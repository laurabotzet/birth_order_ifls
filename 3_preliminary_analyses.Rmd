---
author: "Laura Botzet"
date: "10/26/2016"
output: html_document
---

# Preliminary Analyses

## Load libraries
```{r libraries}
library(lme4)
library(ggplot2)
library(formr)
library(effects)
library(stringr)
library(forcats)
library(dplyr)
```

## helper
```{r helper}
apatheme=theme_bw()+
  theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        panel.border=element_blank(),
        axis.line=element_line(),
        text=element_text(family='Times'))

plot_birthorder = function(model, bo_var = "birthorder") {
  if(inherits(model, "merMod")) {
    varnames = names(model@frame)
  } else {
    varnames = names(model$model)
  }
  outcome = varnames[1]
  library(effects)
  emm = allEffects(model)
  bo_var = names(emm)[names(emm) %contains% bo_var]
  cemm = as.data.frame(emm[[bo_var]]) %>%
    separate_(bo_var, into = c("Birth order", "Sibship"), sep = "/")
  cemm = cemm %>%
    mutate(Sibship = fct_recode(Sibship, "1         n" = "1", "2         n" = "2",
                                "3         n" = "3", "4         n" = "4",
                                "5         n" = "5", "5+       n" = "5+"))
  print(
  ggplot(cemm, aes(`Birth order`, y = fit, ymax = upper, ymin = lower,
                   colour = `Sibship`, group = `Sibship`)) + 
    geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) + 
    geom_line(position = position_dodge(width = 0.5)) +
    scale_y_continuous(outcome, limits = c(-0.6, 0.6), breaks = c(-0.6, -0.5, -0.4,
                                                                  -0.3, -0.2, -0.1, 0,
                                                                  0.1, 0.2, 0.3, 0.4, 0.5,
                                                                  0.6)) +
    theme(legend.background = element_rect(fill="gray90", size=.5, linetype="dotted")) +
    guides(colour=guide_legend(title = "Sibship   n"))
  )
}

```


## Load data
```{r load data}
alldata_birthorder = readRDS("data/alldata_birthorder.rds")

```



## Data Preperations
```{r data preperations}
### Variables
alldata_birthorder = alldata_birthorder %>%
  mutate(
    # center birthyear
    birthyear = byear - mean(byear, na.rm = T),
    # Sex (1 = male, 2 = female)
    male = factor(sex.x == 1),
    male = ifelse(sex.x > 3, NA, male),
    # mother_pidlink has to be specified
    mother_pidlink = mother_pidlink.x,
    # center variables that are used for analysy - but first save old values
    old_g_factor = g_factor,
    old_raven = raven,
    old_math = math,
    old_count_backwards = count_backwards,
    old_words_remembered_avg = words_remembered_avg,
    old_words_immediate = words_immediate,
    old_words_delayed = words_delayed,
    old_adaptive_numbering = adaptive_numbering,
    old_big5_ext = big5_ext,
    old_big5_con = big5_con,
    old_big5_agree = big5_agree,
    old_big5_neu = big5_neu,
    old_big5_open = big5_open,
    old_riskA = riskA,
    old_riskB = riskB,
    g_factor = (g_factor - mean(g_factor, na.rm=T)) / sd(g_factor, na.rm=T),
    raven = (raven - mean(raven, na.rm=T)) / sd(raven, na.rm=T),
    math = (math - mean(math, na.rm=T)) / sd(math, na.rm=T),
    count_backwards = (count_backwards - mean(count_backwards, na.rm=T)) /
      sd(count_backwards, na.rm=T),
    words_remembered_avg = (words_remembered_avg - mean(words_remembered_avg, na.rm=T)) /
      sd(words_remembered_avg, na.rm=T),
    words_immediate = (words_immediate - mean(words_immediate, na.rm=T)) /
      sd(words_immediate, na.rm=T),
    words_delayed = (words_delayed - mean(words_delayed, na.rm=T)) /
      sd(words_delayed, na.rm=T),
    adaptive_numbering = (adaptive_numbering - mean(adaptive_numbering, na.rm=T)) /
      sd(adaptive_numbering, na.rm=T),
    big5_ext = (big5_ext - mean(big5_ext, na.rm=T)) / sd(big5_ext, na.rm=T),
    big5_con = (big5_con - mean(big5_con, na.rm=T)) / sd(big5_con, na.rm=T),
    big5_agree = (big5_agree - mean(big5_agree, na.rm=T)) / sd(big5_agree, na.rm=T),
    big5_open = (big5_open - mean(big5_open, na.rm=T)) / sd(big5_open, na.rm=T),
    big5_neu = (big5_neu - mean(big5_neu, na.rm=T)) / sd(big5_neu, na.rm=T),
    riskA = (riskA - mean(riskA, na.rm=T)) / sd(riskA, na.rm=T),
    riskB = (riskB - mean(riskB, na.rm=T)) / sd(riskB, na.rm=T)
        )
qplot(alldata_birthorder$g_factor)

### Birthorder and Sibling Count
alldata_birthorder = alldata_birthorder %>% 
  mutate(
# birthorder as factors with levels of 1, 2, 3, 4, 5, 5+
    birthorder_uterus_alive_factor = as.character(birthorder_uterus_alive),
    birthorder_uterus_alive_factor = ifelse(birthorder_uterus_alive > 5, "5+",
                                            birthorder_uterus_alive_factor),
    birthorder_uterus_alive_factor = factor(birthorder_uterus_alive_factor, 
                                            levels = c("1","2","3","4","5","5+")),
    sibling_count_uterus_alive_factor = as.character(sibling_count_uterus_alive),
    sibling_count_uterus_alive_factor = ifelse(sibling_count_uterus_alive > 5, "5+",
                                               sibling_count_uterus_alive_factor),
    sibling_count_uterus_alive_factor = factor(sibling_count_uterus_alive_factor, 
                                               levels = c("1","2","3","4","5","5+")),
    birthorder_uterus_preg_factor = as.character(birthorder_uterus_preg),
    birthorder_uterus_preg_factor = ifelse(birthorder_uterus_preg > 5, "5+",
                                           birthorder_uterus_preg_factor),
    birthorder_uterus_preg_factor = factor(birthorder_uterus_preg_factor,
                                           levels = c("1","2","3","4","5","5+")),
    sibling_count_uterus_preg_factor = as.character(sibling_count_uterus_preg),
    sibling_count_uterus_preg_factor = ifelse(sibling_count_uterus_preg > 5, "5+",
                                              sibling_count_uterus_preg_factor),
    sibling_count_uterus_preg_factor = factor(sibling_count_uterus_preg_factor, 
                                              levels = c("1","2","3","4","5","5+")),
    birthorder_genes_factor = as.character(birthorder_genes),
    birthorder_genes_factor = ifelse(birthorder_genes >5 , "5+", birthorder_genes_factor),
    birthorder_genes_factor = factor(birthorder_genes_factor, 
                                     levels = c("1","2","3","4","5","5+")),
    sibling_count_genes_factor = as.character(sibling_count_genes),
    sibling_count_genes_factor = ifelse(sibling_count_genes >5 , "5+",
                                        sibling_count_genes_factor),
    sibling_count_genes_factor = factor(sibling_count_genes_factor, 
                                        levels = c("1","2","3","4","5","5+")),
    # interaction birthorder * siblingcout for each birthorder
    count_birthorder_uterus_alive =
      factor(str_replace(as.character(interaction(birthorder_uterus_alive_factor,                                                              sibling_count_uterus_alive_factor)),
                        "\\.", "/"),
                                           levels =   c("1/1","1/2","2/2", "1/3",  "2/3",
                                                        "3/3", "1/4", "2/4", "3/4", "4/4",
                                                        "1/5", "2/5", "3/5", "4/5", "5/5",
                                                        "1/5+", "2/5+", "3/5+", "4/5+",
                                                        "5/5+", "5+/5+")),
    count_birthorder_uterus_preg =
      factor(str_replace(as.character(interaction(birthorder_uterus_preg_factor,                                                              sibling_count_uterus_preg_factor)), 
                         "\\.", "/"),
                                           levels =   c("1/1","1/2","2/2", "1/3",  "2/3",
                                                        "3/3", "1/4", "2/4", "3/4", "4/4",
                                                        "1/5", "2/5", "3/5", "4/5", "5/5",
                                                        "1/5+", "2/5+", "3/5+", "4/5+",
                                                        "5/5+", "5+/5+")),
    count_birthorder_genes =
      factor(str_replace(as.character(interaction(birthorder_genes_factor,                                                              sibling_count_genes_factor)), "\\.", "/"),
                                           levels =   c("1/1","1/2","2/2", "1/3",  "2/3",
                                                        "3/3", "1/4", "2/4", "3/4", "4/4",
                                                        "1/5", "2/5", "3/5", "4/5", "5/5",
                                                        "1/5+", "2/5+", "3/5+", "4/5+",
                                                        "5/5+", "5+/5+")))



```




```{r Between-family Analysis Intelligence}
### Main Test: G-Factor - without covariats
## Main Test: G-Factor - uterus_alive
m_g_factor_uterus_alive = lm(g_factor ~ count_birthorder_uterus_alive,
                             data = alldata_birthorder)
summary(m_g_factor_uterus_alive)
plot_birthorder(m_g_factor_uterus_alive)

## Main Test: G-Factor - uterus_alive with covariats
m_g_factor_uterus_alive_covariats = lm(g_factor ~ count_birthorder_uterus_alive 
                                       + birthyear + male,
                             data = alldata_birthorder)
summary(m_g_factor_uterus_alive_covariats)
plot_birthorder(m_g_factor_uterus_alive_covariats)

## Main Test: G-Factor - uterus_preg
m_g_factor_uterus_preg = lm(g_factor ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_g_factor_uterus_preg)
plot_birthorder(m_g_factor_uterus_preg)

## Main Test: G-Factor - genes
m_g_factor_genes = lm(g_factor ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_g_factor_genes)
plot_birthorder(m_g_factor_genes)

## Main Test: G-Factor - genes with covariats
m_g_factor_genes_covariats = lm(g_factor ~ count_birthorder_genes
                                + birthyear + male,
                            data = alldata_birthorder)
summary(m_g_factor_genes_covariats)
plot_birthorder(m_g_factor_genes_covariats)

### Sub Tests
## Raven’s matrices test
# raven - uterus_alive
m_raven_uterus_alive = lm(raven ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_raven_uterus_alive)
plot_birthorder(m_raven_uterus_alive)

# raven - uterus_preg
m_raven_uterus_preg = lm(raven ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_raven_uterus_preg)
plot_birthorder(m_raven_uterus_preg)

# raven - genes
m_raven_genes = lm(raven ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_raven_genes)
plot_birthorder(m_raven_genes)

## Numeracy test
# math - uterus_alive
m_math_uterus_alive = lm(math ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_math_uterus_alive)
plot_birthorder(m_math_uterus_alive)

# math - uterus_preg
m_math_uterus_preg = lm(math ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_math_uterus_preg)
plot_birthorder(m_math_uterus_preg)

# math - genes
m_math_genes = lm(math ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_math_genes)
plot_birthorder(m_math_genes)

## Backwards counting
# count_backwards - uterus_alive
m_count_backwards_uterus_alive = lm(count_backwards ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_count_backwards_uterus_alive)
plot_birthorder(m_count_backwards_uterus_alive)

# count_backwards - uterus_preg
m_count_backwards_uterus_preg = lm(count_backwards ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_count_backwards_uterus_preg)
plot_birthorder(m_count_backwards_uterus_preg)

# count_backwards - genes
m_count_backwards_genes = lm(count_backwards ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_count_backwards_genes)
plot_birthorder(m_count_backwards_genes)

## Word Recall
# words_remembered_avg - uterus_alive
m_words_remembered_avg_uterus_alive = lm(words_remembered_avg ~
                                           count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_words_remembered_avg_uterus_alive)
plot_birthorder(m_words_remembered_avg_uterus_alive)

# words_remembered_avg - uterus_preg
m_words_remembered_avg_uterus_preg = lm(words_remembered_avg ~
                                  count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_words_remembered_avg_uterus_preg)
plot_birthorder(m_words_remembered_avg_uterus_preg)

# words_remembered_avg - genes
m_words_remembered_avg_genes = lm(words_remembered_avg ~ 
                               count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_words_remembered_avg_genes)
plot_birthorder(m_words_remembered_avg_genes)

## Adaptive number series
# adaptive_numbering - uterus_alive
m_adaptive_numbering_uterus_alive = lm(adaptive_numbering ~
                                   count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_adaptive_numbering_uterus_alive)
plot_birthorder(m_adaptive_numbering_uterus_alive)

# adaptive_numbering - uterus_preg
m_adaptive_numbering_uterus_preg = lm(adaptive_numbering ~
                                   count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_adaptive_numbering_uterus_preg)
plot_birthorder(m_adaptive_numbering_uterus_preg)

# adaptive_numbering - genes
m_adaptive_numbering_genes = lm(adaptive_numbering ~ 
                              count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_adaptive_numbering_genes)
plot_birthorder(m_adaptive_numbering_genes)

```


```{r Between-family Analysis Personality}
### Personality - without covariats
## Openness
# big5_open - uterus_alive
m_big5_open_uterus_alive = lm(big5_open ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_big5_open_uterus_alive)
plot_birthorder(m_big5_open_uterus_alive)

# big5_open - uterus_preg
m_big5_open_uterus_preg = lm(big5_open ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_big5_open_uterus_preg)
plot_birthorder(m_big5_open_uterus_preg)

# big5_open - genes
m_big5_open_genes = lm(big5_open ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_big5_open_genes)
plot_birthorder(m_big5_open_genes)

## Extraversion
# big5_ext - uterus_alive
m_big5_ext_uterus_alive = lm(big5_ext ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_big5_ext_uterus_alive)
plot_birthorder(m_big5_ext_uterus_alive)

# big5_ext - uterus_preg
m_big5_ext_uterus_preg = lm(big5_ext ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_big5_ext_uterus_preg)
plot_birthorder(m_big5_ext_uterus_preg)

# big5_ext - genes
m_big5_ext_genes = lm(big5_ext ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_big5_ext_genes)
plot_birthorder(m_big5_ext_genes)

## Neuroticism
# big5_neu - uterus_alive
m_big5_neu_uterus_alive = lm(big5_neu ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_big5_neu_uterus_alive)
plot_birthorder(m_big5_neu_uterus_alive)

# big5_neu - uterus_preg
m_big5_neu_uterus_preg = lm(big5_neu ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_big5_neu_uterus_preg)
plot_birthorder(m_big5_neu_uterus_preg)

# big5_neu - genes
m_big5_neu_genes = lm(big5_neu ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_big5_neu_genes)
plot_birthorder(m_big5_neu_genes)

## Aggreableness
# big5_agree - uterus_alive
m_big5_agree_uterus_alive = lm(big5_agree ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_big5_agree_uterus_alive)
plot_birthorder(m_big5_agree_uterus_alive)

# big5_agree - uterus_preg
m_big5_agree_uterus_preg = lm(big5_agree ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_big5_agree_uterus_preg)
plot_birthorder(m_big5_agree_uterus_preg)

# big5_agree - genes
m_big5_agree_genes = lm(big5_agree ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_big5_agree_genes)
plot_birthorder(m_big5_agree_genes)

## Conscientiousness
# big5_con - uterus_alive
m_big5_con_uterus_alive = lm(big5_con ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_big5_con_uterus_alive)
plot_birthorder(m_big5_con_uterus_alive)

# big5_con - uterus_preg
m_big5_con_uterus_preg = lm(big5_con ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_big5_con_uterus_preg)
plot_birthorder(m_big5_con_uterus_preg)

# big5_con - genes
m_big5_con_genes = lm(big5_con ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_big5_con_genes)
plot_birthorder(m_big5_con_genes)

```

## Risk
```{r Between-family Analysis Rsik Preference}
### Risk A
## Risk A - Uterus alive
m_riskA_uterus_alive = lm(riskA ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_riskA_uterus_alive)
plot_birthorder(m_riskA_uterus_alive)

## Risk A - Uterus preg
m_riskA_uterus_preg = lm(riskA ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_riskA_uterus_preg)
plot_birthorder(m_riskA_uterus_preg)

## Risk A - genes
m_riskA_genes = lm(riskA ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_riskA_genes)
plot_birthorder(m_riskA_genes)

### Risk B
## Risk B - Uterus alive
m_riskB_uterus_alive = lm(riskB ~ count_birthorder_uterus_alive,
                            data = alldata_birthorder)
summary(m_riskB_uterus_alive)
plot_birthorder(m_riskB_uterus_alive)

## Risk B - Uterus preg
m_riskB_uterus_preg = lm(riskB ~ count_birthorder_uterus_preg,
                            data = alldata_birthorder)
summary(m_riskB_uterus_preg)
plot_birthorder(m_riskB_uterus_preg)

## Risk B - genes
m_riskB_genes = lm(riskB ~ count_birthorder_genes,
                            data = alldata_birthorder)
summary(m_riskB_genes)
plot_birthorder(m_riskB_genes)
```


## Intelligence - Within Family Analysis
```{r Intelligence - Within Family Analysis}
### Main Test: G-Factor
## Main Test: G-Factor - uterus_alive
# Without covariats
lme_g_factor_uterus_alive = lmer(g_factor ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_g_factor_uterus_alive)
plot_birthorder(lme_g_factor_uterus_alive)
# With covariats
lme_g_factor_uterus_alive_covariats = lmer(g_factor ~ count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_g_factor_uterus_alive_covariats)
plot_birthorder(lme_g_factor_uterus_alive_covariats)

## Main Test: G-Factor - uterus_preg
# Without covariats
lme_g_factor_uterus_preg = lmer(g_factor ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_g_factor_uterus_preg)
plot_birthorder(lme_g_factor_uterus_preg)
# With covariats
lme_g_factor_uterus_preg_covariats = lmer(g_factor ~ count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_g_factor_uterus_preg_covariats)
plot_birthorder(lme_g_factor_uterus_preg_covariats)

## Main Test: G-Factor - genes
# Without covariats
lme_g_factor_genes = lmer(g_factor ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_g_factor_genes)
plot_birthorder(lme_g_factor_genes)
# With covariats
lme_g_factor_genes_covariats = lmer(g_factor ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_g_factor_genes_covariats)
plot_birthorder(lme_g_factor_genes_covariats)

### Raven
## Raven - uterus_alive
# Without covariats
lme_raven_uterus_alive = lmer(raven ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_raven_uterus_alive)
plot_birthorder(lme_raven_uterus_alive)
# With covariats
lme_raven_uterus_alive_covariats = lmer(raven ~ count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_raven_uterus_alive_covariats)
plot_birthorder(lme_raven_uterus_alive_covariats)

## Raven - uterus_preg
# Without covariats
lme_raven_uterus_preg = lmer(raven ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_raven_uterus_preg)
plot_birthorder(lme_raven_uterus_preg)
# With covariats
lme_raven_uterus_preg_covariats = lmer(raven ~ count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_raven_uterus_preg_covariats)
plot_birthorder(lme_raven_uterus_preg_covariats)

## Raven - genes
# Without covariats
lme_raven_genes = lmer(raven ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_raven_genes)
plot_birthorder(lme_raven_genes)
# With covariats
lme_raven_genes_covariats = lmer(raven ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_raven_genes_covariats)
plot_birthorder(lme_raven_genes_covariats)

### math
## math - uterus_alive
# Without covariats
lme_math_uterus_alive = lmer(math ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_math_uterus_alive)
plot_birthorder(lme_math_uterus_alive)
# With covariats
lme_math_uterus_alive_covariats = lmer(math ~ count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_math_uterus_alive_covariats)
plot_birthorder(lme_math_uterus_alive_covariats)

## math - uterus_preg
# Without covariats
lme_math_uterus_preg = lmer(math ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_math_uterus_preg)
plot_birthorder(lme_math_uterus_preg)
# With covariats
lme_math_uterus_preg_covariats = lmer(math ~ count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_math_uterus_preg_covariats)
plot_birthorder(lme_math_uterus_preg_covariats)

## math - genes
# Without covariats
lme_math_genes = lmer(math ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_math_genes)
plot_birthorder(lme_math_genes)
# With covariats
lme_math_genes_covariats = lmer(math ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_math_genes_covariats)
plot_birthorder(lme_math_genes_covariats)


### count_backwards
## count_backwards - uterus_alive
# Without covariats
lme_count_backwards_uterus_alive = lmer(count_backwards ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_count_backwards_uterus_alive)
plot_birthorder(lme_count_backwards_uterus_alive)
# With covariats
lme_count_backwards_uterus_alive_covariats = lmer(count_backwards ~
                                                    count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_count_backwards_uterus_alive_covariats)
plot_birthorder(lme_count_backwards_uterus_alive_covariats)

## count_backwards - uterus_preg
# Without covariats
lme_count_backwards_uterus_preg = lmer(count_backwards ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_count_backwards_uterus_preg)
plot_birthorder(lme_count_backwards_uterus_preg)
# With covariats
lme_count_backwards_uterus_preg_covariats = lmer(count_backwards ~
                                                   count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_count_backwards_uterus_preg_covariats)
plot_birthorder(lme_count_backwards_uterus_preg_covariats)

## count_backwards - genes
# Without covariats
lme_count_backwards_genes = lmer(count_backwards ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_count_backwards_genes)
plot_birthorder(lme_count_backwards_genes)
# With covariats
lme_count_backwards_genes_covariats = lmer(count_backwards ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_count_backwards_genes_covariats)
plot_birthorder(lme_count_backwards_genes_covariats)


### words_remembered_avg
## words_remembered_avg - uterus_alive
# Without covariats
lme_words_remembered_avg_uterus_alive = lmer(words_remembered_avg ~
                                               count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_words_remembered_avg_uterus_alive)
plot_birthorder(lme_words_remembered_avg_uterus_alive)
# With covariats
lme_words_remembered_avg_uterus_alive_covariats = lmer(words_remembered_avg ~
                                                    count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_words_remembered_avg_uterus_alive_covariats)
plot_birthorder(lme_words_remembered_avg_uterus_alive_covariats)

## words_remembered_avg - uterus_preg
# Without covariats
lme_words_remembered_avg_uterus_preg = lmer(words_remembered_avg ~
                                              count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_words_remembered_avg_uterus_preg)
plot_birthorder(lme_words_remembered_avg_uterus_preg)
# With covariats
lme_words_remembered_avg_uterus_preg_covariats = lmer(words_remembered_avg ~
                                                   count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_words_remembered_avg_uterus_preg_covariats)
plot_birthorder(lme_words_remembered_avg_uterus_preg_covariats)

## words_remembered_avg - genes
# Without covariats
lme_words_remembered_avg_genes = lmer(words_remembered_avg ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_words_remembered_avg_genes)
plot_birthorder(lme_words_remembered_avg_genes)
# With covariats
lme_words_remembered_avg_genes_covariats = lmer(words_remembered_avg ~
                                                  count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_words_remembered_avg_genes_covariats)
plot_birthorder(lme_words_remembered_avg_genes_covariats)

### adaptive_numbering
## adaptive_numbering - uterus_alive
# Without covariats
lme_adaptive_numbering_uterus_alive = lmer(adaptive_numbering ~
                                             count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_adaptive_numbering_uterus_alive)
plot_birthorder(lme_adaptive_numbering_uterus_alive)
# With covariats
lme_adaptive_numbering_uterus_alive_covariats = lmer(adaptive_numbering ~
                                                       count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_adaptive_numbering_uterus_alive_covariats)
plot_birthorder(lme_adaptive_numbering_uterus_alive_covariats)

## adaptive_numbering - uterus_preg
# Without covariats
lme_adaptive_numbering_uterus_preg = lmer(adaptive_numbering ~
                                            count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_adaptive_numbering_uterus_preg)
plot_birthorder(lme_adaptive_numbering_uterus_preg)
# With covariats
lme_adaptive_numbering_uterus_preg_covariats = lmer(adaptive_numbering ~
                                                      count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_adaptive_numbering_uterus_preg_covariats)
plot_birthorder(lme_adaptive_numbering_uterus_preg_covariats)

## adaptive_numbering - genes
# Without covariats
lme_adaptive_numbering_genes = lmer(adaptive_numbering ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_adaptive_numbering_genes)
plot_birthorder(lme_adaptive_numbering_genes)
# With covariats
lme_adaptive_numbering_genes_covariats = lmer(adaptive_numbering ~ 
                                                count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_adaptive_numbering_genes_covariats)
plot_birthorder(lme_adaptive_numbering_genes_covariats)

```

## Personality - Within Family Analysis
```{r Personality - Within Family Analysis}
### big5_open
## big5_open - uterus_alive
# Without covariats
lme_big5_open_uterus_alive = lmer(big5_open ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_open_uterus_alive)
plot_birthorder(lme_big5_open_uterus_alive)
# With covariats
lme_big5_open_uterus_alive_covariats = lmer(big5_open ~ count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_open_uterus_alive_covariats)
plot_birthorder(lme_big5_open_uterus_alive_covariats)

## big5_open - uterus_preg
# Without covariats
lme_big5_open_uterus_preg = lmer(big5_open ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_open_uterus_preg)
plot_birthorder(lme_big5_open_uterus_preg)
# With covariats
lme_big5_open_uterus_preg_covariats = lmer(big5_open ~ count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_open_uterus_preg_covariats)
plot_birthorder(lme_big5_open_uterus_preg_covariats)

## big5_open - genes
# Without covariats
lme_big5_open_genes = lmer(big5_open ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_open_genes)
plot_birthorder(lme_big5_open_genes)
# With covariats
lme_big5_open_genes_covariats = lmer(big5_open ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_open_genes_covariats)
plot_birthorder(lme_big5_open_genes_covariats)

### big5_ext
## big5_ext - uterus_alive
# Without covariats
lme_big5_ext_uterus_alive = lmer(big5_ext ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_ext_uterus_alive)
plot_birthorder(lme_big5_ext_uterus_alive)
# With covariats
lme_big5_ext_uterus_alive_covariats = lmer(big5_ext ~ count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_ext_uterus_alive_covariats)
plot_birthorder(lme_big5_ext_uterus_alive_covariats)

## big5_ext - uterus_preg
# Without covariats
lme_big5_ext_uterus_preg = lmer(big5_ext ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_ext_uterus_preg)
plot_birthorder(lme_big5_ext_uterus_preg)
# With covariats
lme_big5_ext_uterus_preg_covariats = lmer(big5_ext ~ count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_ext_uterus_preg_covariats)
plot_birthorder(lme_big5_ext_uterus_preg_covariats)

## big5_ext - genes
# Without covariats
lme_big5_ext_genes = lmer(big5_ext ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_ext_genes)
plot_birthorder(lme_big5_ext_genes)
# With covariats
lme_big5_ext_genes_covariats = lmer(big5_ext ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_ext_genes_covariats)
plot_birthorder(lme_big5_ext_genes_covariats)

### big5_neu
## big5_neu - uterus_alive
# Without covariats
lme_big5_neu_uterus_alive = lmer(big5_neu ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_neu_uterus_alive)
plot_birthorder(lme_big5_neu_uterus_alive)
# With covariats
lme_big5_neu_uterus_alive_covariats = lmer(big5_neu ~ count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_neu_uterus_alive_covariats)
plot_birthorder(lme_big5_neu_uterus_alive_covariats)

## big5_neu - uterus_preg
# Without covariats
lme_big5_neu_uterus_preg = lmer(big5_neu ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_neu_uterus_preg)
plot_birthorder(lme_big5_neu_uterus_preg)
# With covariats
lme_big5_neu_uterus_preg_covariats = lmer(big5_neu ~ count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_neu_uterus_preg_covariats)
plot_birthorder(lme_big5_neu_uterus_preg_covariats)

## big5_neu - genes
# Without covariats
lme_big5_neu_genes = lmer(big5_neu ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_neu_genes)
plot_birthorder(lme_big5_neu_genes)
# With covariats
lme_big5_neu_genes_covariats = lmer(big5_neu ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_neu_genes_covariats)
plot_birthorder(lme_big5_neu_genes_covariats)

### big5_agree
## big5_agree - uterus_alive
# Without covariats
lme_big5_agree_uterus_alive = lmer(big5_agree ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_agree_uterus_alive)
plot_birthorder(lme_big5_agree_uterus_alive)
# With covariats
lme_big5_agree_uterus_alive_covariats = lmer(big5_agree ~ count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_agree_uterus_alive_covariats)
plot_birthorder(lme_big5_agree_uterus_alive_covariats)

## big5_agree - uterus_preg
# Without covariats
lme_big5_agree_uterus_preg = lmer(big5_agree ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_agree_uterus_preg)
plot_birthorder(lme_big5_agree_uterus_preg)
# With covariats
lme_big5_agree_uterus_preg_covariats = lmer(big5_agree ~ count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_agree_uterus_preg_covariats)
plot_birthorder(lme_big5_agree_uterus_preg_covariats)

## big5_agree - genes
# Without covariats
lme_big5_agree_genes = lmer(big5_agree ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_agree_genes)
plot_birthorder(lme_big5_agree_genes)
# With covariats
lme_big5_agree_genes_covariats = lmer(big5_agree ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_agree_genes_covariats)
plot_birthorder(lme_big5_agree_genes_covariats)


### big5_con
## big5_con - uterus_alive
# Without covariats
lme_big5_con_uterus_alive = lmer(big5_con ~ count_birthorder_uterus_alive +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_con_uterus_alive)
plot_birthorder(lme_big5_con_uterus_alive)
# With covariats
lme_big5_con_uterus_alive_covariats = lmer(big5_con ~ count_birthorder_uterus_alive +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_con_uterus_alive_covariats)
plot_birthorder(lme_big5_con_uterus_alive_covariats)

## big5_con - uterus_preg
# Without covariats
lme_big5_con_uterus_preg = lmer(big5_con ~ count_birthorder_uterus_preg +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_con_uterus_preg)
plot_birthorder(lme_big5_con_uterus_preg)
# With covariats
lme_big5_con_uterus_preg_covariats = lmer(big5_con ~ count_birthorder_uterus_preg +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_con_uterus_preg_covariats)
plot_birthorder(lme_big5_con_uterus_preg_covariats)

## big5_con - genes
# Without covariats
lme_big5_con_genes = lmer(big5_con ~ count_birthorder_genes +
                                   (1 | mother_pidlink), data = alldata_birthorder)
summary(lme_big5_con_genes)
plot_birthorder(lme_big5_con_genes)
# With covariats
lme_big5_con_genes_covariats = lmer(big5_con ~ count_birthorder_genes +
                                             (1 | mother_pidlink) + birthyear + male,
                                           data = alldata_birthorder)
summary(lme_big5_con_genes_covariats)
plot_birthorder(lme_big5_con_genes_covariats)
```


