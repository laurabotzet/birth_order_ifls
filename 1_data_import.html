<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Laura Botzet" />


<title></title>

<script src="library/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="library/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="library/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="library/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="library/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="library/highlight/default.css"
      type="text/css" />
<script src="library/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="library/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">




</div>


<div id="data-import" class="section level1 tabset">
<h1>Data import</h1>
<div id="library" class="section level2">
<h2>Library</h2>
<pre class="r"><code>library(devtools)
library(haven)
devtools::install_github(&quot;hadley/haven&quot;)</code></pre>
<pre><code>## Skipping install of &#39;haven&#39; from a github remote, the SHA1 (68e0c2d5) has not changed since last install.
##   Use `force = TRUE` to force installation</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre class="r"><code>library(tidyr)</code></pre>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code>### Individual and household Information
## Informations about individuals living in the household in 2014/2015
# Individuals living in the household
bk_ar1 = read_dta(&quot;data/hh14_all_dta/bk_ar1.dta&quot;)


### Informations about earlier waves
ptrack = read_dta(&quot;data/hh14_all_dta/ptrack.dta&quot;)

### IQ Information
ek_ek1 = read_dta(&quot;data/hh14_all_dta/ek_ek1.dta&quot;)
ek_ek2 = read_dta(&quot;data/hh14_all_dta/ek_ek2.dta&quot;)
ek_time1 = read_dta(&quot;data/hh14_all_dta/ek_time1.dta&quot;)
ek_time2 = read_dta(&quot;data/hh14_all_dta/ek_time2.dta&quot;)
# additional information (counting backwards, adaptive testing) for adults
b3b_cob = read_dta(&quot;data/hh14_all_dta/b3b_cob.dta&quot;)
b3b_co1 = read_dta(&quot;data/hh14_all_dta/b3b_co1.dta&quot;)
### Personality Information (only for adults)
b3b_psn = read_dta(&quot;data/hh14_all_dta/b3b_psn.dta&quot;)

### Risk taking
b3a_si = read_dta(&quot;data/hh14_all_dta/b3a_si.dta&quot;)</code></pre>
</div>
<div id="select-data" class="section level2">
<h2>Select data</h2>
<pre class="r"><code>### Individuals
individuals = bk_ar1 %&gt;% select(hhid14_9, pidlink, ar02b, ar10, ar11, ar07, ar08day, ar08mth, ar08yr, ar09, ar18h)

##create number that should be identical for all siblings in one family
individuals &lt;- unite(individuals,
                  col = &quot;hhid14_9_ar10_ar11&quot;,
                  hhid14_9, ar10, ar11,
                  sep = &quot;_&quot;,
                  remove = FALSE)

#calculate sibling size
individuals &lt;- ddply(individuals,.(hhid14_9_ar10_ar11),transform,siblingcount=length(hhid14_9_ar10_ar11))
##calculate birth order??



### IQ Informations
##ek1 (7-14yrs old)
iq1 = ek_ek1 %&gt;% select(hhid14_9, pidlink, age, sex, ektype, resptype, result, reason, ek1_ans, ek2_ans, ek3_ans, ek4_ans, ek5_ans, ek6_ans, ek7_ans, ek8_ans, ek9_ans, ek10_ans, ek11_ans, ek12_ans, ek13_ans, ek14_ans, ek15_ans, ek16_ans, ek17_ans, ek18_ans, ek19_ans, ek20_ans, ek21_ans, ek22_ans)
# Participants who took the ek1 in 2007 were given ek2 again - to make sure that the dont appear in both cognitive analyses we have to exclude them
iq1 = subset(iq1, age&lt;15)

##ek2 (&gt;14yrs)
iq2.1 = ek_ek2 %&gt;% select(hhid14_9, pidlink, age, sex, ektype, resptype, result, reason, ek1_ans, ek2_ans, ek3_ans, ek4_ans, ek5_ans, ek6_ans, ek7_ans, ek8_ans, ek9_ans, ek10_ans, ek11_ans, ek12_ans, ek13_ans, ek14_ans, ek15_ans, ek16_ans, ek17_ans, ek18_ans, ek19_ans, ek20_ans, ek21_ans, ek22_ans)
#additional informations for adults: counting backwards
iq2.2 = b3b_co1 %&gt;% select(hhid14_9, pidlink, co04a, co04b, co04c, co04d, co04e, co07count, co10count)
#additional informations for adults: adaptive number test
iq2.3 = b3b_cob %&gt;% select(hhid14_9, pidlink, cob01_b, cob02_b, cob03_b, cob04_b, cob05_b, cob06_b, cob07_b, cob08_b, cob09_b, cob10_b, cob11_b, cob12_b, cob13_b, cob14_b, cob15_b1, cob15_b2)
# put all the informations for participants &gt;= 15 together
iq2 = full_join(iq2.1, iq2.2, by = &quot;pidlink&quot;)
iq2 = full_join(iq2, iq2.3, by = &quot;pidlink&quot;)

### Put both iq files together
iq = bind_rows(iq1, iq2)


### Personality
##Rearrange personality data so that every individual has only one row
pers = spread(b3b_psn, psntype, psn01)
##name columns
colnames(pers) &lt;- c(&quot;hhid14_9&quot;, &quot;pid14&quot;, &quot;hhid14&quot;, &quot;pidlink&quot;, &quot;version&quot;, &quot;module&quot;, &quot;e1&quot;, &quot;c1&quot;, &quot;o1&quot;, &quot;e2r&quot;, &quot;n1r&quot;, &quot;a1&quot;, &quot;n2r&quot;, &quot;o2&quot;, &quot;c1r&quot;, &quot;o3&quot;, &quot;a2&quot;, &quot;c2&quot;, &quot;e3&quot;, &quot;a3r&quot;, &quot;n3&quot;)
pers = pers %&gt;% select(hhid14_9, pidlink, e1, c1, o1, e2r, n1r, a1, n2r, o2, c1r, o3, a2, c2, e3, a3r, n3)


###Risktaking
risk = b3a_si %&gt;% select(hhid14_9, pidlink, random_si, si01, si02, si03, si04, si05, si11, si12, si13, si14, si15)</code></pre>
</div>
<div id="find-out-if-its-possible-to-analyse-data-for-personality-siblings-older-than-14" class="section level2">
<h2>Find out if its possible to analyse data for personality (siblings older than 14)</h2>
<pre class="r"><code>### how many siblings older than 14 are there?
##older than 14
individuals15 = subset(individuals, ar09&gt;14)
##exclude people whose parents are not known
individuals15 = subset(individuals15, ar10 &lt;51)
individuals15 = subset(individuals15, ar11 &lt;51)
##exclude only childs (watch out: sibling size was conduted WITH all younger siblings!)
individuals15=subset(individuals15, siblingcount != 1)
hist(individuals15$siblingcount)</code></pre>
<p><img src="1_data_import_files/figure-html/looking at data > 14-1.png&quot; width=“672” /&gt;</p>
<pre class="r"><code>hist(individuals15$ar02b)</code></pre>
<p><img src="1_data_import_files/figure-html/looking at data > 14-2.png&quot; width=“672” /&gt;</p>
<div id="merge-data" class="section level3">
<h3>Merge data</h3>
<pre class="r"><code>### Merge ALL data (including all participants)
alldata = full_join(individuals, iq, by=&quot;pidlink&quot;)
alldata = full_join(alldata, pers, by=&quot;pidlink&quot;)
alldata = full_join(alldata, risk, by=&quot;pidlink&quot;)</code></pre>
</div>
<div id="save-data" class="section level3">
<h3>Save data</h3>
<p>for future analyses</p>
<pre class="r"><code>saveRDS(alldata, file = &quot;data/hh14_all_dta/alldata.dta&quot;)</code></pre>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
