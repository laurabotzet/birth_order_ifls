<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("4_analyses_imputed_data.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>
<li style="background-color: #A6D854">
  <a href="4_analyses.html">Birth Order Effects</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
    <span class="fa fa-github"></span>


  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>




</div>


<div id="birth-order-effects" class="section level1 tabset">
<h1><span style="color:#A6D854">Birth Order Effects</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     ggsave</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.5-23.1097</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;sjPlot&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:cowplot&#39;:
## 
##     plot_grid, save_plot</code></pre>
<pre class="r"><code>opts_chunk$set(warning = FALSE)</code></pre>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<pre class="r"><code>n_imputations.mitml = function(imps) {
  imps$iter$m
}
n_imputations.mids = function(imps) {
  imps$m
}
n_imputations.amelia = function(imps) {
  length(imps$imputations)
}
n_imputations = function(imps) { UseMethod(&quot;n_imputations&quot;) }

complete.mitml = mitml::mitmlComplete
complete.mids = mice::complete
complete = function(...) { UseMethod(&quot;complete&quot;) }

library(mice)</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     complete</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     complete</code></pre>
<pre class="r"><code>library(miceadds)</code></pre>
<pre><code>## * miceadds 2.7-19 (2017-08-24 17:34:44)</code></pre>
<pre class="r"><code>library(mitml)</code></pre>
<pre><code>## *** This is beta software. Please report any bugs!
## *** See the NEWS file for recent changes.</code></pre>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code>birthorder = readRDS(&quot;data/alldata_birthorder_i_ml.rds&quot;)</code></pre>
</div>
<div id="data-preparations" class="section level2">
<h2>Data preparations</h2>
<pre class="r"><code>birthorder &lt;- mids2mitml.list(birthorder)

## Calculate g_factors (for now with rowMeans: better to run factor analysis here as well?)
birthorder &lt;- within(birthorder, {
  g_factor_2015_old &lt;- rowMeans(scale(cbind(raven_2015_old, math_2015_old, count_backwards,  words_delayed, adaptive_numbering)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2015_young &lt;- rowMeans(scale(cbind(raven_2015_young, math_2015_young)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_old &lt;- rowMeans(scale(cbind(raven_2007_old, math_2007_old)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_young &lt;- rowMeans(scale(cbind(raven_2007_young, math_2007_young)))
})


birthorder = birthorder %&gt;% tbl_df.mitml.list

### Birthorder and Sibling Count
# for factor variables we have to round birth order position and eliminate all unlikely numbers (negative ones)
birthorder_data = birthorder[[1]]

birthorder = birthorder %&gt;%
  mutate(birthorder_genes = ifelse(birthorder_genes &lt; 0, 0, birthorder_genes),
         birthorder_naive = ifelse(birthorder_naive &lt; 0, 0, birthorder_naive),
         birthorder_genes = round(birthorder_genes),
         birthorder_naive = round(birthorder_naive),
         sibling_count_genes = ifelse(sibling_count_genes &lt; 0, 0, sibling_count_genes),
         sibling_count_naive = ifelse(sibling_count_naive &lt; 0, 0, sibling_count_naive),
         sibling_count_genes = round(sibling_count_genes),
         sibling_count_naive = round(sibling_count_naive)
         )


birthorder = birthorder %&gt;% 
  mutate(
# birthorder as factors with levels of 1, 2, 3, 4, 5, 5+
    birthorder_naive_factor = as.character(birthorder_naive),
    birthorder_naive_factor = ifelse(birthorder_naive &gt; 5, &quot;5+&quot;,
                                            birthorder_naive_factor),
    birthorder_naive_factor = factor(birthorder_naive_factor, 
                                            levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    sibling_count_naive_factor = as.character(sibling_count_naive),
    sibling_count_naive_factor = ifelse(sibling_count_naive &gt; 5, &quot;5+&quot;,
                                               sibling_count_naive_factor),
    sibling_count_naive_factor = factor(sibling_count_naive_factor, 
                                               levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    birthorder_genes_factor = as.character(birthorder_genes),
    birthorder_genes_factor = ifelse(birthorder_genes &gt;5 , &quot;5+&quot;, birthorder_genes_factor),
    birthorder_genes_factor = factor(birthorder_genes_factor, 
                                     levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    sibling_count_genes_factor = as.character(sibling_count_genes),
    sibling_count_genes_factor = ifelse(sibling_count_genes &gt;5 , &quot;5+&quot;,
                                        sibling_count_genes_factor),
    sibling_count_genes_factor = factor(sibling_count_genes_factor, 
                                        levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    # interaction birthorder * siblingcout for each birthorder
    count_birthorder_naive =
      factor(str_replace(as.character(interaction(birthorder_naive_factor,                                                              sibling_count_naive_factor)),
                        &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;,
                                                        &quot;1/5+&quot;, &quot;2/5+&quot;, &quot;3/5+&quot;, &quot;4/5+&quot;,
                                                        &quot;5/5+&quot;, &quot;5+/5+&quot;)),
    count_birthorder_genes =
      factor(str_replace(as.character(interaction(birthorder_genes_factor,                                                              sibling_count_genes_factor)), &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;,
                                                        &quot;1/5+&quot;, &quot;2/5+&quot;, &quot;3/5+&quot;, &quot;4/5+&quot;,
                                                        &quot;5/5+&quot;, &quot;5+/5+&quot;)))



### Variables
birthorder = birthorder %&gt;%
  mutate(
    g_factor_2015_old = (g_factor_2015_old - mean(g_factor_2015_old, na.rm=T)) / sd(g_factor_2015_old, na.rm=T),
    g_factor_2015_young = (g_factor_2015_young - mean(g_factor_2015_young, na.rm=T)) / sd(g_factor_2015_young, na.rm=T),
    g_factor_2007_old = (g_factor_2007_old - mean(g_factor_2007_old, na.rm=T)) / sd(g_factor_2007_old, na.rm=T),
g_factor_2007_young = (g_factor_2007_young - mean(g_factor_2007_young, na.rm=T)) / sd(g_factor_2007_young, na.rm=T),
    raven_2015_old = (raven_2015_old - mean(raven_2015_old, na.rm=T)) / sd(raven_2015_old),
    math_2015_old = (math_2015_old - mean(math_2015_old, na.rm=T)) / sd(math_2015_old, na.rm=T),
    raven_2015_young = (raven_2015_young - mean(raven_2015_young, na.rm=T)) / sd(raven_2015_young),
    math_2015_young = (math_2015_young - mean(math_2015_young, na.rm=T)) /
      sd(math_2015_young, na.rm=T),
    raven_2007_old = (raven_2007_old - mean(raven_2007_old, na.rm=T)) / sd(raven_2007_old),
math_2007_old = (math_2007_old - mean(math_2007_old, na.rm=T)) / sd(math_2007_old, na.rm=T),
raven_2007_young = (raven_2007_young - mean(raven_2007_young, na.rm=T)) / sd(raven_2007_young),
math_2007_young = (math_2007_young - mean(math_2007_young, na.rm=T)) /
  sd(math_2007_young, na.rm=T),
    count_backwards = (count_backwards - mean(count_backwards, na.rm=T)) /
      sd(count_backwards, na.rm=T),
    words_delayed = (words_delayed - mean(words_delayed, na.rm=T)) /
      sd(words_delayed, na.rm=T),
    adaptive_numbering = (adaptive_numbering - mean(adaptive_numbering, na.rm=T)) /
      sd(adaptive_numbering, na.rm=T),
    big5_ext = (big5_ext - mean(big5_ext, na.rm=T)) / sd(big5_ext, na.rm=T),
    big5_con = (big5_con - mean(big5_con, na.rm=T)) / sd(big5_con, na.rm=T),
    big5_agree = (big5_agree - mean(big5_agree, na.rm=T)) / sd(big5_agree, na.rm=T),
    big5_open = (big5_open - mean(big5_open, na.rm=T)) / sd(big5_open, na.rm=T),
    big5_neu = (big5_neu - mean(big5_neu, na.rm=T)) / sd(big5_neu, na.rm=T),
    riskA = (riskA - mean(riskA, na.rm=T)) / sd(riskA, na.rm=T),
    riskB = (riskB - mean(riskB, na.rm=T)) / sd(riskB, na.rm=T),
    years_of_education_z = (years_of_education - mean(years_of_education, na.rm=T)) /
      sd(years_of_education, na.rm=T),
    wage_last_month_z = (wage_last_month_log - mean(wage_last_month_log, na.rm=T)) /
      sd(wage_last_month_log, na.rm=T),
    wage_last_year_z = (wage_last_year_log - mean(wage_last_year_log, na.rm=T)) /
      sd(wage_last_year_log, na.rm=T),
    attended_school = as.integer(attended_school),
    attended_school = ifelse(attended_school == 1, 0,
                           ifelse(attended_school == 2, 1, NA)))
        
data_used &lt;- birthorder %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)</code></pre>
</div>
<div id="intelligence" class="section level2 active tabset">
<h2>Intelligence</h2>
<div id="g-factor-2015-old" class="section level3 tabset">
<h3>g-factor 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.515     0.024     0.468     0.561    21.625    24.386     0.000     1.548     0.636 
## poly(age, 3, raw = TRUE)1    -0.018     0.003    -0.024    -0.011    -5.576    30.152     0.000     1.204     0.574 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.143    46.845     0.887     0.780     0.461 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.732    66.584     0.008     0.581     0.386 
## male                         -0.008     0.011    -0.029     0.014    -0.714    80.174     0.477     0.504     0.351 
## sibling_count                -0.018     0.002    -0.022    -0.014    -8.849   208.373     0.000     0.262     0.215 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.664 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-1" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.515     0.024     0.468     0.562    21.390    24.432     0.000     1.544     0.636 
## birth_order                  -0.000     0.004    -0.007     0.007    -0.113    43.398     0.910     0.836     0.479 
## poly(age, 3, raw = TRUE)1    -0.018     0.003    -0.024    -0.011    -5.591    30.571     0.000     1.186     0.570 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.131    52.912     0.897     0.702     0.433 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.767    82.282     0.007     0.494     0.346 
## male                         -0.008     0.011    -0.029     0.014    -0.714    80.118     0.477     0.504     0.351 
## sibling_count                -0.018     0.003    -0.023    -0.012    -6.177   103.577     0.000     0.418     0.308 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.664 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-1" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-2" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.508     0.025     0.460     0.556    20.702    26.586     0.000     1.391     0.610 
## birth_order_nonlinear2        0.009     0.017    -0.023     0.042     0.562    35.698     0.578     1.008     0.528 
## birth_order_nonlinear3        0.012     0.017    -0.022     0.045     0.686   113.511     0.494     0.392     0.294 
## birth_order_nonlinear4       -0.006     0.025    -0.056     0.043    -0.241    35.817     0.811     1.005     0.527 
## birth_order_nonlinear5        0.003     0.028    -0.052     0.058     0.092    50.919     0.927     0.725     0.442 
## birth_order_nonlinear5+      -0.016     0.028    -0.071     0.040    -0.553    36.142     0.584     0.996     0.525 
## poly(age, 3, raw = TRUE)1    -0.017     0.003    -0.023    -0.011    -5.459    30.374     0.000     1.195     0.572 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.016    50.809     0.987     0.727     0.442 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.571    76.063     0.012     0.524     0.361 
## male                         -0.008     0.011    -0.030     0.014    -0.727    79.758     0.469     0.506     0.352 
## sibling_count                -0.017     0.003    -0.023    -0.011    -5.828    75.346     0.000     0.528     0.362 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.664 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-2" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-3" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.477     0.035     0.407     0.546    13.488    32.599     0.000     1.107     0.552 
## count_birth_order2/2          0.000     0.026    -0.050     0.050     0.013    51.102     0.990     0.723     0.441 
## count_birth_order1/3          0.015     0.029    -0.041     0.071     0.512   178.716     0.610     0.289     0.233 
## count_birth_order2/3         -0.007     0.032    -0.069     0.055    -0.229    69.461     0.820     0.562     0.378 
## count_birth_order3/3          0.012     0.028    -0.043     0.066     0.429   190.183     0.668     0.278     0.226 
## count_birth_order1/4         -0.003     0.034    -0.070     0.063    -0.099   566.449     0.921     0.144     0.129 
## count_birth_order2/4          0.011     0.035    -0.058     0.080     0.306   242.394     0.760     0.239     0.199 
## count_birth_order3/4         -0.034     0.037    -0.107     0.040    -0.896    82.927     0.373     0.491     0.345 
## count_birth_order4/4         -0.015     0.037    -0.088     0.057    -0.415    67.202     0.680     0.577     0.384 
## count_birth_order1/5         -0.024     0.044    -0.111     0.063    -0.546   205.368     0.585     0.265     0.217 
## count_birth_order2/5          0.025     0.045    -0.063     0.114     0.559   201.950     0.577     0.268     0.219 
## count_birth_order3/5          0.009     0.041    -0.071     0.089     0.217   579.371     0.828     0.142     0.128 
## count_birth_order4/5         -0.040     0.046    -0.131     0.050    -0.880    82.572     0.381     0.493     0.346 
## count_birth_order5/5          0.005     0.042    -0.078     0.088     0.114    87.816     0.909     0.471     0.335 
## count_birth_order1/5+        -0.103     0.036    -0.174    -0.031    -2.823   117.534     0.006     0.383     0.289 
## count_birth_order2/5+        -0.157     0.036    -0.229    -0.086    -4.316   119.430     0.000     0.378     0.286 
## count_birth_order3/5+        -0.144     0.039    -0.221    -0.067    -3.685    53.004     0.001     0.701     0.433 
## count_birth_order4/5+        -0.154     0.037    -0.227    -0.081    -4.135    62.410     0.000     0.612     0.399 
## count_birth_order5/5+        -0.147     0.035    -0.215    -0.079    -4.256    96.564     0.000     0.439     0.319 
## count_birth_order5+/5+       -0.159     0.026    -0.209    -0.109    -6.232   104.045     0.000     0.417     0.307 
## poly(age, 3, raw = TRUE)1    -0.019     0.004    -0.027    -0.011    -4.469    28.800     0.000     1.268     0.587 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.871    46.230     0.389     0.790     0.464 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.648    66.663     0.010     0.581     0.386 
## male                         -0.016     0.011    -0.038     0.006    -1.432   112.554     0.155     0.394     0.295 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.662 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-3" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1002.700       13 1337.335    0.000    0.059 
##   2 vs 3:    3.493        4   39.198    0.016    0.637 
##   3 vs 4:    0.088        1   86.627    0.767    0.476 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-1" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-4" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.516     0.024     0.469     0.562    21.678    25.774     0.000     1.445     0.619 
## poly(age, 3, raw = TRUE)1    -0.019     0.003    -0.025    -0.013    -6.007    30.147     0.000     1.205     0.574 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.340    46.945     0.736     0.779     0.460 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.693    65.926     0.009     0.586     0.388 
## male                         -0.008     0.011    -0.030     0.014    -0.736    77.058     0.464     0.519     0.358 
## sibling_count                -0.020     0.003    -0.027    -0.014    -6.481   164.271     0.000     0.306     0.243 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.663 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-4" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-1" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-5" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.512     0.024     0.465     0.559    21.550    27.271     0.000     1.350     0.603 
## birth_order                   0.004     0.005    -0.005     0.014     0.911    41.675     0.367     0.868     0.489 
## poly(age, 3, raw = TRUE)1    -0.019     0.003    -0.025    -0.013    -6.016    30.017     0.000     1.210     0.575 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.428    47.355     0.671     0.773     0.458 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.798    68.638     0.007     0.568     0.380 
## male                         -0.008     0.011    -0.030     0.014    -0.736    76.988     0.464     0.520     0.358 
## sibling_count                -0.023     0.004    -0.031    -0.015    -5.812   151.133     0.000     0.323     0.254 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.663 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-5" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-1" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-6" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.518     0.025     0.468     0.568    20.343    25.389     0.000     1.471     0.624 
## birth_order_nonlinear2        0.003     0.017    -0.029     0.036     0.201    28.728     0.842     1.271     0.587 
## birth_order_nonlinear3        0.010     0.021    -0.030     0.050     0.481    36.259     0.633     0.993     0.524 
## birth_order_nonlinear4        0.000     0.027    -0.052     0.052     0.000    39.868     1.000     0.905     0.500 
## birth_order_nonlinear5       -0.013     0.032    -0.075     0.050    -0.398    63.001     0.692     0.608     0.397 
## birth_order_nonlinear5+      -0.011     0.033    -0.076     0.055    -0.320    55.537     0.750     0.674     0.423 
## poly(age, 3, raw = TRUE)1    -0.019     0.003    -0.025    -0.012    -5.712    26.703     0.000     1.384     0.609 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.511    41.407     0.612     0.873     0.490 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.817    62.357     0.006     0.613     0.399 
## male                         -0.010     0.011    -0.032     0.011    -0.926    86.184     0.357     0.477     0.338 
## sibling_count                -0.021     0.004    -0.030    -0.013    -5.042    87.774     0.000     0.471     0.335 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.663 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-6" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-1" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-7" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.456     0.031     0.396     0.516    14.927    55.877     0.000     0.670     0.422 
## count_birth_order2/2          0.007     0.026    -0.044     0.059     0.281    29.953     0.780     1.213     0.576 
## count_birth_order1/3          0.022     0.034    -0.045     0.089     0.656    31.433     0.517     1.151     0.562 
## count_birth_order2/3          0.003     0.033    -0.060     0.067     0.101    29.760     0.920     1.222     0.577 
## count_birth_order3/3          0.030     0.031    -0.031     0.091     0.955    44.388     0.345     0.819     0.473 
## count_birth_order1/4         -0.025     0.044    -0.111     0.062    -0.563    38.067     0.577     0.946     0.511 
## count_birth_order2/4         -0.025     0.036    -0.096     0.047    -0.680    62.674     0.499     0.610     0.398 
## count_birth_order3/4         -0.046     0.033    -0.111     0.020    -1.363   141.201     0.175     0.338     0.263 
## count_birth_order4/4         -0.014     0.040    -0.092     0.063    -0.358    48.331     0.722     0.759     0.454 
## count_birth_order1/5         -0.069     0.048    -0.163     0.024    -1.450   222.650     0.148     0.252     0.208 
## count_birth_order2/5         -0.101     0.051    -0.201    -0.001    -1.976    54.202     0.053     0.688     0.428 
## count_birth_order3/5         -0.082     0.045    -0.170     0.006    -1.836   109.620     0.069     0.402     0.299 
## count_birth_order4/5         -0.092     0.058    -0.205     0.020    -1.607    27.083     0.120     1.361     0.605 
## count_birth_order5/5         -0.067     0.052    -0.169     0.035    -1.289    49.031     0.203     0.750     0.450 
## count_birth_order1/5+        -0.181     0.047    -0.273    -0.089    -3.858   109.433     0.000     0.402     0.299 
## count_birth_order2/5+        -0.187     0.046    -0.277    -0.096    -4.031    57.487     0.000     0.655     0.416 
## count_birth_order3/5+        -0.159     0.044    -0.246    -0.073    -3.609    57.400     0.001     0.656     0.416 
## count_birth_order4/5+        -0.167     0.044    -0.252    -0.081    -3.821    60.899     0.000     0.625     0.404 
## count_birth_order5/5+        -0.172     0.043    -0.257    -0.087    -3.980    56.254     0.000     0.667     0.420 
## count_birth_order5+/5+       -0.161     0.031    -0.223    -0.099    -5.117    94.930     0.000     0.445     0.322 
## poly(age, 3, raw = TRUE)1    -0.017     0.004    -0.026    -0.009    -4.161    25.632     0.000     1.454     0.621 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.314    31.359     0.756     1.154     0.563 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.189    37.688     0.035     0.956     0.514 
## male                         -0.013     0.012    -0.037     0.011    -1.054    80.590     0.295     0.502     0.350 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.663 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-7" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-1" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 621.189      13  14.790   0.000   1.132 
##  2 vs 3: 281.690       4  13.835   0.000   1.900 
##  3 vs 4:   1.326       1 124.759   0.252   0.367 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2015-old" class="section level3 tabset">
<h3>Raven 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-1" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-2" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-8" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.357     0.026     0.305     0.409    13.564    20.318     0.000     1.990     0.694 
## poly(age, 3, raw = TRUE)1    -0.011     0.003    -0.017    -0.005    -3.566    35.448     0.001     1.016     0.530 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.289    60.957     0.202     0.624     0.403 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.204    91.718     0.232     0.456     0.328 
## male                          0.046     0.011     0.024     0.069     4.065    72.485     0.000     0.544     0.370 
## sibling_count                -0.007     0.003    -0.012    -0.002    -2.804    37.827     0.008     0.952     0.513 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.701 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-8" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-2" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-9" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.361     0.027     0.308     0.415    13.227    19.392     0.000     2.137     0.710 
## birth_order                  -0.005     0.003    -0.011     0.002    -1.344    72.731     0.183     0.543     0.369 
## poly(age, 3, raw = TRUE)1    -0.011     0.003    -0.017    -0.005    -3.544    36.385     0.001     0.989     0.523 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.481    73.930     0.143     0.536     0.366 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.038   125.647     0.301     0.365     0.279 
## male                          0.046     0.011     0.024     0.069     4.066    72.418     0.000     0.544     0.370 
## sibling_count                -0.004     0.003    -0.010     0.001    -1.700   581.526     0.090     0.142     0.127 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.700 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-9" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-2" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-10" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.348     0.027     0.296     0.400    13.073    22.732     0.000     1.697     0.658 
## birth_order_nonlinear2        0.004     0.015    -0.025     0.034     0.289    72.021     0.773     0.547     0.371 
## birth_order_nonlinear3        0.023     0.017    -0.009     0.056     1.397   192.245     0.164     0.276     0.224 
## birth_order_nonlinear4       -0.006     0.025    -0.055     0.044    -0.227    40.885     0.822     0.884     0.493 
## birth_order_nonlinear5        0.000     0.025    -0.048     0.049     0.005   190.231     0.996     0.278     0.226 
## birth_order_nonlinear5+      -0.037     0.024    -0.084     0.010    -1.535   138.540     0.127     0.342     0.265 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.016    -0.004    -3.425    37.061     0.002     0.972     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.594    72.951     0.115     0.541     0.368 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.902   119.068     0.369     0.379     0.287 
## male                          0.046     0.011     0.024     0.069     4.061    73.839     0.000     0.536     0.366 
## sibling_count                -0.005     0.003    -0.010     0.000    -1.817   206.368     0.071     0.264     0.216 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.700 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-10" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-2" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-11" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.349     0.034     0.282     0.416    10.202    40.295     0.000     0.896     0.497 
## count_birth_order2/2         -0.017     0.024    -0.063     0.029    -0.719   107.396     0.474     0.407     0.302 
## count_birth_order1/3         -0.007     0.034    -0.073     0.059    -0.217    52.903     0.829     0.702     0.433 
## count_birth_order2/3         -0.015     0.035    -0.084     0.054    -0.423    40.224     0.675     0.898     0.497 
## count_birth_order3/3          0.016     0.026    -0.035     0.068     0.619  1086.841     0.536     0.100     0.093 
## count_birth_order1/4         -0.004     0.038    -0.079     0.070    -0.117   123.064     0.907     0.371     0.282 
## count_birth_order2/4          0.021     0.037    -0.051     0.093     0.575   188.516     0.566     0.280     0.227 
## count_birth_order3/4         -0.031     0.039    -0.108     0.046    -0.783    65.381     0.436     0.590     0.389 
## count_birth_order4/4         -0.008     0.036    -0.079     0.063    -0.224    96.487     0.823     0.440     0.319 
## count_birth_order1/5          0.001     0.045    -0.088     0.090     0.032   197.424     0.975     0.271     0.221 
## count_birth_order2/5          0.027     0.046    -0.063     0.117     0.578   211.009     0.564     0.260     0.214 
## count_birth_order3/5          0.039     0.046    -0.051     0.129     0.841   111.338     0.402     0.397     0.297 
## count_birth_order4/5         -0.038     0.044    -0.124     0.047    -0.883   183.622     0.378     0.284     0.230 
## count_birth_order5/5          0.024     0.053    -0.080     0.128     0.455    30.243     0.653     1.200     0.573 
## count_birth_order1/5+        -0.051     0.040    -0.129     0.026    -1.293    66.695     0.200     0.581     0.385 
## count_birth_order2/5+        -0.079     0.039    -0.156    -0.003    -2.028    75.739     0.046     0.526     0.361 
## count_birth_order3/5+        -0.040     0.039    -0.115     0.036    -1.036    67.092     0.304     0.578     0.384 
## count_birth_order4/5+        -0.074     0.040    -0.152     0.005    -1.832    45.531     0.073     0.800     0.467 
## count_birth_order5/5+        -0.081     0.035    -0.149    -0.013    -2.339   112.437     0.021     0.395     0.295 
## count_birth_order5+/5+       -0.098     0.031    -0.159    -0.037    -3.162    35.670     0.003     1.009     0.528 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.005    -3.331    44.558     0.002     0.816     0.473 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.206    89.671     0.837     0.464     0.332 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.306   126.568     0.023     0.364     0.278 
## male                          0.043     0.011     0.021     0.066     3.751   119.694     0.000     0.378     0.286 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.698 
## ICC|mother_pidlink                     0.225 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-11" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-2" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1042.333       13 2965.978    0.000    0.039 
##   2 vs 3:    4.787        4   87.638    0.002    0.352 
##   3 vs 4:    1.656        1   71.278    0.202    0.551 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-1" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-3" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-12" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.358     0.027     0.305     0.412    13.075    19.493     0.000     2.120     0.708 
## poly(age, 3, raw = TRUE)1    -0.011     0.003    -0.017    -0.005    -3.772    37.231     0.001     0.967     0.517 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.216    61.370     0.229     0.621     0.402 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.191    89.164     0.237     0.466     0.333 
## male                          0.046     0.011     0.024     0.069     4.051    71.653     0.000     0.549     0.372 
## sibling_count                -0.009     0.004    -0.016    -0.001    -2.205    35.690     0.034     1.009     0.528 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.700 
## ICC|mother_pidlink                     0.227 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-12" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-3" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-13" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.360     0.028     0.305     0.415    12.809    19.269     0.000     2.159     0.712 
## birth_order                  -0.002     0.005    -0.011     0.008    -0.373    53.286     0.711     0.698     0.432 
## poly(age, 3, raw = TRUE)1    -0.011     0.003    -0.017    -0.005    -3.771    37.503     0.001     0.960     0.515 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.261    65.859     0.212     0.586     0.388 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.158   100.442     0.250     0.427     0.313 
## male                          0.046     0.011     0.024     0.069     4.052    71.681     0.000     0.549     0.372 
## sibling_count                -0.008     0.004    -0.016     0.000    -1.922   157.546     0.056     0.314     0.248 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.700 
## ICC|mother_pidlink                     0.227 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-13" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-3" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-14" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.356     0.029     0.298     0.413    12.139    19.319     0.000     2.150     0.711 
## birth_order_nonlinear2        0.005     0.015    -0.024     0.034     0.344    57.131     0.732     0.658     0.417 
## birth_order_nonlinear3        0.010     0.024    -0.037     0.056     0.400    24.168     0.693     1.566     0.639 
## birth_order_nonlinear4       -0.008     0.027    -0.061     0.044    -0.315    43.675     0.754     0.831     0.477 
## birth_order_nonlinear5       -0.031     0.034    -0.098     0.036    -0.918    49.171     0.363     0.748     0.450 
## birth_order_nonlinear5+      -0.032     0.029    -0.089     0.024    -1.121   356.552     0.263     0.189     0.164 
## poly(age, 3, raw = TRUE)1    -0.011     0.003    -0.018    -0.005    -3.556    32.465     0.001     1.112     0.553 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.106    55.976     0.274     0.669     0.421 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.270    92.172     0.207     0.455     0.327 
## male                          0.045     0.012     0.023     0.068     3.945    77.049     0.000     0.519     0.358 
## sibling_count                -0.008     0.004    -0.016     0.000    -1.856   151.113     0.065     0.323     0.254 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.699 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-14" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-3" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-15" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.314     0.037     0.242     0.386     8.557    27.863     0.000     1.317     0.596 
## count_birth_order2/2          0.012     0.027    -0.040     0.064     0.440    32.229     0.663     1.121     0.555 
## count_birth_order1/3          0.012     0.034    -0.054     0.078     0.360    35.120     0.721     1.025     0.532 
## count_birth_order2/3         -0.000     0.034    -0.066     0.065    -0.011    28.698     0.992     1.273     0.588 
## count_birth_order3/3          0.029     0.029    -0.027     0.086     1.012    80.701     0.315     0.501     0.350 
## count_birth_order1/4         -0.015     0.035    -0.084     0.053    -0.430   395.991     0.667     0.178     0.155 
## count_birth_order2/4         -0.003     0.040    -0.082     0.076    -0.072    41.112     0.943     0.879     0.492 
## count_birth_order3/4         -0.028     0.042    -0.110     0.054    -0.666    35.364     0.510     1.018     0.530 
## count_birth_order4/4          0.001     0.039    -0.076     0.078     0.021    55.072     0.983     0.679     0.425 
## count_birth_order1/5         -0.039     0.055    -0.147     0.069    -0.706    63.140     0.483     0.607     0.396 
## count_birth_order2/5         -0.048     0.053    -0.152     0.056    -0.902    49.820     0.371     0.739     0.447 
## count_birth_order3/5         -0.034     0.047    -0.126     0.059    -0.712    81.618     0.479     0.497     0.348 
## count_birth_order4/5         -0.070     0.066    -0.199     0.058    -1.070    20.545     0.297     1.957     0.691 
## count_birth_order5/5         -0.072     0.056    -0.181     0.038    -1.285    39.280     0.206     0.918     0.503 
## count_birth_order1/5+        -0.095     0.051    -0.195     0.005    -1.868    66.483     0.066     0.582     0.386 
## count_birth_order2/5+        -0.080     0.050    -0.179     0.018    -1.593    41.328     0.119     0.875     0.491 
## count_birth_order3/5+        -0.064     0.056    -0.173     0.046    -1.137    24.327     0.267     1.553     0.637 
## count_birth_order4/5+        -0.089     0.046    -0.180     0.001    -1.943    49.720     0.058     0.741     0.447 
## count_birth_order5/5+        -0.097     0.043    -0.182    -0.012    -2.232    62.168     0.029     0.614     0.399 
## count_birth_order5+/5+       -0.095     0.034    -0.163    -0.028    -2.777    56.371     0.007     0.665     0.420 
## poly(age, 3, raw = TRUE)1    -0.009     0.004    -0.016    -0.001    -2.270    36.010     0.029     1.000     0.526 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.213    49.221     0.231     0.747     0.450 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.906    57.502     0.369     0.655     0.416 
## male                          0.047     0.013     0.022     0.072     3.714    71.712     0.000     0.549     0.372 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.698 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-15" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-3" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 711.480      13  18.661   0.000   0.896 
##  2 vs 3: 376.298       4  19.212   0.000   1.252 
##  3 vs 4:   0.176       1  92.025   0.676   0.455 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-1" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2015-old" class="section level3 tabset">
<h3>Numeracy 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-2" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-4" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-16" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.345     0.022     0.302     0.389    15.558    34.958     0.000     1.030     0.533 
## poly(age, 3, raw = TRUE)1    -0.009     0.003    -0.015    -0.003    -3.104    55.750     0.003     0.672     0.422 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.255    82.645     0.799     0.493     0.346 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.227    82.458     0.223     0.493     0.346 
## male                         -0.066     0.012    -0.091    -0.042    -5.382    56.651     0.000     0.663     0.419 
## sibling_count                -0.016     0.002    -0.021    -0.012    -7.431    91.565     0.000     0.457     0.328 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.171 
## Residual~~Residual                     0.783 
## ICC|mother_pidlink                     0.179 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-16" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-4" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-17" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.347     0.023     0.301     0.392    14.933    31.104     0.000     1.164     0.565 
## birth_order                  -0.001     0.004    -0.010     0.007    -0.288    28.358     0.776     1.290     0.591 
## poly(age, 3, raw = TRUE)1    -0.009     0.003    -0.015    -0.003    -3.097    56.440     0.003     0.665     0.420 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.293    79.077     0.770     0.509     0.354 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.167    79.724     0.247     0.506     0.352 
## male                         -0.066     0.012    -0.091    -0.042    -5.382    56.664     0.000     0.663     0.419 
## sibling_count                -0.016     0.003    -0.022    -0.009    -4.530    39.884     0.000     0.905     0.500 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.171 
## Residual~~Residual                     0.783 
## ICC|mother_pidlink                     0.179 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-17" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-4" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-18" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.341     0.023     0.296     0.386    14.782    38.946     0.000     0.926     0.505 
## birth_order_nonlinear2        0.004     0.020    -0.035     0.042     0.180    26.401     0.859     1.403     0.612 
## birth_order_nonlinear3        0.014     0.020    -0.025     0.054     0.707    51.432     0.482     0.719     0.440 
## birth_order_nonlinear4        0.005     0.028    -0.049     0.059     0.176    33.179     0.861     1.087     0.547 
## birth_order_nonlinear5        0.015     0.033    -0.049     0.079     0.458    35.280     0.650     1.021     0.531 
## birth_order_nonlinear5+      -0.005     0.030    -0.064     0.054    -0.168    39.120     0.868     0.922     0.504 
## poly(age, 3, raw = TRUE)1    -0.009     0.003    -0.014    -0.003    -3.125    68.315     0.003     0.570     0.381 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.342   114.970     0.733     0.388     0.292 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.182   124.516     0.239     0.368     0.280 
## male                         -0.067     0.012    -0.091    -0.042    -5.391    56.632     0.000     0.663     0.419 
## sibling_count                -0.016     0.003    -0.023    -0.010    -4.922    40.247     0.000     0.897     0.497 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.170 
## Residual~~Residual                     0.783 
## ICC|mother_pidlink                     0.179 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-18" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-4" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-19" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.300     0.038     0.226     0.374     7.943    30.864     0.000     1.174     0.567 
## count_birth_order2/2          0.007     0.026    -0.044     0.059     0.277    70.210     0.782     0.558     0.376 
## count_birth_order1/3          0.027     0.037    -0.046     0.100     0.724    37.397     0.474     0.963     0.516 
## count_birth_order2/3         -0.014     0.038    -0.088     0.059    -0.383    36.007     0.704     1.000     0.526 
## count_birth_order3/3          0.010     0.031    -0.051     0.072     0.327    87.351     0.744     0.473     0.336 
## count_birth_order1/4         -0.026     0.036    -0.096     0.045    -0.717   525.422     0.474     0.151     0.134 
## count_birth_order2/4         -0.035     0.039    -0.111     0.042    -0.888   135.569     0.376     0.347     0.268 
## count_birth_order3/4         -0.033     0.043    -0.118     0.052    -0.762    45.983     0.450     0.793     0.465 
## count_birth_order4/4         -0.024     0.040    -0.102     0.053    -0.614    61.604     0.542     0.619     0.401 
## count_birth_order1/5         -0.046     0.050    -0.145     0.053    -0.909    91.192     0.366     0.458     0.329 
## count_birth_order2/5         -0.037     0.051    -0.137     0.062    -0.734    99.239     0.464     0.431     0.315 
## count_birth_order3/5          0.008     0.046    -0.083     0.098     0.166   153.759     0.868     0.319     0.252 
## count_birth_order4/5         -0.032     0.052    -0.134     0.070    -0.609    52.459     0.545     0.707     0.435 
## count_birth_order5/5          0.015     0.048    -0.080     0.109     0.304    53.091     0.762     0.700     0.433 
## count_birth_order1/5+        -0.125     0.037    -0.198    -0.052    -3.357   177.737     0.001     0.290     0.234 
## count_birth_order2/5+        -0.151     0.039    -0.228    -0.075    -3.868   106.411     0.000     0.410     0.304 
## count_birth_order3/5+        -0.144     0.044    -0.230    -0.058    -3.280    39.719     0.002     0.908     0.501 
## count_birth_order4/5+        -0.135     0.039    -0.211    -0.058    -3.448    66.244     0.001     0.584     0.387 
## count_birth_order5/5+        -0.138     0.036    -0.209    -0.067    -3.797   104.284     0.000     0.416     0.307 
## count_birth_order5+/5+       -0.150     0.026    -0.201    -0.099    -5.773   131.166     0.000     0.355     0.273 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014    -0.000    -2.024    84.459     0.046     0.485     0.342 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.308   148.719     0.759     0.326     0.256 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.754    97.927     0.453     0.435     0.317 
## male                         -0.075     0.014    -0.102    -0.048    -5.429    43.247     0.000     0.839     0.480 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-19" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-4" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 919.813      13 185.904   0.000   0.176 
##  2 vs 3:   2.172       4  21.609   0.106   1.102 
##  3 vs 4:   0.391       1  74.516   0.534   0.533 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-2" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-5" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-20" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.347     0.023     0.303     0.391    15.375    35.392     0.000     1.017     0.530 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.016    -0.005    -3.572    57.618     0.001     0.654     0.415 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.061    85.352     0.951     0.481     0.340 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.194    82.292     0.236     0.494     0.346 
## male                         -0.067     0.012    -0.091    -0.042    -5.383    55.332     0.000     0.676     0.424 
## sibling_count                -0.018     0.003    -0.025    -0.012    -5.834   170.162     0.000     0.299     0.239 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.782 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-20" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-5" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-21" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.342     0.024     0.295     0.390    14.240    29.985     0.000     1.212     0.575 
## birth_order                   0.006     0.006    -0.007     0.018     0.869    22.433     0.394     1.728     0.662 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.016    -0.005    -3.589    57.144     0.001     0.658     0.417 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.043    75.127     0.966     0.529     0.363 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.282    72.700     0.204     0.543     0.369 
## male                         -0.067     0.012    -0.091    -0.042    -5.386    55.456     0.000     0.675     0.423 
## sibling_count                -0.022     0.005    -0.030    -0.013    -4.773    59.513     0.000     0.636     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.782 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-21" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-5" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-22" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.346     0.025     0.297     0.396    13.644    29.354     0.000     1.241     0.581 
## birth_order_nonlinear2        0.007     0.024    -0.039     0.053     0.283    16.237     0.781     2.914     0.771 
## birth_order_nonlinear3        0.021     0.023    -0.023     0.065     0.922    32.551     0.363     1.109     0.552 
## birth_order_nonlinear4        0.014     0.032    -0.049     0.077     0.432    26.803     0.669     1.378     0.608 
## birth_order_nonlinear5        0.001     0.034    -0.066     0.068     0.028    65.480     0.978     0.589     0.389 
## birth_order_nonlinear5+       0.000     0.047    -0.092     0.092     0.007    21.160     0.995     1.875     0.681 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.016    -0.005    -3.528    60.075     0.001     0.631     0.406 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.086    93.965     0.932     0.448     0.324 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.352    95.812     0.180     0.442     0.321 
## male                         -0.067     0.013    -0.092    -0.042    -5.358    57.920     0.000     0.651     0.414 
## sibling_count                -0.020     0.004    -0.029    -0.012    -4.572    67.684     0.000     0.574     0.383 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-22" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-5" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-23" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.292     0.035     0.224     0.360     8.402    37.005     0.000     0.973     0.519 
## count_birth_order2/2          0.013     0.028    -0.042     0.068     0.456    30.815     0.652     1.176     0.568 
## count_birth_order1/3          0.016     0.031    -0.045     0.078     0.517    60.247     0.607     0.630     0.406 
## count_birth_order2/3         -0.009     0.036    -0.079     0.061    -0.251    26.764     0.803     1.380     0.608 
## count_birth_order3/3          0.024     0.034    -0.043     0.090     0.700    39.092     0.488     0.922     0.505 
## count_birth_order1/4         -0.033     0.045    -0.122     0.056    -0.727    42.758     0.471     0.848     0.482 
## count_birth_order2/4         -0.043     0.039    -0.121     0.034    -1.098    53.307     0.277     0.697     0.432 
## count_birth_order3/4         -0.030     0.034    -0.098     0.037    -0.884   210.239     0.378     0.261     0.214 
## count_birth_order4/4         -0.011     0.047    -0.102     0.080    -0.237    30.530     0.814     1.188     0.570 
## count_birth_order1/5         -0.076     0.049    -0.173     0.021    -1.535   338.038     0.126     0.195     0.168 
## count_birth_order2/5         -0.114     0.049    -0.209    -0.018    -2.326   125.196     0.022     0.366     0.280 
## count_birth_order3/5         -0.079     0.051    -0.178     0.021    -1.554    62.865     0.125     0.609     0.397 
## count_birth_order4/5         -0.104     0.055    -0.211     0.003    -1.902    40.198     0.064     0.898     0.498 
## count_birth_order5/5         -0.070     0.055    -0.178     0.038    -1.271    50.745     0.209     0.728     0.443 
## count_birth_order1/5+        -0.213     0.054    -0.318    -0.107    -3.958    60.541     0.000     0.628     0.405 
## count_birth_order2/5+        -0.163     0.058    -0.278    -0.049    -2.793    27.133     0.009     1.358     0.604 
## count_birth_order3/5+        -0.143     0.047    -0.236    -0.050    -3.025    53.204     0.004     0.699     0.432 
## count_birth_order4/5+        -0.118     0.040    -0.198    -0.039    -2.936   231.954     0.004     0.245     0.204 
## count_birth_order5/5+        -0.140     0.040    -0.219    -0.061    -3.480   174.583     0.001     0.294     0.236 
## count_birth_order5+/5+       -0.146     0.043    -0.231    -0.061    -3.352    24.264     0.003     1.558     0.638 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.016    -0.001    -2.236    49.697     0.030     0.741     0.447 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.139    69.155     0.890     0.564     0.378 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.077    79.057     0.285     0.509     0.354 
## male                         -0.071     0.015    -0.100    -0.043    -4.878    41.199     0.000     0.878     0.491 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-23" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-5" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 648.460      13  14.981   0.000   1.117 
##  2 vs 3: 260.245       4  12.639   0.000   2.179 
##  3 vs 4:   1.193       1  38.211   0.282   0.943 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-2" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
</div>
<div id="counting-backwards" class="section level3 tabset">
<h3>Counting Backwards</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = count_backwards)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-3" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-6" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-24" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.137     0.022     0.094     0.179     6.236    39.727     0.000     0.908     0.500 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.004     0.007     0.581    64.028     0.563     0.600     0.394 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.147   178.027     0.033     0.290     0.233 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.390   268.812     0.166     0.224     0.189 
## male                          0.005     0.012    -0.018     0.029     0.434    80.971     0.666     0.500     0.349 
## sibling_count                -0.015     0.002    -0.020    -0.011    -6.500    59.979     0.000     0.632     0.407 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.830 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-24" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-6" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-25" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.137     0.022     0.094     0.179     6.313    44.524     0.000     0.817     0.473 
## birth_order                   0.000     0.004    -0.008     0.009     0.008    30.090     0.994     1.207     0.574 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.004     0.007     0.581    64.325     0.563     0.598     0.393 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.174   239.193     0.031     0.241     0.201 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.419   498.420     0.157     0.155     0.138 
## male                          0.005     0.012    -0.018     0.029     0.434    80.909     0.666     0.500     0.349 
## sibling_count                -0.015     0.003    -0.022    -0.009    -4.483    45.491     0.000     0.801     0.468 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.830 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-25" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-6" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-26" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.138     0.023     0.093     0.183     6.022    42.931     0.000     0.845     0.481 
## birth_order_nonlinear2       -0.001     0.017    -0.035     0.033    -0.061    49.232     0.951     0.747     0.449 
## birth_order_nonlinear3       -0.018     0.020    -0.057     0.022    -0.869    57.567     0.388     0.654     0.415 
## birth_order_nonlinear4       -0.016     0.028    -0.071     0.039    -0.561    33.330     0.579     1.082     0.546 
## birth_order_nonlinear5       -0.023     0.032    -0.086     0.040    -0.703    41.023     0.486     0.881     0.493 
## birth_order_nonlinear5+      -0.020     0.033    -0.086     0.045    -0.611    28.570     0.546     1.279     0.589 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.004     0.007     0.574    60.815     0.568     0.625     0.404 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.181   170.660     0.031     0.298     0.239 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.434   259.113     0.153     0.229     0.193 
## male                          0.005     0.012    -0.018     0.029     0.437    79.177     0.663     0.509     0.353 
## sibling_count                -0.013     0.003    -0.020    -0.007    -3.990    39.167     0.000     0.921     0.504 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.829 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-26" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-6" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-27" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.103     0.035     0.035     0.172     2.953    44.397     0.005     0.819     0.473 
## count_birth_order2/2          0.001     0.030    -0.058     0.060     0.044    37.854     0.965     0.952     0.513 
## count_birth_order1/3          0.010     0.031    -0.051     0.071     0.320   144.669     0.749     0.332     0.260 
## count_birth_order2/3         -0.011     0.031    -0.072     0.049    -0.368   154.210     0.713     0.319     0.251 
## count_birth_order3/3         -0.020     0.036    -0.090     0.051    -0.541    40.996     0.591     0.882     0.493 
## count_birth_order1/4          0.041     0.043    -0.042     0.125     0.965    68.405     0.338     0.569     0.381 
## count_birth_order2/4          0.000     0.042    -0.082     0.083     0.003    75.771     0.998     0.526     0.361 
## count_birth_order3/4         -0.030     0.041    -0.109     0.050    -0.731    76.908     0.467     0.520     0.359 
## count_birth_order4/4         -0.008     0.041    -0.088     0.071    -0.205    59.907     0.838     0.633     0.407 
## count_birth_order1/5          0.001     0.047    -0.091     0.092     0.014   285.304     0.989     0.216     0.183 
## count_birth_order2/5          0.042     0.057    -0.070     0.154     0.738    49.132     0.464     0.748     0.450 
## count_birth_order3/5         -0.000     0.048    -0.094     0.093    -0.007   129.398     0.994     0.358     0.275 
## count_birth_order4/5         -0.033     0.051    -0.133     0.067    -0.652    66.855     0.517     0.580     0.385 
## count_birth_order5/5         -0.027     0.044    -0.113     0.059    -0.621   123.225     0.536     0.370     0.282 
## count_birth_order1/5+        -0.055     0.042    -0.136     0.027    -1.315    69.899     0.193     0.560     0.376 
## count_birth_order2/5+        -0.074     0.038    -0.148    -0.001    -1.978   211.611     0.049     0.260     0.214 
## count_birth_order3/5+        -0.104     0.040    -0.182    -0.026    -2.603    76.363     0.011     0.523     0.360 
## count_birth_order4/5+        -0.104     0.040    -0.182    -0.026    -2.620    65.911     0.011     0.586     0.388 
## count_birth_order5/5+        -0.104     0.039    -0.181    -0.027    -2.661    64.951     0.010     0.593     0.391 
## count_birth_order5+/5+       -0.113     0.028    -0.169    -0.058    -4.013    69.522     0.000     0.562     0.377 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.007     0.010     0.372    30.381     0.712     1.194     0.572 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.321    40.093     0.194     0.900     0.498 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.825    47.599     0.413     0.769     0.457 
## male                          0.000     0.013    -0.025     0.026     0.026    73.170     0.980     0.540     0.368 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.160 
## Residual~~Residual                     0.827 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-27" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-6" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 940.558      13 177.578   0.000   0.181 
##  2 vs 3:   2.829       4  28.397   0.043   0.843 
##  3 vs 4:   0.204       1  71.077   0.653   0.552 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-3" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-7" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-28" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.140     0.022     0.097     0.183     6.380    42.476     0.000     0.853     0.484 
## poly(age, 3, raw = TRUE)1     0.001     0.003    -0.005     0.006     0.237    61.114     0.814     0.623     0.403 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -1.974   175.097     0.050     0.293     0.235 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.408   264.505     0.160     0.226     0.191 
## male                          0.005     0.012    -0.019     0.029     0.414    79.665     0.680     0.506     0.352 
## sibling_count                -0.019     0.004    -0.026    -0.011    -4.840    39.356     0.000     0.916     0.503 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.161 
## Residual~~Residual                     0.829 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-28" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-7" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-29" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.142     0.022     0.099     0.184     6.555    50.212     0.000     0.734     0.445 
## birth_order                  -0.002     0.005    -0.013     0.008    -0.407    45.844     0.686     0.796     0.466 
## poly(age, 3, raw = TRUE)1     0.001     0.003    -0.005     0.006     0.244    60.604     0.808     0.627     0.405 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.026   200.197     0.044     0.269     0.220 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.474   370.122     0.141     0.185     0.160 
## male                          0.005     0.012    -0.019     0.029     0.414    79.582     0.680     0.507     0.352 
## sibling_count                -0.017     0.004    -0.026    -0.009    -3.884    67.586     0.000     0.575     0.383 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.161 
## Residual~~Residual                     0.829 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-29" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-7" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-30" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.146     0.023     0.101     0.191     6.405    48.624     0.000     0.755     0.452 
## birth_order_nonlinear2       -0.015     0.017    -0.047     0.018    -0.879    41.846     0.384     0.865     0.488 
## birth_order_nonlinear3       -0.023     0.020    -0.063     0.017    -1.144    60.924     0.257     0.624     0.404 
## birth_order_nonlinear4       -0.023     0.032    -0.085     0.039    -0.726    29.430     0.473     1.237     0.581 
## birth_order_nonlinear5       -0.030     0.034    -0.096     0.037    -0.872    80.807     0.386     0.501     0.350 
## birth_order_nonlinear5+      -0.032     0.038    -0.107     0.042    -0.847    46.290     0.401     0.789     0.464 
## poly(age, 3, raw = TRUE)1     0.000     0.003    -0.005     0.006     0.128    60.158     0.899     0.631     0.406 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.779   130.685     0.078     0.356     0.273 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.240   175.195     0.217     0.293     0.235 
## male                          0.004     0.012    -0.020     0.028     0.344    72.759     0.732     0.543     0.369 
## sibling_count                -0.016     0.005    -0.025    -0.007    -3.383    56.779     0.001     0.661     0.418 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.160 
## Residual~~Residual                     0.829 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-30" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-7" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-31" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.097     0.035     0.027     0.166     2.733    36.643     0.010     0.983     0.521 
## count_birth_order2/2         -0.003     0.030    -0.062     0.057    -0.096    26.327     0.924     1.408     0.613 
## count_birth_order1/3          0.025     0.031    -0.036     0.086     0.811    72.357     0.420     0.545     0.370 
## count_birth_order2/3         -0.014     0.028    -0.070     0.041    -0.502    89.306     0.617     0.465     0.332 
## count_birth_order3/3         -0.009     0.034    -0.076     0.058    -0.258    39.786     0.798     0.907     0.500 
## count_birth_order1/4          0.010     0.052    -0.091     0.112     0.201    28.059     0.842     1.306     0.594 
## count_birth_order2/4         -0.014     0.038    -0.088     0.060    -0.370    83.892     0.712     0.487     0.343 
## count_birth_order3/4         -0.045     0.040    -0.123     0.032    -1.149    61.346     0.255     0.621     0.402 
## count_birth_order4/4         -0.029     0.035    -0.097     0.040    -0.820   391.977     0.413     0.179     0.156 
## count_birth_order1/5         -0.008     0.064    -0.133     0.118    -0.118    38.955     0.907     0.926     0.505 
## count_birth_order2/5         -0.067     0.053    -0.170     0.036    -1.273    75.387     0.207     0.528     0.362 
## count_birth_order3/5         -0.088     0.046    -0.177     0.002    -1.925   215.042     0.056     0.257     0.212 
## count_birth_order4/5         -0.046     0.055    -0.154     0.062    -0.828    42.282     0.412     0.857     0.485 
## count_birth_order5/5         -0.061     0.060    -0.178     0.055    -1.028    38.002     0.310     0.948     0.512 
## count_birth_order1/5+        -0.102     0.057    -0.213     0.009    -1.799    49.481     0.078     0.744     0.448 
## count_birth_order2/5+        -0.149     0.048    -0.243    -0.054    -3.094    74.292     0.003     0.534     0.365 
## count_birth_order3/5+        -0.116     0.049    -0.212    -0.021    -2.388    49.733     0.021     0.740     0.447 
## count_birth_order4/5+        -0.149     0.063    -0.272    -0.026    -2.382    21.036     0.027     1.891     0.683 
## count_birth_order5/5+        -0.129     0.050    -0.227    -0.030    -2.569    38.707     0.014     0.931     0.507 
## count_birth_order5+/5+       -0.134     0.038    -0.208    -0.059    -3.492    38.642     0.001     0.933     0.507 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.387    34.756     0.701     1.036     0.535 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.527    49.453     0.133     0.744     0.448 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.137    67.365     0.260     0.576     0.384 
## male                          0.003     0.013    -0.022     0.029     0.253    90.163     0.801     0.462     0.331 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.160 
## Residual~~Residual                     0.828 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-31" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-7" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 765.914      13  20.538   0.000   0.820 
##  2 vs 3: 275.413       4  12.754   0.000   2.148 
##  3 vs 4:   0.284       1  95.525   0.595   0.443 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-3" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
</div>
</div>
<div id="delayed-word-recall" class="section level3 tabset">
<h3>Delayed Word Recall</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = words_delayed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-4" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-8" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-32" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.541     0.028     0.486     0.595    19.371    17.501     0.000     2.535     0.745 
## poly(age, 3, raw = TRUE)1    -0.025     0.003    -0.031    -0.018    -7.780    29.924     0.000     1.214     0.576 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.571    41.576     0.124     0.870     0.489 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.066    48.914     0.004     0.751     0.451 
## male                         -0.040     0.010    -0.060    -0.019    -3.798   188.879     0.000     0.279     0.226 
## sibling_count                -0.008     0.002    -0.011    -0.004    -3.710    85.826     0.000     0.479     0.339 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-32" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-8" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-33" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.540     0.029     0.484     0.596    18.886    17.177     0.000     2.621     0.751 
## birth_order                   0.001     0.004    -0.006     0.008     0.261    50.406     0.795     0.732     0.444 
## poly(age, 3, raw = TRUE)1    -0.025     0.003    -0.031    -0.018    -7.830    30.534     0.000     1.188     0.570 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.613    44.730     0.114     0.813     0.472 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.110    52.070     0.003     0.712     0.437 
## male                         -0.040     0.010    -0.060    -0.019    -3.798   188.378     0.000     0.280     0.227 
## sibling_count                -0.008     0.003    -0.014    -0.002    -2.594    47.659     0.013     0.769     0.457 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-33" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-8" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-34" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.533     0.027     0.480     0.586    19.697    20.863     0.000     1.914     0.686 
## birth_order_nonlinear2        0.012     0.016    -0.019     0.042     0.767    66.395     0.446     0.583     0.386 
## birth_order_nonlinear3        0.009     0.020    -0.030     0.049     0.472    46.429     0.639     0.787     0.463 
## birth_order_nonlinear4        0.013     0.025    -0.036     0.062     0.535    44.684     0.595     0.814     0.472 
## birth_order_nonlinear5        0.010     0.027    -0.042     0.063     0.391    91.744     0.697     0.456     0.328 
## birth_order_nonlinear5+      -0.006     0.028    -0.060     0.048    -0.218    49.154     0.828     0.748     0.450 
## poly(age, 3, raw = TRUE)1    -0.024     0.003    -0.031    -0.018    -7.782    31.218     0.000     1.159     0.564 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.492    45.248     0.143     0.805     0.469 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.970    52.797     0.004     0.703     0.434 
## male                         -0.040     0.010    -0.060    -0.019    -3.807   183.318     0.000     0.285     0.230 
## sibling_count                -0.007     0.003    -0.013    -0.002    -2.510    57.956     0.015     0.650     0.414 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-34" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-8" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-35" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.535     0.033     0.470     0.601    15.987    40.892     0.000     0.884     0.493 
## count_birth_order2/2          0.001     0.031    -0.060     0.062     0.031    29.183     0.975     1.249     0.583 
## count_birth_order1/3          0.016     0.035    -0.053     0.084     0.450    40.826     0.655     0.885     0.494 
## count_birth_order2/3          0.008     0.028    -0.047     0.063     0.272   290.107     0.786     0.214     0.182 
## count_birth_order3/3          0.008     0.030    -0.050     0.066     0.263   101.386     0.793     0.424     0.311 
## count_birth_order1/4          0.010     0.043    -0.073     0.094     0.244    47.316     0.808     0.773     0.459 
## count_birth_order2/4          0.044     0.039    -0.031     0.120     1.145    96.426     0.255     0.440     0.319 
## count_birth_order3/4         -0.002     0.035    -0.070     0.066    -0.052   231.468     0.959     0.246     0.204 
## count_birth_order4/4          0.003     0.037    -0.069     0.074     0.072    81.699     0.943     0.497     0.348 
## count_birth_order1/5         -0.029     0.047    -0.121     0.062    -0.627   130.762     0.532     0.356     0.273 
## count_birth_order2/5          0.010     0.049    -0.086     0.105     0.200   101.439     0.842     0.424     0.311 
## count_birth_order3/5          0.002     0.048    -0.092     0.095     0.036    75.652     0.971     0.527     0.362 
## count_birth_order4/5         -0.005     0.039    -0.082     0.072    -0.127  2964.799     0.899     0.058     0.056 
## count_birth_order5/5          0.012     0.041    -0.068     0.093     0.301   132.166     0.764     0.353     0.272 
## count_birth_order1/5+        -0.039     0.040    -0.118     0.040    -0.959    57.323     0.341     0.656     0.416 
## count_birth_order2/5+        -0.058     0.035    -0.127     0.012    -1.632   232.215     0.104     0.245     0.204 
## count_birth_order3/5+        -0.051     0.039    -0.127     0.025    -1.307    59.690     0.196     0.635     0.408 
## count_birth_order4/5+        -0.035     0.035    -0.104     0.033    -1.008   119.941     0.316     0.377     0.286 
## count_birth_order5/5+        -0.050     0.031    -0.111     0.010    -1.623   866.412     0.105     0.113     0.104 
## count_birth_order5+/5+       -0.063     0.027    -0.116    -0.011    -2.372    65.016     0.021     0.593     0.391 
## poly(age, 3, raw = TRUE)1    -0.028     0.004    -0.037    -0.020    -6.750    30.259     0.000     1.200     0.573 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.169    35.962     0.037     1.001     0.526 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.127    49.775     0.003     0.740     0.447 
## male                         -0.044     0.011    -0.066    -0.023    -4.118   350.020     0.000     0.191     0.165 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-35" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-8" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:  987.677       13 1093.333    0.000    0.066 
##   2 vs 3:    3.133        4   38.592    0.025    0.645 
##   3 vs 4:    0.482        1  618.456    0.488    0.137 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-4" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-9" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-36" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.541     0.029     0.484     0.598    18.632    16.918     0.000     2.695     0.757 
## poly(age, 3, raw = TRUE)1    -0.025     0.003    -0.031    -0.019    -8.160    31.717     0.000     1.140     0.560 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.673    42.543     0.102     0.852     0.484 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.038    48.335     0.004     0.759     0.454 
## male                         -0.040     0.010    -0.060    -0.019    -3.810   186.289     0.000     0.282     0.228 
## sibling_count                -0.008     0.003    -0.015    -0.001    -2.397    50.269     0.020     0.733     0.445 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.758 
## ICC|mother_pidlink                     0.131 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-36" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-9" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-37" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.537     0.029     0.479     0.594    18.283    17.078     0.000     2.649     0.753 
## birth_order                   0.005     0.005    -0.004     0.015     1.069    49.554     0.290     0.743     0.448 
## poly(age, 3, raw = TRUE)1    -0.025     0.003    -0.031    -0.019    -8.169    31.628     0.000     1.143     0.560 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.735    40.661     0.090     0.888     0.495 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.077    44.910     0.004     0.810     0.471 
## male                         -0.040     0.010    -0.060    -0.019    -3.812   187.457     0.000     0.281     0.227 
## sibling_count                -0.011     0.004    -0.020    -0.002    -2.444    42.355     0.019     0.855     0.485 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.758 
## ICC|mother_pidlink                     0.131 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-37" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-9" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-38" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.541     0.029     0.483     0.598    18.353    18.383     0.000     2.330     0.728 
## birth_order_nonlinear2        0.007     0.016    -0.025     0.038     0.411    40.694     0.683     0.888     0.495 
## birth_order_nonlinear3        0.018     0.020    -0.021     0.056     0.897    55.213     0.374     0.677     0.424 
## birth_order_nonlinear4        0.004     0.025    -0.044     0.052     0.146    85.142     0.884     0.482     0.340 
## birth_order_nonlinear5       -0.012     0.034    -0.079     0.055    -0.352    55.169     0.726     0.678     0.424 
## birth_order_nonlinear5+       0.010     0.035    -0.058     0.079     0.298    56.588     0.767     0.663     0.419 
## poly(age, 3, raw = TRUE)1    -0.026     0.003    -0.032    -0.019    -7.758    27.724     0.000     1.324     0.598 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.749    37.141     0.089     0.970     0.518 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.081    43.977     0.004     0.826     0.476 
## male                         -0.042     0.011    -0.063    -0.021    -3.945   192.631     0.000     0.276     0.224 
## sibling_count                -0.009     0.004    -0.018    -0.001    -2.096    46.714     0.041     0.782     0.462 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-38" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-9" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-39" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.531     0.033     0.467     0.595    16.183    37.904     0.000     0.950     0.512 
## count_birth_order2/2         -0.003     0.031    -0.064     0.059    -0.085    21.333     0.933     1.853     0.678 
## count_birth_order1/3          0.018     0.035    -0.050     0.087     0.524    30.481     0.604     1.190     0.571 
## count_birth_order2/3          0.023     0.026    -0.028     0.074     0.898   112.782     0.371     0.394     0.295 
## count_birth_order3/3          0.027     0.030    -0.032     0.086     0.909    58.319     0.367     0.647     0.413 
## count_birth_order1/4         -0.000     0.048    -0.094     0.094    -0.006    29.580     0.995     1.230     0.579 
## count_birth_order2/4          0.004     0.035    -0.064     0.071     0.108   103.371     0.914     0.419     0.308 
## count_birth_order3/4         -0.011     0.038    -0.085     0.064    -0.281    55.031     0.780     0.679     0.425 
## count_birth_order4/4         -0.008     0.035    -0.076     0.060    -0.239   153.390     0.812     0.320     0.252 
## count_birth_order1/5         -0.059     0.049    -0.155     0.038    -1.196   188.143     0.233     0.280     0.227 
## count_birth_order2/5         -0.028     0.046    -0.118     0.061    -0.616   171.816     0.539     0.297     0.238 
## count_birth_order3/5         -0.014     0.047    -0.107     0.078    -0.305    77.663     0.761     0.516     0.357 
## count_birth_order4/5         -0.034     0.054    -0.141     0.073    -0.620    34.416     0.539     1.047     0.537 
## count_birth_order5/5          0.011     0.054    -0.095     0.117     0.207    45.788     0.837     0.796     0.466 
## count_birth_order1/5+        -0.073     0.051    -0.174     0.027    -1.432    63.418     0.157     0.604     0.395 
## count_birth_order2/5+        -0.079     0.040    -0.156    -0.002    -2.000   423.372     0.046     0.171     0.150 
## count_birth_order3/5+        -0.044     0.042    -0.126     0.038    -1.053    91.454     0.295     0.457     0.328 
## count_birth_order4/5+        -0.058     0.040    -0.138     0.021    -1.445   126.194     0.151     0.364     0.278 
## count_birth_order5/5+        -0.097     0.044    -0.184    -0.011    -2.199    53.013     0.032     0.701     0.433 
## count_birth_order5+/5+       -0.048     0.029    -0.105     0.009    -1.656   180.552     0.099     0.287     0.232 
## poly(age, 3, raw = TRUE)1    -0.027     0.004    -0.035    -0.019    -6.598    26.055     0.000     1.426     0.616 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.785    25.355     0.086     1.474     0.624 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.639    25.213     0.014     1.484     0.626 
## male                         -0.047     0.012    -0.071    -0.023    -3.904   118.203     0.000     0.381     0.288 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.113 
## Residual~~Residual                     0.758 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-39" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-9" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 628.629      13  14.928   0.000   1.121 
##  2 vs 3: 382.713       4  20.526   0.000   1.164 
##  3 vs 4:   0.972       1  50.143   0.329   0.735 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-4" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
</div>
</div>
<div id="adaptive-numbering" class="section level3 tabset">
<h3>Adaptive Numbering</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = adaptive_numbering)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-5" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-10" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-40" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.324     0.027     0.271     0.378    11.981    19.751     0.000     2.077     0.704 
## poly(age, 3, raw = TRUE)1    -0.015     0.003    -0.022    -0.009    -4.612    29.141     0.000     1.251     0.583 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.675    49.237     0.010     0.747     0.449 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.024    61.943     0.000     0.616     0.400 
## male                          0.027     0.011     0.005     0.049     2.382   115.890     0.019     0.386     0.291 
## sibling_count                -0.016     0.002    -0.020    -0.011    -7.527    89.515     0.000     0.464     0.332 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.841 
## ICC|mother_pidlink                     0.112 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-40" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-10" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-41" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.321     0.028     0.266     0.376    11.504    19.072     0.000     2.194     0.715 
## birth_order                   0.004     0.004    -0.003     0.011     1.120    79.989     0.266     0.505     0.351 
## poly(age, 3, raw = TRUE)1    -0.015     0.003    -0.022    -0.009    -4.654    29.481     0.000     1.235     0.580 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.789    51.205     0.007     0.722     0.441 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.134    63.383     0.000     0.605     0.396 
## male                          0.027     0.011     0.005     0.049     2.380   115.805     0.019     0.387     0.291 
## sibling_count                -0.018     0.003    -0.023    -0.012    -6.314   124.487     0.000     0.368     0.280 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.841 
## ICC|mother_pidlink                     0.112 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-41" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-10" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-42" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.316     0.028     0.260     0.371    11.086    20.431     0.000     1.974     0.692 
## birth_order_nonlinear2        0.021     0.018    -0.014     0.057     1.167    36.296     0.251     0.992     0.524 
## birth_order_nonlinear3        0.020     0.022    -0.022     0.063     0.945    39.729     0.350     0.908     0.500 
## birth_order_nonlinear4       -0.002     0.026    -0.052     0.048    -0.078    48.590     0.938     0.756     0.452 
## birth_order_nonlinear5        0.022     0.028    -0.033     0.078     0.784    84.245     0.435     0.486     0.342 
## birth_order_nonlinear5+       0.021     0.028    -0.035     0.077     0.745    55.945     0.460     0.670     0.421 
## poly(age, 3, raw = TRUE)1    -0.015     0.003    -0.022    -0.009    -4.533    29.095     0.000     1.253     0.584 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.614    48.579     0.012     0.756     0.453 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.897    58.659     0.000     0.644     0.411 
## male                          0.027     0.011     0.004     0.049     2.351   109.869     0.021     0.401     0.299 
## sibling_count                -0.017     0.003    -0.022    -0.012    -6.552   252.734     0.000     0.233     0.195 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.841 
## ICC|mother_pidlink                     0.112 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-42" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-10" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-43" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.286     0.043     0.202     0.370     6.699    21.194     0.000     1.871     0.680 
## count_birth_order2/2          0.011     0.030    -0.048     0.069     0.363    38.911     0.718     0.927     0.506 
## count_birth_order1/3          0.003     0.032    -0.059     0.065     0.093    95.342     0.926     0.444     0.321 
## count_birth_order2/3          0.011     0.037    -0.062     0.084     0.285    36.171     0.777     0.995     0.524 
## count_birth_order3/3          0.026     0.031    -0.036     0.087     0.818    85.173     0.415     0.482     0.340 
## count_birth_order1/4         -0.030     0.035    -0.099     0.039    -0.844   719.877     0.399     0.126     0.114 
## count_birth_order2/4          0.002     0.042    -0.080     0.085     0.058    62.066     0.954     0.615     0.400 
## count_birth_order3/4         -0.019     0.045    -0.106     0.069    -0.417    38.172     0.679     0.944     0.511 
## count_birth_order4/4         -0.011     0.046    -0.102     0.080    -0.236    29.441     0.815     1.237     0.580 
## count_birth_order1/5         -0.007     0.043    -0.092     0.078    -0.152  1274.110     0.879     0.092     0.085 
## count_birth_order2/5          0.042     0.047    -0.050     0.133     0.894   274.314     0.372     0.221     0.187 
## count_birth_order3/5         -0.022     0.044    -0.108     0.065    -0.492   307.691     0.623     0.206     0.176 
## count_birth_order4/5         -0.036     0.053    -0.139     0.067    -0.691    48.124     0.493     0.762     0.455 
## count_birth_order5/5         -0.003     0.047    -0.095     0.089    -0.056    58.100     0.956     0.649     0.413 
## count_birth_order1/5+        -0.073     0.043    -0.157     0.011    -1.705    50.462     0.094     0.731     0.444 
## count_birth_order2/5+        -0.149     0.040    -0.228    -0.070    -3.710    78.645     0.000     0.511     0.354 
## count_birth_order3/5+        -0.141     0.040    -0.219    -0.063    -3.539    65.647     0.001     0.588     0.389 
## count_birth_order4/5+        -0.155     0.037    -0.228    -0.083    -4.196    97.297     0.000     0.437     0.318 
## count_birth_order5/5+        -0.110     0.036    -0.181    -0.040    -3.071   109.442     0.003     0.402     0.299 
## count_birth_order5+/5+       -0.124     0.028    -0.179    -0.068    -4.392    56.361     0.000     0.666     0.420 
## poly(age, 3, raw = TRUE)1    -0.016     0.005    -0.026    -0.007    -3.335    22.305     0.003     1.741     0.664 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.131    32.125     0.041     1.124     0.556 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.360    39.508     0.002     0.913     0.502 
## male                          0.020     0.011    -0.002     0.042     1.784   392.821     0.075     0.178     0.156 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.104 
## Residual~~Residual                     0.831 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-43" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-10" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1010.326       13  426.052    0.000    0.110 
##   2 vs 3:    2.945        4   27.949    0.038    0.855 
##   3 vs 4:    1.118        1   80.117    0.293    0.504 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-5" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-11" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-44" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.325     0.027     0.273     0.377    12.175    21.038     0.000     1.891     0.683 
## poly(age, 3, raw = TRUE)1    -0.017     0.003    -0.023    -0.010    -4.991    28.188     0.000     1.299     0.593 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.854    48.647     0.006     0.755     0.452 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.983    62.794     0.000     0.609     0.397 
## male                          0.027     0.011     0.004     0.049     2.342   112.370     0.021     0.395     0.295 
## sibling_count                -0.017     0.003    -0.023    -0.011    -5.366    96.969     0.000     0.438     0.319 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.108 
## Residual~~Residual                     0.840 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-44" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-11" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-45" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.317     0.027     0.264     0.370    11.730    21.251     0.000     1.863     0.680 
## birth_order                   0.010     0.004     0.002     0.019     2.319   181.860     0.022     0.286     0.231 
## poly(age, 3, raw = TRUE)1    -0.017     0.003    -0.023    -0.010    -5.018    28.156     0.000     1.301     0.593 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.998    48.254     0.004     0.760     0.454 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.127    61.254     0.000     0.622     0.403 
## male                          0.027     0.011     0.004     0.049     2.345   114.297     0.021     0.390     0.293 
## sibling_count                -0.023     0.004    -0.030    -0.015    -5.874   205.924     0.000     0.264     0.217 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.108 
## Residual~~Residual                     0.840 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-45" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-11" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-46" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.326     0.028     0.272     0.380    11.796    22.554     0.000     1.715     0.661 
## birth_order_nonlinear2        0.011     0.016    -0.020     0.042     0.688    52.864     0.494     0.702     0.434 
## birth_order_nonlinear3        0.017     0.023    -0.028     0.062     0.741    32.698     0.464     1.104     0.551 
## birth_order_nonlinear4        0.022     0.028    -0.032     0.076     0.792    50.564     0.432     0.730     0.443 
## birth_order_nonlinear5        0.025     0.034    -0.041     0.091     0.737    83.574     0.463     0.488     0.344 
## birth_order_nonlinear5+       0.015     0.033    -0.050     0.080     0.454   126.607     0.651     0.364     0.278 
## poly(age, 3, raw = TRUE)1    -0.017     0.003    -0.023    -0.010    -4.866    27.707     0.000     1.325     0.598 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.855    42.449     0.007     0.853     0.484 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.850    50.491     0.000     0.731     0.444 
## male                          0.024     0.012     0.001     0.046     2.037   114.157     0.044     0.390     0.293 
## sibling_count                -0.020     0.004    -0.027    -0.013    -5.324   305.152     0.000     0.207     0.177 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.839 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-46" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-11" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-47" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.272     0.038     0.197     0.346     7.151    25.933     0.000     1.434     0.618 
## count_birth_order2/2          0.009     0.028    -0.046     0.064     0.324    33.958     0.748     1.061     0.541 
## count_birth_order1/3          0.001     0.038    -0.073     0.074     0.020    27.194     0.984     1.355     0.603 
## count_birth_order2/3          0.007     0.033    -0.058     0.071     0.205    33.417     0.839     1.079     0.545 
## count_birth_order3/3          0.033     0.040    -0.045     0.111     0.834    23.135     0.413     1.658     0.653 
## count_birth_order1/4         -0.043     0.042    -0.125     0.040    -1.018    65.133     0.312     0.592     0.390 
## count_birth_order2/4         -0.028     0.039    -0.105     0.049    -0.717    53.629     0.476     0.694     0.431 
## count_birth_order3/4         -0.033     0.044    -0.118     0.053    -0.746    33.799     0.461     1.066     0.542 
## count_birth_order4/4          0.015     0.049    -0.081     0.110     0.305    26.511     0.762     1.396     0.611 
## count_birth_order1/5         -0.057     0.052    -0.158     0.044    -1.107   173.682     0.270     0.295     0.236 
## count_birth_order2/5         -0.092     0.061    -0.212     0.027    -1.512    31.539     0.140     1.147     0.561 
## count_birth_order3/5         -0.064     0.048    -0.158     0.030    -1.341    98.270     0.183     0.434     0.316 
## count_birth_order4/5         -0.056     0.055    -0.164     0.053    -1.004    37.956     0.322     0.949     0.512 
## count_birth_order5/5         -0.032     0.059    -0.148     0.085    -0.534    35.791     0.597     1.006     0.527 
## count_birth_order1/5+        -0.125     0.057    -0.237    -0.013    -2.190    43.393     0.034     0.836     0.479 
## count_birth_order2/5+        -0.164     0.046    -0.254    -0.073    -3.548    85.991     0.001     0.478     0.339 
## count_birth_order3/5+        -0.177     0.042    -0.259    -0.095    -4.235   141.075     0.000     0.338     0.263 
## count_birth_order4/5+        -0.140     0.052    -0.243    -0.038    -2.679    32.323     0.012     1.117     0.554 
## count_birth_order5/5+        -0.115     0.046    -0.205    -0.025    -2.505    53.215     0.015     0.699     0.432 
## count_birth_order5+/5+       -0.127     0.031    -0.189    -0.066    -4.065   111.425     0.000     0.397     0.297 
## poly(age, 3, raw = TRUE)1    -0.015     0.004    -0.023    -0.007    -3.517    26.711     0.002     1.384     0.609 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.237    43.318     0.030     0.838     0.479 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.073    54.189     0.000     0.688     0.428 
## male                          0.024     0.012     0.000     0.047     2.000   291.546     0.046     0.213     0.181 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.105 
## Residual~~Residual                     0.836 
## ICC|mother_pidlink                     0.112 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-47" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-11" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 709.970      13  17.620   0.000   0.947 
##  2 vs 3: 368.528       4  17.487   0.000   1.396 
##  3 vs 4:   5.300       1 184.798   0.022   0.283 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-5" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2015-young" class="section level3 tabset">
<h3>g-factor 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-6" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-12" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-48" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.495     0.032    -0.558    -0.433   -15.515    14.902     0.000     3.487     0.802 
## poly(age, 3, raw = TRUE)1     0.038     0.003     0.032     0.043    13.315    49.115     0.000     0.748     0.450 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.592    79.696     0.001     0.506     0.352 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.529    82.219     0.130     0.494     0.347 
## male                         -0.062     0.014    -0.090    -0.034    -4.307    25.263     0.000     1.481     0.625 
## sibling_count                -0.014     0.002    -0.018    -0.009    -5.889    64.063     0.000     0.600     0.393 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.678 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-48" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-12" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-49" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.493     0.033    -0.557    -0.428   -14.939    14.576     0.000     3.668     0.810 
## birth_order                  -0.003     0.004    -0.011     0.005    -0.796    29.834     0.432     1.218     0.577 
## poly(age, 3, raw = TRUE)1     0.038     0.003     0.032     0.043    13.359    49.504     0.000     0.743     0.448 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.679    78.789     0.000     0.511     0.354 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.669    91.746     0.098     0.456     0.328 
## male                         -0.062     0.014    -0.090    -0.034    -4.307    25.269     0.000     1.480     0.625 
## sibling_count                -0.012     0.003    -0.017    -0.006    -4.034   103.575     0.000     0.418     0.308 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.678 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-49" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-12" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-50" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.501     0.034    -0.568    -0.434   -14.575    14.706     0.000     3.593     0.807 
## birth_order_nonlinear2        0.005     0.020    -0.035     0.044     0.228    21.668     0.822     1.813     0.673 
## birth_order_nonlinear3        0.009     0.023    -0.036     0.054     0.379    25.074     0.708     1.495     0.628 
## birth_order_nonlinear4       -0.019     0.027    -0.072     0.034    -0.710    29.302     0.483     1.243     0.582 
## birth_order_nonlinear5       -0.016     0.030    -0.075     0.042    -0.548    40.244     0.586     0.897     0.497 
## birth_order_nonlinear5+      -0.032     0.031    -0.093     0.029    -1.028    27.060     0.313     1.362     0.605 
## poly(age, 3, raw = TRUE)1     0.038     0.003     0.032     0.044    13.207    46.272     0.000     0.789     0.464 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.741    74.076     0.000     0.535     0.365 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.735    77.117     0.087     0.519     0.358 
## male                         -0.062     0.014    -0.090    -0.033    -4.286    24.838     0.000     1.512     0.631 
## sibling_count                -0.011     0.003    -0.017    -0.006    -4.052   136.945     0.000     0.345     0.267 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.678 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-50" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-12" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-51" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.541     0.045    -0.630    -0.452   -11.924    18.095     0.000     2.393     0.733 
## count_birth_order2/2          0.007     0.027    -0.046     0.060     0.256    40.291     0.799     0.896     0.497 
## count_birth_order1/3          0.006     0.030    -0.053     0.064     0.187   123.692     0.852     0.369     0.281 
## count_birth_order2/3         -0.006     0.036    -0.075     0.064    -0.155    37.692     0.878     0.956     0.514 
## count_birth_order3/3          0.012     0.033    -0.052     0.076     0.371    50.729     0.712     0.728     0.443 
## count_birth_order1/4         -0.010     0.043    -0.095     0.074    -0.238    44.524     0.813     0.817     0.473 
## count_birth_order2/4         -0.000     0.035    -0.070     0.069    -0.009   294.204     0.993     0.212     0.180 
## count_birth_order3/4         -0.041     0.038    -0.115     0.034    -1.062    77.013     0.291     0.519     0.358 
## count_birth_order4/4         -0.024     0.033    -0.090     0.041    -0.733   238.979     0.464     0.241     0.201 
## count_birth_order1/5          0.004     0.054    -0.102     0.109     0.065    44.848     0.948     0.811     0.471 
## count_birth_order2/5          0.007     0.045    -0.081     0.095     0.148   265.827     0.882     0.225     0.190 
## count_birth_order3/5          0.033     0.048    -0.061     0.127     0.681    71.886     0.498     0.548     0.371 
## count_birth_order4/5         -0.048     0.047    -0.140     0.044    -1.020    75.603     0.311     0.527     0.362 
## count_birth_order5/5          0.010     0.042    -0.072     0.093     0.247   106.505     0.805     0.410     0.304 
## count_birth_order1/5+        -0.078     0.039    -0.154    -0.002    -2.012    72.749     0.048     0.543     0.369 
## count_birth_order2/5+        -0.124     0.043    -0.209    -0.039    -2.858    39.746     0.007     0.908     0.500 
## count_birth_order3/5+        -0.100     0.037    -0.172    -0.027    -2.697    85.977     0.008     0.478     0.339 
## count_birth_order4/5+        -0.121     0.040    -0.199    -0.043    -3.045    46.169     0.004     0.791     0.464 
## count_birth_order5/5+        -0.133     0.043    -0.218    -0.048    -3.069    29.741     0.005     1.223     0.578 
## count_birth_order5+/5+       -0.134     0.029    -0.190    -0.078    -4.681    49.741     0.000     0.740     0.447 
## poly(age, 3, raw = TRUE)1     0.040     0.004     0.032     0.049     9.755    33.002     0.000     1.093     0.549 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.962    62.895     0.004     0.608     0.397 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.384    85.927     0.170     0.478     0.339 
## male                         -0.066     0.016    -0.098    -0.034    -4.022    21.349     0.001     1.851     0.678 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-51" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-12" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 894.717      13 164.062   0.000   0.190 
##  2 vs 3:   2.680       4  22.572   0.058   1.053 
##  3 vs 4:   0.413       1  29.998   0.525   1.211 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-6" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-13" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-52" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.493     0.033    -0.557    -0.429   -15.138    14.892     0.000     3.492     0.802 
## poly(age, 3, raw = TRUE)1     0.037     0.003     0.031     0.042    13.175    51.641     0.000     0.717     0.439 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.449    80.613     0.001     0.502     0.350 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.538    80.537     0.128     0.502     0.350 
## male                         -0.062     0.014    -0.090    -0.034    -4.318    25.263     0.000     1.481     0.625 
## sibling_count                -0.017     0.004    -0.023    -0.010    -4.711    66.331     0.000     0.583     0.387 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-52" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-13" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-53" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.492     0.034    -0.558    -0.426   -14.596    14.635     0.000     3.634     0.809 
## birth_order                  -0.001     0.005    -0.012     0.009    -0.264    33.087     0.793     1.090     0.548 
## poly(age, 3, raw = TRUE)1     0.037     0.003     0.031     0.042    13.193    51.970     0.000     0.713     0.437 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.472    82.330     0.001     0.494     0.346 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.584    89.969     0.117     0.463     0.331 
## male                         -0.062     0.014    -0.090    -0.034    -4.320    25.297     0.000     1.478     0.625 
## sibling_count                -0.016     0.004    -0.023    -0.008    -4.028   208.642     0.000     0.262     0.215 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-53" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-13" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-54" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.494     0.036    -0.564    -0.424   -13.863    14.444     0.000     3.747     0.814 
## birth_order_nonlinear2        0.002     0.016    -0.030     0.034     0.145    32.716     0.885     1.103     0.551 
## birth_order_nonlinear3        0.001     0.020    -0.039     0.041     0.039    38.424     0.969     0.938     0.509 
## birth_order_nonlinear4       -0.015     0.024    -0.062     0.032    -0.630    85.253     0.530     0.481     0.340 
## birth_order_nonlinear5       -0.041     0.032    -0.104     0.022    -1.269    62.675     0.209     0.610     0.398 
## birth_order_nonlinear5+      -0.020     0.033    -0.086     0.045    -0.614    60.082     0.541     0.631     0.406 
## poly(age, 3, raw = TRUE)1     0.037     0.003     0.031     0.043    12.793    47.528     0.000     0.770     0.458 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.385    86.545     0.001     0.476     0.338 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.497   102.364     0.137     0.421     0.310 
## male                         -0.063     0.015    -0.091    -0.034    -4.296    25.104     0.000     1.492     0.627 
## sibling_count                -0.015     0.004    -0.023    -0.008    -3.833   169.615     0.000     0.299     0.239 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-54" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-13" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-55" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.553     0.039    -0.631    -0.476   -14.007    22.357     0.000     1.736     0.663 
## count_birth_order2/2          0.012     0.024    -0.034     0.059     0.531    51.911     0.597     0.713     0.438 
## count_birth_order1/3          0.013     0.030    -0.046     0.072     0.423    57.392     0.674     0.656     0.416 
## count_birth_order2/3         -0.006     0.031    -0.066     0.055    -0.187    36.852     0.852     0.977     0.520 
## count_birth_order3/3          0.013     0.027    -0.041     0.067     0.476   121.582     0.635     0.374     0.284 
## count_birth_order1/4         -0.026     0.042    -0.109     0.057    -0.610    47.303     0.545     0.774     0.459 
## count_birth_order2/4         -0.039     0.037    -0.111     0.034    -1.048    60.993     0.299     0.624     0.403 
## count_birth_order3/4         -0.049     0.038    -0.124     0.026    -1.288    51.181     0.204     0.722     0.441 
## count_birth_order4/4         -0.003     0.034    -0.071     0.064    -0.101   160.075     0.920     0.311     0.246 
## count_birth_order1/5         -0.058     0.050    -0.155     0.039    -1.164   148.311     0.246     0.327     0.256 
## count_birth_order2/5         -0.079     0.054    -0.184     0.026    -1.470    44.563     0.149     0.816     0.473 
## count_birth_order3/5         -0.078     0.062    -0.199     0.043    -1.257    23.464     0.221     1.627     0.648 
## count_birth_order4/5         -0.130     0.072    -0.270     0.011    -1.809    17.246     0.088     2.602     0.750 
## count_birth_order5/5         -0.115     0.046    -0.205    -0.026    -2.521   152.709     0.013     0.321     0.252 
## count_birth_order1/5+        -0.145     0.045    -0.234    -0.056    -3.193   179.651     0.002     0.288     0.232 
## count_birth_order2/5+        -0.138     0.052    -0.240    -0.035    -2.630    33.339     0.013     1.081     0.546 
## count_birth_order3/5+        -0.120     0.040    -0.198    -0.042    -3.014   148.566     0.003     0.326     0.256 
## count_birth_order4/5+        -0.149     0.048    -0.243    -0.055    -3.106    38.769     0.004     0.930     0.507 
## count_birth_order5/5+        -0.153     0.049    -0.249    -0.057    -3.121    32.795     0.004     1.100     0.550 
## count_birth_order5+/5+       -0.136     0.032    -0.199    -0.073    -4.245    85.668     0.000     0.480     0.339 
## poly(age, 3, raw = TRUE)1     0.041     0.004     0.033     0.048    10.493    33.544     0.000     1.075     0.544 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.164    42.428     0.003     0.854     0.484 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.536    43.702     0.132     0.831     0.477 
## male                         -0.063     0.016    -0.095    -0.031    -3.869    23.316     0.001     1.641     0.650 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.211 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.238 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-55" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-13" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 721.801      13  19.562   0.000   0.858 
##  2 vs 3: 355.202       4  18.255   0.000   1.327 
##  3 vs 4:   0.266       1  77.555   0.608   0.517 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-6" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2015-young" class="section level3 tabset">
<h3>Raven 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-7" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-14" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-56" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.623     0.033    -0.687    -0.559   -19.043    14.205     0.000     3.902     0.820 
## poly(age, 3, raw = TRUE)1     0.041     0.003     0.035     0.047    13.430    33.308     0.000     1.083     0.546 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.926    31.485     0.006     1.149     0.562 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.148    28.484     0.260     1.284     0.590 
## male                          0.023     0.010     0.002     0.044     2.187   111.280     0.031     0.397     0.297 
## sibling_count                -0.010     0.002    -0.015    -0.006    -4.311    51.550     0.000     0.718     0.439 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.647 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-56" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-14" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-57" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.619     0.033    -0.684    -0.555   -18.808    14.290     0.000     3.845     0.817 
## birth_order                  -0.004     0.003    -0.011     0.003    -1.193    59.298     0.238     0.638     0.409 
## poly(age, 3, raw = TRUE)1     0.041     0.003     0.035     0.047    13.508    33.752     0.000     1.068     0.543 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.098    33.995     0.004     1.060     0.541 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.315    31.383     0.198     1.153     0.563 
## male                          0.023     0.010     0.002     0.044     2.188   111.053     0.031     0.398     0.297 
## sibling_count                -0.008     0.003    -0.013    -0.002    -2.687    92.334     0.009     0.454     0.327 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.647 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-57" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-14" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-58" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.627     0.033    -0.692    -0.562   -18.964    15.010     0.000     3.431     0.799 
## birth_order_nonlinear2        0.002     0.018    -0.032     0.036     0.110    29.017     0.913     1.257     0.585 
## birth_order_nonlinear3        0.004     0.020    -0.036     0.044     0.194    34.207     0.847     1.053     0.539 
## birth_order_nonlinear4       -0.014     0.030    -0.073     0.046    -0.450    20.602     0.657     1.949     0.690 
## birth_order_nonlinear5       -0.019     0.032    -0.080     0.043    -0.590    29.728     0.560     1.223     0.578 
## birth_order_nonlinear5+      -0.036     0.025    -0.086     0.014    -1.425    61.469     0.159     0.620     0.402 
## poly(age, 3, raw = TRUE)1     0.041     0.003     0.035     0.047    13.343    32.268     0.000     1.119     0.555 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.077    31.121     0.004     1.163     0.565 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.332    28.395     0.193     1.288     0.591 
## male                          0.023     0.011     0.002     0.044     2.172   105.746     0.032     0.412     0.305 
## sibling_count                -0.007     0.003    -0.013    -0.002    -2.539    63.338     0.014     0.605     0.396 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.647 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-58" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-14" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-59" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.649     0.044    -0.736    -0.562   -14.636    18.168     0.000     2.377     0.732 
## count_birth_order2/2         -0.006     0.026    -0.057     0.045    -0.232    42.264     0.818     0.857     0.485 
## count_birth_order1/3         -0.012     0.031    -0.072     0.048    -0.398    82.725     0.692     0.492     0.345 
## count_birth_order2/3         -0.020     0.035    -0.088     0.048    -0.587    39.095     0.561     0.922     0.505 
## count_birth_order3/3          0.012     0.028    -0.044     0.067     0.410   147.759     0.682     0.328     0.257 
## count_birth_order1/4          0.005     0.039    -0.070     0.081     0.135    78.456     0.893     0.512     0.355 
## count_birth_order2/4          0.017     0.036    -0.053     0.088     0.486   172.318     0.628     0.296     0.237 
## count_birth_order3/4         -0.058     0.041    -0.139     0.023    -1.409    42.318     0.166     0.856     0.485 
## count_birth_order4/4         -0.019     0.034    -0.085     0.048    -0.555   140.335     0.580     0.339     0.264 
## count_birth_order1/5          0.007     0.045    -0.081     0.095     0.155   143.660     0.877     0.334     0.261 
## count_birth_order2/5          0.010     0.048    -0.084     0.103     0.199    91.544     0.843     0.457     0.328 
## count_birth_order3/5          0.024     0.049    -0.072     0.119     0.487    56.040     0.628     0.669     0.421 
## count_birth_order4/5         -0.041     0.045    -0.129     0.047    -0.916    94.114     0.362     0.448     0.323 
## count_birth_order5/5          0.004     0.040    -0.074     0.082     0.097   157.559     0.923     0.314     0.248 
## count_birth_order1/5+        -0.060     0.044    -0.147     0.026    -1.365    33.427     0.181     1.079     0.545 
## count_birth_order2/5+        -0.093     0.044    -0.178    -0.007    -2.126    35.488     0.041     1.014     0.529 
## count_birth_order3/5+        -0.083     0.034    -0.150    -0.015    -2.400   138.645     0.018     0.342     0.265 
## count_birth_order4/5+        -0.091     0.041    -0.171    -0.010    -2.208    35.772     0.034     1.006     0.527 
## count_birth_order5/5+        -0.111     0.039    -0.186    -0.035    -2.859    43.016     0.007     0.843     0.481 
## count_birth_order5+/5+       -0.113     0.028    -0.168    -0.058    -4.042    50.632     0.000     0.729     0.443 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.034     0.050    10.031    29.395     0.000     1.239     0.581 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.331    39.710     0.025     0.909     0.501 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.807    42.894     0.424     0.845     0.482 
## male                          0.022     0.012    -0.000     0.045     1.923    75.586     0.058     0.527     0.362 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.646 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-59" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-14" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 835.129      13 100.183   0.000   0.256 
##  2 vs 3:   2.749       4  27.002   0.049   0.883 
##  3 vs 4:   1.268       1  59.506   0.265   0.636 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-7" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-15" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-60" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.619     0.033    -0.683    -0.554   -18.769    14.371     0.000     3.793     0.815 
## poly(age, 3, raw = TRUE)1     0.040     0.003     0.034     0.046    13.198    32.140     0.000     1.124     0.556 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.838    31.075     0.008     1.165     0.565 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.144    28.398     0.262     1.288     0.591 
## male                          0.023     0.011     0.002     0.044     2.175   108.012     0.032     0.406     0.301 
## sibling_count                -0.014     0.003    -0.020    -0.007    -4.164    87.796     0.000     0.471     0.335 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.647 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-60" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-15" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-61" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.616     0.033    -0.681    -0.551   -18.596    14.582     0.000     3.665     0.810 
## birth_order                  -0.003     0.004    -0.011     0.005    -0.738   101.260     0.463     0.425     0.312 
## poly(age, 3, raw = TRUE)1     0.040     0.003     0.034     0.046    13.228    32.319     0.000     1.117     0.554 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.915    32.313     0.006     1.118     0.555 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.219    29.883     0.232     1.216     0.576 
## male                          0.023     0.011     0.002     0.044     2.176   107.909     0.032     0.406     0.302 
## sibling_count                -0.012     0.004    -0.020    -0.004    -3.130   196.598     0.002     0.272     0.222 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.647 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-61" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-15" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-62" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.619     0.035    -0.687    -0.551   -17.873    14.569     0.000     3.672     0.810 
## birth_order_nonlinear2       -0.002     0.014    -0.030     0.025    -0.174    58.925     0.863     0.642     0.410 
## birth_order_nonlinear3        0.004     0.021    -0.038     0.046     0.181    29.955     0.858     1.213     0.576 
## birth_order_nonlinear4       -0.016     0.023    -0.060     0.029    -0.683   105.044     0.496     0.414     0.306 
## birth_order_nonlinear5       -0.040     0.033    -0.104     0.024    -1.222    52.533     0.227     0.706     0.435 
## birth_order_nonlinear5+      -0.021     0.030    -0.080     0.037    -0.719   122.813     0.473     0.371     0.282 
## poly(age, 3, raw = TRUE)1     0.040     0.003     0.034     0.047    13.010    31.889     0.000     1.133     0.558 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.892    34.246     0.007     1.052     0.539 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.201    33.828     0.238     1.065     0.542 
## male                          0.022     0.010     0.002     0.043     2.131   133.370     0.035     0.351     0.271 
## sibling_count                -0.013     0.004    -0.021    -0.005    -3.151   126.952     0.002     0.363     0.278 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.646 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-62" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-15" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-63" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.667     0.038    -0.741    -0.593   -17.698    23.762     0.000     1.600     0.644 
## count_birth_order2/2          0.005     0.022    -0.038     0.048     0.245    68.713     0.807     0.567     0.380 
## count_birth_order1/3         -0.004     0.029    -0.061     0.052    -0.143    68.093     0.887     0.571     0.381 
## count_birth_order2/3         -0.021     0.028    -0.076     0.034    -0.742    51.100     0.461     0.723     0.441 
## count_birth_order3/3          0.016     0.028    -0.039     0.071     0.568    74.658     0.572     0.532     0.364 
## count_birth_order1/4         -0.018     0.040    -0.096     0.059    -0.465    61.639     0.643     0.618     0.401 
## count_birth_order2/4         -0.036     0.034    -0.103     0.031    -1.042    91.989     0.300     0.455     0.327 
## count_birth_order3/4         -0.060     0.038    -0.136     0.015    -1.564    44.719     0.125     0.814     0.472 
## count_birth_order4/4         -0.011     0.034    -0.077     0.055    -0.324   162.170     0.746     0.308     0.245 
## count_birth_order1/5         -0.064     0.052    -0.165     0.038    -1.231    77.339     0.222     0.518     0.358 
## count_birth_order2/5         -0.080     0.054    -0.186     0.026    -1.473    38.052     0.149     0.947     0.511 
## count_birth_order3/5         -0.059     0.060    -0.176     0.059    -0.975    23.700     0.340     1.606     0.645 
## count_birth_order4/5         -0.139     0.060    -0.257    -0.021    -2.304    23.134     0.031     1.658     0.653 
## count_birth_order5/5         -0.108     0.042    -0.191    -0.025    -2.557   363.502     0.011     0.187     0.162 
## count_birth_order1/5+        -0.112     0.051    -0.211    -0.012    -2.197    54.685     0.032     0.683     0.426 
## count_birth_order2/5+        -0.117     0.053    -0.220    -0.013    -2.205    29.908     0.035     1.215     0.576 
## count_birth_order3/5+        -0.097     0.040    -0.175    -0.018    -2.421   111.998     0.017     0.396     0.296 
## count_birth_order4/5+        -0.121     0.050    -0.220    -0.022    -2.404    29.719     0.023     1.224     0.578 
## count_birth_order5/5+        -0.138     0.047    -0.231    -0.045    -2.907    33.865     0.006     1.064     0.542 
## count_birth_order5+/5+       -0.120     0.035    -0.189    -0.051    -3.430    43.525     0.001     0.834     0.478 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.036     0.052    10.808    27.309     0.000     1.348     0.602 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.797    29.253     0.009     1.246     0.582 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.258    28.110     0.219     1.303     0.594 
## male                          0.024     0.012     0.000     0.049     1.966    64.616     0.054     0.595     0.392 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.643 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-63" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-15" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 697.498      13  18.714   0.000   0.894 
##  2 vs 3: 417.558       4  24.736   0.000   0.961 
##  3 vs 4:   0.424       1 101.484   0.516   0.424 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-7" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2015-young" class="section level3 tabset">
<h3>Numeracy 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-8" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-16" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-64" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.211     0.028    -0.267    -0.156    -7.510    18.931     0.000     2.221     0.718 
## poly(age, 3, raw = TRUE)1     0.023     0.003     0.018     0.028     8.694   116.255     0.000     0.385     0.290 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.902   672.928     0.004     0.131     0.118 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.277   472.348     0.202     0.160     0.142 
## male                         -0.127     0.019    -0.164    -0.089    -6.631    16.000     0.000     3.000     0.776 
## sibling_count                -0.013     0.002    -0.017    -0.009    -5.760    92.062     0.000     0.455     0.327 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.200 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-64" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-16" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-65" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.210     0.029    -0.268    -0.152    -7.129    17.846     0.000     2.450     0.738 
## birth_order                  -0.001     0.004    -0.010     0.007    -0.317    28.971     0.754     1.259     0.585 
## poly(age, 3, raw = TRUE)1     0.023     0.003     0.018     0.028     8.691   114.521     0.000     0.390     0.293 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.861   352.133     0.004     0.190     0.165 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.302   320.605     0.194     0.201     0.173 
## male                         -0.127     0.019    -0.164    -0.089    -6.631    16.003     0.000     2.999     0.776 
## sibling_count                -0.012     0.003    -0.018    -0.006    -4.040   104.551     0.000     0.415     0.307 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.200 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-65" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-16" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-66" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.217     0.032    -0.279    -0.154    -6.798    17.124     0.000     2.636     0.752 
## birth_order_nonlinear2        0.006     0.021    -0.035     0.048     0.291    21.660     0.774     1.814     0.673 
## birth_order_nonlinear3        0.011     0.026    -0.040     0.062     0.436    21.190     0.667     1.871     0.681 
## birth_order_nonlinear4       -0.018     0.025    -0.067     0.031    -0.728    50.811     0.470     0.727     0.442 
## birth_order_nonlinear5       -0.008     0.027    -0.061     0.045    -0.303   106.905     0.762     0.409     0.303 
## birth_order_nonlinear5+      -0.018     0.034    -0.086     0.049    -0.532    24.229     0.599     1.561     0.638 
## poly(age, 3, raw = TRUE)1     0.023     0.003     0.018     0.028     8.641   103.249     0.000     0.419     0.309 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.013   527.913     0.003     0.150     0.134 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.434   450.266     0.152     0.165     0.145 
## male                         -0.127     0.019    -0.164    -0.089    -6.613    15.928     0.000     3.027     0.778 
## sibling_count                -0.011     0.003    -0.017    -0.006    -4.101   169.037     0.000     0.300     0.240 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.200 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-66" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-16" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-67" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.263     0.040    -0.342    -0.184    -6.510    25.478     0.000     1.465     0.623 
## count_birth_order2/2          0.018     0.028    -0.036     0.072     0.647    48.047     0.521     0.763     0.455 
## count_birth_order1/3          0.022     0.029    -0.036     0.079     0.742   296.150     0.458     0.211     0.180 
## count_birth_order2/3          0.011     0.033    -0.054     0.076     0.333    68.857     0.740     0.566     0.379 
## count_birth_order3/3          0.009     0.039    -0.066     0.085     0.244    30.312     0.809     1.197     0.572 
## count_birth_order1/4         -0.023     0.043    -0.108     0.063    -0.521    55.188     0.604     0.677     0.424 
## count_birth_order2/4         -0.018     0.037    -0.091     0.055    -0.489   261.699     0.625     0.228     0.192 
## count_birth_order3/4         -0.010     0.041    -0.091     0.070    -0.254    65.074     0.801     0.592     0.390 
## count_birth_order4/4         -0.022     0.039    -0.099     0.056    -0.551    65.224     0.583     0.591     0.390 
## count_birth_order1/5         -0.000     0.059    -0.116     0.116    -0.006    35.781     0.995     1.006     0.527 
## count_birth_order2/5          0.001     0.049    -0.095     0.098     0.029   141.347     0.977     0.337     0.263 
## count_birth_order3/5          0.031     0.047    -0.062     0.124     0.660   117.621     0.511     0.382     0.289 
## count_birth_order4/5         -0.041     0.049    -0.136     0.054    -0.841    85.370     0.403     0.481     0.340 
## count_birth_order5/5          0.015     0.044    -0.071     0.100     0.339   115.698     0.735     0.387     0.291 
## count_birth_order1/5+        -0.071     0.047    -0.164     0.022    -1.496    32.820     0.144     1.099     0.550 
## count_birth_order2/5+        -0.115     0.041    -0.196    -0.035    -2.808    71.028     0.006     0.553     0.373 
## count_birth_order3/5+        -0.085     0.039    -0.162    -0.008    -2.173    77.938     0.033     0.515     0.356 
## count_birth_order4/5+        -0.113     0.037    -0.184    -0.041    -3.074   115.952     0.003     0.386     0.291 
## count_birth_order5/5+        -0.114     0.043    -0.198    -0.030    -2.667    37.492     0.011     0.961     0.515 
## count_birth_order5+/5+       -0.114     0.029    -0.171    -0.057    -3.928    57.130     0.000     0.658     0.417 
## poly(age, 3, raw = TRUE)1     0.026     0.004     0.019     0.033     6.936    67.145     0.000     0.578     0.384 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.695   180.959     0.008     0.287     0.231 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.511   210.740     0.132     0.260     0.214 
## male                         -0.133     0.020    -0.173    -0.093    -6.551    16.058     0.000     2.978     0.775 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.200 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-67" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-16" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 880.357      13 110.634   0.000   0.241 
##  2 vs 3:   2.269       4  19.283   0.099   1.247 
##  3 vs 4:   0.264       1  55.992   0.609   0.669 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-8" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-17" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-68" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.211     0.029    -0.268    -0.154    -7.277    18.535     0.000     2.298     0.725 
## poly(age, 3, raw = TRUE)1     0.022     0.003     0.017     0.027     8.468   139.720     0.000     0.340     0.264 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.733   764.229     0.006     0.122     0.111 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.303   444.942     0.193     0.166     0.146 
## male                         -0.127     0.019    -0.164    -0.090    -6.648    16.019     0.000     2.993     0.776 
## sibling_count                -0.014     0.004    -0.021    -0.007    -3.921    59.896     0.000     0.633     0.407 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.194 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.201 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-68" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-17" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-69" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.212     0.031    -0.272    -0.152    -6.905    17.415     0.000     2.557     0.746 
## birth_order                   0.001     0.006    -0.010     0.012     0.163    30.335     0.872     1.196     0.572 
## poly(age, 3, raw = TRUE)1     0.022     0.003     0.017     0.027     8.460   139.233     0.000     0.341     0.265 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.666   518.654     0.008     0.152     0.135 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.268   388.998     0.206     0.179     0.156 
## male                         -0.127     0.019    -0.164    -0.090    -6.650    16.026     0.000     2.990     0.776 
## sibling_count                -0.015     0.004    -0.023    -0.007    -3.532   131.193     0.001     0.355     0.273 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.194 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.201 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-69" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-17" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-70" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.213     0.032    -0.275    -0.151    -6.688    17.655     0.000     2.496     0.742 
## birth_order_nonlinear2        0.007     0.019    -0.032     0.045     0.337    22.863     0.739     1.684     0.656 
## birth_order_nonlinear3       -0.002     0.024    -0.048     0.045    -0.078    27.721     0.939     1.324     0.598 
## birth_order_nonlinear4       -0.010     0.024    -0.057     0.038    -0.396   129.437     0.693     0.358     0.275 
## birth_order_nonlinear5       -0.030     0.032    -0.093     0.032    -0.944   112.103     0.347     0.395     0.296 
## birth_order_nonlinear5+      -0.014     0.036    -0.084     0.056    -0.386    55.490     0.701     0.674     0.423 
## poly(age, 3, raw = TRUE)1     0.022     0.003     0.017     0.027     8.242   123.146     0.000     0.371     0.282 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.566   551.507     0.011     0.146     0.131 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.165   493.532     0.244     0.156     0.139 
## male                         -0.128     0.019    -0.166    -0.090    -6.637    16.192     0.000     2.930     0.772 
## sibling_count                -0.013     0.004    -0.022    -0.005    -3.173   134.848     0.002     0.348     0.269 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.194 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.201 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-70" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-17" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-71" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.265     0.039    -0.341    -0.189    -6.843    26.093     0.000     1.423     0.616 
## count_birth_order2/2          0.016     0.025    -0.034     0.065     0.626    48.988     0.534     0.750     0.451 
## count_birth_order1/3          0.026     0.031    -0.034     0.087     0.843    67.761     0.402     0.573     0.382 
## count_birth_order2/3          0.011     0.031    -0.051     0.073     0.352    42.223     0.727     0.858     0.485 
## count_birth_order3/3          0.007     0.032    -0.056     0.070     0.218    52.465     0.828     0.707     0.435 
## count_birth_order1/4         -0.025     0.043    -0.108     0.059    -0.584    61.297     0.561     0.621     0.402 
## count_birth_order2/4         -0.030     0.040    -0.108     0.049    -0.741    50.485     0.462     0.731     0.444 
## count_birth_order3/4         -0.023     0.037    -0.096     0.050    -0.611    85.460     0.543     0.480     0.340 
## count_birth_order4/4          0.007     0.035    -0.061     0.075     0.200   285.184     0.842     0.216     0.183 
## count_birth_order1/5         -0.034     0.055    -0.142     0.074    -0.621    85.760     0.536     0.479     0.339 
## count_birth_order2/5         -0.055     0.057    -0.168     0.058    -0.955    40.380     0.345     0.894     0.496 
## count_birth_order3/5         -0.073     0.056    -0.183     0.037    -1.301    37.208     0.201     0.968     0.517 
## count_birth_order4/5         -0.080     0.076    -0.230     0.069    -1.055    16.947     0.306     2.687     0.756 
## count_birth_order5/5         -0.086     0.053    -0.189     0.017    -1.634    67.461     0.107     0.575     0.383 
## count_birth_order1/5+        -0.133     0.045    -0.221    -0.046    -2.974   630.937     0.003     0.136     0.122 
## count_birth_order2/5+        -0.116     0.052    -0.219    -0.014    -2.221    40.952     0.032     0.883     0.493 
## count_birth_order3/5+        -0.107     0.042    -0.189    -0.025    -2.546   146.024     0.012     0.330     0.258 
## count_birth_order4/5+        -0.131     0.043    -0.216    -0.046    -3.009    95.421     0.003     0.443     0.321 
## count_birth_order5/5+        -0.120     0.045    -0.207    -0.032    -2.683    65.897     0.009     0.586     0.388 
## count_birth_order5+/5+       -0.111     0.033    -0.176    -0.045    -3.323    86.467     0.001     0.476     0.338 
## poly(age, 3, raw = TRUE)1     0.025     0.004     0.018     0.032     6.781    51.870     0.000     0.714     0.438 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.381    61.809     0.020     0.617     0.401 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.218    58.576     0.228     0.645     0.412 
## male                         -0.131     0.019    -0.168    -0.094    -6.917    19.099     0.000     2.189     0.715 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.194 
## Residual~~Residual                     0.769 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-71" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-17" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 819.020      13  25.253   0.000   0.684 
##  2 vs 3: 318.523       4  15.121   0.000   1.678 
##  3 vs 4:   0.460       1 136.921   0.499   0.345 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-8" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2007-old" class="section level3 tabset">
<h3>g-factor 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-9" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-18" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-72" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.257     0.056     0.147     0.366     4.603    10.621     0.001    11.584     0.932 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.015     0.005    -0.951    13.503     0.359     4.447     0.839 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.042    16.969     0.967     2.680     0.755 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.230    16.331     0.236     2.882     0.769 
## male                          0.009     0.011    -0.013     0.031     0.818    88.682     0.416     0.468     0.333 
## sibling_count                -0.024     0.003    -0.030    -0.018    -7.876    28.574     0.000     1.279     0.589 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.685 
## ICC|mother_pidlink                     0.290 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-72" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-18" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-73" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.249     0.058     0.136     0.362     4.313    10.548     0.001    12.105     0.935 
## birth_order                   0.009     0.006    -0.004     0.021     1.390    13.657     0.187     4.313     0.834 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.015     0.005    -1.023    13.738     0.324     4.247     0.832 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.287    19.813     0.777     2.067     0.703 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.612    19.284     0.123     2.156     0.712 
## male                          0.009     0.011    -0.013     0.031     0.816    88.512     0.417     0.468     0.334 
## sibling_count                -0.029     0.005    -0.039    -0.019    -5.675    16.336     0.000     2.880     0.769 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.685 
## ICC|mother_pidlink                     0.290 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-73" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-18" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-74" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.250     0.057     0.139     0.361     4.426    10.806     0.001    10.443     0.925 
## birth_order_nonlinear2        0.021     0.018    -0.015     0.057     1.156    28.377     0.257     1.289     0.591 
## birth_order_nonlinear3        0.021     0.027    -0.031     0.073     0.783    18.890     0.443     2.228     0.719 
## birth_order_nonlinear4        0.011     0.031    -0.049     0.072     0.359    21.605     0.723     1.820     0.674 
## birth_order_nonlinear5        0.009     0.035    -0.060     0.078     0.256    24.146     0.800     1.567     0.639 
## birth_order_nonlinear5+       0.048     0.041    -0.032     0.128     1.174    16.257     0.257     2.907     0.771 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.015     0.005    -0.933    13.635     0.367     4.332     0.835 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.106    18.332     0.917     2.341     0.729 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.356    17.813     0.192     2.458     0.739 
## male                          0.009     0.011    -0.013     0.031     0.811    87.876     0.419     0.471     0.335 
## sibling_count                -0.027     0.004    -0.035    -0.018    -6.089    20.185     0.000     2.010     0.696 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.685 
## ICC|mother_pidlink                     0.290 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-74" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-18" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-75" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.065     0.052     0.306     2.765    12.636     0.016     5.408     0.864 
## count_birth_order2/2          0.028     0.025    -0.022     0.077     1.099    64.587     0.276     0.596     0.392 
## count_birth_order1/3          0.020     0.040    -0.057     0.098     0.512    29.529     0.612     1.233     0.580 
## count_birth_order2/3          0.014     0.044    -0.073     0.101     0.310    21.653     0.760     1.815     0.674 
## count_birth_order3/3          0.032     0.038    -0.042     0.105     0.839    32.627     0.407     1.106     0.552 
## count_birth_order1/4         -0.043     0.044    -0.130     0.044    -0.968    46.657     0.338     0.783     0.462 
## count_birth_order2/4         -0.013     0.050    -0.110     0.085    -0.257    29.587     0.799     1.230     0.579 
## count_birth_order3/4         -0.072     0.041    -0.152     0.009    -1.753    59.705     0.085     0.635     0.408 
## count_birth_order4/4         -0.018     0.052    -0.120     0.083    -0.356    21.925     0.725     1.783     0.670 
## count_birth_order1/5         -0.040     0.055    -0.149     0.068    -0.732    46.010     0.468     0.793     0.465 
## count_birth_order2/5         -0.037     0.052    -0.139     0.065    -0.716    73.594     0.476     0.538     0.367 
## count_birth_order3/5         -0.016     0.050    -0.113     0.082    -0.311    68.644     0.756     0.568     0.380 
## count_birth_order4/5         -0.044     0.051    -0.145     0.057    -0.855    52.725     0.397     0.704     0.434 
## count_birth_order5/5          0.001     0.045    -0.088     0.090     0.023    76.020     0.982     0.525     0.361 
## count_birth_order1/5+        -0.169     0.048    -0.263    -0.075    -3.540    30.595     0.001     1.185     0.570 
## count_birth_order2/5+        -0.180     0.044    -0.267    -0.092    -4.038    41.122     0.000     0.879     0.492 
## count_birth_order3/5+        -0.163     0.049    -0.259    -0.067    -3.320    25.717     0.003     1.448     0.620 
## count_birth_order4/5+        -0.191     0.049    -0.287    -0.096    -3.922    24.620     0.001     1.529     0.633 
## count_birth_order5/5+        -0.201     0.043    -0.285    -0.117    -4.698    35.249     0.000     1.021     0.531 
## count_birth_order5+/5+       -0.157     0.034    -0.224    -0.090    -4.587    29.250     0.000     1.246     0.582 
## poly(age, 3, raw = TRUE)1    -0.004     0.006    -0.016     0.007    -0.733    16.030     0.474     2.989     0.776 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.292    24.425     0.773     1.545     0.636 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.453    29.404     0.157     1.238     0.581 
## male                          0.001     0.013    -0.023     0.026     0.114    55.725     0.909     0.672     0.422 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.683 
## ICC|mother_pidlink                     0.291 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-75" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-18" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1004.517       13  530.009    0.000    0.097 
##   2 vs 3:    0.414        4   11.145    0.795    2.703 
##   3 vs 4:    1.834        1   14.213    0.197    3.896 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-9" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-19" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-76" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.259     0.056     0.150     0.368     4.661    10.713     0.001    10.986     0.929 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.016     0.004    -1.244    13.559     0.235     4.397     0.837 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.200    16.998     0.844     2.672     0.755 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.217    16.391     0.241     2.861     0.768 
## male                          0.009     0.011    -0.013     0.031     0.792    88.472     0.431     0.468     0.334 
## sibling_count                -0.028     0.004    -0.037    -0.019    -6.379    32.399     0.000     1.114     0.554 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.283 
## Residual~~Residual                     0.685 
## ICC|mother_pidlink                     0.292 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-76" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-19" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-77" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.245     0.057     0.132     0.358     4.265    10.663     0.001    11.304     0.931 
## birth_order                   0.017     0.008     0.001     0.032     2.083    14.504     0.055     3.711     0.812 
## poly(age, 3, raw = TRUE)1    -0.007     0.005    -0.017     0.003    -1.301    13.666     0.215     4.306     0.834 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.468    18.590     0.645     2.287     0.724 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.569    18.093     0.134     2.393     0.733 
## male                          0.009     0.011    -0.013     0.031     0.791    89.142     0.431     0.466     0.333 
## sibling_count                -0.038     0.007    -0.051    -0.025    -5.648    18.765     0.000     2.252     0.721 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.282 
## Residual~~Residual                     0.684 
## ICC|mother_pidlink                     0.292 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-77" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-216-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-19" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-78" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.263     0.056     0.154     0.373     4.717    10.949     0.001     9.709     0.920 
## birth_order_nonlinear2        0.014     0.017    -0.019     0.047     0.847    32.017     0.403     1.129     0.557 
## birth_order_nonlinear3        0.031     0.024    -0.016     0.079     1.284    23.282     0.212     1.644     0.651 
## birth_order_nonlinear4        0.026     0.034    -0.041     0.092     0.753    21.004     0.460     1.895     0.683 
## birth_order_nonlinear5        0.010     0.043    -0.074     0.093     0.223    22.436     0.826     1.727     0.662 
## birth_order_nonlinear5+       0.081     0.056    -0.028     0.191     1.450    14.942     0.168     3.466     0.801 
## poly(age, 3, raw = TRUE)1    -0.007     0.005    -0.017     0.003    -1.295    13.790     0.217     4.205     0.831 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.525    18.838     0.605     2.238     0.719 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.656    18.661     0.114     2.273     0.723 
## male                          0.007     0.012    -0.016     0.030     0.596    71.404     0.553     0.550     0.372 
## sibling_count                -0.035     0.007    -0.049    -0.022    -5.183    18.297     0.000     2.348     0.729 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.283 
## Residual~~Residual                     0.683 
## ICC|mother_pidlink                     0.293 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-78" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-19" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-79" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.173     0.062     0.052     0.294     2.808    12.871     0.015     5.106     0.857 
## count_birth_order2/2          0.021     0.031    -0.040     0.082     0.678    20.925     0.505     1.906     0.685 
## count_birth_order1/3         -0.001     0.035    -0.069     0.068    -0.019    34.218     0.985     1.053     0.539 
## count_birth_order2/3         -0.005     0.033    -0.069     0.060    -0.138    32.793     0.891     1.100     0.550 
## count_birth_order3/3          0.022     0.035    -0.048     0.091     0.611    31.965     0.545     1.130     0.557 
## count_birth_order1/4         -0.047     0.052    -0.148     0.055    -0.905    25.283     0.374     1.479     0.625 
## count_birth_order2/4         -0.049     0.047    -0.141     0.043    -1.046    25.641     0.305     1.454     0.621 
## count_birth_order3/4         -0.055     0.041    -0.136     0.025    -1.355    43.168     0.182     0.840     0.480 
## count_birth_order4/4         -0.015     0.052    -0.116     0.087    -0.283    22.067     0.780     1.767     0.667 
## count_birth_order1/5         -0.115     0.062    -0.237     0.006    -1.865    37.333     0.070     0.965     0.516 
## count_birth_order2/5         -0.152     0.051    -0.252    -0.053    -2.997    72.764     0.004     0.542     0.369 
## count_birth_order3/5         -0.085     0.059    -0.200     0.030    -1.453    29.483     0.157     1.235     0.580 
## count_birth_order4/5         -0.109     0.061    -0.229     0.010    -1.797    25.738     0.084     1.447     0.620 
## count_birth_order5/5         -0.086     0.060    -0.204     0.032    -1.428    30.945     0.163     1.171     0.566 
## count_birth_order1/5+        -0.270     0.061    -0.390    -0.151    -4.430    30.455     0.000     1.191     0.571 
## count_birth_order2/5+        -0.227     0.063    -0.351    -0.104    -3.602    21.482     0.002     1.835     0.676 
## count_birth_order3/5+        -0.191     0.043    -0.275    -0.106    -4.420    92.279     0.000     0.454     0.327 
## count_birth_order4/5+        -0.217     0.056    -0.327    -0.107    -3.856    25.150     0.001     1.489     0.627 
## count_birth_order5/5+        -0.227     0.044    -0.313    -0.142    -5.217    70.959     0.000     0.553     0.374 
## count_birth_order5+/5+       -0.148     0.039    -0.224    -0.072    -3.828    38.382     0.000     0.939     0.509 
## poly(age, 3, raw = TRUE)1    -0.005     0.006    -0.015     0.006    -0.807    16.033     0.431     2.988     0.776 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.209    21.123     0.836     1.880     0.682 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.314    20.914     0.203     1.907     0.685 
## male                          0.006     0.013    -0.020     0.031     0.433    58.279     0.667     0.647     0.413 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.283 
## Residual~~Residual                     0.681 
## ICC|mother_pidlink                     0.294 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-79" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-19" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 640.225      13  14.601   0.000   1.148 
##  2 vs 3: 365.012       4  18.228   0.000   1.330 
##  3 vs 4:   4.046       1  14.564   0.063   3.675 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-9" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2007-old" class="section level3 tabset">
<h3>Raven 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-10" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-20" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-80" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.015     0.051    -0.086     0.115     0.285    11.046     0.781     9.271     0.917 
## poly(age, 3, raw = TRUE)1     0.005     0.005    -0.005     0.015     0.937    13.921     0.365     4.104     0.827 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.111    18.209     0.913     2.367     0.731 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.036    19.173     0.313     2.176     0.714 
## male                          0.049     0.011     0.027     0.070     4.409   124.116     0.000     0.369     0.281 
## sibling_count                -0.018     0.003    -0.024    -0.013    -6.343    32.409     0.000     1.114     0.554 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.275 
## Residual~~Residual                     0.718 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-80" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-20" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-81" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.009     0.052    -0.093     0.111     0.176    11.008     0.864     9.438     0.918 
## birth_order                   0.006     0.006    -0.005     0.017     1.018    15.174     0.325     3.350     0.795 
## poly(age, 3, raw = TRUE)1     0.005     0.005    -0.005     0.014     0.910    14.082     0.378     3.986     0.823 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.042    19.850     0.967     2.061     0.702 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.248    20.822     0.226     1.919     0.686 
## male                          0.049     0.011     0.027     0.070     4.407   123.801     0.000     0.369     0.281 
## sibling_count                -0.022     0.005    -0.032    -0.012    -4.454    17.383     0.000     2.566     0.747 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.275 
## Residual~~Residual                     0.718 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-81" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-226-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-20" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-82" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.010     0.050    -0.088     0.109     0.209    11.476     0.838     7.738     0.901 
## birth_order_nonlinear2        0.012     0.018    -0.024     0.049     0.677    30.049     0.503     1.209     0.575 
## birth_order_nonlinear3        0.014     0.026    -0.036     0.065     0.552    20.695     0.587     1.937     0.688 
## birth_order_nonlinear4        0.004     0.026    -0.047     0.055     0.152    39.759     0.880     0.908     0.500 
## birth_order_nonlinear5       -0.001     0.036    -0.070     0.069    -0.023    24.956     0.982     1.503     0.629 
## birth_order_nonlinear5+       0.028     0.037    -0.045     0.101     0.751    19.625     0.461     2.098     0.706 
## poly(age, 3, raw = TRUE)1     0.005     0.005    -0.005     0.015     0.966    14.225     0.350     3.888     0.819 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.082    19.459     0.936     2.126     0.709 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.099    20.576     0.284     1.953     0.690 
## male                          0.049     0.011     0.027     0.070     4.397   121.642     0.000     0.374     0.284 
## sibling_count                -0.020     0.004    -0.029    -0.012    -4.653    21.226     0.000     1.867     0.680 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.275 
## Residual~~Residual                     0.718 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-82" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-20" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-83" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.042     0.059    -0.157     0.074    -0.705    13.883     0.492     4.132     0.828 
## count_birth_order2/2          0.015     0.028    -0.040     0.069     0.533    40.986     0.597     0.882     0.493 
## count_birth_order1/3          0.011     0.038    -0.063     0.085     0.280    36.938     0.781     0.975     0.519 
## count_birth_order2/3         -0.000     0.048    -0.095     0.094    -0.010    19.034     0.992     2.201     0.716 
## count_birth_order3/3          0.018     0.038    -0.056     0.092     0.476    34.273     0.637     1.051     0.539 
## count_birth_order1/4         -0.015     0.053    -0.120     0.089    -0.288    25.053     0.776     1.496     0.628 
## count_birth_order2/4          0.003     0.053    -0.101     0.107     0.056    25.241     0.956     1.482     0.626 
## count_birth_order3/4         -0.068     0.043    -0.153     0.017    -1.573    48.727     0.122     0.754     0.452 
## count_birth_order4/4         -0.014     0.059    -0.129     0.101    -0.245    17.840     0.810     2.451     0.738 
## count_birth_order1/5         -0.024     0.055    -0.133     0.085    -0.435    48.659     0.666     0.755     0.452 
## count_birth_order2/5         -0.032     0.059    -0.147     0.083    -0.552    40.153     0.584     0.899     0.498 
## count_birth_order3/5         -0.019     0.052    -0.121     0.082    -0.377    60.380     0.707     0.629     0.405 
## count_birth_order4/5         -0.038     0.053    -0.143     0.067    -0.709    46.314     0.482     0.788     0.464 
## count_birth_order5/5         -0.002     0.046    -0.093     0.089    -0.049    70.809     0.961     0.554     0.374 
## count_birth_order1/5+        -0.140     0.055    -0.249    -0.032    -2.531    21.374     0.019     1.848     0.678 
## count_birth_order2/5+        -0.153     0.047    -0.246    -0.060    -3.238    34.216     0.003     1.053     0.539 
## count_birth_order3/5+        -0.115     0.050    -0.213    -0.016    -2.279    25.162     0.031     1.488     0.627 
## count_birth_order4/5+        -0.157     0.046    -0.247    -0.067    -3.427    30.800     0.002     1.177     0.568 
## count_birth_order5/5+        -0.168     0.043    -0.253    -0.083    -3.883    35.845     0.000     1.004     0.527 
## count_birth_order5+/5+       -0.132     0.035    -0.202    -0.063    -3.732    27.103     0.001     1.360     0.604 
## poly(age, 3, raw = TRUE)1     0.005     0.006    -0.007     0.017     0.838    16.255     0.414     2.908     0.771 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.190    21.497     0.851     1.833     0.676 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.224    26.041     0.232     1.427     0.616 
## male                          0.046     0.012     0.022     0.069     3.834   106.178     0.000     0.411     0.304 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.273 
## Residual~~Residual                     0.715 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-83" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-20" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 939.446      13 164.234   0.000   0.190 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   0.854       1  15.810   0.369   3.073 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-10" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-21" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-84" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.052    -0.084     0.118     0.325    11.107     0.751     9.017     0.914 
## poly(age, 3, raw = TRUE)1     0.004     0.005    -0.006     0.014     0.716    13.987     0.486     4.055     0.825 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.016    18.282     0.987     2.352     0.730 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.025    19.217     0.318     2.168     0.713 
## male                          0.049     0.011     0.027     0.070     4.380   122.003     0.000     0.373     0.283 
## sibling_count                -0.022     0.004    -0.030    -0.013    -5.046    34.254     0.000     1.052     0.539 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.276 
## Residual~~Residual                     0.718 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-84" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-233-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-21" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-85" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.007     0.053    -0.097     0.112     0.139    11.038     0.892     9.305     0.917 
## birth_order                   0.011     0.008    -0.005     0.027     1.338    14.417     0.202     3.764     0.814 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.013     0.690    14.075     0.501     3.991     0.823 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.183    19.169     0.857     2.177     0.714 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.226    19.980     0.234     2.041     0.700 
## male                          0.049     0.011     0.027     0.070     4.383   122.859     0.000     0.371     0.282 
## sibling_count                -0.028     0.007    -0.042    -0.014    -3.923    16.804     0.001     2.729     0.759 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.276 
## Residual~~Residual                     0.718 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-85" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-21" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-86" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.020     0.052    -0.083     0.123     0.382    11.334     0.709     8.182     0.906 
## birth_order_nonlinear2        0.007     0.017    -0.027     0.041     0.398    30.134     0.693     1.205     0.574 
## birth_order_nonlinear3        0.022     0.024    -0.026     0.069     0.897    24.677     0.378     1.525     0.633 
## birth_order_nonlinear4        0.004     0.034    -0.062     0.070     0.106    22.295     0.916     1.742     0.664 
## birth_order_nonlinear5       -0.006     0.044    -0.093     0.080    -0.143    21.756     0.888     1.803     0.672 
## birth_order_nonlinear5+       0.056     0.056    -0.055     0.166     0.991    15.209     0.337     3.334     0.795 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.007     0.014     0.650    13.837     0.527     4.168     0.829 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.250    18.406     0.805     2.325     0.727 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.289    19.452     0.212     2.127     0.709 
## male                          0.047     0.012     0.025     0.070     4.065    86.389     0.000     0.477     0.338 
## sibling_count                -0.026     0.007    -0.041    -0.012    -3.552    16.256     0.003     2.907     0.771 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.275 
## Residual~~Residual                     0.716 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-86" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-21" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-87" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.054     0.058    -0.167     0.058    -0.943    13.815     0.362     4.185     0.830 
## count_birth_order2/2          0.015     0.029    -0.042     0.073     0.524    25.650     0.605     1.453     0.621 
## count_birth_order1/3          0.000     0.030    -0.058     0.059     0.007    89.737     0.994     0.463     0.331 
## count_birth_order2/3         -0.008     0.031    -0.070     0.053    -0.266    43.642     0.792     0.832     0.478 
## count_birth_order3/3          0.017     0.032    -0.046     0.081     0.537    50.253     0.594     0.734     0.445 
## count_birth_order1/4         -0.033     0.061    -0.152     0.086    -0.551    18.500     0.588     2.306     0.726 
## count_birth_order2/4         -0.041     0.042    -0.123     0.042    -0.971    39.544     0.337     0.912     0.502 
## count_birth_order3/4         -0.053     0.047    -0.146     0.040    -1.123    26.685     0.272     1.385     0.609 
## count_birth_order4/4         -0.020     0.047    -0.112     0.073    -0.422    29.378     0.676     1.240     0.581 
## count_birth_order1/5         -0.081     0.064    -0.207     0.044    -1.274    35.078     0.211     1.026     0.532 
## count_birth_order2/5         -0.125     0.061    -0.244    -0.006    -2.052    31.979     0.048     1.130     0.557 
## count_birth_order3/5         -0.048     0.061    -0.167     0.071    -0.794    28.034     0.434     1.307     0.595 
## count_birth_order4/5         -0.111     0.055    -0.218    -0.004    -2.040    40.057     0.048     0.901     0.498 
## count_birth_order5/5         -0.071     0.062    -0.193     0.052    -1.134    29.147     0.266     1.251     0.583 
## count_birth_order1/5+        -0.212     0.060    -0.329    -0.095    -3.560    35.203     0.001     1.023     0.532 
## count_birth_order2/5+        -0.183     0.052    -0.285    -0.081    -3.529    42.092     0.001     0.860     0.486 
## count_birth_order3/5+        -0.152     0.048    -0.246    -0.057    -3.149    48.913     0.003     0.751     0.451 
## count_birth_order4/5+        -0.183     0.057    -0.294    -0.072    -3.229    25.852     0.003     1.439     0.618 
## count_birth_order5/5+        -0.190     0.040    -0.268    -0.112    -4.773   212.965     0.000     0.259     0.213 
## count_birth_order5+/5+       -0.120     0.040    -0.199    -0.042    -3.005    34.705     0.005     1.038     0.535 
## poly(age, 3, raw = TRUE)1     0.006     0.006    -0.005     0.017     1.023    16.405     0.321     2.856     0.767 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.072    21.986     0.943     1.776     0.669 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.951    22.038     0.352     1.770     0.668 
## male                          0.051     0.012     0.027     0.076     4.099   100.697     0.000     0.426     0.312 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.274 
## Residual~~Residual                     0.714 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-87" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-21" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 692.855      13  16.486   0.000   1.012 
##  2 vs 3: 356.992       4  17.189   0.000   1.426 
##  3 vs 4:   1.466       1  14.403   0.246   3.773 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-10" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2007-old" class="section level3 tabset">
<h3>Numeracy 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-11" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-22" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-88" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.408     0.053     0.303     0.513     7.638    10.721     0.000    10.935     0.928 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.004    -2.924    16.008     0.010     2.997     0.776 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.212    19.914     0.834     2.051     0.701 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.117    16.302     0.280     2.891     0.770 
## male                         -0.034     0.011    -0.055    -0.012    -3.087   107.910     0.003     0.406     0.302 
## sibling_count                -0.021     0.003    -0.027    -0.015    -7.014    26.758     0.000     1.381     0.608 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.688 
## ICC|mother_pidlink                     0.263 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-88" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-243-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-22" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-89" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.401     0.057     0.289     0.512     7.015    10.525     0.000    12.287     0.936 
## birth_order                   0.008     0.007    -0.005     0.022     1.221    12.516     0.245     5.578     0.868 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.005    -3.068    16.659     0.007     2.774     0.762 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.489    25.478     0.629     1.465     0.623 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.494    19.728     0.151     2.081     0.704 
## male                         -0.034     0.011    -0.055    -0.012    -3.090   107.882     0.003     0.406     0.302 
## sibling_count                -0.026     0.005    -0.035    -0.017    -5.663    18.637     0.000     2.278     0.723 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.263 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-89" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-245-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-22" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-90" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.401     0.056     0.291     0.511     7.138    10.766     0.000    10.671     0.927 
## birth_order_nonlinear2        0.023     0.019    -0.014     0.061     1.206    24.716     0.239     1.522     0.632 
## birth_order_nonlinear3        0.021     0.024    -0.025     0.067     0.910    24.413     0.372     1.546     0.636 
## birth_order_nonlinear4        0.015     0.033    -0.050     0.080     0.454    18.657     0.655     2.274     0.723 
## birth_order_nonlinear5        0.017     0.034    -0.050     0.084     0.501    26.260     0.620     1.412     0.614 
## birth_order_nonlinear5+       0.052     0.042    -0.031     0.134     1.226    15.557     0.238     3.177     0.786 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.004    -2.876    15.979     0.011     3.008     0.777 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.292    22.265     0.773     1.746     0.665 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.246    17.907     0.229     2.436     0.737 
## male                         -0.034     0.011    -0.055    -0.012    -3.089   106.142     0.003     0.411     0.304 
## sibling_count                -0.024     0.004    -0.031    -0.017    -6.539    28.992     0.000     1.258     0.585 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.688 
## ICC|mother_pidlink                     0.263 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-90" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-22" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-91" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.336     0.064     0.210     0.462     5.225    12.591     0.000     5.470     0.865 
## count_birth_order2/2          0.031     0.026    -0.019     0.082     1.210    54.366     0.232     0.686     0.428 
## count_birth_order1/3          0.023     0.036    -0.048     0.093     0.634    41.165     0.530     0.878     0.492 
## count_birth_order2/3          0.023     0.037    -0.049     0.096     0.629    35.172     0.534     1.024     0.532 
## count_birth_order3/3          0.035     0.034    -0.033     0.102     1.004    44.921     0.321     0.810     0.471 
## count_birth_order1/4         -0.056     0.039    -0.131     0.020    -1.445   119.081     0.151     0.379     0.287 
## count_birth_order2/4         -0.024     0.044    -0.111     0.063    -0.545    44.300     0.588     0.821     0.474 
## count_birth_order3/4         -0.052     0.039    -0.129     0.025    -1.317    74.006     0.192     0.535     0.366 
## count_birth_order4/4         -0.015     0.046    -0.106     0.075    -0.332    28.927     0.742     1.261     0.585 
## count_birth_order1/5         -0.042     0.055    -0.149     0.066    -0.760    44.821     0.451     0.812     0.471 
## count_birth_order2/5         -0.030     0.048    -0.125     0.064    -0.624   131.306     0.534     0.355     0.273 
## count_birth_order3/5         -0.006     0.044    -0.093     0.080    -0.147   224.952     0.883     0.250     0.207 
## count_birth_order4/5         -0.036     0.046    -0.126     0.054    -0.788   118.768     0.432     0.380     0.287 
## count_birth_order5/5          0.005     0.043    -0.080     0.090     0.105    97.822     0.917     0.435     0.317 
## count_birth_order1/5+        -0.138     0.037    -0.211    -0.066    -3.728   134.597     0.000     0.349     0.269 
## count_birth_order2/5+        -0.144     0.042    -0.225    -0.062    -3.435    53.629     0.001     0.694     0.431 
## count_birth_order3/5+        -0.153     0.042    -0.234    -0.071    -3.671    45.535     0.001     0.800     0.467 
## count_birth_order4/5+        -0.158     0.045    -0.246    -0.071    -3.546    31.072     0.001     1.165     0.565 
## count_birth_order5/5+        -0.163     0.041    -0.243    -0.084    -4.031    42.308     0.000     0.856     0.485 
## count_birth_order5+/5+       -0.129     0.035    -0.198    -0.060    -3.689    25.780     0.001     1.444     0.619 
## poly(age, 3, raw = TRUE)1    -0.012     0.005    -0.022    -0.002    -2.396    20.887     0.026     1.911     0.685 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.314    43.957     0.755     0.826     0.476 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.201    39.381     0.237     0.916     0.503 
## male                         -0.044     0.013    -0.069    -0.018    -3.355    47.738     0.002     0.767     0.457 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-91" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-249-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-22" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 802.492      13  62.164   0.000   0.349 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   1.374       1  12.999   0.262   4.955 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-11" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-23" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-92" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.411     0.053     0.307     0.514     7.767    10.847     0.000    10.222     0.924 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.023    -0.006    -3.226    15.959     0.005     3.016     0.777 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.367    19.798     0.717     2.070     0.703 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.103    16.327     0.286     2.883     0.769 
## male                         -0.034     0.011    -0.055    -0.013    -3.116   109.838     0.002     0.401     0.299 
## sibling_count                -0.025     0.004    -0.033    -0.016    -5.706    30.098     0.000     1.207     0.574 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.247 
## Residual~~Residual                     0.688 
## ICC|mother_pidlink                     0.265 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-92" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-252-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-23" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-93" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.397     0.056     0.286     0.507     7.041    10.667     0.000    11.276     0.930 
## birth_order                   0.017     0.009     0.000     0.033     1.967    13.642     0.070     4.326     0.835 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.023    -0.006    -3.322    16.249     0.004     2.910     0.771 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.672    23.247     0.508     1.647     0.651 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.466    18.566     0.159     2.292     0.724 
## male                         -0.034     0.011    -0.055    -0.013    -3.122   110.807     0.002     0.399     0.298 
## sibling_count                -0.034     0.006    -0.045    -0.023    -6.051    25.274     0.000     1.480     0.625 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.247 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.265 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-93" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-23" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-94" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.414     0.052     0.313     0.516     7.994    11.238     0.000     8.514     0.910 
## birth_order_nonlinear2        0.017     0.015    -0.014     0.047     1.077    42.550     0.288     0.852     0.484 
## birth_order_nonlinear3        0.031     0.022    -0.012     0.073     1.424    33.351     0.164     1.081     0.546 
## birth_order_nonlinear4        0.039     0.031    -0.022     0.100     1.252    25.812     0.222     1.442     0.619 
## birth_order_nonlinear5        0.022     0.037    -0.051     0.095     0.587    32.653     0.561     1.105     0.552 
## birth_order_nonlinear5+       0.077     0.059    -0.039     0.193     1.299    14.050     0.215     4.009     0.824 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.023    -0.006    -3.412    17.479     0.003     2.541     0.745 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.718    26.055     0.479     1.426     0.616 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.555    20.317     0.135     1.990     0.694 
## male                         -0.036     0.011    -0.058    -0.014    -3.195    92.975     0.002     0.452     0.325 
## sibling_count                -0.032     0.005    -0.043    -0.022    -5.996    30.404     0.000     1.193     0.571 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.265 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-94" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-256-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-23" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-95" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.338     0.057     0.226     0.450     5.923    13.559     0.000     4.397     0.837 
## count_birth_order2/2          0.020     0.029    -0.037     0.078     0.684    23.910     0.500     1.588     0.642 
## count_birth_order1/3         -0.001     0.039    -0.079     0.076    -0.035    22.822     0.973     1.688     0.657 
## count_birth_order2/3          0.000     0.034    -0.067     0.067     0.011    28.408     0.992     1.288     0.591 
## count_birth_order3/3          0.019     0.033    -0.047     0.085     0.568    37.549     0.573     0.959     0.515 
## count_birth_order1/4         -0.044     0.044    -0.129     0.042    -1.001    45.858     0.322     0.795     0.466 
## count_birth_order2/4         -0.041     0.050    -0.140     0.058    -0.817    21.014     0.423     1.894     0.683 
## count_birth_order3/4         -0.038     0.041    -0.118     0.042    -0.936    42.623     0.355     0.850     0.483 
## count_birth_order4/4         -0.003     0.051    -0.103     0.097    -0.061    22.154     0.952     1.758     0.666 
## count_birth_order1/5         -0.110     0.056    -0.219    -0.002    -1.989    63.786     0.051     0.602     0.394 
## count_birth_order2/5         -0.128     0.052    -0.230    -0.027    -2.477    60.035     0.016     0.632     0.407 
## count_birth_order3/5         -0.094     0.057    -0.205     0.017    -1.653    31.923     0.108     1.132     0.558 
## count_birth_order4/5         -0.070     0.062    -0.191     0.052    -1.122    23.927     0.273     1.586     0.642 
## count_birth_order5/5         -0.071     0.055    -0.179     0.037    -1.281    42.833     0.207     0.846     0.482 
## count_birth_order1/5+        -0.235     0.060    -0.353    -0.117    -3.910    31.128     0.000     1.163     0.565 
## count_birth_order2/5+        -0.194     0.066    -0.324    -0.064    -2.919    19.067     0.009     2.195     0.715 
## count_birth_order3/5+        -0.165     0.044    -0.251    -0.080    -3.799    78.917     0.000     0.510     0.354 
## count_birth_order4/5+        -0.177     0.050    -0.276    -0.079    -3.534    35.403     0.001     1.017     0.530 
## count_birth_order5/5+        -0.186     0.046    -0.276    -0.096    -4.057    48.286     0.000     0.760     0.454 
## count_birth_order5+/5+       -0.128     0.043    -0.213    -0.043    -2.947    24.447     0.007     1.543     0.635 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.022    -0.004    -2.785    21.490     0.011     1.834     0.676 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.444    26.177     0.661     1.418     0.615 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.281    22.472     0.213     1.724     0.662 
## male                         -0.042     0.014    -0.069    -0.015    -3.040    43.325     0.004     0.837     0.479 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.249 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.266 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-95" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-258-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-23" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 551.833      13  11.853   0.000   1.458 
##  2 vs 3: 378.310       4  20.140   0.000   1.188 
##  3 vs 4:   3.581       1  13.731   0.080   4.252 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-11" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2007-young" class="section level3 tabset">
<h3>g-factor 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-12" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-24" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-96" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.456     0.037    -0.528    -0.384   -12.356    12.937     0.000     5.026     0.855 
## poly(age, 3, raw = TRUE)1     0.030     0.004     0.022     0.038     7.211    16.590     0.000     2.796     0.763 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.240    21.574     0.813     1.824     0.675 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.105    20.516     0.282     1.961     0.691 
## male                          0.008     0.012    -0.015     0.031     0.673    45.564     0.504     0.800     0.467 
## sibling_count                -0.023     0.003    -0.029    -0.017    -7.665    25.615     0.000     1.456     0.621 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.265 
## Residual~~Residual                     0.617 
## ICC|mother_pidlink                     0.300 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-96" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-24" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-97" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.471     0.037    -0.545    -0.398   -12.596    12.922     0.000     5.044     0.855 
## birth_order                   0.016     0.006     0.004     0.028     2.642    13.185     0.020     4.753     0.848 
## poly(age, 3, raw = TRUE)1     0.029     0.004     0.021     0.037     7.115    16.712     0.000     2.757     0.761 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.272    22.801     0.788     1.690     0.657 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.695    22.098     0.104     1.764     0.667 
## male                          0.008     0.012    -0.015     0.031     0.671    45.557     0.506     0.800     0.467 
## sibling_count                -0.033     0.005    -0.043    -0.023    -6.250    14.831     0.000     3.525     0.804 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.265 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.301 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-97" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-264-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-24" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-98" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.466     0.038    -0.539    -0.392   -12.387    13.384     0.000     4.556     0.842 
## birth_order_nonlinear2        0.030     0.016    -0.001     0.062     1.898    39.260     0.065     0.919     0.503 
## birth_order_nonlinear3        0.035     0.021    -0.007     0.077     1.624    27.939     0.116     1.312     0.596 
## birth_order_nonlinear4        0.038     0.029    -0.019     0.096     1.304    21.487     0.206     1.834     0.676 
## birth_order_nonlinear5        0.043     0.040    -0.035     0.120     1.082    17.364     0.294     2.571     0.747 
## birth_order_nonlinear5+       0.091     0.042     0.008     0.173     2.151    14.704     0.048     3.595     0.807 
## poly(age, 3, raw = TRUE)1     0.030     0.004     0.022     0.038     7.377    17.185     0.000     2.619     0.751 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.065    23.461     0.948     1.627     0.648 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.341    22.536     0.193     1.717     0.661 
## male                          0.008     0.012    -0.015     0.031     0.664    46.828     0.510     0.781     0.461 
## sibling_count                -0.030     0.005    -0.039    -0.020    -6.192    16.357     0.000     2.873     0.768 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.300 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-98" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-266-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-24" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-99" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.543     0.052    -0.644    -0.441   -10.458    14.875     0.000     3.502     0.803 
## count_birth_order2/2          0.038     0.026    -0.013     0.090     1.461    38.149     0.152     0.944     0.511 
## count_birth_order1/3          0.010     0.035    -0.058     0.078     0.279    41.417     0.781     0.873     0.490 
## count_birth_order2/3          0.011     0.038    -0.063     0.085     0.291    30.015     0.773     1.210     0.575 
## count_birth_order3/3          0.041     0.033    -0.024     0.105     1.238    49.020     0.222     0.750     0.450 
## count_birth_order1/4         -0.046     0.042    -0.129     0.036    -1.101    48.615     0.276     0.755     0.452 
## count_birth_order2/4         -0.014     0.046    -0.103     0.076    -0.297    33.171     0.769     1.087     0.547 
## count_birth_order3/4         -0.062     0.038    -0.138     0.013    -1.630    69.224     0.108     0.564     0.378 
## count_birth_order4/4         -0.002     0.057    -0.113     0.109    -0.037    17.149     0.971     2.629     0.752 
## count_birth_order1/5         -0.042     0.049    -0.139     0.054    -0.860    69.501     0.393     0.562     0.378 
## count_birth_order2/5         -0.032     0.052    -0.133     0.070    -0.613    55.271     0.542     0.677     0.424 
## count_birth_order3/5         -0.006     0.048    -0.100     0.087    -0.132    68.642     0.895     0.568     0.380 
## count_birth_order4/5         -0.017     0.044    -0.104     0.069    -0.390   117.741     0.697     0.382     0.288 
## count_birth_order5/5          0.029     0.049    -0.068     0.126     0.587    36.451     0.561     0.988     0.522 
## count_birth_order1/5+        -0.198     0.042    -0.280    -0.115    -4.702    41.877     0.000     0.864     0.487 
## count_birth_order2/5+        -0.178     0.046    -0.268    -0.087    -3.844    29.633     0.001     1.228     0.579 
## count_birth_order3/5+        -0.171     0.050    -0.269    -0.072    -3.402    21.663     0.003     1.813     0.673 
## count_birth_order4/5+        -0.181     0.047    -0.273    -0.089    -3.846    23.973     0.001     1.582     0.641 
## count_birth_order5/5+        -0.187     0.038    -0.262    -0.111    -4.846    45.528     0.000     0.801     0.468 
## count_birth_order5+/5+       -0.136     0.031    -0.196    -0.075    -4.406    35.947     0.000     1.001     0.526 
## poly(age, 3, raw = TRUE)1     0.031     0.005     0.021     0.041     6.347    20.435     0.000     1.973     0.692 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.002    32.140     0.998     1.124     0.556 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.350    46.821     0.183     0.781     0.461 
## male                          0.001     0.013    -0.024     0.027     0.112    37.611     0.911     0.958     0.514 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.614 
## ICC|mother_pidlink                     0.301 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-99" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-24" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 844.997      13  95.872   0.000   0.263 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   6.555       1  13.111   0.024   4.831 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-12" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-25" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-100" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.455     0.037    -0.527    -0.383   -12.426    13.256     0.000     4.681     0.846 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.036     6.901    16.721     0.000     2.754     0.761 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.053    21.774     0.959     1.800     0.672 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.078    20.375     0.294     1.982     0.693 
## male                          0.008     0.012    -0.016     0.031     0.643    44.318     0.523     0.820     0.474 
## sibling_count                -0.026     0.004    -0.035    -0.018    -6.263    32.461     0.000     1.112     0.553 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.267 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.302 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-100" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-271-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-25" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-101" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.476     0.037    -0.549    -0.403   -12.807    13.291     0.000     4.646     0.845 
## birth_order                   0.025     0.006     0.012     0.037     3.814    18.158     0.001     2.379     0.732 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.036     6.790    16.622     0.000     2.785     0.763 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.389    22.309     0.701     1.741     0.664 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.568    21.176     0.132     1.873     0.681 
## male                          0.008     0.012    -0.016     0.031     0.641    44.007     0.525     0.826     0.476 
## sibling_count                -0.041     0.006    -0.052    -0.029    -6.946    22.412     0.000     1.730     0.663 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.267 
## Residual~~Residual                     0.615 
## ICC|mother_pidlink                     0.303 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-101" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-273-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-25" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-102" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.454     0.039    -0.531    -0.378   -11.646    13.201     0.000     4.736     0.847 
## birth_order_nonlinear2        0.023     0.013    -0.002     0.048     1.797   114.569     0.075     0.389     0.293 
## birth_order_nonlinear3        0.050     0.020     0.011     0.088     2.528    40.376     0.015     0.894     0.496 
## birth_order_nonlinear4        0.051     0.024     0.003     0.098     2.082    57.902     0.042     0.651     0.414 
## birth_order_nonlinear5        0.042     0.041    -0.039     0.123     1.007    21.558     0.325     1.826     0.675 
## birth_order_nonlinear5+       0.125     0.044     0.038     0.211     2.834    19.843     0.010     2.062     0.702 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.036     6.694    16.511     0.000     2.821     0.765 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.332    22.339     0.743     1.738     0.664 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.514    21.377     0.145     1.848     0.678 
## male                          0.006     0.012    -0.017     0.030     0.525    47.716     0.602     0.768     0.457 
## sibling_count                -0.038     0.005    -0.048    -0.027    -6.951    28.581     0.000     1.279     0.589 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.267 
## Residual~~Residual                     0.613 
## ICC|mother_pidlink                     0.303 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-102" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-275-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-25" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-103" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.546     0.045    -0.634    -0.458   -12.179    17.473     0.000     2.542     0.745 
## count_birth_order2/2          0.035     0.025    -0.014     0.084     1.384    33.109     0.176     1.089     0.548 
## count_birth_order1/3          0.013     0.031    -0.048     0.074     0.411    45.603     0.683     0.799     0.467 
## count_birth_order2/3          0.005     0.027    -0.047     0.057     0.191    79.175     0.849     0.509     0.353 
## count_birth_order3/3          0.040     0.033    -0.024     0.104     1.230    35.892     0.227     1.003     0.526 
## count_birth_order1/4         -0.053     0.038    -0.127     0.020    -1.419    97.605     0.159     0.436     0.318 
## count_birth_order2/4         -0.038     0.041    -0.120     0.043    -0.924    32.517     0.362     1.110     0.553 
## count_birth_order3/4         -0.034     0.035    -0.102     0.035    -0.963    84.176     0.338     0.486     0.342 
## count_birth_order4/4          0.013     0.038    -0.062     0.087     0.334    59.312     0.740     0.638     0.409 
## count_birth_order1/5         -0.097     0.055    -0.204     0.010    -1.781    54.798     0.080     0.681     0.426 
## count_birth_order2/5         -0.134     0.048    -0.229    -0.039    -2.769    72.292     0.007     0.545     0.370 
## count_birth_order3/5         -0.071     0.054    -0.177     0.034    -1.330    33.872     0.192     1.064     0.542 
## count_birth_order4/5         -0.101     0.045    -0.189    -0.012    -2.228    85.488     0.029     0.480     0.340 
## count_birth_order5/5         -0.049     0.061    -0.168     0.070    -0.806    25.954     0.428     1.432     0.617 
## count_birth_order1/5+        -0.296     0.052    -0.398    -0.195    -5.717    49.620     0.000     0.742     0.448 
## count_birth_order2/5+        -0.229     0.056    -0.338    -0.120    -4.122    26.153     0.000     1.419     0.615 
## count_birth_order3/5+        -0.171     0.049    -0.268    -0.075    -3.480    33.337     0.001     1.082     0.546 
## count_birth_order4/5+        -0.191     0.047    -0.283    -0.098    -4.029    38.549     0.000     0.935     0.508 
## count_birth_order5/5+        -0.207     0.038    -0.282    -0.132    -5.407   154.356     0.000     0.318     0.251 
## count_birth_order5+/5+       -0.113     0.036    -0.185    -0.042    -3.111    40.797     0.003     0.886     0.494 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.020     0.039     6.059    18.061     0.000     2.400     0.734 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.041    21.753     0.968     1.803     0.672 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.085    20.331     0.291     1.988     0.694 
## male                          0.005     0.013    -0.021     0.032     0.410    40.453     0.684     0.893     0.496 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.268 
## Residual~~Residual                     0.611 
## ICC|mother_pidlink                     0.305 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-103" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-25" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 567.246      13  12.685   0.000   1.344 
##  2 vs 3: 359.036       4  18.391   0.000   1.316 
##  3 vs 4:  13.991       1  17.873   0.002   2.444 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-12" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-279-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2007-young" class="section level3 tabset">
<h3>Raven 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-13" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-26" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-104" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.508     0.037    -0.580    -0.435   -13.740    12.836     0.000     5.148     0.858 
## poly(age, 3, raw = TRUE)1     0.031     0.004     0.023     0.039     7.625    16.966     0.000     2.681     0.756 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.158    20.936     0.876     1.904     0.684 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.107    22.675     0.280     1.703     0.659 
## male                          0.040     0.012     0.016     0.064     3.306    40.848     0.002     0.885     0.494 
## sibling_count                -0.022     0.003    -0.027    -0.016    -7.902    31.714     0.000     1.140     0.560 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.247 
## Residual~~Residual                     0.619 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-104" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-26" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-105" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.519     0.036    -0.590    -0.447   -14.282    13.149     0.000     4.791     0.849 
## birth_order                   0.012     0.006     0.000     0.023     1.983    13.644     0.068     4.325     0.835 
## poly(age, 3, raw = TRUE)1     0.030     0.004     0.022     0.038     7.503    16.882     0.000     2.706     0.757 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.194    20.769     0.848     1.926     0.687 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.506    22.913     0.146     1.679     0.656 
## male                          0.040     0.012     0.016     0.064     3.306    40.869     0.002     0.884     0.493 
## sibling_count                -0.029     0.005    -0.039    -0.019    -5.635    15.107     0.000     3.383     0.797 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.247 
## Residual~~Residual                     0.618 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-105" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-26" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-106" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.515     0.036    -0.586    -0.444   -14.184    13.711     0.000     4.268     0.833 
## birth_order_nonlinear2        0.022     0.016    -0.010     0.054     1.366    37.090     0.180     0.971     0.518 
## birth_order_nonlinear3        0.025     0.020    -0.015     0.065     1.237    32.171     0.225     1.123     0.556 
## birth_order_nonlinear4        0.029     0.029    -0.027     0.085     1.009    22.576     0.324     1.713     0.660 
## birth_order_nonlinear5        0.028     0.036    -0.043     0.099     0.777    20.154     0.446     2.014     0.697 
## birth_order_nonlinear5+       0.062     0.044    -0.024     0.147     1.414    14.202     0.179     3.903     0.820 
## poly(age, 3, raw = TRUE)1     0.031     0.004     0.023     0.039     7.725    17.349     0.000     2.575     0.748 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.052    21.401     0.959     1.845     0.677 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.241    23.750     0.227     1.601     0.644 
## male                          0.040     0.012     0.016     0.063     3.304    41.286     0.002     0.876     0.491 
## sibling_count                -0.026     0.005    -0.036    -0.017    -5.381    15.668     0.000     3.131     0.784 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.247 
## Residual~~Residual                     0.618 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-106" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-26" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-107" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.582     0.045    -0.670    -0.493   -12.916    17.856     0.000     2.448     0.738 
## count_birth_order2/2          0.025     0.023    -0.020     0.071     1.102    81.163     0.274     0.499     0.349 
## count_birth_order1/3          0.004     0.032    -0.058     0.066     0.125    63.870     0.901     0.601     0.394 
## count_birth_order2/3          0.000     0.036    -0.071     0.071     0.000    32.968     1.000     1.094     0.549 
## count_birth_order3/3          0.024     0.033    -0.040     0.089     0.737    46.137     0.465     0.791     0.464 
## count_birth_order1/4         -0.039     0.042    -0.122     0.044    -0.912    44.875     0.366     0.811     0.471 
## count_birth_order2/4         -0.012     0.046    -0.103     0.079    -0.262    30.981     0.795     1.169     0.566 
## count_birth_order3/4         -0.059     0.038    -0.134     0.016    -1.534    66.411     0.130     0.583     0.386 
## count_birth_order4/4         -0.000     0.053    -0.105     0.104    -0.008    18.645     0.993     2.276     0.723 
## count_birth_order1/5         -0.045     0.045    -0.134     0.043    -1.009   148.480     0.314     0.327     0.256 
## count_birth_order2/5         -0.036     0.049    -0.133     0.060    -0.739    74.149     0.462     0.535     0.365 
## count_birth_order3/5         -0.043     0.042    -0.126     0.041    -1.005   204.598     0.316     0.265     0.217 
## count_birth_order4/5         -0.036     0.049    -0.132     0.060    -0.730    51.145     0.469     0.723     0.441 
## count_birth_order5/5          0.010     0.049    -0.085     0.105     0.205    37.500     0.839     0.960     0.515 
## count_birth_order1/5+        -0.185     0.040    -0.264    -0.105    -4.567    49.235     0.000     0.747     0.449 
## count_birth_order2/5+        -0.172     0.053    -0.276    -0.068    -3.240    20.395     0.004     1.979     0.693 
## count_birth_order3/5+        -0.149     0.045    -0.236    -0.061    -3.337    29.203     0.002     1.248     0.583 
## count_birth_order4/5+        -0.173     0.039    -0.250    -0.096    -4.420    44.626     0.000     0.815     0.472 
## count_birth_order5/5+        -0.182     0.038    -0.255    -0.108    -4.813    48.902     0.000     0.751     0.451 
## count_birth_order5+/5+       -0.145     0.029    -0.202    -0.088    -4.955    43.495     0.000     0.834     0.478 
## poly(age, 3, raw = TRUE)1     0.032     0.005     0.023     0.041     6.803    21.670     0.000     1.813     0.673 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.037    27.822     0.971     1.319     0.597 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.135    38.133     0.264     0.945     0.511 
## male                          0.037     0.013     0.011     0.062     2.828    38.576     0.007     0.934     0.508 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-107" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-26" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 967.649      13 507.741   0.000   0.100 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   3.613       1  13.665   0.079   4.307 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-13" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-27" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-108" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.506     0.037    -0.578    -0.434   -13.713    13.066     0.000     4.881     0.851 
## poly(age, 3, raw = TRUE)1     0.029     0.004     0.021     0.037     7.193    16.622     0.000     2.785     0.763 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.018    20.698     0.986     1.936     0.688 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.085    22.670     0.289     1.703     0.659 
## male                          0.040     0.012     0.016     0.063     3.271    40.255     0.002     0.897     0.497 
## sibling_count                -0.025     0.004    -0.033    -0.018    -6.441    40.705     0.000     0.888     0.494 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.250 
## Residual~~Residual                     0.618 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-108" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-27" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-109" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.521     0.036    -0.592    -0.450   -14.404    13.506     0.000     4.444     0.839 
## birth_order                   0.018     0.007     0.005     0.031     2.667    17.475     0.016     2.542     0.745 
## poly(age, 3, raw = TRUE)1     0.029     0.004     0.021     0.037     7.096    16.497     0.000     2.826     0.765 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.316    20.463     0.755     1.969     0.692 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.422    22.618     0.169     1.709     0.660 
## male                          0.040     0.012     0.016     0.063     3.270    40.190     0.002     0.898     0.498 
## sibling_count                -0.035     0.006    -0.048    -0.023    -5.648    18.989     0.000     2.210     0.717 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.249 
## Residual~~Residual                     0.618 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-109" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-27" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-110" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.505     0.039    -0.582    -0.429   -12.935    13.085     0.000     4.860     0.851 
## birth_order_nonlinear2        0.016     0.014    -0.011     0.043     1.190    61.670     0.239     0.618     0.401 
## birth_order_nonlinear3        0.037     0.019     0.001     0.074     2.012    51.719     0.049     0.716     0.438 
## birth_order_nonlinear4        0.028     0.025    -0.020     0.076     1.158    54.423     0.252     0.685     0.427 
## birth_order_nonlinear5        0.015     0.044    -0.071     0.101     0.343    19.223     0.735     2.167     0.713 
## birth_order_nonlinear5+       0.091     0.040     0.012     0.170     2.264    24.204     0.033     1.563     0.638 
## poly(age, 3, raw = TRUE)1     0.029     0.004     0.021     0.037     6.979    16.492     0.000     2.828     0.766 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.338    20.450     0.739     1.971     0.692 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.436    22.221     0.165     1.750     0.665 
## male                          0.039     0.012     0.015     0.062     3.184    42.742     0.003     0.848     0.483 
## sibling_count                -0.033     0.006    -0.044    -0.021    -5.607    22.087     0.000     1.765     0.667 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.249 
## Residual~~Residual                     0.615 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-110" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-27" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-111" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.587     0.043    -0.671    -0.502   -13.642    18.418     0.000     2.323     0.727 
## count_birth_order2/2          0.024     0.024    -0.023     0.071     0.999    38.635     0.324     0.933     0.507 
## count_birth_order1/3          0.001     0.030    -0.058     0.061     0.034    49.531     0.973     0.743     0.448 
## count_birth_order2/3         -0.003     0.027    -0.056     0.051    -0.105    63.988     0.917     0.600     0.394 
## count_birth_order3/3          0.028     0.029    -0.029     0.085     0.961    60.830     0.340     0.625     0.404 
## count_birth_order1/4         -0.047     0.044    -0.133     0.039    -1.067    36.085     0.293     0.998     0.525 
## count_birth_order2/4         -0.045     0.041    -0.124     0.035    -1.101    34.576     0.278     1.042     0.536 
## count_birth_order3/4         -0.044     0.033    -0.110     0.021    -1.329   123.504     0.186     0.370     0.281 
## count_birth_order4/4         -0.005     0.037    -0.077     0.067    -0.131    68.116     0.896     0.571     0.381 
## count_birth_order1/5         -0.104     0.051    -0.205    -0.004    -2.036    81.954     0.045     0.496     0.347 
## count_birth_order2/5         -0.122     0.043    -0.207    -0.038    -2.851   257.826     0.005     0.230     0.193 
## count_birth_order3/5         -0.066     0.051    -0.166     0.035    -1.282    40.012     0.207     0.902     0.499 
## count_birth_order4/5         -0.104     0.056    -0.215     0.006    -1.848    27.423     0.075     1.341     0.601 
## count_birth_order5/5         -0.066     0.056    -0.177     0.044    -1.180    32.551     0.246     1.109     0.553 
## count_birth_order1/5+        -0.249     0.046    -0.339    -0.160    -5.467   126.636     0.000     0.363     0.278 
## count_birth_order2/5+        -0.211     0.058    -0.325    -0.097    -3.616    22.698     0.001     1.700     0.659 
## count_birth_order3/5+        -0.163     0.068    -0.296    -0.030    -2.397    15.973     0.029     3.010     0.777 
## count_birth_order4/5+        -0.197     0.048    -0.292    -0.103    -4.095    34.888     0.000     1.032     0.534 
## count_birth_order5/5+        -0.205     0.041    -0.286    -0.125    -4.993    72.776     0.000     0.542     0.369 
## count_birth_order5+/5+       -0.124     0.034    -0.190    -0.057    -3.632    54.853     0.001     0.681     0.426 
## poly(age, 3, raw = TRUE)1     0.031     0.005     0.022     0.040     6.739    20.186     0.000     2.010     0.696 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.032    23.156     0.975     1.656     0.652 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.045    23.405     0.307     1.632     0.649 
## male                          0.042     0.013     0.017     0.067     3.257    49.962     0.002     0.737     0.446 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.249 
## Residual~~Residual                     0.613 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-111" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-296-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-27" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 652.201      13  16.205   0.000   1.029 
##  2 vs 3: 370.460       4  19.110   0.000   1.259 
##  3 vs 4:   6.812       1  17.455   0.018   2.547 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-13" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2007-young" class="section level3 tabset">
<h3>Numeracy 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-14" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-28" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-112" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.281     0.041    -0.362    -0.201    -6.847    12.270     0.000     5.966     0.875 
## poly(age, 3, raw = TRUE)1     0.021     0.004     0.012     0.029     4.739    16.070     0.000     2.974     0.775 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.238    20.500     0.814     1.964     0.691 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.787    18.087     0.441     2.395     0.733 
## male                         -0.026     0.011    -0.049    -0.004    -2.277    68.330     0.026     0.570     0.381 
## sibling_count                -0.018     0.004    -0.025    -0.011    -4.891    17.486     0.000     2.539     0.745 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.276 
## Residual~~Residual                     0.669 
## ICC|mother_pidlink                     0.292 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-112" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-300-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-28" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-113" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.297     0.043    -0.381    -0.213    -6.921    12.033     0.000     6.399     0.883 
## birth_order                   0.017     0.007     0.004     0.029     2.500    12.909     0.027     5.060     0.856 
## poly(age, 3, raw = TRUE)1     0.020     0.004     0.012     0.029     4.709    16.524     0.000     2.817     0.765 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.259    25.043     0.798     1.497     0.628 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.398    21.835     0.176     1.793     0.671 
## male                         -0.026     0.011    -0.049    -0.004    -2.282    68.363     0.026     0.569     0.381 
## sibling_count                -0.028     0.006    -0.041    -0.016    -4.473    12.910     0.001     5.059     0.856 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.276 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.293 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-113" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-28" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-114" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.291     0.042    -0.374    -0.208    -6.887    12.548     0.000     5.532     0.867 
## birth_order_nonlinear2        0.031     0.015     0.001     0.060     2.019    63.092     0.048     0.607     0.397 
## birth_order_nonlinear3        0.035     0.021    -0.006     0.077     1.685    33.697     0.101     1.070     0.543 
## birth_order_nonlinear4        0.038     0.027    -0.016     0.091     1.379    28.975     0.178     1.259     0.585 
## birth_order_nonlinear5        0.047     0.040    -0.032     0.125     1.167    18.217     0.258     2.366     0.731 
## birth_order_nonlinear5+       0.096     0.043     0.012     0.179     2.247    15.202     0.040     3.337     0.795 
## poly(age, 3, raw = TRUE)1     0.021     0.004     0.013     0.029     4.910    16.896     0.000     2.702     0.757 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.062    25.090     0.951     1.493     0.627 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.060    21.595     0.301     1.821     0.674 
## male                         -0.026     0.011    -0.049    -0.004    -2.300    70.641     0.024     0.555     0.374 
## sibling_count                -0.025     0.006    -0.036    -0.014    -4.482    14.090     0.001     3.981     0.823 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.276 
## Residual~~Residual                     0.669 
## ICC|mother_pidlink                     0.292 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-114" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-304-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-28" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-115" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.358     0.054    -0.464    -0.251    -6.575    14.707     0.000     3.593     0.807 
## count_birth_order2/2          0.041     0.029    -0.016     0.098     1.423    30.569     0.165     1.186     0.570 
## count_birth_order1/3          0.013     0.035    -0.056     0.082     0.361    45.755     0.720     0.797     0.466 
## count_birth_order2/3          0.019     0.035    -0.050     0.088     0.546    45.141     0.588     0.807     0.470 
## count_birth_order3/3          0.046     0.032    -0.017     0.110     1.425    65.225     0.159     0.591     0.390 
## count_birth_order1/4         -0.041     0.043    -0.126     0.043    -0.964    52.728     0.339     0.704     0.434 
## count_birth_order2/4         -0.011     0.045    -0.100     0.078    -0.251    40.373     0.803     0.894     0.496 
## count_birth_order3/4         -0.050     0.040    -0.128     0.028    -1.248    70.003     0.216     0.559     0.376 
## count_birth_order4/4         -0.003     0.053    -0.106     0.101    -0.051    20.661     0.960     1.941     0.689 
## count_birth_order1/5         -0.027     0.052    -0.128     0.074    -0.527    64.970     0.600     0.593     0.391 
## count_birth_order2/5         -0.019     0.054    -0.126     0.087    -0.352    51.769     0.727     0.715     0.438 
## count_birth_order3/5          0.032     0.055    -0.075     0.139     0.584    39.722     0.563     0.908     0.501 
## count_birth_order4/5          0.005     0.045    -0.083     0.093     0.116   155.203     0.908     0.317     0.250 
## count_birth_order5/5          0.041     0.053    -0.063     0.144     0.767    32.356     0.448     1.116     0.554 
## count_birth_order1/5+        -0.157     0.048    -0.251    -0.064    -3.312    30.166     0.002     1.204     0.574 
## count_birth_order2/5+        -0.135     0.045    -0.224    -0.046    -2.980    36.449     0.005     0.988     0.522 
## count_birth_order3/5+        -0.146     0.053    -0.249    -0.042    -2.764    21.143     0.012     1.877     0.681 
## count_birth_order4/5+        -0.140     0.055    -0.247    -0.032    -2.548    18.734     0.020     2.259     0.721 
## count_birth_order5/5+        -0.141     0.039    -0.218    -0.064    -3.575    49.394     0.001     0.745     0.449 
## count_birth_order5+/5+       -0.092     0.030    -0.151    -0.032    -3.013    45.142     0.004     0.807     0.470 
## poly(age, 3, raw = TRUE)1     0.022     0.005     0.012     0.031     4.275    20.563     0.000     1.955     0.690 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.020    32.295     0.984     1.118     0.555 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.058    37.833     0.297     0.952     0.513 
## male                         -0.034     0.013    -0.060    -0.008    -2.591    42.975     0.013     0.844     0.481 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.277 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.293 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-115" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-306-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-28" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 912.944      13 162.459   0.000   0.191 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   5.809       1  12.818   0.032   5.171 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-14" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-29" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-116" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.281     0.041    -0.361    -0.200    -6.837    12.456     0.000     5.668     0.869 
## poly(age, 3, raw = TRUE)1     0.020     0.004     0.011     0.028     4.542    16.404     0.000     2.857     0.767 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.098    20.941     0.923     1.903     0.684 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.767    17.993     0.453     2.416     0.735 
## male                         -0.026     0.012    -0.049    -0.004    -2.289    66.237     0.025     0.584     0.387 
## sibling_count                -0.021     0.005    -0.031    -0.011    -4.048    20.749     0.001     1.929     0.687 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.278 
## Residual~~Residual                     0.669 
## ICC|mother_pidlink                     0.294 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-116" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-29" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-117" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.302     0.043    -0.387    -0.218    -7.019    12.212     0.000     6.065     0.877 
## birth_order                   0.025     0.007     0.011     0.039     3.464    16.212     0.003     2.923     0.772 
## poly(age, 3, raw = TRUE)1     0.019     0.004     0.011     0.028     4.482    16.507     0.000     2.822     0.765 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.337    23.771     0.739     1.600     0.644 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.265    20.240     0.220     2.001     0.695 
## male                         -0.026     0.012    -0.049    -0.004    -2.289    65.560     0.025     0.589     0.389 
## sibling_count                -0.035     0.007    -0.049    -0.021    -4.881    16.333     0.000     2.881     0.769 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.278 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.294 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-117" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-311-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-29" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-118" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.280     0.043    -0.364    -0.197    -6.573    12.655     0.000     5.382     0.863 
## birth_order_nonlinear2        0.024     0.013    -0.001     0.048     1.871   233.123     0.063     0.245     0.203 
## birth_order_nonlinear3        0.049     0.021     0.007     0.090     2.314    35.584     0.027     1.012     0.529 
## birth_order_nonlinear4        0.059     0.028     0.004     0.115     2.107    34.390     0.042     1.047     0.538 
## birth_order_nonlinear5        0.057     0.042    -0.025     0.139     1.359    22.864     0.187     1.684     0.656 
## birth_order_nonlinear5+       0.124     0.052     0.021     0.227     2.362    15.950     0.031     3.019     0.777 
## poly(age, 3, raw = TRUE)1     0.020     0.004     0.011     0.028     4.432    16.216     0.000     2.921     0.772 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.212    23.042     0.834     1.666     0.654 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.129    19.787     0.272     2.071     0.703 
## male                         -0.028     0.012    -0.051    -0.005    -2.357    62.883     0.022     0.609     0.397 
## sibling_count                -0.032     0.007    -0.046    -0.019    -4.687    17.817     0.000     2.457     0.739 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.278 
## Residual~~Residual                     0.667 
## ICC|mother_pidlink                     0.294 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-118" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-313-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-29" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-119" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.358     0.045    -0.447    -0.270    -7.941    18.356     0.000     2.336     0.728 
## count_birth_order2/2          0.036     0.024    -0.011     0.084     1.511    47.403     0.138     0.772     0.458 
## count_birth_order1/3          0.021     0.031    -0.040     0.082     0.678    56.145     0.500     0.668     0.421 
## count_birth_order2/3          0.011     0.028    -0.044     0.067     0.401    65.642     0.690     0.588     0.389 
## count_birth_order3/3          0.042     0.035    -0.027     0.110     1.189    31.779     0.243     1.138     0.559 
## count_birth_order1/4         -0.045     0.042    -0.127     0.036    -1.088    58.808     0.281     0.643     0.411 
## count_birth_order2/4         -0.022     0.040    -0.101     0.057    -0.544    42.470     0.589     0.853     0.484 
## count_birth_order3/4         -0.014     0.040    -0.093     0.065    -0.351    45.022     0.727     0.809     0.470 
## count_birth_order4/4          0.027     0.044    -0.060     0.114     0.615    33.668     0.543     1.071     0.543 
## count_birth_order1/5         -0.064     0.057    -0.177     0.048    -1.118    50.947     0.269     0.725     0.442 
## count_birth_order2/5         -0.110     0.059    -0.226     0.005    -1.877    32.501     0.070     1.111     0.553 
## count_birth_order3/5         -0.058     0.058    -0.173     0.056    -0.998    28.935     0.326     1.261     0.585 
## count_birth_order4/5         -0.070     0.047    -0.163     0.023    -1.470    78.284     0.146     0.513     0.355 
## count_birth_order5/5         -0.018     0.062    -0.140     0.104    -0.288    26.936     0.775     1.370     0.606 
## count_birth_order1/5+        -0.264     0.066    -0.394    -0.134    -3.970    23.193     0.001     1.652     0.652 
## count_birth_order2/5+        -0.186     0.061    -0.306    -0.066    -3.033    22.391     0.006     1.732     0.663 
## count_birth_order3/5+        -0.135     0.065    -0.261    -0.008    -2.081    18.387     0.052     2.329     0.728 
## count_birth_order4/5+        -0.133     0.048    -0.228    -0.038    -2.757    41.621     0.009     0.869     0.489 
## count_birth_order5/5+        -0.153     0.042    -0.234    -0.072    -3.686    97.067     0.000     0.438     0.318 
## count_birth_order5+/5+       -0.075     0.041    -0.155     0.006    -1.814    29.366     0.080     1.240     0.581 
## poly(age, 3, raw = TRUE)1     0.021     0.005     0.011     0.031     4.117    18.535     0.001     2.298     0.725 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.025    22.471     0.981     1.724     0.662 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.838    19.216     0.412     2.168     0.713 
## male                         -0.032     0.014    -0.059    -0.005    -2.325    41.600     0.025     0.870     0.489 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.666 
## ICC|mother_pidlink                     0.297 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-119" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-315-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-29" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 625.148      13  14.263   0.000   1.177 
##  2 vs 3: 352.828       4  17.792   0.000   1.368 
##  3 vs 4:  11.449       1  15.980   0.004   3.008 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-14" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-317-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="personality" class="section level2 tabset">
<h2>Personality</h2>
<div id="extraversion" class="section level3 tabset">
<h3>Extraversion</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_ext)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-15" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-30" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-120" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.182     0.031     0.122     0.242     5.953    16.443     0.000     2.844     0.767 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.004    -0.813    25.943     0.423     1.433     0.617 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.566    41.198     0.575     0.878     0.491 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.954    62.605     0.344     0.611     0.398 
## male                         -0.244     0.015    -0.273    -0.216   -16.750    31.207     0.000     1.160     0.564 
## sibling_count                -0.003     0.002    -0.007     0.001    -1.423    50.395     0.161     0.732     0.444 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-120" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-30" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-121" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.181     0.031     0.120     0.243     5.787    16.186     0.000     2.932     0.772 
## birth_order                   0.001     0.004    -0.007     0.010     0.273    32.459     0.787     1.112     0.553 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.004    -0.818    25.805     0.421     1.442     0.619 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.583    38.852     0.563     0.928     0.506 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.968    57.182     0.337     0.658     0.417 
## male                         -0.244     0.015    -0.273    -0.216   -16.754    31.229     0.000     1.159     0.564 
## sibling_count                -0.004     0.003    -0.009     0.002    -1.310   100.073     0.193     0.428     0.313 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-121" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-30" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-122" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.033     0.116     0.244     5.507    16.615     0.000     2.788     0.763 
## birth_order_nonlinear2        0.016     0.018    -0.020     0.051     0.864    44.702     0.392     0.814     0.472 
## birth_order_nonlinear3        0.002     0.021    -0.040     0.044     0.079    47.411     0.937     0.772     0.458 
## birth_order_nonlinear4       -0.000     0.023    -0.046     0.045    -0.006   139.290     0.995     0.341     0.265 
## birth_order_nonlinear5        0.019     0.037    -0.054     0.092     0.506    26.138     0.617     1.420     0.615 
## birth_order_nonlinear5+       0.029     0.032    -0.034     0.092     0.910    35.734     0.369     1.007     0.528 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.004    -0.809    25.963     0.426     1.432     0.617 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.610    42.540     0.545     0.852     0.484 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.011    68.787     0.316     0.567     0.379 
## male                         -0.244     0.015    -0.273    -0.216   -16.766    31.313     0.000     1.156     0.563 
## sibling_count                -0.005     0.003    -0.010     0.000    -1.847   157.904     0.067     0.314     0.248 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-122" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-30" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-123" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.184     0.045     0.095     0.273     4.045    19.593     0.001     2.103     0.706 
## count_birth_order2/2          0.004     0.029    -0.054     0.061     0.122    54.111     0.904     0.689     0.429 
## count_birth_order1/3         -0.003     0.030    -0.062     0.056    -0.114   245.010     0.909     0.237     0.198 
## count_birth_order2/3          0.005     0.040    -0.073     0.082     0.117    31.878     0.907     1.134     0.558 
## count_birth_order3/3         -0.006     0.033    -0.070     0.058    -0.182    72.224     0.856     0.546     0.370 
## count_birth_order1/4         -0.023     0.045    -0.111     0.065    -0.506    51.420     0.615     0.719     0.440 
## count_birth_order2/4          0.036     0.041    -0.044     0.116     0.884   102.062     0.379     0.422     0.310 
## count_birth_order3/4         -0.028     0.041    -0.109     0.053    -0.673    68.788     0.503     0.567     0.379 
## count_birth_order4/4         -0.033     0.041    -0.112     0.047    -0.811    60.666     0.420     0.626     0.404 
## count_birth_order1/5         -0.021     0.048    -0.116     0.074    -0.433   182.735     0.665     0.285     0.230 
## count_birth_order2/5         -0.037     0.049    -0.133     0.059    -0.750   198.303     0.454     0.271     0.221 
## count_birth_order3/5         -0.019     0.050    -0.118     0.080    -0.379    83.615     0.705     0.488     0.344 
## count_birth_order4/5         -0.003     0.057    -0.115     0.109    -0.049    37.216     0.961     0.968     0.517 
## count_birth_order5/5         -0.009     0.049    -0.105     0.087    -0.193    53.879     0.848     0.691     0.429 
## count_birth_order1/5+        -0.021     0.042    -0.103     0.061    -0.499    68.730     0.619     0.567     0.380 
## count_birth_order2/5+        -0.003     0.041    -0.083     0.077    -0.083    89.861     0.934     0.463     0.331 
## count_birth_order3/5+        -0.020     0.038    -0.095     0.055    -0.524   114.156     0.601     0.390     0.293 
## count_birth_order4/5+        -0.025     0.036    -0.096     0.047    -0.680   156.491     0.497     0.315     0.249 
## count_birth_order5/5+        -0.009     0.047    -0.102     0.083    -0.201    28.541     0.842     1.281     0.589 
## count_birth_order5+/5+       -0.013     0.032    -0.076     0.051    -0.394    31.562     0.696     1.146     0.561 
## poly(age, 3, raw = TRUE)1    -0.004     0.005    -0.014     0.006    -0.823    22.846     0.419     1.686     0.656 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.718    31.747     0.478     1.139     0.559 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.032    42.807     0.308     0.847     0.482 
## male                         -0.248     0.017    -0.280    -0.215   -14.951    26.096     0.000     1.423     0.616 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-123" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-325-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-30" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1027.051       13 1071.969    0.000    0.067 
##   2 vs 3:    3.215        4   34.743    0.024    0.705 
##   3 vs 4:    0.107        1   51.561    0.745    0.718 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-15" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-31" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-124" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.187     0.032     0.124     0.250     5.839    15.790     0.000     3.081     0.781 
## poly(age, 3, raw = TRUE)1    -0.003     0.003    -0.009     0.004    -0.792    28.563     0.435     1.280     0.589 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.566    42.950     0.574     0.844     0.481 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.968    61.508     0.337     0.619     0.402 
## male                         -0.244     0.015    -0.273    -0.216   -16.750    31.236     0.000     1.159     0.564 
## sibling_count                -0.006     0.003    -0.013     0.000    -1.843    40.007     0.073     0.902     0.499 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-124" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-328-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-31" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-125" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.185     0.034     0.119     0.251     5.488    15.142     0.000     3.366     0.796 
## birth_order                   0.003     0.006    -0.010     0.015     0.418    25.130     0.680     1.490     0.627 
## poly(age, 3, raw = TRUE)1    -0.003     0.003    -0.009     0.004    -0.799    28.731     0.431     1.271     0.587 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.599    43.146     0.552     0.841     0.480 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.004    60.979     0.319     0.624     0.403 
## male                         -0.244     0.015    -0.273    -0.216   -16.761    31.302     0.000     1.156     0.563 
## sibling_count                -0.008     0.005    -0.017     0.001    -1.676    39.268     0.102     0.918     0.503 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-125" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-31" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-126" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.183     0.032     0.121     0.245     5.815    17.940     0.000     2.428     0.736 
## birth_order_nonlinear2        0.005     0.015    -0.025     0.035     0.339    76.014     0.736     0.525     0.361 
## birth_order_nonlinear3        0.009     0.027    -0.044     0.063     0.334    21.595     0.742     1.821     0.674 
## birth_order_nonlinear4        0.026     0.030    -0.032     0.084     0.883    42.362     0.382     0.855     0.485 
## birth_order_nonlinear5        0.039     0.040    -0.039     0.117     0.983    37.986     0.332     0.948     0.512 
## birth_order_nonlinear5+      -0.008     0.040    -0.087     0.071    -0.206    40.170     0.838     0.899     0.498 
## poly(age, 3, raw = TRUE)1    -0.002     0.003    -0.009     0.004    -0.720    29.809     0.477     1.220     0.577 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.522    41.807     0.604     0.866     0.488 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.908    50.481     0.368     0.731     0.444 
## male                         -0.242     0.014    -0.270    -0.215   -17.421    39.859     0.000     0.905     0.500 
## sibling_count                -0.008     0.005    -0.017     0.001    -1.698    41.932     0.097     0.863     0.487 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-126" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-332-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-31" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-127" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.168     0.036     0.098     0.239     4.668    32.160     0.000     1.123     0.556 
## count_birth_order2/2          0.001     0.023    -0.043     0.046     0.059   223.026     0.953     0.251     0.208 
## count_birth_order1/3         -0.023     0.034    -0.090     0.044    -0.678    42.497     0.502     0.853     0.484 
## count_birth_order2/3         -0.011     0.030    -0.069     0.047    -0.367    62.673     0.715     0.610     0.398 
## count_birth_order3/3          0.000     0.034    -0.067     0.067     0.001    41.209     0.999     0.877     0.491 
## count_birth_order1/4         -0.013     0.045    -0.101     0.076    -0.279    48.869     0.781     0.752     0.451 
## count_birth_order2/4         -0.041     0.045    -0.128     0.047    -0.911    32.801     0.369     1.100     0.550 
## count_birth_order3/4         -0.017     0.039    -0.094     0.059    -0.437    68.332     0.663     0.570     0.381 
## count_birth_order4/4          0.006     0.046    -0.084     0.095     0.125    35.753     0.901     1.007     0.527 
## count_birth_order1/5         -0.057     0.065    -0.184     0.069    -0.889    38.799     0.379     0.929     0.506 
## count_birth_order2/5         -0.053     0.047    -0.144     0.038    -1.140   378.419     0.255     0.182     0.159 
## count_birth_order3/5         -0.033     0.055    -0.141     0.075    -0.601    44.742     0.551     0.813     0.472 
## count_birth_order4/5         -0.017     0.068    -0.150     0.116    -0.248    21.689     0.806     1.810     0.673 
## count_birth_order5/5         -0.021     0.063    -0.145     0.103    -0.336    31.182     0.739     1.161     0.564 
## count_birth_order1/5+        -0.067     0.054    -0.172     0.038    -1.245    73.154     0.217     0.540     0.368 
## count_birth_order2/5+        -0.036     0.049    -0.133     0.060    -0.737    64.516     0.464     0.596     0.392 
## count_birth_order3/5+        -0.046     0.044    -0.133     0.041    -1.026    95.143     0.307     0.444     0.322 
## count_birth_order4/5+        -0.025     0.056    -0.135     0.084    -0.451    28.142     0.656     1.302     0.593 
## count_birth_order5/5+        -0.006     0.050    -0.103     0.092    -0.111    40.300     0.912     0.896     0.497 
## count_birth_order5+/5+       -0.071     0.036    -0.141    -0.002    -2.013    47.283     0.050     0.774     0.459 
## poly(age, 3, raw = TRUE)1    -0.001     0.004    -0.009     0.007    -0.277    30.821     0.784     1.176     0.568 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.202    41.494     0.841     0.872     0.490 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.617    46.474     0.540     0.786     0.463 
## male                         -0.246     0.017    -0.278    -0.213   -14.705    28.454     0.000     1.285     0.590 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.921 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-127" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-334-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-31" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 713.886      13  17.592   0.000   0.949 
##  2 vs 3: 400.684       4  20.355   0.000   1.174 
##  3 vs 4:   0.198       1  35.272   0.659   1.021 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-15" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
</div>
</div>
<div id="neuroticism" class="section level3 tabset">
<h3>Neuroticism</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-16" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-32" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-128" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.204     0.022     0.160     0.248     9.103    33.578     0.000     1.073     0.544 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -1.979    44.120     0.054     0.824     0.475 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.011    92.399     0.047     0.454     0.327 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.681   110.787     0.008     0.399     0.298 
## male                          0.036     0.012     0.013     0.059     3.118   125.969     0.002     0.365     0.279 
## sibling_count                -0.007     0.002    -0.011    -0.003    -3.497    62.523     0.001     0.611     0.398 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-128" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-338-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-32" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-129" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.203     0.023     0.157     0.248     8.742    30.858     0.000     1.174     0.567 
## birth_order                   0.001     0.004    -0.006     0.008     0.365   128.708     0.716     0.359     0.276 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -1.998    45.350     0.052     0.803     0.468 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.004   109.507     0.048     0.402     0.299 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.660   126.540     0.009     0.364     0.278 
## male                          0.036     0.012     0.013     0.059     3.117   125.707     0.002     0.365     0.279 
## sibling_count                -0.008     0.003    -0.014    -0.002    -2.755    95.506     0.007     0.443     0.321 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-129" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-340-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-32" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-130" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.204     0.024     0.157     0.250     8.569    35.187     0.000     1.023     0.532 
## birth_order_nonlinear2        0.001     0.017    -0.034     0.035     0.030    53.908     0.976     0.691     0.429 
## birth_order_nonlinear3        0.003     0.017    -0.029     0.036     0.190  2377.032     0.850     0.066     0.062 
## birth_order_nonlinear4        0.001     0.025    -0.048     0.049     0.024    77.493     0.981     0.517     0.357 
## birth_order_nonlinear5        0.027     0.032    -0.036     0.091     0.835    43.654     0.409     0.832     0.477 
## birth_order_nonlinear5+       0.005     0.025    -0.043     0.053     0.195   419.812     0.846     0.172     0.150 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -1.991    45.477     0.052     0.801     0.468 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.005   101.772     0.048     0.423     0.311 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.660   115.549     0.009     0.387     0.291 
## male                          0.036     0.012     0.013     0.059     3.100   120.270     0.002     0.377     0.285 
## sibling_count                -0.008     0.003    -0.013    -0.002    -2.826    78.726     0.006     0.511     0.354 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-130" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-342-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-32" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-131" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.037     0.085     0.230     4.272    33.825     0.000     1.065     0.542 
## count_birth_order2/2          0.017     0.030    -0.042     0.076     0.573    46.947     0.569     0.779     0.460 
## count_birth_order1/3          0.037     0.039    -0.040     0.114     0.944    32.035     0.352     1.128     0.557 
## count_birth_order2/3          0.015     0.040    -0.065     0.094     0.361    29.256     0.720     1.245     0.582 
## count_birth_order3/3          0.024     0.033    -0.040     0.089     0.739    64.357     0.463     0.597     0.393 
## count_birth_order1/4         -0.012     0.045    -0.099     0.076    -0.259    51.091     0.797     0.723     0.441 
## count_birth_order2/4          0.022     0.042    -0.061     0.105     0.520    74.588     0.605     0.532     0.364 
## count_birth_order3/4          0.017     0.046    -0.074     0.107     0.360    36.662     0.721     0.982     0.521 
## count_birth_order4/4          0.011     0.043    -0.073     0.095     0.257    43.749     0.798     0.830     0.477 
## count_birth_order1/5         -0.011     0.048    -0.106     0.084    -0.231   175.226     0.817     0.293     0.235 
## count_birth_order2/5         -0.006     0.049    -0.101     0.089    -0.120   216.300     0.905     0.256     0.211 
## count_birth_order3/5          0.012     0.051    -0.087     0.111     0.240    77.977     0.811     0.515     0.356 
## count_birth_order4/5          0.029     0.050    -0.068     0.127     0.588    78.406     0.558     0.512     0.355 
## count_birth_order5/5          0.025     0.055    -0.083     0.133     0.455    31.467     0.652     1.150     0.562 
## count_birth_order1/5+        -0.024     0.046    -0.115     0.066    -0.523    38.729     0.604     0.931     0.507 
## count_birth_order2/5+        -0.015     0.043    -0.099     0.069    -0.346    61.166     0.731     0.622     0.403 
## count_birth_order3/5+        -0.040     0.038    -0.115     0.035    -1.053   119.443     0.294     0.378     0.286 
## count_birth_order4/5+        -0.042     0.037    -0.114     0.030    -1.144   135.166     0.254     0.348     0.269 
## count_birth_order5/5+         0.003     0.035    -0.065     0.071     0.083   216.440     0.934     0.256     0.211 
## count_birth_order5+/5+       -0.037     0.027    -0.089     0.016    -1.362    82.328     0.177     0.494     0.346 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.948    62.747     0.347     0.610     0.398 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.312    94.625     0.023     0.446     0.323 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.747    92.958     0.007     0.452     0.326 
## male                          0.034     0.013     0.010     0.059     2.733   110.906     0.007     0.398     0.297 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-131" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-32" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 962.692      13 257.090   0.000   0.146 
##  2 vs 3:   2.247       4  19.519   0.101   1.230 
##  3 vs 4:   0.279       1 673.661   0.597   0.131 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-16" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-33" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-132" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.207     0.022     0.164     0.250     9.392    37.780     0.000     0.953     0.513 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -2.074    39.765     0.045     0.907     0.500 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.927    86.526     0.057     0.476     0.338 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.697   115.096     0.008     0.388     0.292 
## male                          0.036     0.012     0.013     0.059     3.117   129.025     0.002     0.359     0.275 
## sibling_count                -0.010     0.003    -0.016    -0.003    -2.962    50.901     0.005     0.726     0.442 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-132" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-347-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-33" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-133" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.208     0.023     0.163     0.253     9.079    34.743     0.000     1.037     0.535 
## birth_order                  -0.001     0.005    -0.011     0.008    -0.254    92.671     0.800     0.453     0.326 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -2.073    40.008     0.045     0.902     0.499 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.947    89.101     0.055     0.466     0.333 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.704   112.844     0.008     0.394     0.295 
## male                          0.036     0.012     0.013     0.059     3.118   129.060     0.002     0.359     0.275 
## sibling_count                -0.009     0.004    -0.017    -0.001    -2.105    66.169     0.039     0.584     0.387 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-133" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-349-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-33" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-134" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.206     0.022     0.163     0.250     9.287    51.820     0.000     0.715     0.438 
## birth_order_nonlinear2       -0.002     0.015    -0.031     0.028    -0.126    92.064     0.900     0.455     0.327 
## birth_order_nonlinear3        0.010     0.019    -0.027     0.047     0.521   119.279     0.603     0.379     0.287 
## birth_order_nonlinear4       -0.014     0.028    -0.069     0.042    -0.485    53.472     0.630     0.696     0.431 
## birth_order_nonlinear5        0.011     0.042    -0.071     0.094     0.269    30.646     0.790     1.183     0.569 
## birth_order_nonlinear5+      -0.002     0.036    -0.073     0.068    -0.068    76.359     0.946     0.523     0.360 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012     0.000    -1.933    40.878     0.060     0.884     0.493 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.002    77.907     0.049     0.515     0.356 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.710    95.618     0.008     0.443     0.321 
## male                          0.036     0.012     0.013     0.060     3.015   103.364     0.003     0.419     0.308 
## sibling_count                -0.010     0.004    -0.018    -0.002    -2.341    78.106     0.022     0.514     0.356 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.052 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.053 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-134" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-351-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-33" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-135" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.032     0.117     0.243     5.599    51.739     0.000     0.715     0.438 
## count_birth_order2/2          0.004     0.028    -0.052     0.059     0.125    36.329     0.901     0.991     0.523 
## count_birth_order1/3          0.029     0.034    -0.037     0.095     0.868    44.967     0.390     0.810     0.470 
## count_birth_order2/3          0.001     0.032    -0.061     0.063     0.035    44.356     0.972     0.820     0.474 
## count_birth_order3/3          0.006     0.035    -0.062     0.074     0.163    37.678     0.872     0.956     0.514 
## count_birth_order1/4         -0.016     0.051    -0.116     0.084    -0.305    29.376     0.763     1.240     0.581 
## count_birth_order2/4          0.008     0.035    -0.062     0.077     0.214   155.016     0.831     0.317     0.251 
## count_birth_order3/4         -0.002     0.036    -0.073     0.069    -0.051   130.528     0.960     0.356     0.274 
## count_birth_order4/4         -0.023     0.041    -0.103     0.057    -0.565    63.653     0.574     0.603     0.395 
## count_birth_order1/5         -0.028     0.075    -0.174     0.119    -0.371    24.004     0.714     1.579     0.641 
## count_birth_order2/5         -0.025     0.055    -0.133     0.083    -0.452    55.027     0.653     0.679     0.425 
## count_birth_order3/5          0.005     0.059    -0.112     0.121     0.077    32.332     0.939     1.117     0.554 
## count_birth_order4/5         -0.031     0.049    -0.127     0.065    -0.637    90.465     0.526     0.461     0.330 
## count_birth_order5/5          0.001     0.064    -0.124     0.125     0.008    30.313     0.994     1.197     0.572 
## count_birth_order1/5+        -0.057     0.050    -0.156     0.042    -1.126   127.194     0.262     0.362     0.277 
## count_birth_order2/5+        -0.066     0.053    -0.169     0.038    -1.242    42.575     0.221     0.851     0.483 
## count_birth_order3/5+        -0.035     0.052    -0.136     0.066    -0.676    37.170     0.504     0.969     0.517 
## count_birth_order4/5+        -0.066     0.043    -0.151     0.018    -1.548   127.185     0.124     0.362     0.277 
## count_birth_order5/5+        -0.042     0.050    -0.139     0.055    -0.842    40.196     0.405     0.898     0.498 
## count_birth_order5+/5+       -0.059     0.030    -0.119     0.000    -1.958   155.719     0.052     0.316     0.250 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.013     0.001    -1.727    79.436     0.088     0.507     0.353 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.854    93.043     0.067     0.451     0.325 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.489    88.032     0.015     0.470     0.335 
## male                          0.037     0.013     0.012     0.063     2.909   130.048     0.004     0.357     0.274 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-135" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-353-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-33" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:  766.209       13   20.767    0.000    0.812 
##   2 vs 3:  282.161        4   12.995    0.000    2.086 
##   3 vs 4:    0.327        1 1387.571    0.567    0.088 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-16" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-355-1.png" width="672" /></p>
</div>
</div>
<div id="conscientiousness" class="section level3 tabset">
<h3>Conscientiousness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-17" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-34" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-136" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.204     0.022     0.160     0.248     9.103    33.578     0.000     1.073     0.544 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -1.979    44.120     0.054     0.824     0.475 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.011    92.399     0.047     0.454     0.327 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.681   110.787     0.008     0.399     0.298 
## male                          0.036     0.012     0.013     0.059     3.118   125.969     0.002     0.365     0.279 
## sibling_count                -0.007     0.002    -0.011    -0.003    -3.497    62.523     0.001     0.611     0.398 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-136" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-357-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-34" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-137" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.203     0.023     0.157     0.248     8.742    30.858     0.000     1.174     0.567 
## birth_order                   0.001     0.004    -0.006     0.008     0.365   128.708     0.716     0.359     0.276 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -1.998    45.350     0.052     0.803     0.468 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.004   109.507     0.048     0.402     0.299 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.660   126.540     0.009     0.364     0.278 
## male                          0.036     0.012     0.013     0.059     3.117   125.707     0.002     0.365     0.279 
## sibling_count                -0.008     0.003    -0.014    -0.002    -2.755    95.506     0.007     0.443     0.321 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-137" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-359-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-34" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-138" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.204     0.024     0.157     0.250     8.569    35.187     0.000     1.023     0.532 
## birth_order_nonlinear2        0.001     0.017    -0.034     0.035     0.030    53.908     0.976     0.691     0.429 
## birth_order_nonlinear3        0.003     0.017    -0.029     0.036     0.190  2377.032     0.850     0.066     0.062 
## birth_order_nonlinear4        0.001     0.025    -0.048     0.049     0.024    77.493     0.981     0.517     0.357 
## birth_order_nonlinear5        0.027     0.032    -0.036     0.091     0.835    43.654     0.409     0.832     0.477 
## birth_order_nonlinear5+       0.005     0.025    -0.043     0.053     0.195   419.812     0.846     0.172     0.150 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -1.991    45.477     0.052     0.801     0.468 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.005   101.772     0.048     0.423     0.311 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.660   115.549     0.009     0.387     0.291 
## male                          0.036     0.012     0.013     0.059     3.100   120.270     0.002     0.377     0.285 
## sibling_count                -0.008     0.003    -0.013    -0.002    -2.826    78.726     0.006     0.511     0.354 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-138" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-361-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-34" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-139" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.037     0.085     0.230     4.272    33.825     0.000     1.065     0.542 
## count_birth_order2/2          0.017     0.030    -0.042     0.076     0.573    46.947     0.569     0.779     0.460 
## count_birth_order1/3          0.037     0.039    -0.040     0.114     0.944    32.035     0.352     1.128     0.557 
## count_birth_order2/3          0.015     0.040    -0.065     0.094     0.361    29.256     0.720     1.245     0.582 
## count_birth_order3/3          0.024     0.033    -0.040     0.089     0.739    64.357     0.463     0.597     0.393 
## count_birth_order1/4         -0.012     0.045    -0.099     0.076    -0.259    51.091     0.797     0.723     0.441 
## count_birth_order2/4          0.022     0.042    -0.061     0.105     0.520    74.588     0.605     0.532     0.364 
## count_birth_order3/4          0.017     0.046    -0.074     0.107     0.360    36.662     0.721     0.982     0.521 
## count_birth_order4/4          0.011     0.043    -0.073     0.095     0.257    43.749     0.798     0.830     0.477 
## count_birth_order1/5         -0.011     0.048    -0.106     0.084    -0.231   175.226     0.817     0.293     0.235 
## count_birth_order2/5         -0.006     0.049    -0.101     0.089    -0.120   216.300     0.905     0.256     0.211 
## count_birth_order3/5          0.012     0.051    -0.087     0.111     0.240    77.977     0.811     0.515     0.356 
## count_birth_order4/5          0.029     0.050    -0.068     0.127     0.588    78.406     0.558     0.512     0.355 
## count_birth_order5/5          0.025     0.055    -0.083     0.133     0.455    31.467     0.652     1.150     0.562 
## count_birth_order1/5+        -0.024     0.046    -0.115     0.066    -0.523    38.729     0.604     0.931     0.507 
## count_birth_order2/5+        -0.015     0.043    -0.099     0.069    -0.346    61.166     0.731     0.622     0.403 
## count_birth_order3/5+        -0.040     0.038    -0.115     0.035    -1.053   119.443     0.294     0.378     0.286 
## count_birth_order4/5+        -0.042     0.037    -0.114     0.030    -1.144   135.166     0.254     0.348     0.269 
## count_birth_order5/5+         0.003     0.035    -0.065     0.071     0.083   216.440     0.934     0.256     0.211 
## count_birth_order5+/5+       -0.037     0.027    -0.089     0.016    -1.362    82.328     0.177     0.494     0.346 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.948    62.747     0.347     0.610     0.398 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.312    94.625     0.023     0.446     0.323 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.747    92.958     0.007     0.452     0.326 
## male                          0.034     0.013     0.010     0.059     2.733   110.906     0.007     0.398     0.297 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-139" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-363-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-34" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 962.692      13 257.090   0.000   0.146 
##  2 vs 3:   2.247       4  19.519   0.101   1.230 
##  3 vs 4:   0.279       1 673.661   0.597   0.131 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-17" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-35" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-140" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.207     0.022     0.164     0.250     9.392    37.780     0.000     0.953     0.513 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -2.074    39.765     0.045     0.907     0.500 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.927    86.526     0.057     0.476     0.338 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.697   115.096     0.008     0.388     0.292 
## male                          0.036     0.012     0.013     0.059     3.117   129.025     0.002     0.359     0.275 
## sibling_count                -0.010     0.003    -0.016    -0.003    -2.962    50.901     0.005     0.726     0.442 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-140" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-366-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-35" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-141" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.208     0.023     0.163     0.253     9.079    34.743     0.000     1.037     0.535 
## birth_order                  -0.001     0.005    -0.011     0.008    -0.254    92.671     0.800     0.453     0.326 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012    -0.000    -2.073    40.008     0.045     0.902     0.499 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.947    89.101     0.055     0.466     0.333 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.704   112.844     0.008     0.394     0.295 
## male                          0.036     0.012     0.013     0.059     3.118   129.060     0.002     0.359     0.275 
## sibling_count                -0.009     0.004    -0.017    -0.001    -2.105    66.169     0.039     0.584     0.387 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-141" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-368-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-35" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-142" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.206     0.022     0.163     0.250     9.287    51.820     0.000     0.715     0.438 
## birth_order_nonlinear2       -0.002     0.015    -0.031     0.028    -0.126    92.064     0.900     0.455     0.327 
## birth_order_nonlinear3        0.010     0.019    -0.027     0.047     0.521   119.279     0.603     0.379     0.287 
## birth_order_nonlinear4       -0.014     0.028    -0.069     0.042    -0.485    53.472     0.630     0.696     0.431 
## birth_order_nonlinear5        0.011     0.042    -0.071     0.094     0.269    30.646     0.790     1.183     0.569 
## birth_order_nonlinear5+      -0.002     0.036    -0.073     0.068    -0.068    76.359     0.946     0.523     0.360 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012     0.000    -1.933    40.878     0.060     0.884     0.493 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.002    77.907     0.049     0.515     0.356 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.710    95.618     0.008     0.443     0.321 
## male                          0.036     0.012     0.013     0.060     3.015   103.364     0.003     0.419     0.308 
## sibling_count                -0.010     0.004    -0.018    -0.002    -2.341    78.106     0.022     0.514     0.356 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.052 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.053 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-142" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-370-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-35" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-143" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.032     0.117     0.243     5.599    51.739     0.000     0.715     0.438 
## count_birth_order2/2          0.004     0.028    -0.052     0.059     0.125    36.329     0.901     0.991     0.523 
## count_birth_order1/3          0.029     0.034    -0.037     0.095     0.868    44.967     0.390     0.810     0.470 
## count_birth_order2/3          0.001     0.032    -0.061     0.063     0.035    44.356     0.972     0.820     0.474 
## count_birth_order3/3          0.006     0.035    -0.062     0.074     0.163    37.678     0.872     0.956     0.514 
## count_birth_order1/4         -0.016     0.051    -0.116     0.084    -0.305    29.376     0.763     1.240     0.581 
## count_birth_order2/4          0.008     0.035    -0.062     0.077     0.214   155.016     0.831     0.317     0.251 
## count_birth_order3/4         -0.002     0.036    -0.073     0.069    -0.051   130.528     0.960     0.356     0.274 
## count_birth_order4/4         -0.023     0.041    -0.103     0.057    -0.565    63.653     0.574     0.603     0.395 
## count_birth_order1/5         -0.028     0.075    -0.174     0.119    -0.371    24.004     0.714     1.579     0.641 
## count_birth_order2/5         -0.025     0.055    -0.133     0.083    -0.452    55.027     0.653     0.679     0.425 
## count_birth_order3/5          0.005     0.059    -0.112     0.121     0.077    32.332     0.939     1.117     0.554 
## count_birth_order4/5         -0.031     0.049    -0.127     0.065    -0.637    90.465     0.526     0.461     0.330 
## count_birth_order5/5          0.001     0.064    -0.124     0.125     0.008    30.313     0.994     1.197     0.572 
## count_birth_order1/5+        -0.057     0.050    -0.156     0.042    -1.126   127.194     0.262     0.362     0.277 
## count_birth_order2/5+        -0.066     0.053    -0.169     0.038    -1.242    42.575     0.221     0.851     0.483 
## count_birth_order3/5+        -0.035     0.052    -0.136     0.066    -0.676    37.170     0.504     0.969     0.517 
## count_birth_order4/5+        -0.066     0.043    -0.151     0.018    -1.548   127.185     0.124     0.362     0.277 
## count_birth_order5/5+        -0.042     0.050    -0.139     0.055    -0.842    40.196     0.405     0.898     0.498 
## count_birth_order5+/5+       -0.059     0.030    -0.119     0.000    -1.958   155.719     0.052     0.316     0.250 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.013     0.001    -1.727    79.436     0.088     0.507     0.353 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.854    93.043     0.067     0.451     0.325 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.489    88.032     0.015     0.470     0.335 
## male                          0.037     0.013     0.012     0.063     2.909   130.048     0.004     0.357     0.274 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-143" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-372-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-35" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:  766.209       13   20.767    0.000    0.812 
##   2 vs 3:  282.161        4   12.995    0.000    2.086 
##   3 vs 4:    0.327        1 1387.571    0.567    0.088 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-17" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-374-1.png" width="672" /></p>
</div>
</div>
<div id="agreeableness" class="section level3 tabset">
<h3>Agreeableness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_agree)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-18" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-36" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-144" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.155     0.040    -0.233    -0.078    -3.925    12.670     0.002     5.363     0.863 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.581    15.844     0.570     3.060     0.780 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.886    21.999     0.073     1.775     0.668 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.658    27.536     0.013     1.335     0.600 
## male                          0.018     0.013    -0.008     0.043     1.372    57.799     0.175     0.652     0.415 
## sibling_count                 0.002     0.002    -0.002     0.005     0.770   128.772     0.443     0.359     0.276 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-144" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-36" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-145" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.160     0.041    -0.240    -0.079    -3.868    12.406     0.002     5.744     0.871 
## birth_order                   0.005     0.004    -0.003     0.013     1.274    46.822     0.209     0.781     0.461 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.011     0.561    15.979     0.582     3.008     0.777 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.017    23.007     0.056     1.670     0.654 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.816    29.110     0.009     1.252     0.584 
## male                          0.017     0.013    -0.008     0.043     1.370    57.810     0.176     0.652     0.414 
## sibling_count                -0.001     0.003    -0.007     0.004    -0.525   124.757     0.601     0.367     0.280 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-145" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-378-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-36" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-146" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.155     0.041    -0.236    -0.075    -3.780    12.984     0.002     4.973     0.854 
## birth_order_nonlinear2        0.005     0.024    -0.042     0.052     0.214    19.249     0.833     2.162     0.712 
## birth_order_nonlinear3        0.007     0.023    -0.038     0.053     0.307    33.482     0.761     1.077     0.545 
## birth_order_nonlinear4        0.022     0.027    -0.031     0.075     0.816    44.003     0.419     0.826     0.476 
## birth_order_nonlinear5        0.007     0.028    -0.048     0.062     0.251   134.096     0.802     0.350     0.270 
## birth_order_nonlinear5+       0.037     0.034    -0.030     0.103     1.073    28.927     0.292     1.261     0.585 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.011     0.566    16.097     0.579     2.964     0.774 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.003    23.358     0.057     1.637     0.650 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.803    29.945     0.009     1.213     0.576 
## male                          0.018     0.013    -0.007     0.043     1.379    58.512     0.173     0.645     0.412 
## sibling_count                -0.001     0.003    -0.006     0.004    -0.357   105.912     0.722     0.411     0.305 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-146" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-380-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-36" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-147" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.144     0.046    -0.234    -0.054    -3.145    19.339     0.005     2.146     0.711 
## count_birth_order2/2         -0.010     0.036    -0.081     0.061    -0.265    23.709     0.793     1.605     0.645 
## count_birth_order1/3         -0.013     0.032    -0.075     0.049    -0.403   129.880     0.687     0.357     0.274 
## count_birth_order2/3          0.007     0.039    -0.068     0.083     0.187    35.079     0.852     1.026     0.532 
## count_birth_order3/3         -0.016     0.032    -0.078     0.045    -0.523    99.747     0.602     0.429     0.314 
## count_birth_order1/4          0.001     0.039    -0.076     0.078     0.016   153.007     0.987     0.320     0.252 
## count_birth_order2/4          0.022     0.038    -0.053     0.096     0.576   262.519     0.565     0.227     0.191 
## count_birth_order3/4          0.011     0.050    -0.086     0.108     0.218    29.206     0.829     1.248     0.583 
## count_birth_order4/4          0.040     0.043    -0.044     0.124     0.939    45.218     0.353     0.805     0.469 
## count_birth_order1/5          0.007     0.056    -0.103     0.117     0.125    50.573     0.901     0.730     0.443 
## count_birth_order2/5         -0.014     0.053    -0.117     0.089    -0.274    91.463     0.784     0.457     0.328 
## count_birth_order3/5         -0.026     0.049    -0.122     0.070    -0.527   104.656     0.599     0.415     0.306 
## count_birth_order4/5          0.004     0.064    -0.121     0.130     0.068    25.491     0.947     1.464     0.623 
## count_birth_order5/5          0.006     0.046    -0.084     0.096     0.136    82.864     0.892     0.492     0.345 
## count_birth_order1/5+        -0.040     0.039    -0.116     0.035    -1.047   145.554     0.297     0.331     0.259 
## count_birth_order2/5+        -0.004     0.038    -0.078     0.070    -0.112   239.825     0.911     0.240     0.200 
## count_birth_order3/5+         0.034     0.044    -0.053     0.121     0.773    42.391     0.444     0.855     0.485 
## count_birth_order4/5+        -0.004     0.038    -0.079     0.070    -0.111   100.021     0.912     0.429     0.314 
## count_birth_order5/5+        -0.007     0.035    -0.075     0.061    -0.205   274.477     0.837     0.221     0.187 
## count_birth_order5+/5+        0.026     0.029    -0.031     0.082     0.879    52.808     0.383     0.703     0.434 
## poly(age, 3, raw = TRUE)1     0.001     0.006    -0.010     0.012     0.232    17.416     0.819     2.557     0.746 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.580    22.526     0.128     1.718     0.661 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.900    26.542     0.068     1.394     0.611 
## male                          0.021     0.013    -0.005     0.046     1.607    89.439     0.112     0.465     0.332 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.080 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-147" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-382-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-36" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1013.199       13  685.676    0.000    0.085 
##   2 vs 3:    2.932        4   43.473    0.031    0.586 
##   3 vs 4:    1.446        1   46.787    0.235    0.781 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-18" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-37" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-148" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.154     0.038    -0.230    -0.079    -4.019    13.140     0.001     4.801     0.849 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.618    15.097     0.546     3.388     0.797 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.842    21.443     0.079     1.840     0.677 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.680    27.922     0.012     1.313     0.596 
## male                          0.018     0.013    -0.007     0.043     1.379    57.876     0.173     0.651     0.414 
## sibling_count                 0.001     0.003    -0.005     0.007     0.246    68.602     0.806     0.568     0.380 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-148" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-385-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-37" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-149" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.156     0.041    -0.237    -0.076    -3.796    12.611     0.002     5.442     0.865 
## birth_order                   0.003     0.007    -0.010     0.016     0.408    22.971     0.687     1.673     0.655 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.616    15.175     0.547     3.350     0.795 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.897    22.261     0.071     1.746     0.665 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.740    29.022     0.010     1.257     0.585 
## male                          0.018     0.013    -0.007     0.043     1.379    58.181     0.173     0.648     0.413 
## sibling_count                -0.001     0.005    -0.011     0.009    -0.145    30.353     0.886     1.196     0.572 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-149" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-37" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-150" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.153     0.038    -0.227    -0.078    -3.992    14.065     0.001     3.999     0.823 
## birth_order_nonlinear2       -0.001     0.022    -0.045     0.043    -0.053    18.871     0.958     2.232     0.719 
## birth_order_nonlinear3       -0.006     0.020    -0.044     0.033    -0.278    83.189     0.782     0.490     0.344 
## birth_order_nonlinear4        0.009     0.033    -0.055     0.074     0.287    27.806     0.776     1.320     0.597 
## birth_order_nonlinear5        0.026     0.046    -0.064     0.115     0.564    24.044     0.578     1.576     0.641 
## birth_order_nonlinear5+       0.004     0.042    -0.079     0.087     0.093    32.740     0.927     1.102     0.551 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.585    16.184     0.567     2.933     0.772 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.038    25.834     0.052     1.440     0.619 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.909    35.498     0.006     1.014     0.529 
## male                          0.017     0.013    -0.009     0.044     1.297    48.047     0.201     0.763     0.455 
## sibling_count                 0.000     0.005    -0.010     0.010     0.031    29.328     0.976     1.242     0.582 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.080 
## Residual~~Residual                     0.907 
## ICC|mother_pidlink                     0.081 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-150" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-389-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-37" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-151" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.143     0.046    -0.233    -0.053    -3.120    17.929     0.006     2.431     0.736 
## count_birth_order2/2         -0.006     0.028    -0.061     0.049    -0.211    37.076     0.834     0.971     0.518 
## count_birth_order1/3         -0.007     0.035    -0.075     0.061    -0.194    39.774     0.847     0.907     0.500 
## count_birth_order2/3         -0.003     0.030    -0.062     0.057    -0.090    55.338     0.929     0.676     0.424 
## count_birth_order3/3         -0.020     0.033    -0.084     0.044    -0.611    50.467     0.544     0.731     0.444 
## count_birth_order1/4         -0.031     0.042    -0.114     0.051    -0.744    76.093     0.459     0.524     0.361 
## count_birth_order2/4         -0.019     0.038    -0.093     0.055    -0.506    79.614     0.614     0.507     0.352 
## count_birth_order3/4         -0.004     0.043    -0.088     0.079    -0.104    42.107     0.918     0.860     0.486 
## count_birth_order4/4          0.009     0.042    -0.074     0.091     0.206    52.840     0.838     0.703     0.434 
## count_birth_order1/5          0.025     0.058    -0.088     0.137     0.427    74.956     0.670     0.530     0.363 
## count_birth_order2/5          0.014     0.059    -0.102     0.131     0.238    38.837     0.813     0.928     0.506 
## count_birth_order3/5          0.016     0.052    -0.085     0.118     0.314    63.119     0.754     0.607     0.396 
## count_birth_order4/5         -0.005     0.052    -0.107     0.097    -0.088    59.232     0.930     0.639     0.409 
## count_birth_order5/5          0.059     0.057    -0.053     0.172     1.034    46.377     0.306     0.787     0.463 
## count_birth_order1/5+        -0.014     0.054    -0.120     0.091    -0.267    73.200     0.790     0.540     0.368 
## count_birth_order2/5+        -0.016     0.057    -0.127     0.095    -0.283    32.536     0.779     1.109     0.553 
## count_birth_order3/5+        -0.005     0.044    -0.091     0.081    -0.107   107.637     0.915     0.407     0.302 
## count_birth_order4/5+         0.010     0.047    -0.082     0.101     0.209    63.247     0.835     0.606     0.396 
## count_birth_order5/5+        -0.008     0.047    -0.101     0.084    -0.175    51.525     0.862     0.718     0.439 
## count_birth_order5+/5+       -0.003     0.033    -0.067     0.061    -0.091    87.327     0.927     0.473     0.336 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.009     0.012     0.322    18.058     0.751     2.401     0.734 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.953    25.679     0.062     1.451     0.620 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.664    32.011     0.012     1.129     0.557 
## male                          0.019     0.015    -0.011     0.050     1.247    37.562     0.220     0.959     0.515 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.081 
## Residual~~Residual                     0.906 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-151" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-37" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 799.343      13  22.784   0.000   0.748 
##  2 vs 3: 428.885       4  22.556   0.000   1.054 
##  3 vs 4:   0.724       1  70.486   0.398   0.556 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-18" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
</div>
</div>
<div id="openness" class="section level3 tabset">
<h3>Openness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_open)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-19" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-38" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-152" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.097     0.030     0.038     0.155     3.255    17.422     0.005     2.555     0.746 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.820    22.330     0.082     1.739     0.664 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.455    24.525     0.158     1.537     0.634 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.134    26.466     0.042     1.399     0.611 
## male                          0.034     0.013     0.008     0.061     2.582    46.298     0.013     0.789     0.464 
## sibling_count                -0.006     0.002    -0.010    -0.002    -2.838    65.281     0.006     0.591     0.390 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.916 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-152" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-395-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-38" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-153" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.103     0.029     0.046     0.161     3.517    18.036     0.002     2.406     0.734 
## birth_order                  -0.008     0.004    -0.016    -0.001    -2.269    76.835     0.026     0.520     0.359 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.772    22.312     0.090     1.741     0.664 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.281    24.926     0.212     1.506     0.629 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.937    27.184     0.063     1.355     0.604 
## male                          0.034     0.013     0.008     0.061     2.585    46.287     0.013     0.789     0.464 
## sibling_count                -0.001     0.003    -0.007     0.005    -0.352    76.404     0.726     0.523     0.360 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.916 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-153" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-397-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-38" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-154" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.097     0.031     0.036     0.158     3.098    17.890     0.006     2.440     0.737 
## birth_order_nonlinear2       -0.004     0.016    -0.034     0.027    -0.230   126.100     0.819     0.365     0.279 
## birth_order_nonlinear3       -0.022     0.020    -0.061     0.016    -1.134    83.937     0.260     0.487     0.343 
## birth_order_nonlinear4       -0.030     0.026    -0.081     0.021    -1.140    53.826     0.259     0.692     0.430 
## birth_order_nonlinear5       -0.023     0.030    -0.082     0.036    -0.769    66.462     0.445     0.582     0.386 
## birth_order_nonlinear5+      -0.053     0.025    -0.102    -0.003    -2.080   230.870     0.039     0.246     0.204 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.779    22.216     0.089     1.751     0.665 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.336    24.673     0.194     1.525     0.633 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -1.999    26.517     0.056     1.396     0.611 
## male                          0.034     0.013     0.008     0.061     2.589    46.659     0.013     0.783     0.462 
## sibling_count                -0.002     0.003    -0.008     0.003    -0.802   100.087     0.424     0.428     0.313 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.916 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-154" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-399-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-38" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-155" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.110     0.036     0.038     0.181     3.009    36.824     0.005     0.978     0.520 
## count_birth_order2/2         -0.030     0.030    -0.089     0.030    -0.978    45.704     0.333     0.798     0.467 
## count_birth_order1/3         -0.017     0.039    -0.092     0.059    -0.430    35.155     0.670     1.024     0.532 
## count_birth_order2/3         -0.022     0.031    -0.083     0.040    -0.696   149.299     0.488     0.325     0.255 
## count_birth_order3/3         -0.033     0.033    -0.098     0.031    -1.008    70.378     0.317     0.557     0.375 
## count_birth_order1/4         -0.032     0.048    -0.125     0.062    -0.662    38.186     0.512     0.944     0.510 
## count_birth_order2/4          0.009     0.040    -0.070     0.087     0.217   129.144     0.829     0.359     0.275 
## count_birth_order3/4         -0.073     0.051    -0.173     0.028    -1.415    26.361     0.169     1.406     0.613 
## count_birth_order4/4         -0.025     0.044    -0.110     0.061    -0.564    41.664     0.576     0.868     0.489 
## count_birth_order1/5          0.028     0.054    -0.077     0.134     0.526    68.218     0.601     0.570     0.381 
## count_birth_order2/5         -0.030     0.052    -0.132     0.073    -0.564    96.117     0.574     0.441     0.320 
## count_birth_order3/5         -0.038     0.067    -0.169     0.093    -0.570    23.613     0.574     1.613     0.646 
## count_birth_order4/5         -0.025     0.062    -0.147     0.098    -0.394    27.670     0.697     1.327     0.598 
## count_birth_order5/5         -0.048     0.051    -0.147     0.051    -0.945    45.384     0.350     0.803     0.468 
## count_birth_order1/5+        -0.022     0.041    -0.103     0.059    -0.526    76.438     0.600     0.522     0.360 
## count_birth_order2/5+        -0.044     0.037    -0.116     0.028    -1.199   374.776     0.231     0.183     0.159 
## count_birth_order3/5+        -0.047     0.043    -0.132     0.038    -1.085    48.843     0.283     0.752     0.451 
## count_birth_order4/5+        -0.101     0.041    -0.181    -0.020    -2.438    55.912     0.018     0.670     0.422 
## count_birth_order5/5+        -0.052     0.039    -0.130     0.025    -1.331    66.636     0.188     0.581     0.386 
## count_birth_order5+/5+       -0.088     0.029    -0.145    -0.030    -2.984    50.113     0.004     0.735     0.445 
## poly(age, 3, raw = TRUE)1    -0.007     0.005    -0.016     0.002    -1.450    24.539     0.160     1.536     0.634 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.949    28.964     0.351     1.260     0.585 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.155    33.834     0.256     1.065     0.542 
## male                          0.039     0.013     0.013     0.064     2.949    79.536     0.004     0.507     0.352 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-155" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-401-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-38" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1054.911       13 1770.364    0.000    0.051 
##   2 vs 3:    1.283        4   15.847    0.318    1.578 
##   3 vs 4:    4.994        1   75.968    0.028    0.525 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-19" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-39" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-156" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.099     0.030     0.040     0.157     3.298    17.614     0.004     2.506     0.742 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.000    -1.902    21.623     0.071     1.818     0.674 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.494    24.094     0.148     1.572     0.640 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.129    26.526     0.043     1.395     0.611 
## male                          0.034     0.013     0.008     0.060     2.577    46.449     0.013     0.786     0.463 
## sibling_count                -0.008     0.003    -0.014    -0.002    -2.494    96.827     0.014     0.439     0.319 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.916 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-156" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-404-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-39" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-157" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.105     0.030     0.047     0.163     3.532    18.470     0.002     2.312     0.726 
## birth_order                  -0.008     0.005    -0.018     0.002    -1.559    72.094     0.123     0.546     0.371 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.000    -1.883    21.602     0.073     1.821     0.674 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.401    24.191     0.174     1.564     0.639 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.023    26.712     0.053     1.384     0.609 
## male                          0.034     0.013     0.008     0.060     2.580    46.621     0.013     0.784     0.462 
## sibling_count                -0.003     0.004    -0.012     0.005    -0.735    58.503     0.466     0.645     0.412 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.916 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-157" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-406-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-39" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-158" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.097     0.030     0.037     0.156     3.185    19.424     0.005     2.132     0.709 
## birth_order_nonlinear2       -0.007     0.018    -0.042     0.029    -0.381    32.639     0.706     1.106     0.552 
## birth_order_nonlinear3       -0.020     0.022    -0.064     0.024    -0.896    41.854     0.375     0.865     0.488 
## birth_order_nonlinear4       -0.012     0.026    -0.063     0.038    -0.470   109.792     0.640     0.401     0.299 
## birth_order_nonlinear5       -0.045     0.037    -0.119     0.028    -1.210    50.795     0.232     0.727     0.442 
## birth_order_nonlinear5+      -0.074     0.038    -0.148     0.000    -1.951    54.562     0.056     0.684     0.427 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.808    20.678     0.085     1.939     0.688 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.318    21.977     0.201     1.777     0.669 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.859    23.091     0.076     1.662     0.653 
## male                          0.033     0.013     0.007     0.059     2.470    49.062     0.017     0.749     0.450 
## sibling_count                -0.003     0.004    -0.011     0.006    -0.592    78.967     0.556     0.510     0.354 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-158" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-408-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-39" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-159" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.100     0.038     0.025     0.175     2.606    26.995     0.015     1.366     0.606 
## count_birth_order2/2         -0.022     0.028    -0.077     0.034    -0.759    36.190     0.453     0.995     0.524 
## count_birth_order1/3         -0.012     0.043    -0.096     0.072    -0.276    20.911     0.785     1.907     0.685 
## count_birth_order2/3         -0.031     0.031    -0.092     0.031    -0.984    47.585     0.330     0.770     0.457 
## count_birth_order3/3         -0.024     0.030    -0.082     0.034    -0.819   106.568     0.415     0.410     0.304 
## count_birth_order1/4         -0.011     0.047    -0.104     0.081    -0.244    40.807     0.808     0.885     0.494 
## count_birth_order2/4         -0.015     0.042    -0.098     0.067    -0.365    42.201     0.717     0.858     0.486 
## count_birth_order3/4         -0.042     0.052    -0.144     0.061    -0.797    21.777     0.434     1.800     0.672 
## count_birth_order4/4         -0.006     0.043    -0.090     0.079    -0.133    46.948     0.895     0.779     0.460 
## count_birth_order1/5         -0.080     0.055    -0.189     0.028    -1.458   112.197     0.148     0.395     0.296 
## count_birth_order2/5         -0.041     0.057    -0.152     0.070    -0.720    49.627     0.475     0.742     0.448 
## count_birth_order3/5         -0.078     0.050    -0.177     0.020    -1.560    82.903     0.122     0.491     0.345 
## count_birth_order4/5         -0.049     0.055    -0.157     0.059    -0.892    44.246     0.377     0.822     0.474 
## count_birth_order5/5         -0.047     0.057    -0.160     0.065    -0.820    47.573     0.416     0.770     0.457 
## count_birth_order1/5+        -0.032     0.064    -0.157     0.093    -0.508    31.366     0.615     1.154     0.563 
## count_birth_order2/5+        -0.043     0.047    -0.135     0.050    -0.905    91.472     0.368     0.457     0.328 
## count_birth_order3/5+        -0.083     0.055    -0.191     0.025    -1.502    30.138     0.143     1.205     0.574 
## count_birth_order4/5+        -0.075     0.053    -0.178     0.028    -1.423    35.398     0.163     1.017     0.530 
## count_birth_order5/5+        -0.106     0.044    -0.192    -0.020    -2.414    86.675     0.018     0.475     0.337 
## count_birth_order5+/5+       -0.111     0.039    -0.187    -0.035    -2.874    33.993     0.007     1.060     0.541 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.016     0.001    -1.642    26.589     0.112     1.391     0.610 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.317    25.471     0.199     1.466     0.623 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.786    25.164     0.086     1.488     0.627 
## male                          0.037     0.013     0.011     0.063     2.801    99.738     0.006     0.429     0.314 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-159" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-410-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-39" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 665.112      13  15.184   0.000   1.101 
##  2 vs 3: 317.470       4  14.402   0.000   1.794 
##  3 vs 4:   2.289       1  72.426   0.135   0.544 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-19" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-412-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="riskpreference" class="section level2 tabset">
<h2>Riskpreference</h2>
<div id="risk-a" class="section level3 tabset">
<h3>Risk A</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskA)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-20" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-40" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-160" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.151     0.029     0.094     0.208     5.180    17.744     0.000     2.475     0.740 
## poly(age, 3, raw = TRUE)1    -0.003     0.003    -0.010     0.004    -0.889    26.684     0.382     1.385     0.609 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.509    29.659     0.615     1.226     0.578 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.278    35.279     0.210     1.021     0.531 
## male                         -0.203     0.020    -0.242    -0.164   -10.192    15.991     0.000     3.003     0.777 
## sibling_count                 0.004     0.002    -0.001     0.008     1.630    33.541     0.113     1.075     0.544 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-160" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-414-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-40" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-161" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.153     0.028     0.097     0.209     5.392    19.003     0.000     2.207     0.717 
## birth_order                  -0.002     0.006    -0.013     0.009    -0.394    17.385     0.699     2.565     0.747 
## poly(age, 3, raw = TRUE)1    -0.003     0.003    -0.010     0.004    -0.876    26.682     0.389     1.385     0.609 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.561    30.784     0.579     1.177     0.568 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.361    39.111     0.181     0.922     0.504 
## male                         -0.203     0.020    -0.242    -0.164   -10.189    15.985     0.000     3.006     0.777 
## sibling_count                 0.005     0.004    -0.004     0.014     1.167    18.216     0.258     2.366     0.731 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-161" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-416-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-40" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-162" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.152     0.028     0.096     0.208     5.347    21.210     0.000     1.869     0.680 
## birth_order_nonlinear2        0.001     0.016    -0.031     0.033     0.073    81.912     0.942     0.496     0.347 
## birth_order_nonlinear3       -0.021     0.023    -0.067     0.025    -0.884    32.941     0.383     1.095     0.549 
## birth_order_nonlinear4       -0.017     0.026    -0.067     0.034    -0.647    57.643     0.520     0.653     0.415 
## birth_order_nonlinear5        0.014     0.031    -0.046     0.073     0.444    61.922     0.658     0.616     0.400 
## birth_order_nonlinear5+      -0.024     0.038    -0.098     0.050    -0.631    22.229     0.534     1.749     0.665 
## poly(age, 3, raw = TRUE)1    -0.003     0.003    -0.010     0.004    -0.892    27.278     0.380     1.350     0.603 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.551    30.938     0.586     1.171     0.567 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.339    38.371     0.188     0.939     0.509 
## male                         -0.203     0.020    -0.242    -0.164   -10.152    15.907     0.000     3.035     0.778 
## sibling_count                 0.005     0.004    -0.002     0.013     1.452    22.789     0.160     1.691     0.657 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-162" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-418-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-40" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-163" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.156     0.033     0.093     0.220     4.806    64.869     0.000     0.594     0.391 
## count_birth_order2/2          0.001     0.035    -0.068     0.070     0.036    26.029     0.971     1.427     0.616 
## count_birth_order1/3         -0.013     0.035    -0.081     0.055    -0.366    57.653     0.715     0.653     0.415 
## count_birth_order2/3          0.006     0.032    -0.057     0.068     0.178   110.946     0.859     0.398     0.297 
## count_birth_order3/3          0.006     0.037    -0.066     0.078     0.174    38.226     0.863     0.943     0.510 
## count_birth_order1/4          0.039     0.047    -0.053     0.131     0.825    40.925     0.414     0.883     0.493 
## count_birth_order2/4         -0.003     0.045    -0.092     0.086    -0.060    48.828     0.952     0.752     0.451 
## count_birth_order3/4         -0.021     0.045    -0.110     0.068    -0.457    40.210     0.650     0.898     0.497 
## count_birth_order4/4          0.007     0.044    -0.080     0.093     0.154    38.888     0.878     0.927     0.506 
## count_birth_order1/5         -0.010     0.050    -0.108     0.088    -0.202   131.066     0.840     0.355     0.273 
## count_birth_order2/5          0.020     0.051    -0.080     0.121     0.397   111.494     0.692     0.397     0.297 
## count_birth_order3/5         -0.009     0.051    -0.109     0.091    -0.173    75.682     0.863     0.526     0.361 
## count_birth_order4/5         -0.056     0.050    -0.155     0.042    -1.115    76.769     0.268     0.521     0.359 
## count_birth_order5/5          0.013     0.048    -0.081     0.106     0.271    63.430     0.788     0.604     0.395 
## count_birth_order1/5+         0.004     0.041    -0.076     0.084     0.096    81.992     0.924     0.495     0.347 
## count_birth_order2/5+         0.053     0.045    -0.035     0.142     1.182    45.920     0.243     0.794     0.465 
## count_birth_order3/5+        -0.014     0.047    -0.106     0.077    -0.309    34.563     0.759     1.042     0.536 
## count_birth_order4/5+         0.033     0.045    -0.056     0.122     0.730    34.670     0.470     1.039     0.536 
## count_birth_order5/5+         0.055     0.040    -0.023     0.133     1.383    60.246     0.172     0.630     0.406 
## count_birth_order5+/5+        0.019     0.033    -0.046     0.084     0.585    29.348     0.563     1.241     0.581 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.005    -0.503    83.068     0.616     0.491     0.345 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.777    76.262     0.440     0.523     0.360 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.236    88.304     0.220     0.469     0.334 
## male                         -0.202     0.020    -0.242    -0.163   -10.018    17.261     0.000     2.598     0.750 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-163" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-420-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-40" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1015.573       13  608.223    0.000    0.090 
##   2 vs 3:    3.501        4   45.098    0.014    0.569 
##   3 vs 4:    0.339        1   25.146    0.566    1.489 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-20" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-41" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-164" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.148     0.028     0.093     0.204     5.277    19.419     0.000     2.133     0.709 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.004    -0.828    24.083     0.416     1.573     0.640 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.527    28.948     0.602     1.260     0.585 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.287    35.923     0.206     1.002     0.526 
## male                         -0.203     0.020    -0.242    -0.164   -10.165    15.934     0.000     3.025     0.778 
## sibling_count                 0.006     0.004    -0.002     0.013     1.493    25.834     0.148     1.440     0.619 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-164" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-423-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-41" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-165" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.153     0.027     0.099     0.207     5.568    21.096     0.000     1.883     0.682 
## birth_order                  -0.006     0.007    -0.019     0.007    -0.912    22.953     0.371     1.675     0.655 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.004    -0.814    24.074     0.423     1.574     0.640 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.600    29.205     0.553     1.248     0.583 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.379    37.150     0.176     0.969     0.517 
## male                         -0.203     0.020    -0.242    -0.164   -10.156    15.917     0.000     3.031     0.778 
## sibling_count                 0.009     0.006    -0.002     0.021     1.580    20.337     0.130     1.987     0.694 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-165" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-425-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-41" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-166" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.150     0.029     0.092     0.208     5.104    20.425     0.000     1.975     0.693 
## birth_order_nonlinear2       -0.008     0.017    -0.041     0.025    -0.496    43.993     0.622     0.826     0.476 
## birth_order_nonlinear3       -0.017     0.020    -0.055     0.021    -0.879    98.764     0.381     0.432     0.316 
## birth_order_nonlinear4       -0.022     0.035    -0.091     0.047    -0.636    23.602     0.531     1.614     0.646 
## birth_order_nonlinear5       -0.018     0.041    -0.098     0.062    -0.445    35.035     0.659     1.028     0.533 
## birth_order_nonlinear5+      -0.022     0.049    -0.117     0.073    -0.456    22.195     0.653     1.753     0.666 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.004    -0.877    25.025     0.389     1.498     0.628 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.525    28.257     0.604     1.296     0.592 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.271    33.907     0.212     1.063     0.541 
## male                         -0.204     0.019    -0.242    -0.166   -10.501    16.981     0.000     2.677     0.755 
## sibling_count                 0.009     0.006    -0.003     0.020     1.452    19.978     0.162     2.041     0.700 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.061 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-166" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-427-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-41" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-167" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.176     0.033     0.112     0.240     5.408    50.696     0.000     0.728     0.443 
## count_birth_order2/2         -0.015     0.030    -0.073     0.042    -0.523    32.050     0.605     1.127     0.557 
## count_birth_order1/3         -0.015     0.040    -0.094     0.064    -0.363    23.959     0.720     1.583     0.642 
## count_birth_order2/3         -0.003     0.041    -0.083     0.077    -0.080    19.986     0.937     2.040     0.700 
## count_birth_order3/3         -0.016     0.034    -0.083     0.050    -0.472    42.342     0.639     0.855     0.485 
## count_birth_order1/4          0.020     0.042    -0.062     0.101     0.469    83.436     0.641     0.489     0.344 
## count_birth_order2/4          0.023     0.042    -0.059     0.106     0.549    42.254     0.586     0.857     0.485 
## count_birth_order3/4         -0.014     0.049    -0.111     0.082    -0.292    25.066     0.773     1.495     0.628 
## count_birth_order4/4         -0.017     0.058    -0.131     0.097    -0.290    18.847     0.775     2.237     0.719 
## count_birth_order1/5         -0.002     0.069    -0.136     0.133    -0.024    30.915     0.981     1.172     0.567 
## count_birth_order2/5         -0.006     0.058    -0.119     0.107    -0.100    44.986     0.921     0.809     0.470 
## count_birth_order3/5          0.022     0.070    -0.115     0.159     0.310    20.835     0.760     1.918     0.686 
## count_birth_order4/5          0.024     0.049    -0.073     0.121     0.488    88.252     0.626     0.469     0.334 
## count_birth_order5/5         -0.005     0.056    -0.114     0.104    -0.084    55.802     0.933     0.671     0.422 
## count_birth_order1/5+         0.051     0.069    -0.084     0.186     0.739    24.681     0.467     1.524     0.632 
## count_birth_order2/5+         0.066     0.050    -0.031     0.164     1.329    59.540     0.189     0.636     0.408 
## count_birth_order3/5+         0.042     0.058    -0.072     0.157     0.723    25.210     0.476     1.484     0.626 
## count_birth_order4/5+         0.025     0.054    -0.081     0.131     0.463    31.946     0.647     1.131     0.558 
## count_birth_order5/5+         0.034     0.055    -0.074     0.142     0.615    27.739     0.544     1.323     0.598 
## count_birth_order5+/5+        0.035     0.046    -0.055     0.126     0.770    20.313     0.450     1.991     0.694 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.003    -1.116    45.827     0.270     0.796     0.466 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.294    43.005     0.770     0.843     0.481 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.970    38.949     0.338     0.926     0.505 
## male                         -0.203     0.020    -0.242    -0.163   -10.120    18.695     0.000     2.266     0.722 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-167" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-429-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-41" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 895.732      13  32.543   0.000   0.557 
##  2 vs 3: 382.815       4  18.689   0.000   1.292 
##  3 vs 4:   0.819       1  26.996   0.374   1.366 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-20" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-431-1.png" width="672" /></p>
</div>
</div>
<div id="risk-b" class="section level3 tabset">
<h3>Risk B</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskB)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-21" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-42" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-168" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.016     0.032    -0.078     0.047    -0.489    15.674     0.632     3.128     0.784 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.005     0.009     0.574    26.849     0.571     1.375     0.607 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.085    63.743     0.932     0.602     0.394 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.168   102.243     0.867     0.422     0.310 
## male                         -0.073     0.017    -0.106    -0.041    -4.402    22.164     0.000     1.757     0.666 
## sibling_count                 0.003     0.003    -0.003     0.008     1.014    23.250     0.321     1.647     0.651 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-168" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-433-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-42" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-169" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.012     0.031    -0.073     0.049    -0.371    16.492     0.715     2.827     0.766 
## birth_order                  -0.005     0.004    -0.013     0.003    -1.305    58.002     0.197     0.650     0.414 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.005     0.009     0.600    26.584     0.553     1.391     0.610 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.210    59.679     0.834     0.635     0.408 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.316    93.927     0.753     0.448     0.324 
## male                         -0.073     0.017    -0.106    -0.041    -4.401    22.165     0.000     1.756     0.666 
## sibling_count                 0.006     0.004    -0.002     0.014     1.407    21.871     0.173     1.789     0.670 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-169" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-435-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-42" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-170" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.019     0.032    -0.080     0.043    -0.588    17.671     0.564     2.492     0.741 
## birth_order_nonlinear2        0.005     0.016    -0.027     0.037     0.315    96.886     0.754     0.438     0.319 
## birth_order_nonlinear3       -0.013     0.020    -0.052     0.026    -0.655    77.479     0.514     0.517     0.357 
## birth_order_nonlinear4       -0.021     0.024    -0.067     0.025    -0.903   125.830     0.368     0.365     0.279 
## birth_order_nonlinear5        0.012     0.030    -0.048     0.072     0.395    66.664     0.694     0.581     0.386 
## birth_order_nonlinear5+      -0.036     0.029    -0.092     0.021    -1.240    65.227     0.220     0.591     0.390 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.005     0.009     0.623    27.968     0.538     1.311     0.595 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.205    71.653     0.838     0.549     0.372 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.307   124.873     0.759     0.367     0.280 
## male                         -0.073     0.017    -0.106    -0.041    -4.398    22.038     0.000     1.770     0.668 
## sibling_count                 0.005     0.004    -0.002     0.013     1.328    21.115     0.198     1.881     0.682 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-170" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-437-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-42" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-171" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.004     0.041    -0.085     0.077    -0.098    24.568     0.923     1.533     0.634 
## count_birth_order2/2          0.009     0.026    -0.042     0.060     0.361   159.956     0.719     0.311     0.247 
## count_birth_order1/3         -0.004     0.040    -0.081     0.074    -0.094    32.297     0.926     1.118     0.555 
## count_birth_order2/3          0.014     0.038    -0.061     0.088     0.356    38.738     0.724     0.931     0.507 
## count_birth_order3/3          0.008     0.038    -0.066     0.083     0.225    34.985     0.824     1.029     0.533 
## count_birth_order1/4          0.019     0.044    -0.067     0.106     0.438    58.958     0.663     0.641     0.410 
## count_birth_order2/4          0.004     0.048    -0.090     0.098     0.074    38.519     0.941     0.936     0.508 
## count_birth_order3/4         -0.006     0.041    -0.086     0.074    -0.143    80.026     0.886     0.505     0.351 
## count_birth_order4/4         -0.014     0.041    -0.094     0.066    -0.347    60.444     0.730     0.628     0.405 
## count_birth_order1/5         -0.008     0.053    -0.112     0.097    -0.144    75.899     0.886     0.525     0.361 
## count_birth_order2/5         -0.003     0.053    -0.107     0.100    -0.065    91.870     0.948     0.456     0.327 
## count_birth_order3/5          0.031     0.057    -0.081     0.144     0.543    39.883     0.590     0.905     0.500 
## count_birth_order4/5         -0.009     0.055    -0.116     0.099    -0.155    45.833     0.877     0.796     0.466 
## count_birth_order5/5         -0.017     0.051    -0.116     0.083    -0.325    45.489     0.747     0.801     0.468 
## count_birth_order1/5+         0.032     0.049    -0.064     0.128     0.657    32.377     0.516     1.115     0.554 
## count_birth_order2/5+         0.047     0.048    -0.047     0.141     0.972    36.258     0.338     0.993     0.524 
## count_birth_order3/5+        -0.024     0.045    -0.111     0.064    -0.532    42.385     0.597     0.855     0.485 
## count_birth_order4/5+         0.014     0.041    -0.066     0.095     0.347    57.192     0.730     0.658     0.417 
## count_birth_order5/5+         0.069     0.042    -0.012     0.151     1.662    47.841     0.103     0.766     0.456 
## count_birth_order5+/5+        0.006     0.032    -0.057     0.069     0.185    33.622     0.855     1.072     0.544 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.008     0.009     0.100    30.145     0.921     1.205     0.574 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.482    44.497     0.632     0.817     0.473 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.621    54.828     0.537     0.681     0.426 
## male                         -0.074     0.018    -0.110    -0.038    -4.043    20.827     0.001     1.919     0.686 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.061 
## Residual~~Residual                     0.939 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-171" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-439-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-42" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 907.603      13 134.331   0.000   0.214 
##  2 vs 3:   2.255       4  21.185   0.097   1.125 
##  3 vs 4:   1.543       1  58.050   0.219   0.649 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-21" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-43" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-172" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.016     0.033    -0.082     0.049    -0.490    15.176     0.631     3.350     0.795 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.005     0.009     0.642    27.399     0.527     1.343     0.601 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.117    64.196     0.908     0.599     0.393 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.163    99.884     0.871     0.429     0.314 
## male                         -0.073     0.017    -0.106    -0.040    -4.394    22.123     0.000     1.761     0.667 
## sibling_count                 0.003     0.004    -0.005     0.011     0.785    22.497     0.441     1.721     0.661 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-172" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-442-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-43" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-173" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.011     0.032    -0.074     0.052    -0.334    16.237     0.743     2.914     0.771 
## birth_order                  -0.008     0.006    -0.019     0.003    -1.346    40.925     0.186     0.883     0.493 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.004     0.009     0.659    27.318     0.516     1.347     0.602 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.220    61.236     0.827     0.622     0.403 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.283    92.498     0.778     0.453     0.326 
## male                         -0.073     0.017    -0.106    -0.040    -4.392    22.107     0.000     1.763     0.667 
## sibling_count                 0.007     0.006    -0.005     0.020     1.182    17.767     0.253     2.469     0.739 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-173" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-444-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-43" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-174" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.012     0.033    -0.077     0.052    -0.381    17.066     0.708     2.652     0.753 
## birth_order_nonlinear2       -0.011     0.018    -0.046     0.024    -0.641    35.493     0.526     1.014     0.529 
## birth_order_nonlinear3       -0.020     0.019    -0.058     0.017    -1.072   141.080     0.285     0.338     0.263 
## birth_order_nonlinear4       -0.036     0.031    -0.096     0.025    -1.157    36.306     0.255     0.992     0.523 
## birth_order_nonlinear5       -0.020     0.048    -0.114     0.073    -0.425    22.051     0.675     1.769     0.668 
## birth_order_nonlinear5+      -0.024     0.036    -0.094     0.046    -0.666    89.737     0.507     0.463     0.331 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.005     0.009     0.607    27.780     0.549     1.321     0.597 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.114    65.967     0.909     0.586     0.388 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.167   104.930     0.868     0.414     0.306 
## male                         -0.073     0.017    -0.106    -0.039    -4.270    21.771     0.000     1.801     0.672 
## sibling_count                 0.006     0.006    -0.006     0.017     0.999    21.018     0.329     1.893     0.683 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.938 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-174" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-446-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-43" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-175" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.013     0.038    -0.062     0.088     0.339    27.210     0.737     1.354     0.603 
## count_birth_order2/2         -0.010     0.025    -0.058     0.039    -0.387    82.728     0.700     0.492     0.345 
## count_birth_order1/3         -0.012     0.038    -0.086     0.062    -0.321    29.876     0.750     1.217     0.576 
## count_birth_order2/3         -0.026     0.030    -0.085     0.034    -0.850    59.125     0.399     0.640     0.410 
## count_birth_order3/3         -0.024     0.030    -0.083     0.035    -0.790    93.845     0.432     0.449     0.324 
## count_birth_order1/4          0.013     0.043    -0.071     0.097     0.301    70.221     0.764     0.558     0.376 
## count_birth_order2/4          0.001     0.048    -0.093     0.096     0.028    26.063     0.978     1.425     0.616 
## count_birth_order3/4         -0.035     0.045    -0.124     0.054    -0.779    33.207     0.442     1.086     0.547 
## count_birth_order4/4         -0.053     0.043    -0.137     0.032    -1.218    47.735     0.229     0.767     0.457 
## count_birth_order1/5          0.010     0.081    -0.149     0.169     0.120    20.302     0.906     1.992     0.694 
## count_birth_order2/5         -0.004     0.059    -0.119     0.111    -0.063    42.438     0.950     0.854     0.484 
## count_birth_order3/5          0.013     0.055    -0.095     0.122     0.241    45.777     0.811     0.797     0.466 
## count_birth_order4/5         -0.002     0.060    -0.119     0.116    -0.028    31.635     0.978     1.143     0.560 
## count_birth_order5/5         -0.027     0.054    -0.133     0.080    -0.493    66.996     0.624     0.579     0.385 
## count_birth_order1/5+         0.046     0.080    -0.109     0.202     0.584    18.406     0.566     2.325     0.727 
## count_birth_order2/5+         0.035     0.072    -0.107     0.176     0.480    18.053     0.637     2.402     0.734 
## count_birth_order3/5+         0.033     0.067    -0.099     0.165     0.488    18.703     0.631     2.265     0.722 
## count_birth_order4/5+         0.010     0.047    -0.082     0.101     0.206    66.888     0.837     0.579     0.385 
## count_birth_order5/5+         0.027     0.056    -0.084     0.138     0.479    26.232     0.636     1.414     0.614 
## count_birth_order5+/5+        0.012     0.043    -0.073     0.096     0.268    23.846     0.791     1.593     0.643 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.010     0.286    27.065     0.777     1.362     0.605 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.060    29.487     0.952     1.234     0.580 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.015    30.757     0.988     1.178     0.568 
## male                         -0.076     0.018    -0.111    -0.040    -4.207    23.628     0.000     1.612     0.646 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.061 
## Residual~~Residual                     0.938 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-175" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-448-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-43" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 779.366      13  21.225   0.000   0.796 
##  2 vs 3: 304.204       4  14.093   0.000   1.850 
##  3 vs 4:   1.640       1  41.357   0.207   0.874 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-21" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-450-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="educational-attainment" class="section level2 tabset">
<h2>Educational Attainment</h2>
<div id="years-of-education---z-standardized" class="section level3 tabset">
<h3>Years of Education - z-standardized</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = years_of_education_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-22" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-44" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-176" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.264     0.027     0.211     0.317     9.733    20.105     0.000     2.022     0.698 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.017    -0.003    -2.829    21.319     0.010     1.855     0.679 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.688    27.883     0.012     1.316     0.596 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.705    31.616     0.000     1.144     0.560 
## male                         -0.012     0.010    -0.031     0.007    -1.262   276.647     0.208     0.220     0.186 
## sibling_count                -0.019     0.003    -0.024    -0.013    -7.113    77.383     0.000     0.518     0.357 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.388 
## Residual~~Residual                     0.572 
## ICC|mother_pidlink                     0.404 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-176" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-452-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-44" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-177" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.253     0.027     0.201     0.305     9.493    21.459     0.000     1.838     0.676 
## birth_order                   0.011     0.004     0.004     0.018     2.973    35.980     0.005     1.001     0.526 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.018    -0.004    -2.931    21.190     0.008     1.871     0.681 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     3.116    29.114     0.004     1.252     0.584 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.268    34.892     0.000     1.032     0.534 
## male                         -0.012     0.010    -0.031     0.007    -1.264   276.663     0.207     0.220     0.186 
## sibling_count                -0.025     0.003    -0.031    -0.019    -8.328   160.995     0.000     0.310     0.246 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.388 
## Residual~~Residual                     0.572 
## ICC|mother_pidlink                     0.404 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-177" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-454-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-44" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-178" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.260     0.027     0.207     0.313     9.652    23.084     0.000     1.662     0.653 
## birth_order_nonlinear2        0.010     0.015    -0.019     0.039     0.698    52.510     0.488     0.706     0.435 
## birth_order_nonlinear3        0.023     0.020    -0.016     0.063     1.147    32.865     0.260     1.098     0.550 
## birth_order_nonlinear4        0.017     0.026    -0.035     0.068     0.637    27.599     0.529     1.331     0.599 
## birth_order_nonlinear5        0.035     0.029    -0.023     0.092     1.177    34.626     0.247     1.040     0.536 
## birth_order_nonlinear5+       0.059     0.027     0.007     0.111     2.206    40.881     0.033     0.884     0.493 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.018    -0.003    -2.817    21.473     0.010     1.836     0.676 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.864    28.422     0.008     1.287     0.591 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.921    33.018     0.000     1.092     0.549 
## male                         -0.012     0.010    -0.031     0.007    -1.266   266.053     0.207     0.225     0.190 
## sibling_count                -0.023     0.003    -0.029    -0.017    -7.713   155.685     0.000     0.317     0.250 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.388 
## Residual~~Residual                     0.572 
## ICC|mother_pidlink                     0.404 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-178" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-456-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-44" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-179" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.215     0.035     0.145     0.284     6.076    36.655     0.000     0.982     0.521 
## count_birth_order2/2          0.011     0.022    -0.031     0.054     0.532   119.280     0.596     0.379     0.287 
## count_birth_order1/3          0.030     0.031    -0.030     0.090     0.978   120.609     0.330     0.376     0.285 
## count_birth_order2/3          0.002     0.032    -0.061     0.066     0.074    71.015     0.941     0.553     0.373 
## count_birth_order3/3          0.036     0.031    -0.025     0.096     1.162    90.621     0.248     0.460     0.330 
## count_birth_order1/4          0.013     0.041    -0.068     0.093     0.307    65.335     0.760     0.590     0.390 
## count_birth_order2/4          0.002     0.046    -0.089     0.092     0.036    35.498     0.971     1.014     0.529 
## count_birth_order3/4          0.005     0.047    -0.086     0.096     0.105    30.464     0.917     1.191     0.571 
## count_birth_order4/4          0.030     0.043    -0.055     0.114     0.693    36.543     0.493     0.985     0.522 
## count_birth_order1/5          0.024     0.045    -0.065     0.112     0.519   188.510     0.604     0.280     0.227 
## count_birth_order2/5          0.007     0.047    -0.085     0.099     0.145   146.720     0.885     0.329     0.258 
## count_birth_order3/5         -0.009     0.044    -0.094     0.077    -0.202   210.657     0.840     0.261     0.214 
## count_birth_order4/5          0.001     0.043    -0.084     0.086     0.031   189.415     0.975     0.279     0.226 
## count_birth_order5/5          0.072     0.054    -0.034     0.178     1.340    28.944     0.191     1.261     0.585 
## count_birth_order1/5+        -0.145     0.033    -0.211    -0.080    -4.384   797.319     0.000     0.119     0.108 
## count_birth_order2/5+        -0.171     0.039    -0.247    -0.094    -4.374    72.735     0.000     0.543     0.369 
## count_birth_order3/5+        -0.165     0.039    -0.241    -0.088    -4.212    57.844     0.000     0.651     0.414 
## count_birth_order4/5+        -0.182     0.037    -0.254    -0.109    -4.917    72.085     0.000     0.546     0.371 
## count_birth_order5/5+        -0.165     0.033    -0.230    -0.101    -5.024   197.703     0.000     0.271     0.221 
## count_birth_order5+/5+       -0.116     0.030    -0.174    -0.058    -3.912    55.620     0.000     0.673     0.423 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.024    -0.007    -3.741    31.546     0.001     1.147     0.561 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.504    50.766     0.000     0.727     0.443 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.965    79.203     0.000     0.509     0.353 
## male                         -0.023     0.011    -0.044    -0.002    -2.131   123.297     0.035     0.370     0.282 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.377 
## Residual~~Residual                     0.568 
## ICC|mother_pidlink                     0.399 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-179" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-458-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-44" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1014.829       13  425.325    0.000    0.110 
##   2 vs 3:    0.632        4   15.680    0.647    1.600 
##   3 vs 4:    8.678        1   36.379    0.006    0.990 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-22" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-45" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-180" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.271     0.026     0.219     0.322    10.308    22.669     0.000     1.703     0.659 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.018    -0.004    -2.984    20.801     0.007     1.922     0.687 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.805    27.636     0.009     1.329     0.599 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.740    32.015     0.000     1.129     0.557 
## male                         -0.012     0.010    -0.031     0.007    -1.267   271.882     0.206     0.222     0.188 
## sibling_count                -0.025     0.004    -0.033    -0.018    -6.474    77.380     0.000     0.518     0.357 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.389 
## Residual~~Residual                     0.572 
## ICC|mother_pidlink                     0.405 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-180" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-461-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-45" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-181" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.252     0.025     0.203     0.302     9.985    26.419     0.000     1.402     0.612 
## birth_order                   0.020     0.005     0.009     0.030     3.799    29.947     0.001     1.213     0.576 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.019    -0.004    -3.049    20.507     0.006     1.963     0.691 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     3.210    27.249     0.003     1.351     0.603 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.230    32.602     0.000     1.107     0.552 
## male                         -0.012     0.010    -0.031     0.007    -1.264   263.224     0.207     0.227     0.191 
## sibling_count                -0.037     0.005    -0.046    -0.028    -8.117    94.218     0.000     0.447     0.323 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.388 
## Residual~~Residual                     0.572 
## ICC|mother_pidlink                     0.405 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-181" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-463-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-45" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-182" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.283     0.026     0.231     0.334    10.804    26.358     0.000     1.406     0.613 
## birth_order_nonlinear2        0.002     0.014    -0.026     0.029     0.115    53.062     0.909     0.700     0.433 
## birth_order_nonlinear3        0.034     0.021    -0.007     0.075     1.626    30.615     0.114     1.184     0.569 
## birth_order_nonlinear4        0.053     0.025     0.004     0.102     2.109    44.416     0.041     0.819     0.473 
## birth_order_nonlinear5        0.057     0.040    -0.021     0.136     1.425    22.032     0.168     1.771     0.668 
## birth_order_nonlinear5+       0.088     0.036     0.018     0.157     2.468    33.607     0.019     1.073     0.544 
## poly(age, 3, raw = TRUE)1    -0.012     0.004    -0.019    -0.005    -3.367    22.709     0.003     1.699     0.658 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     3.650    31.538     0.001     1.147     0.561 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.718    38.396     0.000     0.939     0.509 
## male                         -0.015     0.010    -0.034     0.004    -1.511   290.119     0.132     0.214     0.182 
## sibling_count                -0.036     0.005    -0.045    -0.027    -7.635    79.386     0.000     0.508     0.353 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.385 
## Residual~~Residual                     0.570 
## ICC|mother_pidlink                     0.403 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-182" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-465-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-45" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-183" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.041     0.101     0.260     4.427    22.396     0.000     1.732     0.663 
## count_birth_order2/2          0.021     0.026    -0.029     0.071     0.824    29.551     0.417     1.231     0.579 
## count_birth_order1/3          0.042     0.040    -0.035     0.120     1.072    21.641     0.296     1.816     0.674 
## count_birth_order2/3          0.002     0.032    -0.062     0.065     0.051    32.659     0.959     1.105     0.552 
## count_birth_order3/3          0.061     0.037    -0.011     0.133     1.668    26.122     0.107     1.421     0.615 
## count_birth_order1/4          0.009     0.043    -0.075     0.093     0.210    44.888     0.835     0.811     0.471 
## count_birth_order2/4         -0.026     0.043    -0.111     0.059    -0.603    29.872     0.551     1.217     0.576 
## count_birth_order3/4          0.001     0.034    -0.065     0.067     0.036   157.244     0.971     0.314     0.249 
## count_birth_order4/4          0.036     0.042    -0.047     0.119     0.847    36.300     0.402     0.992     0.523 
## count_birth_order1/5         -0.086     0.055    -0.194     0.023    -1.552    52.840     0.127     0.703     0.434 
## count_birth_order2/5         -0.106     0.047    -0.197    -0.014    -2.263   104.336     0.026     0.416     0.307 
## count_birth_order3/5         -0.075     0.048    -0.169     0.018    -1.579    64.050     0.119     0.600     0.394 
## count_birth_order4/5         -0.058     0.057    -0.170     0.053    -1.026    28.015     0.314     1.308     0.595 
## count_birth_order5/5         -0.018     0.058    -0.132     0.096    -0.310    30.065     0.759     1.208     0.575 
## count_birth_order1/5+        -0.254     0.049    -0.349    -0.158    -5.211    78.909     0.000     0.510     0.354 
## count_birth_order2/5+        -0.241     0.051    -0.342    -0.141    -4.699    35.825     0.000     1.005     0.527 
## count_birth_order3/5+        -0.243     0.042    -0.325    -0.161    -5.809    93.901     0.000     0.448     0.324 
## count_birth_order4/5+        -0.184     0.052    -0.285    -0.082    -3.548    29.564     0.001     1.231     0.579 
## count_birth_order5/5+        -0.178     0.050    -0.275    -0.080    -3.566    31.522     0.001     1.147     0.561 
## count_birth_order5+/5+       -0.137     0.038    -0.212    -0.062    -3.592    40.589     0.001     0.890     0.495 
## poly(age, 3, raw = TRUE)1    -0.011     0.005    -0.020    -0.002    -2.452    21.423     0.023     1.842     0.677 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.986    25.123     0.006     1.491     0.627 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.577    29.397     0.000     1.239     0.581 
## male                         -0.022     0.011    -0.044     0.000    -1.928   131.598     0.056     0.354     0.272 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.386 
## Residual~~Residual                     0.569 
## ICC|mother_pidlink                     0.404 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-183" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-467-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-45" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 505.442      13  10.603   0.000   1.681 
##  2 vs 3: 318.013       4  15.193   0.000   1.668 
##  3 vs 4:  14.134       1  29.674   0.001   1.226 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-22" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-469-1.png" width="672" /></p>
</div>
</div>
<div id="elementary_missed" class="section level3">
<h3>elementary_missed</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_missed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-23" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-46" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-184" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.011     0.009    -0.006     0.028     1.310    11.465     0.216     7.772     0.902 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.001     0.357    27.215     0.724     1.353     0.603 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.039    39.946     0.969     0.904     0.499 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.203    35.799     0.841     1.006     0.527 
## male                          0.002     0.002    -0.003     0.007     0.747    38.067     0.460     0.946     0.511 
## sibling_count                 0.003     0.001     0.002     0.004     5.102    19.132     0.000     2.183     0.714 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-184" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-471-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-46" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-185" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.012     0.009    -0.005     0.029     1.401    11.480     0.188     7.728     0.901 
## birth_order                  -0.001     0.001    -0.003     0.001    -0.888    14.146     0.390     3.941     0.821 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.396    26.825     0.695     1.377     0.607 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.118    34.870     0.907     1.033     0.534 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.357    29.962     0.723     1.213     0.575 
## male                          0.002     0.002    -0.003     0.007     0.748    38.070     0.459     0.946     0.511 
## sibling_count                 0.004     0.001     0.002     0.005     4.407    18.751     0.000     2.255     0.721 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-185" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-473-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-46" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-186" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.012     0.009    -0.006     0.030     1.333    11.555     0.208     7.513     0.899 
## birth_order_nonlinear2       -0.002     0.003    -0.008     0.005    -0.464    32.928     0.646     1.096     0.549 
## birth_order_nonlinear3       -0.004     0.006    -0.014     0.007    -0.628    16.698     0.539     2.762     0.761 
## birth_order_nonlinear4       -0.005     0.005    -0.015     0.004    -1.138    51.358     0.260     0.720     0.440 
## birth_order_nonlinear5       -0.006     0.007    -0.021     0.008    -0.850    20.297     0.405     1.993     0.695 
## birth_order_nonlinear5+      -0.006     0.008    -0.023     0.010    -0.768    15.587     0.454     3.165     0.786 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.001     0.336    26.932     0.739     1.370     0.606 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.020    36.501     0.984     0.986     0.522 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.254    32.624     0.801     1.106     0.552 
## male                          0.002     0.002    -0.003     0.007     0.753    39.040     0.456     0.924     0.505 
## sibling_count                 0.004     0.001     0.002     0.005     4.440    18.595     0.000     2.286     0.724 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-186" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-475-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-46" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-187" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.010    -0.001     0.039     1.826    14.625     0.088     3.640     0.809 
## count_birth_order2/2         -0.001     0.006    -0.012     0.010    -0.170    35.044     0.866     1.027     0.533 
## count_birth_order1/3          0.001     0.006    -0.011     0.013     0.163    97.102     0.871     0.438     0.318 
## count_birth_order2/3         -0.001     0.007    -0.014     0.012    -0.133    41.417     0.895     0.873     0.490 
## count_birth_order3/3         -0.002     0.008    -0.017     0.014    -0.210    22.655     0.836     1.705     0.659 
## count_birth_order1/4          0.004     0.007    -0.010     0.018     0.595   158.578     0.553     0.313     0.248 
## count_birth_order2/4          0.006     0.009    -0.012     0.023     0.614    33.713     0.544     1.069     0.543 
## count_birth_order3/4         -0.001     0.010    -0.022     0.019    -0.143    20.937     0.888     1.904     0.684 
## count_birth_order4/4          0.001     0.008    -0.015     0.017     0.091    37.888     0.928     0.951     0.512 
## count_birth_order1/5          0.003     0.009    -0.015     0.020     0.323   173.907     0.747     0.294     0.236 
## count_birth_order2/5          0.007     0.009    -0.010     0.025     0.817   155.784     0.415     0.316     0.250 
## count_birth_order3/5          0.005     0.012    -0.019     0.029     0.405    22.788     0.689     1.691     0.657 
## count_birth_order4/5          0.009     0.009    -0.009     0.027     0.961    80.742     0.339     0.501     0.350 
## count_birth_order5/5          0.002     0.012    -0.021     0.025     0.173    21.563     0.865     1.825     0.675 
## count_birth_order1/5+         0.020     0.008     0.003     0.037     2.364    39.287     0.023     0.918     0.503 
## count_birth_order2/5+         0.015     0.009    -0.001     0.032     1.792    38.026     0.081     0.947     0.512 
## count_birth_order3/5+         0.021     0.008     0.006     0.037     2.700    48.675     0.010     0.754     0.452 
## count_birth_order4/5+         0.013     0.008    -0.003     0.028     1.574    38.867     0.124     0.928     0.506 
## count_birth_order5/5+         0.015     0.008     0.001     0.030     2.027    47.592     0.048     0.769     0.457 
## count_birth_order5+/5+        0.020     0.006     0.007     0.032     3.059    27.240     0.005     1.352     0.603 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.302    28.133     0.765     1.302     0.594 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.130    32.216     0.898     1.121     0.555 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.073    31.727     0.942     1.140     0.560 
## male                          0.002     0.003    -0.003     0.007     0.869    49.244     0.389     0.747     0.449 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.164 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-187" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-477-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-46" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:      NA      13      NA      NA      NA 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   1.652       1  20.955   0.213   1.901 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-23" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-47" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-188" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.010     0.009    -0.007     0.027     1.169    11.581     0.266     7.442     0.898 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.575    24.556     0.570     1.534     0.634 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.094    38.157     0.926     0.944     0.511 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.199    35.491     0.844     1.014     0.529 
## male                          0.002     0.002    -0.003     0.007     0.762    38.789     0.451     0.929     0.506 
## sibling_count                 0.004     0.001     0.002     0.006     4.291    17.703     0.000     2.485     0.741 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-188" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-480-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-47" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-189" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.011     0.009    -0.006     0.028     1.236    11.532     0.241     7.578     0.899 
## birth_order                  -0.001     0.002    -0.004     0.002    -0.721    15.071     0.482     3.401     0.798 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.591    24.344     0.560     1.551     0.637 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.183    35.063     0.855     1.027     0.533 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.290    31.418     0.773     1.152     0.562 
## male                          0.002     0.002    -0.003     0.007     0.761    38.714     0.451     0.931     0.507 
## sibling_count                 0.005     0.001     0.003     0.007     4.331    22.184     0.000     1.754     0.666 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-189" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-482-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-47" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-190" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.011     0.009    -0.007     0.028     1.167    11.647     0.267     7.267     0.896 
## birth_order_nonlinear2       -0.002     0.003    -0.008     0.005    -0.436    26.618     0.666     1.389     0.610 
## birth_order_nonlinear3       -0.003     0.005    -0.013     0.008    -0.509    18.387     0.617     2.329     0.728 
## birth_order_nonlinear4       -0.008     0.006    -0.020     0.005    -1.181    22.820     0.250     1.688     0.657 
## birth_order_nonlinear5       -0.001     0.009    -0.020     0.017    -0.122    17.732     0.904     2.477     0.740 
## birth_order_nonlinear5+      -0.003     0.010    -0.023     0.018    -0.269    15.834     0.791     3.064     0.780 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.516    22.948     0.611     1.676     0.655 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.101    33.610     0.920     1.072     0.544 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.204    31.998     0.840     1.129     0.557 
## male                          0.002     0.002    -0.003     0.007     0.868    49.316     0.389     0.746     0.449 
## sibling_count                 0.004     0.001     0.002     0.007     4.066    21.854     0.001     1.791     0.671 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-190" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-484-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-47" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-191" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.010    -0.001     0.038     1.905    14.772     0.076     3.557     0.805 
## count_birth_order2/2         -0.003     0.005    -0.012     0.007    -0.544    41.216     0.589     0.877     0.491 
## count_birth_order1/3         -0.002     0.007    -0.015     0.011    -0.253    32.266     0.802     1.119     0.555 
## count_birth_order2/3          0.001     0.007    -0.013     0.015     0.083    22.150     0.935     1.758     0.666 
## count_birth_order3/3          0.001     0.007    -0.013     0.015     0.158    25.115     0.876     1.491     0.627 
## count_birth_order1/4          0.006     0.009    -0.012     0.024     0.622    30.839     0.538     1.175     0.567 
## count_birth_order2/4          0.008     0.009    -0.009     0.026     0.929    25.574     0.362     1.458     0.622 
## count_birth_order3/4          0.002     0.008    -0.013     0.017     0.215    44.460     0.830     0.818     0.473 
## count_birth_order4/4         -0.000     0.008    -0.017     0.016    -0.035    34.541     0.973     1.043     0.537 
## count_birth_order1/5          0.013     0.012    -0.010     0.036     1.087    39.539     0.284     0.912     0.502 
## count_birth_order2/5          0.010     0.011    -0.012     0.032     0.930    34.166     0.359     1.054     0.539 
## count_birth_order3/5          0.006     0.010    -0.014     0.027     0.611    39.349     0.545     0.917     0.503 
## count_birth_order4/5          0.005     0.013    -0.021     0.031     0.360    19.213     0.723     2.169     0.713 
## count_birth_order5/5          0.004     0.010    -0.016     0.024     0.415    57.063     0.680     0.659     0.417 
## count_birth_order1/5+         0.025     0.011     0.003     0.047     2.237    36.331     0.032     0.991     0.523 
## count_birth_order2/5+         0.024     0.009     0.006     0.041     2.609    63.165     0.011     0.606     0.396 
## count_birth_order3/5+         0.026     0.009     0.008     0.044     2.840    44.033     0.007     0.825     0.475 
## count_birth_order4/5+         0.019     0.010    -0.001     0.039     1.846    27.777     0.076     1.321     0.597 
## count_birth_order5/5+         0.029     0.009     0.012     0.047     3.248    42.970     0.002     0.844     0.481 
## count_birth_order5+/5+        0.026     0.009     0.008     0.043     2.898    19.863     0.009     2.059     0.702 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.736    30.065     0.468     1.208     0.575 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.347    42.338     0.730     0.855     0.485 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.357    35.972     0.723     1.001     0.526 
## male                          0.002     0.003    -0.003     0.007     0.699    43.078     0.489     0.842     0.481 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-191" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-486-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-47" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:      NA      13      NA      NA      NA 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   1.559       1  28.836   0.222   1.266 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-23" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-488-1.png" width="672" /></p>
</div>
</div>
<div id="elementary_worked" class="section level3">
<h3>elementary_worked</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_worked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-24" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-48" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-192" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.011     0.009    -0.007     0.028     1.193    13.229     0.254     4.708     0.846 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.167    17.909     0.869     2.435     0.737 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.058    20.574     0.302     1.953     0.690 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.716    22.351     0.482     1.736     0.663 
## male                          0.007     0.003     0.001     0.013     2.477    78.716     0.015     0.511     0.354 
## sibling_count                 0.005     0.001     0.003     0.006     7.584    39.958     0.000     0.903     0.499 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-192" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-490-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-48" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-193" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.014     0.009    -0.003     0.032     1.596    13.513     0.134     4.438     0.838 
## birth_order                  -0.004     0.001    -0.006    -0.002    -3.739    25.717     0.001     1.448     0.620 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.274    17.864     0.787     2.446     0.738 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.663    20.997     0.515     1.896     0.683 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.260    23.661     0.797     1.609     0.645 
## male                          0.007     0.003     0.001     0.013     2.483    78.828     0.015     0.510     0.354 
## sibling_count                 0.007     0.001     0.005     0.009     8.106    33.826     0.000     1.065     0.542 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-193" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-492-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-48" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-194" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.011     0.009    -0.007     0.029     1.213    14.032     0.245     4.022     0.824 
## birth_order_nonlinear2       -0.003     0.004    -0.010     0.005    -0.686    69.239     0.495     0.564     0.378 
## birth_order_nonlinear3       -0.007     0.006    -0.018     0.004    -1.213    29.691     0.235     1.225     0.578 
## birth_order_nonlinear4       -0.011     0.006    -0.023     0.002    -1.693    39.785     0.098     0.907     0.500 
## birth_order_nonlinear5       -0.010     0.007    -0.024     0.003    -1.497    65.014     0.139     0.593     0.391 
## birth_order_nonlinear5+      -0.023     0.008    -0.038    -0.008    -2.947    30.467     0.006     1.191     0.571 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.212    17.790     0.834     2.464     0.739 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.825    20.568     0.419     1.954     0.690 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.456    22.555     0.652     1.715     0.661 
## male                          0.007     0.003     0.001     0.013     2.467    75.675     0.016     0.526     0.362 
## sibling_count                 0.006     0.001     0.005     0.008     8.012    43.887     0.000     0.828     0.476 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-194" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-494-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-48" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-195" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.023     0.009     0.005     0.042     2.486    27.617     0.019     1.330     0.599 
## count_birth_order2/2         -0.003     0.006    -0.015     0.010    -0.400    66.901     0.691     0.579     0.385 
## count_birth_order1/3          0.003     0.008    -0.013     0.019     0.382    63.802     0.704     0.601     0.394 
## count_birth_order2/3          0.002     0.007    -0.013     0.016     0.215   143.965     0.830     0.333     0.260 
## count_birth_order3/3         -0.004     0.008    -0.020     0.011    -0.578    74.268     0.565     0.534     0.365 
## count_birth_order1/4          0.004     0.011    -0.017     0.025     0.405    49.920     0.688     0.738     0.446 
## count_birth_order2/4          0.011     0.010    -0.009     0.031     1.075    69.249     0.286     0.564     0.378 
## count_birth_order3/4          0.009     0.012    -0.014     0.033     0.766    26.199     0.451     1.416     0.614 
## count_birth_order4/4          0.001     0.009    -0.017     0.018     0.079   113.350     0.938     0.392     0.294 
## count_birth_order1/5          0.016     0.015    -0.013     0.046     1.092    28.814     0.284     1.267     0.587 
## count_birth_order2/5          0.012     0.015    -0.017     0.041     0.804    32.097     0.427     1.126     0.556 
## count_birth_order3/5          0.005     0.012    -0.018     0.028     0.408    79.989     0.684     0.505     0.351 
## count_birth_order4/5          0.007     0.010    -0.013     0.027     0.664   388.402     0.507     0.180     0.157 
## count_birth_order5/5          0.008     0.014    -0.019     0.034     0.560    26.988     0.580     1.367     0.606 
## count_birth_order1/5+         0.034     0.011     0.013     0.055     3.214    44.472     0.002     0.818     0.473 
## count_birth_order2/5+         0.042     0.011     0.020     0.064     3.778    36.503     0.001     0.986     0.522 
## count_birth_order3/5+         0.040     0.010     0.020     0.061     3.862    41.770     0.000     0.866     0.488 
## count_birth_order4/5+         0.032     0.009     0.014     0.049     3.583   102.974     0.001     0.420     0.309 
## count_birth_order5/5+         0.031     0.009     0.014     0.048     3.554   105.750     0.001     0.412     0.305 
## count_birth_order5+/5+        0.027     0.007     0.014     0.040     3.970    70.431     0.000     0.556     0.375 
## poly(age, 3, raw = TRUE)1    -0.000     0.001    -0.003     0.002    -0.052    20.147     0.959     2.015     0.697 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.844    18.493     0.410     2.307     0.726 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.548    17.447     0.590     2.549     0.746 
## male                          0.007     0.003     0.002     0.013     2.704   195.767     0.007     0.273     0.222 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.188 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-195" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-496-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-48" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:      NA      13      NA      NA      NA 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:  13.553       1  25.242   0.001   1.482 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-24" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-49" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-196" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.008     0.009    -0.009     0.025     0.900    13.673     0.384     4.300     0.834 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.298    16.968     0.769     2.680     0.756 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.948    20.150     0.354     2.015     0.697 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.704    22.608     0.489     1.710     0.660 
## male                          0.007     0.003     0.001     0.013     2.488    81.019     0.015     0.500     0.349 
## sibling_count                 0.007     0.001     0.005     0.009     6.582    26.654     0.000     1.387     0.609 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-196" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-499-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-49" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-197" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.012     0.009    -0.005     0.029     1.347    14.123     0.199     3.958     0.822 
## birth_order                  -0.005     0.002    -0.008    -0.002    -3.156    23.587     0.004     1.616     0.646 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.351    16.972     0.730     2.679     0.755 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.687    20.423     0.500     1.975     0.693 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.402    23.549     0.692     1.619     0.647 
## male                          0.007     0.003     0.001     0.013     2.491    80.754     0.015     0.501     0.350 
## sibling_count                 0.010     0.001     0.007     0.012     7.225    26.729     0.000     1.382     0.609 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-197" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-501-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-49" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-198" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.008     0.009    -0.010     0.026     0.866    14.110     0.401     3.967     0.822 
## birth_order_nonlinear2       -0.004     0.004    -0.011     0.003    -1.177    79.037     0.243     0.509     0.354 
## birth_order_nonlinear3       -0.009     0.006    -0.020     0.003    -1.468    26.239     0.154     1.414     0.614 
## birth_order_nonlinear4       -0.011     0.006    -0.024     0.002    -1.680    55.600     0.099     0.673     0.423 
## birth_order_nonlinear5       -0.017     0.008    -0.034    -0.001    -2.040    54.699     0.046     0.682     0.426 
## birth_order_nonlinear5+      -0.024     0.011    -0.046    -0.003    -2.239    22.969     0.035     1.674     0.655 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.274    17.141     0.787     2.631     0.752 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.751    20.265     0.462     1.998     0.695 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.436    22.464     0.667     1.724     0.662 
## male                          0.007     0.003     0.002     0.013     2.510    94.907     0.014     0.445     0.322 
## sibling_count                 0.009     0.001     0.006     0.012     6.390    22.900     0.000     1.680     0.656 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-198" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-503-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-49" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-199" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.025     0.011     0.004     0.046     2.342    18.661     0.030     2.273     0.723 
## count_birth_order2/2         -0.003     0.006    -0.015     0.009    -0.517    48.494     0.608     0.757     0.453 
## count_birth_order1/3          0.001     0.009    -0.016     0.017     0.060    33.688     0.952     1.070     0.543 
## count_birth_order2/3          0.001     0.007    -0.012     0.014     0.162   104.017     0.872     0.417     0.307 
## count_birth_order3/3         -0.005     0.006    -0.017     0.008    -0.720   317.059     0.472     0.203     0.174 
## count_birth_order1/4          0.014     0.010    -0.006     0.035     1.371    52.973     0.176     0.701     0.433 
## count_birth_order2/4          0.014     0.011    -0.008     0.035     1.212    27.492     0.236     1.337     0.600 
## count_birth_order3/4          0.009     0.010    -0.011     0.029     0.915    40.151     0.366     0.899     0.498 
## count_birth_order4/4          0.004     0.010    -0.015     0.024     0.417    50.741     0.678     0.728     0.443 
## count_birth_order1/5          0.026     0.016    -0.004     0.057     1.679    33.402     0.103     1.079     0.546 
## count_birth_order2/5          0.024     0.014    -0.003     0.051     1.750    42.231     0.087     0.858     0.485 
## count_birth_order3/5          0.018     0.013    -0.008     0.044     1.389    40.656     0.172     0.889     0.495 
## count_birth_order4/5          0.015     0.015    -0.015     0.046     1.004    23.614     0.326     1.613     0.646 
## count_birth_order5/5          0.012     0.015    -0.017     0.041     0.823    30.764     0.417     1.178     0.568 
## count_birth_order1/5+         0.057     0.014     0.030     0.084     4.117    42.963     0.000     0.844     0.481 
## count_birth_order2/5+         0.051     0.012     0.028     0.074     4.349    59.918     0.000     0.633     0.407 
## count_birth_order3/5+         0.052     0.012     0.029     0.075     4.422    45.095     0.000     0.807     0.470 
## count_birth_order4/5+         0.046     0.011     0.025     0.068     4.296    71.863     0.000     0.548     0.371 
## count_birth_order5/5+         0.035     0.014     0.007     0.063     2.423    21.364     0.024     1.849     0.678 
## count_birth_order5+/5+        0.033     0.009     0.015     0.050     3.686    42.007     0.001     0.862     0.487 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.195    17.773     0.848     2.468     0.739 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.660    20.777     0.517     1.925     0.687 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.406    23.496     0.689     1.624     0.648 
## male                          0.008     0.003     0.003     0.013     2.947   551.747     0.003     0.146     0.131 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.186 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-199" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-505-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-49" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:      NA      13      NA      NA      NA 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   9.660       1  23.440   0.005   1.629 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-24" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-507-1.png" width="672" /></p>
</div>
</div>
<div id="attended_school" class="section level3">
<h3>attended_school</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = attended_school)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-25" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-50" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-200" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.501     0.017     0.467     0.535    28.886    12.920     0.000     5.047     0.855 
## poly(age, 3, raw = TRUE)1     0.017     0.002     0.014     0.020    11.204    29.555     0.000     1.231     0.579 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -5.026    39.548     0.000     0.912     0.502 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.542    44.487     0.130     0.817     0.473 
## male                         -0.016     0.005    -0.026    -0.005    -2.990    87.340     0.004     0.473     0.336 
## sibling_count                 0.004     0.001     0.002     0.006     3.950    66.179     0.000     0.584     0.387 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.028 
## Residual~~Residual                     0.169 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-200" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-509-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-50" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-201" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.496     0.018     0.461     0.531    27.887    12.792     0.000     5.202     0.859 
## birth_order                   0.006     0.002     0.003     0.010     3.765    51.987     0.000     0.713     0.437 
## poly(age, 3, raw = TRUE)1     0.017     0.001     0.014     0.020    11.179    30.294     0.000     1.198     0.572 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.717    44.110     0.000     0.824     0.475 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.110    50.288     0.272     0.733     0.445 
## male                         -0.016     0.005    -0.026    -0.006    -2.996    87.367     0.004     0.473     0.336 
## sibling_count                 0.000     0.001    -0.002     0.003     0.103    97.197     0.918     0.437     0.318 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.028 
## Residual~~Residual                     0.168 
## ICC|mother_pidlink                     0.143 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-201" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-511-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-50" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-202" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.510     0.017     0.477     0.544    29.640    13.769     0.000     4.221     0.831 
## birth_order_nonlinear2       -0.009     0.007    -0.023     0.004    -1.385   125.577     0.169     0.366     0.279 
## birth_order_nonlinear3       -0.009     0.010    -0.028     0.010    -0.922    40.718     0.362     0.887     0.494 
## birth_order_nonlinear4        0.007     0.013    -0.018     0.032     0.538    33.251     0.594     1.084     0.547 
## birth_order_nonlinear5        0.014     0.015    -0.015     0.043     0.947    37.474     0.350     0.961     0.515 
## birth_order_nonlinear5+       0.040     0.013     0.015     0.065     3.106    56.541     0.003     0.664     0.419 
## poly(age, 3, raw = TRUE)1     0.017     0.001     0.014     0.019    11.082    30.954     0.000     1.170     0.566 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.672    45.797     0.000     0.796     0.466 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.033    52.503     0.307     0.707     0.435 
## male                         -0.016     0.005    -0.026    -0.005    -2.986    87.951     0.004     0.470     0.335 
## sibling_count                 0.001     0.001    -0.001     0.004     0.840   101.724     0.403     0.423     0.311 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.028 
## Residual~~Residual                     0.169 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-202" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-513-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-50" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-203" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.474     0.022     0.431     0.517    21.624    17.103     0.000     2.642     0.753 
## count_birth_order2/2          0.022     0.013    -0.002     0.047     1.778    53.532     0.081     0.695     0.431 
## count_birth_order1/3          0.026     0.017    -0.008     0.060     1.523    33.106     0.137     1.089     0.548 
## count_birth_order2/3         -0.003     0.015    -0.032     0.026    -0.201    68.280     0.841     0.570     0.381 
## count_birth_order3/3          0.022     0.015    -0.008     0.052     1.451    54.613     0.152     0.683     0.427 
## count_birth_order1/4          0.040     0.017     0.007     0.072     2.398   289.054     0.017     0.214     0.182 
## count_birth_order2/4          0.025     0.020    -0.014     0.065     1.267    47.492     0.211     0.771     0.458 
## count_birth_order3/4          0.002     0.021    -0.041     0.044     0.071    30.875     0.944     1.173     0.567 
## count_birth_order4/4          0.041     0.018     0.005     0.076     2.236    55.442     0.029     0.675     0.423 
## count_birth_order1/5          0.064     0.022     0.021     0.107     2.935   132.380     0.004     0.353     0.272 
## count_birth_order2/5          0.053     0.020     0.013     0.093     2.616   711.724     0.009     0.127     0.115 
## count_birth_order3/5          0.031     0.023    -0.013     0.075     1.379    73.189     0.172     0.540     0.368 
## count_birth_order4/5          0.027     0.020    -0.013     0.067     1.330   180.572     0.185     0.287     0.232 
## count_birth_order5/5          0.042     0.028    -0.012     0.096     1.511    22.067     0.145     1.767     0.667 
## count_birth_order1/5+         0.051     0.019     0.013     0.089     2.640    50.633     0.011     0.729     0.443 
## count_birth_order2/5+         0.028     0.017    -0.006     0.061     1.617   153.152     0.108     0.320     0.252 
## count_birth_order3/5+         0.034     0.017    -0.000     0.068     1.939    84.911     0.056     0.483     0.341 
## count_birth_order4/5+         0.043     0.020     0.005     0.082     2.216    38.193     0.033     0.943     0.510 
## count_birth_order5/5+         0.051     0.016     0.020     0.083     3.183   126.199     0.002     0.364     0.278 
## count_birth_order5+/5+        0.073     0.011     0.052     0.094     6.758   399.519     0.000     0.177     0.154 
## poly(age, 3, raw = TRUE)1     0.019     0.002     0.014     0.023     8.396    22.534     0.000     1.717     0.661 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.691    34.331     0.001     1.049     0.538 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.558    50.135     0.579     0.735     0.445 
## male                         -0.019     0.005    -0.029    -0.009    -3.781   274.154     0.000     0.221     0.187 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.166 
## ICC|mother_pidlink                     0.140 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-203" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-515-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-50" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 423.327      13 132.036   0.000   0.216 
##  2 vs 3:   1.897       4  20.610   0.149   1.159 
##  3 vs 4:  14.051       1  52.562   0.000   0.706 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-25" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-51" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-204" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.500     0.018     0.465     0.535    27.786    12.729     0.000     5.284     0.861 
## poly(age, 3, raw = TRUE)1     0.017     0.001     0.014     0.020    11.479    30.283     0.000     1.199     0.572 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -5.100    39.314     0.000     0.917     0.503 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.534    44.229     0.132     0.822     0.474 
## male                         -0.016     0.005    -0.026    -0.005    -2.989    89.265     0.004     0.465     0.332 
## sibling_count                 0.005     0.002     0.002     0.008     3.075    40.734     0.004     0.887     0.494 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.028 
## Residual~~Residual                     0.169 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-204" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-518-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-51" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-205" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.492     0.019     0.455     0.529    26.188    12.494     0.000     5.611     0.868 
## birth_order                   0.011     0.002     0.006     0.015     4.314    41.372     0.000     0.874     0.490 
## poly(age, 3, raw = TRUE)1     0.017     0.001     0.014     0.020    11.430    30.478     0.000     1.190     0.571 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.824    43.076     0.000     0.842     0.481 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.149    49.333     0.256     0.746     0.449 
## male                         -0.016     0.005    -0.026    -0.006    -3.006    92.531     0.003     0.453     0.326 
## sibling_count                -0.001     0.002    -0.004     0.003    -0.430   138.471     0.668     0.342     0.265 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.028 
## Residual~~Residual                     0.168 
## ICC|mother_pidlink                     0.143 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-205" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-520-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-51" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-206" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.509     0.018     0.474     0.543    28.887    13.693     0.000     4.283     0.833 
## birth_order_nonlinear2       -0.005     0.007    -0.019     0.009    -0.686    53.593     0.496     0.694     0.431 
## birth_order_nonlinear3        0.008     0.011    -0.013     0.030     0.757    26.472     0.456     1.399     0.611 
## birth_order_nonlinear4        0.018     0.013    -0.006     0.043     1.463    50.972     0.149     0.725     0.442 
## birth_order_nonlinear5        0.036     0.016     0.005     0.066     2.267    65.181     0.027     0.591     0.390 
## birth_order_nonlinear5+       0.062     0.017     0.029     0.095     3.726    51.742     0.000     0.715     0.438 
## poly(age, 3, raw = TRUE)1     0.017     0.002     0.014     0.020    11.054    29.976     0.000     1.212     0.575 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.548    43.835     0.000     0.829     0.476 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.885    51.696     0.380     0.716     0.439 
## male                         -0.015     0.005    -0.026    -0.005    -2.898   100.655     0.005     0.427     0.313 
## sibling_count                -0.000     0.002    -0.003     0.003    -0.047   331.592     0.963     0.197     0.170 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.028 
## Residual~~Residual                     0.168 
## ICC|mother_pidlink                     0.143 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-206" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-522-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-51" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-207" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.459     0.023     0.414     0.505    19.759    14.948     0.000     3.463     0.801 
## count_birth_order2/2          0.027     0.015    -0.002     0.056     1.833    21.242     0.081     1.865     0.680 
## count_birth_order1/3          0.027     0.016    -0.004     0.058     1.694    33.352     0.100     1.081     0.546 
## count_birth_order2/3          0.005     0.013    -0.020     0.029     0.367    78.677     0.715     0.511     0.354 
## count_birth_order3/3          0.039     0.017     0.005     0.073     2.266    24.878     0.032     1.509     0.630 
## count_birth_order1/4          0.042     0.019     0.004     0.080     2.190    56.372     0.033     0.665     0.420 
## count_birth_order2/4          0.022     0.015    -0.008     0.052     1.458   225.479     0.146     0.250     0.207 
## count_birth_order3/4          0.028     0.016    -0.003     0.058     1.795   184.976     0.074     0.283     0.229 
## count_birth_order4/4          0.038     0.018     0.003     0.074     2.110    56.385     0.039     0.665     0.420 
## count_birth_order1/5          0.031     0.024    -0.015     0.078     1.336   141.237     0.184     0.338     0.263 
## count_birth_order2/5          0.014     0.028    -0.041     0.070     0.505    28.003     0.617     1.309     0.595 
## count_birth_order3/5          0.028     0.024    -0.018     0.075     1.190    48.109     0.240     0.762     0.455 
## count_birth_order4/5          0.038     0.026    -0.013     0.089     1.470    32.472     0.151     1.112     0.553 
## count_birth_order5/5          0.053     0.026     0.002     0.104     2.035    39.601     0.049     0.911     0.501 
## count_birth_order1/5+         0.018     0.024    -0.028     0.065     0.762    68.065     0.448     0.571     0.382 
## count_birth_order2/5+         0.008     0.021    -0.034     0.049     0.357    69.863     0.722     0.560     0.377 
## count_birth_order3/5+         0.015     0.022    -0.027     0.058     0.707    46.299     0.483     0.789     0.464 
## count_birth_order4/5+         0.039     0.023    -0.007     0.085     1.677    34.060     0.103     1.058     0.540 
## count_birth_order5/5+         0.052     0.020     0.013     0.091     2.601    66.298     0.011     0.583     0.387 
## count_birth_order5+/5+        0.075     0.015     0.046     0.105     4.995    68.798     0.000     0.567     0.379 
## poly(age, 3, raw = TRUE)1     0.021     0.002     0.017     0.026    10.084    21.044     0.000     1.890     0.683 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -5.518    27.233     0.000     1.352     0.603 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.425    30.237     0.021     1.201     0.573 
## male                         -0.016     0.006    -0.028    -0.005    -2.746    71.625     0.008     0.549     0.372 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.026 
## Residual~~Residual                     0.164 
## ICC|mother_pidlink                     0.138 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-207" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-524-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-51" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 458.151      13  44.411   0.000   0.442 
##  2 vs 3: 213.559       4  30.543   0.000   0.789 
##  3 vs 4:  18.368       1  41.139   0.000   0.879 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-25" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-526-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="work" class="section level2 tabset">
<h2>Work</h2>
<div id="income-last-month-log---z-standardized" class="section level3 tabset">
<h3>Income Last Month (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_month_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-26" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-52" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-208" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.167     0.045    -0.255    -0.079    -3.706    11.691     0.003     7.156     0.894 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.003     0.012     1.156    22.497     0.260     1.721     0.661 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.207    30.825     0.236     1.176     0.568 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.768    29.569     0.087     1.231     0.579 
## male                          0.073     0.024     0.026     0.120     3.042    13.108     0.009     4.835     0.850 
## sibling_count                -0.000     0.003    -0.007     0.007    -0.032    15.726     0.975     3.107     0.783 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-208" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-528-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-52" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-209" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.171     0.045    -0.259    -0.082    -3.769    11.732     0.003     7.055     0.893 
## birth_order                   0.005     0.004    -0.003     0.012     1.262    76.096     0.211     0.524     0.360 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.003     0.012     1.132    22.659     0.269     1.704     0.659 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.322    31.903     0.196     1.133     0.558 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.890    30.384     0.068     1.194     0.572 
## male                          0.073     0.024     0.026     0.120     3.041    13.105     0.009     4.838     0.850 
## sibling_count                -0.003     0.004    -0.010     0.005    -0.759    27.298     0.454     1.348     0.602 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-209" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-530-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-52" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-210" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.176     0.049    -0.272    -0.081    -3.616    11.619     0.004     7.342     0.897 
## birth_order_nonlinear2        0.016     0.016    -0.015     0.047     1.011   114.231     0.314     0.390     0.293 
## birth_order_nonlinear3        0.024     0.030    -0.035     0.082     0.785    17.669     0.443     2.493     0.741 
## birth_order_nonlinear4        0.033     0.033    -0.032     0.098     1.000    22.147     0.328     1.758     0.666 
## birth_order_nonlinear5        0.027     0.029    -0.030     0.083     0.920    88.997     0.360     0.466     0.333 
## birth_order_nonlinear5+       0.018     0.030    -0.041     0.076     0.591    50.120     0.557     0.735     0.445 
## poly(age, 3, raw = TRUE)1     0.005     0.004    -0.003     0.012     1.195    22.108     0.245     1.763     0.667 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.165    30.753     0.253     1.179     0.568 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.696    29.034     0.101     1.256     0.584 
## male                          0.073     0.024     0.026     0.120     3.040    13.130     0.009     4.811     0.849 
## sibling_count                -0.002     0.004    -0.009     0.005    -0.445    27.636     0.660     1.329     0.599 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-210" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-532-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-52" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-211" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.170     0.045    -0.258    -0.082    -3.801    20.299     0.001     1.993     0.695 
## count_birth_order2/2          0.007     0.028    -0.049     0.062     0.243    62.487     0.809     0.612     0.398 
## count_birth_order1/3          0.010     0.035    -0.058     0.078     0.292    59.139     0.771     0.640     0.410 
## count_birth_order2/3          0.027     0.032    -0.036     0.091     0.844   100.049     0.401     0.428     0.314 
## count_birth_order3/3          0.025     0.040    -0.054     0.104     0.622    27.597     0.539     1.331     0.599 
## count_birth_order1/4          0.014     0.047    -0.079     0.107     0.298    39.060     0.768     0.923     0.505 
## count_birth_order2/4          0.020     0.040    -0.059     0.099     0.488   114.622     0.627     0.389     0.292 
## count_birth_order3/4          0.019     0.048    -0.075     0.113     0.396    31.962     0.695     1.131     0.557 
## count_birth_order4/4          0.030     0.049    -0.066     0.126     0.617    27.200     0.542     1.354     0.603 
## count_birth_order1/5         -0.029     0.050    -0.126     0.068    -0.583   133.778     0.561     0.350     0.270 
## count_birth_order2/5          0.028     0.058    -0.085     0.141     0.485    48.329     0.630     0.759     0.454 
## count_birth_order3/5         -0.003     0.067    -0.134     0.128    -0.045    23.659     0.964     1.609     0.646 
## count_birth_order4/5          0.030     0.069    -0.106     0.166     0.431    21.027     0.671     1.892     0.683 
## count_birth_order5/5          0.030     0.053    -0.074     0.135     0.567    35.646     0.574     1.010     0.528 
## count_birth_order1/5+        -0.019     0.041    -0.100     0.062    -0.464    76.204     0.644     0.524     0.360 
## count_birth_order2/5+        -0.019     0.046    -0.110     0.071    -0.419    40.395     0.678     0.894     0.496 
## count_birth_order3/5+         0.014     0.051    -0.085     0.114     0.280    25.834     0.782     1.440     0.619 
## count_birth_order4/5+         0.016     0.051    -0.084     0.116     0.307    24.041     0.762     1.576     0.641 
## count_birth_order5/5+         0.006     0.040    -0.072     0.085     0.160    58.109     0.874     0.649     0.413 
## count_birth_order5+/5+        0.002     0.037    -0.070     0.074     0.058    22.482     0.954     1.723     0.662 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.558    43.506     0.580     0.834     0.478 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.583    50.618     0.120     0.729     0.443 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.866    46.627     0.068     0.784     0.462 
## male                          0.074     0.024     0.027     0.120     3.102    14.026     0.008     4.026     0.824 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-211" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-534-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-52" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 900.710      13 117.819   0.000   0.232 
##  2 vs 3:   1.482       4  14.171   0.260   1.835 
##  3 vs 4:   1.455       1  76.627   0.232   0.521 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-26" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-53" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-212" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.166     0.046    -0.257    -0.076    -3.597    11.611     0.004     7.362     0.897 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.003     0.012     1.164    22.480     0.257     1.723     0.662 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.200    30.210     0.239     1.202     0.573 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.763    29.267     0.088     1.245     0.582 
## male                          0.073     0.024     0.026     0.120     3.043    13.109     0.009     4.834     0.850 
## sibling_count                -0.000     0.005    -0.010     0.010    -0.060    16.378     0.953     2.865     0.768 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-212" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-537-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-53" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-213" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.172     0.047    -0.264    -0.080    -3.665    11.643     0.003     7.277     0.896 
## birth_order                   0.007     0.005    -0.003     0.017     1.424    83.321     0.158     0.490     0.344 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.003     0.012     1.149    22.612     0.262     1.709     0.660 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.308    31.919     0.200     1.132     0.558 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.887    30.933     0.069     1.171     0.567 
## male                          0.073     0.024     0.026     0.120     3.042    13.108     0.009     4.834     0.850 
## sibling_count                -0.004     0.005    -0.015     0.006    -0.805    27.552     0.428     1.334     0.600 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-213" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-539-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-53" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-214" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.166     0.048    -0.260    -0.071    -3.438    11.787     0.005     6.926     0.891 
## birth_order_nonlinear2        0.008     0.016    -0.025     0.040     0.459    49.769     0.648     0.740     0.447 
## birth_order_nonlinear3        0.022     0.020    -0.017     0.062     1.120    77.026     0.266     0.519     0.358 
## birth_order_nonlinear4        0.003     0.028    -0.051     0.057     0.111    60.759     0.912     0.626     0.404 
## birth_order_nonlinear5        0.014     0.036    -0.057     0.085     0.385    57.871     0.702     0.651     0.414 
## birth_order_nonlinear5+       0.027     0.038    -0.048     0.103     0.704    48.504     0.485     0.757     0.453 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.003     0.012     1.125    22.898     0.272     1.681     0.656 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.282    31.564     0.209     1.146     0.561 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.834    30.390     0.077     1.194     0.571 
## male                          0.072     0.024     0.024     0.120     2.964    13.121     0.011     4.820     0.850 
## sibling_count                -0.003     0.005    -0.013     0.008    -0.526    26.128     0.603     1.421     0.615 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.096 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-214" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-541-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-53" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-215" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.171     0.044    -0.257    -0.085    -3.914    19.745     0.001     2.078     0.704 
## count_birth_order2/2          0.010     0.027    -0.043     0.063     0.372    45.814     0.711     0.796     0.466 
## count_birth_order1/3          0.012     0.031    -0.048     0.072     0.397    82.303     0.693     0.494     0.346 
## count_birth_order2/3          0.013     0.029    -0.044     0.069     0.439    80.441     0.662     0.503     0.350 
## count_birth_order3/3          0.025     0.034    -0.041     0.092     0.751    42.868     0.457     0.846     0.482 
## count_birth_order1/4         -0.025     0.056    -0.135     0.085    -0.442    22.796     0.663     1.691     0.657 
## count_birth_order2/4         -0.003     0.044    -0.089     0.084    -0.066    34.929     0.948     1.031     0.534 
## count_birth_order3/4          0.023     0.046    -0.068     0.114     0.495    30.308     0.624     1.197     0.572 
## count_birth_order4/4         -0.005     0.052    -0.107     0.098    -0.086    23.331     0.932     1.639     0.650 
## count_birth_order1/5         -0.000     0.063    -0.124     0.124    -0.002    42.432     0.999     0.854     0.484 
## count_birth_order2/5          0.003     0.067    -0.129     0.134     0.038    25.484     0.970     1.465     0.623 
## count_birth_order3/5          0.004     0.066    -0.125     0.133     0.058    23.843     0.954     1.593     0.643 
## count_birth_order4/5         -0.029     0.054    -0.134     0.076    -0.537    49.632     0.594     0.742     0.448 
## count_birth_order5/5         -0.004     0.059    -0.120     0.111    -0.074    41.242     0.941     0.877     0.491 
## count_birth_order1/5+        -0.036     0.066    -0.166     0.093    -0.548    27.537     0.588     1.335     0.600 
## count_birth_order2/5+        -0.046     0.066    -0.175     0.083    -0.705    21.391     0.488     1.846     0.677 
## count_birth_order3/5+         0.003     0.049    -0.093     0.099     0.058    50.089     0.954     0.736     0.446 
## count_birth_order4/5+         0.005     0.055    -0.102     0.112     0.088    30.601     0.931     1.185     0.570 
## count_birth_order5/5+         0.005     0.072    -0.135     0.145     0.068    16.229     0.947     2.917     0.771 
## count_birth_order5+/5+        0.005     0.048    -0.088     0.098     0.107    19.578     0.916     2.106     0.707 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.004     0.011     0.928    55.768     0.357     0.671     0.422 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.735   137.125     0.085     0.344     0.267 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.470   206.788     0.014     0.264     0.216 
## male                          0.075     0.023     0.030     0.119     3.250    15.229     0.005     3.325     0.794 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-215" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-543-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-53" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 684.434      13  16.067   0.000   1.038 
##  2 vs 3: 588.887       4  54.679   0.000   0.492 
##  3 vs 4:   1.893       1  82.601   0.173   0.493 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-26" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-545-1.png" width="672" /></p>
</div>
</div>
<div id="income-last-year-log---z-standardized" class="section level3 tabset">
<h3>Income last year (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_year_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-27" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-54" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-216" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.398     0.045    -0.486    -0.311    -8.907    11.575     0.000     7.459     0.898 
## poly(age, 3, raw = TRUE)1     0.016     0.003     0.010     0.023     4.838    28.163     0.000     1.300     0.593 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.151    37.522     0.257     0.960     0.515 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.828    28.437     0.078     1.286     0.590 
## male                          0.079     0.017     0.045     0.114     4.544    18.567     0.000     2.292     0.724 
## sibling_count                -0.001     0.004    -0.009     0.006    -0.345    14.034     0.736     4.021     0.824 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.832 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-216" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-547-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-54" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-217" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.403     0.045    -0.491    -0.315    -8.994    11.633     0.000     7.305     0.896 
## birth_order                   0.006     0.004    -0.001     0.013     1.649    68.917     0.104     0.566     0.379 
## poly(age, 3, raw = TRUE)1     0.016     0.003     0.009     0.023     4.801    28.259     0.000     1.295     0.592 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.317    39.683     0.195     0.909     0.501 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.009    30.035     0.054     1.209     0.575 
## male                          0.079     0.017     0.045     0.114     4.541    18.557     0.000     2.294     0.725 
## sibling_count                -0.005     0.004    -0.012     0.003    -1.281    25.517     0.212     1.462     0.622 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.832 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-217" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-549-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-54" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-218" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.405     0.048    -0.498    -0.311    -8.460    11.573     0.000     7.466     0.898 
## birth_order_nonlinear2        0.015     0.017    -0.017     0.048     0.917    54.185     0.363     0.688     0.428 
## birth_order_nonlinear3        0.013     0.028    -0.042     0.068     0.473    18.740     0.642     2.257     0.721 
## birth_order_nonlinear4        0.031     0.035    -0.037     0.099     0.895    18.984     0.382     2.211     0.717 
## birth_order_nonlinear5        0.037     0.033    -0.027     0.102     1.136    35.802     0.263     1.006     0.527 
## birth_order_nonlinear5+       0.027     0.029    -0.031     0.084     0.911    47.411     0.367     0.772     0.458 
## poly(age, 3, raw = TRUE)1     0.016     0.003     0.010     0.023     4.763    26.697     0.000     1.384     0.609 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.144    34.726     0.260     1.037     0.535 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.784    26.526     0.086     1.395     0.611 
## male                          0.079     0.017     0.045     0.113     4.537    18.602     0.000     2.285     0.724 
## sibling_count                -0.003     0.004    -0.011     0.004    -0.931    23.277     0.362     1.644     0.651 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.832 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-218" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-551-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-54" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-219" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.404     0.041    -0.484    -0.323    -9.827    23.421     0.000     1.631     0.649 
## count_birth_order2/2          0.010     0.029    -0.046     0.067     0.354    46.674     0.725     0.783     0.462 
## count_birth_order1/3          0.004     0.037    -0.067     0.076     0.112    39.851     0.912     0.906     0.500 
## count_birth_order2/3          0.015     0.034    -0.052     0.082     0.446    55.521     0.658     0.674     0.423 
## count_birth_order3/3          0.016     0.039    -0.060     0.092     0.409    28.445     0.685     1.286     0.590 
## count_birth_order1/4          0.034     0.050    -0.064     0.131     0.673    29.467     0.506     1.235     0.580 
## count_birth_order2/4          0.024     0.039    -0.053     0.101     0.610   115.451     0.543     0.387     0.291 
## count_birth_order3/4          0.008     0.043    -0.077     0.093     0.191    44.885     0.850     0.811     0.471 
## count_birth_order4/4          0.032     0.044    -0.055     0.118     0.716    35.326     0.479     1.019     0.531 
## count_birth_order1/5         -0.006     0.058    -0.120     0.108    -0.103    37.993     0.918     0.948     0.512 
## count_birth_order2/5          0.039     0.059    -0.078     0.155     0.650    37.248     0.520     0.967     0.517 
## count_birth_order3/5          0.000     0.069    -0.135     0.136     0.001    20.572     0.999     1.954     0.690 
## count_birth_order4/5          0.016     0.064    -0.111     0.142     0.244    23.374     0.809     1.635     0.649 
## count_birth_order5/5          0.044     0.053    -0.060     0.147     0.827    33.786     0.414     1.067     0.542 
## count_birth_order1/5+        -0.031     0.040    -0.110     0.047    -0.784    79.065     0.435     0.509     0.354 
## count_birth_order2/5+        -0.009     0.043    -0.094     0.076    -0.210    49.911     0.835     0.738     0.446 
## count_birth_order3/5+        -0.007     0.044    -0.094     0.080    -0.163    38.203     0.872     0.943     0.510 
## count_birth_order4/5+         0.011     0.051    -0.089     0.111     0.219    22.521     0.829     1.719     0.661 
## count_birth_order5/5+         0.008     0.044    -0.079     0.095     0.188    32.356     0.852     1.116     0.554 
## count_birth_order5+/5+        0.001     0.036    -0.070     0.071     0.015    22.866     0.988     1.684     0.656 
## poly(age, 3, raw = TRUE)1     0.014     0.004     0.006     0.021     3.711    71.930     0.000     0.547     0.371 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.899    99.271     0.061     0.431     0.315 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.463    78.430     0.016     0.512     0.355 
## male                          0.078     0.018     0.044     0.113     4.438    20.875     0.000     1.912     0.685 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.108 
## Residual~~Residual                     0.836 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-219" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-553-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-54" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 878.115      13 128.314   0.000   0.220 
##  2 vs 3:   1.892       4  18.168   0.155   1.335 
##  3 vs 4:   2.573       1  68.701   0.113   0.567 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-27" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-55" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-220" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.395     0.046    -0.485    -0.306    -8.649    11.541     0.000     7.553     0.899 
## poly(age, 3, raw = TRUE)1     0.016     0.003     0.010     0.023     4.772    25.915     0.000     1.435     0.618 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.128    35.864     0.267     1.004     0.527 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.836    28.299     0.077     1.293     0.592 
## male                          0.079     0.017     0.045     0.114     4.553    18.601     0.000     2.285     0.724 
## sibling_count                -0.003     0.005    -0.014     0.007    -0.652    15.441     0.524     3.228     0.789 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.832 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-220" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-556-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-55" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-221" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.402     0.045    -0.491    -0.313    -8.844    11.688     0.000     7.163     0.894 
## birth_order                   0.009     0.005    -0.001     0.019     1.717    54.338     0.092     0.686     0.428 
## poly(age, 3, raw = TRUE)1     0.016     0.003     0.010     0.023     4.737    25.767     0.000     1.445     0.619 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.258    36.709     0.216     0.981     0.521 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -1.980    29.254     0.057     1.245     0.582 
## male                          0.079     0.017     0.045     0.114     4.549    18.578     0.000     2.290     0.724 
## sibling_count                -0.008     0.006    -0.019     0.002    -1.515    23.231     0.143     1.648     0.651 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.832 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-221" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-558-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-55" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-222" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.392     0.047    -0.483    -0.300    -8.356    11.820     0.000     6.848     0.890 
## birth_order_nonlinear2        0.007     0.017    -0.027     0.041     0.388    32.630     0.701     1.106     0.552 
## birth_order_nonlinear3        0.020     0.025    -0.028     0.068     0.807    26.000     0.427     1.429     0.617 
## birth_order_nonlinear4        0.013     0.034    -0.053     0.079     0.381    24.252     0.707     1.559     0.638 
## birth_order_nonlinear5        0.016     0.044    -0.069     0.102     0.373    24.673     0.713     1.525     0.633 
## birth_order_nonlinear5+       0.044     0.033    -0.021     0.109     1.318   109.835     0.190     0.401     0.299 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.009     0.023     4.565    25.259     0.000     1.481     0.625 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.267    34.235     0.214     1.052     0.539 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -1.976    28.925     0.058     1.261     0.586 
## male                          0.078     0.018     0.043     0.114     4.353    18.177     0.000     2.374     0.732 
## sibling_count                -0.007     0.006    -0.018     0.004    -1.274    22.780     0.215     1.692     0.657 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.106 
## Residual~~Residual                     0.834 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-222" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-560-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-55" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-223" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.407     0.044    -0.494    -0.320    -9.150    18.404     0.000     2.326     0.727 
## count_birth_order2/2          0.010     0.027    -0.044     0.063     0.359    37.627     0.722     0.957     0.514 
## count_birth_order1/3         -0.006     0.030    -0.064     0.052    -0.190    91.624     0.849     0.456     0.328 
## count_birth_order2/3          0.004     0.028    -0.051     0.059     0.153    82.245     0.879     0.494     0.347 
## count_birth_order3/3          0.013     0.042    -0.070     0.095     0.300    20.318     0.768     1.990     0.694 
## count_birth_order1/4         -0.013     0.045    -0.102     0.076    -0.282    42.470     0.779     0.853     0.484 
## count_birth_order2/4         -0.015     0.044    -0.100     0.071    -0.334    33.424     0.740     1.079     0.545 
## count_birth_order3/4          0.013     0.042    -0.068     0.095     0.321    42.201     0.749     0.858     0.486 
## count_birth_order4/4          0.005     0.045    -0.084     0.093     0.105    34.060     0.917     1.058     0.540 
## count_birth_order1/5         -0.008     0.067    -0.139     0.123    -0.123    31.017     0.903     1.168     0.566 
## count_birth_order2/5         -0.017     0.064    -0.142     0.108    -0.268    27.585     0.791     1.332     0.599 
## count_birth_order3/5         -0.012     0.061    -0.132     0.109    -0.188    27.228     0.852     1.353     0.603 
## count_birth_order4/5         -0.042     0.060    -0.160     0.076    -0.697    28.032     0.491     1.307     0.595 
## count_birth_order5/5         -0.019     0.056    -0.130     0.091    -0.344    44.576     0.733     0.816     0.472 
## count_birth_order1/5+        -0.059     0.056    -0.169     0.051    -1.057    47.621     0.296     0.769     0.457 
## count_birth_order2/5+        -0.054     0.065    -0.182     0.074    -0.833    20.592     0.414     1.951     0.690 
## count_birth_order3/5+        -0.016     0.051    -0.116     0.084    -0.310    35.936     0.759     1.002     0.526 
## count_birth_order4/5+        -0.011     0.050    -0.109     0.088    -0.211    38.514     0.834     0.936     0.508 
## count_birth_order5/5+        -0.019     0.070    -0.156     0.119    -0.266    16.167     0.794     2.939     0.773 
## count_birth_order5+/5+       -0.004     0.041    -0.085     0.077    -0.102    25.847     0.919     1.440     0.619 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.008     0.023     4.101    38.318     0.000     0.940     0.510 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.388    66.345     0.170     0.583     0.387 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.278    75.711     0.026     0.526     0.361 
## male                          0.080     0.019     0.043     0.118     4.201    19.239     0.000     2.164     0.712 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-223" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-562-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-55" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 754.377      13  20.914   0.000   0.807 
##  2 vs 3: 423.190       4  24.233   0.000   0.980 
##  3 vs 4:   2.762       1  52.976   0.102   0.701 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-27" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-564-1.png" width="672" /></p>
</div>
</div>
<div id="self-employment---non-standardized" class="section level3 tabset">
<h3>Self-Employment - non standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = Self_employed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-28" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-56" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-224" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.156     0.049     0.060     0.253     3.174    10.836     0.009    10.279     0.924 
## poly(age, 3, raw = TRUE)1    -0.002     0.003    -0.009     0.004    -0.715    23.194     0.482     1.652     0.652 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.395    54.603     0.020     0.683     0.427 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.005    84.119     0.048     0.486     0.343 
## male                          0.063     0.015     0.033     0.092     4.164    23.286     0.000     1.643     0.650 
## sibling_count                 0.001     0.002    -0.004     0.005     0.404    30.500     0.689     1.189     0.570 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.071 
## Residual~~Residual                     0.791 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-224" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-566-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-56" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-225" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.051     0.056     0.258     3.059    10.716     0.011    10.965     0.929 
## birth_order                  -0.001     0.004    -0.009     0.007    -0.204    35.662     0.839     1.010     0.528 
## poly(age, 3, raw = TRUE)1    -0.002     0.003    -0.009     0.004    -0.719    23.896     0.479     1.589     0.642 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.432    65.870     0.018     0.586     0.388 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -1.980    89.130     0.051     0.466     0.333 
## male                          0.063     0.015     0.033     0.092     4.164    23.297     0.000     1.642     0.650 
## sibling_count                 0.001     0.003    -0.004     0.007     0.470    48.823     0.641     0.752     0.451 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.071 
## Residual~~Residual                     0.791 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-225" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-568-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-56" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-226" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.156     0.052     0.055     0.257     3.019    10.932     0.012     9.791     0.921 
## birth_order_nonlinear2        0.002     0.020    -0.038     0.042     0.097    23.469     0.924     1.627     0.648 
## birth_order_nonlinear3       -0.004     0.028    -0.059     0.050    -0.158    18.076     0.876     2.397     0.734 
## birth_order_nonlinear4       -0.003     0.030    -0.062     0.055    -0.110    24.404     0.913     1.546     0.636 
## birth_order_nonlinear5       -0.008     0.032    -0.072     0.055    -0.261    33.506     0.795     1.076     0.545 
## birth_order_nonlinear5+      -0.006     0.028    -0.061     0.049    -0.202    48.546     0.841     0.756     0.453 
## poly(age, 3, raw = TRUE)1    -0.002     0.003    -0.009     0.004    -0.712    23.893     0.483     1.589     0.642 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.432    66.783     0.018     0.580     0.385 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.019   108.209     0.046     0.405     0.301 
## male                          0.063     0.015     0.033     0.092     4.179    23.477     0.000     1.626     0.648 
## sibling_count                 0.001     0.003    -0.004     0.007     0.562    82.078     0.576     0.495     0.347 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.070 
## Residual~~Residual                     0.791 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-226" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-570-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-56" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-227" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.167     0.070     0.030     0.304     2.386    11.551     0.035     7.525     0.899 
## count_birth_order2/2         -0.005     0.031    -0.066     0.055    -0.179    30.529     0.859     1.188     0.570 
## count_birth_order1/3         -0.024     0.030    -0.084     0.036    -0.789    88.901     0.432     0.467     0.333 
## count_birth_order2/3          0.005     0.044    -0.080     0.091     0.124    20.220     0.903     2.004     0.696 
## count_birth_order3/3         -0.004     0.046    -0.094     0.087    -0.078    17.422     0.938     2.555     0.746 
## count_birth_order1/4         -0.012     0.041    -0.093     0.069    -0.281    53.490     0.780     0.695     0.431 
## count_birth_order2/4          0.001     0.043    -0.083     0.084     0.014    45.342     0.989     0.803     0.468 
## count_birth_order3/4         -0.016     0.056    -0.125     0.094    -0.281    18.436     0.782     2.319     0.727 
## count_birth_order4/4         -0.021     0.051    -0.122     0.079    -0.414    20.071     0.683     2.027     0.698 
## count_birth_order1/5         -0.032     0.048    -0.126     0.063    -0.660    87.894     0.511     0.471     0.335 
## count_birth_order2/5         -0.017     0.068    -0.151     0.117    -0.254    21.223     0.802     1.867     0.680 
## count_birth_order3/5         -0.010     0.045    -0.097     0.078    -0.218   126.672     0.828     0.363     0.278 
## count_birth_order4/5          0.003     0.062    -0.118     0.125     0.054    22.725     0.957     1.698     0.658 
## count_birth_order5/5         -0.021     0.050    -0.119     0.077    -0.419    34.688     0.678     1.038     0.535 
## count_birth_order1/5+         0.013     0.042    -0.070     0.096     0.314    42.167     0.755     0.859     0.486 
## count_birth_order2/5+         0.018     0.041    -0.062     0.097     0.434    55.072     0.666     0.679     0.425 
## count_birth_order3/5+         0.004     0.045    -0.084     0.092     0.092    29.775     0.927     1.221     0.577 
## count_birth_order4/5+         0.014     0.039    -0.063     0.091     0.353    48.304     0.726     0.759     0.454 
## count_birth_order5/5+         0.005     0.039    -0.073     0.082     0.119    42.617     0.906     0.850     0.483 
## count_birth_order5+/5+        0.004     0.027    -0.050     0.058     0.141    48.098     0.888     0.762     0.455 
## poly(age, 3, raw = TRUE)1    -0.003     0.006    -0.014     0.008    -0.529    16.258     0.604     2.907     0.771 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.427    21.996     0.168     1.775     0.668 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.185    27.340     0.246     1.346     0.602 
## male                          0.063     0.015     0.033     0.092     4.157    27.519     0.000     1.336     0.600 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.068 
## Residual~~Residual                     0.782 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-227" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-572-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-56" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 558.922      13  17.712   0.000   0.942 
##  2 vs 3:   2.480       4  22.600   0.073   1.052 
##  3 vs 4:   0.289       1 106.663   0.592   0.409 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-28" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-57" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-228" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.156     0.049     0.060     0.252     3.179    10.926     0.009     9.821     0.921 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.004    -0.687    21.575     0.500     1.824     0.675 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.367    51.686     0.022     0.716     0.439 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.006    84.748     0.048     0.483     0.341 
## male                          0.063     0.015     0.033     0.092     4.173    23.414     0.000     1.631     0.649 
## sibling_count                 0.001     0.003    -0.005     0.007     0.458    60.882     0.649     0.625     0.404 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.071 
## Residual~~Residual                     0.791 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-228" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-575-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-57" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-229" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.156     0.051     0.057     0.256     3.096    10.867     0.010    10.120     0.923 
## birth_order                  -0.001     0.005    -0.010     0.008    -0.213    80.936     0.832     0.500     0.349 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.004    -0.687    21.733     0.500     1.805     0.672 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.359    53.361     0.022     0.697     0.432 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -1.970    80.900     0.052     0.500     0.349 
## male                          0.063     0.015     0.033     0.092     4.172    23.410     0.000     1.632     0.649 
## sibling_count                 0.002     0.004    -0.006     0.010     0.468    53.466     0.641     0.696     0.431 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.071 
## Residual~~Residual                     0.791 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-229" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-577-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-57" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-230" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.051     0.058     0.259     3.093    11.046     0.010     9.272     0.917 
## birth_order_nonlinear2       -0.004     0.018    -0.039     0.031    -0.205    26.853     0.839     1.375     0.607 
## birth_order_nonlinear3       -0.003     0.023    -0.048     0.043    -0.126    27.616     0.901     1.330     0.599 
## birth_order_nonlinear4       -0.012     0.029    -0.070     0.045    -0.424    33.718     0.674     1.069     0.543 
## birth_order_nonlinear5        0.004     0.041    -0.077     0.084     0.088    26.953     0.931     1.369     0.606 
## birth_order_nonlinear5+      -0.002     0.033    -0.067     0.062    -0.076    96.294     0.939     0.440     0.320 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.005    -0.711    20.672     0.485     1.940     0.689 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.333    49.359     0.024     0.745     0.449 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -1.986    84.673     0.050     0.484     0.341 
## male                          0.063     0.016     0.032     0.093     4.047    22.506     0.001     1.720     0.661 
## sibling_count                 0.002     0.004    -0.006     0.009     0.442    79.706     0.659     0.506     0.352 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.070 
## Residual~~Residual                     0.794 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-230" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-579-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-57" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-231" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.168     0.058     0.053     0.282     2.867    12.545     0.014     5.536     0.867 
## count_birth_order2/2         -0.012     0.025    -0.062     0.038    -0.469    41.310     0.642     0.875     0.491 
## count_birth_order1/3         -0.013     0.027    -0.066     0.039    -0.502   139.562     0.617     0.340     0.264 
## count_birth_order2/3         -0.004     0.035    -0.073     0.065    -0.115    22.998     0.910     1.671     0.654 
## count_birth_order3/3         -0.008     0.036    -0.079     0.063    -0.222    25.409     0.826     1.470     0.624 
## count_birth_order1/4         -0.033     0.045    -0.121     0.055    -0.727    34.743     0.472     1.037     0.535 
## count_birth_order2/4         -0.016     0.045    -0.105     0.072    -0.358    24.926     0.723     1.506     0.629 
## count_birth_order3/4          0.003     0.040    -0.075     0.081     0.085    39.288     0.933     0.918     0.503 
## count_birth_order4/4         -0.018     0.036    -0.089     0.053    -0.500    83.103     0.619     0.491     0.345 
## count_birth_order1/5          0.009     0.047    -0.083     0.101     0.197   332.819     0.844     0.197     0.169 
## count_birth_order2/5          0.027     0.053    -0.077     0.130     0.504    47.061     0.617     0.777     0.460 
## count_birth_order3/5          0.000     0.043    -0.083     0.084     0.003   194.020     0.998     0.274     0.223 
## count_birth_order4/5         -0.004     0.053    -0.107     0.100    -0.067    36.984     0.947     0.974     0.519 
## count_birth_order5/5         -0.013     0.065    -0.141     0.114    -0.202    22.839     0.841     1.686     0.657 
## count_birth_order1/5+         0.003     0.062    -0.117     0.124     0.055    26.758     0.956     1.381     0.608 
## count_birth_order2/5+         0.004     0.046    -0.086     0.094     0.096    59.672     0.924     0.635     0.408 
## count_birth_order3/5+         0.001     0.038    -0.075     0.076     0.016   199.494     0.987     0.270     0.220 
## count_birth_order4/5+         0.008     0.045    -0.081     0.097     0.184    46.702     0.855     0.783     0.462 
## count_birth_order5/5+         0.023     0.050    -0.074     0.121     0.468    29.445     0.643     1.236     0.580 
## count_birth_order5+/5+        0.003     0.031    -0.057     0.064     0.113    69.272     0.911     0.564     0.378 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.012     0.006    -0.617    20.242     0.544     2.001     0.695 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.791    31.814     0.083     1.136     0.559 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.506    46.393     0.139     0.787     0.463 
## male                          0.064     0.017     0.032     0.097     3.872    23.297     0.001     1.642     0.650 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.067 
## Residual~~Residual                     0.772 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-231" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-581-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-57" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 380.693      13   7.868   0.000   2.676 
##  2 vs 3: 308.306       4  15.840   0.000   1.579 
##  3 vs 4:   0.260       1 571.014   0.610   0.144 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-28" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-583-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="smoking-behaviour" class="section level2 tabset">
<h2>Smoking Behaviour</h2>
<div id="ever_smoked" class="section level3 tabset">
<h3>ever_smoked</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = ever_smoked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-29" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-58" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-232" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.184     0.012    -0.208    -0.159   -14.704    13.435     0.000     4.509     0.841 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.007     4.992    36.959     0.000     0.974     0.519 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.793    55.686     0.078     0.672     0.422 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.175    62.080     0.002     0.615     0.400 
## male                          0.662     0.005     0.653     0.671   140.207    34.819     0.000     1.034     0.534 
## sibling_count                 0.004     0.001     0.003     0.006     6.185    95.327     0.000     0.444     0.321 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.134 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-232" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-585-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-58" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-233" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.183     0.013    -0.208    -0.158   -14.498    13.446     0.000     4.498     0.840 
## birth_order                  -0.001     0.001    -0.003     0.002    -0.515    40.461     0.609     0.893     0.496 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.007     5.018    37.335     0.000     0.965     0.516 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.743    59.799     0.086     0.634     0.407 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.129    68.424     0.003     0.569     0.381 
## male                          0.662     0.005     0.653     0.671   140.208    34.820     0.000     1.034     0.534 
## sibling_count                 0.005     0.001     0.003     0.007     4.896   110.060     0.000     0.400     0.299 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.134 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-233" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-587-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-58" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-234" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.184     0.013    -0.210    -0.159   -14.344    13.903     0.000     4.117     0.828 
## birth_order_nonlinear2        0.001     0.005    -0.010     0.012     0.199    76.259     0.843     0.523     0.360 
## birth_order_nonlinear3       -0.001     0.007    -0.016     0.013    -0.158    41.408     0.875     0.873     0.490 
## birth_order_nonlinear4        0.004     0.009    -0.013     0.021     0.488    56.318     0.628     0.666     0.420 
## birth_order_nonlinear5        0.003     0.009    -0.015     0.021     0.296   135.789     0.768     0.347     0.268 
## birth_order_nonlinear5+      -0.003     0.010    -0.024     0.017    -0.321    38.208     0.750     0.943     0.510 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.008     4.940    35.052     0.000     1.027     0.533 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.706    51.849     0.094     0.714     0.438 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.060    58.765     0.003     0.643     0.411 
## male                          0.662     0.005     0.653     0.671   140.121    34.757     0.000     1.036     0.535 
## sibling_count                 0.005     0.001     0.003     0.006     5.096   195.392     0.000     0.273     0.223 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.134 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-234" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-589-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-58" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-235" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.177     0.015    -0.205    -0.148   -12.072    21.839     0.000     1.793     0.671 
## count_birth_order2/2          0.008     0.009    -0.009     0.024     0.890   135.858     0.375     0.347     0.268 
## count_birth_order1/3         -0.005     0.013    -0.030     0.020    -0.402    37.321     0.690     0.965     0.516 
## count_birth_order2/3          0.007     0.011    -0.015     0.029     0.607    77.901     0.545     0.515     0.356 
## count_birth_order3/3          0.007     0.014    -0.021     0.035     0.524    23.944     0.605     1.585     0.642 
## count_birth_order1/4          0.006     0.015    -0.023     0.035     0.393    57.258     0.696     0.657     0.416 
## count_birth_order2/4          0.004     0.013    -0.021     0.029     0.306   327.258     0.760     0.199     0.171 
## count_birth_order3/4          0.009     0.013    -0.016     0.034     0.690   135.635     0.491     0.347     0.268 
## count_birth_order4/4          0.016     0.015    -0.013     0.045     1.079    39.256     0.287     0.919     0.503 
## count_birth_order1/5          0.028     0.016    -0.003     0.059     1.755   285.144     0.080     0.216     0.183 
## count_birth_order2/5          0.007     0.018    -0.028     0.041     0.387    93.059     0.699     0.451     0.325 
## count_birth_order3/5          0.005     0.019    -0.032     0.042     0.255    43.030     0.800     0.843     0.481 
## count_birth_order4/5          0.033     0.018    -0.001     0.068     1.899    59.796     0.062     0.634     0.407 
## count_birth_order5/5          0.018     0.016    -0.012     0.049     1.166    81.026     0.247     0.500     0.349 
## count_birth_order1/5+         0.049     0.013     0.023     0.075     3.741   131.561     0.000     0.354     0.273 
## count_birth_order2/5+         0.044     0.013     0.018     0.070     3.272   113.043     0.001     0.393     0.295 
## count_birth_order3/5+         0.037     0.012     0.013     0.061     2.992   219.333     0.003     0.254     0.210 
## count_birth_order4/5+         0.031     0.012     0.007     0.056     2.544   143.967     0.012     0.333     0.260 
## count_birth_order5/5+         0.038     0.013     0.012     0.064     2.850    63.848     0.006     0.601     0.394 
## count_birth_order5+/5+        0.037     0.011     0.016     0.058     3.502    37.423     0.001     0.962     0.516 
## poly(age, 3, raw = TRUE)1     0.004     0.001     0.002     0.007     3.490   103.224     0.001     0.419     0.309 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.818    91.057     0.006     0.459     0.329 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.972    81.254     0.000     0.499     0.349 
## male                          0.660     0.005     0.650     0.670   131.812    36.271     0.000     0.993     0.524 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.135 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-235" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-591-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-58" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 176.049      13  57.707   0.000   0.368 
##  2 vs 3:   0.342       4  22.873   0.847   1.039 
##  3 vs 4:   0.148       1  46.351   0.702   0.788 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-29" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-59" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-236" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.185     0.012    -0.209    -0.160   -14.864    13.713     0.000     4.266     0.833 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.004     0.008     5.189    34.080     0.000     1.057     0.540 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.642    52.850     0.106     0.703     0.434 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.204    63.503     0.002     0.604     0.395 
## male                          0.662     0.005     0.653     0.671   140.345    34.963     0.000     1.030     0.533 
## sibling_count                 0.005     0.001     0.003     0.007     5.431   375.572     0.000     0.183     0.159 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.135 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-236" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-594-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-59" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-237" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.184     0.013    -0.209    -0.160   -14.636    13.753     0.000     4.234     0.832 
## birth_order                  -0.000     0.002    -0.004     0.004    -0.076    24.264     0.940     1.558     0.638 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.004     0.008     5.186    33.993     0.000     1.060     0.541 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.628    52.464     0.109     0.707     0.435 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.178    62.840     0.002     0.609     0.397 
## male                          0.662     0.005     0.653     0.671   140.373    34.989     0.000     1.029     0.533 
## sibling_count                 0.005     0.001     0.003     0.008     3.807    87.800     0.000     0.471     0.335 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.135 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-237" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-596-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-59" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-238" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.183     0.012    -0.208    -0.159   -14.683    14.625     0.000     3.640     0.809 
## birth_order_nonlinear2        0.001     0.006    -0.011     0.012     0.103    31.714     0.919     1.140     0.560 
## birth_order_nonlinear3        0.002     0.007    -0.012     0.016     0.248    50.964     0.805     0.725     0.442 
## birth_order_nonlinear4        0.004     0.010    -0.016     0.024     0.408    35.060     0.686     1.027     0.533 
## birth_order_nonlinear5       -0.001     0.014    -0.028     0.027    -0.042    31.632     0.967     1.143     0.560 
## birth_order_nonlinear5+       0.005     0.013    -0.021     0.032     0.407    38.076     0.686     0.946     0.511 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.008     5.064    37.527     0.000     0.960     0.515 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.708    48.430     0.094     0.758     0.453 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.145    56.551     0.003     0.664     0.419 
## male                          0.661     0.005     0.652     0.670   143.915    42.271     0.000     0.857     0.485 
## sibling_count                 0.005     0.001     0.002     0.008     3.623   131.281     0.000     0.355     0.273 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.133 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-238" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-598-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-59" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-239" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.183     0.014    -0.211    -0.155   -12.721    20.911     0.000     1.907     0.685 
## count_birth_order2/2          0.008     0.008    -0.008     0.023     1.003   109.919     0.318     0.401     0.299 
## count_birth_order1/3         -0.001     0.010    -0.021     0.019    -0.063    95.568     0.950     0.443     0.321 
## count_birth_order2/3          0.001     0.010    -0.019     0.022     0.115    51.499     0.909     0.718     0.439 
## count_birth_order3/3          0.006     0.011    -0.016     0.029     0.527    41.538     0.601     0.871     0.489 
## count_birth_order1/4          0.003     0.013    -0.022     0.028     0.243   283.741     0.808     0.217     0.184 
## count_birth_order2/4          0.012     0.016    -0.020     0.044     0.719    25.439     0.479     1.468     0.623 
## count_birth_order3/4          0.016     0.012    -0.008     0.040     1.339   132.174     0.183     0.353     0.272 
## count_birth_order4/4          0.015     0.015    -0.014     0.044     1.015    43.052     0.316     0.842     0.481 
## count_birth_order1/5          0.026     0.018    -0.009     0.061     1.431   161.332     0.154     0.309     0.245 
## count_birth_order2/5          0.023     0.020    -0.017     0.062     1.136    37.251     0.263     0.967     0.517 
## count_birth_order3/5          0.029     0.020    -0.011     0.070     1.442    30.149     0.160     1.204     0.574 
## count_birth_order4/5          0.027     0.017    -0.007     0.060     1.546    67.039     0.127     0.578     0.384 
## count_birth_order5/5          0.034     0.018    -0.002     0.070     1.866    61.138     0.067     0.623     0.403 
## count_birth_order1/5+         0.057     0.019     0.019     0.095     2.942    48.326     0.005     0.759     0.454 
## count_birth_order2/5+         0.046     0.017     0.013     0.080     2.691    50.760     0.010     0.727     0.443 
## count_birth_order3/5+         0.038     0.015     0.008     0.068     2.485    79.768     0.015     0.506     0.352 
## count_birth_order4/5+         0.040     0.015     0.010     0.069     2.642    87.469     0.010     0.472     0.336 
## count_birth_order5/5+         0.023     0.015    -0.006     0.053     1.534    69.459     0.130     0.562     0.378 
## count_birth_order5+/5+        0.043     0.012     0.019     0.066     3.590    57.859     0.001     0.651     0.414 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.004     0.009     4.897    47.867     0.000     0.766     0.456 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.929    47.215     0.358     0.775     0.459 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.130    41.961     0.039     0.863     0.487 
## male                          0.660     0.005     0.651     0.670   140.922    62.293     0.000     0.613     0.399 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.134 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-239" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-600-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-59" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 144.967      13  14.413   0.000   1.164 
##  2 vs 3: 101.346       4  39.620   0.000   0.632 
##  3 vs 4:   0.061       1  37.748   0.806   0.954 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-29" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-602-1.png" width="672" /></p>
</div>
</div>
<div id="still_smoking" class="section level3 tabset">
<h3>still_smoking</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = still_smoking)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-30" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-60" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-240" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.037     0.686     0.833    20.351     9.273     0.000    66.350     0.988 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.606    23.664     0.121     1.609     0.645 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.225    46.168     0.823     0.791     0.464 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.122    46.437     0.904     0.786     0.463 
## male                          0.206     0.022     0.163     0.249     9.302     9.292     0.000    62.085     0.987 
## sibling_count                 0.002     0.001    -0.001     0.004     1.407    13.787     0.182     4.207     0.831 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-240" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-604-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-60" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-241" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.037     0.687     0.833    20.455     9.283     0.000    64.136     0.987 
## birth_order                  -0.000     0.001    -0.003     0.002    -0.372    48.263     0.711     0.760     0.454 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.594    23.615     0.124     1.613     0.646 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.266    45.524     0.791     0.801     0.468 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.167    44.098     0.868     0.824     0.475 
## male                          0.206     0.022     0.163     0.249     9.302     9.292     0.000    62.091     0.987 
## sibling_count                 0.002     0.001    -0.001     0.005     1.399    16.954     0.180     2.684     0.756 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-241" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-606-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-60" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-242" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.038     0.686     0.834    20.034     9.302     0.000    60.197     0.986 
## birth_order_nonlinear2       -0.000     0.005    -0.009     0.009    -0.062    74.269     0.951     0.534     0.365 
## birth_order_nonlinear3       -0.003     0.006    -0.014     0.008    -0.542    72.137     0.590     0.546     0.370 
## birth_order_nonlinear4       -0.000     0.008    -0.016     0.016    -0.015    34.050     0.988     1.058     0.540 
## birth_order_nonlinear5       -0.003     0.010    -0.023     0.018    -0.252    25.970     0.803     1.431     0.617 
## birth_order_nonlinear5+      -0.003     0.009    -0.021     0.014    -0.385    37.368     0.702     0.964     0.516 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.561    22.221     0.133     1.750     0.665 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.246    42.771     0.807     0.847     0.482 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.146    42.214     0.885     0.858     0.486 
## male                          0.206     0.022     0.163     0.249     9.308     9.293     0.000    61.984     0.987 
## sibling_count                 0.002     0.001    -0.001     0.005     1.454    16.852     0.164     2.715     0.758 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-242" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-608-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-60" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-243" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.756     0.035     0.687     0.826    21.308     9.844     0.000    21.803     0.963 
## count_birth_order2/2          0.006     0.007    -0.008     0.020     0.825    93.766     0.411     0.449     0.324 
## count_birth_order1/3          0.011     0.011    -0.009     0.032     1.076    40.960     0.288     0.882     0.493 
## count_birth_order2/3          0.011     0.010    -0.008     0.030     1.092    66.008     0.279     0.585     0.388 
## count_birth_order3/3          0.007     0.009    -0.010     0.024     0.787   149.660     0.432     0.325     0.255 
## count_birth_order1/4          0.010     0.013    -0.015     0.035     0.810    50.179     0.422     0.735     0.445 
## count_birth_order2/4          0.009     0.012    -0.015     0.033     0.761    71.226     0.449     0.552     0.373 
## count_birth_order3/4          0.009     0.015    -0.022     0.039     0.560    22.790     0.581     1.691     0.657 
## count_birth_order4/4          0.011     0.012    -0.012     0.034     0.967    55.673     0.338     0.672     0.422 
## count_birth_order1/5          0.021     0.017    -0.012     0.054     1.249    38.295     0.219     0.941     0.510 
## count_birth_order2/5          0.006     0.018    -0.028     0.041     0.361    34.678     0.720     1.039     0.535 
## count_birth_order3/5          0.007     0.021    -0.034     0.047     0.320    19.620     0.752     2.099     0.706 
## count_birth_order4/5          0.013     0.019    -0.024     0.050     0.693    22.836     0.495     1.687     0.657 
## count_birth_order5/5          0.017     0.014    -0.011     0.044     1.182    51.423     0.243     0.719     0.440 
## count_birth_order1/5+         0.020     0.014    -0.008     0.048     1.401    29.170     0.172     1.250     0.583 
## count_birth_order2/5+         0.015     0.015    -0.013     0.044     1.057    27.787     0.300     1.321     0.597 
## count_birth_order3/5+         0.015     0.013    -0.010     0.039     1.142    40.308     0.260     0.896     0.497 
## count_birth_order4/5+         0.017     0.018    -0.018     0.052     0.968    16.268     0.347     2.903     0.770 
## count_birth_order5/5+         0.012     0.018    -0.024     0.048     0.654    15.212     0.523     3.332     0.795 
## count_birth_order5+/5+        0.017     0.012    -0.006     0.041     1.429    17.527     0.170     2.528     0.744 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.420    48.358     0.162     0.759     0.454 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.181    81.306     0.857     0.499     0.349 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.099    94.934     0.921     0.445     0.322 
## male                          0.206     0.022     0.163     0.249     9.350     9.335     0.000    54.206     0.985 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-243" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-610-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-60" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  36.361      13   7.603   0.000   2.854 
##  2 vs 3:      NA       4      NA      NA      NA 
##  3 vs 4:   0.513       1 297.314   0.474   0.211 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-30" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-61" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-244" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.038     0.685     0.835    19.964     9.272     0.000    66.604     0.988 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.448    24.025     0.161     1.578     0.641 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.305    46.538     0.762     0.785     0.462 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.101    46.134     0.920     0.791     0.464 
## male                          0.206     0.022     0.163     0.249     9.307     9.292     0.000    62.040     0.987 
## sibling_count                 0.002     0.002    -0.002     0.006     0.764    12.655     0.459     5.382     0.863 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-244" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-613-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-61" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-245" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.761     0.038     0.686     0.835    19.956     9.282     0.000    64.344     0.987 
## birth_order                  -0.001     0.002    -0.004     0.002    -0.443    42.250     0.660     0.857     0.485 
## poly(age, 3, raw = TRUE)1    -0.001     0.001    -0.004     0.001    -1.441    24.081     0.162     1.573     0.640 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.343    45.877     0.733     0.795     0.466 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.144    44.463     0.886     0.818     0.473 
## male                          0.206     0.022     0.163     0.249     9.308     9.293     0.000    62.034     0.987 
## sibling_count                 0.002     0.002    -0.002     0.006     0.948    16.072     0.357     2.973     0.775 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-245" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-615-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-61" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-246" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.038     0.685     0.835    19.745     9.304     0.000    59.709     0.986 
## birth_order_nonlinear2       -0.000     0.006    -0.012     0.011    -0.036    21.383     0.972     1.847     0.678 
## birth_order_nonlinear3       -0.002     0.008    -0.016     0.013    -0.202    21.958     0.842     1.779     0.669 
## birth_order_nonlinear4       -0.005     0.009    -0.023     0.014    -0.515    26.600     0.611     1.390     0.610 
## birth_order_nonlinear5        0.000     0.010    -0.020     0.021     0.041    52.798     0.967     0.703     0.434 
## birth_order_nonlinear5+      -0.002     0.010    -0.023     0.018    -0.196    54.364     0.845     0.686     0.428 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.395    22.465     0.177     1.724     0.662 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.309    39.587     0.759     0.911     0.501 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.128    41.359     0.899     0.874     0.491 
## male                          0.206     0.022     0.162     0.250     9.259     9.299     0.000    60.693     0.986 
## sibling_count                 0.002     0.002    -0.002     0.006     0.911    16.172     0.376     2.937     0.772 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.182 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-246" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-617-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-61" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-247" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.762     0.036     0.691     0.832    21.120     9.762     0.000    24.105     0.966 
## count_birth_order2/2          0.003     0.007    -0.012     0.018     0.389    45.450     0.699     0.802     0.468 
## count_birth_order1/3          0.004     0.009    -0.013     0.021     0.417    82.653     0.677     0.493     0.346 
## count_birth_order2/3          0.004     0.009    -0.013     0.022     0.451    46.984     0.654     0.778     0.460 
## count_birth_order3/3          0.003     0.013    -0.022     0.028     0.232    18.400     0.819     2.326     0.727 
## count_birth_order1/4          0.016     0.014    -0.011     0.042     1.134    36.110     0.264     0.997     0.525 
## count_birth_order2/4          0.007     0.014    -0.020     0.034     0.475    25.694     0.639     1.450     0.620 
## count_birth_order3/4          0.002     0.018    -0.034     0.038     0.112    15.492     0.912     3.205     0.788 
## count_birth_order4/4          0.001     0.014    -0.026     0.028     0.077    28.404     0.939     1.288     0.591 
## count_birth_order1/5          0.010     0.020    -0.029     0.049     0.511    27.911     0.613     1.314     0.596 
## count_birth_order2/5          0.015     0.018    -0.021     0.051     0.796    27.934     0.433     1.313     0.596 
## count_birth_order3/5          0.010     0.020    -0.030     0.049     0.486    20.214     0.633     2.005     0.696 
## count_birth_order4/5          0.008     0.017    -0.025     0.040     0.452    32.866     0.655     1.098     0.550 
## count_birth_order5/5          0.007     0.022    -0.036     0.050     0.337    18.858     0.740     2.234     0.719 
## count_birth_order1/5+         0.023     0.021    -0.019     0.064     1.064    20.065     0.300     2.028     0.698 
## count_birth_order2/5+         0.014     0.017    -0.020     0.048     0.799    25.371     0.432     1.473     0.624 
## count_birth_order3/5+         0.017     0.019    -0.020     0.054     0.893    19.190     0.383     2.173     0.713 
## count_birth_order4/5+         0.010     0.019    -0.027     0.047     0.515    18.713     0.612     2.263     0.722 
## count_birth_order5/5+         0.017     0.016    -0.014     0.048     1.086    26.673     0.287     1.386     0.609 
## count_birth_order5+/5+        0.015     0.015    -0.014     0.043     1.022    18.051     0.320     2.403     0.734 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.478    50.782     0.146     0.727     0.443 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.373    72.127     0.710     0.546     0.370 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.289    44.536     0.774     0.817     0.473 
## male                          0.206     0.022     0.163     0.248     9.495     9.378     0.000    48.070     0.983 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-247" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-619-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-61" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  17.846      13   5.342   0.002   7.581 
##  2 vs 3:  15.255       4   8.692   0.001   4.764 
##  3 vs 4:   0.521       1 151.660   0.472   0.322 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-30" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-621-1.png" width="672" /></p>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCm91dHB1dDogaHRtbF9kb2N1bWVudAplZGl0b3Jfb3B0aW9uczogCiAgY2h1bmtfb3V0cHV0X3R5cGU6IGNvbnNvbGUKLS0tCiMgPHNwYW4gc3R5bGU9ImNvbG9yOiNBNkQ4NTQiPkJpcnRoIE9yZGVyIEVmZmVjdHM8L3NwYW4+IHsudGFic2V0fQoKIyMgSGVscGVyCmBgYHtyIGhlbHBlcn0Kc291cmNlKCIwX2hlbHBlcnMuUiIpCm9wdHNfY2h1bmskc2V0KHdhcm5pbmcgPSBGQUxTRSkKCmBgYAoKCiMjIEZ1bmN0aW9ucwoKYGBge3J9CgpuX2ltcHV0YXRpb25zLm1pdG1sID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkaXRlciRtCn0Kbl9pbXB1dGF0aW9ucy5taWRzID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkbQp9Cm5faW1wdXRhdGlvbnMuYW1lbGlhID0gZnVuY3Rpb24oaW1wcykgewogIGxlbmd0aChpbXBzJGltcHV0YXRpb25zKQp9Cm5faW1wdXRhdGlvbnMgPSBmdW5jdGlvbihpbXBzKSB7IFVzZU1ldGhvZCgibl9pbXB1dGF0aW9ucyIpIH0KCmNvbXBsZXRlLm1pdG1sID0gbWl0bWw6Om1pdG1sQ29tcGxldGUKY29tcGxldGUubWlkcyA9IG1pY2U6OmNvbXBsZXRlCmNvbXBsZXRlID0gZnVuY3Rpb24oLi4uKSB7IFVzZU1ldGhvZCgiY29tcGxldGUiKSB9CgpsaWJyYXJ5KG1pY2UpCmxpYnJhcnkobWljZWFkZHMpCmxpYnJhcnkobWl0bWwpCmBgYAoKCiMjIExvYWQgZGF0YQpgYGB7ciBMb2FkIERhdGF9CmJpcnRob3JkZXIgPSByZWFkUkRTKCJkYXRhL2FsbGRhdGFfYmlydGhvcmRlcl9pX21sLnJkcyIpCmBgYAoKIyMgRGF0YSBwcmVwYXJhdGlvbnMKYGBge3IgZGF0YSBwcmVwYXJhdGlvbnN9CmJpcnRob3JkZXIgPC0gbWlkczJtaXRtbC5saXN0KGJpcnRob3JkZXIpCgojIyBDYWxjdWxhdGUgZ19mYWN0b3JzIChmb3Igbm93IHdpdGggcm93TWVhbnM6IGJldHRlciB0byBydW4gZmFjdG9yIGFuYWx5c2lzIGhlcmUgYXMgd2VsbD8pCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDE1X29sZCA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDE1X29sZCwgbWF0aF8yMDE1X29sZCwgY291bnRfYmFja3dhcmRzLCAgd29yZHNfZGVsYXllZCwgYWRhcHRpdmVfbnVtYmVyaW5nKSkpCn0pCgpiaXJ0aG9yZGVyIDwtIHdpdGhpbihiaXJ0aG9yZGVyLCB7CiAgZ19mYWN0b3JfMjAxNV95b3VuZyA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDE1X3lvdW5nLCBtYXRoXzIwMTVfeW91bmcpKSkKfSkKCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDA3X29sZCA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDA3X29sZCwgbWF0aF8yMDA3X29sZCkpKQp9KQoKYmlydGhvcmRlciA8LSB3aXRoaW4oYmlydGhvcmRlciwgewogIGdfZmFjdG9yXzIwMDdfeW91bmcgPC0gcm93TWVhbnMoc2NhbGUoY2JpbmQocmF2ZW5fMjAwN195b3VuZywgbWF0aF8yMDA3X3lvdW5nKSkpCn0pCgoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lIHRibF9kZi5taXRtbC5saXN0CgojIyMgQmlydGhvcmRlciBhbmQgU2libGluZyBDb3VudAojIGZvciBmYWN0b3IgdmFyaWFibGVzIHdlIGhhdmUgdG8gcm91bmQgYmlydGggb3JkZXIgcG9zaXRpb24gYW5kIGVsaW1pbmF0ZSBhbGwgdW5saWtlbHkgbnVtYmVycyAobmVnYXRpdmUgb25lcykKYmlydGhvcmRlcl9kYXRhID0gYmlydGhvcmRlcltbMV1dCgpiaXJ0aG9yZGVyID0gYmlydGhvcmRlciAlPiUKICBtdXRhdGUoYmlydGhvcmRlcl9nZW5lcyA9IGlmZWxzZShiaXJ0aG9yZGVyX2dlbmVzIDwgMCwgMCwgYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSBpZmVsc2UoYmlydGhvcmRlcl9uYWl2ZSA8IDAsIDAsIGJpcnRob3JkZXJfbmFpdmUpLAogICAgICAgICBiaXJ0aG9yZGVyX2dlbmVzID0gcm91bmQoYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSByb3VuZChiaXJ0aG9yZGVyX25haXZlKSwKICAgICAgICAgc2libGluZ19jb3VudF9nZW5lcyA9IGlmZWxzZShzaWJsaW5nX2NvdW50X2dlbmVzIDwgMCwgMCwgc2libGluZ19jb3VudF9nZW5lcyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmUgPSBpZmVsc2Uoc2libGluZ19jb3VudF9uYWl2ZSA8IDAsIDAsIHNpYmxpbmdfY291bnRfbmFpdmUpLAogICAgICAgICBzaWJsaW5nX2NvdW50X2dlbmVzID0gcm91bmQoc2libGluZ19jb3VudF9nZW5lcyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmUgPSByb3VuZChzaWJsaW5nX2NvdW50X25haXZlKQogICAgICAgICApCgoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lIAogIG11dGF0ZSgKIyBiaXJ0aG9yZGVyIGFzIGZhY3RvcnMgd2l0aCBsZXZlbHMgb2YgMSwgMiwgMywgNCwgNSwgNSsKICAgIGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yID0gYXMuY2hhcmFjdGVyKGJpcnRob3JkZXJfbmFpdmUpLAogICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IgPSBpZmVsc2UoYmlydGhvcmRlcl9uYWl2ZSA+IDUsICI1KyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IpLAogICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IgPSBmYWN0b3IoYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjEiLCIyIiwiMyIsIjQiLCI1IiwiNSsiKSksCiAgICBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihzaWJsaW5nX2NvdW50X25haXZlKSwKICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yID0gaWZlbHNlKHNpYmxpbmdfY291bnRfbmFpdmUgPiA1LCAiNSsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yKSwKICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yID0gZmFjdG9yKHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIyIiwiMyIsIjQiLCI1IiwiNSsiKSksCiAgICBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihiaXJ0aG9yZGVyX2dlbmVzKSwKICAgIGJpcnRob3JkZXJfZ2VuZXNfZmFjdG9yID0gaWZlbHNlKGJpcnRob3JkZXJfZ2VuZXMgPjUgLCAiNSsiLCBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciksCiAgICBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciA9IGZhY3RvcihiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIxIiwiMiIsIjMiLCI0IiwiNSIsIjUrIikpLAogICAgc2libGluZ19jb3VudF9nZW5lc19mYWN0b3IgPSBhcy5jaGFyYWN0ZXIoc2libGluZ19jb3VudF9nZW5lcyksCiAgICBzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciA9IGlmZWxzZShzaWJsaW5nX2NvdW50X2dlbmVzID41ICwgIjUrIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yKSwKICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yID0gZmFjdG9yKHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjIiLCIzIiwiNCIsIjUiLCI1KyIpKSwKICAgICMgaW50ZXJhY3Rpb24gYmlydGhvcmRlciAqIHNpYmxpbmdjb3V0IGZvciBlYWNoIGJpcnRob3JkZXIKICAgIGNvdW50X2JpcnRob3JkZXJfbmFpdmUgPQogICAgICBmYWN0b3Ioc3RyX3JlcGxhY2UoYXMuY2hhcmFjdGVyKGludGVyYWN0aW9uKGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IpKSwKICAgICAgICAgICAgICAgICAgICAgICAgIlxcLiIsICIvIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSAgIGMoIjEvMiIsIjIvMiIsICIxLzMiLCAgIjIvMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjMvMyIsICIxLzQiLCAiMi80IiwgIjMvNCIsICI0LzQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIxLzUiLCAiMi81IiwgIjMvNSIsICI0LzUiLCAiNS81IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81KyIsICIyLzUrIiwgIjMvNSsiLCAiNC81KyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjUvNSsiLCAiNSsvNSsiKSksCiAgICBjb3VudF9iaXJ0aG9yZGVyX2dlbmVzID0KICAgICAgZmFjdG9yKHN0cl9yZXBsYWNlKGFzLmNoYXJhY3RlcihpbnRlcmFjdGlvbihiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yKSksICJcXC4iLCAiLyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gICBjKCIxLzIiLCIyLzIiLCAiMS8zIiwgICIyLzMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIzLzMiLCAiMS80IiwgIjIvNCIsICIzLzQiLCAiNC80IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81IiwgIjIvNSIsICIzLzUiLCAiNC81IiwgIjUvNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjEvNSsiLCAiMi81KyIsICIzLzUrIiwgIjQvNSsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI1LzUrIiwgIjUrLzUrIikpKQoKCgojIyMgVmFyaWFibGVzCmJpcnRob3JkZXIgPSBiaXJ0aG9yZGVyICU+JQogIG11dGF0ZSgKICAgIGdfZmFjdG9yXzIwMTVfb2xkID0gKGdfZmFjdG9yXzIwMTVfb2xkIC0gbWVhbihnX2ZhY3Rvcl8yMDE1X29sZCwgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAxNV9vbGQsIG5hLnJtPVQpLAogICAgZ19mYWN0b3JfMjAxNV95b3VuZyA9IChnX2ZhY3Rvcl8yMDE1X3lvdW5nIC0gbWVhbihnX2ZhY3Rvcl8yMDE1X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChnX2ZhY3Rvcl8yMDE1X3lvdW5nLCBuYS5ybT1UKSwKICAgIGdfZmFjdG9yXzIwMDdfb2xkID0gKGdfZmFjdG9yXzIwMDdfb2xkIC0gbWVhbihnX2ZhY3Rvcl8yMDA3X29sZCwgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAwN19vbGQsIG5hLnJtPVQpLApnX2ZhY3Rvcl8yMDA3X3lvdW5nID0gKGdfZmFjdG9yXzIwMDdfeW91bmcgLSBtZWFuKGdfZmFjdG9yXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvIHNkKGdfZmFjdG9yXzIwMDdfeW91bmcsIG5hLnJtPVQpLAogICAgcmF2ZW5fMjAxNV9vbGQgPSAocmF2ZW5fMjAxNV9vbGQgLSBtZWFuKHJhdmVuXzIwMTVfb2xkLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDE1X29sZCksCiAgICBtYXRoXzIwMTVfb2xkID0gKG1hdGhfMjAxNV9vbGQgLSBtZWFuKG1hdGhfMjAxNV9vbGQsIG5hLnJtPVQpKSAvIHNkKG1hdGhfMjAxNV9vbGQsIG5hLnJtPVQpLAogICAgcmF2ZW5fMjAxNV95b3VuZyA9IChyYXZlbl8yMDE1X3lvdW5nIC0gbWVhbihyYXZlbl8yMDE1X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDE1X3lvdW5nKSwKICAgIG1hdGhfMjAxNV95b3VuZyA9IChtYXRoXzIwMTVfeW91bmcgLSBtZWFuKG1hdGhfMjAxNV95b3VuZywgbmEucm09VCkpIC8KICAgICAgc2QobWF0aF8yMDE1X3lvdW5nLCBuYS5ybT1UKSwKICAgIHJhdmVuXzIwMDdfb2xkID0gKHJhdmVuXzIwMDdfb2xkIC0gbWVhbihyYXZlbl8yMDA3X29sZCwgbmEucm09VCkpIC8gc2QocmF2ZW5fMjAwN19vbGQpLAptYXRoXzIwMDdfb2xkID0gKG1hdGhfMjAwN19vbGQgLSBtZWFuKG1hdGhfMjAwN19vbGQsIG5hLnJtPVQpKSAvIHNkKG1hdGhfMjAwN19vbGQsIG5hLnJtPVQpLApyYXZlbl8yMDA3X3lvdW5nID0gKHJhdmVuXzIwMDdfeW91bmcgLSBtZWFuKHJhdmVuXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvIHNkKHJhdmVuXzIwMDdfeW91bmcpLAptYXRoXzIwMDdfeW91bmcgPSAobWF0aF8yMDA3X3lvdW5nIC0gbWVhbihtYXRoXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvCiAgc2QobWF0aF8yMDA3X3lvdW5nLCBuYS5ybT1UKSwKICAgIGNvdW50X2JhY2t3YXJkcyA9IChjb3VudF9iYWNrd2FyZHMgLSBtZWFuKGNvdW50X2JhY2t3YXJkcywgbmEucm09VCkpIC8KICAgICAgc2QoY291bnRfYmFja3dhcmRzLCBuYS5ybT1UKSwKICAgIHdvcmRzX2RlbGF5ZWQgPSAod29yZHNfZGVsYXllZCAtIG1lYW4od29yZHNfZGVsYXllZCwgbmEucm09VCkpIC8KICAgICAgc2Qod29yZHNfZGVsYXllZCwgbmEucm09VCksCiAgICBhZGFwdGl2ZV9udW1iZXJpbmcgPSAoYWRhcHRpdmVfbnVtYmVyaW5nIC0gbWVhbihhZGFwdGl2ZV9udW1iZXJpbmcsIG5hLnJtPVQpKSAvCiAgICAgIHNkKGFkYXB0aXZlX251bWJlcmluZywgbmEucm09VCksCiAgICBiaWc1X2V4dCA9IChiaWc1X2V4dCAtIG1lYW4oYmlnNV9leHQsIG5hLnJtPVQpKSAvIHNkKGJpZzVfZXh0LCBuYS5ybT1UKSwKICAgIGJpZzVfY29uID0gKGJpZzVfY29uIC0gbWVhbihiaWc1X2NvbiwgbmEucm09VCkpIC8gc2QoYmlnNV9jb24sIG5hLnJtPVQpLAogICAgYmlnNV9hZ3JlZSA9IChiaWc1X2FncmVlIC0gbWVhbihiaWc1X2FncmVlLCBuYS5ybT1UKSkgLyBzZChiaWc1X2FncmVlLCBuYS5ybT1UKSwKICAgIGJpZzVfb3BlbiA9IChiaWc1X29wZW4gLSBtZWFuKGJpZzVfb3BlbiwgbmEucm09VCkpIC8gc2QoYmlnNV9vcGVuLCBuYS5ybT1UKSwKICAgIGJpZzVfbmV1ID0gKGJpZzVfbmV1IC0gbWVhbihiaWc1X25ldSwgbmEucm09VCkpIC8gc2QoYmlnNV9uZXUsIG5hLnJtPVQpLAogICAgcmlza0EgPSAocmlza0EgLSBtZWFuKHJpc2tBLCBuYS5ybT1UKSkgLyBzZChyaXNrQSwgbmEucm09VCksCiAgICByaXNrQiA9IChyaXNrQiAtIG1lYW4ocmlza0IsIG5hLnJtPVQpKSAvIHNkKHJpc2tCLCBuYS5ybT1UKSwKICAgIHllYXJzX29mX2VkdWNhdGlvbl96ID0gKHllYXJzX29mX2VkdWNhdGlvbiAtIG1lYW4oeWVhcnNfb2ZfZWR1Y2F0aW9uLCBuYS5ybT1UKSkgLwogICAgICBzZCh5ZWFyc19vZl9lZHVjYXRpb24sIG5hLnJtPVQpLAogICAgd2FnZV9sYXN0X21vbnRoX3ogPSAod2FnZV9sYXN0X21vbnRoX2xvZyAtIG1lYW4od2FnZV9sYXN0X21vbnRoX2xvZywgbmEucm09VCkpIC8KICAgICAgc2Qod2FnZV9sYXN0X21vbnRoX2xvZywgbmEucm09VCksCiAgICB3YWdlX2xhc3RfeWVhcl96ID0gKHdhZ2VfbGFzdF95ZWFyX2xvZyAtIG1lYW4od2FnZV9sYXN0X3llYXJfbG9nLCBuYS5ybT1UKSkgLwogICAgICBzZCh3YWdlX2xhc3RfeWVhcl9sb2csIG5hLnJtPVQpLAogICAgYXR0ZW5kZWRfc2Nob29sID0gYXMuaW50ZWdlcihhdHRlbmRlZF9zY2hvb2wpLAogICAgYXR0ZW5kZWRfc2Nob29sID0gaWZlbHNlKGF0dGVuZGVkX3NjaG9vbCA9PSAxLCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoYXR0ZW5kZWRfc2Nob29sID09IDIsIDEsIE5BKSkpCiAgICAgICAgCmRhdGFfdXNlZCA8LSBiaXJ0aG9yZGVyICU+JQogIG11dGF0ZShzaWJsaW5nX2NvdW50ID0gc2libGluZ19jb3VudF9uYWl2ZSwKICAgICAgICAgYmlydGhfb3JkZXJfbm9ubGluZWFyID0gYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IsCiAgICAgICAgIGJpcnRoX29yZGVyID0gYmlydGhvcmRlcl9uYWl2ZSwKICAgICAgICAgY291bnRfYmlydGhfb3JkZXIgPSBjb3VudF9iaXJ0aG9yZGVyX25haXZlKQoKYGBgCgojIyBJbnRlbGxpZ2VuY2Ugey5hY3RpdmUgLnRhYnNldH0KIyMjIGctZmFjdG9yIDIwMTUgb2xkIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGdfZmFjdG9yXzIwMTVfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCgojIyMgUmF2ZW4gMjAxNSBvbGQgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gcmF2ZW5fMjAxNV9vbGQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgTnVtZXJhY3kgMjAxNSBvbGQgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gbWF0aF8yMDE1X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBDb3VudGluZyBCYWNrd2FyZHMgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gY291bnRfYmFja3dhcmRzKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIERlbGF5ZWQgV29yZCBSZWNhbGwgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gd29yZHNfZGVsYXllZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgQWRhcHRpdmUgTnVtYmVyaW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGFkYXB0aXZlX251bWJlcmluZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoKIyMjIGctZmFjdG9yIDIwMTUgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gZ19mYWN0b3JfMjAxNV95b3VuZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgUmF2ZW4gMjAxNSB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByYXZlbl8yMDE1X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIE51bWVyYWN5IDIwMTUgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gbWF0aF8yMDE1X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIGctZmFjdG9yIDIwMDcgb2xkIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGdfZmFjdG9yXzIwMDdfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBSYXZlbiAyMDA3IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByYXZlbl8yMDA3X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBOdW1lcmFjeSAyMDA3IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBtYXRoXzIwMDdfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIGctZmFjdG9yIDIwMDcgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gZ19mYWN0b3JfMjAwN195b3VuZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgUmF2ZW4gMjAwNyB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByYXZlbl8yMDA3X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIE51bWVyYWN5IDIwMDcgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gbWF0aF8yMDA3X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMgUGVyc29uYWxpdHkgey50YWJzZXR9CgojIyMgRXh0cmF2ZXJzaW9uIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfZXh0KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBOZXVyb3RpY2lzbSB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBiaWc1X25ldSkKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIENvbnNjaWVudGlvdXNuZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfbmV1KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBBZ3JlZWFibGVuZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfYWdyZWUpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIE9wZW5uZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfb3BlbikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIFJpc2twcmVmZXJlbmNlIHsudGFic2V0fQojIyMgUmlzayBBIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJpc2tBKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIFJpc2sgQiB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByaXNrQikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIEVkdWNhdGlvbmFsIEF0dGFpbm1lbnQgey50YWJzZXR9CiMjIyBZZWFycyBvZiBFZHVjYXRpb24gLSB6LXN0YW5kYXJkaXplZHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHllYXJzX29mX2VkdWNhdGlvbl96KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIGVsZW1lbnRhcnlfbWlzc2VkCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gRWxlbWVudGFyeV9taXNzZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIGVsZW1lbnRhcnlfd29ya2VkCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gRWxlbWVudGFyeV93b3JrZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgYXR0ZW5kZWRfc2Nob29sCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYXR0ZW5kZWRfc2Nob29sKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCgojIyBXb3JrIHsudGFic2V0fQoKIyMjIEluY29tZSBMYXN0IE1vbnRoIChsb2cpIC0gei1zdGFuZGFyZGl6ZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHdhZ2VfbGFzdF9tb250aF96KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIEluY29tZSBsYXN0IHllYXIgKGxvZykgLSB6LXN0YW5kYXJkaXplZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gd2FnZV9sYXN0X3llYXJfeikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoKIyMjIFNlbGYtRW1wbG95bWVudCAtIG5vbiBzdGFuZGFyZGl6ZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IFNlbGZfZW1wbG95ZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQpgYGAKCiMjIFNtb2tpbmcgQmVoYXZpb3VyIHsudGFic2V0fQojIyMgZXZlcl9zbW9rZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGV2ZXJfc21va2VkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgojIyMgc3RpbGxfc21va2luZyB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gc3RpbGxfc21va2luZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoK</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
