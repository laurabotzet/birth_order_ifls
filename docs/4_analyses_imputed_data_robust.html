<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("4_analyses_imputed_data_robust.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>
<li style="background-color: #A6D854">
  <a href="4_analyses.html">Birth Order Effects</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
    <span class="fa fa-github"></span>


  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>




</div>


<div id="birth-order-effects" class="section level1 tabset">
<h1><span style="color:#A6D854">Birth Order Effects</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     ggsave</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.5-23.1097</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;sjPlot&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:cowplot&#39;:
## 
##     plot_grid, save_plot</code></pre>
<pre class="r"><code>opts_chunk$set(warning = FALSE)
detach(&quot;package:lmerTest&quot;, unload=TRUE)</code></pre>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<pre class="r"><code>n_imputations.mitml = function(imps) {
  imps$iter$m
}
n_imputations.mids = function(imps) {
  imps$m
}
n_imputations.amelia = function(imps) {
  length(imps$imputations)
}
n_imputations = function(imps) { UseMethod(&quot;n_imputations&quot;) }

complete.mitml = mitml::mitmlComplete
complete.mids = mice::complete
complete = function(...) { UseMethod(&quot;complete&quot;) }

library(mice)</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     complete</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     complete</code></pre>
<pre class="r"><code>library(miceadds)</code></pre>
<pre><code>## * miceadds 2.7-19 (2017-08-24 17:34:44)</code></pre>
<pre class="r"><code>library(mitml)</code></pre>
<pre><code>## *** This is beta software. Please report any bugs!
## *** See the NEWS file for recent changes.</code></pre>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code>birthorder = readRDS(&quot;data/alldata_birthorder_i_ml.rds&quot;)</code></pre>
</div>
<div id="data-preparations" class="section level2">
<h2>Data preparations</h2>
<pre class="r"><code>birthorder &lt;- mids2mitml.list(birthorder)

## Calculate g_factors (for now with rowMeans: better to run factor analysis here as well?)
birthorder &lt;- within(birthorder, {
  g_factor_2015_old &lt;- rowMeans(scale(cbind(raven_2015_old, math_2015_old, count_backwards,  words_delayed, adaptive_numbering)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2015_young &lt;- rowMeans(scale(cbind(raven_2015_young, math_2015_young)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_old &lt;- rowMeans(scale(cbind(raven_2007_old, math_2007_old)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_young &lt;- rowMeans(scale(cbind(raven_2007_young, math_2007_young)))
})


birthorder = birthorder %&gt;% tbl_df.mitml.list

### Birthorder and Sibling Count
# for factor variables we have to round birth order position and eliminate all unlikely numbers (negative ones)
birthorder_data = birthorder[[1]]

birthorder = birthorder %&gt;%
  mutate(birthorder_genes = ifelse(birthorder_genes &lt; 0, 0, birthorder_genes),
         birthorder_naive = ifelse(birthorder_naive &lt; 0, 0, birthorder_naive),
         birthorder_genes = round(birthorder_genes),
         birthorder_naive = round(birthorder_naive),
         sibling_count_genes = ifelse(sibling_count_genes &lt; 0, 0, sibling_count_genes),
         sibling_count_naive = ifelse(sibling_count_naive &lt; 0, 0, sibling_count_naive),
         sibling_count_genes = round(sibling_count_genes),
         sibling_count_naive = round(sibling_count_naive),
         birthorder_genes = ifelse(birthorder_genes &gt; 5, NA, birthorder_genes),
         birthorder_naive = ifelse(birthorder_naive &gt; 5, NA, birthorder_naive),
         sibling_count_genes = ifelse(sibling_count_genes &gt; 5, NA, sibling_count_genes),
         sibling_count_naive = ifelse(sibling_count_naive &gt; 5, NA, sibling_count_naive))


birthorder = birthorder %&gt;% 
  mutate(
# birthorder as factors with levels of 1, 2, 3, 4, 5, 5+
    birthorder_naive_factor = as.character(birthorder_naive),
    birthorder_naive_factor = factor(birthorder_naive_factor, 
                                            levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
    sibling_count_naive_factor = as.character(sibling_count_naive),
    sibling_count_naive_factor = factor(sibling_count_naive_factor, 
                                               levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
    birthorder_genes_factor = as.character(birthorder_genes),
    birthorder_genes_factor = factor(birthorder_genes_factor, 
                                     levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
    sibling_count_genes_factor = as.character(sibling_count_genes),
    sibling_count_genes_factor = factor(sibling_count_genes_factor, 
                                        levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
    # interaction birthorder * siblingcout for each birthorder
    count_birthorder_naive =
      factor(str_replace(as.character(interaction(birthorder_naive_factor,                                                              sibling_count_naive_factor)),
                        &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;)),
    count_birthorder_genes =
      factor(str_replace(as.character(interaction(birthorder_genes_factor,                                                              sibling_count_genes_factor)), &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;)))



### Variables

birthorder = birthorder %&gt;%
  mutate(
    g_factor_2015_old = (g_factor_2015_old - mean(g_factor_2015_old, na.rm=T)) / sd(g_factor_2015_old, na.rm=T),
    g_factor_2015_young = (g_factor_2015_young - mean(g_factor_2015_young, na.rm=T)) / sd(g_factor_2015_young, na.rm=T),
    g_factor_2007_old = (g_factor_2007_old - mean(g_factor_2007_old, na.rm=T)) / sd(g_factor_2007_old, na.rm=T),
g_factor_2007_young = (g_factor_2007_young - mean(g_factor_2007_young, na.rm=T)) / sd(g_factor_2007_young, na.rm=T),
    raven_2015_old = (raven_2015_old - mean(raven_2015_old, na.rm=T)) / sd(raven_2015_old),
    math_2015_old = (math_2015_old - mean(math_2015_old, na.rm=T)) / sd(math_2015_old, na.rm=T),
    raven_2015_young = (raven_2015_young - mean(raven_2015_young, na.rm=T)) / sd(raven_2015_young),
    math_2015_young = (math_2015_young - mean(math_2015_young, na.rm=T)) /
      sd(math_2015_young, na.rm=T),
    raven_2007_old = (raven_2007_old - mean(raven_2007_old, na.rm=T)) / sd(raven_2007_old),
math_2007_old = (math_2007_old - mean(math_2007_old, na.rm=T)) / sd(math_2007_old, na.rm=T),
raven_2007_young = (raven_2007_young - mean(raven_2007_young, na.rm=T)) / sd(raven_2007_young),
math_2007_young = (math_2007_young - mean(math_2007_young, na.rm=T)) /
  sd(math_2007_young, na.rm=T),
    count_backwards = (count_backwards - mean(count_backwards, na.rm=T)) /
      sd(count_backwards, na.rm=T),
    words_delayed = (words_delayed - mean(words_delayed, na.rm=T)) /
      sd(words_delayed, na.rm=T),
    adaptive_numbering = (adaptive_numbering - mean(adaptive_numbering, na.rm=T)) /
      sd(adaptive_numbering, na.rm=T),
    big5_ext = (big5_ext - mean(big5_ext, na.rm=T)) / sd(big5_ext, na.rm=T),
    big5_con = (big5_con - mean(big5_con, na.rm=T)) / sd(big5_con, na.rm=T),
    big5_agree = (big5_agree - mean(big5_agree, na.rm=T)) / sd(big5_agree, na.rm=T),
    big5_open = (big5_open - mean(big5_open, na.rm=T)) / sd(big5_open, na.rm=T),
    big5_neu = (big5_neu - mean(big5_neu, na.rm=T)) / sd(big5_neu, na.rm=T),
    riskA = (riskA - mean(riskA, na.rm=T)) / sd(riskA, na.rm=T),
    riskB = (riskB - mean(riskB, na.rm=T)) / sd(riskB, na.rm=T),
    years_of_education_z = (years_of_education - mean(years_of_education, na.rm=T)) /
      sd(years_of_education, na.rm=T),
    wage_last_month_z = (wage_last_month_log - mean(wage_last_month_log, na.rm=T)) /
      sd(wage_last_month_log, na.rm=T),
    wage_last_year_z = (wage_last_year_log - mean(wage_last_year_log, na.rm=T)) /
      sd(wage_last_year_log, na.rm=T),
    attended_school = as.integer(attended_school),
    attended_school = ifelse(attended_school == 1, 0,
                           ifelse(attended_school == 2, 1, NA)))
data_used &lt;- birthorder %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)</code></pre>
</div>
<div id="intelligence" class="section level2 active tabset">
<h2>Intelligence</h2>
<div id="g-factor-2015-old" class="section level3 tabset">
<h3>g-factor 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.473     0.031     0.412     0.533    15.374    27.938     0.000     1.313     0.596 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.024    -0.009    -4.285    58.168     0.000     0.648     0.413 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.211   299.848     0.833     0.210     0.179 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.388   932.109     0.017     0.109     0.100 
## male                         -0.029     0.015    -0.057    -0.000    -1.984    85.023     0.050     0.482     0.341 
## sibling_count3                0.005     0.020    -0.033     0.044     0.265   246.023     0.791     0.236     0.198 
## sibling_count4               -0.013     0.023    -0.058     0.032    -0.574   169.545     0.567     0.299     0.239 
## sibling_count5               -0.007     0.026    -0.057     0.043    -0.285   248.888     0.776     0.235     0.197 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.190 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.220 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-1" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.480     0.037     0.408     0.552    13.035    34.105     0.000     1.056     0.540 
## birth_order                  -0.003     0.009    -0.020     0.014    -0.343    42.915     0.734     0.845     0.482 
## poly(age, 3, raw = TRUE)1    -0.017     0.004    -0.024    -0.009    -4.171    53.920     0.000     0.691     0.429 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.285   212.272     0.776     0.259     0.213 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.399   619.509     0.017     0.137     0.123 
## male                         -0.029     0.015    -0.057    -0.000    -1.979    85.105     0.051     0.482     0.341 
## sibling_count3                0.007     0.021    -0.034     0.048     0.344   158.243     0.731     0.313     0.248 
## sibling_count4               -0.009     0.026    -0.061     0.042    -0.354   101.637     0.724     0.424     0.311 
## sibling_count5               -0.002     0.031    -0.063     0.060    -0.048   101.286     0.962     0.425     0.312 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.190 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.220 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-1" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-2" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.475     0.035     0.405     0.544    13.427    29.383     0.000     1.239     0.581 
## birth_order_nonlinear2        0.001     0.021    -0.040     0.041     0.026    31.129     0.980     1.163     0.565 
## birth_order_nonlinear3       -0.004     0.023    -0.049     0.040    -0.198    77.820     0.844     0.515     0.356 
## birth_order_nonlinear4       -0.022     0.035    -0.091     0.047    -0.630    35.900     0.533     1.003     0.526 
## birth_order_nonlinear5        0.005     0.045    -0.082     0.093     0.119    71.914     0.906     0.547     0.371 
## poly(age, 3, raw = TRUE)1    -0.017     0.004    -0.025    -0.008    -4.031    48.008     0.000     0.764     0.455 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.251   151.005     0.802     0.323     0.254 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.291   322.158     0.023     0.201     0.172 
## male                         -0.029     0.015    -0.057    -0.000    -1.987    85.003     0.050     0.482     0.341 
## sibling_count3                0.007     0.021    -0.035     0.049     0.340   175.204     0.735     0.293     0.235 
## sibling_count4               -0.005     0.026    -0.055     0.045    -0.196   175.608     0.845     0.293     0.235 
## sibling_count5               -0.002     0.032    -0.064     0.060    -0.075   116.930     0.940     0.384     0.289 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.190 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.220 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-2" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-3" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.470     0.035     0.402     0.538    13.484    44.508     0.000     0.817     0.473 
## count_birth_order2/2          0.004     0.026    -0.048     0.055     0.134    47.393     0.894     0.772     0.458 
## count_birth_order1/3          0.014     0.029    -0.042     0.070     0.493   172.390     0.623     0.296     0.237 
## count_birth_order2/3         -0.008     0.031    -0.070     0.054    -0.249    70.224     0.804     0.558     0.376 
## count_birth_order3/3          0.014     0.028    -0.041     0.069     0.490   183.797     0.625     0.284     0.230 
## count_birth_order1/4         -0.001     0.034    -0.068     0.065    -0.042   672.168     0.966     0.131     0.118 
## count_birth_order2/4          0.010     0.036    -0.060     0.080     0.286   214.018     0.775     0.258     0.212 
## count_birth_order3/4         -0.036     0.037    -0.109     0.038    -0.952    83.298     0.344     0.490     0.344 
## count_birth_order4/4         -0.015     0.037    -0.088     0.058    -0.403    64.532     0.688     0.596     0.392 
## count_birth_order1/5         -0.021     0.045    -0.109     0.067    -0.468   189.091     0.640     0.279     0.226 
## count_birth_order2/5          0.026     0.045    -0.062     0.114     0.588   229.670     0.557     0.247     0.205 
## count_birth_order3/5          0.008     0.041    -0.072     0.087     0.188   634.786     0.851     0.135     0.122 
## count_birth_order4/5         -0.043     0.045    -0.133     0.046    -0.957    91.771     0.341     0.456     0.328 
## count_birth_order5/5          0.004     0.043    -0.079     0.088     0.103    85.497     0.918     0.480     0.340 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.024    -0.008    -3.840    53.093     0.000     0.700     0.433 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.099   149.604     0.921     0.325     0.255 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.103   275.640     0.036     0.221     0.187 
## male                         -0.029     0.014    -0.057    -0.000    -1.992    86.449     0.050     0.476     0.338 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.190 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.220 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-3" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.469       6 138.190   0.830   1.509 
##  2 vs 3:   0.224       3  42.797   0.879   3.099 
##  3 vs 4:   0.304       1  11.282   0.592   3.760</code></pre>
</div>
</div>
<div id="parental-full-sibling-order" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-1" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-4" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.460     0.032     0.397     0.522    14.419    22.333     0.000     1.738     0.664 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.024    -0.007    -3.601    22.227     0.002     1.750     0.665 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.324    29.581     0.748     1.230     0.579 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.579    36.222     0.123     0.994     0.524 
## male                         -0.023     0.014    -0.051     0.004    -1.675    58.163     0.099     0.648     0.413 
## sibling_count3                0.018     0.022    -0.025     0.061     0.816    34.644     0.420     1.040     0.536 
## sibling_count4               -0.026     0.023    -0.072     0.020    -1.125    68.729     0.265     0.567     0.380 
## sibling_count5               -0.085     0.029    -0.141    -0.028    -2.934    61.053     0.005     0.623     0.403 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.667 
## ICC|mother_pidlink                     0.233 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-4" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-1" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-5" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.447     0.035     0.378     0.516    12.645    28.882     0.000     1.264     0.586 
## birth_order                   0.005     0.009    -0.012     0.023     0.618    29.250     0.541     1.246     0.582 
## poly(age, 3, raw = TRUE)1    -0.015     0.004    -0.024    -0.007    -3.479    22.833     0.002     1.687     0.657 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.392    29.706     0.698     1.224     0.578 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.525    36.122     0.136     0.997     0.525 
## male                         -0.023     0.014    -0.051     0.005    -1.632    51.925     0.109     0.713     0.438 
## sibling_count3                0.014     0.022    -0.028     0.057     0.671    42.156     0.506     0.859     0.486 
## sibling_count4               -0.033     0.025    -0.082     0.016    -1.305    70.407     0.196     0.556     0.375 
## sibling_count5               -0.092     0.034    -0.159    -0.026    -2.719    43.183     0.009     0.840     0.480 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.233 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-5" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-1" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-6" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.465     0.033     0.400     0.529    14.131    30.704     0.000     1.181     0.569 
## birth_order_nonlinear2       -0.004     0.017    -0.037     0.030    -0.213    51.204     0.832     0.722     0.441 
## birth_order_nonlinear3       -0.004     0.022    -0.048     0.039    -0.202    55.573     0.841     0.673     0.423 
## birth_order_nonlinear4       -0.002     0.036    -0.072     0.068    -0.056    29.361     0.956     1.240     0.581 
## birth_order_nonlinear5        0.001     0.055    -0.106     0.109     0.025    32.664     0.980     1.105     0.552 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.025    -0.007    -3.584    22.523     0.002     1.718     0.661 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.128    28.182     0.899     1.299     0.593 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.726    34.220     0.093     1.053     0.539 
## male                         -0.024     0.014    -0.053     0.004    -1.691    51.965     0.097     0.713     0.437 
## sibling_count3                0.016     0.022    -0.027     0.060     0.740    42.997     0.464     0.843     0.481 
## sibling_count4               -0.028     0.026    -0.078     0.022    -1.114    76.225     0.269     0.523     0.360 
## sibling_count5               -0.084     0.035    -0.153    -0.015    -2.378    41.388     0.022     0.874     0.490 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.201 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.231 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-6" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-1" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-7" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.450     0.030     0.391     0.508    15.051    79.759     0.000     0.506     0.352 
## count_birth_order2/2          0.011     0.027    -0.041     0.063     0.421    30.309     0.677     1.197     0.572 
## count_birth_order1/3          0.023     0.034    -0.044     0.090     0.676    31.654     0.504     1.142     0.560 
## count_birth_order2/3          0.004     0.033    -0.060     0.068     0.124    29.750     0.902     1.222     0.577 
## count_birth_order3/3          0.032     0.031    -0.030     0.093     1.018    43.756     0.314     0.830     0.477 
## count_birth_order1/4         -0.022     0.044    -0.108     0.064    -0.504    38.822     0.617     0.929     0.506 
## count_birth_order2/4         -0.023     0.037    -0.095     0.049    -0.636    60.953     0.527     0.624     0.404 
## count_birth_order3/4         -0.046     0.033    -0.111     0.019    -1.377   145.100     0.171     0.332     0.259 
## count_birth_order4/4         -0.014     0.039    -0.091     0.063    -0.358    49.258     0.722     0.747     0.449 
## count_birth_order1/5         -0.064     0.048    -0.158     0.030    -1.343   217.413     0.181     0.255     0.211 
## count_birth_order2/5         -0.098     0.053    -0.201     0.006    -1.847    46.485     0.071     0.786     0.463 
## count_birth_order3/5         -0.083     0.045    -0.171     0.006    -1.838   107.885     0.069     0.406     0.302 
## count_birth_order4/5         -0.094     0.056    -0.205     0.016    -1.673    29.542     0.105     1.232     0.579 
## count_birth_order5/5         -0.072     0.051    -0.172     0.027    -1.424    60.041     0.160     0.632     0.407 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.023    -0.006    -3.359    27.628     0.002     1.330     0.599 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.445    33.909     0.659     1.063     0.541 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.500    39.525     0.142     0.913     0.502 
## male                         -0.027     0.015    -0.056     0.002    -1.812    48.257     0.076     0.760     0.454 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.201 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.231 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-7" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-1" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.362       6  54.410   0.900 235.300 
##  2 vs 3:   0.365       3  27.087   0.779 491.340 
##  3 vs 4:   0.293       1   9.046   0.601 170.402</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2015-old" class="section level3 tabset">
<h3>Raven 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-1" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-2" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-8" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.341     0.031     0.281     0.402    10.992    28.205     0.000     1.298     0.593 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.018    -0.003    -2.890    84.830     0.005     0.483     0.341 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.671   276.139     0.503     0.220     0.186 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.459   317.368     0.145     0.203     0.174 
## male                          0.029     0.015    -0.001     0.058     1.892    68.212     0.063     0.570     0.381 
## sibling_count3                0.008     0.019    -0.030     0.046     0.391   435.349     0.696     0.168     0.148 
## sibling_count4                0.003     0.024    -0.044     0.050     0.137   130.083     0.891     0.357     0.274 
## sibling_count5                0.021     0.027    -0.031     0.073     0.784   169.117     0.434     0.300     0.240 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.201 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.227 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-8" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-2" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-9" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.346     0.038     0.271     0.421     9.030    30.933     0.000     1.171     0.567 
## birth_order                  -0.002     0.008    -0.017     0.013    -0.257   131.745     0.797     0.354     0.272 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.018    -0.003    -2.780    70.363     0.007     0.557     0.375 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.597   212.376     0.551     0.259     0.213 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.474   274.069     0.142     0.221     0.187 
## male                          0.029     0.015    -0.001     0.058     1.891    67.035     0.063     0.578     0.385 
## sibling_count3                0.009     0.020    -0.030     0.047     0.451   650.002     0.652     0.133     0.120 
## sibling_count4                0.006     0.025    -0.043     0.055     0.236   225.717     0.814     0.250     0.207 
## sibling_count5                0.025     0.030    -0.034     0.083     0.828   219.608     0.408     0.254     0.210 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.201 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.227 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-9" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-2" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-10" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.346     0.034     0.279     0.413    10.100    34.534     0.000     1.043     0.537 
## birth_order_nonlinear2       -0.005     0.017    -0.038     0.028    -0.299   108.383     0.765     0.405     0.301 
## birth_order_nonlinear3        0.005     0.022    -0.037     0.047     0.233   131.121     0.816     0.355     0.273 
## birth_order_nonlinear4       -0.025     0.031    -0.085     0.035    -0.822    85.525     0.414     0.480     0.340 
## birth_order_nonlinear5        0.008     0.046    -0.082     0.098     0.175    65.418     0.862     0.590     0.389 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.018    -0.003    -2.755    70.501     0.007     0.556     0.375 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.591   196.260     0.555     0.272     0.222 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.446   232.945     0.150     0.245     0.203 
## male                          0.029     0.015    -0.001     0.058     1.884    66.041     0.064     0.585     0.387 
## sibling_count3                0.005     0.021    -0.037     0.047     0.231   214.332     0.818     0.258     0.212 
## sibling_count4                0.008     0.026    -0.042     0.059     0.317   215.646     0.751     0.257     0.212 
## sibling_count5                0.022     0.030    -0.037     0.081     0.729   303.087     0.467     0.208     0.178 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.201 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.227 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-10" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-2" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-11" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.348     0.035     0.279     0.418     9.819    43.557     0.000     0.833     0.478 
## count_birth_order2/2         -0.015     0.024    -0.062     0.032    -0.614    89.537     0.541     0.464     0.332 
## count_birth_order1/3         -0.006     0.033    -0.071     0.058    -0.196    57.135     0.845     0.658     0.417 
## count_birth_order2/3         -0.014     0.035    -0.083     0.054    -0.410    40.675     0.684     0.888     0.495 
## count_birth_order3/3          0.018     0.026    -0.034     0.070     0.678   861.654     0.498     0.114     0.104 
## count_birth_order1/4         -0.000     0.037    -0.073     0.073    -0.005   146.599     0.996     0.329     0.258 
## count_birth_order2/4          0.024     0.036    -0.047     0.095     0.654   204.111     0.514     0.266     0.218 
## count_birth_order3/4         -0.030     0.039    -0.106     0.045    -0.785    72.905     0.435     0.542     0.368 
## count_birth_order4/4         -0.007     0.036    -0.078     0.065    -0.188    87.849     0.851     0.471     0.335 
## count_birth_order1/5          0.007     0.045    -0.081     0.095     0.163   214.627     0.871     0.258     0.212 
## count_birth_order2/5          0.032     0.045    -0.057     0.121     0.695   233.559     0.488     0.244     0.203 
## count_birth_order3/5          0.041     0.045    -0.048     0.130     0.910   123.011     0.365     0.371     0.282 
## count_birth_order4/5         -0.038     0.043    -0.122     0.047    -0.874   203.265     0.383     0.266     0.218 
## count_birth_order5/5          0.025     0.053    -0.078     0.128     0.473    30.157     0.640     1.204     0.574 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.018    -0.003    -2.640    89.210     0.010     0.465     0.332 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.696   239.162     0.487     0.241     0.201 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.330   238.739     0.185     0.241     0.201 
## male                          0.029     0.015    -0.001     0.058     1.893    68.144     0.063     0.571     0.381 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.201 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.227 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-11" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-2" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.583       6 127.785   0.743   1.679 
##  2 vs 3:   0.263       3  43.713   0.852   2.949 
##  3 vs 4:   0.096       1  11.662   0.762   3.269</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-1" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-3" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-12" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.325     0.031     0.263     0.386    10.316    23.968     0.000     1.583     0.641 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.000    -2.010    33.839     0.052     1.065     0.542 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.771    45.571     0.083     0.800     0.467 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.257    50.808     0.798     0.727     0.442 
## male                          0.036     0.015     0.006     0.066     2.346    39.939     0.024     0.904     0.499 
## sibling_count3                0.012     0.022    -0.030     0.055     0.559    38.574     0.579     0.934     0.508 
## sibling_count4               -0.013     0.024    -0.061     0.035    -0.521    57.820     0.604     0.652     0.414 
## sibling_count5               -0.055     0.031    -0.117     0.007    -1.751    41.759     0.087     0.867     0.488 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-12" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-3" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-13" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.318     0.037     0.246     0.390     8.674    27.080     0.000     1.361     0.605 
## birth_order                   0.003     0.008    -0.013     0.018     0.361    52.173     0.720     0.710     0.437 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.000    -1.913    33.533     0.064     1.075     0.544 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.798    44.566     0.079     0.816     0.473 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.222    49.889     0.825     0.738     0.446 
## male                          0.036     0.015     0.006     0.066     2.333    39.472     0.025     0.914     0.502 
## sibling_count3                0.010     0.021    -0.031     0.052     0.490    48.869     0.626     0.752     0.451 
## sibling_count4               -0.016     0.024    -0.063     0.032    -0.650   114.695     0.517     0.389     0.292 
## sibling_count5               -0.059     0.032    -0.121     0.004    -1.838    66.371     0.071     0.583     0.386 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.690 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-13" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-3" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-14" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.325     0.035     0.257     0.393     9.349    27.066     0.000     1.362     0.605 
## birth_order_nonlinear2        0.003     0.017    -0.031     0.036     0.156    54.165     0.877     0.688     0.428 
## birth_order_nonlinear3        0.003     0.022    -0.040     0.045     0.122    65.593     0.903     0.588     0.389 
## birth_order_nonlinear4       -0.004     0.029    -0.061     0.053    -0.151    96.431     0.880     0.440     0.319 
## birth_order_nonlinear5       -0.026     0.057    -0.138     0.086    -0.462    30.051     0.647     1.209     0.575 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.016    -0.000    -1.975    32.229     0.057     1.121     0.555 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.569    43.044     0.124     0.843     0.481 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.423    51.495     0.674     0.718     0.439 
## male                          0.036     0.016     0.005     0.066     2.292    39.649     0.027     0.910     0.501 
## sibling_count3                0.010     0.023    -0.034     0.055     0.456    41.217     0.651     0.877     0.491 
## sibling_count4               -0.011     0.024    -0.058     0.035    -0.481   183.213     0.631     0.285     0.230 
## sibling_count5               -0.049     0.034    -0.114     0.017    -1.448    58.658     0.153     0.644     0.411 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.689 
## ICC|mother_pidlink                     0.231 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-14" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-3" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-15" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.313     0.038     0.239     0.388     8.229    26.973     0.000     1.368     0.606 
## count_birth_order2/2          0.014     0.027    -0.039     0.066     0.506    30.276     0.617     1.199     0.573 
## count_birth_order1/3          0.014     0.034    -0.052     0.080     0.415    35.734     0.681     1.007     0.528 
## count_birth_order2/3          0.001     0.034    -0.065     0.067     0.029    28.220     0.977     1.297     0.593 
## count_birth_order3/3          0.031     0.029    -0.026     0.088     1.050    74.463     0.297     0.533     0.365 
## count_birth_order1/4         -0.011     0.035    -0.079     0.057    -0.317   405.031     0.751     0.175     0.153 
## count_birth_order2/4          0.000     0.040    -0.079     0.079     0.006    39.471     0.995     0.914     0.502 
## count_birth_order3/4         -0.027     0.042    -0.109     0.055    -0.640    34.767     0.526     1.036     0.535 
## count_birth_order4/4          0.001     0.039    -0.076     0.078     0.024    55.217     0.981     0.677     0.424 
## count_birth_order1/5         -0.033     0.055    -0.141     0.075    -0.594    61.882     0.555     0.616     0.400 
## count_birth_order2/5         -0.044     0.054    -0.149     0.062    -0.814    46.543     0.420     0.785     0.462 
## count_birth_order3/5         -0.033     0.047    -0.125     0.059    -0.701    83.337     0.485     0.489     0.344 
## count_birth_order4/5         -0.071     0.064    -0.195     0.054    -1.113    22.194     0.278     1.753     0.666 
## count_birth_order5/5         -0.077     0.055    -0.185     0.031    -1.402    42.066     0.168     0.861     0.486 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.002    -1.584    32.847     0.123     1.098     0.550 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.812    44.712     0.077     0.814     0.472 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.204    52.650     0.840     0.705     0.435 
## male                          0.034     0.015     0.003     0.064     2.186    43.228     0.034     0.839     0.480 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-15" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-3" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.389       6  54.410   0.883 235.528 
##  2 vs 3:   0.399       3  27.087   0.755 491.222 
##  3 vs 4:   0.390       1   9.046   0.548 169.825</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-1" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2015-old" class="section level3 tabset">
<h3>Numeracy 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-2" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-4" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-16" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.303     0.029     0.245     0.360    10.325    41.090     0.000     0.880     0.492 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.013     0.001    -1.619   208.437     0.107     0.262     0.215 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.769   323.611     0.442     0.200     0.172 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.419   215.669     0.676     0.257     0.212 
## male                         -0.082     0.019    -0.119    -0.045    -4.369    31.195     0.000     1.160     0.564 
## sibling_count3                0.003     0.023    -0.041     0.048     0.152    70.643     0.880     0.555     0.374 
## sibling_count4               -0.033     0.024    -0.080     0.013    -1.396   173.635     0.164     0.295     0.236 
## sibling_count5               -0.020     0.030    -0.079     0.040    -0.650    59.702     0.518     0.635     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.800 
## ICC|mother_pidlink                     0.177 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-16" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-4" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-17" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.293     0.043     0.209     0.377     6.860    25.392     0.000     1.471     0.624 
## birth_order                   0.004     0.011    -0.017     0.025     0.369    27.257     0.715     1.351     0.603 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.012     0.002    -1.436   229.900     0.152     0.247     0.205 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.868   513.930     0.386     0.153     0.136 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.342   276.148     0.733     0.220     0.186 
## male                         -0.082     0.019    -0.119    -0.046    -4.399    31.783     0.000     1.137     0.559 
## sibling_count3                0.001     0.023    -0.044     0.046     0.041    87.634     0.967     0.472     0.335 
## sibling_count4               -0.038     0.026    -0.090     0.013    -1.470   160.928     0.144     0.310     0.246 
## sibling_count5               -0.028     0.036    -0.099     0.044    -0.755    47.251     0.454     0.774     0.459 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.800 
## ICC|mother_pidlink                     0.177 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-17" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-4" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-18" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.305     0.037     0.232     0.377     8.211    30.174     0.000     1.203     0.574 
## birth_order_nonlinear2       -0.007     0.025    -0.056     0.041    -0.302    22.892     0.765     1.681     0.656 
## birth_order_nonlinear3        0.006     0.025    -0.044     0.055     0.220    62.581     0.826     0.611     0.398 
## birth_order_nonlinear4        0.000     0.039    -0.076     0.077     0.013    32.501     0.990     1.111     0.553 
## birth_order_nonlinear5        0.040     0.058    -0.073     0.153     0.691    30.374     0.495     1.195     0.572 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.013     0.002    -1.535   281.530     0.126     0.218     0.185 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.757   461.139     0.450     0.162     0.143 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.433   229.058     0.665     0.247     0.205 
## male                         -0.082     0.019    -0.119    -0.046    -4.398    31.733     0.000     1.139     0.559 
## sibling_count3               -0.000     0.024    -0.047     0.047    -0.013    85.311     0.989     0.481     0.340 
## sibling_count4               -0.038     0.026    -0.089     0.013    -1.448   280.807     0.149     0.218     0.185 
## sibling_count5               -0.034     0.037    -0.107     0.039    -0.923    47.774     0.360     0.767     0.456 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.800 
## ICC|mother_pidlink                     0.177 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-18" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-4" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-19" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.294     0.039     0.218     0.370     7.588    36.035     0.000     0.999     0.525 
## count_birth_order2/2          0.010     0.027    -0.043     0.063     0.354    64.394     0.725     0.597     0.392 
## count_birth_order1/3          0.026     0.038    -0.048     0.100     0.702    36.614     0.487     0.983     0.521 
## count_birth_order2/3         -0.015     0.038    -0.089     0.059    -0.395    36.680     0.695     0.982     0.521 
## count_birth_order3/3          0.012     0.032    -0.051     0.074     0.364    84.320     0.717     0.485     0.342 
## count_birth_order1/4         -0.025     0.036    -0.095     0.045    -0.693   722.083     0.488     0.126     0.114 
## count_birth_order2/4         -0.035     0.040    -0.113     0.043    -0.885   124.104     0.378     0.369     0.281 
## count_birth_order3/4         -0.034     0.044    -0.120     0.051    -0.789    46.448     0.434     0.786     0.463 
## count_birth_order4/4         -0.024     0.040    -0.102     0.054    -0.602    62.262     0.550     0.613     0.399 
## count_birth_order1/5         -0.044     0.052    -0.145     0.057    -0.854    83.429     0.396     0.489     0.344 
## count_birth_order2/5         -0.037     0.051    -0.137     0.064    -0.715    97.426     0.477     0.437     0.318 
## count_birth_order3/5          0.007     0.047    -0.084     0.098     0.144   164.578     0.886     0.305     0.243 
## count_birth_order4/5         -0.033     0.052    -0.135     0.069    -0.642    54.764     0.523     0.682     0.426 
## count_birth_order5/5          0.014     0.049    -0.081     0.110     0.291    51.714     0.772     0.716     0.438 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.002    -1.374   228.528     0.171     0.248     0.205 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.834   442.185     0.405     0.166     0.147 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.344   233.547     0.731     0.244     0.203 
## male                         -0.082     0.019    -0.119    -0.046    -4.420    32.321     0.000     1.117     0.554 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.800 
## ICC|mother_pidlink                     0.177 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-19" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-4" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.454       6 132.469   0.841   1.597 
##  2 vs 3:   0.325       3  42.494   0.807   3.153 
##  3 vs 4:   0.360       1  10.999   0.561   4.247</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-2" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-5" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-20" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.302     0.024     0.254     0.350    12.351    90.525     0.000     0.461     0.330 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.000    -1.976    37.443     0.056     0.962     0.515 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.416    33.326     0.680     1.082     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.671    33.994     0.507     1.060     0.541 
## male                         -0.080     0.017    -0.114    -0.046    -4.678    31.546     0.000     1.147     0.561 
## sibling_count3                0.007     0.020    -0.032     0.046     0.337    68.481     0.737     0.569     0.380 
## sibling_count4               -0.030     0.022    -0.074     0.013    -1.370   154.346     0.173     0.318     0.251 
## sibling_count5               -0.091     0.026    -0.143    -0.039    -3.456   189.403     0.001     0.279     0.226 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.175 
## Residual~~Residual                     0.792 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-20" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-5" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-21" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.287     0.035     0.219     0.356     8.196    35.385     0.000     1.017     0.530 
## birth_order                   0.007     0.010    -0.013     0.026     0.659    25.932     0.516     1.434     0.618 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.789    36.663     0.082     0.982     0.521 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.505    33.099     0.617     1.090     0.548 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.599    33.545     0.553     1.075     0.544 
## male                         -0.080     0.017    -0.114    -0.046    -4.610    30.195     0.000     1.202     0.573 
## sibling_count3                0.003     0.020    -0.036     0.041     0.130    91.017     0.897     0.459     0.329 
## sibling_count4               -0.038     0.027    -0.091     0.014    -1.446    60.427     0.153     0.628     0.405 
## sibling_count5               -0.100     0.034    -0.166    -0.034    -2.969    54.371     0.004     0.686     0.428 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.174 
## Residual~~Residual                     0.793 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-21" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-5" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-22" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.304     0.032     0.242     0.366     9.612    43.916     0.000     0.827     0.476 
## birth_order_nonlinear2       -0.004     0.023    -0.049     0.041    -0.189    22.565     0.852     1.714     0.660 
## birth_order_nonlinear3        0.008     0.026    -0.044     0.060     0.304    33.413     0.763     1.079     0.545 
## birth_order_nonlinear4        0.001     0.045    -0.086     0.089     0.025    20.243     0.981     2.001     0.695 
## birth_order_nonlinear5        0.004     0.057    -0.109     0.117     0.069    36.679     0.946     0.982     0.521 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.000    -1.989    46.021     0.053     0.793     0.465 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.348    43.396     0.729     0.836     0.479 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.800    44.017     0.428     0.825     0.475 
## male                         -0.079     0.018    -0.114    -0.045    -4.488    29.842     0.000     1.218     0.577 
## sibling_count3                0.001     0.021    -0.039     0.041     0.050    87.809     0.960     0.471     0.335 
## sibling_count4               -0.038     0.027    -0.091     0.016    -1.375    62.513     0.174     0.611     0.398 
## sibling_count5               -0.096     0.033    -0.162    -0.031    -2.873    71.271     0.005     0.551     0.373 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.174 
## Residual~~Residual                     0.795 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-22" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-5" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-23" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.287     0.035     0.219     0.355     8.294    44.062     0.000     0.825     0.475 
## count_birth_order2/2          0.015     0.029    -0.041     0.072     0.538    29.771     0.594     1.221     0.577 
## count_birth_order1/3          0.016     0.032    -0.046     0.078     0.520    59.724     0.605     0.634     0.408 
## count_birth_order2/3         -0.009     0.035    -0.078     0.061    -0.241    27.308     0.811     1.348     0.602 
## count_birth_order3/3          0.025     0.034    -0.042     0.092     0.725    37.575     0.473     0.959     0.515 
## count_birth_order1/4         -0.032     0.046    -0.121     0.058    -0.693    43.713     0.492     0.831     0.477 
## count_birth_order2/4         -0.043     0.040    -0.121     0.036    -1.066    52.031     0.291     0.712     0.437 
## count_birth_order3/4         -0.031     0.034    -0.098     0.036    -0.904   232.386     0.367     0.245     0.204 
## count_birth_order4/4         -0.011     0.047    -0.103     0.081    -0.243    30.376     0.810     1.195     0.572 
## count_birth_order1/5         -0.073     0.049    -0.170     0.024    -1.482   404.768     0.139     0.175     0.153 
## count_birth_order2/5         -0.111     0.050    -0.208    -0.014    -2.235   115.763     0.027     0.387     0.291 
## count_birth_order3/5         -0.078     0.052    -0.180     0.023    -1.514    58.587     0.135     0.645     0.412 
## count_birth_order4/5         -0.105     0.054    -0.210     0.000    -1.955    46.233     0.057     0.790     0.464 
## count_birth_order5/5         -0.074     0.055    -0.181     0.034    -1.344    54.768     0.185     0.682     0.426 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.013     0.001    -1.643    68.116     0.105     0.571     0.381 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.686    63.745     0.495     0.602     0.394 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.588    65.378     0.558     0.590     0.389 
## male                         -0.081     0.018    -0.116    -0.045    -4.452    28.359     0.000     1.290     0.591 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.174 
## Residual~~Residual                     0.794 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-23" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-5" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.419       6  54.410   0.863 235.288 
##  2 vs 3:   0.370       3  27.087   0.775 491.626 
##  3 vs 4:   0.332       1   9.046   0.579 170.750</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-2" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
</div>
<div id="counting-backwards" class="section level3 tabset">
<h3>Counting Backwards</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = count_backwards)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-3" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-6" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-24" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.100     0.029     0.043     0.157     3.440    42.407     0.001     0.854     0.484 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.004     0.010     0.772   110.683     0.442     0.399     0.298 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.747   261.658     0.082     0.228     0.192 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.040   194.730     0.300     0.274     0.223 
## male                         -0.008     0.015    -0.038     0.022    -0.514   111.243     0.608     0.397     0.297 
## sibling_count3               -0.009     0.021    -0.051     0.032    -0.437   124.344     0.663     0.368     0.281 
## sibling_count4               -0.003     0.025    -0.052     0.046    -0.122    96.188     0.903     0.441     0.320 
## sibling_count5               -0.009     0.025    -0.058     0.040    -0.378   712.294     0.706     0.127     0.115 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.156 
## Residual~~Residual                     0.820 
## ICC|mother_pidlink                     0.160 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-24" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-6" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-25" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.133     0.034     0.067     0.200     3.922    70.349     0.000     0.557     0.375 
## birth_order                  -0.014     0.009    -0.032     0.004    -1.521    56.813     0.134     0.661     0.418 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.006     0.009     0.303   102.049     0.762     0.422     0.310 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.365   210.830     0.174     0.260     0.214 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.753   176.609     0.453     0.292     0.234 
## male                         -0.007     0.015    -0.037     0.022    -0.489   109.270     0.626     0.403     0.300 
## sibling_count3               -0.000     0.023    -0.046     0.045    -0.019    79.134     0.985     0.509     0.353 
## sibling_count4                0.015     0.028    -0.041     0.071     0.525    69.640     0.601     0.561     0.377 
## sibling_count5                0.017     0.030    -0.042     0.076     0.569   251.127     0.570     0.234     0.196 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.156 
## Residual~~Residual                     0.819 
## ICC|mother_pidlink                     0.160 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-25" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-6" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-26" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.116     0.031     0.056     0.177     3.760    75.568     0.000     0.527     0.362 
## birth_order_nonlinear2       -0.009     0.021    -0.049     0.032    -0.416    45.442     0.679     0.802     0.468 
## birth_order_nonlinear3       -0.033     0.029    -0.090     0.024    -1.142    32.118     0.262     1.125     0.556 
## birth_order_nonlinear4       -0.040     0.037    -0.112     0.032    -1.077    43.044     0.287     0.843     0.481 
## birth_order_nonlinear5       -0.051     0.050    -0.149     0.048    -1.013    59.918     0.315     0.633     0.407 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.006     0.009     0.317   101.787     0.752     0.423     0.311 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.365   197.294     0.174     0.272     0.221 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.760   168.215     0.448     0.301     0.240 
## male                         -0.008     0.015    -0.037     0.022    -0.494   108.039     0.622     0.406     0.301 
## sibling_count3                0.003     0.024    -0.045     0.051     0.107    68.628     0.915     0.568     0.380 
## sibling_count4                0.017     0.028    -0.038     0.072     0.606    93.819     0.546     0.449     0.324 
## sibling_count5                0.018     0.031    -0.043     0.079     0.589   227.850     0.556     0.248     0.206 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.156 
## Residual~~Residual                     0.819 
## ICC|mother_pidlink                     0.160 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-26" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-6" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-27" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.107     0.034     0.042     0.173     3.203    82.174     0.002     0.495     0.347 
## count_birth_order2/2          0.001     0.030    -0.057     0.060     0.044    38.709     0.965     0.931     0.507 
## count_birth_order1/3          0.010     0.031    -0.051     0.072     0.325   126.097     0.745     0.365     0.279 
## count_birth_order2/3         -0.011     0.031    -0.072     0.049    -0.369   150.631     0.713     0.324     0.254 
## count_birth_order3/3         -0.020     0.036    -0.090     0.051    -0.549    41.892     0.586     0.864     0.487 
## count_birth_order1/4          0.042     0.042    -0.041     0.125     0.991    69.948     0.325     0.559     0.376 
## count_birth_order2/4          0.000     0.043    -0.084     0.085     0.009    64.441     0.993     0.597     0.392 
## count_birth_order3/4         -0.030     0.040    -0.109     0.049    -0.741    78.630     0.461     0.511     0.355 
## count_birth_order4/4         -0.009     0.041    -0.088     0.071    -0.211    57.891     0.833     0.651     0.414 
## count_birth_order1/5          0.002     0.048    -0.092     0.095     0.033   194.490     0.974     0.274     0.223 
## count_birth_order2/5          0.043     0.056    -0.068     0.153     0.759    52.175     0.451     0.710     0.437 
## count_birth_order3/5         -0.000     0.047    -0.092     0.092    -0.006   150.711     0.995     0.323     0.254 
## count_birth_order4/5         -0.034     0.051    -0.133     0.066    -0.660    65.569     0.511     0.589     0.389 
## count_birth_order5/5         -0.028     0.043    -0.113     0.058    -0.634   130.281     0.527     0.357     0.274 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.477    85.176     0.635     0.482     0.340 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.465   137.271     0.145     0.344     0.267 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.878   134.709     0.381     0.349     0.269 
## male                         -0.008     0.015    -0.038     0.022    -0.504   104.158     0.615     0.416     0.307 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.156 
## Residual~~Residual                     0.819 
## ICC|mother_pidlink                     0.160 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-27" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-6" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.323       6 124.333   0.924   1.747 
##  2 vs 3:   0.230       3  41.934   0.875   3.257 
##  3 vs 4:   1.020       1  11.407   0.333   3.583</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-3" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-7" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-28" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.090     0.032     0.027     0.153     2.811    25.318     0.009     1.477     0.625 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.005     0.010     0.644    39.301     0.524     0.918     0.503 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.954   100.854     0.053     0.426     0.312 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.483   194.598     0.140     0.274     0.223 
## male                         -0.001     0.014    -0.029     0.027    -0.071    92.131     0.944     0.455     0.327 
## sibling_count3                0.003     0.022    -0.041     0.046     0.122    38.434     0.903     0.938     0.509 
## sibling_count4               -0.018     0.022    -0.061     0.025    -0.814   163.986     0.417     0.306     0.243 
## sibling_count5               -0.054     0.033    -0.120     0.011    -1.633    34.238     0.112     1.052     0.539 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.162 
## Residual~~Residual                     0.818 
## ICC|mother_pidlink                     0.165 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-28" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-7" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-29" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.110     0.034     0.043     0.178     3.201    38.866     0.003     0.928     0.506 
## birth_order                  -0.009     0.008    -0.025     0.007    -1.082    53.695     0.284     0.693     0.430 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.009     0.462    40.887     0.646     0.884     0.493 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.831   100.285     0.070     0.428     0.313 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.396   185.019     0.164     0.283     0.229 
## male                         -0.001     0.014    -0.029     0.027    -0.067    91.121     0.947     0.458     0.329 
## sibling_count3                0.008     0.022    -0.036     0.052     0.374    41.861     0.710     0.865     0.488 
## sibling_count4               -0.006     0.025    -0.055     0.043    -0.254    97.700     0.800     0.436     0.317 
## sibling_count5               -0.039     0.035    -0.108     0.030    -1.111    43.924     0.273     0.827     0.476 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.162 
## Residual~~Residual                     0.818 
## ICC|mother_pidlink                     0.165 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-29" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-7" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-30" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.112     0.033     0.047     0.177     3.371    36.008     0.002     1.000     0.526 
## birth_order_nonlinear2       -0.020     0.019    -0.057     0.017    -1.081    46.982     0.285     0.778     0.460 
## birth_order_nonlinear3       -0.042     0.022    -0.085     0.001    -1.902   100.030     0.060     0.428     0.314 
## birth_order_nonlinear4       -0.026     0.033    -0.091     0.039    -0.789    61.386     0.433     0.620     0.402 
## birth_order_nonlinear5       -0.035     0.060    -0.153     0.082    -0.589    32.594     0.560     1.107     0.552 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.009     0.294    41.154     0.770     0.878     0.492 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.558    80.081     0.123     0.504     0.351 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.143   126.412     0.255     0.364     0.278 
## male                         -0.001     0.014    -0.029     0.027    -0.081   113.766     0.936     0.391     0.294 
## sibling_count3                0.013     0.023    -0.032     0.059     0.583    43.080     0.563     0.842     0.481 
## sibling_count4               -0.004     0.025    -0.054     0.045    -0.171   118.296     0.865     0.381     0.288 
## sibling_count5               -0.036     0.036    -0.106     0.035    -0.992    45.928     0.327     0.794     0.465 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.161 
## Residual~~Residual                     0.818 
## ICC|mother_pidlink                     0.165 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-30" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-7" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-31" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.096     0.035     0.026     0.165     2.708    40.238     0.010     0.897     0.497 
## count_birth_order2/2         -0.002     0.030    -0.061     0.057    -0.064    26.553     0.949     1.393     0.610 
## count_birth_order1/3          0.025     0.031    -0.035     0.086     0.819    71.748     0.416     0.548     0.371 
## count_birth_order2/3         -0.014     0.028    -0.069     0.041    -0.495    89.452     0.622     0.465     0.332 
## count_birth_order3/3         -0.008     0.034    -0.075     0.058    -0.246    40.084     0.807     0.901     0.498 
## count_birth_order1/4          0.011     0.052    -0.091     0.113     0.210    26.889     0.835     1.373     0.607 
## count_birth_order2/4         -0.014     0.038    -0.087     0.060    -0.362    81.508     0.719     0.498     0.348 
## count_birth_order3/4         -0.046     0.040    -0.124     0.032    -1.152    58.001     0.254     0.650     0.414 
## count_birth_order4/4         -0.029     0.035    -0.097     0.039    -0.832   390.418     0.406     0.179     0.156 
## count_birth_order1/5         -0.007     0.066    -0.135     0.122    -0.103    34.832     0.918     1.034     0.534 
## count_birth_order2/5         -0.064     0.053    -0.167     0.039    -1.225    74.247     0.224     0.534     0.365 
## count_birth_order3/5         -0.088     0.046    -0.178     0.002    -1.923   193.062     0.056     0.275     0.224 
## count_birth_order4/5         -0.046     0.057    -0.157     0.065    -0.808    36.910     0.424     0.976     0.519 
## count_birth_order5/5         -0.063     0.059    -0.179     0.053    -1.061    38.989     0.295     0.925     0.505 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.588    40.931     0.560     0.883     0.493 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.711    59.415     0.092     0.637     0.409 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.273    80.560     0.207     0.502     0.350 
## male                         -0.003     0.014    -0.031     0.026    -0.191   103.452     0.849     0.418     0.308 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.161 
## Residual~~Residual                     0.817 
## ICC|mother_pidlink                     0.165 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-31" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-7" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.434       6  54.410   0.853 235.305 
##  2 vs 3:   0.433       3  27.087   0.731 491.311 
##  3 vs 4:   0.428       1   9.046   0.529 169.927</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-3" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
</div>
</div>
<div id="delayed-word-recall" class="section level3 tabset">
<h3>Delayed Word Recall</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = words_delayed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-4" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-8" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-32" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.518     0.037     0.446     0.589    14.155    18.548     0.000     2.296     0.725 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.033    -0.017    -6.134    42.163     0.000     0.859     0.486 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.372    80.973     0.174     0.500     0.349 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.504   135.321     0.013     0.348     0.269 
## male                         -0.037     0.014    -0.065    -0.009    -2.560   116.911     0.012     0.384     0.290 
## sibling_count3                0.008     0.021    -0.033     0.049     0.380    71.692     0.705     0.549     0.372 
## sibling_count4                0.010     0.024    -0.037     0.057     0.426    71.562     0.671     0.550     0.372 
## sibling_count5               -0.004     0.025    -0.052     0.045    -0.142   161.887     0.887     0.309     0.245 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.760 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-32" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-8" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-33" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.518     0.041     0.438     0.598    12.754    24.928     0.000     1.505     0.629 
## birth_order                  -0.000     0.010    -0.020     0.019    -0.009    32.255     0.993     1.120     0.555 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.033    -0.016    -5.717    36.103     0.000     0.997     0.525 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.291    58.467     0.202     0.646     0.412 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.380    90.640     0.019     0.460     0.330 
## male                         -0.037     0.014    -0.065    -0.009    -2.556   114.609     0.012     0.389     0.292 
## sibling_count3                0.008     0.023    -0.036     0.052     0.358    56.022     0.722     0.669     0.421 
## sibling_count4                0.010     0.029    -0.047     0.067     0.355    40.930     0.724     0.883     0.493 
## sibling_count5               -0.003     0.035    -0.071     0.064    -0.099    41.892     0.921     0.864     0.487 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.760 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-33" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-8" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-34" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.513     0.035     0.444     0.582    14.594    29.596     0.000     1.229     0.579 
## birth_order_nonlinear2        0.008     0.020    -0.032     0.048     0.385    38.927     0.702     0.926     0.506 
## birth_order_nonlinear3       -0.004     0.028    -0.058     0.051    -0.130    32.266     0.897     1.119     0.555 
## birth_order_nonlinear4       -0.008     0.038    -0.082     0.066    -0.209    32.624     0.836     1.106     0.552 
## birth_order_nonlinear5        0.016     0.047    -0.077     0.108     0.338    67.969     0.737     0.572     0.382 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.033    -0.016    -5.698    37.284     0.000     0.966     0.517 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.255    59.069     0.214     0.640     0.410 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.328    89.090     0.022     0.466     0.333 
## male                         -0.037     0.014    -0.065    -0.009    -2.574   118.744     0.011     0.380     0.287 
## sibling_count3                0.011     0.022    -0.033     0.055     0.487    78.003     0.627     0.514     0.356 
## sibling_count4                0.016     0.030    -0.043     0.074     0.523    42.248     0.604     0.857     0.485 
## sibling_count5               -0.003     0.035    -0.071     0.066    -0.073    45.018     0.942     0.809     0.470 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-34" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-8" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-35" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.515     0.035     0.447     0.584    14.664    42.713     0.000     0.849     0.483 
## count_birth_order2/2          0.005     0.031    -0.055     0.065     0.159    30.861     0.874     1.174     0.567 
## count_birth_order1/3          0.015     0.035    -0.053     0.083     0.430    41.928     0.669     0.863     0.487 
## count_birth_order2/3          0.007     0.028    -0.048     0.062     0.238   277.806     0.812     0.219     0.186 
## count_birth_order3/3          0.010     0.030    -0.048     0.068     0.347   103.855     0.730     0.417     0.308 
## count_birth_order1/4          0.011     0.042    -0.072     0.095     0.271    49.650     0.787     0.741     0.448 
## count_birth_order2/4          0.044     0.039    -0.032     0.119     1.136    98.013     0.259     0.435     0.317 
## count_birth_order3/4         -0.003     0.034    -0.071     0.064    -0.101   237.294     0.920     0.242     0.201 
## count_birth_order4/4          0.004     0.037    -0.068     0.075     0.096    82.071     0.924     0.495     0.347 
## count_birth_order1/5         -0.026     0.047    -0.118     0.066    -0.550   125.357     0.583     0.366     0.279 
## count_birth_order2/5          0.011     0.048    -0.084     0.106     0.231   105.792     0.817     0.412     0.305 
## count_birth_order3/5          0.001     0.048    -0.092     0.095     0.022    76.918     0.983     0.520     0.359 
## count_birth_order4/5         -0.007     0.039    -0.084     0.070    -0.177  2457.792     0.860     0.064     0.061 
## count_birth_order5/5          0.012     0.041    -0.068     0.092     0.292   132.414     0.771     0.353     0.272 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.033    -0.016    -5.649    39.681     0.000     0.909     0.501 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.235    55.913     0.222     0.670     0.422 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.272    78.798     0.026     0.510     0.354 
## male                         -0.037     0.014    -0.065    -0.009    -2.582   122.117     0.011     0.373     0.283 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-35" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-8" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.259       6 128.396   0.955   1.668 
##  2 vs 3:   0.342       3  42.179   0.795   3.211 
##  3 vs 4:   0.307       1  11.109   0.591   4.042</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-4" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-9" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-36" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.519     0.034     0.452     0.586    15.231    19.098     0.000     2.190     0.715 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.033    -0.017    -6.001    24.729     0.000     1.521     0.632 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.123    26.438     0.271     1.401     0.612 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.090    26.427     0.046     1.401     0.612 
## male                         -0.046     0.013    -0.070    -0.021    -3.628   213.737     0.000     0.258     0.213 
## sibling_count3                0.025     0.018    -0.010     0.060     1.412    95.558     0.161     0.443     0.321 
## sibling_count4               -0.002     0.024    -0.049     0.044    -0.098    49.195     0.922     0.747     0.450 
## sibling_count5               -0.025     0.027    -0.077     0.027    -0.936    73.070     0.352     0.541     0.368 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.755 
## ICC|mother_pidlink                     0.129 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-36" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-9" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-37" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.506     0.039     0.429     0.583    12.857    21.271     0.000     1.861     0.679 
## birth_order                   0.006     0.008    -0.010     0.023     0.743    40.253     0.462     0.897     0.497 
## poly(age, 3, raw = TRUE)1    -0.024     0.004    -0.033    -0.016    -5.851    25.111     0.000     1.492     0.627 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.063    26.632     0.297     1.389     0.610 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.048    26.393     0.051     1.404     0.612 
## male                         -0.045     0.013    -0.070    -0.021    -3.580   183.071     0.000     0.285     0.230 
## sibling_count3                0.021     0.018    -0.013     0.056     1.216   160.425     0.226     0.310     0.246 
## sibling_count4               -0.010     0.027    -0.062     0.043    -0.367    39.874     0.716     0.905     0.500 
## sibling_count5               -0.034     0.032    -0.097     0.029    -1.068    46.387     0.291     0.787     0.463 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.755 
## ICC|mother_pidlink                     0.129 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-37" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-9" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-38" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.517     0.034     0.450     0.585    15.000    25.611     0.000     1.456     0.621 
## birth_order_nonlinear2        0.004     0.018    -0.031     0.038     0.223    51.990     0.825     0.713     0.437 
## birth_order_nonlinear3        0.006     0.024    -0.042     0.053     0.233    40.821     0.817     0.885     0.494 
## birth_order_nonlinear4        0.000     0.033    -0.064     0.065     0.005    48.699     0.996     0.754     0.452 
## birth_order_nonlinear5        0.027     0.045    -0.062     0.116     0.589   140.578     0.557     0.339     0.263 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.034    -0.016    -5.713    23.544     0.000     1.620     0.647 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.158    24.620     0.258     1.529     0.633 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.100    24.758     0.046     1.518     0.632 
## male                         -0.047     0.013    -0.073    -0.022    -3.614   141.165     0.000     0.338     0.263 
## sibling_count3                0.022     0.018    -0.013     0.057     1.226   175.001     0.222     0.293     0.235 
## sibling_count4               -0.006     0.026    -0.058     0.045    -0.240    49.100     0.812     0.749     0.450 
## sibling_count5               -0.030     0.030    -0.089     0.030    -0.975    82.372     0.333     0.494     0.346 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.111 
## Residual~~Residual                     0.755 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-38" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-9" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-39" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.520     0.034     0.454     0.587    15.346    36.636     0.000     0.983     0.521 
## count_birth_order2/2          0.000     0.031    -0.061     0.061     0.001    22.015     0.999     1.773     0.668 
## count_birth_order1/3          0.018     0.035    -0.050     0.086     0.530    30.701     0.600     1.181     0.569 
## count_birth_order2/3          0.024     0.026    -0.027     0.075     0.912   108.096     0.364     0.406     0.301 
## count_birth_order3/3          0.029     0.030    -0.031     0.088     0.947    55.931     0.348     0.670     0.421 
## count_birth_order1/4          0.001     0.048    -0.093     0.096     0.030    28.432     0.976     1.286     0.590 
## count_birth_order2/4          0.005     0.034    -0.063     0.072     0.133   103.343     0.894     0.419     0.308 
## count_birth_order3/4         -0.011     0.038    -0.085     0.063    -0.292    55.158     0.771     0.678     0.424 
## count_birth_order4/4         -0.008     0.035    -0.076     0.059    -0.245   151.303     0.807     0.323     0.254 
## count_birth_order1/5         -0.056     0.049    -0.153     0.041    -1.137   187.040     0.257     0.281     0.228 
## count_birth_order2/5         -0.026     0.047    -0.117     0.066    -0.552   131.479     0.582     0.354     0.273 
## count_birth_order3/5         -0.016     0.047    -0.108     0.077    -0.329    78.774     0.743     0.511     0.354 
## count_birth_order4/5         -0.036     0.054    -0.142     0.070    -0.666    35.141     0.510     1.025     0.532 
## count_birth_order5/5          0.008     0.052    -0.094     0.111     0.159    53.432     0.874     0.696     0.431 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.033    -0.016    -5.763    26.224     0.000     1.414     0.614 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.153    26.866     0.259     1.374     0.607 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.084    26.470     0.047     1.399     0.611 
## male                         -0.048     0.014    -0.075    -0.022    -3.552   113.377     0.001     0.392     0.294 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.111 
## Residual~~Residual                     0.755 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-39" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-9" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.364       6  54.409   0.899 235.637 
##  2 vs 3:   0.377       3  27.087   0.770 491.113 
##  3 vs 4:   0.419       1   9.046   0.533 169.944</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-4" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
</div>
</div>
<div id="adaptive-numbering" class="section level3 tabset">
<h3>Adaptive Numbering</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = adaptive_numbering)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-5" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-10" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-40" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.291     0.041     0.211     0.371     7.151    16.504     0.000     2.824     0.765 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.023    -0.004    -2.799    25.841     0.010     1.440     0.619 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.589    43.735     0.119     0.830     0.477 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.018    51.983     0.004     0.713     0.437 
## male                          0.002     0.015    -0.028     0.031     0.107   112.888     0.915     0.393     0.295 
## sibling_count3                0.007     0.022    -0.037     0.050     0.296    59.178     0.768     0.639     0.410 
## sibling_count4               -0.022     0.026    -0.074     0.030    -0.827    44.577     0.413     0.816     0.472 
## sibling_count5               -0.014     0.025    -0.063     0.034    -0.568   210.733     0.571     0.260     0.214 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.091 
## Residual~~Residual                     0.847 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-40" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-10" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-41" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.285     0.049     0.190     0.380     5.861    18.247     0.000     2.359     0.730 
## birth_order                   0.003     0.009    -0.015     0.020     0.294    69.572     0.770     0.562     0.377 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.023    -0.003    -2.564    23.793     0.017     1.598     0.644 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.467    38.010     0.151     0.948     0.512 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.872    45.794     0.006     0.796     0.466 
## male                          0.002     0.015    -0.028     0.031     0.102   111.351     0.919     0.397     0.297 
## sibling_count3                0.005     0.023    -0.040     0.050     0.212    56.201     0.833     0.667     0.420 
## sibling_count4               -0.025     0.028    -0.080     0.029    -0.906    57.132     0.369     0.658     0.417 
## sibling_count5               -0.019     0.030    -0.078     0.039    -0.641   143.842     0.523     0.334     0.260 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.091 
## Residual~~Residual                     0.847 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-41" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-10" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-42" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.278     0.047     0.186     0.371     5.926    16.816     0.000     2.726     0.759 
## birth_order_nonlinear2        0.017     0.021    -0.025     0.059     0.802    39.151     0.427     0.921     0.504 
## birth_order_nonlinear3        0.012     0.024    -0.035     0.059     0.498    98.556     0.620     0.433     0.316 
## birth_order_nonlinear4       -0.002     0.038    -0.077     0.074    -0.041    36.521     0.968     0.986     0.522 
## birth_order_nonlinear5        0.012     0.049    -0.084     0.107     0.239    79.170     0.812     0.509     0.353 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.023    -0.003    -2.448    23.282     0.022     1.644     0.651 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.340    35.604     0.189     1.011     0.529 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.706    42.017     0.010     0.862     0.487 
## male                          0.001     0.015    -0.028     0.031     0.093   110.193     0.926     0.400     0.298 
## sibling_count3                0.005     0.025    -0.043     0.053     0.207    49.969     0.837     0.737     0.446 
## sibling_count4               -0.020     0.028    -0.075     0.034    -0.734    73.509     0.465     0.538     0.367 
## sibling_count5               -0.014     0.029    -0.072     0.043    -0.482   275.149     0.630     0.221     0.187 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.091 
## Residual~~Residual                     0.847 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-42" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-10" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-43" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.275     0.045     0.187     0.364     6.083    21.264     0.000     1.862     0.679 
## count_birth_order2/2          0.016     0.030    -0.044     0.075     0.524    38.562     0.603     0.935     0.508 
## count_birth_order1/3          0.002     0.032    -0.061     0.064     0.047    92.183     0.962     0.454     0.327 
## count_birth_order2/3          0.009     0.037    -0.064     0.082     0.248    35.914     0.805     1.002     0.526 
## count_birth_order3/3          0.029     0.031    -0.032     0.090     0.921    91.316     0.360     0.458     0.328 
## count_birth_order1/4         -0.029     0.036    -0.099     0.041    -0.817   598.110     0.415     0.140     0.126 
## count_birth_order2/4          0.000     0.043    -0.083     0.084     0.008    61.287     0.994     0.621     0.402 
## count_birth_order3/4         -0.022     0.045    -0.110     0.066    -0.494    38.392     0.624     0.939     0.509 
## count_birth_order4/4         -0.010     0.046    -0.101     0.081    -0.216    29.218     0.831     1.247     0.583 
## count_birth_order1/5         -0.005     0.044    -0.090     0.081    -0.110  1250.667     0.912     0.093     0.086 
## count_birth_order2/5          0.041     0.048    -0.052     0.134     0.865   217.412     0.388     0.255     0.211 
## count_birth_order3/5         -0.025     0.044    -0.112     0.062    -0.564   288.355     0.573     0.215     0.182 
## count_birth_order4/5         -0.041     0.052    -0.143     0.061    -0.782    51.383     0.438     0.720     0.440 
## count_birth_order5/5         -0.003     0.047    -0.096     0.089    -0.072    57.192     0.943     0.658     0.417 
## poly(age, 3, raw = TRUE)1    -0.012     0.005    -0.022    -0.002    -2.351    25.917     0.027     1.435     0.618 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.214    39.508     0.232     0.913     0.502 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.588    44.795     0.013     0.812     0.471 
## male                          0.002     0.015    -0.028     0.031     0.101   109.286     0.920     0.402     0.300 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.091 
## Residual~~Residual                     0.846 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-43" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-10" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.358       6 130.661   0.904   1.628 
##  2 vs 3:   0.223       3  42.209   0.880   3.205 
##  3 vs 4:   0.254       1  11.506   0.624   3.454</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-5" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-11" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-44" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.280     0.035     0.210     0.349     7.892    19.112     0.000     2.187     0.715 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.022    -0.005    -3.026    23.562     0.006     1.618     0.647 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.466    34.798     0.152     1.035     0.535 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.227    40.534     0.002     0.891     0.496 
## male                          0.010     0.014    -0.017     0.037     0.737   110.159     0.463     0.400     0.298 
## sibling_count3                0.012     0.022    -0.031     0.055     0.550    35.819     0.585     1.005     0.527 
## sibling_count4               -0.020     0.023    -0.066     0.025    -0.876    66.031     0.384     0.585     0.387 
## sibling_count5               -0.061     0.028    -0.116    -0.007    -2.202    64.435     0.031     0.597     0.392 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.099 
## Residual~~Residual                     0.846 
## ICC|mother_pidlink                     0.105 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-44" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-11" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-45" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.246     0.039     0.169     0.324     6.260    23.252     0.000     1.647     0.651 
## birth_order                   0.015     0.008    -0.001     0.031     1.894    66.788     0.063     0.580     0.385 
## poly(age, 3, raw = TRUE)1    -0.012     0.005    -0.021    -0.003    -2.718    23.113     0.012     1.660     0.653 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.287    33.612     0.207     1.072     0.544 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.092    39.773     0.004     0.907     0.500 
## male                          0.011     0.014    -0.016     0.038     0.765   121.538     0.446     0.374     0.284 
## sibling_count3                0.003     0.022    -0.040     0.045     0.119    41.420     0.906     0.873     0.490 
## sibling_count4               -0.039     0.022    -0.083     0.005    -1.728   215.247     0.085     0.257     0.212 
## sibling_count5               -0.086     0.031    -0.148    -0.024    -2.731    63.230     0.008     0.606     0.396 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.099 
## Residual~~Residual                     0.847 
## ICC|mother_pidlink                     0.105 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-45" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-11" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-46" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.272     0.039     0.196     0.349     6.962    20.767     0.000     1.927     0.687 
## birth_order_nonlinear2        0.007     0.019    -0.031     0.044     0.343    42.561     0.733     0.851     0.484 
## birth_order_nonlinear3        0.014     0.026    -0.037     0.065     0.540    37.523     0.592     0.960     0.515 
## birth_order_nonlinear4        0.028     0.040    -0.052     0.107     0.682    26.534     0.501     1.395     0.611 
## birth_order_nonlinear5        0.034     0.057    -0.078     0.146     0.593    39.189     0.557     0.920     0.504 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.022    -0.004    -2.815    23.709     0.010     1.605     0.645 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.420    33.296     0.165     1.083     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.200    39.896     0.003     0.905     0.499 
## male                          0.008     0.014    -0.019     0.036     0.590    99.657     0.556     0.430     0.314 
## sibling_count3                0.005     0.022    -0.038     0.048     0.246    45.831     0.807     0.796     0.466 
## sibling_count4               -0.033     0.024    -0.080     0.014    -1.375   128.006     0.172     0.361     0.276 
## sibling_count5               -0.076     0.034    -0.142    -0.010    -2.266    53.476     0.028     0.696     0.431 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.846 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-46" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-11" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-47" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.262     0.037     0.189     0.336     7.000    29.323     0.000     1.242     0.582 
## count_birth_order2/2          0.014     0.028    -0.041     0.069     0.487    33.779     0.629     1.067     0.542 
## count_birth_order1/3          0.001     0.038    -0.073     0.075     0.026    26.932     0.979     1.370     0.606 
## count_birth_order2/3          0.008     0.033    -0.057     0.073     0.231    33.181     0.819     1.087     0.547 
## count_birth_order3/3          0.035     0.040    -0.042     0.113     0.892    23.011     0.381     1.669     0.654 
## count_birth_order1/4         -0.040     0.042    -0.123     0.042    -0.961    67.323     0.340     0.576     0.384 
## count_birth_order2/4         -0.027     0.039    -0.104     0.051    -0.680    52.544     0.499     0.706     0.435 
## count_birth_order3/4         -0.033     0.043    -0.118     0.052    -0.766    35.059     0.449     1.027     0.533 
## count_birth_order4/4          0.015     0.049    -0.081     0.110     0.307    26.541     0.761     1.394     0.611 
## count_birth_order1/5         -0.053     0.052    -0.154     0.048    -1.024   182.212     0.307     0.286     0.231 
## count_birth_order2/5         -0.091     0.061    -0.211     0.029    -1.481    31.499     0.149     1.148     0.562 
## count_birth_order3/5         -0.065     0.048    -0.159     0.029    -1.352    97.098     0.180     0.438     0.318 
## count_birth_order4/5         -0.058     0.055    -0.166     0.049    -1.061    39.549     0.295     0.912     0.502 
## count_birth_order5/5         -0.035     0.059    -0.150     0.080    -0.592    37.629     0.557     0.957     0.514 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.020    -0.003    -2.594    28.596     0.015     1.278     0.589 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.204    41.910     0.235     0.864     0.487 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.078    47.994     0.003     0.764     0.455 
## male                          0.007     0.014    -0.021     0.035     0.482    98.080     0.631     0.435     0.317 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.847 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-47" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-11" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.415       6  54.410   0.866 235.296 
##  2 vs 3:   0.457       3  27.087   0.715 492.008 
##  3 vs 4:   0.373       1   9.046   0.556 169.690</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-5" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2015-young" class="section level3 tabset">
<h3>g-factor 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-6" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-12" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-48" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.540     0.042    -0.622    -0.459   -12.934    15.551     0.000     3.180     0.787 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.035     0.050    10.775    49.343     0.000     0.745     0.449 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.000    -3.393   138.243     0.001     0.343     0.266 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.551   236.322     0.122     0.242     0.202 
## male                         -0.075     0.019    -0.111    -0.038    -3.955    25.421     0.001     1.469     0.624 
## sibling_count3               -0.000     0.025    -0.049     0.048    -0.016    40.063     0.988     0.901     0.498 
## sibling_count4               -0.025     0.026    -0.076     0.025    -0.988    69.770     0.327     0.560     0.377 
## sibling_count5               -0.005     0.028    -0.061     0.051    -0.173    91.253     0.863     0.458     0.329 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-48" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-12" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-49" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.534     0.048    -0.627    -0.441   -11.238    18.272     0.000     2.354     0.730 
## birth_order                  -0.003     0.008    -0.017     0.012    -0.338   144.596     0.736     0.332     0.260 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.034     0.050    10.547    57.061     0.000     0.659     0.417 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.334   179.787     0.001     0.288     0.232 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.481   251.174     0.140     0.233     0.196 
## male                         -0.074     0.019    -0.111    -0.038    -3.957    25.537     0.001     1.461     0.622 
## sibling_count3                0.001     0.025    -0.047     0.050     0.051    45.640     0.960     0.799     0.467 
## sibling_count4               -0.022     0.028    -0.077     0.032    -0.798    73.419     0.427     0.539     0.367 
## sibling_count5                0.000     0.032    -0.062     0.062     0.001   105.508     0.999     0.413     0.305 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-49" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-12" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-50" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.540     0.046    -0.631    -0.450   -11.712    16.815     0.000     2.726     0.759 
## birth_order_nonlinear2        0.002     0.020    -0.036     0.041     0.118    36.956     0.907     0.974     0.519 
## birth_order_nonlinear3        0.002     0.025    -0.046     0.051     0.086    44.025     0.932     0.825     0.475 
## birth_order_nonlinear4       -0.025     0.029    -0.082     0.031    -0.881   135.925     0.380     0.346     0.268 
## birth_order_nonlinear5        0.005     0.040    -0.074     0.084     0.128   225.569     0.898     0.250     0.207 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.034     0.050    10.397    53.601     0.000     0.694     0.431 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.000    -3.349   173.270     0.001     0.295     0.237 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.510   218.612     0.133     0.255     0.210 
## male                         -0.075     0.019    -0.112    -0.037    -3.942    25.172     0.001     1.487     0.626 
## sibling_count3               -0.000     0.025    -0.049     0.048    -0.017    56.840     0.986     0.661     0.418 
## sibling_count4               -0.018     0.029    -0.074     0.038    -0.613    72.348     0.542     0.545     0.370 
## sibling_count5               -0.000     0.032    -0.062     0.062    -0.000   134.185     1.000     0.349     0.270 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-50" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-12" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-51" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.549     0.045    -0.636    -0.461   -12.326    20.950     0.000     1.902     0.684 
## count_birth_order2/2          0.010     0.027    -0.043     0.062     0.366    43.073     0.716     0.842     0.481 
## count_birth_order1/3          0.005     0.030    -0.054     0.063     0.154   117.531     0.878     0.383     0.289 
## count_birth_order2/3         -0.007     0.036    -0.077     0.063    -0.186    36.937     0.854     0.975     0.519 
## count_birth_order3/3          0.014     0.033    -0.050     0.078     0.420    51.483     0.676     0.719     0.439 
## count_birth_order1/4         -0.010     0.043    -0.095     0.074    -0.237    45.550     0.814     0.800     0.467 
## count_birth_order2/4         -0.002     0.035    -0.071     0.067    -0.054   314.500     0.957     0.204     0.174 
## count_birth_order3/4         -0.043     0.038    -0.118     0.032    -1.125    75.192     0.264     0.529     0.363 
## count_birth_order4/4         -0.024     0.033    -0.090     0.041    -0.733   237.848     0.464     0.242     0.201 
## count_birth_order1/5          0.004     0.054    -0.101     0.109     0.083    45.701     0.934     0.798     0.467 
## count_birth_order2/5          0.006     0.045    -0.082     0.094     0.133   271.979     0.894     0.222     0.188 
## count_birth_order3/5          0.030     0.048    -0.063     0.124     0.635    74.338     0.527     0.534     0.365 
## count_birth_order4/5         -0.051     0.047    -0.142     0.041    -1.088    78.544     0.280     0.512     0.355 
## count_birth_order5/5          0.009     0.042    -0.074     0.092     0.219    98.665     0.827     0.433     0.316 
## poly(age, 3, raw = TRUE)1     0.043     0.004     0.035     0.051    10.544    61.996     0.000     0.616     0.400 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.000    -3.503   184.920     0.001     0.283     0.229 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.695   276.656     0.091     0.220     0.186 
## male                         -0.075     0.019    -0.112    -0.037    -3.942    25.212     0.001     1.484     0.626 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-51" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-12" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.399       6 130.458   0.879   1.631 
##  2 vs 3:   0.328       3  42.732   0.805   3.110 
##  3 vs 4:   0.177       1  11.680   0.682   3.250</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-6" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-13" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-52" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.547     0.036    -0.616    -0.477   -15.367    18.324     0.000     2.342     0.729 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.035     0.049    11.351    37.882     0.000     0.951     0.512 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.580    42.407     0.001     0.854     0.484 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.923    46.121     0.061     0.791     0.464 
## male                         -0.070     0.017    -0.103    -0.038    -4.246    28.565     0.000     1.279     0.589 
## sibling_count3                0.004     0.021    -0.037     0.044     0.172    47.944     0.864     0.764     0.456 
## sibling_count4               -0.033     0.026    -0.085     0.019    -1.255    38.186     0.217     0.944     0.510 
## sibling_count5               -0.097     0.036    -0.167    -0.027    -2.710    26.257     0.012     1.412     0.614 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.214 
## Residual~~Residual                     0.673 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-52" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-13" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-53" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.546     0.038    -0.620    -0.471   -14.331    24.106     0.000     1.571     0.640 
## birth_order                  -0.001     0.007    -0.015     0.014    -0.075    67.257     0.940     0.577     0.384 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.035     0.049    11.400    41.507     0.000     0.871     0.490 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.565    42.539     0.001     0.852     0.484 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.911    45.107     0.062     0.807     0.470 
## male                         -0.070     0.017    -0.104    -0.037    -4.173    27.229     0.000     1.353     0.603 
## sibling_count3                0.004     0.021    -0.038     0.045     0.184    49.266     0.855     0.746     0.449 
## sibling_count4               -0.032     0.029    -0.088     0.024    -1.120    36.434     0.270     0.988     0.523 
## sibling_count5               -0.094     0.038    -0.168    -0.021    -2.505    29.913     0.018     1.215     0.576 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.214 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-53" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-13" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-54" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.542     0.040    -0.621    -0.463   -13.450    18.986     0.000     2.210     0.717 
## birth_order_nonlinear2       -0.002     0.018    -0.038     0.033    -0.123    38.693     0.903     0.932     0.507 
## birth_order_nonlinear3       -0.008     0.024    -0.056     0.039    -0.351    36.551     0.728     0.985     0.522 
## birth_order_nonlinear4       -0.009     0.028    -0.065     0.046    -0.322   113.426     0.748     0.392     0.294 
## birth_order_nonlinear5       -0.034     0.048    -0.128     0.061    -0.699    62.310     0.487     0.613     0.399 
## poly(age, 3, raw = TRUE)1     0.041     0.004     0.034     0.049    10.898    38.042     0.000     0.947     0.511 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.377    41.497     0.002     0.872     0.490 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.748    43.522     0.087     0.834     0.478 
## male                         -0.071     0.017    -0.104    -0.038    -4.179    28.084     0.000     1.305     0.594 
## sibling_count3                0.005     0.021    -0.038     0.047     0.211    53.481     0.834     0.696     0.431 
## sibling_count4               -0.029     0.026    -0.081     0.022    -1.116    66.267     0.268     0.584     0.387 
## sibling_count5               -0.087     0.041    -0.167    -0.008    -2.157    26.254     0.040     1.413     0.614 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.214 
## Residual~~Residual                     0.673 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-54" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-13" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-55" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.561     0.039    -0.638    -0.485   -14.405    24.896     0.000     1.508     0.630 
## count_birth_order2/2          0.016     0.024    -0.031     0.062     0.666    49.728     0.509     0.740     0.447 
## count_birth_order1/3          0.013     0.030    -0.046     0.072     0.430    57.687     0.669     0.653     0.415 
## count_birth_order2/3         -0.005     0.031    -0.066     0.056    -0.173    35.971     0.863     1.001     0.526 
## count_birth_order3/3          0.015     0.028    -0.040     0.069     0.526   103.692     0.600     0.418     0.308 
## count_birth_order1/4         -0.024     0.042    -0.107     0.059    -0.574    47.988     0.568     0.764     0.455 
## count_birth_order2/4         -0.038     0.037    -0.110     0.034    -1.027    61.469     0.309     0.620     0.402 
## count_birth_order3/4         -0.050     0.038    -0.125     0.025    -1.314    51.380     0.195     0.720     0.440 
## count_birth_order4/4         -0.004     0.035    -0.072     0.064    -0.119   142.017     0.906     0.336     0.262 
## count_birth_order1/5         -0.054     0.050    -0.151     0.044    -1.073   140.613     0.285     0.339     0.263 
## count_birth_order2/5         -0.076     0.055    -0.185     0.032    -1.380    39.023     0.175     0.924     0.505 
## count_birth_order3/5         -0.080     0.062    -0.201     0.041    -1.295    23.871     0.208     1.591     0.643 
## count_birth_order4/5         -0.132     0.069    -0.267     0.003    -1.923    18.632     0.070     2.279     0.723 
## count_birth_order5/5         -0.120     0.047    -0.211    -0.029    -2.573   132.993     0.011     0.352     0.271 
## poly(age, 3, raw = TRUE)1     0.043     0.004     0.036     0.051    11.104    40.030     0.000     0.902     0.499 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.000    -3.699    43.707     0.001     0.831     0.477 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.004    45.002     0.051     0.809     0.470 
## male                         -0.072     0.017    -0.105    -0.040    -4.328    30.439     0.000     1.192     0.571 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.215 
## Residual~~Residual                     0.670 
## ICC|mother_pidlink                     0.243 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-55" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-13" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.388       6  54.410   0.884 235.587 
##  2 vs 3:   0.382       3  27.087   0.767 490.692 
##  3 vs 4:   0.300       1   9.046   0.597 169.644</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-6" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2015-young" class="section level3 tabset">
<h3>Raven 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-7" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-14" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-56" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.655     0.043    -0.740    -0.570   -15.091    14.446     0.000     3.746     0.813 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.036     0.052    10.554    33.137     0.000     1.088     0.548 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.743    54.067     0.008     0.689     0.429 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.050    60.290     0.298     0.630     0.406 
## male                          0.013     0.015    -0.016     0.042     0.855    63.961     0.396     0.600     0.394 
## sibling_count3               -0.004     0.022    -0.048     0.039    -0.183    63.869     0.855     0.601     0.394 
## sibling_count4               -0.014     0.027    -0.066     0.039    -0.513    49.325     0.610     0.746     0.449 
## sibling_count5                0.001     0.026    -0.049     0.052     0.051   219.526     0.959     0.254     0.210 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.635 
## ICC|mother_pidlink                     0.242 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-56" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-14" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-57" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.644     0.046    -0.735    -0.553   -13.899    18.267     0.000     2.355     0.730 
## birth_order                  -0.004     0.008    -0.019     0.010    -0.591   100.102     0.556     0.428     0.313 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.035     0.052    10.131    34.614     0.000     1.040     0.536 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.604    55.875     0.012     0.670     0.422 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.953    61.555     0.344     0.619     0.402 
## male                          0.013     0.015    -0.016     0.042     0.863    62.775     0.392     0.609     0.398 
## sibling_count3               -0.001     0.023    -0.047     0.045    -0.050    55.284     0.960     0.676     0.424 
## sibling_count4               -0.008     0.027    -0.061     0.045    -0.286    73.847     0.775     0.536     0.366 
## sibling_count5                0.010     0.030    -0.048     0.068     0.339   175.785     0.735     0.292     0.235 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.635 
## ICC|mother_pidlink                     0.242 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-57" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-14" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-58" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.649     0.046    -0.740    -0.558   -13.991    16.081     0.000     2.970     0.775 
## birth_order_nonlinear2       -0.004     0.018    -0.038     0.031    -0.205    53.220     0.838     0.698     0.432 
## birth_order_nonlinear3       -0.004     0.024    -0.050     0.043    -0.164    48.228     0.871     0.761     0.454 
## birth_order_nonlinear4       -0.027     0.028    -0.082     0.029    -0.938   123.873     0.350     0.369     0.281 
## birth_order_nonlinear5       -0.006     0.041    -0.087     0.074    -0.148   119.720     0.883     0.378     0.286 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.035     0.052     9.866    32.160     0.000     1.123     0.556 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.536    48.855     0.014     0.752     0.451 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.934    51.822     0.355     0.715     0.438 
## male                          0.013     0.015    -0.016     0.042     0.854    60.188     0.396     0.631     0.406 
## sibling_count3               -0.003     0.024    -0.050     0.044    -0.119    59.301     0.906     0.638     0.409 
## sibling_count4               -0.005     0.027    -0.059     0.048    -0.186    86.207     0.853     0.477     0.338 
## sibling_count5                0.009     0.031    -0.051     0.069     0.294   150.276     0.769     0.324     0.255 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.635 
## ICC|mother_pidlink                     0.242 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-58" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-14" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-59" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.656     0.044    -0.741    -0.570   -14.989    20.604     0.000     1.949     0.690 
## count_birth_order2/2         -0.003     0.026    -0.054     0.048    -0.126    43.334     0.900     0.837     0.479 
## count_birth_order1/3         -0.013     0.031    -0.073     0.047    -0.420    78.688     0.675     0.511     0.354 
## count_birth_order2/3         -0.021     0.034    -0.088     0.046    -0.617    39.448     0.541     0.914     0.502 
## count_birth_order3/3          0.013     0.028    -0.042     0.068     0.471   154.670     0.638     0.318     0.251 
## count_birth_order1/4          0.006     0.038    -0.069     0.081     0.156    81.990     0.876     0.495     0.347 
## count_birth_order2/4          0.017     0.036    -0.053     0.086     0.468   175.661     0.640     0.293     0.235 
## count_birth_order3/4         -0.060     0.041    -0.141     0.021    -1.454    40.857     0.154     0.884     0.494 
## count_birth_order4/4         -0.019     0.034    -0.085     0.048    -0.544   123.245     0.587     0.370     0.282 
## count_birth_order1/5          0.009     0.045    -0.080     0.098     0.194   123.919     0.846     0.369     0.281 
## count_birth_order2/5          0.010     0.048    -0.083     0.103     0.207    92.438     0.836     0.454     0.326 
## count_birth_order3/5          0.022     0.049    -0.073     0.117     0.459    55.660     0.648     0.673     0.422 
## count_birth_order4/5         -0.043     0.045    -0.131     0.044    -0.972    94.307     0.334     0.447     0.323 
## count_birth_order5/5          0.003     0.040    -0.075     0.081     0.077   144.878     0.938     0.332     0.259 
## poly(age, 3, raw = TRUE)1     0.045     0.004     0.036     0.053    10.446    41.242     0.000     0.877     0.491 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.821    59.612     0.006     0.635     0.408 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.170    62.887     0.246     0.609     0.397 
## male                          0.013     0.015    -0.017     0.042     0.851    60.242     0.398     0.630     0.406 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.635 
## ICC|mother_pidlink                     0.243 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-59" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-14" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.677       6 126.578   0.669   1.702 
##  2 vs 3:   0.241       3  43.416   0.867   2.996 
##  3 vs 4:   0.286       1  11.594   0.603   3.347</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-7" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-15" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-60" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.662     0.038    -0.735    -0.588   -17.613    16.249     0.000     2.910     0.771 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.037     0.052    10.994    25.304     0.000     1.478     0.625 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.061    26.348     0.005     1.406     0.613 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.558    25.472     0.132     1.466     0.623 
## male                          0.017     0.014    -0.010     0.044     1.249    58.099     0.217     0.649     0.413 
## sibling_count3               -0.003     0.018    -0.039     0.033    -0.144    85.834     0.886     0.479     0.339 
## sibling_count4               -0.032     0.023    -0.077     0.013    -1.385    73.738     0.170     0.537     0.366 
## sibling_count5               -0.089     0.030    -0.147    -0.031    -3.004    49.402     0.004     0.745     0.449 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.640 
## ICC|mother_pidlink                     0.243 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-60" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-15" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-61" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.661     0.038    -0.735    -0.587   -17.473    23.077     0.000     1.663     0.653 
## birth_order                  -0.000     0.007    -0.014     0.014    -0.034    79.135     0.973     0.509     0.353 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.036     0.052    10.956    26.301     0.000     1.409     0.613 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.045    26.639     0.005     1.388     0.610 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.546    25.609     0.134     1.456     0.621 
## male                          0.017     0.014    -0.010     0.045     1.228    53.112     0.225     0.700     0.433 
## sibling_count3               -0.002     0.019    -0.040     0.035    -0.132    87.153     0.895     0.474     0.336 
## sibling_count4               -0.031     0.025    -0.080     0.018    -1.233    63.652     0.222     0.603     0.395 
## sibling_count5               -0.089     0.034    -0.157    -0.021    -2.580    38.281     0.014     0.941     0.510 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.640 
## ICC|mother_pidlink                     0.243 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-61" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-15" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-62" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.656     0.041    -0.735    -0.576   -16.144    17.979     0.000     2.419     0.735 
## birth_order_nonlinear2       -0.006     0.017    -0.039     0.027    -0.361    45.815     0.719     0.796     0.466 
## birth_order_nonlinear3       -0.002     0.022    -0.046     0.042    -0.085    45.278     0.932     0.805     0.469 
## birth_order_nonlinear4       -0.011     0.028    -0.066     0.044    -0.388    96.316     0.699     0.440     0.320 
## birth_order_nonlinear5       -0.023     0.048    -0.118     0.072    -0.477    52.343     0.635     0.708     0.436 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.036     0.052    10.379    24.421     0.000     1.545     0.636 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.823    25.161     0.009     1.488     0.627 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.385    24.693     0.178     1.523     0.632 
## male                          0.017     0.014    -0.010     0.044     1.250    61.679     0.216     0.618     0.401 
## sibling_count3               -0.003     0.020    -0.042     0.035    -0.156    81.680     0.876     0.497     0.348 
## sibling_count4               -0.029     0.025    -0.078     0.019    -1.185    89.134     0.239     0.466     0.333 
## sibling_count5               -0.084     0.039    -0.162    -0.007    -2.141    26.523     0.042     1.395     0.611 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.639 
## ICC|mother_pidlink                     0.243 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-62" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-15" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-63" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.672     0.038    -0.747    -0.597   -17.567    24.507     0.000     1.538     0.635 
## count_birth_order2/2          0.008     0.022    -0.036     0.051     0.350    64.250     0.727     0.598     0.393 
## count_birth_order1/3         -0.003     0.029    -0.059     0.053    -0.118    69.789     0.907     0.560     0.377 
## count_birth_order2/3         -0.020     0.028    -0.076     0.035    -0.719    50.085     0.475     0.736     0.446 
## count_birth_order3/3          0.017     0.028    -0.038     0.073     0.610    70.109     0.544     0.558     0.376 
## count_birth_order1/4         -0.016     0.040    -0.094     0.062    -0.411    60.198     0.683     0.630     0.406 
## count_birth_order2/4         -0.034     0.034    -0.101     0.033    -1.005    93.119     0.318     0.451     0.325 
## count_birth_order3/4         -0.060     0.038    -0.136     0.015    -1.572    44.541     0.123     0.817     0.473 
## count_birth_order4/4         -0.011     0.034    -0.077     0.055    -0.333   149.107     0.740     0.326     0.256 
## count_birth_order1/5         -0.059     0.052    -0.162     0.044    -1.128    70.500     0.263     0.556     0.375 
## count_birth_order2/5         -0.077     0.055    -0.185     0.031    -1.396    35.740     0.171     1.007     0.528 
## count_birth_order3/5         -0.060     0.060    -0.178     0.058    -0.997    23.764     0.329     1.600     0.644 
## count_birth_order4/5         -0.139     0.058    -0.254    -0.025    -2.382    25.255     0.025     1.481     0.625 
## count_birth_order5/5         -0.112     0.044    -0.197    -0.026    -2.563   237.553     0.011     0.242     0.201 
## poly(age, 3, raw = TRUE)1     0.046     0.004     0.038     0.054    10.853    27.609     0.000     1.331     0.599 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.000    -3.108    26.804     0.004     1.378     0.608 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.590    25.627     0.124     1.455     0.621 
## male                          0.016     0.014    -0.012     0.043     1.127    59.632     0.264     0.635     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.637 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-63" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-15" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.367       6  54.409   0.897 235.712 
##  2 vs 3:   0.361       3  27.087   0.782 490.885 
##  3 vs 4:   0.316       1   9.046   0.588 169.710</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-7" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2015-young" class="section level3 tabset">
<h3>Numeracy 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-8" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-16" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-64" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.256     0.036    -0.326    -0.186    -7.181    21.879     0.000     1.788     0.670 
## poly(age, 3, raw = TRUE)1     0.027     0.004     0.020     0.035     6.965    66.177     0.000     0.584     0.387 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.520    84.245     0.014     0.486     0.342 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.292    78.916     0.200     0.510     0.354 
## male                         -0.139     0.023    -0.184    -0.094    -6.021    18.512     0.000     2.303     0.725 
## sibling_count3                0.004     0.025    -0.045     0.052     0.144    45.846     0.886     0.796     0.466 
## sibling_count4               -0.029     0.030    -0.088     0.029    -0.988    37.469     0.330     0.961     0.515 
## sibling_count5               -0.009     0.030    -0.068     0.049    -0.317    73.132     0.752     0.540     0.368 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.195 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-64" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-16" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-65" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.257     0.044    -0.343    -0.170    -5.824    23.301     0.000     1.642     0.650 
## birth_order                   0.000     0.009    -0.018     0.018     0.038    49.030     0.970     0.750     0.450 
## poly(age, 3, raw = TRUE)1     0.027     0.004     0.020     0.035     6.891    79.951     0.000     0.505     0.352 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.514    94.279     0.014     0.447     0.323 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.274    75.544     0.207     0.527     0.362 
## male                         -0.139     0.023    -0.184    -0.094    -6.029    18.558     0.000     2.294     0.725 
## sibling_count3                0.003     0.024    -0.044     0.050     0.139    66.375     0.890     0.583     0.386 
## sibling_count4               -0.030     0.031    -0.091     0.031    -0.955    43.536     0.345     0.834     0.478 
## sibling_count5               -0.010     0.035    -0.080     0.059    -0.289    58.322     0.774     0.647     0.413 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.195 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-65" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-16" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-66" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.261     0.041    -0.341    -0.181    -6.386    22.837     0.000     1.687     0.657 
## birth_order_nonlinear2        0.008     0.021    -0.033     0.048     0.366    39.894     0.716     0.905     0.499 
## birth_order_nonlinear3        0.008     0.028    -0.047     0.062     0.277    35.643     0.784     1.010     0.528 
## birth_order_nonlinear4       -0.016     0.034    -0.082     0.050    -0.479    60.416     0.634     0.629     0.405 
## birth_order_nonlinear5        0.016     0.045    -0.072     0.104     0.357   118.066     0.722     0.381     0.288 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.035     6.967    87.051     0.000     0.474     0.337 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.618   120.479     0.010     0.376     0.285 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.355    92.360     0.179     0.454     0.327 
## male                         -0.139     0.023    -0.184    -0.094    -6.028    18.520     0.000     2.301     0.725 
## sibling_count3                0.002     0.023    -0.043     0.047     0.095   125.164     0.924     0.366     0.280 
## sibling_count4               -0.025     0.032    -0.087     0.038    -0.771    45.008     0.445     0.809     0.470 
## sibling_count5               -0.009     0.035    -0.078     0.059    -0.266    72.013     0.791     0.547     0.371 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.195 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-66" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-16" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-67" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.270     0.041    -0.350    -0.189    -6.552    28.765     0.000     1.269     0.587 
## count_birth_order2/2          0.020     0.028    -0.034     0.074     0.733    52.248     0.467     0.710     0.436 
## count_birth_order1/3          0.021     0.029    -0.037     0.078     0.705   287.084     0.481     0.215     0.183 
## count_birth_order2/3          0.010     0.034    -0.056     0.076     0.298    65.045     0.767     0.592     0.390 
## count_birth_order3/3          0.011     0.039    -0.065     0.086     0.274    30.735     0.786     1.179     0.568 
## count_birth_order1/4         -0.023     0.044    -0.109     0.062    -0.535    55.638     0.595     0.673     0.423 
## count_birth_order2/4         -0.020     0.037    -0.093     0.053    -0.535   243.099     0.593     0.238     0.199 
## count_birth_order3/4         -0.013     0.041    -0.093     0.068    -0.307    62.903     0.760     0.608     0.397 
## count_birth_order4/4         -0.022     0.040    -0.100     0.056    -0.554    64.335     0.582     0.598     0.393 
## count_birth_order1/5         -0.001     0.058    -0.115     0.114    -0.010    38.392     0.992     0.939     0.509 
## count_birth_order2/5         -0.000     0.049    -0.096     0.096    -0.000   156.198     1.000     0.316     0.250 
## count_birth_order3/5          0.029     0.048    -0.064     0.122     0.607   117.334     0.545     0.383     0.289 
## count_birth_order4/5         -0.043     0.048    -0.138     0.051    -0.898    88.788     0.371     0.467     0.333 
## count_birth_order5/5          0.014     0.044    -0.072     0.100     0.312   109.456     0.756     0.402     0.299 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.036     6.922    94.957     0.000     0.445     0.322 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.680   142.691     0.008     0.335     0.261 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.433   115.842     0.154     0.386     0.291 
## male                         -0.139     0.023    -0.184    -0.094    -6.035    18.587     0.000     2.288     0.724 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.195 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-67" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-16" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.300       6 131.222   0.936   1.618 
##  2 vs 3:   0.326       3  42.899   0.806   3.081 
##  3 vs 4:   0.199       1  11.343   0.664   3.672</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-8" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-17" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-68" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.259     0.033    -0.324    -0.194    -7.783    22.781     0.000     1.692     0.657 
## poly(age, 3, raw = TRUE)1     0.026     0.003     0.019     0.033     7.417    63.028     0.000     0.607     0.397 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.706    60.241     0.009     0.630     0.406 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.474    57.251     0.146     0.657     0.417 
## male                         -0.136     0.019    -0.174    -0.099    -7.123    22.447     0.000     1.726     0.662 
## sibling_count3                0.009     0.022    -0.034     0.053     0.408    39.341     0.685     0.917     0.503 
## sibling_count4               -0.023     0.027    -0.076     0.030    -0.862    38.897     0.394     0.927     0.506 
## sibling_count5               -0.075     0.041    -0.155     0.006    -1.821    20.124     0.084     2.019     0.697 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.198 
## Residual~~Residual                     0.769 
## ICC|mother_pidlink                     0.205 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-68" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-17" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-69" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.259     0.038    -0.333    -0.185    -6.856    27.651     0.000     1.328     0.599 
## birth_order                  -0.000     0.008    -0.017     0.016    -0.041    46.278     0.968     0.789     0.464 
## poly(age, 3, raw = TRUE)1     0.026     0.003     0.019     0.033     7.482    73.191     0.000     0.540     0.368 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.714    60.277     0.009     0.630     0.406 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.484    55.866     0.144     0.670     0.422 
## male                         -0.136     0.019    -0.174    -0.099    -7.089    22.287     0.000     1.743     0.664 
## sibling_count3                0.009     0.023    -0.035     0.053     0.408    41.885     0.685     0.864     0.487 
## sibling_count4               -0.023     0.030    -0.082     0.037    -0.755    33.319     0.456     1.082     0.546 
## sibling_count5               -0.072     0.043    -0.156     0.013    -1.661    22.496     0.111     1.721     0.661 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.198 
## Residual~~Residual                     0.769 
## ICC|mother_pidlink                     0.205 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-69" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-17" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-70" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.258     0.038    -0.333    -0.183    -6.770    23.351     0.000     1.637     0.650 
## birth_order_nonlinear2        0.002     0.019    -0.036     0.040     0.113    37.184     0.911     0.968     0.517 
## birth_order_nonlinear3       -0.012     0.028    -0.066     0.042    -0.436    27.470     0.666     1.339     0.600 
## birth_order_nonlinear4       -0.004     0.030    -0.063     0.055    -0.128   117.440     0.898     0.383     0.289 
## birth_order_nonlinear5       -0.034     0.051    -0.134     0.067    -0.656    62.955     0.514     0.608     0.397 
## poly(age, 3, raw = TRUE)1     0.026     0.004     0.019     0.033     7.356    76.221     0.000     0.524     0.360 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.661    69.398     0.010     0.563     0.378 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.425    65.646     0.159     0.588     0.389 
## male                         -0.137     0.019    -0.175    -0.099    -7.142    23.153     0.000     1.656     0.652 
## sibling_count3                0.011     0.022    -0.033     0.055     0.489    51.058     0.627     0.724     0.441 
## sibling_count4               -0.020     0.028    -0.075     0.035    -0.704    53.466     0.485     0.696     0.431 
## sibling_count5               -0.064     0.043    -0.149     0.021    -1.476    24.061     0.153     1.575     0.640 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.198 
## Residual~~Residual                     0.769 
## ICC|mother_pidlink                     0.205 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-70" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-17" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-71" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.274     0.038    -0.348    -0.199    -7.163    29.831     0.000     1.219     0.577 
## count_birth_order2/2          0.019     0.025    -0.030     0.068     0.758    51.680     0.452     0.716     0.439 
## count_birth_order1/3          0.026     0.031    -0.035     0.086     0.834    69.232     0.407     0.564     0.378 
## count_birth_order2/3          0.011     0.032    -0.051     0.073     0.354    41.097     0.725     0.880     0.492 
## count_birth_order3/3          0.008     0.032    -0.055     0.071     0.261    51.173     0.795     0.722     0.441 
## count_birth_order1/4         -0.024     0.042    -0.107     0.059    -0.570    63.271     0.571     0.606     0.396 
## count_birth_order2/4         -0.029     0.040    -0.108     0.049    -0.740    51.845     0.462     0.714     0.438 
## count_birth_order3/4         -0.024     0.037    -0.097     0.049    -0.640    83.371     0.524     0.489     0.344 
## count_birth_order4/4          0.006     0.035    -0.062     0.075     0.177   254.549     0.859     0.232     0.194 
## count_birth_order1/5         -0.032     0.056    -0.142     0.079    -0.564    72.291     0.574     0.545     0.370 
## count_birth_order2/5         -0.054     0.059    -0.169     0.061    -0.917    37.708     0.365     0.955     0.514 
## count_birth_order3/5         -0.075     0.056    -0.186     0.035    -1.333    37.334     0.191     0.965     0.516 
## count_birth_order4/5         -0.084     0.074    -0.229     0.061    -1.141    17.914     0.269     2.434     0.737 
## count_birth_order5/5         -0.090     0.052    -0.193     0.012    -1.725    72.324     0.089     0.545     0.370 
## poly(age, 3, raw = TRUE)1     0.027     0.004     0.020     0.035     7.404    69.656     0.000     0.561     0.377 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.907    69.936     0.005     0.559     0.376 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.611    61.275     0.112     0.621     0.402 
## male                         -0.138     0.019    -0.175    -0.101    -7.279    24.501     0.000     1.539     0.635 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.199 
## Residual~~Residual                     0.767 
## ICC|mother_pidlink                     0.206 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-71" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-17" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.420       6  54.410   0.862 235.413 
##  2 vs 3:   0.419       3  27.087   0.741 490.769 
##  3 vs 4:   0.369       1   9.046   0.558 169.939</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-8" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2007-old" class="section level3 tabset">
<h3>g-factor 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-9" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-18" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-72" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.211     0.062     0.090     0.333     3.414    11.561     0.005     7.497     0.898 
## poly(age, 3, raw = TRUE)1    -0.007     0.005    -0.018     0.003    -1.317    19.468     0.203     2.124     0.708 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.980    44.627     0.332     0.815     0.472 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.276    68.430     0.026     0.569     0.381 
## male                         -0.007     0.014    -0.034     0.021    -0.469   173.572     0.640     0.295     0.236 
## sibling_count3                0.009     0.026    -0.041     0.060     0.364    44.448     0.718     0.818     0.473 
## sibling_count4               -0.049     0.031    -0.110     0.013    -1.555    34.545     0.129     1.043     0.536 
## sibling_count5               -0.038     0.029    -0.095     0.019    -1.310   142.399     0.192     0.336     0.262 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.266 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.279 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-72" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-18" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-73" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.193     0.068     0.060     0.326     2.838    12.678     0.014     5.352     0.863 
## birth_order                   0.007     0.012    -0.016     0.031     0.615    18.406     0.546     2.325     0.727 
## poly(age, 3, raw = TRUE)1    -0.006     0.006    -0.017     0.005    -1.099    19.914     0.285     2.051     0.701 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.792    42.066     0.433     0.861     0.486 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.064    59.621     0.043     0.635     0.408 
## male                         -0.007     0.014    -0.034     0.021    -0.483   167.486     0.629     0.302     0.241 
## sibling_count3                0.004     0.027    -0.048     0.057     0.166    42.114     0.869     0.860     0.486 
## sibling_count4               -0.059     0.033    -0.124     0.006    -1.765    36.883     0.086     0.976     0.519 
## sibling_count5               -0.053     0.039    -0.130     0.024    -1.340    38.443     0.188     0.937     0.509 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.266 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.279 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-73" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-18" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-74" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.195     0.065     0.067     0.323     2.989    12.293     0.011     5.927     0.875 
## birth_order_nonlinear2        0.016     0.021    -0.025     0.057     0.758    30.507     0.455     1.189     0.570 
## birth_order_nonlinear3        0.007     0.031    -0.054     0.068     0.226    21.861     0.823     1.790     0.670 
## birth_order_nonlinear4        0.020     0.040    -0.059     0.098     0.491    24.923     0.628     1.506     0.630 
## birth_order_nonlinear5        0.047     0.057    -0.065     0.159     0.822    25.938     0.419     1.433     0.617 
## poly(age, 3, raw = TRUE)1    -0.006     0.006    -0.017     0.005    -1.079    20.137     0.294     2.017     0.697 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.761    41.962     0.451     0.863     0.487 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.028    60.917     0.047     0.624     0.404 
## male                         -0.007     0.014    -0.034     0.021    -0.492   164.840     0.623     0.305     0.243 
## sibling_count3                0.009     0.029    -0.048     0.066     0.314    33.907     0.756     1.063     0.541 
## sibling_count4               -0.053     0.034    -0.120     0.013    -1.576    37.476     0.123     0.961     0.515 
## sibling_count5               -0.052     0.041    -0.133     0.029    -1.252    33.640     0.219     1.071     0.544 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.266 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.279 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-74" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-18" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-75" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.184     0.063     0.060     0.308     2.912    13.522     0.012     4.430     0.838 
## count_birth_order2/2          0.027     0.025    -0.021     0.076     1.106    73.619     0.272     0.538     0.367 
## count_birth_order1/3          0.020     0.040    -0.059     0.098     0.492    28.229     0.627     1.297     0.593 
## count_birth_order2/3          0.014     0.044    -0.073     0.100     0.309    21.629     0.760     1.817     0.674 
## count_birth_order3/3          0.032     0.037    -0.041     0.104     0.851    34.330     0.401     1.049     0.538 
## count_birth_order1/4         -0.045     0.046    -0.135     0.045    -0.975    39.501     0.335     0.913     0.502 
## count_birth_order2/4         -0.014     0.050    -0.112     0.084    -0.284    28.529     0.779     1.281     0.589 
## count_birth_order3/4         -0.073     0.041    -0.153     0.007    -1.780    58.594     0.080     0.645     0.412 
## count_birth_order4/4         -0.019     0.052    -0.120     0.083    -0.360    21.967     0.722     1.778     0.669 
## count_birth_order1/5         -0.043     0.057    -0.155     0.069    -0.756    38.998     0.454     0.925     0.505 
## count_birth_order2/5         -0.040     0.052    -0.142     0.062    -0.775    72.807     0.441     0.542     0.369 
## count_birth_order3/5         -0.017     0.050    -0.116     0.081    -0.347    63.816     0.730     0.601     0.394 
## count_birth_order4/5         -0.046     0.051    -0.146     0.055    -0.886    52.107     0.380     0.711     0.437 
## count_birth_order5/5          0.001     0.045    -0.087     0.089     0.017    77.650     0.987     0.516     0.357 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.016     0.006    -0.929    23.114     0.363     1.660     0.653 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.566    49.488     0.574     0.744     0.448 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.863    73.937     0.066     0.536     0.366 
## male                         -0.007     0.014    -0.034     0.021    -0.494   165.816     0.622     0.304     0.242 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.266 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.279 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-75" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-18" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.419       6 115.785   0.865   1.944 
##  2 vs 3:   0.426       3  41.963   0.735   3.252 
##  3 vs 4:   0.286       1  10.595   0.604   5.238</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-9" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-19" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-76" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.200     0.062     0.080     0.321     3.252    11.322     0.007     8.223     0.907 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.016     0.004    -1.172    17.052     0.257     2.656     0.754 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.406    26.477     0.688     1.398     0.611 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.525    25.564     0.140     1.459     0.622 
## male                         -0.003     0.013    -0.029     0.022    -0.267   134.932     0.790     0.348     0.269 
## sibling_count3               -0.003     0.024    -0.049     0.044    -0.114    32.303     0.910     1.118     0.555 
## sibling_count4               -0.045     0.031    -0.106     0.017    -1.416    25.353     0.169     1.474     0.624 
## sibling_count5               -0.110     0.029    -0.167    -0.053    -3.790   102.382     0.000     0.421     0.310 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.278 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-76" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-19" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-77" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.166     0.065     0.038     0.294     2.546    12.294     0.025     5.926     0.875 
## birth_order                   0.015     0.011    -0.007     0.036     1.345    18.957     0.194     2.216     0.717 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.015     0.005    -0.939    17.588     0.360     2.513     0.743 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.262    27.386     0.796     1.343     0.601 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.446    26.110     0.160     1.422     0.615 
## male                         -0.003     0.013    -0.029     0.022    -0.265   133.402     0.791     0.351     0.271 
## sibling_count3               -0.012     0.024    -0.059     0.034    -0.509    36.222     0.614     0.994     0.524 
## sibling_count4               -0.063     0.034    -0.131     0.004    -1.837    24.155     0.079     1.567     0.639 
## sibling_count5               -0.134     0.032    -0.197    -0.071    -4.148    90.993     0.000     0.459     0.329 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.278 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-77" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-216-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-19" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-78" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.192     0.062     0.072     0.313     3.120    12.312     0.009     5.896     0.874 
## birth_order_nonlinear2        0.006     0.019    -0.031     0.044     0.336    34.085     0.739     1.057     0.540 
## birth_order_nonlinear3        0.018     0.027    -0.034     0.070     0.685    27.701     0.499     1.326     0.598 
## birth_order_nonlinear4        0.027     0.048    -0.066     0.121     0.575    16.618     0.573     2.787     0.763 
## birth_order_nonlinear5        0.030     0.063    -0.093     0.153     0.482    23.562     0.634     1.618     0.647 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.016     0.004    -1.107    18.218     0.283     2.365     0.731 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.501    28.042     0.620     1.307     0.594 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.698    27.985     0.101     1.310     0.595 
## male                         -0.005     0.013    -0.031     0.021    -0.381   123.393     0.704     0.370     0.282 
## sibling_count3               -0.009     0.026    -0.060     0.041    -0.365    29.388     0.718     1.239     0.581 
## sibling_count4               -0.061     0.037    -0.132     0.011    -1.657    22.181     0.112     1.755     0.666 
## sibling_count5               -0.127     0.033    -0.192    -0.061    -3.784    84.615     0.000     0.484     0.342 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.279 
## Residual~~Residual                     0.684 
## ICC|mother_pidlink                     0.289 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-78" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-19" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-79" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.177     0.060     0.059     0.295     2.933    13.420     0.011     4.522     0.841 
## count_birth_order2/2          0.022     0.031    -0.039     0.083     0.704    21.231     0.489     1.866     0.680 
## count_birth_order1/3         -0.001     0.035    -0.070     0.068    -0.029    32.465     0.977     1.112     0.553 
## count_birth_order2/3         -0.005     0.033    -0.070     0.060    -0.142    32.029     0.888     1.128     0.557 
## count_birth_order3/3          0.022     0.035    -0.047     0.091     0.626    32.508     0.536     1.110     0.553 
## count_birth_order1/4         -0.048     0.053    -0.151     0.056    -0.904    24.235     0.375     1.560     0.638 
## count_birth_order2/4         -0.050     0.048    -0.144     0.044    -1.037    24.220     0.310     1.561     0.638 
## count_birth_order3/4         -0.056     0.041    -0.137     0.025    -1.354    41.391     0.183     0.874     0.490 
## count_birth_order4/4         -0.014     0.051    -0.115     0.086    -0.280    22.227     0.782     1.750     0.665 
## count_birth_order1/5         -0.111     0.063    -0.235     0.013    -1.755    34.762     0.088     1.036     0.535 
## count_birth_order2/5         -0.150     0.051    -0.251    -0.050    -2.945    72.944     0.004     0.541     0.368 
## count_birth_order3/5         -0.082     0.058    -0.197     0.032    -1.407    30.649     0.170     1.183     0.569 
## count_birth_order4/5         -0.106     0.061    -0.226     0.014    -1.733    26.224     0.095     1.414     0.614 
## count_birth_order5/5         -0.084     0.059    -0.199     0.031    -1.432    35.601     0.161     1.011     0.529 
## poly(age, 3, raw = TRUE)1    -0.004     0.005    -0.015     0.006    -0.842    19.193     0.410     2.172     0.713 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.261    28.257     0.796     1.295     0.592 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.494    27.868     0.146     1.316     0.596 
## male                         -0.005     0.013    -0.031     0.021    -0.399   146.360     0.691     0.330     0.258 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.278 
## Residual~~Residual                     0.683 
## ICC|mother_pidlink                     0.290 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-79" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-19" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.403       6  54.409   0.874 235.834 
##  2 vs 3:   0.422       3  27.087   0.739 491.694 
##  3 vs 4:   0.358       1   9.046   0.564 171.161</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-9" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2007-old" class="section level3 tabset">
<h3>Raven 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-10" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-20" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-80" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.015     0.062    -0.136     0.106    -0.245    11.646     0.811     7.270     0.896 
## poly(age, 3, raw = TRUE)1     0.003     0.006    -0.009     0.015     0.483    16.038     0.636     2.986     0.775 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.562    24.505     0.579     1.538     0.635 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.519    28.587     0.140     1.278     0.589 
## male                          0.028     0.015    -0.002     0.058     1.843    77.240     0.069     0.518     0.358 
## sibling_count3                0.003     0.025    -0.046     0.052     0.128    53.487     0.899     0.695     0.431 
## sibling_count4               -0.030     0.037    -0.102     0.042    -0.822    22.158     0.420     1.757     0.666 
## sibling_count5               -0.028     0.032    -0.090     0.034    -0.890    65.528     0.377     0.589     0.389 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.706 
## ICC|mother_pidlink                     0.272 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-80" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-20" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-81" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.019     0.062    -0.141     0.103    -0.308    13.744     0.763     4.241     0.832 
## birth_order                   0.002     0.010    -0.018     0.021     0.165    30.943     0.870     1.171     0.566 
## poly(age, 3, raw = TRUE)1     0.003     0.006    -0.009     0.015     0.522    17.165     0.608     2.625     0.751 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.536    26.143     0.597     1.420     0.615 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.502    30.334     0.143     1.196     0.572 
## male                          0.028     0.015    -0.002     0.058     1.836    76.370     0.070     0.523     0.360 
## sibling_count3                0.002     0.026    -0.049     0.053     0.081    50.017     0.936     0.737     0.446 
## sibling_count4               -0.032     0.040    -0.111     0.046    -0.809    21.621     0.427     1.818     0.674 
## sibling_count5               -0.032     0.039    -0.108     0.045    -0.806    40.330     0.425     0.895     0.497 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.706 
## ICC|mother_pidlink                     0.272 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-81" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-226-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-20" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-82" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.019     0.061    -0.140     0.101    -0.312    12.942     0.760     5.021     0.855 
## birth_order_nonlinear2        0.005     0.022    -0.037     0.048     0.247    28.948     0.807     1.260     0.585 
## birth_order_nonlinear3       -0.007     0.031    -0.067     0.053    -0.228    23.274     0.822     1.644     0.651 
## birth_order_nonlinear4        0.003     0.031    -0.058     0.064     0.096    84.774     0.923     0.483     0.341 
## birth_order_nonlinear5        0.026     0.052    -0.076     0.129     0.506    36.450     0.616     0.988     0.522 
## poly(age, 3, raw = TRUE)1     0.003     0.006    -0.009     0.015     0.516    17.613     0.612     2.507     0.742 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.548    26.728     0.588     1.383     0.609 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.509    30.774     0.142     1.178     0.568 
## male                          0.028     0.015    -0.002     0.058     1.823    74.192     0.072     0.534     0.365 
## sibling_count3                0.007     0.030    -0.052     0.066     0.225    30.643     0.823     1.183     0.569 
## sibling_count4               -0.028     0.042    -0.110     0.054    -0.672    20.803     0.509     1.922     0.687 
## sibling_count5               -0.033     0.043    -0.116     0.051    -0.764    30.771     0.451     1.178     0.568 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.705 
## ICC|mother_pidlink                     0.272 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-82" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-20" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-83" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.029     0.060    -0.147     0.089    -0.487    14.302     0.634     3.837     0.817 
## count_birth_order2/2          0.014     0.027    -0.039     0.068     0.520    44.024     0.606     0.825     0.475 
## count_birth_order1/3          0.011     0.038    -0.063     0.085     0.284    35.668     0.778     1.009     0.528 
## count_birth_order2/3          0.000     0.048    -0.094     0.094     0.002    18.698     0.998     2.266     0.722 
## count_birth_order3/3          0.018     0.037    -0.055     0.090     0.477    35.515     0.636     1.014     0.529 
## count_birth_order1/4         -0.015     0.054    -0.122     0.091    -0.281    23.402     0.781     1.633     0.649 
## count_birth_order2/4          0.003     0.054    -0.102     0.108     0.056    24.200     0.956     1.563     0.639 
## count_birth_order3/4         -0.068     0.043    -0.152     0.017    -1.575    47.579     0.122     0.770     0.457 
## count_birth_order4/4         -0.014     0.058    -0.128     0.100    -0.245    17.802     0.809     2.461     0.739 
## count_birth_order1/5         -0.025     0.056    -0.136     0.085    -0.451    43.416     0.654     0.836     0.479 
## count_birth_order2/5         -0.033     0.059    -0.149     0.083    -0.561    37.515     0.578     0.960     0.515 
## count_birth_order3/5         -0.020     0.052    -0.121     0.082    -0.380    56.305     0.706     0.666     0.420 
## count_birth_order4/5         -0.038     0.053    -0.142     0.067    -0.711    45.109     0.481     0.807     0.470 
## count_birth_order5/5         -0.002     0.046    -0.092     0.088    -0.044    69.484     0.965     0.562     0.378 
## poly(age, 3, raw = TRUE)1     0.004     0.006    -0.007     0.016     0.719    20.277     0.480     1.996     0.695 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.380    32.846     0.707     1.098     0.550 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.396    37.847     0.171     0.952     0.513 
## male                          0.028     0.015    -0.002     0.058     1.810    72.189     0.074     0.546     0.370 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.705 
## ICC|mother_pidlink                     0.272 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-83" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-20" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.431       6 117.306   0.857   1.905 
##  2 vs 3:   0.425       3  40.229   0.736   3.630 
##  3 vs 4:   0.107       1  11.086   0.749   4.084</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-10" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-21" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-84" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.028     0.059    -0.144     0.087    -0.480    11.652     0.640     7.256     0.895 
## poly(age, 3, raw = TRUE)1     0.004     0.006    -0.007     0.015     0.767    16.028     0.454     2.990     0.776 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.082    23.014     0.935     1.669     0.654 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.034    22.682     0.312     1.702     0.659 
## male                          0.036     0.014     0.009     0.062     2.655   111.713     0.009     0.396     0.296 
## sibling_count3               -0.003     0.021    -0.044     0.039    -0.124    59.071     0.902     0.640     0.410 
## sibling_count4               -0.040     0.029    -0.096     0.016    -1.397    35.362     0.171     1.018     0.530 
## sibling_count5               -0.089     0.029    -0.147    -0.032    -3.039   100.393     0.003     0.427     0.313 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.272 
## Residual~~Residual                     0.713 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-84" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-233-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-21" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-85" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.047     0.064    -0.173     0.079    -0.731    12.520     0.478     5.573     0.867 
## birth_order                   0.008     0.011    -0.013     0.029     0.762    20.545     0.455     1.957     0.691 
## poly(age, 3, raw = TRUE)1     0.005     0.005    -0.006     0.016     0.887    16.584     0.388     2.798     0.764 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.015    24.607     0.988     1.530     0.633 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.013    23.805     0.321     1.597     0.644 
## male                          0.036     0.014     0.009     0.063     2.653   109.030     0.009     0.403     0.300 
## sibling_count3               -0.008     0.022    -0.050     0.035    -0.357    60.639     0.723     0.627     0.405 
## sibling_count4               -0.050     0.035    -0.119     0.019    -1.422    23.129     0.168     1.658     0.653 
## sibling_count5               -0.102     0.037    -0.175    -0.028    -2.714    38.427     0.010     0.938     0.509 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.272 
## Residual~~Residual                     0.713 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-85" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-21" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-86" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.028     0.060    -0.147     0.090    -0.470    12.571     0.647     5.499     0.866 
## birth_order_nonlinear2        0.001     0.019    -0.036     0.037     0.028    37.857     0.978     0.952     0.513 
## birth_order_nonlinear3        0.011     0.025    -0.038     0.059     0.436    38.365     0.666     0.939     0.509 
## birth_order_nonlinear4        0.003     0.048    -0.091     0.097     0.066    16.742     0.948     2.748     0.760 
## birth_order_nonlinear5        0.008     0.067    -0.123     0.140     0.127    20.971     0.900     1.899     0.684 
## poly(age, 3, raw = TRUE)1     0.004     0.006    -0.007     0.015     0.728    16.672     0.477     2.770     0.762 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.222    23.924     0.826     1.586     0.642 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.195    23.336     0.244     1.639     0.650 
## male                          0.035     0.014     0.008     0.062     2.505    98.966     0.014     0.432     0.315 
## sibling_count3               -0.007     0.024    -0.053     0.039    -0.281    44.740     0.780     0.813     0.472 
## sibling_count4               -0.046     0.038    -0.121     0.028    -1.218    20.640     0.237     1.944     0.689 
## sibling_count5               -0.094     0.039    -0.171    -0.017    -2.383    35.026     0.023     1.028     0.533 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.272 
## Residual~~Residual                     0.711 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-86" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-21" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-87" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.045     0.058    -0.159     0.070    -0.763    13.938     0.458     4.091     0.827 
## count_birth_order2/2          0.015     0.029    -0.042     0.073     0.521    25.200     0.607     1.485     0.626 
## count_birth_order1/3          0.001     0.030    -0.058     0.059     0.020    84.154     0.984     0.486     0.342 
## count_birth_order2/3         -0.008     0.031    -0.069     0.053    -0.254    43.062     0.801     0.842     0.481 
## count_birth_order3/3          0.018     0.032    -0.045     0.081     0.545    50.653     0.588     0.729     0.443 
## count_birth_order1/4         -0.033     0.062    -0.154     0.088    -0.540    17.958     0.596     2.424     0.736 
## count_birth_order2/4         -0.041     0.043    -0.124     0.043    -0.952    36.941     0.348     0.975     0.519 
## count_birth_order3/4         -0.053     0.047    -0.146     0.040    -1.119    26.328     0.273     1.408     0.613 
## count_birth_order4/4         -0.020     0.047    -0.113     0.072    -0.427    29.192     0.673     1.248     0.583 
## count_birth_order1/5         -0.079     0.066    -0.208     0.050    -1.199    31.845     0.239     1.135     0.559 
## count_birth_order2/5         -0.124     0.062    -0.245    -0.003    -2.010    30.505     0.053     1.189     0.570 
## count_birth_order3/5         -0.047     0.061    -0.167     0.074    -0.760    27.406     0.454     1.342     0.601 
## count_birth_order4/5         -0.110     0.055    -0.219    -0.002    -2.000    39.010     0.052     0.924     0.505 
## count_birth_order5/5         -0.072     0.061    -0.191     0.047    -1.187    33.009     0.244     1.093     0.549 
## poly(age, 3, raw = TRUE)1     0.005     0.005    -0.005     0.016     1.015    18.489     0.323     2.308     0.726 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.017    26.686     0.987     1.385     0.609 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.028    25.209     0.314     1.484     0.626 
## male                          0.035     0.014     0.007     0.062     2.433    89.545     0.017     0.464     0.332 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.271 
## Residual~~Residual                     0.709 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-87" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-21" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.421       6  54.409   0.862 235.757 
##  2 vs 3:   0.440       3  27.087   0.726 492.130 
##  3 vs 4:   0.408       1   9.046   0.539 170.899</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-10" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2007-old" class="section level3 tabset">
<h3>Numeracy 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-11" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-22" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-88" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.362     0.054     0.256     0.468     6.673    12.476     0.000     5.638     0.869 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.023    -0.006    -3.499    43.728     0.001     0.830     0.477 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.961    68.318     0.340     0.570     0.381 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.846    61.905     0.070     0.616     0.400 
## male                         -0.039     0.014    -0.067    -0.011    -2.704   116.366     0.008     0.385     0.290 
## sibling_count3                0.012     0.024    -0.035     0.059     0.501    58.431     0.618     0.646     0.412 
## sibling_count4               -0.051     0.028    -0.105     0.004    -1.814    53.995     0.075     0.690     0.429 
## sibling_count5               -0.035     0.026    -0.086     0.016    -1.342   777.202     0.180     0.121     0.110 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.240 
## Residual~~Residual                     0.695 
## ICC|mother_pidlink                     0.257 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-88" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-243-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-22" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-89" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.335     0.066     0.205     0.465     5.062    12.842     0.000     5.141     0.858 
## birth_order                   0.011     0.012    -0.013     0.034     0.899    18.782     0.380     2.249     0.720 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.022    -0.004    -2.849    33.717     0.007     1.069     0.543 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.663    51.800     0.510     0.715     0.438 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.554    48.306     0.127     0.759     0.454 
## male                         -0.039     0.014    -0.068    -0.011    -2.724   115.991     0.007     0.386     0.291 
## sibling_count3                0.005     0.025    -0.043     0.053     0.200    57.674     0.842     0.653     0.415 
## sibling_count4               -0.065     0.027    -0.118    -0.012    -2.386   122.085     0.019     0.373     0.283 
## sibling_count5               -0.056     0.036    -0.126     0.014    -1.566    56.439     0.123     0.665     0.420 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.240 
## Residual~~Residual                     0.695 
## ICC|mother_pidlink                     0.256 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-89" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-245-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-22" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-90" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.339     0.062     0.218     0.461     5.473    12.670     0.000     5.362     0.863 
## birth_order_nonlinear2        0.021     0.020    -0.018     0.060     1.065    38.319     0.294     0.940     0.510 
## birth_order_nonlinear3        0.019     0.026    -0.033     0.070     0.713    36.996     0.480     0.973     0.519 
## birth_order_nonlinear4        0.030     0.044    -0.056     0.116     0.679    20.310     0.505     1.991     0.694 
## birth_order_nonlinear5        0.052     0.055    -0.056     0.159     0.944    29.367     0.353     1.240     0.581 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.022    -0.004    -2.807    35.069     0.008     1.027     0.533 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.618    59.400     0.539     0.637     0.409 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.530    56.627     0.132     0.663     0.419 
## male                         -0.039     0.014    -0.068    -0.011    -2.730   115.119     0.007     0.388     0.292 
## sibling_count3                0.008     0.025    -0.041     0.057     0.323    68.102     0.747     0.571     0.381 
## sibling_count4               -0.061     0.028    -0.115    -0.007    -2.199   141.620     0.030     0.337     0.262 
## sibling_count5               -0.054     0.036    -0.124     0.017    -1.483    60.267     0.143     0.630     0.406 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.240 
## Residual~~Residual                     0.695 
## ICC|mother_pidlink                     0.257 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-90" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-22" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-91" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.331     0.062     0.210     0.451     5.368    13.737     0.000     4.248     0.832 
## count_birth_order2/2          0.032     0.025    -0.017     0.080     1.275    74.976     0.206     0.530     0.363 
## count_birth_order1/3          0.022     0.036    -0.050     0.093     0.593    38.996     0.556     0.925     0.505 
## count_birth_order2/3          0.022     0.037    -0.050     0.095     0.609    36.518     0.546     0.986     0.522 
## count_birth_order3/3          0.035     0.034    -0.031     0.101     1.031    50.998     0.307     0.724     0.442 
## count_birth_order1/4         -0.059     0.040    -0.136     0.019    -1.480    95.561     0.142     0.443     0.321 
## count_birth_order2/4         -0.027     0.045    -0.114     0.061    -0.596    43.068     0.554     0.842     0.481 
## count_birth_order3/4         -0.053     0.040    -0.131     0.024    -1.353    71.906     0.180     0.547     0.371 
## count_birth_order4/4         -0.016     0.046    -0.106     0.075    -0.339    29.179     0.737     1.249     0.583 
## count_birth_order1/5         -0.045     0.057    -0.157     0.067    -0.788    38.349     0.435     0.940     0.509 
## count_birth_order2/5         -0.034     0.048    -0.127     0.060    -0.708   156.554     0.480     0.315     0.249 
## count_birth_order3/5         -0.009     0.045    -0.097     0.078    -0.211   187.889     0.833     0.280     0.227 
## count_birth_order4/5         -0.038     0.046    -0.128     0.052    -0.835   118.069     0.406     0.381     0.288 
## count_birth_order5/5          0.004     0.043    -0.081     0.089     0.086   100.222     0.932     0.428     0.313 
## poly(age, 3, raw = TRUE)1    -0.012     0.005    -0.021    -0.003    -2.650    38.825     0.012     0.929     0.506 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.478    67.565     0.634     0.575     0.383 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.411    62.288     0.163     0.613     0.399 
## male                         -0.039     0.014    -0.068    -0.011    -2.729   116.115     0.007     0.386     0.291 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.240 
## Residual~~Residual                     0.695 
## ICC|mother_pidlink                     0.257 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-91" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-249-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-22" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.295       6 123.928   0.938   1.755 
##  2 vs 3:   0.310       3  44.226   0.818   2.871 
##  3 vs 4:   0.533       1  10.608   0.481   5.200</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-11" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-23" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-92" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.357     0.055     0.250     0.464     6.547    12.023     0.000     6.419     0.883 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.022    -0.006    -3.384    27.037     0.002     1.364     0.605 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.584    32.573     0.563     1.108     0.552 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.393    24.894     0.176     1.508     0.630 
## male                         -0.042     0.013    -0.068    -0.016    -3.140   103.041     0.002     0.420     0.309 
## sibling_count3               -0.002     0.024    -0.049     0.045    -0.086    29.433     0.932     1.237     0.581 
## sibling_count4               -0.034     0.033    -0.098     0.030    -1.035    21.932     0.312     1.782     0.669 
## sibling_count5               -0.095     0.035    -0.162    -0.027    -2.737    32.854     0.010     1.098     0.550 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.247 
## Residual~~Residual                     0.693 
## ICC|mother_pidlink                     0.263 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-92" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-252-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-23" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-93" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.318     0.061     0.200     0.437     5.255    12.833     0.000     5.152     0.858 
## birth_order                   0.017     0.010    -0.004     0.037     1.577    20.342     0.130     1.986     0.694 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.004    -2.938    25.511     0.007     1.463     0.622 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.390    30.504     0.699     1.189     0.570 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.269    24.070     0.217     1.574     0.640 
## male                         -0.042     0.013    -0.068    -0.016    -3.165   110.796     0.002     0.399     0.298 
## sibling_count3               -0.013     0.024    -0.060     0.035    -0.524    32.002     0.604     1.129     0.557 
## sibling_count4               -0.055     0.031    -0.115     0.005    -1.786    32.239     0.083     1.120     0.555 
## sibling_count5               -0.122     0.030    -0.181    -0.062    -3.992   133.377     0.000     0.351     0.271 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.693 
## ICC|mother_pidlink                     0.262 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-93" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-23" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-94" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.344     0.056     0.234     0.454     6.126    13.074     0.000     4.872     0.851 
## birth_order_nonlinear2        0.010     0.019    -0.027     0.047     0.527    33.574     0.602     1.074     0.544 
## birth_order_nonlinear3        0.020     0.027    -0.032     0.072     0.742    27.854     0.464     1.317     0.596 
## birth_order_nonlinear4        0.042     0.039    -0.034     0.119     1.086    24.300     0.288     1.555     0.637 
## birth_order_nonlinear5        0.042     0.054    -0.063     0.147     0.781    39.030     0.439     0.924     0.505 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.022    -0.005    -3.141    28.852     0.004     1.265     0.586 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.577    33.401     0.568     1.079     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.471    26.922     0.153     1.371     0.606 
## male                         -0.043     0.014    -0.070    -0.016    -3.153    88.934     0.002     0.467     0.333 
## sibling_count3               -0.009     0.026    -0.061     0.042    -0.355    27.103     0.725     1.360     0.604 
## sibling_count4               -0.054     0.033    -0.118     0.010    -1.647    28.290     0.111     1.294     0.592 
## sibling_count5               -0.117     0.032    -0.181    -0.053    -3.600    94.160     0.001     0.448     0.323 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-94" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-256-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-23" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-95" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.334     0.055     0.227     0.442     6.099    14.565     0.000     3.674     0.810 
## count_birth_order2/2          0.021     0.029    -0.035     0.078     0.744    25.644     0.464     1.454     0.621 
## count_birth_order1/3         -0.002     0.040    -0.081     0.076    -0.058    22.098     0.954     1.764     0.667 
## count_birth_order2/3         -0.000     0.034    -0.068     0.067    -0.005    27.971     0.996     1.311     0.595 
## count_birth_order3/3          0.019     0.033    -0.046     0.085     0.585    38.885     0.562     0.927     0.506 
## count_birth_order1/4         -0.045     0.044    -0.132     0.042    -1.016    43.692     0.315     0.831     0.477 
## count_birth_order2/4         -0.042     0.051    -0.143     0.058    -0.829    20.531     0.416     1.959     0.691 
## count_birth_order3/4         -0.039     0.041    -0.119     0.042    -0.947    41.027     0.349     0.881     0.493 
## count_birth_order4/4         -0.003     0.051    -0.102     0.097    -0.056    22.554     0.956     1.715     0.661 
## count_birth_order1/5         -0.107     0.057    -0.218     0.004    -1.886    59.243     0.064     0.639     0.409 
## count_birth_order2/5         -0.126     0.051    -0.227    -0.025    -2.452    66.073     0.017     0.585     0.387 
## count_birth_order3/5         -0.091     0.056    -0.200     0.018    -1.633    35.510     0.111     1.014     0.529 
## count_birth_order4/5         -0.065     0.062    -0.186     0.055    -1.061    25.016     0.299     1.499     0.628 
## count_birth_order5/5         -0.067     0.055    -0.174     0.040    -1.230    48.161     0.225     0.761     0.454 
## poly(age, 3, raw = TRUE)1    -0.012     0.004    -0.021    -0.004    -2.808    27.721     0.009     1.324     0.598 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.421    33.294     0.676     1.083     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.372    28.142     0.181     1.302     0.593 
## male                         -0.044     0.014    -0.071    -0.016    -3.065    76.497     0.003     0.522     0.360 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-95" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-258-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-23" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.381       6  54.409   0.888 235.766 
##  2 vs 3:   0.388       3  27.087   0.762 490.723 
##  3 vs 4:   0.350       1   9.046   0.569 171.110</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-11" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2007-young" class="section level3 tabset">
<h3>g-factor 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-12" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-24" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-96" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.495     0.047    -0.587    -0.404   -10.631    13.647     0.000     4.322     0.835 
## poly(age, 3, raw = TRUE)1     0.025     0.005     0.015     0.035     4.943    19.539     0.000     2.112     0.707 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.281    31.105     0.210     1.164     0.565 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.529    43.576     0.015     0.833     0.478 
## male                         -0.002     0.014    -0.029     0.025    -0.172   109.598     0.864     0.402     0.299 
## sibling_count3                0.004     0.023    -0.040     0.048     0.174    73.080     0.862     0.541     0.368 
## sibling_count4               -0.047     0.033    -0.111     0.018    -1.424    25.351     0.167     1.474     0.624 
## sibling_count5               -0.027     0.027    -0.080     0.025    -1.020   197.770     0.309     0.271     0.221 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.245 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-96" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-24" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-97" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.537     0.049    -0.633    -0.441   -10.972    17.095     0.000     2.644     0.753 
## birth_order                   0.017     0.011    -0.004     0.037     1.568    21.915     0.131     1.784     0.670 
## poly(age, 3, raw = TRUE)1     0.028     0.005     0.018     0.037     5.658    23.876     0.000     1.590     0.643 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.970    38.534     0.338     0.935     0.508 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.277    52.791     0.027     0.703     0.434 
## male                         -0.003     0.014    -0.030     0.024    -0.207   113.620     0.836     0.392     0.294 
## sibling_count3               -0.007     0.023    -0.053     0.039    -0.295    66.450     0.769     0.582     0.386 
## sibling_count4               -0.069     0.036    -0.139     0.002    -1.918    24.577     0.067     1.533     0.634 
## sibling_count5               -0.060     0.031    -0.121     0.001    -1.924   135.149     0.056     0.348     0.269 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.245 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-97" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-264-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-24" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-98" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.525     0.050    -0.622    -0.427   -10.523    14.960     0.000     3.457     0.801 
## birth_order_nonlinear2        0.024     0.021    -0.018     0.066     1.138    24.561     0.266     1.534     0.634 
## birth_order_nonlinear3        0.025     0.024    -0.021     0.071     1.078    47.802     0.287     0.767     0.456 
## birth_order_nonlinear4        0.048     0.035    -0.020     0.116     1.376    32.992     0.178     1.093     0.549 
## birth_order_nonlinear5        0.081     0.059    -0.033     0.196     1.391    21.341     0.179     1.852     0.678 
## poly(age, 3, raw = TRUE)1     0.028     0.005     0.018     0.037     5.677    24.398     0.000     1.547     0.636 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.952    41.048     0.346     0.881     0.492 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.273    58.657     0.027     0.644     0.411 
## male                         -0.003     0.014    -0.030     0.024    -0.217   120.508     0.828     0.376     0.285 
## sibling_count3               -0.003     0.024    -0.050     0.045    -0.103    65.084     0.918     0.592     0.390 
## sibling_count4               -0.064     0.034    -0.131     0.003    -1.875    30.432     0.070     1.192     0.571 
## sibling_count5               -0.059     0.033    -0.124     0.005    -1.815   102.229     0.073     0.422     0.310 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.245 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-98" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-266-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-24" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-99" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.537     0.052    -0.638    -0.436   -10.431    16.032     0.000     2.988     0.776 
## count_birth_order2/2          0.038     0.027    -0.015     0.091     1.389    34.772     0.174     1.036     0.535 
## count_birth_order1/3          0.008     0.035    -0.059     0.076     0.238    40.323     0.813     0.896     0.497 
## count_birth_order2/3          0.011     0.037    -0.063     0.084     0.283    29.943     0.779     1.214     0.576 
## count_birth_order3/3          0.040     0.033    -0.025     0.105     1.216    45.451     0.230     0.802     0.468 
## count_birth_order1/4         -0.051     0.043    -0.135     0.033    -1.198    43.130     0.238     0.841     0.480 
## count_birth_order2/4         -0.017     0.046    -0.108     0.074    -0.370    31.159     0.714     1.162     0.565 
## count_birth_order3/4         -0.064     0.038    -0.139     0.011    -1.675    67.196     0.099     0.577     0.384 
## count_birth_order4/4         -0.003     0.056    -0.113     0.108    -0.045    17.081     0.964     2.648     0.753 
## count_birth_order1/5         -0.050     0.050    -0.147     0.048    -0.996    61.499     0.323     0.620     0.402 
## count_birth_order2/5         -0.039     0.052    -0.140     0.063    -0.748    53.159     0.458     0.699     0.432 
## count_birth_order3/5         -0.011     0.048    -0.104     0.083    -0.220    64.163     0.826     0.599     0.393 
## count_birth_order4/5         -0.020     0.044    -0.107     0.067    -0.444   103.962     0.658     0.417     0.307 
## count_birth_order5/5          0.028     0.049    -0.068     0.124     0.579    36.492     0.566     0.987     0.522 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.019     0.038     5.936    27.123     0.000     1.359     0.604 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.733    49.327     0.467     0.746     0.449 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.110    77.334     0.038     0.518     0.358 
## male                         -0.003     0.014    -0.030     0.024    -0.217   118.362     0.828     0.381     0.288 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.245 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-99" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-24" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.397       6 114.002   0.880   1.993 
##  2 vs 3:   0.312       3  42.125   0.817   3.221 
##  3 vs 4:   1.238       1  10.783   0.290   4.722</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-12" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-25" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-100" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.506     0.045    -0.593    -0.418   -11.354    13.668     0.000     4.304     0.834 
## poly(age, 3, raw = TRUE)1     0.027     0.005     0.017     0.037     5.223    16.329     0.000     2.882     0.769 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.551    20.937     0.588     1.904     0.684 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.487    20.116     0.152     2.020     0.698 
## male                          0.001     0.014    -0.025     0.028     0.081    64.814     0.936     0.594     0.391 
## sibling_count3                0.004     0.024    -0.043     0.051     0.162    26.965     0.872     1.368     0.606 
## sibling_count4               -0.038     0.027    -0.091     0.016    -1.380    34.536     0.177     1.043     0.537 
## sibling_count5               -0.099     0.027    -0.151    -0.046    -3.678   147.220     0.000     0.328     0.257 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.258 
## Residual~~Residual                     0.619 
## ICC|mother_pidlink                     0.294 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-100" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-271-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-25" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-101" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.556     0.041    -0.636    -0.476   -13.597    20.285     0.000     1.995     0.695 
## birth_order                   0.021     0.008     0.005     0.038     2.561    33.071     0.015     1.091     0.548 
## poly(age, 3, raw = TRUE)1     0.028     0.005     0.019     0.038     5.824    18.001     0.000     2.414     0.735 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.382    22.556     0.706     1.715     0.660 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.413    20.916     0.172     1.907     0.685 
## male                          0.001     0.014    -0.026     0.028     0.076    64.619     0.940     0.595     0.392 
## sibling_count3               -0.010     0.025    -0.059     0.039    -0.392    25.910     0.698     1.435     0.618 
## sibling_count4               -0.065     0.030    -0.125    -0.005    -2.138    30.206     0.041     1.202     0.573 
## sibling_count5               -0.135     0.027    -0.189    -0.081    -4.912   475.652     0.000     0.159     0.141 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.258 
## Residual~~Residual                     0.619 
## ICC|mother_pidlink                     0.294 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-101" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-273-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-25" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-102" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.525     0.045    -0.614    -0.436   -11.577    15.731     0.000     3.105     0.782 
## birth_order_nonlinear2        0.015     0.016    -0.018     0.047     0.887    51.355     0.379     0.720     0.440 
## birth_order_nonlinear3        0.031     0.021    -0.011     0.073     1.466    54.996     0.148     0.679     0.425 
## birth_order_nonlinear4        0.045     0.026    -0.006     0.097     1.728   190.690     0.086     0.278     0.225 
## birth_order_nonlinear5        0.064     0.063    -0.060     0.188     1.011    20.581     0.324     1.952     0.690 
## poly(age, 3, raw = TRUE)1     0.028     0.005     0.018     0.038     5.419    17.196     0.000     2.616     0.751 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.541    21.563     0.594     1.825     0.675 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.557    20.876     0.134     1.912     0.685 
## male                         -0.000     0.014    -0.028     0.027    -0.011    55.199     0.991     0.677     0.424 
## sibling_count3               -0.006     0.026    -0.058     0.046    -0.233    24.069     0.818     1.574     0.640 
## sibling_count4               -0.061     0.030    -0.120    -0.001    -2.000    33.387     0.054     1.080     0.546 
## sibling_count5               -0.127     0.029    -0.184    -0.069    -4.326   221.728     0.000     0.252     0.209 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.258 
## Residual~~Residual                     0.617 
## ICC|mother_pidlink                     0.295 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-102" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-275-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-25" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-103" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.545     0.045    -0.633    -0.457   -12.141    18.227     0.000     2.363     0.731 
## count_birth_order2/2          0.035     0.025    -0.014     0.085     1.396    32.350     0.172     1.116     0.554 
## count_birth_order1/3          0.011     0.031    -0.050     0.072     0.358    45.755     0.722     0.797     0.466 
## count_birth_order2/3          0.004     0.027    -0.048     0.057     0.153    76.818     0.879     0.520     0.359 
## count_birth_order3/3          0.040     0.032    -0.023     0.104     1.247    36.780     0.220     0.979     0.520 
## count_birth_order1/4         -0.056     0.038    -0.131     0.019    -1.475    83.901     0.144     0.487     0.343 
## count_birth_order2/4         -0.041     0.042    -0.123     0.041    -0.973    31.234     0.338     1.159     0.564 
## count_birth_order3/4         -0.035     0.035    -0.104     0.034    -0.993    78.627     0.324     0.511     0.355 
## count_birth_order4/4          0.013     0.038    -0.061     0.087     0.349    61.741     0.729     0.618     0.401 
## count_birth_order1/5         -0.096     0.054    -0.202     0.011    -1.762    57.563     0.083     0.654     0.415 
## count_birth_order2/5         -0.135     0.047    -0.228    -0.042    -2.850    90.749     0.005     0.460     0.330 
## count_birth_order3/5         -0.070     0.053    -0.174     0.034    -1.322    36.416     0.194     0.989     0.523 
## count_birth_order4/5         -0.098     0.046    -0.187    -0.009    -2.153    85.056     0.034     0.482     0.341 
## count_birth_order5/5         -0.046     0.059    -0.163     0.070    -0.779    28.610     0.442     1.277     0.589 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.020     0.039     6.002    19.907     0.000     2.052     0.701 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.264    25.827     0.794     1.441     0.619 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.371    23.422     0.184     1.631     0.649 
## male                         -0.000     0.014    -0.028     0.027    -0.013    59.689     0.990     0.635     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.258 
## Residual~~Residual                     0.615 
## ICC|mother_pidlink                     0.296 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-103" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-25" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.363       6  54.410   0.899 235.409 
##  2 vs 3:   0.394       3  27.087   0.758 491.091 
##  3 vs 4:   0.365       1   9.046   0.560 170.056</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-12" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-279-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2007-young" class="section level3 tabset">
<h3>Raven 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-13" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-26" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-104" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.542     0.044    -0.629    -0.455   -12.200    14.126     0.000     3.956     0.822 
## poly(age, 3, raw = TRUE)1     0.028     0.005     0.018     0.038     5.416    18.889     0.000     2.229     0.719 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.777    23.682     0.445     1.607     0.645 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.761    29.464     0.089     1.236     0.580 
## male                          0.023     0.014    -0.005     0.050     1.618    85.259     0.109     0.481     0.340 
## sibling_count3               -0.001     0.022    -0.045     0.043    -0.043    66.705     0.966     0.581     0.385 
## sibling_count4               -0.037     0.033    -0.102     0.028    -1.116    24.115     0.275     1.570     0.640 
## sibling_count5               -0.038     0.028    -0.093     0.017    -1.354   104.768     0.179     0.415     0.306 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.234 
## Residual~~Residual                     0.608 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-104" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-26" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-105" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.572     0.043    -0.657    -0.487   -13.196    20.763     0.000     1.927     0.687 
## birth_order                   0.012     0.010    -0.008     0.032     1.182    23.774     0.249     1.599     0.644 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.020     0.039     6.013    22.726     0.000     1.698     0.658 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.561    26.453     0.580     1.400     0.612 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.583    32.362     0.123     1.116     0.554 
## male                          0.022     0.014    -0.005     0.050     1.595    86.083     0.114     0.478     0.339 
## sibling_count3               -0.009     0.023    -0.054     0.037    -0.377    62.263     0.708     0.613     0.399 
## sibling_count4               -0.053     0.036    -0.123     0.018    -1.469    23.676     0.155     1.608     0.645 
## sibling_count5               -0.061     0.031    -0.123     0.000    -1.960   112.103     0.053     0.395     0.296 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.234 
## Residual~~Residual                     0.608 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-105" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-26" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-106" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.561     0.044    -0.648    -0.475   -12.775    17.461     0.000     2.545     0.746 
## birth_order_nonlinear2        0.016     0.021    -0.026     0.058     0.731    24.304     0.472     1.554     0.637 
## birth_order_nonlinear3        0.011     0.023    -0.035     0.056     0.464    48.589     0.645     0.756     0.452 
## birth_order_nonlinear4        0.036     0.035    -0.033     0.105     1.024    30.481     0.314     1.190     0.571 
## birth_order_nonlinear5        0.069     0.054    -0.038     0.175     1.267    25.162     0.217     1.488     0.627 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.020     0.039     6.045    23.686     0.000     1.607     0.645 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.589    27.862     0.560     1.317     0.596 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.623    34.605     0.114     1.041     0.536 
## male                          0.022     0.014    -0.005     0.050     1.595    90.212     0.114     0.462     0.331 
## sibling_count3               -0.003     0.024    -0.051     0.045    -0.127    57.232     0.900     0.657     0.417 
## sibling_count4               -0.048     0.035    -0.116     0.020    -1.389    27.711     0.176     1.325     0.598 
## sibling_count5               -0.063     0.032    -0.125    -0.000    -1.960   110.761     0.053     0.399     0.298 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.234 
## Residual~~Residual                     0.608 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-106" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-26" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-107" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.572     0.044    -0.658    -0.486   -13.054    20.579     0.000     1.953     0.690 
## count_birth_order2/2          0.025     0.023    -0.020     0.071     1.084    77.249     0.282     0.518     0.358 
## count_birth_order1/3          0.003     0.032    -0.059     0.065     0.102    60.210     0.919     0.630     0.406 
## count_birth_order2/3          0.000     0.036    -0.070     0.071     0.011    32.521     0.991     1.110     0.553 
## count_birth_order3/3          0.024     0.033    -0.040     0.088     0.748    45.606     0.458     0.799     0.467 
## count_birth_order1/4         -0.041     0.043    -0.126     0.043    -0.959    39.511     0.343     0.913     0.502 
## count_birth_order2/4         -0.014     0.047    -0.106     0.078    -0.297    28.867     0.769     1.264     0.586 
## count_birth_order3/4         -0.059     0.038    -0.133     0.015    -1.560    65.702     0.124     0.588     0.388 
## count_birth_order4/4         -0.000     0.053    -0.104     0.103    -0.003    18.627     0.997     2.280     0.723 
## count_birth_order1/5         -0.050     0.045    -0.140     0.039    -1.111   121.261     0.269     0.374     0.284 
## count_birth_order2/5         -0.040     0.049    -0.136     0.055    -0.833    75.967     0.407     0.525     0.361 
## count_birth_order3/5         -0.045     0.043    -0.129     0.039    -1.046   158.236     0.297     0.313     0.248 
## count_birth_order4/5         -0.037     0.049    -0.133     0.059    -0.748    48.038     0.458     0.763     0.455 
## count_birth_order5/5          0.010     0.048    -0.084     0.105     0.212    37.303     0.833     0.965     0.516 
## poly(age, 3, raw = TRUE)1     0.031     0.005     0.021     0.040     6.257    25.752     0.000     1.446     0.620 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.390    29.892     0.699     1.216     0.576 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.455    38.369     0.154     0.939     0.509 
## male                          0.022     0.014    -0.005     0.050     1.594    88.761     0.115     0.467     0.333 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.234 
## Residual~~Residual                     0.607 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-107" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-26" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.353       6 119.618   0.907   1.850 
##  2 vs 3:   0.395       3  42.216   0.757   3.204 
##  3 vs 4:   0.704       1  10.880   0.420   4.496</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-13" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-27" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-108" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.553     0.044    -0.639    -0.467   -12.572    13.697     0.000     4.280     0.833 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.019     0.038     5.825    17.111     0.000     2.640     0.753 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.357    19.790     0.725     2.071     0.703 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.203    20.234     0.243     2.002     0.696 
## male                          0.030     0.014     0.004     0.057     2.227    57.948     0.030     0.650     0.414 
## sibling_count3               -0.001     0.022    -0.044     0.042    -0.032    35.351     0.974     1.018     0.530 
## sibling_count4               -0.041     0.025    -0.090     0.008    -1.652    49.684     0.105     0.741     0.447 
## sibling_count5               -0.095     0.026    -0.146    -0.045    -3.724   234.493     0.000     0.244     0.203 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.243 
## Residual~~Residual                     0.615 
## ICC|mother_pidlink                     0.283 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-108" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-27" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-109" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.588     0.040    -0.665    -0.510   -14.808    21.084     0.000     1.885     0.682 
## birth_order                   0.015     0.009    -0.003     0.033     1.645    24.242     0.113     1.560     0.638 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.020     0.039     6.307    18.785     0.000     2.249     0.720 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.245    20.983     0.809     1.898     0.684 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.157    21.114     0.260     1.881     0.682 
## male                          0.030     0.014     0.004     0.057     2.216    57.474     0.031     0.655     0.416 
## sibling_count3               -0.010     0.024    -0.058     0.037    -0.426    27.591     0.673     1.332     0.599 
## sibling_count4               -0.060     0.029    -0.117    -0.003    -2.057    33.128     0.048     1.089     0.548 
## sibling_count5               -0.121     0.031    -0.182    -0.060    -3.899    75.558     0.000     0.527     0.362 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.243 
## Residual~~Residual                     0.615 
## ICC|mother_pidlink                     0.283 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-109" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-27" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-110" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.564     0.043    -0.648    -0.479   -13.083    16.607     0.000     2.790     0.763 
## birth_order_nonlinear2        0.009     0.016    -0.023     0.042     0.561    49.592     0.577     0.742     0.448 
## birth_order_nonlinear3        0.023     0.024    -0.024     0.070     0.948    32.362     0.350     1.116     0.554 
## birth_order_nonlinear4        0.029     0.028    -0.025     0.084     1.047    95.034     0.298     0.445     0.322 
## birth_order_nonlinear5        0.031     0.067    -0.100     0.162     0.461    18.372     0.650     2.332     0.728 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.020     0.038     6.056    18.919     0.000     2.223     0.718 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.439    21.239     0.665     1.865     0.680 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.331    20.850     0.198     1.916     0.686 
## male                          0.029     0.014     0.002     0.057     2.100    55.163     0.040     0.678     0.424 
## sibling_count3               -0.008     0.025    -0.058     0.042    -0.319    26.112     0.753     1.422     0.615 
## sibling_count4               -0.056     0.029    -0.112    -0.000    -1.964    39.920     0.056     0.904     0.499 
## sibling_count5               -0.112     0.032    -0.175    -0.050    -3.526    78.279     0.001     0.513     0.355 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.243 
## Residual~~Residual                     0.612 
## ICC|mother_pidlink                     0.284 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-110" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-27" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-111" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.579     0.043    -0.663    -0.496   -13.600    19.622     0.000     2.098     0.706 
## count_birth_order2/2          0.024     0.024    -0.024     0.072     0.984    36.171     0.332     0.995     0.524 
## count_birth_order1/3          0.001     0.030    -0.059     0.060     0.020    48.597     0.984     0.755     0.452 
## count_birth_order2/3         -0.003     0.027    -0.056     0.050    -0.111    63.538     0.912     0.603     0.395 
## count_birth_order3/3          0.028     0.029    -0.029     0.085     0.973    62.211     0.334     0.614     0.399 
## count_birth_order1/4         -0.048     0.045    -0.135     0.039    -1.081    33.991     0.287     1.060     0.541 
## count_birth_order2/4         -0.045     0.041    -0.126     0.035    -1.108    32.541     0.276     1.109     0.553 
## count_birth_order3/4         -0.045     0.034    -0.111     0.021    -1.324   107.888     0.188     0.406     0.302 
## count_birth_order4/4         -0.005     0.037    -0.076     0.067    -0.126    69.042     0.900     0.565     0.379 
## count_birth_order1/5         -0.102     0.051    -0.203    -0.001    -1.982    80.386     0.051     0.503     0.351 
## count_birth_order2/5         -0.123     0.042    -0.206    -0.040    -2.905   338.228     0.004     0.195     0.168 
## count_birth_order3/5         -0.063     0.051    -0.164     0.037    -1.242    41.268     0.221     0.876     0.491 
## count_birth_order4/5         -0.101     0.057    -0.213     0.011    -1.771    27.000     0.088     1.366     0.606 
## count_birth_order5/5         -0.066     0.055    -0.175     0.042    -1.198    35.570     0.239     1.012     0.529 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.021     0.040     6.551    21.791     0.000     1.798     0.671 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.213    25.011     0.833     1.499     0.628 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.212    24.516     0.237     1.537     0.635 
## male                          0.029     0.014     0.002     0.056     2.100    64.244     0.040     0.598     0.393 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.243 
## Residual~~Residual                     0.610 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-111" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-296-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-27" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.355       6  54.410   0.904 235.537 
##  2 vs 3:   0.403       3  27.087   0.752 491.222 
##  3 vs 4:   0.353       1   9.046   0.567 170.470</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-13" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2007-young" class="section level3 tabset">
<h3>Numeracy 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-14" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-28" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-112" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.316     0.048    -0.411    -0.221    -6.520    13.674     0.000     4.299     0.834 
## poly(age, 3, raw = TRUE)1     0.016     0.005     0.006     0.026     3.074    20.539     0.006     1.958     0.691 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.347    36.995     0.186     0.973     0.519 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.338    44.527     0.024     0.817     0.473 
## male                         -0.027     0.015    -0.056     0.003    -1.777    74.217     0.080     0.534     0.365 
## sibling_count3                0.008     0.022    -0.035     0.050     0.356   154.537     0.722     0.318     0.251 
## sibling_count4               -0.044     0.032    -0.108     0.019    -1.368    29.657     0.181     1.227     0.578 
## sibling_count5               -0.010     0.030    -0.068     0.048    -0.331    95.083     0.742     0.444     0.322 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.260 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-112" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-300-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-28" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-113" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.357     0.057    -0.468    -0.246    -6.307    14.861     0.000     3.509     0.803 
## birth_order                   0.017     0.010    -0.004     0.037     1.611    25.283     0.120     1.479     0.625 
## poly(age, 3, raw = TRUE)1     0.018     0.005     0.008     0.029     3.473    21.970     0.002     1.778     0.669 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.002    41.431     0.322     0.873     0.490 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.036    47.066     0.047     0.777     0.460 
## male                         -0.027     0.015    -0.057     0.002    -1.815    76.494     0.073     0.522     0.360 
## sibling_count3               -0.003     0.023    -0.048     0.042    -0.140   101.613     0.889     0.424     0.311 
## sibling_count4               -0.066     0.035    -0.135     0.002    -1.890    29.007     0.069     1.257     0.585 
## sibling_count5               -0.043     0.035    -0.111     0.025    -1.240    74.982     0.219     0.530     0.363 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.260 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-113" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-28" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-114" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.347     0.056    -0.456    -0.238    -6.228    13.880     0.000     4.135     0.828 
## birth_order_nonlinear2        0.027     0.020    -0.013     0.067     1.318    33.337     0.196     1.082     0.546 
## birth_order_nonlinear3        0.033     0.024    -0.013     0.080     1.404    59.585     0.165     0.636     0.408 
## birth_order_nonlinear4        0.047     0.033    -0.019     0.112     1.399    47.206     0.168     0.775     0.459 
## birth_order_nonlinear5        0.073     0.062    -0.049     0.194     1.174    20.868     0.254     1.913     0.685 
## poly(age, 3, raw = TRUE)1     0.019     0.005     0.008     0.029     3.538    22.617     0.002     1.709     0.660 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.952    46.299     0.346     0.789     0.464 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.011    55.077     0.049     0.679     0.425 
## male                         -0.027     0.015    -0.057     0.002    -1.829    79.015     0.071     0.509     0.354 
## sibling_count3               -0.001     0.023    -0.046     0.044    -0.056   151.346     0.955     0.323     0.254 
## sibling_count4               -0.063     0.034    -0.129     0.003    -1.862    36.896     0.071     0.976     0.519 
## sibling_count5               -0.040     0.036    -0.111     0.030    -1.122    66.124     0.266     0.585     0.387 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.260 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-114" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-304-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-28" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-115" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.358     0.057    -0.470    -0.246    -6.270    14.826     0.000     3.527     0.804 
## count_birth_order2/2          0.040     0.030    -0.019     0.099     1.333    27.840     0.193     1.318     0.597 
## count_birth_order1/3          0.011     0.035    -0.058     0.080     0.311    45.055     0.757     0.808     0.470 
## count_birth_order2/3          0.018     0.035    -0.051     0.087     0.517    45.788     0.608     0.796     0.466 
## count_birth_order3/3          0.045     0.033    -0.019     0.109     1.385    59.899     0.171     0.633     0.407 
## count_birth_order1/4         -0.047     0.043    -0.132     0.037    -1.097    51.388     0.278     0.720     0.440 
## count_birth_order2/4         -0.016     0.045    -0.104     0.073    -0.349    40.513     0.729     0.892     0.496 
## count_birth_order3/4         -0.052     0.040    -0.130     0.026    -1.301    68.140     0.198     0.571     0.381 
## count_birth_order4/4         -0.004     0.053    -0.108     0.100    -0.073    20.229     0.942     2.003     0.696 
## count_birth_order1/5         -0.035     0.052    -0.138     0.068    -0.665    57.898     0.508     0.651     0.414 
## count_birth_order2/5         -0.027     0.055    -0.134     0.081    -0.486    48.254     0.629     0.760     0.454 
## count_birth_order3/5          0.027     0.055    -0.081     0.134     0.485    38.400     0.630     0.938     0.509 
## count_birth_order4/5          0.002     0.045    -0.086     0.090     0.047   144.594     0.963     0.332     0.260 
## count_birth_order5/5          0.039     0.053    -0.065     0.143     0.739    31.832     0.465     1.136     0.559 
## poly(age, 3, raw = TRUE)1     0.019     0.005     0.009     0.030     3.763    25.621     0.001     1.455     0.621 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.796    62.026     0.429     0.615     0.400 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.909    75.393     0.060     0.528     0.362 
## male                         -0.027     0.015    -0.057     0.002    -1.828    77.848     0.071     0.515     0.356 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.260 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-115" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-306-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-28" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.354       6 112.341   0.906   2.040 
##  2 vs 3:   0.266       3  42.324   0.850   3.184 
##  3 vs 4:   1.261       1  10.910   0.285   4.430</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-14" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-29" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-116" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.323     0.043    -0.408    -0.238    -7.460    14.608     0.000     3.649     0.809 
## poly(age, 3, raw = TRUE)1     0.018     0.005     0.008     0.028     3.482    17.348     0.003     2.575     0.748 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.569    23.175     0.575     1.654     0.652 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.331    20.553     0.198     1.956     0.690 
## male                         -0.029     0.015    -0.057     0.000    -1.948    50.008     0.057     0.737     0.446 
## sibling_count3                0.007     0.026    -0.043     0.058     0.286    24.782     0.777     1.517     0.631 
## sibling_count4               -0.024     0.031    -0.085     0.037    -0.782    25.305     0.441     1.478     0.625 
## sibling_count5               -0.076     0.034    -0.143    -0.010    -2.249    36.875     0.031     0.976     0.519 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.271 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-116" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-29" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-117" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.375     0.047    -0.467    -0.282    -7.964    16.953     0.000     2.685     0.756 
## birth_order                   0.022     0.008     0.006     0.039     2.652    39.283     0.011     0.918     0.503 
## poly(age, 3, raw = TRUE)1     0.020     0.005     0.010     0.029     3.858    18.006     0.001     2.413     0.735 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.377    23.578     0.709     1.617     0.647 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.225    20.543     0.234     1.958     0.691 
## male                         -0.029     0.015    -0.057    -0.000    -1.962    51.975     0.055     0.713     0.437 
## sibling_count3               -0.007     0.026    -0.058     0.044    -0.263    25.564     0.795     1.459     0.622 
## sibling_count4               -0.053     0.032    -0.115     0.010    -1.653    28.979     0.109     1.259     0.585 
## sibling_count5               -0.113     0.035    -0.182    -0.044    -3.215    47.386     0.002     0.772     0.458 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.270 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-117" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-311-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-29" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-118" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.345     0.047    -0.437    -0.254    -7.425    16.001     0.000     3.000     0.776 
## birth_order_nonlinear2        0.016     0.016    -0.016     0.048     0.978    66.381     0.332     0.583     0.386 
## birth_order_nonlinear3        0.032     0.020    -0.007     0.071     1.614   163.860     0.108     0.306     0.244 
## birth_order_nonlinear4        0.050     0.030    -0.010     0.109     1.639    68.932     0.106     0.566     0.379 
## birth_order_nonlinear5        0.080     0.059    -0.035     0.195     1.367    27.525     0.183     1.335     0.600 
## poly(age, 3, raw = TRUE)1     0.019     0.005     0.009     0.029     3.667    17.719     0.002     2.481     0.740 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.473    23.821     0.640     1.595     0.643 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.327    21.678     0.198     1.812     0.673 
## male                         -0.030     0.015    -0.059     0.000    -1.954    45.766     0.057     0.797     0.466 
## sibling_count3               -0.003     0.027    -0.056     0.050    -0.102    25.124     0.920     1.491     0.627 
## sibling_count4               -0.049     0.032    -0.113     0.015    -1.509    29.891     0.142     1.216     0.576 
## sibling_count5               -0.108     0.037    -0.180    -0.036    -2.941    43.748     0.005     0.830     0.477 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.271 
## Residual~~Residual                     0.673 
## ICC|mother_pidlink                     0.287 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-118" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-313-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-29" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-119" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.364     0.046    -0.454    -0.275    -7.995    18.978     0.000     2.212     0.717 
## count_birth_order2/2          0.038     0.024    -0.010     0.085     1.556    48.475     0.126     0.757     0.453 
## count_birth_order1/3          0.019     0.031    -0.043     0.080     0.598    54.896     0.552     0.680     0.425 
## count_birth_order2/3          0.010     0.029    -0.046     0.066     0.346    63.556     0.731     0.603     0.395 
## count_birth_order3/3          0.042     0.035    -0.026     0.110     1.201    32.102     0.239     1.125     0.556 
## count_birth_order1/4         -0.049     0.042    -0.132     0.033    -1.173    55.519     0.246     0.674     0.423 
## count_birth_order2/4         -0.025     0.040    -0.105     0.054    -0.626    42.214     0.535     0.858     0.486 
## count_birth_order3/4         -0.016     0.040    -0.095     0.062    -0.403    45.608     0.689     0.799     0.467 
## count_birth_order4/4          0.028     0.044    -0.059     0.114     0.628    34.228     0.534     1.052     0.539 
## count_birth_order1/5         -0.065     0.057    -0.176     0.047    -1.130    54.644     0.263     0.683     0.426 
## count_birth_order2/5         -0.111     0.057    -0.223     0.001    -1.937    36.900     0.060     0.976     0.519 
## count_birth_order3/5         -0.059     0.058    -0.172     0.055    -1.015    30.869     0.318     1.174     0.567 
## count_birth_order4/5         -0.069     0.046    -0.159     0.021    -1.497   109.496     0.137     0.402     0.299 
## count_birth_order5/5         -0.014     0.061    -0.133     0.105    -0.228    30.169     0.821     1.204     0.574 
## poly(age, 3, raw = TRUE)1     0.021     0.005     0.011     0.030     4.171    21.197     0.000     1.870     0.680 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.214    28.991     0.832     1.258     0.585 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.130    23.548     0.270     1.619     0.647 
## male                         -0.029     0.015    -0.059     0.001    -1.910    45.872     0.062     0.795     0.466 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.271 
## Residual~~Residual                     0.671 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-119" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-315-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-29" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.395       6  54.410   0.879 235.227 
##  2 vs 3:   0.393       3  27.087   0.759 490.884 
##  3 vs 4:   0.418       1   9.046   0.534 170.235</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-14" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-317-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="personality" class="section level2 tabset">
<h2>Personality</h2>
<div id="extraversion" class="section level3 tabset">
<h3>Extraversion</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_ext)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-15" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-30" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-120" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.181     0.040     0.103     0.259     4.541    17.502     0.000     2.535     0.745 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.011     0.007    -0.386    28.653     0.702     1.275     0.588 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.253    40.854     0.802     0.885     0.494 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.646    54.829     0.521     0.681     0.426 
## male                         -0.257     0.020    -0.297    -0.218   -12.694    26.646     0.000     1.388     0.609 
## sibling_count3               -0.005     0.021    -0.046     0.037    -0.227    86.384     0.821     0.477     0.338 
## sibling_count4               -0.017     0.025    -0.065     0.032    -0.678    66.618     0.500     0.581     0.386 
## sibling_count5               -0.021     0.027    -0.074     0.032    -0.766    77.418     0.446     0.517     0.357 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.067 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-120" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-30" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-121" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.182     0.048     0.088     0.276     3.778    19.235     0.001     2.165     0.712 
## birth_order                  -0.000     0.009    -0.018     0.018    -0.039    75.529     0.969     0.527     0.362 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.011     0.008    -0.388    29.817     0.701     1.219     0.577 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.260    44.439     0.796     0.818     0.473 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.655    60.618     0.515     0.627     0.405 
## male                         -0.257     0.020    -0.297    -0.218   -12.674    26.546     0.000     1.394     0.611 
## sibling_count3               -0.005     0.020    -0.045     0.035    -0.224   183.165     0.823     0.285     0.230 
## sibling_count4               -0.016     0.027    -0.068     0.036    -0.613    83.527     0.542     0.489     0.344 
## sibling_count5               -0.020     0.031    -0.081     0.041    -0.640    94.794     0.524     0.445     0.322 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.067 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-121" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-30" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-122" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.174     0.048     0.080     0.268     3.612    16.686     0.002     2.765     0.761 
## birth_order_nonlinear2        0.013     0.021    -0.029     0.055     0.592    45.490     0.557     0.801     0.468 
## birth_order_nonlinear3       -0.004     0.028    -0.058     0.050    -0.154    49.033     0.878     0.750     0.450 
## birth_order_nonlinear4       -0.007     0.035    -0.076     0.063    -0.187    66.846     0.852     0.580     0.385 
## birth_order_nonlinear5        0.011     0.049    -0.086     0.108     0.223    92.099     0.824     0.455     0.327 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.011     0.008    -0.334    27.644     0.741     1.329     0.599 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.204    41.603     0.840     0.870     0.489 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.592    58.886     0.556     0.642     0.411 
## male                         -0.258     0.020    -0.297    -0.218   -12.653    26.384     0.000     1.404     0.612 
## sibling_count3               -0.001     0.022    -0.044     0.043    -0.032   115.980     0.975     0.386     0.291 
## sibling_count4               -0.010     0.028    -0.065     0.044    -0.365    76.595     0.716     0.522     0.359 
## sibling_count5               -0.017     0.031    -0.077     0.044    -0.547   156.962     0.585     0.315     0.249 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.067 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-122" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-30" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-123" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.046     0.089     0.269     3.905    21.608     0.001     1.820     0.674 
## count_birth_order2/2          0.006     0.029    -0.051     0.063     0.213    58.968     0.832     0.641     0.410 
## count_birth_order1/3         -0.004     0.030    -0.063     0.055    -0.132   244.094     0.895     0.238     0.199 
## count_birth_order2/3          0.004     0.040    -0.073     0.082     0.114    31.834     0.910     1.135     0.559 
## count_birth_order3/3         -0.004     0.033    -0.068     0.060    -0.125    75.147     0.901     0.529     0.363 
## count_birth_order1/4         -0.022     0.044    -0.108     0.064    -0.501    57.400     0.618     0.656     0.416 
## count_birth_order2/4          0.036     0.040    -0.043     0.115     0.889   115.641     0.376     0.387     0.291 
## count_birth_order3/4         -0.029     0.041    -0.109     0.052    -0.695    69.417     0.489     0.563     0.378 
## count_birth_order4/4         -0.032     0.041    -0.111     0.047    -0.789    60.619     0.433     0.627     0.405 
## count_birth_order1/5         -0.020     0.049    -0.115     0.075    -0.411   181.633     0.681     0.286     0.231 
## count_birth_order2/5         -0.037     0.049    -0.132     0.059    -0.753   236.660     0.452     0.242     0.202 
## count_birth_order3/5         -0.020     0.050    -0.119     0.079    -0.393    81.045     0.695     0.500     0.349 
## count_birth_order4/5         -0.004     0.057    -0.115     0.107    -0.069    38.040     0.946     0.947     0.511 
## count_birth_order5/5         -0.009     0.049    -0.105     0.087    -0.190    52.826     0.850     0.703     0.434 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.008    -0.395    28.946     0.696     1.260     0.585 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.261    41.758     0.795     0.867     0.488 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.639    58.849     0.525     0.642     0.411 
## male                         -0.258     0.020    -0.297    -0.218   -12.719    26.797     0.000     1.378     0.608 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.916 
## ICC|mother_pidlink                     0.068 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-123" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-325-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-30" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.387       6 117.901   0.886   1.891 
##  2 vs 3:   0.340       3  43.674   0.797   2.955 
##  3 vs 4:   0.190       1  11.502   0.671   3.458</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-15" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-31" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-124" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.170     0.034     0.103     0.237     4.975    21.046     0.000     1.890     0.683 
## poly(age, 3, raw = TRUE)1    -0.000     0.004    -0.009     0.008    -0.081    28.018     0.936     1.308     0.595 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.124    33.951     0.902     1.061     0.541 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.263    37.008     0.794     0.973     0.518 
## male                         -0.252     0.019    -0.289    -0.216   -13.556    26.625     0.000     1.389     0.610 
## sibling_count3               -0.009     0.019    -0.047     0.029    -0.480    67.564     0.633     0.575     0.383 
## sibling_count4               -0.013     0.025    -0.063     0.037    -0.517    39.006     0.608     0.924     0.505 
## sibling_count5               -0.030     0.027    -0.082     0.022    -1.145    86.910     0.255     0.474     0.337 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-124" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-328-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-31" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-125" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.149     0.044     0.063     0.236     3.389    18.844     0.003     2.237     0.719 
## birth_order                   0.010     0.010    -0.010     0.030     0.947    26.097     0.352     1.423     0.616 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.008     0.009     0.079    25.747     0.938     1.446     0.620 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.223    31.982     0.825     1.130     0.557 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.185    35.244     0.854     1.022     0.531 
## male                         -0.253     0.018    -0.289    -0.216   -13.698    27.429     0.000     1.341     0.601 
## sibling_count3               -0.015     0.021    -0.056     0.025    -0.734    54.129     0.466     0.689     0.428 
## sibling_count4               -0.025     0.029    -0.081     0.031    -0.869    34.167     0.391     1.054     0.539 
## sibling_count5               -0.048     0.031    -0.109     0.014    -1.517    62.972     0.134     0.608     0.397 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.062 
## Residual~~Residual                     0.921 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-125" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-31" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-126" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.039     0.087     0.242     4.174    20.969     0.000     1.900     0.684 
## birth_order_nonlinear2        0.001     0.016    -0.029     0.032     0.094   649.752     0.925     0.133     0.120 
## birth_order_nonlinear3        0.012     0.029    -0.045     0.069     0.397    28.223     0.695     1.297     0.593 
## birth_order_nonlinear4        0.030     0.039    -0.046     0.106     0.768    33.214     0.448     1.086     0.547 
## birth_order_nonlinear5        0.039     0.073    -0.105     0.182     0.526    20.628     0.605     1.946     0.689 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.008     0.009     0.042    26.866     0.967     1.374     0.607 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.163    34.545     0.872     1.043     0.537 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.263    38.310     0.794     0.941     0.510 
## male                         -0.253     0.018    -0.289    -0.216   -13.660    28.250     0.000     1.296     0.592 
## sibling_count3               -0.014     0.022    -0.057     0.029    -0.640    47.780     0.525     0.767     0.456 
## sibling_count4               -0.026     0.031    -0.086     0.035    -0.831    30.030     0.413     1.210     0.575 
## sibling_count5               -0.050     0.037    -0.123     0.023    -1.348    33.414     0.187     1.079     0.545 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.062 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.063 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-126" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-332-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-31" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-127" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.037     0.090     0.236     4.352    30.899     0.000     1.172     0.567 
## count_birth_order2/2          0.004     0.023    -0.041     0.048     0.157   215.961     0.875     0.257     0.211 
## count_birth_order1/3         -0.023     0.034    -0.090     0.044    -0.680    42.566     0.500     0.851     0.484 
## count_birth_order2/3         -0.011     0.030    -0.069     0.048    -0.355    62.156     0.724     0.614     0.400 
## count_birth_order3/3          0.001     0.034    -0.066     0.069     0.042    40.365     0.966     0.895     0.497 
## count_birth_order1/4         -0.012     0.045    -0.101     0.077    -0.264    49.019     0.793     0.750     0.450 
## count_birth_order2/4         -0.040     0.045    -0.128     0.047    -0.904    33.379     0.373     1.080     0.546 
## count_birth_order3/4         -0.017     0.039    -0.094     0.059    -0.442    66.900     0.660     0.579     0.385 
## count_birth_order4/4          0.006     0.046    -0.084     0.096     0.130    35.471     0.897     1.015     0.530 
## count_birth_order1/5         -0.056     0.065    -0.183     0.072    -0.853    37.629     0.399     0.957     0.514 
## count_birth_order2/5         -0.052     0.046    -0.142     0.039    -1.122   466.774     0.262     0.161     0.143 
## count_birth_order3/5         -0.033     0.055    -0.142     0.075    -0.599    44.034     0.552     0.825     0.475 
## count_birth_order4/5         -0.017     0.069    -0.152     0.118    -0.245    21.278     0.809     1.860     0.679 
## count_birth_order5/5         -0.021     0.063    -0.145     0.103    -0.327    31.219     0.746     1.159     0.564 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.008     0.009     0.124    32.426     0.902     1.113     0.554 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.224    40.271     0.824     0.897     0.497 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.219    41.846     0.828     0.865     0.488 
## male                         -0.253     0.019    -0.290    -0.216   -13.353    27.258     0.000     1.351     0.603 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.062 
## Residual~~Residual                     0.921 
## ICC|mother_pidlink                     0.063 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-127" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-334-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-31" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.428       6  54.410   0.857 235.574 
##  2 vs 3:   0.435       3  27.087   0.730 491.317 
##  3 vs 4:   0.459       1   9.046   0.515 170.793</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-15" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
</div>
</div>
<div id="neuroticism" class="section level3 tabset">
<h3>Neuroticism</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-16" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-32" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-128" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.029     0.122     0.235     6.229    41.948     0.000     0.863     0.487 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.014     0.003    -1.281    42.986     0.207     0.844     0.481 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.421    51.033     0.161     0.724     0.441 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.797    55.575     0.078     0.673     0.423 
## male                          0.022     0.016    -0.009     0.053     1.405    85.099     0.164     0.482     0.341 
## sibling_count3                0.017     0.024    -0.030     0.064     0.703    37.431     0.486     0.962     0.516 
## sibling_count4                0.001     0.026    -0.050     0.051     0.024    47.943     0.981     0.765     0.456 
## sibling_count5                0.002     0.025    -0.047     0.051     0.077   150.499     0.939     0.324     0.254 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-128" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-338-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-32" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-129" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.038     0.090     0.237     4.340    37.170     0.000     0.969     0.517 
## birth_order                   0.007     0.008    -0.010     0.023     0.801   154.855     0.424     0.318     0.251 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.004    -1.048    39.178     0.301     0.920     0.504 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.508    48.126     0.138     0.762     0.455 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.871    53.550     0.067     0.695     0.431 
## male                          0.022     0.016    -0.009     0.053     1.391    84.143     0.168     0.486     0.342 
## sibling_count3                0.013     0.024    -0.035     0.060     0.523    41.656     0.604     0.869     0.489 
## sibling_count4               -0.008     0.028    -0.062     0.047    -0.284    55.811     0.777     0.671     0.422 
## sibling_count5               -0.011     0.028    -0.066     0.045    -0.383   302.012     0.702     0.209     0.178 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-129" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-340-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-32" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-130" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.170     0.035     0.101     0.238     4.842    34.828     0.000     1.034     0.534 
## birth_order_nonlinear2        0.008     0.023    -0.038     0.054     0.339    30.917     0.737     1.172     0.567 
## birth_order_nonlinear3        0.010     0.023    -0.034     0.055     0.454   336.374     0.650     0.196     0.169 
## birth_order_nonlinear4        0.020     0.036    -0.050     0.090     0.562    63.558     0.576     0.603     0.395 
## birth_order_nonlinear5        0.030     0.056    -0.079     0.140     0.543    41.416     0.590     0.873     0.490 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.004    -1.064    42.083     0.293     0.860     0.486 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.511    51.119     0.137     0.723     0.441 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.865    55.194     0.067     0.677     0.424 
## male                          0.022     0.016    -0.009     0.053     1.385    82.618     0.170     0.493     0.346 
## sibling_count3                0.014     0.026    -0.038     0.066     0.533    35.792     0.597     1.006     0.527 
## sibling_count4               -0.006     0.028    -0.062     0.049    -0.229    62.029     0.820     0.615     0.400 
## sibling_count5               -0.011     0.029    -0.067     0.046    -0.363   341.857     0.717     0.194     0.167 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.910 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-130" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-342-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-32" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-131" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.166     0.036     0.096     0.237     4.642    48.572     0.000     0.756     0.453 
## count_birth_order2/2          0.017     0.029    -0.041     0.074     0.567    55.772     0.573     0.671     0.422 
## count_birth_order1/3          0.036     0.039    -0.040     0.113     0.931    32.249     0.359     1.120     0.555 
## count_birth_order2/3          0.014     0.040    -0.065     0.094     0.355    28.825     0.725     1.266     0.587 
## count_birth_order3/3          0.024     0.033    -0.040     0.088     0.731    70.196     0.467     0.558     0.376 
## count_birth_order1/4         -0.014     0.045    -0.102     0.073    -0.317    50.391     0.753     0.732     0.444 
## count_birth_order2/4          0.020     0.043    -0.064     0.104     0.467    66.791     0.642     0.580     0.385 
## count_birth_order3/4          0.016     0.046    -0.075     0.106     0.335    35.884     0.739     1.003     0.526 
## count_birth_order4/4          0.010     0.042    -0.073     0.094     0.242    44.526     0.810     0.817     0.473 
## count_birth_order1/5         -0.016     0.048    -0.111     0.079    -0.321   165.927     0.749     0.304     0.242 
## count_birth_order2/5         -0.010     0.049    -0.105     0.086    -0.199   199.653     0.843     0.270     0.220 
## count_birth_order3/5          0.009     0.051    -0.090     0.109     0.187    75.734     0.852     0.526     0.361 
## count_birth_order4/5          0.028     0.050    -0.069     0.126     0.565    77.071     0.573     0.519     0.358 
## count_birth_order5/5          0.024     0.055    -0.083     0.132     0.440    31.065     0.663     1.166     0.565 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.003    -1.151    58.964     0.254     0.641     0.410 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.522    72.003     0.132     0.547     0.371 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.886    73.879     0.063     0.536     0.366 
## male                          0.022     0.016    -0.009     0.053     1.397    85.493     0.166     0.480     0.340 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.910 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-131" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-32" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.265       6 122.987   0.952   1.775 
##  2 vs 3:   0.384       3  41.436   0.765   3.357 
##  3 vs 4:   0.668       1  11.683   0.430   3.246</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-16" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-33" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-132" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.187     0.025     0.137     0.237     7.340    60.654     0.000     0.627     0.405 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.807    39.358     0.078     0.916     0.503 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.300    46.484     0.200     0.786     0.463 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.876    48.566     0.067     0.756     0.453 
## male                          0.033     0.015     0.003     0.063     2.163    60.851     0.034     0.625     0.404 
## sibling_count3                0.008     0.019    -0.029     0.046     0.440    63.496     0.662     0.604     0.395 
## sibling_count4               -0.011     0.024    -0.057     0.035    -0.461    53.309     0.646     0.697     0.432 
## sibling_count5               -0.020     0.031    -0.081     0.041    -0.636    33.926     0.529     1.062     0.541 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-132" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-347-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-33" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-133" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.189     0.035     0.121     0.257     5.429    34.615     0.000     1.040     0.536 
## birth_order                  -0.001     0.009    -0.018     0.017    -0.086    44.591     0.932     0.816     0.472 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.784    37.023     0.083     0.973     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.265    45.086     0.212     0.808     0.470 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.847    47.690     0.071     0.768     0.457 
## male                          0.033     0.015     0.003     0.063     2.158    58.527     0.035     0.645     0.412 
## sibling_count3                0.009     0.020    -0.030     0.048     0.455    67.627     0.650     0.574     0.383 
## sibling_count4               -0.010     0.026    -0.062     0.041    -0.393    48.719     0.696     0.754     0.452 
## sibling_count5               -0.019     0.037    -0.091     0.053    -0.519    29.966     0.607     1.213     0.575 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-133" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-349-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-33" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-134" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.188     0.032     0.126     0.250     5.942    40.840     0.000     0.885     0.494 
## birth_order_nonlinear2       -0.003     0.018    -0.038     0.032    -0.158    74.085     0.875     0.535     0.365 
## birth_order_nonlinear3        0.001     0.027    -0.053     0.054     0.033    34.882     0.974     1.032     0.534 
## birth_order_nonlinear4       -0.017     0.036    -0.087     0.052    -0.491    49.167     0.625     0.748     0.450 
## birth_order_nonlinear5        0.015     0.064    -0.110     0.140     0.239    29.425     0.813     1.237     0.581 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.665    34.721     0.105     1.037     0.535 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.290    40.903     0.204     0.884     0.493 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.847    43.136     0.072     0.841     0.480 
## male                          0.034     0.016     0.003     0.065     2.169    56.983     0.034     0.660     0.418 
## sibling_count3                0.008     0.022    -0.035     0.051     0.354    46.577     0.725     0.784     0.462 
## sibling_count4               -0.007     0.028    -0.062     0.048    -0.251    42.831     0.803     0.846     0.482 
## sibling_count5               -0.020     0.038    -0.094     0.055    -0.512    29.813     0.613     1.219     0.577 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-134" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-351-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-33" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-135" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.186     0.033     0.121     0.251     5.638    51.749     0.000     0.715     0.438 
## count_birth_order2/2          0.003     0.028    -0.052     0.058     0.104    39.014     0.918     0.924     0.505 
## count_birth_order1/3          0.028     0.034    -0.037     0.094     0.846    44.433     0.402     0.818     0.473 
## count_birth_order2/3          0.000     0.032    -0.061     0.062     0.015    43.291     0.988     0.838     0.479 
## count_birth_order3/3          0.005     0.034    -0.062     0.073     0.150    38.620     0.882     0.933     0.508 
## count_birth_order1/4         -0.018     0.051    -0.117     0.082    -0.347    29.450     0.731     1.236     0.580 
## count_birth_order2/4          0.006     0.035    -0.063     0.075     0.168   163.072     0.866     0.307     0.244 
## count_birth_order3/4         -0.003     0.036    -0.074     0.068    -0.077   127.581     0.939     0.362     0.277 
## count_birth_order4/4         -0.023     0.041    -0.103     0.056    -0.577    62.550     0.566     0.611     0.398 
## count_birth_order1/5         -0.031     0.074    -0.176     0.114    -0.420    24.448     0.678     1.543     0.635 
## count_birth_order2/5         -0.028     0.055    -0.135     0.080    -0.503    56.094     0.617     0.668     0.421 
## count_birth_order3/5          0.003     0.060    -0.115     0.120     0.043    30.827     0.966     1.175     0.568 
## count_birth_order4/5         -0.032     0.049    -0.128     0.064    -0.658    91.348     0.513     0.457     0.328 
## count_birth_order5/5         -0.000     0.063    -0.125     0.124    -0.006    30.253     0.995     1.200     0.573 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.801    47.492     0.078     0.771     0.458 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.231    49.222     0.224     0.747     0.450 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.785    49.634     0.080     0.742     0.448 
## male                          0.033     0.015     0.003     0.063     2.152    72.850     0.035     0.542     0.369 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-135" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-353-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-33" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.425       6  54.410   0.859 235.403 
##  2 vs 3:   0.431       3  27.087   0.733 491.224 
##  3 vs 4:   0.440       1   9.046   0.524 170.232</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-16" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-355-1.png" width="672" /></p>
</div>
</div>
<div id="conscientiousness" class="section level3 tabset">
<h3>Conscientiousness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-17" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-34" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-136" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.029     0.122     0.235     6.229    41.948     0.000     0.863     0.487 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.014     0.003    -1.281    42.986     0.207     0.844     0.481 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.421    51.033     0.161     0.724     0.441 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.797    55.575     0.078     0.673     0.423 
## male                          0.022     0.016    -0.009     0.053     1.405    85.099     0.164     0.482     0.341 
## sibling_count3                0.017     0.024    -0.030     0.064     0.703    37.431     0.486     0.962     0.516 
## sibling_count4                0.001     0.026    -0.050     0.051     0.024    47.943     0.981     0.765     0.456 
## sibling_count5                0.002     0.025    -0.047     0.051     0.077   150.499     0.939     0.324     0.254 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-136" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-357-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-34" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-137" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.038     0.090     0.237     4.340    37.170     0.000     0.969     0.517 
## birth_order                   0.007     0.008    -0.010     0.023     0.801   154.855     0.424     0.318     0.251 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.004    -1.048    39.178     0.301     0.920     0.504 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.508    48.126     0.138     0.762     0.455 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.871    53.550     0.067     0.695     0.431 
## male                          0.022     0.016    -0.009     0.053     1.391    84.143     0.168     0.486     0.342 
## sibling_count3                0.013     0.024    -0.035     0.060     0.523    41.656     0.604     0.869     0.489 
## sibling_count4               -0.008     0.028    -0.062     0.047    -0.284    55.811     0.777     0.671     0.422 
## sibling_count5               -0.011     0.028    -0.066     0.045    -0.383   302.012     0.702     0.209     0.178 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-137" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-359-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-34" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-138" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.170     0.035     0.101     0.238     4.842    34.828     0.000     1.034     0.534 
## birth_order_nonlinear2        0.008     0.023    -0.038     0.054     0.339    30.917     0.737     1.172     0.567 
## birth_order_nonlinear3        0.010     0.023    -0.034     0.055     0.454   336.374     0.650     0.196     0.169 
## birth_order_nonlinear4        0.020     0.036    -0.050     0.090     0.562    63.558     0.576     0.603     0.395 
## birth_order_nonlinear5        0.030     0.056    -0.079     0.140     0.543    41.416     0.590     0.873     0.490 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.004    -1.064    42.083     0.293     0.860     0.486 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.511    51.119     0.137     0.723     0.441 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.865    55.194     0.067     0.677     0.424 
## male                          0.022     0.016    -0.009     0.053     1.385    82.618     0.170     0.493     0.346 
## sibling_count3                0.014     0.026    -0.038     0.066     0.533    35.792     0.597     1.006     0.527 
## sibling_count4               -0.006     0.028    -0.062     0.049    -0.229    62.029     0.820     0.615     0.400 
## sibling_count5               -0.011     0.029    -0.067     0.046    -0.363   341.857     0.717     0.194     0.167 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.910 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-138" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-361-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-34" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-139" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.166     0.036     0.096     0.237     4.642    48.572     0.000     0.756     0.453 
## count_birth_order2/2          0.017     0.029    -0.041     0.074     0.567    55.772     0.573     0.671     0.422 
## count_birth_order1/3          0.036     0.039    -0.040     0.113     0.931    32.249     0.359     1.120     0.555 
## count_birth_order2/3          0.014     0.040    -0.065     0.094     0.355    28.825     0.725     1.266     0.587 
## count_birth_order3/3          0.024     0.033    -0.040     0.088     0.731    70.196     0.467     0.558     0.376 
## count_birth_order1/4         -0.014     0.045    -0.102     0.073    -0.317    50.391     0.753     0.732     0.444 
## count_birth_order2/4          0.020     0.043    -0.064     0.104     0.467    66.791     0.642     0.580     0.385 
## count_birth_order3/4          0.016     0.046    -0.075     0.106     0.335    35.884     0.739     1.003     0.526 
## count_birth_order4/4          0.010     0.042    -0.073     0.094     0.242    44.526     0.810     0.817     0.473 
## count_birth_order1/5         -0.016     0.048    -0.111     0.079    -0.321   165.927     0.749     0.304     0.242 
## count_birth_order2/5         -0.010     0.049    -0.105     0.086    -0.199   199.653     0.843     0.270     0.220 
## count_birth_order3/5          0.009     0.051    -0.090     0.109     0.187    75.734     0.852     0.526     0.361 
## count_birth_order4/5          0.028     0.050    -0.069     0.126     0.565    77.071     0.573     0.519     0.358 
## count_birth_order5/5          0.024     0.055    -0.083     0.132     0.440    31.065     0.663     1.166     0.565 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.003    -1.151    58.964     0.254     0.641     0.410 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.522    72.003     0.132     0.547     0.371 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.886    73.879     0.063     0.536     0.366 
## male                          0.022     0.016    -0.009     0.053     1.397    85.493     0.166     0.480     0.340 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.910 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-139" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-363-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-34" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.265       6 122.987   0.952   1.775 
##  2 vs 3:   0.384       3  41.436   0.765   3.357 
##  3 vs 4:   0.668       1  11.683   0.430   3.246</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-17" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-35" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-140" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.187     0.025     0.137     0.237     7.340    60.654     0.000     0.627     0.405 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.807    39.358     0.078     0.916     0.503 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.300    46.484     0.200     0.786     0.463 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.876    48.566     0.067     0.756     0.453 
## male                          0.033     0.015     0.003     0.063     2.163    60.851     0.034     0.625     0.404 
## sibling_count3                0.008     0.019    -0.029     0.046     0.440    63.496     0.662     0.604     0.395 
## sibling_count4               -0.011     0.024    -0.057     0.035    -0.461    53.309     0.646     0.697     0.432 
## sibling_count5               -0.020     0.031    -0.081     0.041    -0.636    33.926     0.529     1.062     0.541 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-140" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-366-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-35" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-141" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.189     0.035     0.121     0.257     5.429    34.615     0.000     1.040     0.536 
## birth_order                  -0.001     0.009    -0.018     0.017    -0.086    44.591     0.932     0.816     0.472 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.784    37.023     0.083     0.973     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.265    45.086     0.212     0.808     0.470 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.847    47.690     0.071     0.768     0.457 
## male                          0.033     0.015     0.003     0.063     2.158    58.527     0.035     0.645     0.412 
## sibling_count3                0.009     0.020    -0.030     0.048     0.455    67.627     0.650     0.574     0.383 
## sibling_count4               -0.010     0.026    -0.062     0.041    -0.393    48.719     0.696     0.754     0.452 
## sibling_count5               -0.019     0.037    -0.091     0.053    -0.519    29.966     0.607     1.213     0.575 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-141" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-368-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-35" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-142" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.188     0.032     0.126     0.250     5.942    40.840     0.000     0.885     0.494 
## birth_order_nonlinear2       -0.003     0.018    -0.038     0.032    -0.158    74.085     0.875     0.535     0.365 
## birth_order_nonlinear3        0.001     0.027    -0.053     0.054     0.033    34.882     0.974     1.032     0.534 
## birth_order_nonlinear4       -0.017     0.036    -0.087     0.052    -0.491    49.167     0.625     0.748     0.450 
## birth_order_nonlinear5        0.015     0.064    -0.110     0.140     0.239    29.425     0.813     1.237     0.581 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.665    34.721     0.105     1.037     0.535 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.290    40.903     0.204     0.884     0.493 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.847    43.136     0.072     0.841     0.480 
## male                          0.034     0.016     0.003     0.065     2.169    56.983     0.034     0.660     0.418 
## sibling_count3                0.008     0.022    -0.035     0.051     0.354    46.577     0.725     0.784     0.462 
## sibling_count4               -0.007     0.028    -0.062     0.048    -0.251    42.831     0.803     0.846     0.482 
## sibling_count5               -0.020     0.038    -0.094     0.055    -0.512    29.813     0.613     1.219     0.577 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-142" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-370-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-35" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-143" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.186     0.033     0.121     0.251     5.638    51.749     0.000     0.715     0.438 
## count_birth_order2/2          0.003     0.028    -0.052     0.058     0.104    39.014     0.918     0.924     0.505 
## count_birth_order1/3          0.028     0.034    -0.037     0.094     0.846    44.433     0.402     0.818     0.473 
## count_birth_order2/3          0.000     0.032    -0.061     0.062     0.015    43.291     0.988     0.838     0.479 
## count_birth_order3/3          0.005     0.034    -0.062     0.073     0.150    38.620     0.882     0.933     0.508 
## count_birth_order1/4         -0.018     0.051    -0.117     0.082    -0.347    29.450     0.731     1.236     0.580 
## count_birth_order2/4          0.006     0.035    -0.063     0.075     0.168   163.072     0.866     0.307     0.244 
## count_birth_order3/4         -0.003     0.036    -0.074     0.068    -0.077   127.581     0.939     0.362     0.277 
## count_birth_order4/4         -0.023     0.041    -0.103     0.056    -0.577    62.550     0.566     0.611     0.398 
## count_birth_order1/5         -0.031     0.074    -0.176     0.114    -0.420    24.448     0.678     1.543     0.635 
## count_birth_order2/5         -0.028     0.055    -0.135     0.080    -0.503    56.094     0.617     0.668     0.421 
## count_birth_order3/5          0.003     0.060    -0.115     0.120     0.043    30.827     0.966     1.175     0.568 
## count_birth_order4/5         -0.032     0.049    -0.128     0.064    -0.658    91.348     0.513     0.457     0.328 
## count_birth_order5/5         -0.000     0.063    -0.125     0.124    -0.006    30.253     0.995     1.200     0.573 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.801    47.492     0.078     0.771     0.458 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.231    49.222     0.224     0.747     0.450 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.785    49.634     0.080     0.742     0.448 
## male                          0.033     0.015     0.003     0.063     2.152    72.850     0.035     0.542     0.369 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-143" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-372-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-35" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.425       6  54.410   0.859 235.403 
##  2 vs 3:   0.431       3  27.087   0.733 491.224 
##  3 vs 4:   0.440       1   9.046   0.524 170.232</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-17" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-374-1.png" width="672" /></p>
</div>
</div>
<div id="agreeableness" class="section level3 tabset">
<h3>Agreeableness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_agree)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-18" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-36" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-144" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.145     0.047    -0.237    -0.054    -3.106    14.404     0.008     3.772     0.815 
## poly(age, 3, raw = TRUE)1     0.001     0.006    -0.012     0.013     0.113    15.642     0.912     3.141     0.784 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.454    19.616     0.162     2.099     0.706 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.746    22.964     0.094     1.674     0.655 
## male                          0.020     0.017    -0.014     0.053     1.145    54.986     0.257     0.679     0.425 
## sibling_count3               -0.003     0.021    -0.045     0.039    -0.118    88.207     0.907     0.469     0.334 
## sibling_count4                0.025     0.023    -0.021     0.070     1.068   135.694     0.287     0.347     0.268 
## sibling_count5                0.002     0.024    -0.045     0.049     0.066   696.180     0.947     0.128     0.116 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-144" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-36" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-145" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.150     0.056    -0.260    -0.041    -2.699    15.578     0.016     3.168     0.786 
## birth_order                   0.002     0.009    -0.015     0.020     0.250    79.949     0.803     0.505     0.352 
## poly(age, 3, raw = TRUE)1     0.001     0.007    -0.012     0.014     0.147    15.639     0.885     3.143     0.785 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.395    19.569     0.179     2.107     0.707 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.693    22.849     0.104     1.685     0.656 
## male                          0.020     0.017    -0.014     0.053     1.145    55.450     0.257     0.675     0.423 
## sibling_count3               -0.004     0.023    -0.049     0.041    -0.172    69.850     0.864     0.560     0.377 
## sibling_count4                0.022     0.026    -0.029     0.073     0.850   120.093     0.397     0.377     0.286 
## sibling_count5               -0.003     0.029    -0.059     0.054    -0.088   359.766     0.930     0.188     0.163 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-145" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-378-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-36" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-146" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.147     0.052    -0.248    -0.045    -2.831    15.320     0.012     3.282     0.792 
## birth_order_nonlinear2        0.001     0.026    -0.049     0.052     0.042    23.627     0.967     1.612     0.646 
## birth_order_nonlinear3       -0.011     0.028    -0.066     0.043    -0.414    47.095     0.680     0.777     0.460 
## birth_order_nonlinear4        0.020     0.034    -0.048     0.087     0.579    82.726     0.564     0.492     0.345 
## birth_order_nonlinear5        0.015     0.056    -0.094     0.124     0.274    42.286     0.786     0.856     0.485 
## poly(age, 3, raw = TRUE)1     0.001     0.007    -0.012     0.014     0.119    16.174     0.907     2.936     0.772 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.472    20.961     0.156     1.901     0.684 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.781    24.909     0.087     1.507     0.630 
## male                          0.020     0.017    -0.014     0.053     1.151    55.681     0.255     0.672     0.422 
## sibling_count3                0.002     0.022    -0.042     0.046     0.081   117.965     0.935     0.382     0.288 
## sibling_count4                0.022     0.025    -0.028     0.072     0.869   252.767     0.386     0.233     0.195 
## sibling_count5               -0.004     0.030    -0.064     0.056    -0.127   226.821     0.899     0.249     0.206 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-146" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-380-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-36" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-147" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.139     0.050    -0.236    -0.042    -2.800    18.810     0.011     2.244     0.720 
## count_birth_order2/2         -0.011     0.035    -0.081     0.058    -0.316    25.539     0.754     1.461     0.622 
## count_birth_order1/3         -0.012     0.032    -0.075     0.050    -0.387   116.812     0.700     0.384     0.290 
## count_birth_order2/3          0.007     0.039    -0.069     0.083     0.182    34.914     0.857     1.031     0.534 
## count_birth_order3/3         -0.018     0.031    -0.078     0.043    -0.577   128.608     0.565     0.360     0.276 
## count_birth_order1/4          0.001     0.040    -0.077     0.079     0.024   136.046     0.981     0.346     0.268 
## count_birth_order2/4          0.022     0.038    -0.053     0.097     0.571   234.488     0.568     0.244     0.203 
## count_birth_order3/4          0.011     0.050    -0.087     0.108     0.215    29.222     0.831     1.247     0.583 
## count_birth_order4/4          0.039     0.043    -0.045     0.123     0.912    45.570     0.367     0.800     0.467 
## count_birth_order1/5          0.007     0.057    -0.104     0.119     0.126    48.956     0.900     0.751     0.451 
## count_birth_order2/5         -0.015     0.053    -0.118     0.088    -0.281    94.446     0.779     0.447     0.323 
## count_birth_order3/5         -0.026     0.049    -0.122     0.070    -0.533   110.273     0.595     0.400     0.298 
## count_birth_order4/5          0.004     0.064    -0.122     0.130     0.065    25.424     0.949     1.469     0.623 
## count_birth_order5/5          0.005     0.046    -0.085     0.096     0.118    81.290     0.906     0.499     0.349 
## poly(age, 3, raw = TRUE)1     0.000     0.006    -0.012     0.013     0.071    17.259     0.944     2.599     0.750 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.548    22.644     0.136     1.706     0.659 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.861    27.049     0.074     1.363     0.605 
## male                          0.020     0.017    -0.014     0.053     1.153    55.018     0.254     0.679     0.425 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-147" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-382-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-36" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.269       6 113.932   0.950   1.995 
##  2 vs 3:   0.284       3  40.934   0.837   3.465 
##  3 vs 4:   0.498       1  11.537   0.494   3.415</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-18" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-37" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-148" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.144     0.041    -0.224    -0.064    -3.527    15.834     0.003     3.064     0.780 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.008     0.011     0.349    19.459     0.731     2.126     0.709 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.020    30.420     0.052     1.193     0.571 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.696    37.102     0.010     0.971     0.518 
## male                          0.012     0.016    -0.019     0.044     0.776    46.463     0.441     0.786     0.463 
## sibling_count3               -0.005     0.021    -0.046     0.036    -0.235    43.480     0.816     0.835     0.478 
## sibling_count4               -0.004     0.021    -0.045     0.036    -0.215   245.264     0.830     0.237     0.198 
## sibling_count5                0.023     0.028    -0.031     0.078     0.834    67.961     0.407     0.572     0.382 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.081 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-148" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-385-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-37" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-149" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.154     0.051    -0.254    -0.054    -3.017    15.325     0.008     3.280     0.792 
## birth_order                   0.005     0.009    -0.013     0.023     0.527    36.214     0.602     0.994     0.524 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.008     0.012     0.387    18.943     0.703     2.218     0.718 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     1.989    30.296     0.056     1.198     0.572 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.700    38.096     0.010     0.946     0.511 
## male                          0.012     0.016    -0.020     0.044     0.746    44.182     0.460     0.823     0.475 
## sibling_count3               -0.008     0.022    -0.050     0.034    -0.365    44.654     0.717     0.815     0.472 
## sibling_count4               -0.011     0.024    -0.058     0.037    -0.440    96.232     0.661     0.441     0.320 
## sibling_count5                0.014     0.031    -0.048     0.075     0.437    68.380     0.664     0.569     0.381 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.081 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-149" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-37" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-150" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.144     0.045    -0.231    -0.056    -3.226    17.101     0.005     2.642     0.753 
## birth_order_nonlinear2       -0.001     0.022    -0.044     0.042    -0.043    28.795     0.966     1.268     0.587 
## birth_order_nonlinear3       -0.006     0.022    -0.050     0.038    -0.270   118.741     0.787     0.380     0.287 
## birth_order_nonlinear4        0.006     0.040    -0.073     0.085     0.152    28.977     0.880     1.259     0.585 
## birth_order_nonlinear5        0.058     0.057    -0.054     0.170     1.012    45.753     0.317     0.797     0.466 
## poly(age, 3, raw = TRUE)1     0.001     0.005    -0.008     0.011     0.306    21.377     0.763     1.848     0.678 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.220    39.387     0.032     0.916     0.503 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.926    47.867     0.005     0.766     0.456 
## male                          0.013     0.017    -0.020     0.046     0.750    39.992     0.458     0.903     0.499 
## sibling_count3               -0.003     0.022    -0.046     0.039    -0.161    55.678     0.872     0.672     0.422 
## sibling_count4               -0.007     0.025    -0.056     0.042    -0.271    98.110     0.787     0.434     0.317 
## sibling_count5                0.013     0.031    -0.048     0.074     0.419   103.065     0.676     0.419     0.309 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.082 
## Residual~~Residual                     0.906 
## ICC|mother_pidlink                     0.083 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-150" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-389-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-37" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-151" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.138     0.048    -0.232    -0.044    -2.881    17.527     0.010     2.528     0.744 
## count_birth_order2/2         -0.006     0.028    -0.062     0.049    -0.226    36.525     0.823     0.986     0.522 
## count_birth_order1/3         -0.007     0.035    -0.075     0.061    -0.199    39.658     0.843     0.910     0.501 
## count_birth_order2/3         -0.003     0.031    -0.063     0.057    -0.092    53.013     0.927     0.701     0.433 
## count_birth_order3/3         -0.020     0.033    -0.085     0.044    -0.616    49.200     0.541     0.747     0.450 
## count_birth_order1/4         -0.032     0.043    -0.116     0.052    -0.755    69.863     0.453     0.560     0.377 
## count_birth_order2/4         -0.020     0.038    -0.094     0.054    -0.522    81.261     0.603     0.499     0.349 
## count_birth_order3/4         -0.005     0.043    -0.089     0.080    -0.111    39.697     0.912     0.909     0.501 
## count_birth_order4/4          0.008     0.042    -0.074     0.091     0.198    51.949     0.843     0.713     0.437 
## count_birth_order1/5          0.024     0.058    -0.090     0.138     0.413    72.277     0.681     0.545     0.370 
## count_birth_order2/5          0.013     0.060    -0.105     0.132     0.219    36.667     0.828     0.982     0.521 
## count_birth_order3/5          0.016     0.052    -0.085     0.118     0.315    63.837     0.754     0.601     0.394 
## count_birth_order4/5         -0.005     0.052    -0.107     0.098    -0.087    58.158     0.931     0.648     0.413 
## count_birth_order5/5          0.061     0.058    -0.052     0.174     1.054    46.044     0.298     0.792     0.465 
## poly(age, 3, raw = TRUE)1     0.001     0.005    -0.009     0.011     0.194    20.375     0.848     1.982     0.693 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.245    36.202     0.031     0.994     0.524 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.004    48.760     0.004     0.753     0.452 
## male                          0.014     0.018    -0.021     0.048     0.789    34.616     0.435     1.040     0.536 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.083 
## Residual~~Residual                     0.904 
## ICC|mother_pidlink                     0.084 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-151" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-37" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.435       6  54.409   0.852 235.719 
##  2 vs 3:   0.459       3  27.087   0.713 491.313 
##  3 vs 4:   0.444       1   9.046   0.522 170.014</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-18" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
</div>
</div>
<div id="openness" class="section level3 tabset">
<h3>Openness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_open)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-19" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-38" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-152" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.090     0.036     0.019     0.161     2.484    20.786     0.022     1.924     0.687 
## poly(age, 3, raw = TRUE)1    -0.004     0.005    -0.014     0.006    -0.789    22.135     0.439     1.760     0.666 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.404    24.248     0.690     1.559     0.638 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.721    27.275     0.477     1.350     0.603 
## male                          0.017     0.018    -0.018     0.052     0.959    43.459     0.343     0.835     0.479 
## sibling_count3               -0.011     0.020    -0.051     0.029    -0.547   122.833     0.585     0.371     0.282 
## sibling_count4               -0.019     0.025    -0.069     0.031    -0.754    59.339     0.454     0.638     0.409 
## sibling_count5               -0.014     0.036    -0.084     0.056    -0.394    24.202     0.697     1.563     0.638 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.077 
## Residual~~Residual                     0.902 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-152" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-395-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-38" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-153" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.117     0.044     0.030     0.203     2.631    22.887     0.015     1.682     0.656 
## birth_order                  -0.012     0.009    -0.029     0.006    -1.286    80.810     0.202     0.501     0.350 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.016     0.005    -0.986    21.271     0.335     1.861     0.679 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.569    23.291     0.575     1.643     0.650 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.859    26.356     0.398     1.406     0.613 
## male                          0.017     0.018    -0.017     0.052     0.979    43.718     0.333     0.831     0.477 
## sibling_count3               -0.004     0.022    -0.046     0.038    -0.183   103.532     0.855     0.418     0.308 
## sibling_count4               -0.004     0.027    -0.058     0.049    -0.164    67.487     0.871     0.575     0.383 
## sibling_count5                0.008     0.039    -0.069     0.085     0.199    28.936     0.844     1.261     0.585 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.077 
## Residual~~Residual                     0.902 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-153" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-397-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-38" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-154" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.107     0.040     0.028     0.187     2.655    23.126     0.014     1.658     0.653 
## birth_order_nonlinear2       -0.015     0.019    -0.052     0.023    -0.772    96.091     0.442     0.441     0.320 
## birth_order_nonlinear3       -0.038     0.027    -0.091     0.015    -1.412    53.636     0.164     0.694     0.430 
## birth_order_nonlinear4       -0.016     0.038    -0.092     0.059    -0.429    41.603     0.670     0.870     0.489 
## birth_order_nonlinear5       -0.049     0.055    -0.157     0.060    -0.880    43.319     0.384     0.838     0.479 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.016     0.005    -1.029    21.873     0.315     1.789     0.670 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.609    23.585     0.548     1.616     0.646 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.896    26.295     0.379     1.410     0.613 
## male                          0.017     0.018    -0.017     0.052     0.984    44.604     0.330     0.816     0.472 
## sibling_count3                0.001     0.024    -0.045     0.047     0.045    68.884     0.965     0.566     0.379 
## sibling_count4               -0.007     0.028    -0.061     0.047    -0.244    86.101     0.808     0.478     0.338 
## sibling_count5                0.007     0.042    -0.076     0.089     0.161    25.985     0.874     1.430     0.617 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.077 
## Residual~~Residual                     0.902 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-154" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-399-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-38" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-155" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.113     0.039     0.037     0.188     2.929    36.083     0.006     0.998     0.525 
## count_birth_order2/2         -0.028     0.031    -0.088     0.032    -0.902    42.227     0.372     0.858     0.485 
## count_birth_order1/3         -0.017     0.038    -0.092     0.058    -0.450    35.498     0.655     1.014     0.529 
## count_birth_order2/3         -0.022     0.031    -0.083     0.039    -0.708   140.577     0.480     0.339     0.263 
## count_birth_order3/3         -0.032     0.032    -0.095     0.031    -0.999    83.461     0.321     0.489     0.344 
## count_birth_order1/4         -0.031     0.048    -0.126     0.063    -0.649    35.993     0.520     1.000     0.526 
## count_birth_order2/4          0.008     0.040    -0.070     0.086     0.194   125.431     0.846     0.366     0.279 
## count_birth_order3/4         -0.074     0.051    -0.175     0.026    -1.444    25.912     0.161     1.435     0.618 
## count_birth_order4/4         -0.024     0.043    -0.109     0.060    -0.563    41.877     0.577     0.864     0.487 
## count_birth_order1/5          0.028     0.053    -0.076     0.133     0.528    69.597     0.599     0.562     0.377 
## count_birth_order2/5         -0.030     0.052    -0.133     0.072    -0.581    94.068     0.562     0.448     0.324 
## count_birth_order3/5         -0.040     0.067    -0.172     0.092    -0.595    23.002     0.558     1.670     0.654 
## count_birth_order4/5         -0.027     0.062    -0.149     0.096    -0.425    26.903     0.674     1.372     0.607 
## count_birth_order5/5         -0.048     0.051    -0.148     0.051    -0.955    43.600     0.345     0.833     0.478 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.016     0.005    -1.039    25.998     0.309     1.429     0.617 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.614    29.386     0.544     1.239     0.581 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.923    33.240     0.363     1.085     0.547 
## male                          0.017     0.018    -0.017     0.052     0.986    44.670     0.329     0.814     0.472 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.901 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-155" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-401-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-38" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.399       6 112.454   0.878   2.037 
##  2 vs 3:   0.462       3  41.273   0.710   3.392 
##  3 vs 4:   0.960       1  11.546   0.347   3.404</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-19" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-39" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-156" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.084     0.039     0.007     0.160     2.149    16.840     0.046     2.718     0.758 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.004    -1.073    24.556     0.294     1.534     0.634 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.744    23.735     0.464     1.603     0.645 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.309    23.895     0.203     1.589     0.642 
## male                          0.025     0.017    -0.009     0.058     1.455    34.995     0.155     1.029     0.533 
## sibling_count3               -0.013     0.022    -0.055     0.030    -0.575    36.721     0.569     0.980     0.520 
## sibling_count4               -0.009     0.030    -0.069     0.050    -0.305    22.647     0.763     1.706     0.659 
## sibling_count5               -0.052     0.025    -0.101    -0.003    -2.071   195.043     0.040     0.274     0.223 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-156" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-404-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-39" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-157" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.085     0.043     0.002     0.169     1.998    20.111     0.059     2.021     0.698 
## birth_order                  -0.001     0.010    -0.020     0.018    -0.089    29.619     0.930     1.228     0.579 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.004    -1.070    25.073     0.295     1.495     0.628 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.743    24.089     0.465     1.572     0.640 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.311    24.219     0.202     1.561     0.638 
## male                          0.025     0.017    -0.009     0.058     1.451    36.106     0.156     0.997     0.525 
## sibling_count3               -0.012     0.024    -0.058     0.034    -0.510    30.521     0.614     1.188     0.570 
## sibling_count4               -0.008     0.033    -0.073     0.056    -0.256    22.630     0.800     1.707     0.659 
## sibling_count5               -0.048     0.029    -0.105     0.009    -1.660   144.035     0.099     0.333     0.260 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-157" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-406-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-39" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-158" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.096     0.037     0.024     0.168     2.598    24.848     0.016     1.512     0.630 
## birth_order_nonlinear2       -0.014     0.017    -0.048     0.021    -0.780    97.889     0.437     0.435     0.317 
## birth_order_nonlinear3       -0.019     0.028    -0.074     0.037    -0.660    30.043     0.514     1.209     0.575 
## birth_order_nonlinear4        0.000     0.032    -0.062     0.062     0.002   110.593     0.998     0.399     0.298 
## birth_order_nonlinear5        0.006     0.058    -0.107     0.120     0.107    41.972     0.915     0.862     0.487 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.014     0.003    -1.212    26.413     0.236     1.402     0.612 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.875    24.776     0.390     1.517     0.631 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.404    24.245     0.173     1.559     0.638 
## male                          0.022     0.017    -0.011     0.055     1.331    40.029     0.191     0.902     0.499 
## sibling_count3               -0.009     0.025    -0.059     0.041    -0.350    27.538     0.729     1.335     0.600 
## sibling_count4               -0.007     0.032    -0.070     0.056    -0.224    26.926     0.825     1.370     0.606 
## sibling_count5               -0.050     0.031    -0.110     0.011    -1.606   107.815     0.111     0.406     0.302 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.904 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-158" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-408-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-39" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-159" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.099     0.039     0.022     0.175     2.514    26.819     0.018     1.377     0.608 
## count_birth_order2/2         -0.019     0.028    -0.074     0.036    -0.678    37.055     0.502     0.972     0.518 
## count_birth_order1/3         -0.012     0.043    -0.096     0.072    -0.275    20.711     0.786     1.934     0.688 
## count_birth_order2/3         -0.030     0.031    -0.092     0.031    -0.962    45.509     0.341     0.801     0.468 
## count_birth_order3/3         -0.023     0.030    -0.081     0.035    -0.776   101.577     0.440     0.424     0.311 
## count_birth_order1/4         -0.011     0.047    -0.103     0.082    -0.224    39.539     0.824     0.912     0.502 
## count_birth_order2/4         -0.015     0.042    -0.098     0.068    -0.350    41.232     0.728     0.877     0.491 
## count_birth_order3/4         -0.042     0.052    -0.145     0.060    -0.806    21.462     0.429     1.837     0.676 
## count_birth_order4/4         -0.006     0.043    -0.091     0.078    -0.142    45.851     0.888     0.795     0.466 
## count_birth_order1/5         -0.078     0.055    -0.185     0.030    -1.420   115.639     0.158     0.387     0.291 
## count_birth_order2/5         -0.039     0.057    -0.151     0.073    -0.686    46.920     0.496     0.779     0.460 
## count_birth_order3/5         -0.079     0.051    -0.179     0.020    -1.564    73.323     0.122     0.539     0.367 
## count_birth_order4/5         -0.051     0.055    -0.158     0.057    -0.921    43.794     0.362     0.829     0.477 
## count_birth_order5/5         -0.047     0.057    -0.160     0.065    -0.820    46.556     0.417     0.785     0.462 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.014     0.004    -1.185    26.406     0.247     1.403     0.612 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.883    24.054     0.386     1.575     0.640 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.417    23.324     0.170     1.640     0.650 
## male                          0.021     0.016    -0.010     0.053     1.331    52.183     0.189     0.710     0.436 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.904 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-159" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-410-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-39" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.427       6  54.409   0.858 235.842 
##  2 vs 3:   0.465       3  27.087   0.709 490.939 
##  3 vs 4:   0.455       1   9.046   0.517 170.170</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-19" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-412-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="riskpreference" class="section level2 tabset">
<h2>Riskpreference</h2>
<div id="risk-a" class="section level3 tabset">
<h3>Risk A</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskA)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-20" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-40" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-160" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.161     0.033     0.096     0.226     4.856    25.593     0.000     1.457     0.621 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.914    51.417     0.365     0.719     0.440 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.175    64.167     0.861     0.599     0.393 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.637    79.802     0.526     0.506     0.352 
## male                         -0.198     0.023    -0.243    -0.153    -8.590    19.682     0.000     2.088     0.705 
## sibling_count3               -0.000     0.020    -0.039     0.039    -0.007   152.011     0.994     0.322     0.253 
## sibling_count4                0.004     0.027    -0.049     0.057     0.158    40.070     0.875     0.901     0.498 
## sibling_count5               -0.009     0.028    -0.063     0.045    -0.321    66.270     0.749     0.584     0.387 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-160" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-414-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-40" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-161" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.166     0.034     0.099     0.232     4.847    64.339     0.000     0.597     0.393 
## birth_order                  -0.002     0.011    -0.023     0.019    -0.180    33.153     0.858     1.088     0.548 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.978    68.994     0.332     0.565     0.379 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.139    75.054     0.890     0.530     0.363 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.607    89.281     0.546     0.465     0.332 
## male                         -0.198     0.023    -0.243    -0.153    -8.560    19.564     0.000     2.108     0.707 
## sibling_count3                0.001     0.020    -0.038     0.040     0.051   230.022     0.959     0.247     0.205 
## sibling_count4                0.007     0.029    -0.051     0.064     0.229    43.180     0.820     0.840     0.480 
## sibling_count5               -0.005     0.036    -0.077     0.066    -0.147    37.423     0.884     0.962     0.516 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-161" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-416-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-40" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-162" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.032     0.100     0.225     5.073    55.566     0.000     0.674     0.423 
## birth_order_nonlinear2        0.001     0.021    -0.041     0.042     0.036    49.171     0.971     0.748     0.450 
## birth_order_nonlinear3       -0.008     0.028    -0.063     0.047    -0.283    44.040     0.779     0.825     0.475 
## birth_order_nonlinear4       -0.021     0.035    -0.089     0.048    -0.599    73.461     0.551     0.539     0.367 
## birth_order_nonlinear5        0.021     0.056    -0.089     0.130     0.371    42.316     0.712     0.856     0.485 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.992    72.860     0.325     0.542     0.369 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.128    78.223     0.898     0.513     0.355 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.594    91.408     0.554     0.457     0.328 
## male                         -0.198     0.023    -0.243    -0.153    -8.549    19.493     0.000     2.120     0.708 
## sibling_count3                0.003     0.021    -0.038     0.044     0.151   239.609     0.880     0.240     0.200 
## sibling_count4                0.013     0.030    -0.045     0.071     0.440    49.385     0.662     0.745     0.449 
## sibling_count5               -0.007     0.037    -0.080     0.065    -0.201    40.036     0.842     0.902     0.499 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-162" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-418-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-40" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-163" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.036     0.088     0.231     4.370    46.157     0.000     0.791     0.464 
## count_birth_order2/2         -0.000     0.035    -0.069     0.069    -0.005    26.121     0.996     1.421     0.615 
## count_birth_order1/3         -0.013     0.035    -0.081     0.055    -0.376    58.982     0.709     0.641     0.410 
## count_birth_order2/3          0.005     0.032    -0.057     0.068     0.170   113.761     0.865     0.391     0.294 
## count_birth_order3/3          0.005     0.037    -0.067     0.077     0.145    38.080     0.886     0.946     0.511 
## count_birth_order1/4          0.037     0.047    -0.055     0.129     0.786    40.497     0.436     0.892     0.496 
## count_birth_order2/4         -0.004     0.045    -0.091     0.084    -0.085    52.239     0.932     0.710     0.436 
## count_birth_order3/4         -0.021     0.045    -0.109     0.067    -0.465    40.943     0.644     0.883     0.493 
## count_birth_order4/4          0.006     0.044    -0.080     0.092     0.136    40.292     0.892     0.896     0.497 
## count_birth_order1/5         -0.012     0.049    -0.109     0.084    -0.253   145.006     0.800     0.332     0.259 
## count_birth_order2/5          0.018     0.051    -0.081     0.117     0.357   129.906     0.721     0.357     0.274 
## count_birth_order3/5         -0.010     0.051    -0.110     0.091    -0.190    71.790     0.850     0.548     0.371 
## count_birth_order4/5         -0.056     0.051    -0.156     0.043    -1.113    71.175     0.270     0.552     0.373 
## count_birth_order5/5          0.012     0.047    -0.081     0.105     0.261    64.443     0.795     0.597     0.392 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.012     0.005    -0.762    57.327     0.449     0.656     0.416 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.278    64.579     0.782     0.596     0.392 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.713    79.163     0.478     0.509     0.353 
## male                         -0.198     0.023    -0.244    -0.153    -8.573    19.561     0.000     2.109     0.707 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.916 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-163" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-420-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-40" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.373       6 120.259   0.895   1.835 
##  2 vs 3:   0.372       3  44.590   0.774   2.819 
##  3 vs 4:   0.351       1  11.150   0.565   3.972</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-20" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-41" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-164" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.029     0.106     0.219     5.631    33.913     0.000     1.062     0.541 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.011     0.004    -0.827    37.873     0.413     0.951     0.513 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.488    39.995     0.628     0.902     0.499 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.128    38.404     0.266     0.938     0.509 
## male                         -0.200     0.023    -0.246    -0.154    -8.583    16.703     0.000     2.760     0.761 
## sibling_count3               -0.006     0.023    -0.051     0.040    -0.242    28.632     0.810     1.276     0.588 
## sibling_count4                0.007     0.030    -0.051     0.065     0.235    23.394     0.817     1.633     0.649 
## sibling_count5                0.011     0.029    -0.045     0.068     0.396    48.272     0.694     0.760     0.454 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-164" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-423-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-41" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-165" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.177     0.035     0.109     0.245     5.122    36.352     0.000     0.990     0.523 
## birth_order                  -0.007     0.008    -0.023     0.010    -0.812    69.661     0.420     0.561     0.377 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.919    34.157     0.365     1.055     0.540 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.393    36.806     0.696     0.978     0.520 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.046    36.221     0.303     0.994     0.524 
## male                         -0.200     0.023    -0.245    -0.155    -8.679    16.999     0.000     2.671     0.755 
## sibling_count3               -0.002     0.023    -0.048     0.044    -0.070    30.631     0.945     1.184     0.569 
## sibling_count4                0.015     0.030    -0.044     0.074     0.499    28.266     0.621     1.295     0.592 
## sibling_count5                0.023     0.033    -0.043     0.088     0.678    44.883     0.501     0.811     0.471 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-165" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-425-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-41" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-166" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.168     0.032     0.104     0.231     5.185    38.166     0.000     0.944     0.511 
## birth_order_nonlinear2       -0.004     0.021    -0.045     0.037    -0.191    32.765     0.849     1.101     0.551 
## birth_order_nonlinear3       -0.008     0.025    -0.057     0.040    -0.340    58.161     0.735     0.648     0.413 
## birth_order_nonlinear4       -0.012     0.037    -0.085     0.060    -0.338    41.503     0.737     0.872     0.490 
## birth_order_nonlinear5       -0.009     0.057    -0.120     0.102    -0.155    47.579     0.878     0.770     0.457 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.925    35.614     0.361     1.011     0.528 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.399    40.110     0.692     0.900     0.498 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.075    40.295     0.289     0.896     0.497 
## male                         -0.201     0.023    -0.246    -0.156    -8.724    17.398     0.000     2.562     0.747 
## sibling_count3               -0.002     0.025    -0.051     0.046    -0.094    29.570     0.925     1.231     0.579 
## sibling_count4                0.015     0.032    -0.048     0.077     0.468    26.890     0.644     1.373     0.607 
## sibling_count5                0.019     0.036    -0.053     0.090     0.510    36.848     0.613     0.977     0.520 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.918 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-166" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-427-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-41" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-167" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.033     0.115     0.243     5.457    55.317     0.000     0.676     0.424 
## count_birth_order2/2         -0.017     0.030    -0.075     0.042    -0.552    30.105     0.585     1.206     0.574 
## count_birth_order1/3         -0.014     0.040    -0.093     0.065    -0.353    24.116     0.727     1.570     0.640 
## count_birth_order2/3         -0.003     0.041    -0.083     0.077    -0.076    20.028     0.940     2.033     0.699 
## count_birth_order3/3         -0.017     0.034    -0.084     0.050    -0.483    40.440     0.631     0.893     0.496 
## count_birth_order1/4          0.020     0.042    -0.061     0.102     0.482    85.011     0.631     0.482     0.341 
## count_birth_order2/4          0.024     0.042    -0.058     0.105     0.567    44.539     0.573     0.817     0.473 
## count_birth_order3/4         -0.014     0.049    -0.110     0.083    -0.278    25.004     0.783     1.500     0.629 
## count_birth_order4/4         -0.017     0.058    -0.130     0.097    -0.285    18.753     0.779     2.255     0.721 
## count_birth_order1/5         -0.002     0.068    -0.136     0.132    -0.027    31.438     0.979     1.151     0.562 
## count_birth_order2/5         -0.006     0.057    -0.118     0.106    -0.103    46.110     0.918     0.791     0.465 
## count_birth_order3/5          0.022     0.070    -0.114     0.159     0.320    20.920     0.752     1.906     0.685 
## count_birth_order4/5          0.025     0.049    -0.072     0.121     0.500    89.667     0.618     0.464     0.332 
## count_birth_order5/5         -0.005     0.056    -0.114     0.104    -0.087    55.265     0.931     0.677     0.424 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.003    -1.238    47.209     0.222     0.775     0.459 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.154    45.106     0.878     0.807     0.470 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.860    40.758     0.395     0.886     0.494 
## male                         -0.201     0.022    -0.244    -0.157    -9.081    19.006     0.000     2.206     0.716 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.918 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-167" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-429-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-41" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.432       6  54.410   0.855 235.475 
##  2 vs 3:   0.450       3  27.087   0.719 491.276 
##  3 vs 4:   0.438       1   9.046   0.524 169.763</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-20" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-431-1.png" width="672" /></p>
</div>
</div>
<div id="risk-b" class="section level3 tabset">
<h3>Risk B</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskB)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-21" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-42" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-168" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.003     0.034    -0.070     0.064    -0.097    24.225     0.923     1.561     0.638 
## poly(age, 3, raw = TRUE)1     0.000     0.005    -0.009     0.009     0.079    34.176     0.937     1.054     0.539 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.535    42.062     0.595     0.861     0.486 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.716    44.325     0.478     0.820     0.474 
## male                         -0.067     0.020    -0.106    -0.028    -3.377    29.365     0.002     1.240     0.581 
## sibling_count3                0.001     0.028    -0.053     0.055     0.033    24.957     0.974     1.503     0.629 
## sibling_count4               -0.006     0.026    -0.058     0.046    -0.231    46.598     0.818     0.784     0.462 
## sibling_count5               -0.008     0.033    -0.072     0.057    -0.235    30.245     0.816     1.200     0.573 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.932 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-168" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-433-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-42" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-169" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.003     0.036    -0.068     0.074     0.076    47.462     0.940     0.771     0.458 
## birth_order                  -0.003     0.009    -0.020     0.015    -0.298   100.507     0.766     0.427     0.313 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.009     0.009     0.014    41.346     0.989     0.875     0.491 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.586    45.995     0.561     0.793     0.465 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.757    47.134     0.453     0.776     0.459 
## male                         -0.067     0.020    -0.105    -0.028    -3.383    29.655     0.002     1.227     0.578 
## sibling_count3                0.003     0.028    -0.052     0.057     0.093    27.569     0.927     1.333     0.599 
## sibling_count4               -0.003     0.029    -0.060     0.054    -0.096    47.010     0.924     0.778     0.460 
## sibling_count5               -0.003     0.036    -0.074     0.068    -0.077    39.602     0.939     0.911     0.501 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.932 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-169" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-435-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-42" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-170" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.006     0.034    -0.073     0.060    -0.186    42.426     0.853     0.854     0.484 
## birth_order_nonlinear2        0.007     0.018    -0.029     0.043     0.380   170.738     0.704     0.298     0.238 
## birth_order_nonlinear3        0.006     0.025    -0.042     0.054     0.239   121.754     0.812     0.373     0.284 
## birth_order_nonlinear4       -0.014     0.035    -0.084     0.055    -0.407    72.622     0.685     0.543     0.369 
## birth_order_nonlinear5       -0.022     0.050    -0.119     0.076    -0.435    91.356     0.664     0.457     0.328 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.008     0.009     0.090    46.420     0.929     0.787     0.463 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.515    53.602     0.608     0.694     0.431 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.689    54.480     0.493     0.685     0.427 
## male                         -0.067     0.020    -0.106    -0.028    -3.376    29.362     0.002     1.240     0.581 
## sibling_count3                0.000     0.029    -0.057     0.058     0.009    26.397     0.993     1.403     0.612 
## sibling_count4               -0.001     0.032    -0.063     0.061    -0.033    37.859     0.974     0.951     0.513 
## sibling_count5                0.002     0.037    -0.070     0.075     0.060    41.810     0.952     0.866     0.488 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.932 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-170" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-437-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-42" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-171" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.008     0.040    -0.086     0.070    -0.192    33.053     0.849     1.091     0.548 
## count_birth_order2/2          0.009     0.026    -0.043     0.061     0.340   142.789     0.734     0.335     0.261 
## count_birth_order1/3         -0.004     0.039    -0.081     0.073    -0.102    33.616     0.920     1.072     0.544 
## count_birth_order2/3          0.013     0.038    -0.061     0.086     0.336    39.956     0.739     0.903     0.499 
## count_birth_order3/3          0.008     0.039    -0.068     0.083     0.199    32.353     0.844     1.116     0.554 
## count_birth_order1/4          0.019     0.043    -0.066     0.104     0.435    66.768     0.665     0.580     0.385 
## count_birth_order2/4          0.003     0.047    -0.090     0.095     0.054    41.826     0.957     0.865     0.488 
## count_birth_order3/4         -0.007     0.041    -0.087     0.073    -0.172    81.463     0.864     0.498     0.348 
## count_birth_order4/4         -0.015     0.041    -0.095     0.064    -0.373    62.905     0.710     0.608     0.397 
## count_birth_order1/5         -0.008     0.053    -0.111     0.095    -0.147    83.061     0.883     0.491     0.345 
## count_birth_order2/5         -0.004     0.053    -0.108     0.099    -0.082    93.338     0.935     0.450     0.325 
## count_birth_order3/5          0.030     0.057    -0.082     0.142     0.523    40.952     0.604     0.883     0.493 
## count_birth_order4/5         -0.010     0.055    -0.117     0.097    -0.182    46.413     0.856     0.787     0.463 
## count_birth_order5/5         -0.018     0.051    -0.117     0.081    -0.358    46.343     0.722     0.788     0.463 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.008     0.009     0.110    49.501     0.913     0.743     0.448 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.491    59.487     0.625     0.637     0.409 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.668    59.786     0.506     0.634     0.407 
## male                         -0.067     0.020    -0.106    -0.028    -3.373    29.053     0.002     1.255     0.584 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.932 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-171" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-439-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-42" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.196       6 124.323   0.978   1.747 
##  2 vs 3:   0.427       3  44.045   0.735   2.898 
##  3 vs 4:   0.177       1  11.603   0.681   3.337</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-21" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-43" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-172" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.001     0.035    -0.068     0.069     0.020    20.342     0.984     1.986     0.694 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.463    30.719     0.647     1.180     0.568 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.012    36.833     0.990     0.978     0.520 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.005    36.602     0.996     0.984     0.521 
## male                         -0.073     0.019    -0.109    -0.036    -3.915    27.198     0.001     1.354     0.603 
## sibling_count3               -0.017     0.019    -0.055     0.020    -0.911    77.631     0.365     0.516     0.357 
## sibling_count4               -0.017     0.026    -0.068     0.035    -0.633    35.510     0.531     1.014     0.529 
## sibling_count5                0.002     0.036    -0.068     0.072     0.060    23.681     0.953     1.607     0.645 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.936 
## ICC|mother_pidlink                     0.063 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-172" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-442-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-43" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-173" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.022     0.034    -0.044     0.088     0.646    41.975     0.522     0.862     0.487 
## birth_order                  -0.010     0.009    -0.027     0.007    -1.121    50.724     0.267     0.728     0.443 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.009     0.316    33.141     0.754     1.088     0.548 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.068    36.642     0.946     0.983     0.521 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.043    35.801     0.966     1.006     0.527 
## male                         -0.073     0.019    -0.110    -0.036    -3.893    26.614     0.001     1.390     0.610 
## sibling_count3               -0.011     0.021    -0.053     0.030    -0.541    50.328     0.591     0.733     0.445 
## sibling_count4               -0.004     0.032    -0.066     0.057    -0.142    25.597     0.889     1.457     0.621 
## sibling_count5                0.017     0.044    -0.068     0.102     0.392    19.996     0.699     2.038     0.700 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.936 
## ICC|mother_pidlink                     0.063 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-173" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-444-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-43" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-174" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.013     0.035    -0.055     0.080     0.361    30.452     0.720     1.191     0.571 
## birth_order_nonlinear2       -0.011     0.019    -0.048     0.025    -0.609    66.489     0.545     0.582     0.386 
## birth_order_nonlinear3       -0.018     0.026    -0.068     0.033    -0.688    48.868     0.494     0.752     0.451 
## birth_order_nonlinear4       -0.038     0.038    -0.111     0.036    -1.009    40.190     0.319     0.898     0.498 
## birth_order_nonlinear5       -0.042     0.064    -0.168     0.083    -0.664    30.053     0.512     1.209     0.575 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.009     0.305    33.861     0.762     1.064     0.542 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.077    36.974     0.939     0.974     0.519 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.052    36.811     0.959     0.978     0.520 
## male                         -0.072     0.019    -0.110    -0.035    -3.833    27.056     0.001     1.363     0.605 
## sibling_count3               -0.012     0.022    -0.056     0.031    -0.560    46.333     0.578     0.788     0.463 
## sibling_count4               -0.003     0.034    -0.069     0.063    -0.082    23.888     0.935     1.589     0.643 
## sibling_count5                0.019     0.044    -0.067     0.106     0.434    21.070     0.668     1.886     0.682 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.063 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-174" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-446-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-43" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-175" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.012     0.038    -0.062     0.086     0.319    31.096     0.752     1.164     0.565 
## count_birth_order2/2         -0.010     0.025    -0.059     0.039    -0.391    79.040     0.697     0.509     0.354 
## count_birth_order1/3         -0.012     0.038    -0.086     0.062    -0.319    29.699     0.752     1.225     0.578 
## count_birth_order2/3         -0.026     0.030    -0.085     0.033    -0.856    60.942     0.395     0.624     0.404 
## count_birth_order3/3         -0.024     0.030    -0.083     0.035    -0.792    89.764     0.430     0.463     0.331 
## count_birth_order1/4          0.013     0.043    -0.071     0.097     0.308    74.107     0.759     0.535     0.365 
## count_birth_order2/4          0.001     0.049    -0.094     0.097     0.030    25.847     0.976     1.440     0.619 
## count_birth_order3/4         -0.035     0.045    -0.124     0.054    -0.776    33.000     0.443     1.093     0.549 
## count_birth_order4/4         -0.053     0.043    -0.137     0.032    -1.225    48.664     0.227     0.755     0.452 
## count_birth_order1/5          0.010     0.082    -0.149     0.170     0.128    20.145     0.899     2.016     0.697 
## count_birth_order2/5         -0.003     0.059    -0.118     0.112    -0.051    42.820     0.959     0.847     0.482 
## count_birth_order3/5          0.014     0.055    -0.094     0.121     0.249    48.136     0.804     0.762     0.455 
## count_birth_order4/5         -0.002     0.060    -0.119     0.115    -0.034    32.228     0.973     1.121     0.555 
## count_birth_order5/5         -0.026     0.054    -0.133     0.081    -0.479    67.109     0.634     0.578     0.384 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.010     0.296    32.398     0.769     1.114     0.554 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.044    33.725     0.965     1.069     0.543 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.003    32.881     0.998     1.097     0.550 
## male                         -0.073     0.018    -0.109    -0.037    -3.962    30.289     0.000     1.198     0.572 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.936 
## ICC|mother_pidlink                     0.063 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-175" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-448-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-43" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.445       6  54.410   0.846 235.412 
##  2 vs 3:   0.428       3  27.087   0.734 491.549 
##  3 vs 4:   0.435       1   9.046   0.526 169.872</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-21" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-450-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="educational-attainment" class="section level2 tabset">
<h2>Educational Attainment</h2>
<div id="years-of-education---z-standardized" class="section level3 tabset">
<h3>Years of Education - z-standardized</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = years_of_education_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-22" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-44" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-176" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.236     0.031     0.174     0.297     7.561    29.945     0.000     1.214     0.576 
## poly(age, 3, raw = TRUE)1    -0.019     0.004    -0.028    -0.011    -4.412    30.309     0.000     1.197     0.572 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.001     0.001     5.033    46.187     0.000     0.790     0.464 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -7.214    66.097     0.000     0.585     0.387 
## male                         -0.020     0.015    -0.050     0.010    -1.311    51.717     0.196     0.716     0.438 
## sibling_count3                0.019     0.022    -0.024     0.062     0.848   223.588     0.397     0.251     0.208 
## sibling_count4                0.009     0.031    -0.053     0.070     0.274    39.476     0.785     0.914     0.502 
## sibling_count5                0.017     0.029    -0.039     0.074     0.597   243.963     0.551     0.238     0.199 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.350 
## Residual~~Residual                     0.584 
## ICC|mother_pidlink                     0.375 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-176" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-452-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-44" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-177" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.216     0.034     0.150     0.282     6.416    63.276     0.000     0.605     0.396 
## birth_order                   0.008     0.009    -0.010     0.026     0.831    31.092     0.413     1.165     0.565 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.027    -0.010    -4.200    36.823     0.000     0.978     0.520 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.792    47.535     0.000     0.770     0.457 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.925    63.064     0.000     0.607     0.397 
## male                         -0.020     0.015    -0.050     0.010    -1.326    51.845     0.191     0.714     0.438 
## sibling_count3                0.013     0.022    -0.029     0.056     0.621   399.738     0.535     0.177     0.154 
## sibling_count4               -0.002     0.032    -0.064     0.060    -0.055    52.031     0.956     0.712     0.437 
## sibling_count5                0.002     0.031    -0.059     0.063     0.059   441.542     0.953     0.167     0.147 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.350 
## Residual~~Residual                     0.584 
## ICC|mother_pidlink                     0.375 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-177" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-454-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-44" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-178" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.234     0.032     0.171     0.297     7.247    50.086     0.000     0.736     0.446 
## birth_order_nonlinear2       -0.007     0.019    -0.044     0.031    -0.340    32.890     0.736     1.097     0.550 
## birth_order_nonlinear3        0.002     0.023    -0.043     0.047     0.098    50.200     0.922     0.734     0.445 
## birth_order_nonlinear4        0.012     0.031    -0.049     0.073     0.397    51.211     0.693     0.722     0.441 
## birth_order_nonlinear5        0.071     0.055    -0.037     0.178     1.291    24.099     0.209     1.571     0.640 
## poly(age, 3, raw = TRUE)1    -0.019     0.004    -0.028    -0.010    -4.259    34.951     0.000     1.030     0.533 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.001     0.001     4.855    44.717     0.000     0.814     0.472 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.949    58.248     0.000     0.648     0.413 
## male                         -0.020     0.015    -0.050     0.010    -1.325    51.344     0.191     0.720     0.440 
## sibling_count3                0.016     0.022    -0.028     0.060     0.706   391.795     0.481     0.179     0.156 
## sibling_count4                0.001     0.033    -0.064     0.066     0.024    46.709     0.981     0.782     0.462 
## sibling_count5               -0.008     0.031    -0.068     0.052    -0.260  1292.046     0.795     0.091     0.085 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.350 
## Residual~~Residual                     0.583 
## ICC|mother_pidlink                     0.375 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-178" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-456-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-44" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-179" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.218     0.034     0.151     0.285     6.400    60.106     0.000     0.631     0.406 
## count_birth_order2/2          0.010     0.022    -0.034     0.053     0.440   105.096     0.661     0.414     0.306 
## count_birth_order1/3          0.029     0.030    -0.031     0.088     0.949   128.427     0.344     0.360     0.276 
## count_birth_order2/3          0.001     0.032    -0.062     0.065     0.045    70.062     0.964     0.559     0.376 
## count_birth_order3/3          0.034     0.031    -0.027     0.095     1.103    82.851     0.273     0.492     0.345 
## count_birth_order1/4          0.009     0.041    -0.072     0.090     0.215    62.398     0.831     0.612     0.399 
## count_birth_order2/4         -0.001     0.047    -0.093     0.090    -0.032    33.953     0.975     1.061     0.541 
## count_birth_order3/4          0.002     0.047    -0.089     0.094     0.053    29.585     0.958     1.230     0.579 
## count_birth_order4/4          0.028     0.043    -0.057     0.113     0.654    35.138     0.517     1.025     0.532 
## count_birth_order1/5          0.019     0.045    -0.070     0.107     0.410   208.358     0.682     0.262     0.215 
## count_birth_order2/5          0.001     0.046    -0.089     0.092     0.027   182.198     0.979     0.286     0.231 
## count_birth_order3/5         -0.012     0.044    -0.099     0.074    -0.281   174.509     0.779     0.294     0.236 
## count_birth_order4/5         -0.002     0.043    -0.087     0.083    -0.046   194.189     0.964     0.274     0.223 
## count_birth_order5/5          0.071     0.054    -0.035     0.177     1.306    28.542     0.202     1.281     0.589 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.026    -0.009    -3.976    40.982     0.000     0.882     0.493 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.538    48.344     0.000     0.759     0.454 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.633    60.771     0.000     0.626     0.404 
## male                         -0.020     0.015    -0.050     0.010    -1.320    52.178     0.193     0.710     0.437 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.350 
## Residual~~Residual                     0.583 
## ICC|mother_pidlink                     0.375 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-179" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-458-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-44" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.328       6 123.147   0.921   1.771 
##  2 vs 3:   0.587       3  42.332   0.627   3.182 
##  3 vs 4:   0.430       1  11.086   0.525   4.084</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-22" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-45" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-180" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.207     0.033     0.142     0.273     6.210    21.815     0.000     1.796     0.671 
## poly(age, 3, raw = TRUE)1    -0.012     0.005    -0.021    -0.003    -2.712    20.733     0.013     1.931     0.688 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.931    23.574     0.007     1.617     0.647 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.297    25.169     0.000     1.487     0.627 
## male                         -0.025     0.013    -0.051     0.001    -1.863    64.006     0.067     0.600     0.394 
## sibling_count3                0.024     0.026    -0.026     0.074     0.927    26.089     0.363     1.423     0.616 
## sibling_count4               -0.001     0.027    -0.054     0.053    -0.031    45.890     0.975     0.795     0.466 
## sibling_count5               -0.069     0.028    -0.124    -0.014    -2.445   185.588     0.015     0.282     0.228 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.374 
## Residual~~Residual                     0.577 
## ICC|mother_pidlink                     0.393 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-180" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-461-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-45" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-181" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.160     0.034     0.094     0.226     4.772    41.111     0.000     0.879     0.492 
## birth_order                   0.019     0.009     0.002     0.036     2.145    27.075     0.041     1.362     0.605 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.019    -0.002    -2.380    23.031     0.026     1.668     0.654 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.755    24.250     0.011     1.559     0.638 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.208    25.554     0.000     1.460     0.622 
## male                         -0.025     0.014    -0.052     0.002    -1.822    58.217     0.074     0.648     0.413 
## sibling_count3                0.011     0.026    -0.040     0.062     0.430    27.023     0.671     1.365     0.605 
## sibling_count4               -0.026     0.027    -0.078     0.027    -0.957    78.144     0.341     0.514     0.356 
## sibling_count5               -0.100     0.028    -0.156    -0.045    -3.569  1423.183     0.000     0.086     0.081 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.373 
## Residual~~Residual                     0.578 
## ICC|mother_pidlink                     0.392 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-181" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-463-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-45" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-182" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.205     0.035     0.137     0.273     5.931    29.864     0.000     1.217     0.576 
## birth_order_nonlinear2       -0.007     0.016    -0.038     0.024    -0.452    60.185     0.653     0.631     0.406 
## birth_order_nonlinear3        0.024     0.025    -0.025     0.073     0.962    27.345     0.345     1.346     0.602 
## birth_order_nonlinear4        0.041     0.028    -0.014     0.097     1.470    77.138     0.146     0.519     0.358 
## birth_order_nonlinear5        0.061     0.056    -0.048     0.170     1.104    27.342     0.279     1.346     0.602 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.004    -2.839    23.957     0.009     1.583     0.642 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     3.251    25.088     0.003     1.493     0.628 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.638    26.284     0.000     1.411     0.613 
## male                         -0.027     0.014    -0.053    -0.000    -1.975    68.897     0.052     0.566     0.379 
## sibling_count3                0.013     0.027    -0.041     0.066     0.461    25.409     0.649     1.470     0.624 
## sibling_count4               -0.026     0.029    -0.083     0.031    -0.889    51.932     0.378     0.713     0.438 
## sibling_count5               -0.099     0.029    -0.156    -0.042    -3.381   729.712     0.001     0.125     0.113 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.371 
## Residual~~Residual                     0.576 
## ICC|mother_pidlink                     0.391 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-182" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-465-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-45" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-183" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.178     0.038     0.103     0.253     4.657    28.679     0.000     1.274     0.588 
## count_birth_order2/2          0.023     0.026    -0.027     0.073     0.900    30.391     0.375     1.194     0.571 
## count_birth_order1/3          0.041     0.040    -0.037     0.119     1.038    21.436     0.311     1.841     0.677 
## count_birth_order2/3          0.001     0.032    -0.062     0.064     0.036    32.435     0.972     1.113     0.553 
## count_birth_order3/3          0.062     0.037    -0.010     0.134     1.684    25.588     0.104     1.457     0.622 
## count_birth_order1/4          0.008     0.043    -0.076     0.093     0.194    43.315     0.847     0.838     0.479 
## count_birth_order2/4         -0.027     0.044    -0.114     0.060    -0.607    27.419     0.549     1.342     0.601 
## count_birth_order3/4          0.001     0.034    -0.066     0.067     0.018   137.352     0.986     0.344     0.267 
## count_birth_order4/4          0.037     0.043    -0.047     0.121     0.869    35.041     0.391     1.028     0.533 
## count_birth_order1/5         -0.081     0.057    -0.192     0.030    -1.431    48.574     0.159     0.756     0.453 
## count_birth_order2/5         -0.101     0.048    -0.194    -0.007    -2.108    94.922     0.038     0.445     0.322 
## count_birth_order3/5         -0.070     0.047    -0.162     0.023    -1.478    76.384     0.143     0.523     0.360 
## count_birth_order4/5         -0.053     0.056    -0.162     0.056    -0.948    31.690     0.350     1.141     0.560 
## count_birth_order5/5         -0.012     0.056    -0.122     0.098    -0.213    37.749     0.832     0.954     0.513 
## poly(age, 3, raw = TRUE)1    -0.011     0.005    -0.019    -0.002    -2.332    25.120     0.028     1.491     0.627 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.792    25.380     0.010     1.472     0.624 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.204    26.452     0.000     1.400     0.612 
## male                         -0.029     0.014    -0.056    -0.001    -2.067    62.704     0.043     0.610     0.398 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.370 
## Residual~~Residual                     0.576 
## ICC|mother_pidlink                     0.391 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-183" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-467-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-45" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.338       6  54.410   0.914 235.399 
##  2 vs 3:   0.399       3  27.087   0.755 491.085 
##  3 vs 4:   0.269       1   9.046   0.616 170.302</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-22" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-469-1.png" width="672" /></p>
</div>
</div>
<div id="elementary_missed" class="section level3">
<h3>elementary_missed</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_missed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-23" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-46" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-184" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.018     0.009     0.001     0.034     2.086    14.358     0.055     3.801     0.816 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.611    24.052     0.547     1.575     0.640 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.315    22.514     0.755     1.719     0.661 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.368    20.990     0.716     1.897     0.684 
## male                          0.002     0.003    -0.005     0.008     0.537    34.414     0.595     1.047     0.538 
## sibling_count3               -0.000     0.005    -0.009     0.009    -0.018    37.200     0.986     0.968     0.517 
## sibling_count4                0.003     0.006    -0.008     0.014     0.479    28.221     0.636     1.297     0.593 
## sibling_count5                0.006     0.006    -0.005     0.017     1.013    43.608     0.317     0.832     0.478 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-184" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-471-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-46" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-185" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.021     0.011    -0.002     0.043     1.814    13.678     0.092     4.295     0.834 
## birth_order                  -0.001     0.002    -0.006     0.004    -0.494    17.218     0.628     2.610     0.750 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.431    23.762     0.671     1.600     0.644 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.200    22.157     0.843     1.757     0.666 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.276    20.746     0.785     1.930     0.687 
## male                          0.002     0.003    -0.005     0.008     0.549    35.298     0.587     1.020     0.531 
## sibling_count3                0.001     0.004    -0.008     0.009     0.162    66.884     0.871     0.579     0.385 
## sibling_count4                0.004     0.005    -0.006     0.014     0.837    69.861     0.406     0.560     0.377 
## sibling_count5                0.008     0.006    -0.005     0.021     1.262    51.015     0.213     0.724     0.441 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-185" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-473-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-46" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-186" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.010    -0.000     0.039     1.920    14.379     0.075     3.788     0.815 
## birth_order_nonlinear2       -0.001     0.004    -0.008     0.006    -0.160    60.505     0.874     0.628     0.405 
## birth_order_nonlinear3       -0.003     0.007    -0.016     0.010    -0.508    18.556     0.617     2.294     0.725 
## birth_order_nonlinear4       -0.002     0.007    -0.015     0.012    -0.269    37.671     0.789     0.956     0.514 
## birth_order_nonlinear5       -0.006     0.014    -0.034     0.021    -0.446    16.124     0.662     2.954     0.774 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.441    24.639     0.663     1.528     0.633 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.209    22.484     0.836     1.722     0.662 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.285    20.979     0.778     1.898     0.684 
## male                          0.002     0.003    -0.005     0.008     0.539    34.869     0.593     1.033     0.534 
## sibling_count3                0.001     0.005    -0.008     0.010     0.257    59.882     0.798     0.633     0.407 
## sibling_count4                0.004     0.005    -0.006     0.014     0.817    84.227     0.416     0.486     0.342 
## sibling_count5                0.009     0.007    -0.005     0.023     1.212    37.340     0.233     0.964     0.516 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-186" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-475-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-46" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-187" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.020     0.011    -0.002     0.041     1.820    14.581     0.089     3.665     0.810 
## count_birth_order2/2         -0.001     0.006    -0.012     0.010    -0.199    34.861     0.843     1.033     0.534 
## count_birth_order1/3          0.001     0.006    -0.010     0.013     0.221   102.723     0.825     0.420     0.309 
## count_birth_order2/3         -0.001     0.007    -0.014     0.012    -0.111    40.974     0.912     0.882     0.493 
## count_birth_order3/3         -0.002     0.008    -0.017     0.014    -0.227    22.137     0.822     1.760     0.666 
## count_birth_order1/4          0.005     0.007    -0.009     0.019     0.726   157.298     0.469     0.314     0.249 
## count_birth_order2/4          0.006     0.009    -0.012     0.024     0.686    31.415     0.498     1.152     0.562 
## count_birth_order3/4         -0.001     0.010    -0.021     0.019    -0.112    20.513     0.912     1.962     0.691 
## count_birth_order4/4          0.001     0.008    -0.015     0.017     0.093    35.064     0.927     1.027     0.533 
## count_birth_order1/5          0.004     0.009    -0.013     0.021     0.458   166.794     0.648     0.303     0.241 
## count_birth_order2/5          0.008     0.009    -0.009     0.026     0.943   146.318     0.347     0.330     0.258 
## count_birth_order3/5          0.006     0.012    -0.019     0.030     0.461    21.464     0.649     1.837     0.676 
## count_birth_order4/5          0.009     0.009    -0.009     0.027     1.012    73.887     0.315     0.536     0.366 
## count_birth_order5/5          0.002     0.012    -0.021     0.025     0.181    20.927     0.858     1.905     0.685 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.402    26.893     0.691     1.372     0.607 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.182    24.959     0.857     1.503     0.629 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.268    22.733     0.791     1.697     0.658 
## male                          0.002     0.003    -0.005     0.008     0.537    34.617     0.595     1.040     0.536 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-187" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-477-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-46" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.288       6 120.754   1.000   1.823 
##  2 vs 3:  -0.549       3  40.312   1.000   3.610 
##  3 vs 4:  -0.329       1  10.507   1.000   5.524</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-23" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-47" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-188" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.008     0.001     0.033     2.071    14.113     0.057     3.965     0.822 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.844    33.769     0.404     1.067     0.543 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.388    34.562     0.701     1.042     0.536 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.415    28.619     0.681     1.277     0.589 
## male                          0.002     0.003    -0.003     0.007     0.764    58.298     0.448     0.647     0.413 
## sibling_count3                0.001     0.004    -0.007     0.010     0.281    30.972     0.780     1.169     0.566 
## sibling_count4                0.005     0.005    -0.005     0.016     0.974    26.215     0.339     1.415     0.614 
## sibling_count5                0.008     0.006    -0.003     0.020     1.454    42.090     0.153     0.860     0.486 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.158 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-188" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-480-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-47" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-189" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.021     0.009     0.004     0.039     2.402    16.267     0.029     2.904     0.770 
## birth_order                  -0.002     0.002    -0.005     0.002    -1.104    27.180     0.279     1.355     0.604 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.681    39.287     0.500     0.918     0.503 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.312    40.603     0.757     0.890     0.495 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.379    31.610     0.707     1.144     0.561 
## male                          0.002     0.003    -0.003     0.008     0.754    55.332     0.454     0.676     0.424 
## sibling_count3                0.002     0.004    -0.006     0.011     0.557    31.909     0.582     1.133     0.558 
## sibling_count4                0.008     0.006    -0.004     0.020     1.276    23.866     0.214     1.591     0.643 
## sibling_count5                0.012     0.007    -0.001     0.025     1.778    34.303     0.084     1.050     0.538 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.158 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-189" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-482-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-47" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-190" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.018     0.009     0.000     0.036     1.965    14.619     0.069     3.643     0.809 
## birth_order_nonlinear2       -0.001     0.004    -0.008     0.006    -0.183    34.857     0.856     1.033     0.534 
## birth_order_nonlinear3       -0.001     0.006    -0.013     0.010    -0.241    21.029     0.812     1.892     0.683 
## birth_order_nonlinear4       -0.007     0.007    -0.021     0.007    -0.923    28.165     0.364     1.300     0.593 
## birth_order_nonlinear5       -0.007     0.012    -0.030     0.016    -0.587    26.725     0.562     1.383     0.609 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.794    35.904     0.433     1.003     0.526 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.440    40.119     0.663     0.900     0.498 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.474    30.892     0.639     1.173     0.567 
## male                          0.002     0.003    -0.003     0.008     0.768    54.012     0.446     0.690     0.429 
## sibling_count3                0.002     0.005    -0.008     0.011     0.345    25.604     0.733     1.456     0.621 
## sibling_count4                0.007     0.006    -0.005     0.019     1.194    25.998     0.243     1.429     0.617 
## sibling_count5                0.011     0.007    -0.003     0.026     1.555    28.283     0.131     1.294     0.592 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.158 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-190" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-484-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-47" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-191" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.010    -0.000     0.039     1.947    14.889     0.071     3.494     0.802 
## count_birth_order2/2         -0.003     0.005    -0.012     0.007    -0.582    40.721     0.564     0.887     0.494 
## count_birth_order1/3         -0.001     0.007    -0.015     0.012    -0.222    30.865     0.826     1.174     0.567 
## count_birth_order2/3          0.001     0.007    -0.013     0.015     0.105    21.542     0.917     1.828     0.675 
## count_birth_order3/3          0.001     0.007    -0.013     0.015     0.148    24.702     0.883     1.523     0.632 
## count_birth_order1/4          0.006     0.009    -0.012     0.024     0.676    30.276     0.504     1.199     0.573 
## count_birth_order2/4          0.009     0.009    -0.009     0.026     0.973    24.887     0.340     1.508     0.630 
## count_birth_order3/4          0.002     0.008    -0.013     0.017     0.250    43.588     0.804     0.833     0.478 
## count_birth_order4/4         -0.000     0.008    -0.017     0.016    -0.030    33.500     0.976     1.076     0.545 
## count_birth_order1/5          0.013     0.012    -0.010     0.036     1.105    36.166     0.277     0.995     0.524 
## count_birth_order2/5          0.011     0.011    -0.010     0.032     1.006    40.264     0.320     0.897     0.497 
## count_birth_order3/5          0.006     0.010    -0.014     0.027     0.616    36.912     0.542     0.975     0.519 
## count_birth_order4/5          0.005     0.013    -0.021     0.031     0.348    18.492     0.731     2.307     0.726 
## count_birth_order5/5          0.004     0.010    -0.016     0.023     0.357    56.282     0.723     0.666     0.420 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.736    34.476     0.467     1.045     0.537 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.426    43.294     0.672     0.838     0.479 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.467    32.523     0.643     1.110     0.553 
## male                          0.002     0.003    -0.004     0.008     0.700    46.760     0.487     0.782     0.461 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.157 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-191" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-486-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-47" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -1.101       6  54.410   1.000 235.563 
##  2 vs 3:  -1.099       3  27.087   1.000 491.657 
##  3 vs 4:  -1.168       1   9.046   1.000 170.251</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-23" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-488-1.png" width="672" /></p>
</div>
</div>
<div id="elementary_worked" class="section level3">
<h3>elementary_worked</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_worked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-24" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-48" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-192" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.022     0.010     0.003     0.041     2.246    16.638     0.039     2.780     0.762 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.002     0.003     0.470    18.642     0.644     2.277     0.723 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.132    18.512     0.897     2.303     0.725 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.141    17.505     0.890     2.534     0.745 
## male                          0.005     0.004    -0.002     0.012     1.433   101.084     0.155     0.425     0.312 
## sibling_count3                0.001     0.005    -0.009     0.012     0.229    72.282     0.820     0.545     0.370 
## sibling_count4                0.008     0.006    -0.005     0.021     1.212    48.549     0.231     0.756     0.453 
## sibling_count5                0.011     0.007    -0.003     0.026     1.528    45.462     0.133     0.802     0.468 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.043 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-192" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-490-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-48" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-193" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.029     0.009     0.010     0.047     3.043    29.586     0.005     1.230     0.579 
## birth_order                  -0.003     0.002    -0.007     0.002    -1.277    37.057     0.209     0.972     0.518 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.194    20.057     0.848     2.029     0.698 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.319    18.677     0.753     2.270     0.722 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.010    17.311     0.992     2.585     0.749 
## male                          0.005     0.004    -0.002     0.012     1.451    97.979     0.150     0.435     0.317 
## sibling_count3                0.003     0.006    -0.008     0.014     0.551    60.367     0.584     0.629     0.405 
## sibling_count4                0.012     0.007    -0.003     0.026     1.576    39.274     0.123     0.918     0.503 
## sibling_count5                0.017     0.009    -0.001     0.035     1.845    33.072     0.074     1.091     0.548 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.043 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-193" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-492-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-48" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-194" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.025     0.010     0.006     0.044     2.619    22.861     0.015     1.684     0.656 
## birth_order_nonlinear2       -0.001     0.005    -0.011     0.008    -0.312    48.756     0.756     0.753     0.452 
## birth_order_nonlinear3       -0.006     0.007    -0.020     0.007    -0.960    32.330     0.344     1.117     0.554 
## birth_order_nonlinear4       -0.010     0.008    -0.027     0.006    -1.241    46.567     0.221     0.785     0.462 
## birth_order_nonlinear5       -0.009     0.013    -0.035     0.017    -0.653    31.087     0.519     1.165     0.565 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.208    19.223     0.837     2.167     0.713 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.287    17.724     0.778     2.479     0.740 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.009    16.607     0.993     2.790     0.763 
## male                          0.005     0.004    -0.002     0.012     1.437    93.563     0.154     0.450     0.324 
## sibling_count3                0.004     0.006    -0.008     0.015     0.609    58.265     0.545     0.648     0.413 
## sibling_count4                0.013     0.007    -0.002     0.027     1.690    43.406     0.098     0.836     0.479 
## sibling_count5                0.017     0.009    -0.001     0.035     1.899    39.602     0.065     0.911     0.501 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.043 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-194" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-494-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-48" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-195" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.026     0.010     0.007     0.046     2.634    25.330     0.014     1.476     0.625 
## count_birth_order2/2         -0.003     0.006    -0.016     0.010    -0.470    56.254     0.640     0.667     0.420 
## count_birth_order1/3          0.004     0.008    -0.012     0.019     0.485    61.333     0.629     0.621     0.402 
## count_birth_order2/3          0.002     0.007    -0.012     0.016     0.266   136.745     0.791     0.345     0.267 
## count_birth_order3/3         -0.005     0.008    -0.020     0.010    -0.643    67.954     0.523     0.572     0.382 
## count_birth_order1/4          0.006     0.010    -0.014     0.027     0.615    51.612     0.542     0.717     0.439 
## count_birth_order2/4          0.012     0.010    -0.007     0.032     1.259    69.430     0.212     0.563     0.378 
## count_birth_order3/4          0.010     0.012    -0.013     0.033     0.838    25.601     0.410     1.457     0.621 
## count_birth_order4/4          0.001     0.009    -0.016     0.018     0.067   108.623     0.946     0.404     0.301 
## count_birth_order1/5          0.019     0.015    -0.010     0.048     1.278    27.770     0.212     1.322     0.597 
## count_birth_order2/5          0.014     0.015    -0.015     0.044     0.968    29.613     0.341     1.229     0.579 
## count_birth_order3/5          0.007     0.012    -0.016     0.029     0.569    84.713     0.571     0.484     0.341 
## count_birth_order4/5          0.008     0.010    -0.012     0.028     0.765   352.016     0.445     0.190     0.165 
## count_birth_order5/5          0.008     0.013    -0.018     0.034     0.580    26.508     0.567     1.396     0.611 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.114    20.694     0.910     1.937     0.688 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.376    19.056     0.711     2.197     0.716 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.062    17.849     0.951     2.449     0.738 
## male                          0.005     0.004    -0.002     0.012     1.451    94.587     0.150     0.446     0.323 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.043 
## ICC|mother_pidlink                     0.182 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-195" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-496-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-48" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.217       6 115.504   1.000   1.952 
##  2 vs 3:  -0.380       3  41.753   1.000   3.293 
##  3 vs 4:   0.164       1  11.147   0.693   3.976</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-24" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-49" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-196" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.024     0.011     0.002     0.045     2.187    13.851     0.046     4.157     0.829 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.302    16.253     0.766     2.909     0.771 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.567    19.300     0.577     2.153     0.711 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.327    22.340     0.747     1.738     0.664 
## male                          0.006     0.003    -0.001     0.012     1.731    79.305     0.087     0.508     0.353 
## sibling_count3                0.001     0.004    -0.008     0.009     0.133   188.168     0.894     0.280     0.227 
## sibling_count4                0.011     0.006    -0.001     0.023     1.850    49.894     0.070     0.738     0.446 
## sibling_count5                0.020     0.008     0.005     0.035     2.579    37.928     0.014     0.950     0.512 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.182 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-196" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-499-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-49" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-197" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.032     0.011     0.010     0.053     2.900    17.660     0.010     2.495     0.742 
## birth_order                  -0.004     0.002    -0.008     0.001    -1.633    34.088     0.112     1.057     0.540 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.104    16.696     0.918     2.762     0.761 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.670    19.404     0.511     2.135     0.710 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.386    22.242     0.703     1.748     0.665 
## male                          0.006     0.003    -0.001     0.012     1.787    88.514     0.077     0.468     0.334 
## sibling_count3                0.003     0.005    -0.006     0.012     0.609   115.588     0.544     0.387     0.291 
## sibling_count4                0.015     0.006     0.003     0.028     2.426    54.622     0.019     0.683     0.427 
## sibling_count5                0.026     0.009     0.008     0.043     2.851    30.401     0.008     1.193     0.571 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.182 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-197" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-501-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-49" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-198" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.027     0.011     0.006     0.048     2.545    16.924     0.021     2.693     0.756 
## birth_order_nonlinear2       -0.002     0.004    -0.010     0.006    -0.508   112.367     0.613     0.395     0.295 
## birth_order_nonlinear3       -0.006     0.006    -0.018     0.006    -0.941    31.113     0.354     1.164     0.565 
## birth_order_nonlinear4       -0.010     0.008    -0.025     0.005    -1.306    62.298     0.196     0.613     0.399 
## birth_order_nonlinear5       -0.014     0.012    -0.038     0.010    -1.145    59.408     0.257     0.637     0.409 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.160    17.041     0.874     2.659     0.754 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.566    19.606     0.578     2.101     0.706 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.253    21.865     0.803     1.790     0.670 
## male                          0.006     0.004    -0.001     0.013     1.705    64.013     0.093     0.600     0.394 
## sibling_count3                0.003     0.004    -0.006     0.011     0.578   286.644     0.564     0.215     0.183 
## sibling_count4                0.016     0.007     0.003     0.029     2.371    50.169     0.022     0.735     0.445 
## sibling_count5                0.026     0.009     0.009     0.043     2.929    37.287     0.006     0.966     0.517 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-198" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-503-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-49" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-199" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.028     0.011     0.006     0.050     2.532    17.990     0.021     2.416     0.735 
## count_birth_order2/2         -0.004     0.006    -0.016     0.008    -0.602    46.213     0.550     0.790     0.464 
## count_birth_order1/3          0.001     0.008    -0.015     0.018     0.133    32.362     0.895     1.116     0.554 
## count_birth_order2/3          0.001     0.007    -0.011     0.014     0.217    96.224     0.829     0.441     0.320 
## count_birth_order3/3         -0.005     0.006    -0.017     0.008    -0.766   292.892     0.444     0.213     0.181 
## count_birth_order1/4          0.015     0.010    -0.005     0.036     1.476    50.296     0.146     0.733     0.445 
## count_birth_order2/4          0.014     0.011    -0.007     0.036     1.305    26.759     0.203     1.381     0.608 
## count_birth_order3/4          0.010     0.010    -0.010     0.030     0.980    38.181     0.333     0.944     0.510 
## count_birth_order4/4          0.004     0.010    -0.015     0.023     0.420    50.261     0.676     0.734     0.445 
## count_birth_order1/5          0.027     0.016    -0.004     0.058     1.725    31.422     0.094     1.151     0.562 
## count_birth_order2/5          0.024     0.014    -0.002     0.051     1.787    39.366     0.082     0.916     0.503 
## count_birth_order3/5          0.018     0.013    -0.007     0.044     1.414    40.297     0.165     0.896     0.497 
## count_birth_order4/5          0.015     0.015    -0.015     0.046     0.998    22.805     0.329     1.690     0.657 
## count_birth_order5/5          0.011     0.015    -0.017     0.040     0.782    31.462     0.440     1.150     0.562 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.003     0.003     0.067    16.756     0.947     2.744     0.760 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.620    19.658     0.543     2.093     0.705 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.307    22.527     0.762     1.718     0.661 
## male                          0.006     0.003    -0.000     0.013     1.895   101.035     0.061     0.425     0.312 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-199" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-505-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-49" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.867       6  54.409   1.000 235.995 
##  2 vs 3:  -0.836       3  27.087   1.000 490.379 
##  3 vs 4:  -0.789       1   9.046   1.000 169.892</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-24" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-507-1.png" width="672" /></p>
</div>
</div>
<div id="attended_school" class="section level3">
<h3>attended_school</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = attended_school)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-25" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-50" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-200" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.511     0.022     0.467     0.555    22.740    13.829     0.000     4.174     0.830 
## poly(age, 3, raw = TRUE)1     0.013     0.002     0.009     0.018     5.552    22.793     0.000     1.691     0.657 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.171    35.735     0.249     1.007     0.528 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.236    50.622     0.222     0.729     0.443 
## male                         -0.018     0.007    -0.032    -0.004    -2.582   128.773     0.011     0.359     0.276 
## sibling_count3                0.007     0.011    -0.015     0.029     0.651    46.825     0.518     0.781     0.461 
## sibling_count4                0.021     0.012    -0.002     0.044     1.789    73.983     0.078     0.536     0.366 
## sibling_count5                0.038     0.014     0.010     0.065     2.662    50.618     0.010     0.729     0.443 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.029 
## Residual~~Residual                     0.180 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-200" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-509-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-50" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-201" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.521     0.027     0.468     0.575    18.988    14.420     0.000     3.762     0.814 
## birth_order                  -0.004     0.005    -0.014     0.006    -0.841    26.754     0.408     1.381     0.608 
## poly(age, 3, raw = TRUE)1     0.013     0.003     0.008     0.018     4.903    20.451     0.000     1.971     0.692 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.936    30.323     0.356     1.197     0.572 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.323    42.041     0.193     0.861     0.487 
## male                         -0.018     0.007    -0.032    -0.004    -2.560   124.286     0.012     0.368     0.281 
## sibling_count3                0.010     0.012    -0.013     0.033     0.859    44.126     0.395     0.824     0.475 
## sibling_count4                0.027     0.012     0.003     0.050     2.256   184.514     0.025     0.283     0.229 
## sibling_count5                0.046     0.016     0.015     0.077     2.917    66.106     0.005     0.585     0.387 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.029 
## Residual~~Residual                     0.180 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-201" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-511-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-50" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-202" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.518     0.024     0.472     0.564    21.975    15.600     0.000     3.159     0.785 
## birth_order_nonlinear2       -0.005     0.009    -0.022     0.012    -0.573    84.728     0.568     0.483     0.341 
## birth_order_nonlinear3       -0.016     0.014    -0.043     0.012    -1.124    30.606     0.270     1.185     0.570 
## birth_order_nonlinear4       -0.008     0.017    -0.040     0.025    -0.456    52.560     0.650     0.706     0.435 
## birth_order_nonlinear5       -0.014     0.030    -0.073     0.044    -0.476    23.174     0.638     1.654     0.652 
## poly(age, 3, raw = TRUE)1     0.013     0.003     0.008     0.018     4.990    21.887     0.000     1.787     0.670 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.922    34.883     0.363     1.032     0.534 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.412    50.914     0.164     0.725     0.442 
## male                         -0.018     0.007    -0.032    -0.004    -2.555   119.533     0.012     0.378     0.286 
## sibling_count3                0.012     0.013    -0.013     0.038     0.949    32.503     0.350     1.111     0.553 
## sibling_count4                0.027     0.013     0.002     0.052     2.082   108.002     0.040     0.406     0.301 
## sibling_count5                0.045     0.016     0.014     0.076     2.864    78.553     0.005     0.512     0.355 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.029 
## Residual~~Residual                     0.180 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-202" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-513-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-50" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-203" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.502     0.025     0.453     0.550    20.251    16.529     0.000     2.816     0.765 
## count_birth_order2/2          0.015     0.013    -0.011     0.040     1.133    57.695     0.262     0.653     0.415 
## count_birth_order1/3          0.029     0.018    -0.006     0.064     1.640    34.798     0.110     1.035     0.535 
## count_birth_order2/3         -0.002     0.015    -0.032     0.028    -0.133    75.021     0.894     0.530     0.363 
## count_birth_order3/3          0.016     0.016    -0.015     0.047     1.029    58.306     0.308     0.647     0.413 
## count_birth_order1/4          0.043     0.017     0.009     0.077     2.456   269.031     0.015     0.224     0.189 
## count_birth_order2/4          0.029     0.021    -0.012     0.070     1.377    47.828     0.175     0.766     0.456 
## count_birth_order3/4          0.004     0.022    -0.039     0.047     0.190    32.508     0.851     1.110     0.553 
## count_birth_order4/4          0.037     0.019     0.001     0.074     2.007    60.132     0.049     0.631     0.406 
## count_birth_order1/5          0.066     0.022     0.022     0.110     2.955   164.681     0.004     0.305     0.243 
## count_birth_order2/5          0.056     0.021     0.014     0.098     2.640   619.680     0.009     0.137     0.123 
## count_birth_order3/5          0.035     0.023    -0.010     0.080     1.528    87.884     0.130     0.471     0.335 
## count_birth_order4/5          0.030     0.021    -0.011     0.072     1.442   198.293     0.151     0.271     0.221 
## count_birth_order5/5          0.041     0.028    -0.015     0.096     1.445    23.164     0.162     1.655     0.652 
## poly(age, 3, raw = TRUE)1     0.014     0.003     0.009     0.019     5.240    21.229     0.000     1.866     0.680 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.360    33.333     0.183     1.082     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.941    48.686     0.351     0.754     0.452 
## male                         -0.018     0.007    -0.032    -0.004    -2.553   120.867     0.012     0.375     0.285 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.029 
## Residual~~Residual                     0.180 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-203" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-515-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-50" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.788       6 130.035   0.581   1.639 
##  2 vs 3:  -0.009       3  42.406   1.000   3.169 
##  3 vs 4:   0.215       1  10.975   0.652   4.296</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-25" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-51" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-204" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.491     0.022     0.448     0.533    22.618    13.319     0.000     4.619     0.844 
## poly(age, 3, raw = TRUE)1     0.019     0.002     0.015     0.023     9.395    24.588     0.000     1.532     0.634 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.623    32.451     0.000     1.113     0.553 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.702    34.136     0.098     1.055     0.540 
## male                         -0.017     0.007    -0.030    -0.003    -2.397    52.732     0.020     0.704     0.434 
## sibling_count3                0.012     0.008    -0.003     0.028     1.557   232.989     0.121     0.245     0.203 
## sibling_count4                0.024     0.012     0.001     0.048     2.030    38.407     0.049     0.938     0.509 
## sibling_count5                0.026     0.012     0.004     0.049     2.270   204.318     0.024     0.266     0.218 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.172 
## ICC|mother_pidlink                     0.137 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-204" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-518-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-51" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-205" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.475     0.026     0.424     0.526    18.232    13.480     0.000     4.467     0.839 
## birth_order                   0.007     0.004    -0.001     0.015     1.665    32.133     0.106     1.124     0.556 
## poly(age, 3, raw = TRUE)1     0.019     0.002     0.015     0.023     8.868    21.023     0.000     1.893     0.683 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.483    27.591     0.000     1.332     0.599 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.701    30.265     0.099     1.199     0.573 
## male                         -0.017     0.007    -0.031    -0.003    -2.377    50.297     0.021     0.733     0.445 
## sibling_count3                0.008     0.008    -0.008     0.024     0.991   303.689     0.322     0.208     0.178 
## sibling_count4                0.015     0.013    -0.010     0.040     1.205    40.722     0.235     0.887     0.494 
## sibling_count5                0.013     0.013    -0.013     0.039     0.990   193.112     0.323     0.275     0.224 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.172 
## ICC|mother_pidlink                     0.137 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-205" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-520-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-51" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-206" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.487     0.023     0.442     0.533    20.972    14.301     0.000     3.838     0.817 
## birth_order_nonlinear2        0.002     0.009    -0.016     0.019     0.186    37.300     0.853     0.965     0.516 
## birth_order_nonlinear3        0.011     0.013    -0.015     0.036     0.821    28.008     0.419     1.309     0.595 
## birth_order_nonlinear4        0.012     0.015    -0.017     0.041     0.805    75.305     0.424     0.528     0.362 
## birth_order_nonlinear5        0.029     0.026    -0.022     0.079     1.120    42.056     0.269     0.861     0.486 
## poly(age, 3, raw = TRUE)1     0.019     0.002     0.015     0.023     8.869    22.881     0.000     1.682     0.656 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.361    31.633     0.000     1.143     0.560 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.483    33.866     0.147     1.064     0.542 
## male                         -0.016     0.007    -0.030    -0.002    -2.213    46.447     0.032     0.786     0.463 
## sibling_count3                0.008     0.008    -0.008     0.025     0.991   295.329     0.323     0.211     0.180 
## sibling_count4                0.017     0.012    -0.006     0.040     1.485    83.038     0.141     0.491     0.345 
## sibling_count5                0.014     0.014    -0.014     0.042     0.992   112.057     0.323     0.395     0.296 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.171 
## ICC|mother_pidlink                     0.137 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-206" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-522-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-51" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-207" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.469     0.025     0.421     0.517    18.988    14.735     0.000     3.578     0.806 
## count_birth_order2/2          0.024     0.015    -0.004     0.053     1.668    22.644     0.109     1.706     0.659 
## count_birth_order1/3          0.028     0.016    -0.004     0.060     1.705    32.708     0.098     1.103     0.551 
## count_birth_order2/3          0.005     0.013    -0.020     0.030     0.384    78.528     0.702     0.512     0.355 
## count_birth_order3/3          0.038     0.018     0.003     0.072     2.140    25.093     0.042     1.493     0.627 
## count_birth_order1/4          0.043     0.019     0.005     0.081     2.220    61.591     0.030     0.619     0.401 
## count_birth_order2/4          0.023     0.015    -0.007     0.053     1.494   247.448     0.136     0.236     0.197 
## count_birth_order3/4          0.029     0.016    -0.002     0.060     1.835   207.820     0.068     0.263     0.216 
## count_birth_order4/4          0.038     0.018     0.002     0.074     2.068    59.008     0.043     0.641     0.410 
## count_birth_order1/5          0.032     0.024    -0.015     0.079     1.345   143.780     0.181     0.334     0.260 
## count_birth_order2/5          0.014     0.029    -0.043     0.072     0.489    27.818     0.629     1.319     0.597 
## count_birth_order3/5          0.030     0.024    -0.018     0.078     1.225    48.101     0.226     0.762     0.455 
## count_birth_order4/5          0.039     0.026    -0.012     0.090     1.491    35.035     0.145     1.028     0.533 
## count_birth_order5/5          0.053     0.026     0.003     0.103     2.059    46.861     0.045     0.780     0.461 
## poly(age, 3, raw = TRUE)1     0.020     0.002     0.015     0.024     8.690    20.874     0.000     1.912     0.685 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.579    29.715     0.000     1.224     0.578 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.775    33.543     0.085     1.075     0.544 
## male                         -0.016     0.008    -0.031    -0.001    -2.079    40.453     0.044     0.893     0.496 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.172 
## ICC|mother_pidlink                     0.136 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-207" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-524-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-51" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.282       6  54.409   1.000 235.791 
##  2 vs 3:  -0.270       3  27.087   1.000 491.234 
##  3 vs 4:  -0.362       1   9.046   1.000 170.286</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-25" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-526-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="work" class="section level2 tabset">
<h2>Work</h2>
<div id="income-last-month-log---z-standardized" class="section level3 tabset">
<h3>Income Last Month (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_month_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-26" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-52" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-208" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.158     0.048    -0.252    -0.064    -3.311    14.104     0.005     3.971     0.822 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.007     0.010     0.437    40.089     0.664     0.900     0.498 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.590    80.951     0.116     0.500     0.349 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.822    64.972     0.073     0.593     0.391 
## male                          0.065     0.026     0.013     0.117     2.451    15.818     0.026     3.070     0.780 
## sibling_count3                0.018     0.025    -0.031     0.068     0.716    35.461     0.479     1.015     0.530 
## sibling_count4                0.019     0.027    -0.033     0.071     0.718    51.318     0.476     0.721     0.440 
## sibling_count5                0.011     0.029    -0.047     0.068     0.366    57.557     0.716     0.654     0.415 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.101 
## Residual~~Residual                     0.890 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-208" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-528-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-52" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-209" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.177     0.053    -0.282    -0.073    -3.327    16.521     0.004     2.818     0.765 
## birth_order                   0.008     0.011    -0.013     0.030     0.753    28.005     0.458     1.309     0.595 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.628    38.266     0.534     0.942     0.510 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.355    66.575     0.180     0.581     0.386 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.635    58.073     0.108     0.649     0.414 
## male                          0.065     0.027     0.013     0.117     2.432    15.720     0.027     3.109     0.783 
## sibling_count3                0.013     0.026    -0.039     0.065     0.484    33.470     0.631     1.077     0.545 
## sibling_count4                0.008     0.026    -0.043     0.060     0.321   117.600     0.749     0.382     0.289 
## sibling_count5               -0.005     0.032    -0.067     0.057    -0.163   106.109     0.871     0.411     0.304 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.101 
## Residual~~Residual                     0.890 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-209" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-530-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-52" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-210" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.172     0.051    -0.272    -0.072    -3.382    15.650     0.004     3.138     0.784 
## birth_order_nonlinear2        0.014     0.019    -0.024     0.052     0.737    86.338     0.463     0.477     0.338 
## birth_order_nonlinear3        0.011     0.037    -0.060     0.083     0.312    19.323     0.758     2.149     0.711 
## birth_order_nonlinear4        0.028     0.043    -0.057     0.113     0.649    26.559     0.522     1.393     0.610 
## birth_order_nonlinear5        0.038     0.062    -0.085     0.160     0.601    26.996     0.553     1.366     0.606 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.617    34.099     0.541     1.057     0.540 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.278    51.698     0.207     0.716     0.439 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.540    45.575     0.131     0.800     0.467 
## male                          0.065     0.027     0.012     0.117     2.429    15.725     0.028     3.107     0.783 
## sibling_count3                0.016     0.028    -0.039     0.070     0.574    33.096     0.570     1.090     0.548 
## sibling_count4                0.011     0.025    -0.039     0.060     0.420   346.855     0.675     0.192     0.166 
## sibling_count5               -0.004     0.034    -0.070     0.063    -0.110    72.845     0.913     0.542     0.369 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.101 
## Residual~~Residual                     0.890 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-210" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-532-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-52" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-211" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.168     0.048    -0.263    -0.073    -3.458    19.571     0.003     2.107     0.707 
## count_birth_order2/2          0.008     0.028    -0.047     0.062     0.274    71.703     0.785     0.549     0.372 
## count_birth_order1/3          0.010     0.034    -0.057     0.078     0.293    62.434     0.771     0.612     0.399 
## count_birth_order2/3          0.028     0.033    -0.036     0.091     0.850    97.087     0.397     0.438     0.318 
## count_birth_order3/3          0.026     0.041    -0.054     0.106     0.630    26.640     0.534     1.388     0.609 
## count_birth_order1/4          0.015     0.047    -0.078     0.107     0.308    40.850     0.760     0.885     0.494 
## count_birth_order2/4          0.020     0.040    -0.059     0.099     0.494   115.193     0.622     0.388     0.292 
## count_birth_order3/4          0.019     0.048    -0.074     0.113     0.405    32.935     0.688     1.095     0.549 
## count_birth_order4/4          0.031     0.049    -0.064     0.126     0.633    27.695     0.532     1.326     0.598 
## count_birth_order1/5         -0.029     0.050    -0.127     0.070    -0.575   120.858     0.566     0.375     0.285 
## count_birth_order2/5          0.028     0.058    -0.085     0.142     0.487    47.464     0.629     0.771     0.458 
## count_birth_order3/5         -0.003     0.067    -0.133     0.128    -0.044    23.828     0.965     1.595     0.643 
## count_birth_order4/5          0.030     0.069    -0.105     0.165     0.437    21.409     0.666     1.844     0.677 
## count_birth_order5/5          0.031     0.053    -0.073     0.134     0.584    37.505     0.563     0.960     0.515 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.582    41.220     0.564     0.877     0.491 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.297    52.097     0.200     0.711     0.437 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.548    44.961     0.129     0.810     0.470 
## male                          0.065     0.027     0.012     0.117     2.422    15.685     0.028     3.124     0.783 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.101 
## Residual~~Residual                     0.889 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-211" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-534-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-52" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.162       6 112.366   0.986   2.039 
##  2 vs 3:   0.216       3  39.391   0.885   3.851 
##  3 vs 4:   0.572       1  10.978   0.465   4.289</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-26" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-53" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-212" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.164     0.040    -0.243    -0.084    -4.048    16.168     0.001     2.938     0.773 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.004     0.011     0.851    42.757     0.399     0.848     0.482 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.703   166.194     0.090     0.303     0.242 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.343   175.691     0.020     0.293     0.235 
## male                          0.070     0.024     0.023     0.116     2.931    16.231     0.010     2.916     0.771 
## sibling_count3                0.014     0.020    -0.026     0.053     0.691    58.438     0.492     0.646     0.412 
## sibling_count4               -0.002     0.030    -0.060     0.057    -0.062    24.928     0.951     1.505     0.629 
## sibling_count5               -0.004     0.035    -0.072     0.065    -0.107    26.274     0.916     1.411     0.614 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.891 
## ICC|mother_pidlink                     0.103 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-212" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-537-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-53" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-213" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.170     0.046    -0.260    -0.080    -3.702    17.885     0.002     2.441     0.737 
## birth_order                   0.003     0.008    -0.012     0.018     0.422   117.576     0.673     0.382     0.289 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.004     0.011     0.861    38.240     0.395     0.942     0.510 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.666   153.008     0.098     0.320     0.252 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.338   184.958     0.020     0.283     0.229 
## male                          0.070     0.024     0.024     0.116     2.965    16.552     0.009     2.808     0.764 
## sibling_count3                0.012     0.020    -0.028     0.052     0.590    69.611     0.557     0.561     0.377 
## sibling_count4               -0.006     0.034    -0.072     0.060    -0.176    22.431     0.862     1.728     0.662 
## sibling_count5               -0.011     0.036    -0.081     0.059    -0.317    36.765     0.753     0.979     0.520 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.891 
## ICC|mother_pidlink                     0.103 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-213" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-539-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-53" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-214" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.168     0.046    -0.257    -0.078    -3.677    16.643     0.002     2.779     0.762 
## birth_order_nonlinear2        0.008     0.020    -0.031     0.047     0.404    40.281     0.688     0.896     0.497 
## birth_order_nonlinear3        0.016     0.026    -0.034     0.066     0.612    45.848     0.544     0.796     0.466 
## birth_order_nonlinear4       -0.010     0.032    -0.072     0.052    -0.309   118.044     0.758     0.381     0.288 
## birth_order_nonlinear5       -0.002     0.051    -0.103     0.098    -0.043    90.172     0.966     0.462     0.331 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.005     0.011     0.826    36.292     0.414     0.992     0.524 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.629   126.439     0.106     0.364     0.278 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.310   177.884     0.022     0.290     0.234 
## male                          0.069     0.024     0.022     0.116     2.899    16.501     0.010     2.825     0.765 
## sibling_count3                0.010     0.020    -0.030     0.050     0.483    85.656     0.630     0.480     0.339 
## sibling_count4               -0.004     0.032    -0.067     0.058    -0.129    28.632     0.898     1.276     0.588 
## sibling_count5               -0.007     0.036    -0.078     0.065    -0.180    40.471     0.858     0.892     0.496 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.891 
## ICC|mother_pidlink                     0.103 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-214" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-541-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-53" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-215" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.170     0.045    -0.258    -0.082    -3.788    19.869     0.001     2.058     0.702 
## count_birth_order2/2          0.010     0.027    -0.042     0.063     0.390    47.575     0.698     0.770     0.457 
## count_birth_order1/3          0.012     0.031    -0.049     0.073     0.388    73.536     0.699     0.538     0.367 
## count_birth_order2/3          0.013     0.029    -0.044     0.070     0.444    78.409     0.658     0.512     0.355 
## count_birth_order3/3          0.026     0.034    -0.041     0.092     0.759    42.617     0.452     0.850     0.483 
## count_birth_order1/4         -0.025     0.056    -0.135     0.085    -0.445    22.948     0.661     1.676     0.655 
## count_birth_order2/4         -0.003     0.044    -0.089     0.083    -0.062    35.976     0.951     1.001     0.526 
## count_birth_order3/4          0.023     0.046    -0.068     0.114     0.495    30.550     0.624     1.187     0.570 
## count_birth_order4/4         -0.004     0.052    -0.107     0.098    -0.085    23.547     0.933     1.619     0.647 
## count_birth_order1/5         -0.000     0.064    -0.126     0.125    -0.006    41.067     0.996     0.880     0.492 
## count_birth_order2/5          0.003     0.067    -0.128     0.134     0.045    26.408     0.965     1.403     0.612 
## count_birth_order3/5          0.004     0.065    -0.124     0.132     0.060    24.909     0.952     1.507     0.630 
## count_birth_order4/5         -0.030     0.054    -0.137     0.076    -0.561    47.881     0.577     0.765     0.456 
## count_birth_order5/5         -0.005     0.059    -0.120     0.109    -0.093    43.220     0.926     0.839     0.480 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.004     0.011     0.957    60.115     0.342     0.631     0.406 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.581   156.099     0.116     0.316     0.250 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.255   182.002     0.025     0.286     0.231 
## male                          0.070     0.024     0.024     0.117     2.951    16.936     0.009     2.690     0.756 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.103 
## Residual~~Residual                     0.891 
## ICC|mother_pidlink                     0.104 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-215" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-543-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-53" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.417       6  54.409   0.864 235.786 
##  2 vs 3:   0.445       3  27.087   0.723 491.008 
##  3 vs 4:   0.377       1   9.046   0.554 169.220</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-26" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-545-1.png" width="672" /></p>
</div>
</div>
<div id="income-last-year-log---z-standardized" class="section level3 tabset">
<h3>Income last year (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_year_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-27" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-54" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-216" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.392     0.045    -0.480    -0.304    -8.738    14.733     0.000     3.578     0.806 
## poly(age, 3, raw = TRUE)1     0.013     0.004     0.006     0.021     3.403    59.114     0.001     0.640     0.410 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.776   153.495     0.078     0.320     0.252 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.232    88.537     0.028     0.468     0.334 
## male                          0.072     0.018     0.036     0.108     3.947    34.896     0.000     1.032     0.534 
## sibling_count3                0.007     0.025    -0.042     0.056     0.289    34.535     0.775     1.043     0.537 
## sibling_count4                0.021     0.029    -0.036     0.077     0.713    32.853     0.481     1.098     0.550 
## sibling_count5                0.016     0.033    -0.049     0.081     0.489    31.077     0.628     1.165     0.565 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.833 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-216" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-547-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-54" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-217" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.403     0.050    -0.501    -0.305    -8.065    17.650     0.000     2.498     0.742 
## birth_order                   0.005     0.011    -0.017     0.026     0.431    27.682     0.670     1.327     0.598 
## poly(age, 3, raw = TRUE)1     0.014     0.004     0.006     0.022     3.313    49.346     0.002     0.745     0.449 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.562    91.850     0.122     0.456     0.328 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.050    67.291     0.044     0.577     0.384 
## male                          0.072     0.018     0.036     0.108     3.921    34.188     0.000     1.054     0.539 
## sibling_count3                0.004     0.028    -0.051     0.060     0.152    25.903     0.881     1.436     0.618 
## sibling_count4                0.015     0.030    -0.045     0.074     0.481    39.100     0.633     0.922     0.504 
## sibling_count5                0.007     0.037    -0.065     0.079     0.198    37.824     0.844     0.952     0.513 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.833 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-217" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-549-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-54" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-218" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.401     0.048    -0.494    -0.308    -8.419    16.651     0.000     2.776     0.762 
## birth_order_nonlinear2        0.010     0.019    -0.027     0.048     0.548    71.130     0.585     0.552     0.373 
## birth_order_nonlinear3        0.000     0.032    -0.063     0.064     0.007    23.821     0.994     1.595     0.643 
## birth_order_nonlinear4        0.012     0.041    -0.069     0.092     0.284    28.413     0.778     1.287     0.591 
## birth_order_nonlinear5        0.037     0.055    -0.071     0.145     0.673    37.927     0.505     0.950     0.512 
## poly(age, 3, raw = TRUE)1     0.014     0.004     0.006     0.022     3.269    47.832     0.002     0.766     0.456 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.528    80.775     0.130     0.501     0.350 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -1.990    57.982     0.051     0.650     0.414 
## male                          0.072     0.018     0.036     0.108     3.918    34.316     0.000     1.050     0.538 
## sibling_count3                0.009     0.029    -0.048     0.066     0.304    27.194     0.763     1.355     0.603 
## sibling_count4                0.019     0.029    -0.038     0.076     0.665    60.307     0.509     0.629     0.406 
## sibling_count5                0.007     0.039    -0.069     0.083     0.180    33.975     0.858     1.061     0.541 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.833 
## ICC|mother_pidlink                     0.119 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-218" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-551-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-54" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-219" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.403     0.044    -0.489    -0.317    -9.191    23.103     0.000     1.661     0.653 
## count_birth_order2/2          0.011     0.029    -0.045     0.067     0.391    50.332     0.698     0.733     0.445 
## count_birth_order1/3          0.004     0.036    -0.067     0.075     0.114    40.628     0.910     0.889     0.495 
## count_birth_order2/3          0.016     0.034    -0.052     0.083     0.452    53.848     0.653     0.692     0.430 
## count_birth_order3/3          0.017     0.039    -0.060     0.094     0.426    27.879     0.673     1.316     0.596 
## count_birth_order1/4          0.034     0.050    -0.063     0.132     0.694    30.185     0.493     1.203     0.573 
## count_birth_order2/4          0.025     0.039    -0.053     0.102     0.627   117.434     0.532     0.383     0.289 
## count_birth_order3/4          0.009     0.043    -0.076     0.093     0.199    45.384     0.843     0.803     0.468 
## count_birth_order4/4          0.032     0.044    -0.054     0.119     0.735    35.991     0.467     1.000     0.526 
## count_birth_order1/5         -0.005     0.059    -0.120     0.110    -0.087    37.551     0.931     0.959     0.515 
## count_birth_order2/5          0.040     0.059    -0.076     0.155     0.671    39.190     0.506     0.920     0.504 
## count_birth_order3/5          0.001     0.070    -0.136     0.137     0.009    20.326     0.993     1.989     0.694 
## count_birth_order4/5          0.016     0.064    -0.110     0.142     0.251    23.523     0.804     1.622     0.647 
## count_birth_order5/5          0.044     0.052    -0.058     0.147     0.844    34.944     0.404     1.030     0.533 
## poly(age, 3, raw = TRUE)1     0.014     0.004     0.006     0.022     3.481    69.851     0.001     0.560     0.377 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.437    93.829     0.154     0.449     0.324 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.912    62.398     0.060     0.612     0.399 
## male                          0.072     0.018     0.036     0.108     3.892    33.694     0.000     1.070     0.543 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.833 
## ICC|mother_pidlink                     0.119 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-219" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-553-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-54" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.212       6 107.159   0.972   2.207 
##  2 vs 3:   0.292       3  41.095   0.831   3.430 
##  3 vs 4:   0.509       1  10.977   0.490   4.291</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-27" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-55" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-220" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.398     0.041    -0.478    -0.319    -9.821    15.625     0.000     3.148     0.785 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.008     0.023     4.170    41.563     0.000     0.870     0.489 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.442   127.762     0.152     0.361     0.277 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.271   106.284     0.025     0.410     0.304 
## male                          0.076     0.020     0.037     0.116     3.788    20.629     0.001     1.946     0.689 
## sibling_count3                0.002     0.021    -0.039     0.044     0.117    40.101     0.907     0.900     0.498 
## sibling_count4               -0.002     0.024    -0.049     0.045    -0.088    58.513     0.930     0.645     0.412 
## sibling_count5               -0.018     0.032    -0.080     0.044    -0.568    35.475     0.574     1.015     0.529 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-220" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-556-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-55" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-221" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.408     0.042    -0.491    -0.326    -9.724    20.284     0.000     1.995     0.695 
## birth_order                   0.005     0.008    -0.011     0.021     0.582    66.639     0.562     0.581     0.386 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.008     0.023     4.190    41.945     0.000     0.863     0.487 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.396   119.937     0.165     0.377     0.286 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.247   104.165     0.027     0.416     0.307 
## male                          0.076     0.020     0.037     0.115     3.815    20.998     0.001     1.896     0.683 
## sibling_count3               -0.000     0.021    -0.042     0.041    -0.017    48.187     0.987     0.761     0.454 
## sibling_count4               -0.008     0.026    -0.058     0.042    -0.308    60.524     0.759     0.628     0.405 
## sibling_count5               -0.028     0.032    -0.091     0.035    -0.881    59.040     0.382     0.641     0.410 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.836 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-221" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-558-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-55" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-222" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.402     0.044    -0.488    -0.315    -9.085    16.920     0.000     2.695     0.757 
## birth_order_nonlinear2        0.007     0.019    -0.031     0.045     0.343    40.168     0.733     0.899     0.498 
## birth_order_nonlinear3        0.014     0.028    -0.042     0.069     0.485    28.033     0.632     1.307     0.595 
## birth_order_nonlinear4       -0.001     0.038    -0.075     0.073    -0.028    33.528     0.978     1.075     0.544 
## birth_order_nonlinear5        0.005     0.047    -0.088     0.098     0.103   151.812     0.918     0.322     0.253 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.008     0.023     3.947    36.452     0.000     0.988     0.522 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.350    87.967     0.180     0.470     0.335 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.193    95.459     0.031     0.443     0.321 
## male                          0.075     0.020     0.035     0.115     3.678    20.714     0.001     1.934     0.688 
## sibling_count3               -0.002     0.020    -0.042     0.038    -0.104    79.172     0.917     0.509     0.353 
## sibling_count4               -0.006     0.025    -0.056     0.043    -0.249    89.391     0.804     0.465     0.332 
## sibling_count5               -0.024     0.032    -0.087     0.039    -0.746    77.189     0.458     0.519     0.358 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.111 
## Residual~~Residual                     0.837 
## ICC|mother_pidlink                     0.117 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-222" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-560-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-55" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-223" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.406     0.044    -0.492    -0.319    -9.182    19.696     0.000     2.086     0.705 
## count_birth_order2/2          0.010     0.027    -0.043     0.063     0.370    38.585     0.713     0.934     0.508 
## count_birth_order1/3         -0.005     0.030    -0.064     0.053    -0.180    87.572     0.857     0.472     0.336 
## count_birth_order2/3          0.005     0.028    -0.051     0.060     0.162    79.256     0.872     0.508     0.353 
## count_birth_order3/3          0.013     0.042    -0.070     0.095     0.306    20.452     0.763     1.971     0.692 
## count_birth_order1/4         -0.012     0.045    -0.100     0.076    -0.274    45.673     0.785     0.798     0.467 
## count_birth_order2/4         -0.014     0.044    -0.099     0.072    -0.319    33.782     0.752     1.067     0.542 
## count_birth_order3/4          0.014     0.042    -0.068     0.095     0.326    42.246     0.746     0.857     0.485 
## count_birth_order4/4          0.005     0.045    -0.083     0.093     0.107    34.746     0.915     1.036     0.535 
## count_birth_order1/5         -0.008     0.068    -0.141     0.125    -0.112    29.807     0.911     1.220     0.577 
## count_birth_order2/5         -0.016     0.063    -0.141     0.108    -0.257    28.522     0.799     1.282     0.590 
## count_birth_order3/5         -0.011     0.061    -0.131     0.110    -0.175    27.368     0.862     1.344     0.602 
## count_birth_order4/5         -0.043     0.061    -0.162     0.076    -0.708    27.901     0.485     1.315     0.596 
## count_birth_order5/5         -0.020     0.057    -0.131     0.092    -0.347    43.684     0.730     0.831     0.477 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.008     0.024     4.119    45.555     0.000     0.800     0.467 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.237    81.648     0.220     0.497     0.348 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.075    82.103     0.041     0.495     0.347 
## male                          0.076     0.021     0.036     0.117     3.677    20.338     0.001     1.987     0.694 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.836 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-223" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-562-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-55" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.411       6  54.409   0.869 236.104 
##  2 vs 3:   0.388       3  27.087   0.763 491.331 
##  3 vs 4:   0.349       1   9.046   0.569 169.548</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-27" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-564-1.png" width="672" /></p>
</div>
</div>
<div id="self-employment---non-standardized" class="section level3 tabset">
<h3>Self-Employment - non standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = Self_employed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-28" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-56" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-224" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.155     0.057     0.043     0.267     2.722    11.940     0.019     6.586     0.886 
## poly(age, 3, raw = TRUE)1    -0.001     0.005    -0.011     0.009    -0.231    22.147     0.820     1.758     0.666 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.025    30.363     0.313     1.195     0.572 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.786    35.001     0.437     1.029     0.533 
## male                          0.069     0.018     0.034     0.103     3.899    38.929     0.000     0.926     0.506 
## sibling_count3               -0.005     0.025    -0.054     0.043    -0.214    32.740     0.832     1.102     0.551 
## sibling_count4               -0.011     0.033    -0.075     0.054    -0.318    20.869     0.753     1.913     0.685 
## sibling_count5               -0.013     0.031    -0.074     0.049    -0.408    33.661     0.686     1.071     0.543 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.843 
## ICC|mother_pidlink                     0.090 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-224" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-566-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-56" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-225" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.151     0.083    -0.013     0.314     1.807    11.113     0.098     8.991     0.914 
## birth_order                   0.002     0.014    -0.025     0.029     0.137    16.424     0.893     2.850     0.767 
## poly(age, 3, raw = TRUE)1    -0.001     0.006    -0.013     0.011    -0.159    17.294     0.875     2.589     0.749 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.893    23.638     0.381     1.611     0.646 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.704    28.347     0.487     1.291     0.591 
## male                          0.069     0.018     0.034     0.103     3.897    39.019     0.000     0.924     0.505 
## sibling_count3               -0.006     0.023    -0.051     0.038    -0.283    55.019     0.778     0.679     0.425 
## sibling_count4               -0.013     0.028    -0.068     0.042    -0.464    53.099     0.645     0.700     0.433 
## sibling_count5               -0.016     0.037    -0.089     0.056    -0.446    33.724     0.658     1.069     0.543 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.843 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-225" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-568-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-56" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-226" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.148     0.070     0.010     0.285     2.101    11.586     0.058     7.429     0.898 
## birth_order_nonlinear2        0.009     0.024    -0.037     0.055     0.397    27.448     0.694     1.340     0.601 
## birth_order_nonlinear3        0.008     0.037    -0.064     0.081     0.225    17.974     0.824     2.420     0.736 
## birth_order_nonlinear4        0.007     0.047    -0.085     0.098     0.144    20.578     0.887     1.953     0.690 
## birth_order_nonlinear5       -0.001     0.060    -0.118     0.115    -0.022    28.464     0.982     1.285     0.590 
## poly(age, 3, raw = TRUE)1    -0.001     0.006    -0.012     0.011    -0.123    18.034     0.903     2.407     0.734 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.868    25.755     0.393     1.446     0.620 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.674    31.851     0.505     1.135     0.558 
## male                          0.069     0.018     0.034     0.103     3.892    39.003     0.000     0.924     0.505 
## sibling_count3               -0.007     0.024    -0.054     0.040    -0.281    56.511     0.780     0.664     0.419 
## sibling_count4               -0.012     0.028    -0.067     0.042    -0.444    67.947     0.658     0.572     0.382 
## sibling_count5               -0.013     0.038    -0.088     0.062    -0.338    33.060     0.737     1.091     0.548 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.843 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-226" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-570-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-56" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-227" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.069     0.022     0.291     2.276    12.437     0.041     5.696     0.870 
## count_birth_order2/2         -0.004     0.032    -0.065     0.058    -0.115    32.652     0.909     1.105     0.552 
## count_birth_order1/3         -0.024     0.031    -0.086     0.037    -0.776   102.240     0.439     0.422     0.310 
## count_birth_order2/3          0.005     0.044    -0.082     0.092     0.115    21.245     0.909     1.864     0.680 
## count_birth_order3/3         -0.002     0.047    -0.094     0.089    -0.051    18.390     0.960     2.329     0.728 
## count_birth_order1/4         -0.011     0.043    -0.095     0.074    -0.253    54.253     0.801     0.687     0.428 
## count_birth_order2/4          0.001     0.043    -0.084     0.085     0.016    53.488     0.987     0.695     0.431 
## count_birth_order3/4         -0.016     0.057    -0.127     0.095    -0.288    19.412     0.777     2.134     0.709 
## count_birth_order4/4         -0.021     0.052    -0.123     0.081    -0.395    21.342     0.697     1.852     0.678 
## count_birth_order1/5         -0.030     0.051    -0.129     0.069    -0.589    85.229     0.557     0.481     0.340 
## count_birth_order2/5         -0.016     0.071    -0.154     0.122    -0.227    21.775     0.822     1.800     0.672 
## count_birth_order3/5         -0.010     0.046    -0.100     0.081    -0.208   143.366     0.835     0.334     0.261 
## count_birth_order4/5          0.003     0.064    -0.122     0.127     0.045    23.823     0.964     1.595     0.643 
## count_birth_order5/5         -0.021     0.051    -0.121     0.079    -0.408    37.347     0.686     0.964     0.516 
## poly(age, 3, raw = TRUE)1    -0.001     0.006    -0.012     0.010    -0.204    20.107     0.841     2.022     0.698 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.973    29.970     0.338     1.212     0.575 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.761    36.926     0.451     0.975     0.519 
## male                          0.068     0.018     0.034     0.103     3.889    39.247     0.000     0.919     0.504 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.843 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-227" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-572-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-56" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.285       6 106.049   0.943   2.247 
##  2 vs 3:   0.255       3  42.216   0.857   3.204 
##  3 vs 4:   0.237       1  10.463   0.637   5.678</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-28" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-57" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-228" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.056     0.047     0.267     2.789    11.479     0.017     7.732     0.901 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.008    -0.405    17.476     0.690     2.542     0.745 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.458    26.361     0.157     1.406     0.613 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.223    37.876     0.229     0.951     0.513 
## male                          0.065     0.015     0.035     0.096     4.253    42.718     0.000     0.848     0.483 
## sibling_count3               -0.004     0.023    -0.049     0.041    -0.161    25.206     0.873     1.485     0.626 
## sibling_count4               -0.008     0.027    -0.062     0.045    -0.301    25.876     0.766     1.438     0.618 
## sibling_count5                0.011     0.027    -0.043     0.064     0.397    53.660     0.693     0.694     0.430 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.074 
## Residual~~Residual                     0.798 
## ICC|mother_pidlink                     0.085 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-228" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-575-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-57" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-229" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.061     0.043     0.282     2.676    12.332     0.020     5.864     0.873 
## birth_order                  -0.003     0.008    -0.019     0.014    -0.323    45.149     0.748     0.807     0.469 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.007    -0.449    18.240     0.659     2.361     0.730 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.520    28.592     0.140     1.278     0.589 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.273    42.171     0.210     0.859     0.486 
## male                          0.065     0.015     0.035     0.096     4.246    42.779     0.000     0.847     0.482 
## sibling_count3               -0.002     0.022    -0.044     0.040    -0.098    34.382     0.922     1.048     0.538 
## sibling_count4               -0.005     0.029    -0.061     0.051    -0.183    29.295     0.856     1.244     0.582 
## sibling_count5                0.014     0.031    -0.046     0.074     0.448    55.635     0.656     0.673     0.423 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.074 
## Residual~~Residual                     0.799 
## ICC|mother_pidlink                     0.085 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-229" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-577-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-57" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-230" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.158     0.061     0.038     0.278     2.577    11.865     0.024     6.748     0.888 
## birth_order_nonlinear2       -0.000     0.018    -0.035     0.035    -0.010    53.021     0.992     0.701     0.433 
## birth_order_nonlinear3        0.004     0.024    -0.043     0.050     0.151    49.310     0.880     0.746     0.449 
## birth_order_nonlinear4       -0.014     0.037    -0.086     0.058    -0.372    32.686     0.713     1.104     0.551 
## birth_order_nonlinear5       -0.016     0.059    -0.131     0.099    -0.277    31.693     0.784     1.141     0.560 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.008    -0.419    18.147     0.680     2.381     0.732 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.474    29.529     0.151     1.233     0.580 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.255    50.542     0.215     0.730     0.444 
## male                          0.065     0.016     0.034     0.097     4.087    38.373     0.000     0.939     0.509 
## sibling_count3               -0.004     0.023    -0.049     0.041    -0.176    32.173     0.861     1.123     0.556 
## sibling_count4               -0.006     0.030    -0.064     0.052    -0.193    29.068     0.849     1.254     0.584 
## sibling_count5                0.014     0.030    -0.044     0.072     0.487    96.323     0.627     0.440     0.320 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.075 
## Residual~~Residual                     0.801 
## ICC|mother_pidlink                     0.086 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-230" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-579-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-57" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-231" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.059     0.049     0.281     2.788    12.930     0.015     5.034     0.855 
## count_birth_order2/2         -0.012     0.025    -0.061     0.038    -0.454    45.889     0.652     0.795     0.466 
## count_birth_order1/3         -0.013     0.027    -0.067     0.040    -0.488   145.857     0.626     0.331     0.259 
## count_birth_order2/3         -0.004     0.036    -0.074     0.066    -0.110    23.643     0.913     1.611     0.646 
## count_birth_order3/3         -0.008     0.036    -0.079     0.063    -0.216    26.691     0.831     1.385     0.609 
## count_birth_order1/4         -0.032     0.046    -0.121     0.057    -0.706    36.461     0.485     0.987     0.522 
## count_birth_order2/4         -0.016     0.046    -0.105     0.074    -0.342    25.702     0.735     1.449     0.620 
## count_birth_order3/4          0.004     0.040    -0.075     0.082     0.087    42.071     0.931     0.861     0.486 
## count_birth_order4/4         -0.018     0.037    -0.090     0.054    -0.486    85.724     0.628     0.479     0.339 
## count_birth_order1/5          0.010     0.048    -0.085     0.104     0.198   292.811     0.843     0.213     0.181 
## count_birth_order2/5          0.027     0.055    -0.081     0.134     0.487    43.334     0.629     0.837     0.479 
## count_birth_order3/5          0.000     0.044    -0.086     0.086     0.000   175.512     1.000     0.293     0.235 
## count_birth_order4/5         -0.005     0.053    -0.109     0.100    -0.085    38.847     0.933     0.928     0.506 
## count_birth_order5/5         -0.014     0.066    -0.143     0.115    -0.214    23.294     0.832     1.643     0.650 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.007    -0.478    20.730     0.638     1.932     0.688 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.572    36.912     0.125     0.975     0.519 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.298    58.735     0.200     0.643     0.411 
## male                          0.066     0.017     0.033     0.099     3.928    33.357     0.000     1.081     0.546 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.076 
## Residual~~Residual                     0.801 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-231" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-581-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-57" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.366       6  54.410   0.897 235.332 
##  2 vs 3:   0.313       3  27.087   0.816 491.241 
##  3 vs 4:   0.261       1   9.046   0.622 170.174</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-28" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-583-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="smoking-behaviour" class="section level2 tabset">
<h2>Smoking Behaviour</h2>
<div id="ever_smoked" class="section level3 tabset">
<h3>ever_smoked</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = ever_smoked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-29" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-58" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-232" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.157     0.013    -0.182    -0.132   -12.307    19.965     0.000     2.043     0.700 
## poly(age, 3, raw = TRUE)1     0.003     0.001     0.000     0.006     2.204    70.516     0.031     0.556     0.375 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.865    47.957     0.006     0.764     0.455 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.547    46.600     0.001     0.784     0.462 
## male                          0.645     0.006     0.634     0.657   109.596    47.175     0.000     0.776     0.459 
## sibling_count3                0.001     0.009    -0.017     0.019     0.092    30.459     0.927     1.191     0.571 
## sibling_count4                0.008     0.009    -0.009     0.025     0.899    69.485     0.372     0.562     0.378 
## sibling_count5                0.018     0.009    -0.001     0.036     1.858   109.103     0.066     0.403     0.300 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.017 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.145 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-232" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-585-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-58" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-233" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.164     0.014    -0.191    -0.137   -11.837    29.965     0.000     1.213     0.575 
## birth_order                   0.003     0.003    -0.003     0.009     0.915    52.523     0.365     0.706     0.435 
## poly(age, 3, raw = TRUE)1     0.003     0.001     0.001     0.006     2.455    90.474     0.016     0.461     0.330 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.687    52.264     0.010     0.709     0.436 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.408    49.821     0.001     0.739     0.447 
## male                          0.645     0.006     0.634     0.657   109.567    47.163     0.000     0.776     0.459 
## sibling_count3               -0.001     0.009    -0.019     0.017    -0.108    30.896     0.915     1.173     0.567 
## sibling_count4                0.004     0.009    -0.013     0.021     0.478   186.808     0.633     0.281     0.228 
## sibling_count5                0.012     0.011    -0.009     0.033     1.115   132.131     0.267     0.353     0.272 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.017 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.145 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-233" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-587-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-58" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-234" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.162     0.013    -0.187    -0.137   -12.661    29.474     0.000     1.235     0.580 
## birth_order_nonlinear2        0.005     0.006    -0.007     0.016     0.745   151.674     0.458     0.322     0.253 
## birth_order_nonlinear3        0.004     0.009    -0.013     0.021     0.462    74.202     0.646     0.534     0.365 
## birth_order_nonlinear4        0.015     0.013    -0.010     0.040     1.162    39.042     0.252     0.924     0.505 
## birth_order_nonlinear5        0.004     0.015    -0.025     0.034     0.294   197.362     0.769     0.272     0.221 
## poly(age, 3, raw = TRUE)1     0.003     0.001     0.001     0.006     2.485   101.140     0.015     0.425     0.312 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.678    55.880     0.010     0.670     0.422 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.403    53.269     0.001     0.698     0.432 
## male                          0.645     0.006     0.634     0.657   109.442    46.889     0.000     0.780     0.461 
## sibling_count3               -0.000     0.009    -0.018     0.018    -0.005    42.088     0.996     0.860     0.486 
## sibling_count4                0.003     0.009    -0.014     0.021     0.373   279.897     0.709     0.218     0.185 
## sibling_count5                0.013     0.011    -0.007     0.034     1.264   230.663     0.207     0.246     0.204 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.017 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.145 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-234" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-589-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-58" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-235" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.164     0.013    -0.190    -0.138   -12.285    35.194     0.000     1.023     0.532 
## count_birth_order2/2          0.007     0.009    -0.010     0.023     0.757   142.466     0.450     0.336     0.262 
## count_birth_order1/3         -0.004     0.013    -0.030     0.021    -0.319    35.990     0.751     1.000     0.526 
## count_birth_order2/3          0.008     0.011    -0.014     0.030     0.698    77.554     0.487     0.517     0.357 
## count_birth_order3/3          0.007     0.014    -0.021     0.035     0.497    25.619     0.624     1.455     0.621 
## count_birth_order1/4          0.008     0.015    -0.022     0.037     0.513    53.500     0.610     0.695     0.431 
## count_birth_order2/4          0.006     0.013    -0.019     0.031     0.460   315.243     0.646     0.203     0.174 
## count_birth_order3/4          0.010     0.013    -0.015     0.036     0.804   129.366     0.423     0.358     0.275 
## count_birth_order4/4          0.016     0.015    -0.013     0.046     1.096    40.134     0.280     0.900     0.498 
## count_birth_order1/5          0.029     0.016    -0.003     0.061     1.791   218.608     0.075     0.255     0.210 
## count_birth_order2/5          0.009     0.017    -0.025     0.043     0.514   121.016     0.608     0.375     0.284 
## count_birth_order3/5          0.007     0.019    -0.030     0.044     0.359    43.621     0.721     0.832     0.478 
## count_birth_order4/5          0.035     0.018     0.000     0.070     1.988    60.021     0.051     0.632     0.407 
## count_birth_order5/5          0.019     0.015    -0.011     0.049     1.225    88.952     0.224     0.466     0.333 
## poly(age, 3, raw = TRUE)1     0.004     0.001     0.001     0.006     2.500    85.032     0.014     0.482     0.341 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.411    44.299     0.020     0.821     0.474 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.124    42.503     0.003     0.852     0.484 
## male                          0.645     0.006     0.634     0.657   110.061    48.277     0.000     0.760     0.454 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.017 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.145 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-235" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-591-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-58" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.016       6 118.579   1.000   1.874 
##  2 vs 3:  -0.122       3  45.092   1.000   2.750 
##  3 vs 4:   0.043       1  11.369   0.840   3.635</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-29" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-59" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-236" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.170     0.014    -0.197    -0.143   -12.385    16.174     0.000     2.936     0.772 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.295    41.116     0.000     0.879     0.492 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.282    39.735     0.207     0.908     0.500 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.341    36.815     0.025     0.978     0.520 
## male                          0.652     0.005     0.642     0.663   123.249    51.191     0.000     0.722     0.441 
## sibling_count3               -0.001     0.007    -0.015     0.014    -0.092    41.380     0.928     0.874     0.490 
## sibling_count4                0.009     0.008    -0.006     0.025     1.192    83.638     0.237     0.488     0.344 
## sibling_count5                0.024     0.011     0.003     0.045     2.290    42.932     0.027     0.845     0.481 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-236" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-594-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-59" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-237" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.176     0.015    -0.205    -0.147   -11.825    19.517     0.000     2.116     0.708 
## birth_order                   0.003     0.003    -0.003     0.008     0.917    46.872     0.364     0.780     0.461 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.451    43.544     0.000     0.834     0.478 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.179    39.681     0.245     0.909     0.501 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.255    35.959     0.030     1.001     0.526 
## male                          0.652     0.005     0.642     0.663   124.777    55.400     0.000     0.675     0.424 
## sibling_count3               -0.002     0.008    -0.017     0.013    -0.305    41.203     0.762     0.877     0.491 
## sibling_count4                0.006     0.010    -0.013     0.025     0.633    44.117     0.530     0.824     0.475 
## sibling_count5                0.020     0.011    -0.002     0.042     1.761    57.081     0.084     0.659     0.417 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-237" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-596-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-59" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-238" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.174     0.014    -0.202    -0.147   -12.448    19.747     0.000     2.078     0.704 
## birth_order_nonlinear2        0.005     0.006    -0.007     0.018     0.828    49.560     0.411     0.743     0.448 
## birth_order_nonlinear3        0.009     0.008    -0.005     0.024     1.242    98.188     0.217     0.434     0.317 
## birth_order_nonlinear4        0.010     0.012    -0.013     0.033     0.854    52.573     0.397     0.706     0.435 
## birth_order_nonlinear5        0.017     0.019    -0.021     0.054     0.869    44.780     0.390     0.813     0.471 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.421    47.307     0.000     0.774     0.459 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.155    40.350     0.255     0.895     0.497 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.190    36.902     0.035     0.976     0.519 
## male                          0.651     0.005     0.641     0.661   125.843    64.466     0.000     0.597     0.392 
## sibling_count3               -0.003     0.008    -0.018     0.012    -0.424    45.202     0.673     0.806     0.469 
## sibling_count4                0.005     0.009    -0.013     0.023     0.519    56.640     0.606     0.663     0.419 
## sibling_count5                0.019     0.012    -0.005     0.042     1.530    45.379     0.133     0.803     0.468 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.141 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-238" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-598-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-59" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-239" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.175     0.014    -0.202    -0.148   -12.851    26.032     0.000     1.427     0.616 
## count_birth_order2/2          0.007     0.008    -0.008     0.023     0.908   107.626     0.366     0.407     0.302 
## count_birth_order1/3          0.000     0.010    -0.020     0.020     0.017    90.732     0.986     0.460     0.330 
## count_birth_order2/3          0.002     0.010    -0.018     0.022     0.169    54.002     0.866     0.690     0.429 
## count_birth_order3/3          0.006     0.011    -0.017     0.028     0.522    42.488     0.605     0.853     0.484 
## count_birth_order1/4          0.004     0.013    -0.021     0.029     0.316   296.342     0.752     0.211     0.180 
## count_birth_order2/4          0.013     0.016    -0.019     0.045     0.783    25.621     0.441     1.455     0.621 
## count_birth_order3/4          0.017     0.012    -0.007     0.041     1.402   127.333     0.163     0.362     0.277 
## count_birth_order4/4          0.015     0.015    -0.014     0.044     1.025    43.330     0.311     0.837     0.479 
## count_birth_order1/5          0.026     0.018    -0.009     0.062     1.455   157.992     0.148     0.313     0.248 
## count_birth_order2/5          0.024     0.020    -0.015     0.063     1.190    40.168     0.241     0.899     0.498 
## count_birth_order3/5          0.031     0.020    -0.009     0.070     1.517    32.229     0.139     1.121     0.555 
## count_birth_order4/5          0.028     0.017    -0.006     0.061     1.621    73.976     0.109     0.536     0.366 
## count_birth_order5/5          0.035     0.018    -0.001     0.071     1.915    63.578     0.060     0.603     0.395 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.494    65.755     0.000     0.587     0.388 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.131    46.604     0.264     0.784     0.462 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.108    38.935     0.041     0.926     0.506 
## male                          0.651     0.005     0.641     0.661   124.032    63.593     0.000     0.603     0.395 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-239" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-600-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-59" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.531       6  54.410   1.000 235.580 
##  2 vs 3:  -0.577       3  27.087   1.000 491.051 
##  3 vs 4:  -0.541       1   9.046   1.000 170.010</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-29" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-602-1.png" width="672" /></p>
</div>
</div>
<div id="still_smoking" class="section level3 tabset">
<h3>still_smoking</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = still_smoking)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-30" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-60" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-240" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.761     0.035     0.692     0.830    21.682     9.589     0.000    31.037     0.974 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.791    95.700     0.076     0.442     0.321 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.079   135.592     0.937     0.347     0.268 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.107   140.679     0.915     0.339     0.263 
## male                          0.207     0.024     0.160     0.253     8.733     9.457     0.000    39.852     0.979 
## sibling_count3                0.007     0.007    -0.008     0.021     0.906    42.357     0.370     0.855     0.485 
## sibling_count4                0.007     0.009    -0.010     0.025     0.805    31.427     0.427     1.151     0.562 
## sibling_count5                0.010     0.012    -0.014     0.034     0.839    19.308     0.412     2.152     0.711 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.185 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-240" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-604-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-60" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-241" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.761     0.034     0.694     0.828    22.158    10.028     0.000    17.989     0.955 
## birth_order                  -0.000     0.002    -0.005     0.005    -0.046   119.546     0.963     0.378     0.286 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.721    86.211     0.089     0.477     0.338 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.086    99.497     0.931     0.430     0.314 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.113   108.132     0.910     0.405     0.301 
## male                          0.207     0.024     0.160     0.253     8.729     9.457     0.000    39.883     0.979 
## sibling_count3                0.007     0.008    -0.008     0.021     0.879    39.981     0.385     0.903     0.499 
## sibling_count4                0.007     0.010    -0.012     0.026     0.764    32.923     0.450     1.096     0.549 
## sibling_count5                0.011     0.014    -0.016     0.037     0.767    20.459     0.452     1.970     0.692 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.185 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-241" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-606-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-60" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-242" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.035     0.691     0.829    21.580     9.813     0.000    22.640     0.964 
## birth_order_nonlinear2        0.001     0.005    -0.009     0.011     0.237   151.968     0.813     0.322     0.253 
## birth_order_nonlinear3       -0.004     0.006    -0.015     0.008    -0.623  1639.455     0.534     0.080     0.075 
## birth_order_nonlinear4        0.001     0.010    -0.020     0.021     0.051    48.505     0.960     0.757     0.453 
## birth_order_nonlinear5        0.004     0.013    -0.023     0.030     0.261    96.179     0.794     0.441     0.320 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.719    84.161     0.089     0.486     0.342 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.102   126.266     0.919     0.364     0.278 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.129   144.005     0.897     0.333     0.260 
## male                          0.207     0.024     0.160     0.253     8.725     9.457     0.000    39.902     0.979 
## sibling_count3                0.008     0.008    -0.007     0.023     1.062    43.781     0.294     0.829     0.477 
## sibling_count4                0.008     0.010    -0.011     0.028     0.836    32.019     0.409     1.128     0.557 
## sibling_count5                0.010     0.014    -0.017     0.038     0.735    19.803     0.471     2.069     0.703 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.185 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-242" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-608-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-60" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-243" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.757     0.035     0.689     0.825    21.776    10.017     0.000    18.178     0.956 
## count_birth_order2/2          0.006     0.008    -0.009     0.021     0.758    77.876     0.451     0.515     0.356 
## count_birth_order1/3          0.012     0.011    -0.009     0.032     1.087    42.139     0.283     0.859     0.486 
## count_birth_order2/3          0.011     0.010    -0.008     0.030     1.089    66.733     0.280     0.580     0.385 
## count_birth_order3/3          0.007     0.009    -0.011     0.024     0.751   145.886     0.454     0.330     0.258 
## count_birth_order1/4          0.011     0.013    -0.015     0.036     0.816    50.039     0.419     0.736     0.446 
## count_birth_order2/4          0.009     0.012    -0.014     0.033     0.769    72.787     0.444     0.542     0.369 
## count_birth_order3/4          0.009     0.016    -0.022     0.039     0.561    22.757     0.580     1.695     0.658 
## count_birth_order4/4          0.011     0.012    -0.012     0.034     0.939    53.016     0.352     0.701     0.433 
## count_birth_order1/5          0.021     0.017    -0.012     0.054     1.254    39.054     0.217     0.923     0.505 
## count_birth_order2/5          0.007     0.018    -0.028     0.041     0.371    35.760     0.713     1.007     0.527 
## count_birth_order3/5          0.007     0.020    -0.033     0.047     0.331    20.085     0.744     2.025     0.698 
## count_birth_order4/5          0.013     0.019    -0.024     0.050     0.698    23.147     0.492     1.656     0.652 
## count_birth_order5/5          0.017     0.014    -0.011     0.044     1.175    52.196     0.245     0.710     0.436 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.457    61.964     0.150     0.616     0.400 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.034    70.673     0.973     0.555     0.374 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.009    81.373     0.993     0.498     0.348 
## male                          0.207     0.024     0.160     0.253     8.742     9.458     0.000    39.753     0.979 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.185 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-243" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-610-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-60" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.017       6 119.510   1.000   1.852 
##  2 vs 3:  -0.357       3  44.441   1.000   2.840 
##  3 vs 4:  -0.487       1  11.676   1.000   3.254</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-30" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-61" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-244" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.763     0.036     0.692     0.834    21.033     9.490     0.000    37.194     0.978 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.437    39.750     0.158     0.908     0.500 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.298    57.842     0.767     0.651     0.414 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.178    40.079     0.859     0.901     0.498 
## male                          0.206     0.022     0.162     0.250     9.162     9.421     0.000    43.202     0.981 
## sibling_count3                0.002     0.007    -0.012     0.015     0.235    33.158     0.816     1.088     0.547 
## sibling_count4                0.004     0.011    -0.018     0.026     0.345    15.691     0.735     3.121     0.783 
## sibling_count5                0.007     0.012    -0.017     0.031     0.580    18.581     0.569     2.289     0.724 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.183 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-244" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-613-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-61" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-245" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.766     0.038     0.691     0.841    19.937     9.659     0.000    27.805     0.971 
## birth_order                  -0.001     0.003    -0.006     0.004    -0.453    34.533     0.653     1.043     0.537 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.419    34.069     0.165     1.057     0.540 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.276    53.659     0.784     0.694     0.430 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.174    38.401     0.863     0.938     0.509 
## male                          0.206     0.022     0.162     0.250     9.184     9.424     0.000    42.907     0.981 
## sibling_count3                0.002     0.006    -0.010     0.015     0.354    42.143     0.725     0.859     0.486 
## sibling_count4                0.005     0.010    -0.015     0.026     0.517    20.997     0.610     1.896     0.683 
## sibling_count5                0.010     0.011    -0.012     0.031     0.866    31.194     0.393     1.160     0.564 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.183 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-245" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-615-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-61" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-246" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.764     0.037     0.691     0.836    20.628     9.637     0.000    28.757     0.972 
## birth_order_nonlinear2        0.001     0.006    -0.010     0.012     0.137    35.617     0.892     1.011     0.528 
## birth_order_nonlinear3       -0.002     0.008    -0.018     0.015    -0.185    25.560     0.855     1.459     0.622 
## birth_order_nonlinear4       -0.005     0.009    -0.023     0.014    -0.495    69.112     0.622     0.565     0.379 
## birth_order_nonlinear5       -0.002     0.016    -0.034     0.030    -0.135    41.184     0.893     0.878     0.492 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.369    34.336     0.180     1.049     0.538 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.309    53.512     0.759     0.695     0.431 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.224    39.274     0.824     0.918     0.503 
## male                          0.206     0.023     0.162     0.250     9.140     9.432     0.000    42.177     0.981 
## sibling_count3                0.002     0.006    -0.010     0.015     0.376    58.523     0.709     0.645     0.412 
## sibling_count4                0.006     0.011    -0.015     0.027     0.540    20.192     0.595     2.009     0.696 
## sibling_count5                0.009     0.012    -0.014     0.032     0.797    28.323     0.432     1.292     0.592 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.183 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-246" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-617-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-61" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-247" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.762     0.036     0.691     0.834    20.928     9.798     0.000    23.049     0.965 
## count_birth_order2/2          0.003     0.007    -0.012     0.017     0.372    50.001     0.711     0.737     0.446 
## count_birth_order1/3          0.004     0.009    -0.013     0.021     0.438    78.031     0.663     0.514     0.356 
## count_birth_order2/3          0.004     0.009    -0.013     0.022     0.458    46.556     0.649     0.785     0.462 
## count_birth_order3/3          0.003     0.013    -0.022     0.028     0.223    18.871     0.826     2.232     0.719 
## count_birth_order1/4          0.016     0.014    -0.011     0.043     1.151    35.203     0.258     1.023     0.532 
## count_birth_order2/4          0.007     0.014    -0.021     0.034     0.489    25.164     0.629     1.488     0.627 
## count_birth_order3/4          0.002     0.018    -0.034     0.038     0.116    15.451     0.909     3.223     0.789 
## count_birth_order4/4          0.001     0.014    -0.026     0.028     0.068    28.899     0.946     1.263     0.586 
## count_birth_order1/5          0.010     0.020    -0.030     0.050     0.498    27.094     0.622     1.360     0.605 
## count_birth_order2/5          0.015     0.018    -0.021     0.051     0.805    29.411     0.427     1.238     0.581 
## count_birth_order3/5          0.010     0.020    -0.029     0.049     0.492    21.055     0.628     1.888     0.683 
## count_birth_order4/5          0.007     0.016    -0.025     0.039     0.417    36.149     0.679     0.996     0.525 
## count_birth_order5/5          0.007     0.021    -0.035     0.049     0.321    20.173     0.752     2.012     0.697 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.477    70.007     0.144     0.559     0.376 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.417    98.921     0.678     0.432     0.315 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.339    54.248     0.736     0.687     0.428 
## male                          0.206     0.023     0.161     0.251     8.974     9.428     0.000    42.526     0.981 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.183 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-247" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-619-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-61" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.716       6  54.410   1.000 235.551 
##  2 vs 3:  -0.688       3  27.087   1.000 490.349 
##  3 vs 4:  -0.710       1   9.046   1.000 169.607</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-30" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-621-1.png" width="672" /></p>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCm91dHB1dDogaHRtbF9kb2N1bWVudAplZGl0b3Jfb3B0aW9uczogCiAgY2h1bmtfb3V0cHV0X3R5cGU6IGNvbnNvbGUKLS0tCiMgPHNwYW4gc3R5bGU9ImNvbG9yOiNBNkQ4NTQiPkJpcnRoIE9yZGVyIEVmZmVjdHM8L3NwYW4+IHsudGFic2V0fQoKIyMgSGVscGVyCmBgYHtyIGhlbHBlcn0Kc291cmNlKCIwX2hlbHBlcnMuUiIpCm9wdHNfY2h1bmskc2V0KHdhcm5pbmcgPSBGQUxTRSkKZGV0YWNoKCJwYWNrYWdlOmxtZXJUZXN0IiwgdW5sb2FkPVRSVUUpCmBgYAoKCiMjIEZ1bmN0aW9ucwoKYGBge3J9CgpuX2ltcHV0YXRpb25zLm1pdG1sID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkaXRlciRtCn0Kbl9pbXB1dGF0aW9ucy5taWRzID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkbQp9Cm5faW1wdXRhdGlvbnMuYW1lbGlhID0gZnVuY3Rpb24oaW1wcykgewogIGxlbmd0aChpbXBzJGltcHV0YXRpb25zKQp9Cm5faW1wdXRhdGlvbnMgPSBmdW5jdGlvbihpbXBzKSB7IFVzZU1ldGhvZCgibl9pbXB1dGF0aW9ucyIpIH0KCmNvbXBsZXRlLm1pdG1sID0gbWl0bWw6Om1pdG1sQ29tcGxldGUKY29tcGxldGUubWlkcyA9IG1pY2U6OmNvbXBsZXRlCmNvbXBsZXRlID0gZnVuY3Rpb24oLi4uKSB7IFVzZU1ldGhvZCgiY29tcGxldGUiKSB9CgpsaWJyYXJ5KG1pY2UpCmxpYnJhcnkobWljZWFkZHMpCmxpYnJhcnkobWl0bWwpCmBgYAoKCiMjIExvYWQgZGF0YQpgYGB7ciBMb2FkIERhdGF9CmJpcnRob3JkZXIgPSByZWFkUkRTKCJkYXRhL2FsbGRhdGFfYmlydGhvcmRlcl9pX21sLnJkcyIpCmBgYAoKIyMgRGF0YSBwcmVwYXJhdGlvbnMKYGBge3IgZGF0YSBwcmVwYXJhdGlvbnN9CmJpcnRob3JkZXIgPC0gbWlkczJtaXRtbC5saXN0KGJpcnRob3JkZXIpCgojIyBDYWxjdWxhdGUgZ19mYWN0b3JzIChmb3Igbm93IHdpdGggcm93TWVhbnM6IGJldHRlciB0byBydW4gZmFjdG9yIGFuYWx5c2lzIGhlcmUgYXMgd2VsbD8pCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDE1X29sZCA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDE1X29sZCwgbWF0aF8yMDE1X29sZCwgY291bnRfYmFja3dhcmRzLCAgd29yZHNfZGVsYXllZCwgYWRhcHRpdmVfbnVtYmVyaW5nKSkpCn0pCgpiaXJ0aG9yZGVyIDwtIHdpdGhpbihiaXJ0aG9yZGVyLCB7CiAgZ19mYWN0b3JfMjAxNV95b3VuZyA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDE1X3lvdW5nLCBtYXRoXzIwMTVfeW91bmcpKSkKfSkKCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDA3X29sZCA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDA3X29sZCwgbWF0aF8yMDA3X29sZCkpKQp9KQoKYmlydGhvcmRlciA8LSB3aXRoaW4oYmlydGhvcmRlciwgewogIGdfZmFjdG9yXzIwMDdfeW91bmcgPC0gcm93TWVhbnMoc2NhbGUoY2JpbmQocmF2ZW5fMjAwN195b3VuZywgbWF0aF8yMDA3X3lvdW5nKSkpCn0pCgoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lIHRibF9kZi5taXRtbC5saXN0CgojIyMgQmlydGhvcmRlciBhbmQgU2libGluZyBDb3VudAojIGZvciBmYWN0b3IgdmFyaWFibGVzIHdlIGhhdmUgdG8gcm91bmQgYmlydGggb3JkZXIgcG9zaXRpb24gYW5kIGVsaW1pbmF0ZSBhbGwgdW5saWtlbHkgbnVtYmVycyAobmVnYXRpdmUgb25lcykKYmlydGhvcmRlcl9kYXRhID0gYmlydGhvcmRlcltbMV1dCgpiaXJ0aG9yZGVyID0gYmlydGhvcmRlciAlPiUKICBtdXRhdGUoYmlydGhvcmRlcl9nZW5lcyA9IGlmZWxzZShiaXJ0aG9yZGVyX2dlbmVzIDwgMCwgMCwgYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSBpZmVsc2UoYmlydGhvcmRlcl9uYWl2ZSA8IDAsIDAsIGJpcnRob3JkZXJfbmFpdmUpLAogICAgICAgICBiaXJ0aG9yZGVyX2dlbmVzID0gcm91bmQoYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSByb3VuZChiaXJ0aG9yZGVyX25haXZlKSwKICAgICAgICAgc2libGluZ19jb3VudF9nZW5lcyA9IGlmZWxzZShzaWJsaW5nX2NvdW50X2dlbmVzIDwgMCwgMCwgc2libGluZ19jb3VudF9nZW5lcyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmUgPSBpZmVsc2Uoc2libGluZ19jb3VudF9uYWl2ZSA8IDAsIDAsIHNpYmxpbmdfY291bnRfbmFpdmUpLAogICAgICAgICBzaWJsaW5nX2NvdW50X2dlbmVzID0gcm91bmQoc2libGluZ19jb3VudF9nZW5lcyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmUgPSByb3VuZChzaWJsaW5nX2NvdW50X25haXZlKSwKICAgICAgICAgYmlydGhvcmRlcl9nZW5lcyA9IGlmZWxzZShiaXJ0aG9yZGVyX2dlbmVzID4gNSwgTkEsIGJpcnRob3JkZXJfZ2VuZXMpLAogICAgICAgICBiaXJ0aG9yZGVyX25haXZlID0gaWZlbHNlKGJpcnRob3JkZXJfbmFpdmUgPiA1LCBOQSwgYmlydGhvcmRlcl9uYWl2ZSksCiAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgPSBpZmVsc2Uoc2libGluZ19jb3VudF9nZW5lcyA+IDUsIE5BLCBzaWJsaW5nX2NvdW50X2dlbmVzKSwKICAgICAgICAgc2libGluZ19jb3VudF9uYWl2ZSA9IGlmZWxzZShzaWJsaW5nX2NvdW50X25haXZlID4gNSwgTkEsIHNpYmxpbmdfY291bnRfbmFpdmUpKQoKCmJpcnRob3JkZXIgPSBiaXJ0aG9yZGVyICU+JSAKICBtdXRhdGUoCiMgYmlydGhvcmRlciBhcyBmYWN0b3JzIHdpdGggbGV2ZWxzIG9mIDEsIDIsIDMsIDQsIDUsIDUrCiAgICBiaXJ0aG9yZGVyX25haXZlX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihiaXJ0aG9yZGVyX25haXZlKSwKICAgIGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yID0gZmFjdG9yKGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIxIiwiMiIsIjMiLCI0IiwiNSIpKSwKICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yID0gYXMuY2hhcmFjdGVyKHNpYmxpbmdfY291bnRfbmFpdmUpLAogICAgc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IgPSBmYWN0b3Ioc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjIiLCIzIiwiNCIsIjUiKSksCiAgICBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihiaXJ0aG9yZGVyX2dlbmVzKSwKICAgIGJpcnRob3JkZXJfZ2VuZXNfZmFjdG9yID0gZmFjdG9yKGJpcnRob3JkZXJfZ2VuZXNfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjEiLCIyIiwiMyIsIjQiLCI1IikpLAogICAgc2libGluZ19jb3VudF9nZW5lc19mYWN0b3IgPSBhcy5jaGFyYWN0ZXIoc2libGluZ19jb3VudF9nZW5lcyksCiAgICBzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciA9IGZhY3RvcihzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIyIiwiMyIsIjQiLCI1IikpLAogICAgIyBpbnRlcmFjdGlvbiBiaXJ0aG9yZGVyICogc2libGluZ2NvdXQgZm9yIGVhY2ggYmlydGhvcmRlcgogICAgY291bnRfYmlydGhvcmRlcl9uYWl2ZSA9CiAgICAgIGZhY3RvcihzdHJfcmVwbGFjZShhcy5jaGFyYWN0ZXIoaW50ZXJhY3Rpb24oYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvcikpLAogICAgICAgICAgICAgICAgICAgICAgICAiXFwuIiwgIi8iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9ICAgYygiMS8yIiwiMi8yIiwgIjEvMyIsICAiMi8zIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMy8zIiwgIjEvNCIsICIyLzQiLCAiMy80IiwgIjQvNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjEvNSIsICIyLzUiLCAiMy81IiwgIjQvNSIsICI1LzUiKSksCiAgICBjb3VudF9iaXJ0aG9yZGVyX2dlbmVzID0KICAgICAgZmFjdG9yKHN0cl9yZXBsYWNlKGFzLmNoYXJhY3RlcihpbnRlcmFjdGlvbihiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yKSksICJcXC4iLCAiLyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gICBjKCIxLzIiLCIyLzIiLCAiMS8zIiwgICIyLzMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIzLzMiLCAiMS80IiwgIjIvNCIsICIzLzQiLCAiNC80IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81IiwgIjIvNSIsICIzLzUiLCAiNC81IiwgIjUvNSIpKSkKCgoKIyMjIFZhcmlhYmxlcwoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lCiAgbXV0YXRlKAogICAgZ19mYWN0b3JfMjAxNV9vbGQgPSAoZ19mYWN0b3JfMjAxNV9vbGQgLSBtZWFuKGdfZmFjdG9yXzIwMTVfb2xkLCBuYS5ybT1UKSkgLyBzZChnX2ZhY3Rvcl8yMDE1X29sZCwgbmEucm09VCksCiAgICBnX2ZhY3Rvcl8yMDE1X3lvdW5nID0gKGdfZmFjdG9yXzIwMTVfeW91bmcgLSBtZWFuKGdfZmFjdG9yXzIwMTVfeW91bmcsIG5hLnJtPVQpKSAvIHNkKGdfZmFjdG9yXzIwMTVfeW91bmcsIG5hLnJtPVQpLAogICAgZ19mYWN0b3JfMjAwN19vbGQgPSAoZ19mYWN0b3JfMjAwN19vbGQgLSBtZWFuKGdfZmFjdG9yXzIwMDdfb2xkLCBuYS5ybT1UKSkgLyBzZChnX2ZhY3Rvcl8yMDA3X29sZCwgbmEucm09VCksCmdfZmFjdG9yXzIwMDdfeW91bmcgPSAoZ19mYWN0b3JfMjAwN195b3VuZyAtIG1lYW4oZ19mYWN0b3JfMjAwN195b3VuZywgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAwN195b3VuZywgbmEucm09VCksCiAgICByYXZlbl8yMDE1X29sZCA9IChyYXZlbl8yMDE1X29sZCAtIG1lYW4ocmF2ZW5fMjAxNV9vbGQsIG5hLnJtPVQpKSAvIHNkKHJhdmVuXzIwMTVfb2xkKSwKICAgIG1hdGhfMjAxNV9vbGQgPSAobWF0aF8yMDE1X29sZCAtIG1lYW4obWF0aF8yMDE1X29sZCwgbmEucm09VCkpIC8gc2QobWF0aF8yMDE1X29sZCwgbmEucm09VCksCiAgICByYXZlbl8yMDE1X3lvdW5nID0gKHJhdmVuXzIwMTVfeW91bmcgLSBtZWFuKHJhdmVuXzIwMTVfeW91bmcsIG5hLnJtPVQpKSAvIHNkKHJhdmVuXzIwMTVfeW91bmcpLAogICAgbWF0aF8yMDE1X3lvdW5nID0gKG1hdGhfMjAxNV95b3VuZyAtIG1lYW4obWF0aF8yMDE1X3lvdW5nLCBuYS5ybT1UKSkgLwogICAgICBzZChtYXRoXzIwMTVfeW91bmcsIG5hLnJtPVQpLAogICAgcmF2ZW5fMjAwN19vbGQgPSAocmF2ZW5fMjAwN19vbGQgLSBtZWFuKHJhdmVuXzIwMDdfb2xkLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDA3X29sZCksCm1hdGhfMjAwN19vbGQgPSAobWF0aF8yMDA3X29sZCAtIG1lYW4obWF0aF8yMDA3X29sZCwgbmEucm09VCkpIC8gc2QobWF0aF8yMDA3X29sZCwgbmEucm09VCksCnJhdmVuXzIwMDdfeW91bmcgPSAocmF2ZW5fMjAwN195b3VuZyAtIG1lYW4ocmF2ZW5fMjAwN195b3VuZywgbmEucm09VCkpIC8gc2QocmF2ZW5fMjAwN195b3VuZyksCm1hdGhfMjAwN195b3VuZyA9IChtYXRoXzIwMDdfeW91bmcgLSBtZWFuKG1hdGhfMjAwN195b3VuZywgbmEucm09VCkpIC8KICBzZChtYXRoXzIwMDdfeW91bmcsIG5hLnJtPVQpLAogICAgY291bnRfYmFja3dhcmRzID0gKGNvdW50X2JhY2t3YXJkcyAtIG1lYW4oY291bnRfYmFja3dhcmRzLCBuYS5ybT1UKSkgLwogICAgICBzZChjb3VudF9iYWNrd2FyZHMsIG5hLnJtPVQpLAogICAgd29yZHNfZGVsYXllZCA9ICh3b3Jkc19kZWxheWVkIC0gbWVhbih3b3Jkc19kZWxheWVkLCBuYS5ybT1UKSkgLwogICAgICBzZCh3b3Jkc19kZWxheWVkLCBuYS5ybT1UKSwKICAgIGFkYXB0aXZlX251bWJlcmluZyA9IChhZGFwdGl2ZV9udW1iZXJpbmcgLSBtZWFuKGFkYXB0aXZlX251bWJlcmluZywgbmEucm09VCkpIC8KICAgICAgc2QoYWRhcHRpdmVfbnVtYmVyaW5nLCBuYS5ybT1UKSwKICAgIGJpZzVfZXh0ID0gKGJpZzVfZXh0IC0gbWVhbihiaWc1X2V4dCwgbmEucm09VCkpIC8gc2QoYmlnNV9leHQsIG5hLnJtPVQpLAogICAgYmlnNV9jb24gPSAoYmlnNV9jb24gLSBtZWFuKGJpZzVfY29uLCBuYS5ybT1UKSkgLyBzZChiaWc1X2NvbiwgbmEucm09VCksCiAgICBiaWc1X2FncmVlID0gKGJpZzVfYWdyZWUgLSBtZWFuKGJpZzVfYWdyZWUsIG5hLnJtPVQpKSAvIHNkKGJpZzVfYWdyZWUsIG5hLnJtPVQpLAogICAgYmlnNV9vcGVuID0gKGJpZzVfb3BlbiAtIG1lYW4oYmlnNV9vcGVuLCBuYS5ybT1UKSkgLyBzZChiaWc1X29wZW4sIG5hLnJtPVQpLAogICAgYmlnNV9uZXUgPSAoYmlnNV9uZXUgLSBtZWFuKGJpZzVfbmV1LCBuYS5ybT1UKSkgLyBzZChiaWc1X25ldSwgbmEucm09VCksCiAgICByaXNrQSA9IChyaXNrQSAtIG1lYW4ocmlza0EsIG5hLnJtPVQpKSAvIHNkKHJpc2tBLCBuYS5ybT1UKSwKICAgIHJpc2tCID0gKHJpc2tCIC0gbWVhbihyaXNrQiwgbmEucm09VCkpIC8gc2Qocmlza0IsIG5hLnJtPVQpLAogICAgeWVhcnNfb2ZfZWR1Y2F0aW9uX3ogPSAoeWVhcnNfb2ZfZWR1Y2F0aW9uIC0gbWVhbih5ZWFyc19vZl9lZHVjYXRpb24sIG5hLnJtPVQpKSAvCiAgICAgIHNkKHllYXJzX29mX2VkdWNhdGlvbiwgbmEucm09VCksCiAgICB3YWdlX2xhc3RfbW9udGhfeiA9ICh3YWdlX2xhc3RfbW9udGhfbG9nIC0gbWVhbih3YWdlX2xhc3RfbW9udGhfbG9nLCBuYS5ybT1UKSkgLwogICAgICBzZCh3YWdlX2xhc3RfbW9udGhfbG9nLCBuYS5ybT1UKSwKICAgIHdhZ2VfbGFzdF95ZWFyX3ogPSAod2FnZV9sYXN0X3llYXJfbG9nIC0gbWVhbih3YWdlX2xhc3RfeWVhcl9sb2csIG5hLnJtPVQpKSAvCiAgICAgIHNkKHdhZ2VfbGFzdF95ZWFyX2xvZywgbmEucm09VCksCiAgICBhdHRlbmRlZF9zY2hvb2wgPSBhcy5pbnRlZ2VyKGF0dGVuZGVkX3NjaG9vbCksCiAgICBhdHRlbmRlZF9zY2hvb2wgPSBpZmVsc2UoYXR0ZW5kZWRfc2Nob29sID09IDEsIDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShhdHRlbmRlZF9zY2hvb2wgPT0gMiwgMSwgTkEpKSkKZGF0YV91c2VkIDwtIGJpcnRob3JkZXIgJT4lCiAgbXV0YXRlKHNpYmxpbmdfY291bnQgPSBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciwKICAgICAgICAgYmlydGhfb3JkZXJfbm9ubGluZWFyID0gYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IsCiAgICAgICAgIGJpcnRoX29yZGVyID0gYmlydGhvcmRlcl9uYWl2ZSwKICAgICAgICAgY291bnRfYmlydGhfb3JkZXIgPSBjb3VudF9iaXJ0aG9yZGVyX25haXZlKQoKYGBgCgojIyBJbnRlbGxpZ2VuY2Ugey5hY3RpdmUgLnRhYnNldH0KIyMjIGctZmFjdG9yIDIwMTUgb2xkIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGdfZmFjdG9yXzIwMTVfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBSYXZlbiAyMDE1IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByYXZlbl8yMDE1X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBOdW1lcmFjeSAyMDE1IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBtYXRoXzIwMTVfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIENvdW50aW5nIEJhY2t3YXJkcyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBjb3VudF9iYWNrd2FyZHMpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgRGVsYXllZCBXb3JkIFJlY2FsbCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSB3b3Jkc19kZWxheWVkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBBZGFwdGl2ZSBOdW1iZXJpbmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYWRhcHRpdmVfbnVtYmVyaW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgojIyMgZy1mYWN0b3IgMjAxNSB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBnX2ZhY3Rvcl8yMDE1X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBSYXZlbiAyMDE1IHlvdW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJhdmVuXzIwMTVfeW91bmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgTnVtZXJhY3kgMjAxNSB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBtYXRoXzIwMTVfeW91bmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgZy1mYWN0b3IgMjAwNyBvbGQgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gZ19mYWN0b3JfMjAwN19vbGQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIFJhdmVuIDIwMDcgb2xkIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJhdmVuXzIwMDdfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIE51bWVyYWN5IDIwMDcgb2xkIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IG1hdGhfMjAwN19vbGQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgZy1mYWN0b3IgMjAwNyB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBnX2ZhY3Rvcl8yMDA3X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBSYXZlbiAyMDA3IHlvdW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJhdmVuXzIwMDdfeW91bmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgTnVtZXJhY3kgMjAwNyB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBtYXRoXzIwMDdfeW91bmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyBQZXJzb25hbGl0eSB7LnRhYnNldH0KCiMjIyBFeHRyYXZlcnNpb24gey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9leHQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIE5ldXJvdGljaXNtIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfbmV1KQpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgQ29uc2NpZW50aW91c25lc3Mgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9uZXUpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIEFncmVlYWJsZW5lc3Mgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9hZ3JlZSkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgT3Blbm5lc3Mgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9vcGVuKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMgUmlza3ByZWZlcmVuY2Ugey50YWJzZXR9CiMjIyBSaXNrIEEgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gcmlza0EpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgUmlzayBCIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJpc2tCKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMgRWR1Y2F0aW9uYWwgQXR0YWlubWVudCB7LnRhYnNldH0KIyMjIFllYXJzIG9mIEVkdWNhdGlvbiAtIHotc3RhbmRhcmRpemVkey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0geWVhcnNfb2ZfZWR1Y2F0aW9uX3opCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgZWxlbWVudGFyeV9taXNzZWQKCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBFbGVtZW50YXJ5X21pc3NlZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgZWxlbWVudGFyeV93b3JrZWQKCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBFbGVtZW50YXJ5X3dvcmtlZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBhdHRlbmRlZF9zY2hvb2wKCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBhdHRlbmRlZF9zY2hvb2wpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKCiMjIFdvcmsgey50YWJzZXR9CgojIyMgSW5jb21lIExhc3QgTW9udGggKGxvZykgLSB6LXN0YW5kYXJkaXplZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gd2FnZV9sYXN0X21vbnRoX3opCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgSW5jb21lIGxhc3QgeWVhciAobG9nKSAtIHotc3RhbmRhcmRpemVkIHsudGFic2V0fQoKYGBge3J9CmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSB3YWdlX2xhc3RfeWVhcl96KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgojIyMgU2VsZi1FbXBsb3ltZW50IC0gbm9uIHN0YW5kYXJkaXplZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gU2VsZl9lbXBsb3llZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoKIyMgU21va2luZyBCZWhhdmlvdXIgey50YWJzZXR9CiMjIyBldmVyX3Ntb2tlZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gZXZlcl9zbW9rZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQpgYGAKCiMjIyBzdGlsbF9zbW9raW5nIHsudGFic2V0fQoKYGBge3J9CmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBzdGlsbF9zbW9raW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgo=</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
