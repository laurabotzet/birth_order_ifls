---
output: html_document
editor_options: 
  chunk_output_type: console
---


```{r}
# Specify your outcome
birthorder = birthorder %>% mutate(outcome = g_factor_2015)

### start with naive birthorder
birthorder <- birthorder %>%
                     mutate(sibling_count = sibling_count_naive,
                            birth_order_nonlinear = birthorder_naive_factor,
                            birth_order = birthorder_naive,
                            count_birth_order = count_birthorder_naive)
# naive covariates
model_naive_m1 <- with(birthorder, lmer(outcome ~ age + male + sibling_count + (1 | mother_pidlink)))
mitml::testEstimates(model_naive_m1, var.comp = T)

model_naive_m1_plot = lmer(outcome ~ age + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder[[1]])
plot(allEffects(model_naive_m1_plot)) # fuer plots

# naive linear
model_naive_m2 <- with(birthorder, lmer(outcome ~ birth_order + age + male + sibling_count +
                                    (1 | mother_pidlink)))
mitml::testEstimates(model_naive_m2, var.comp = T)
model_naive_m2_plot = lmer(outcome ~ birth_order + age + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder[[1]])
plot_birthorder(model_naive_m2_plot, separate = FALSE)

# naive factor
model_naive_m3 <- with(birthorder, lmer(outcome ~ birth_order_nonlinear + age + male +
                                          sibling_count + (1 | mother_pidlink)))
mitml::testEstimates(model_naive_m3, var.comp = T)
model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + age + male + sibling_count +
                       (1 | mother_pidlink),
                   data = birthorder[[1]])
plot_birthorder(model_naive_m3_plot, separate = FALSE)

# naive interaction
model_naive_m4 <- with(birthorder, lmer(outcome ~ count_birth_order + age + male  +
                                    (1 | mother_pidlink)))
mitml::testEstimates(model_naive_m4, var.comp = T)
model_naive_m4_plot = lmer(outcome ~ count_birth_order + age + male +
                       (1 | mother_pidlink),
                   data = birthorder[[1]])
plot_birthorder(model_naive_m4_plot)

anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)

# genes birthorder
birthorder <- birthorder %>%
                     mutate(sibling_count = sibling_count_genes,
                            birth_order_nonlinear = birthorder_genes_factor,
                            birth_order = birthorder_genes,
                            count_birth_order = count_birthorder_genes)

# genes covariates
model_genes_m1 <- with(birthorder, lmer(outcome ~ age + male + sibling_count + (1 | mother_pidlink)))
mitml::testEstimates(model_genes_m1, var.comp = T)

model_genes_m1_plot = lmer(outcome ~ age + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder[[1]])
plot(allEffects(model_genes_m1_plot)) # fuer plots

# genes linear
model_genes_m2 <- with(birthorder, lmer(outcome ~ birth_order + age + male + sibling_count +
                                    (1 | mother_pidlink)))
mitml::testEstimates(model_genes_m2, var.comp = T)
model_genes_m2_plot = lmer(outcome ~ birth_order + age + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder[[1]])
plot_birthorder(model_genes_m2_plot, separate = FALSE)

# genes factor
model_genes_m3 <- with(birthorder, lmer(outcome ~ birth_order_nonlinear + age + male + sibling_count +
                                    (1 | mother_pidlink)))
mitml::testEstimates(model_genes_m3, var.comp = T)
model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + age + male + sibling_count +
                       (1 | mother_pidlink),
                   data = birthorder[[1]])
plot_birthorder(model_genes_m3_plot, separate = FALSE)

# genes interaction
model_genes_m4 <- with(birthorder, lmer(outcome ~ count_birth_order + age + male  +
                                    (1 | mother_pidlink)))
mitml::testEstimates(model_genes_m4, var.comp = T)
model_genes_m4_plot = lmer(outcome ~ count_birth_order + age + male +
                       (1 | mother_pidlink),
                   data = birthorder[[1]])
plot_birthorder(model_genes_m4_plot)

anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)


library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot)

```
