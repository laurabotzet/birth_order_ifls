<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Laura Botzet &amp; Ruben Arslan" />

<meta name="date" content="2017-09-28" />

<title>3_imputation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("3_imputation.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>





<head>
<style>
.dropdown-menu li:hover .sub-menu {
  visibility: visible;
}

.dropdown:hover .dropdown-menu {
  display: block;
}
</style>
</head>


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
<div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
  </button>
  <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
</div>
<div id="navbar" class="navbar-collapse collapse">
  <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>

<li class="dropdown" style="background-color: #E5C494">
        <a class="dropdown-toggle" aria-expanded="false">
          Birth Order Effects <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" style="background-color: #E5C494">
          <li class=""><a href="4_analyses.html" aria-expanded="false" aria-controls="first-tab"> Main Analyses</a></li>
          <li class=""><a href="4_analyses_robust.html" aria-expanded="false" aria-controls="first-tab"> Robustness Analyses</a></li>
        </ul>
     </li>


<li class="dropdown" style="background-color: #FFD92F">
        <a class="dropdown-toggle" aria-expanded="false">
          Birth Order Effects Imputed Data <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" style="background-color: #FFD92F">
          <li class=""><a href="3_imputation.html" aria-expanded="false" aria-controls="first-tab">Multiple Imputation</a></li>
          <li class=""><a href="3_imputation_check.html" aria-expanded="false" aria-controls="first-tab">Imputation Checks</a></li>
          <li class=""><a href="4_analyses_imputed_data.html" aria-expanded="false" aria-controls="second-tab">Birth Order Effects Imputed Data</a></li>
        </ul>
     </li>


  </ul>
  <ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
<span class="fa fa-github"></span>


  </a>
</li>
  </ul>
</div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">3_imputation</h1>
<h4 class="author"><em>Laura Botzet &amp; Ruben Arslan</em></h4>
<h4 class="date"><em>28 September 2017</em></h4>

</div>


<div id="imputation" class="section level1 tabset">
<h1><span style="color:#FFD92F">Imputation</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>knitr::opts_chunk$set(eval = FALSE)
source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.6-2</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;codebook&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     bfi</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     aggregate_and_document_scale, asis_knit_child, expired, paste.knit_asis,
##     reverse_labelled_values</code></pre>
<pre><code>## 
## Attaching package: &#39;effsize&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cohen.d</code></pre>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<pre class="r"><code>### Import alldata used for birthorder and g-factors computed
alldata_birthorder = readRDS(&quot;data/alldata_birthorder.rds&quot;)

## For the imputation we want to clean the dataset and get rid of all uninteresting data
alldata_birthorder = alldata_birthorder %&gt;%
  filter(!is.na(pidlink)) %&gt;% # no individuals who are only known from the pregnancy file
  filter(is.na(lifebirths) | lifebirths == 2) %&gt;% # remove 7 and 2 individuals who are known as stillbirth or miscarriage but still have PID
  select(-lifebirths) %&gt;% 
  filter(!is.na(mother_pidlink)) %&gt;% 
  select(-father_pidlink) %&gt;% 
  filter(is.na(any_multiple_birth) | any_multiple_birth != 1) %&gt;% # remove 7 and 2 individuals who are known as stillbirth or miscarriage but still have PID
  select(-starts_with(&quot;age_&quot;), -wave, -any_multiple_birth, -multiple_birth,
         -starts_with(&quot;g_factor&quot;)) %&gt;% 
  mutate(money_spent_smoking_log = if_else(is.na(money_spent_smoking_log) &amp; ever_smoked == 0, 0, money_spent_smoking_log),
         amount = if_else(is.na(amount) &amp; ever_smoked == 0, 0, amount),
         amount_still_smokers = if_else(is.na(amount_still_smokers) &amp;  still_smoking == 0, 0, amount_still_smokers),
         birthyear = lubridate::year(birthdate))

## For the second imputation we only want to keep nice, non-problematic variables
alldata_birthorder = alldata_birthorder %&gt;%
  select(-birthorder_uterus_alive, -birthorder_uterus_preg,
         -sibling_count_uterus_preg, -sibling_count_naive_ind, -sibling_count_uterus_alive,
         -words_immediate, -words_remembered_avg,
         -Total_score_highest,-Total_score_highest_type, -Math_score_highest,
         -Math_score_highest_type, -birthdate, -birthyear, -marriage_id,
         -money_spent_smoking_log,-amount_still_smokers, -total_worked, -total_missed, 
         -highest_education, -chron_order_birth, -alive, -death_yr, -death_month,
         -University_worked, -University_missed, - English_score_elementary,
         )

alldata_birthorder = alldata_birthorder %&gt;%
  mutate(currently_attending_school = as.integer(currently_attending_school),
         attended_school = as.integer(attended_school),
         Type_of_test_elementary = as.integer(Type_of_test_elementary),
         Type_of_test_Junior_High = as.integer(Type_of_test_Junior_High),
         Type_of_test_Senior_High = as.integer(Type_of_test_Senior_High),
         random_si = as.integer(random_si)
         )

# recode Factor Variable as Dummy Variable
alldata_birthorder = left_join(alldata_birthorder,
                                alldata_birthorder %&gt;%
                                  filter(!is.na(Category)) %&gt;%
                                  mutate(var = 1) %&gt;%
                                  select(pidlink, Category, var) %&gt;%
                                  spread(Category, var, fill = 0, sep = &quot;_&quot;), by = &quot;pidlink&quot;) %&gt;%
  select(-Category)

# recode Factor Variable as Dummy Variable
alldata_birthorder = left_join(alldata_birthorder,
                                alldata_birthorder %&gt;%
                                  filter(!is.na(Sector)) %&gt;%
                                  mutate(var = 1) %&gt;%
                                  select(pidlink, Sector, var) %&gt;%
                                  spread(Sector, var, fill = 0, sep = &quot;_&quot;), by = &quot;pidlink&quot;) %&gt;%
  select(-Sector)





corr_pipe = . %&gt;%  as.matrix() %&gt;% 
Hmisc::rcorr(.) %&gt;% {
  left_join(left_join(.$r %&gt;% reshape2::melt() %&gt;% rename(r = value), 
                      .$n %&gt;% reshape2::melt() %&gt;% rename(n = value), by = c(&quot;Var1&quot;, &quot;Var2&quot;)),
            .$P %&gt;% reshape2::melt() %&gt;% rename(p = value), 
            by = c(&quot;Var1&quot;, &quot;Var2&quot;))
  } %&gt;% 
  arrange(desc(r)) %&gt;% 
  filter(Var1 != Var2)

attributes(alldata_birthorder$mother_pidlink)
zap_label &lt;- function(x) {
  UseMethod(&quot;zap_label&quot;)
}
zap_label.data.frame &lt;- function(x) {
  x[] &lt;- lapply(x, zap_label)
  x
}
zap_label.default &lt;- function(x) {
  attributes(x)$label &lt;- NULL
  x
}
  
alldata_birthorder &lt;- alldata_birthorder %&gt;% haven::zap_labels() %&gt;% haven::zap_formats() %&gt;% zap_label()
str(alldata_birthorder)
alldata_birthorder %&gt;% select_if(function(.)!is.numeric(.)) %&gt;% names()

correlations = corr_pipe(alldata_birthorder %&gt;% select_if(is.numeric))

alldata_birthorder &lt;-  alldata_birthorder %&gt;% select(`mother_pidlink`,  `age`, `male`, `birthorder_naive`, `sibling_count_naive`, `birthorder_genes`, `sibling_count_genes`,  
`raven_2015_young`, `math_2015_young`, `raven_2015_old`, `math_2015_old`, `words_delayed`, `adaptive_numbering`, `raven_2007_old`, `raven_2007_young`, `math_2007_young`, `math_2007_old`, `count_backwards`, 

`big5_ext`, `big5_con`, `big5_open`, `big5_neu`, `big5_agree`, `riskA`, `riskB`,

`Elementary_missed`, `Elementary_worked`, `attended_school`,

`years_of_education`, `Self_employed`, `ever_smoked`, `still_smoking`, `wage_last_month_log`, `wage_last_year_log`,

`Category_Casual worker in agriculture`, `Category_Casual worker not in agriculture`, `Category_Government worker`, `Category_Private worker`, `Category_Self-employed`, `Category_Unpaid family worker`, 
`Sector_Agriculture, forestry, fishing and hunting`, `Sector_Construction`, `Sector_Electricity, gas, water`, `Sector_Finance, insurance, real estate and business services`, `Sector_Manufacturing`, `Sector_Mining and quarrying`, `Sector_Social services`, `Sector_Transportation, storage and communications`, `Sector_Wholesale, retail, restaurants and hotels`)</code></pre>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<pre class="r"><code>n_imputations.mitml = function(imps) {
  imps$iter$m
}
n_imputations.mids = function(imps) {
  imps$m
}
n_imputations.amelia = function(imps) {
  length(imps$imputations)
}
n_imputations = function(imps) { UseMethod(&quot;n_imputations&quot;) }

complete.mitml = mitml::mitmlComplete
complete.mids = mice::complete
complete = function(...) { UseMethod(&quot;complete&quot;) }

library(mice)
library(miceadds)
library(mitml)
library(lattice)
library(pan)

sort(round(miss_frac(alldata_birthorder),2))
# skimr::skim(alldata_birthorder)</code></pre>
</div>
<div id="imputation-1" class="section level2 active tabset">
<h2>Imputation</h2>
<pre class="r"><code>set.seed(123) # random seed so that other can replicate our imputation

# look at the dataset
colnames(alldata_birthorder)
head(alldata_birthorder)
dim(alldata_birthorder)
nrow(alldata_birthorder)
ncol(alldata_birthorder)
summary(alldata_birthorder)

#look at the missing data pattern
missingness_pattern = as.data.frame(md.pattern(alldata_birthorder))
length(missingness_pattern)


alldata_birthorder &lt;- alldata_birthorder %&gt;% select(-pidlink)
alldata_birthorder$mother_pidlink = as.integer(alldata_birthorder$mother_pidlink)
skimr::skim(alldata_birthorder)

imp0 &lt;- mice(alldata_birthorder, maxit=0)

pred1 &lt;- imp0$predictorMatrix
pred1
pred1 = quickpred(alldata_birthorder, mincor = 0.1) #all variables that correlate &gt; .01
pred1
meth1 &lt;- imp0$method

# linear multilevel imputation using the function mice.impute.2l.norm()
# specify predictor_matrix using 1 = fixed effects, 2 = random effects, -2 = class variable, 0 = no effect
# we can set the mother_pidlink as class variable (= -2)
pred1[, &quot;mother_pidlink&quot;] = -2
# set imputation procedures
meth1[-1] &lt;- &quot;2l.pan&quot;
meth1
pred1

imp1 &lt;- mice(alldata_birthorder, maxit = 4, m=2, predictorMatrix = pred1, method = meth1)

library(future)
plan(multicore(workers = 10))
imps = listenv::listenv()
for (i in seq_along(1:10)) {
  imps[[i]] %&lt;-% mice(alldata_birthorder, m = 1, maxit = 15, predictorMatrix = pred1, method = meth1)
}
save(imps, file = &quot;imps.rdata&quot;)

all_imps = as.list(imps)
save(all_imps, file = &quot;imps2.rdata&quot;)
alldata_birthorder_i = all_imps[[1]]
for (i in seq_along(2:length(all_imps))) {
  alldata_birthorder_i = ibind(alldata_birthorder_i, all_imps[[i]])
}
saveRDS(alldata_birthorder_i, file = &quot;alldata_birthorder_i_ml.rds&quot;)</code></pre>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiM19pbXB1dGF0aW9uIgphdXRob3I6ICJMYXVyYSBCb3R6ZXQgJiBSdWJlbiBBcnNsYW4iCmRhdGU6ICIyOCBTZXB0ZW1iZXIgMjAxNyIKb3V0cHV0OiAKICBodG1sX2RvY3VtZW50OgogICAgY29kZV9mb2xkaW5nOiAic2hvdyIKZWRpdG9yX29wdGlvbnM6IAogIGNodW5rX291dHB1dF90eXBlOiBjb25zb2xlCi0tLQoKIyA8c3BhbiBzdHlsZT0iY29sb3I6I0ZGRDkyRiI+SW1wdXRhdGlvbjwvc3Bhbj4gey50YWJzZXR9CgojIyBIZWxwZXIKYGBge3IgaGVscGVyfQprbml0cjo6b3B0c19jaHVuayRzZXQoZXZhbCA9IEZBTFNFKQpzb3VyY2UoIjBfaGVscGVycy5SIikKYGBgCgoKIyMgRGF0YQpgYGB7cn0KIyMjIEltcG9ydCBhbGxkYXRhIHVzZWQgZm9yIGJpcnRob3JkZXIgYW5kIGctZmFjdG9ycyBjb21wdXRlZAphbGxkYXRhX2JpcnRob3JkZXIgPSByZWFkUkRTKCJkYXRhL2FsbGRhdGFfYmlydGhvcmRlci5yZHMiKQoKIyMgRm9yIHRoZSBpbXB1dGF0aW9uIHdlIHdhbnQgdG8gY2xlYW4gdGhlIGRhdGFzZXQgYW5kIGdldCByaWQgb2YgYWxsIHVuaW50ZXJlc3RpbmcgZGF0YQphbGxkYXRhX2JpcnRob3JkZXIgPSBhbGxkYXRhX2JpcnRob3JkZXIgJT4lCiAgZmlsdGVyKCFpcy5uYShwaWRsaW5rKSkgJT4lICMgbm8gaW5kaXZpZHVhbHMgd2hvIGFyZSBvbmx5IGtub3duIGZyb20gdGhlIHByZWduYW5jeSBmaWxlCiAgZmlsdGVyKGlzLm5hKGxpZmViaXJ0aHMpIHwgbGlmZWJpcnRocyA9PSAyKSAlPiUgIyByZW1vdmUgNyBhbmQgMiBpbmRpdmlkdWFscyB3aG8gYXJlIGtub3duIGFzIHN0aWxsYmlydGggb3IgbWlzY2FycmlhZ2UgYnV0IHN0aWxsIGhhdmUgUElECiAgc2VsZWN0KC1saWZlYmlydGhzKSAlPiUgCiAgZmlsdGVyKCFpcy5uYShtb3RoZXJfcGlkbGluaykpICU+JSAKICBzZWxlY3QoLWZhdGhlcl9waWRsaW5rKSAlPiUgCiAgZmlsdGVyKGlzLm5hKGFueV9tdWx0aXBsZV9iaXJ0aCkgfCBhbnlfbXVsdGlwbGVfYmlydGggIT0gMSkgJT4lICMgcmVtb3ZlIDcgYW5kIDIgaW5kaXZpZHVhbHMgd2hvIGFyZSBrbm93biBhcyBzdGlsbGJpcnRoIG9yIG1pc2NhcnJpYWdlIGJ1dCBzdGlsbCBoYXZlIFBJRAogIHNlbGVjdCgtc3RhcnRzX3dpdGgoImFnZV8iKSwgLXdhdmUsIC1hbnlfbXVsdGlwbGVfYmlydGgsIC1tdWx0aXBsZV9iaXJ0aCwKICAgICAgICAgLXN0YXJ0c193aXRoKCJnX2ZhY3RvciIpKSAlPiUgCiAgbXV0YXRlKG1vbmV5X3NwZW50X3Ntb2tpbmdfbG9nID0gaWZfZWxzZShpcy5uYShtb25leV9zcGVudF9zbW9raW5nX2xvZykgJiBldmVyX3Ntb2tlZCA9PSAwLCAwLCBtb25leV9zcGVudF9zbW9raW5nX2xvZyksCiAgICAgICAgIGFtb3VudCA9IGlmX2Vsc2UoaXMubmEoYW1vdW50KSAmIGV2ZXJfc21va2VkID09IDAsIDAsIGFtb3VudCksCiAgICAgICAgIGFtb3VudF9zdGlsbF9zbW9rZXJzID0gaWZfZWxzZShpcy5uYShhbW91bnRfc3RpbGxfc21va2VycykgJiAgc3RpbGxfc21va2luZyA9PSAwLCAwLCBhbW91bnRfc3RpbGxfc21va2VycyksCiAgICAgICAgIGJpcnRoeWVhciA9IGx1YnJpZGF0ZTo6eWVhcihiaXJ0aGRhdGUpKQoKIyMgRm9yIHRoZSBzZWNvbmQgaW1wdXRhdGlvbiB3ZSBvbmx5IHdhbnQgdG8ga2VlcCBuaWNlLCBub24tcHJvYmxlbWF0aWMgdmFyaWFibGVzCmFsbGRhdGFfYmlydGhvcmRlciA9IGFsbGRhdGFfYmlydGhvcmRlciAlPiUKICBzZWxlY3QoLWJpcnRob3JkZXJfdXRlcnVzX2FsaXZlLCAtYmlydGhvcmRlcl91dGVydXNfcHJlZywKICAgICAgICAgLXNpYmxpbmdfY291bnRfdXRlcnVzX3ByZWcsIC1zaWJsaW5nX2NvdW50X25haXZlX2luZCwgLXNpYmxpbmdfY291bnRfdXRlcnVzX2FsaXZlLAogICAgICAgICAtd29yZHNfaW1tZWRpYXRlLCAtd29yZHNfcmVtZW1iZXJlZF9hdmcsCiAgICAgICAgIC1Ub3RhbF9zY29yZV9oaWdoZXN0LC1Ub3RhbF9zY29yZV9oaWdoZXN0X3R5cGUsIC1NYXRoX3Njb3JlX2hpZ2hlc3QsCiAgICAgICAgIC1NYXRoX3Njb3JlX2hpZ2hlc3RfdHlwZSwgLWJpcnRoZGF0ZSwgLWJpcnRoeWVhciwgLW1hcnJpYWdlX2lkLAogICAgICAgICAtbW9uZXlfc3BlbnRfc21va2luZ19sb2csLWFtb3VudF9zdGlsbF9zbW9rZXJzLCAtdG90YWxfd29ya2VkLCAtdG90YWxfbWlzc2VkLCAKICAgICAgICAgLWhpZ2hlc3RfZWR1Y2F0aW9uLCAtY2hyb25fb3JkZXJfYmlydGgsIC1hbGl2ZSwgLWRlYXRoX3lyLCAtZGVhdGhfbW9udGgsCiAgICAgICAgIC1Vbml2ZXJzaXR5X3dvcmtlZCwgLVVuaXZlcnNpdHlfbWlzc2VkLCAtIEVuZ2xpc2hfc2NvcmVfZWxlbWVudGFyeSwKICAgICAgICAgKQoKYWxsZGF0YV9iaXJ0aG9yZGVyID0gYWxsZGF0YV9iaXJ0aG9yZGVyICU+JQogIG11dGF0ZShjdXJyZW50bHlfYXR0ZW5kaW5nX3NjaG9vbCA9IGFzLmludGVnZXIoY3VycmVudGx5X2F0dGVuZGluZ19zY2hvb2wpLAogICAgICAgICBhdHRlbmRlZF9zY2hvb2wgPSBhcy5pbnRlZ2VyKGF0dGVuZGVkX3NjaG9vbCksCiAgICAgICAgIFR5cGVfb2ZfdGVzdF9lbGVtZW50YXJ5ID0gYXMuaW50ZWdlcihUeXBlX29mX3Rlc3RfZWxlbWVudGFyeSksCiAgICAgICAgIFR5cGVfb2ZfdGVzdF9KdW5pb3JfSGlnaCA9IGFzLmludGVnZXIoVHlwZV9vZl90ZXN0X0p1bmlvcl9IaWdoKSwKICAgICAgICAgVHlwZV9vZl90ZXN0X1Nlbmlvcl9IaWdoID0gYXMuaW50ZWdlcihUeXBlX29mX3Rlc3RfU2VuaW9yX0hpZ2gpLAogICAgICAgICByYW5kb21fc2kgPSBhcy5pbnRlZ2VyKHJhbmRvbV9zaSkKICAgICAgICAgKQoKIyByZWNvZGUgRmFjdG9yIFZhcmlhYmxlIGFzIER1bW15IFZhcmlhYmxlCmFsbGRhdGFfYmlydGhvcmRlciA9IGxlZnRfam9pbihhbGxkYXRhX2JpcnRob3JkZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsZGF0YV9iaXJ0aG9yZGVyICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyKCFpcy5uYShDYXRlZ29yeSkpICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXV0YXRlKHZhciA9IDEpICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0KHBpZGxpbmssIENhdGVnb3J5LCB2YXIpICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkKENhdGVnb3J5LCB2YXIsIGZpbGwgPSAwLCBzZXAgPSAiXyIpLCBieSA9ICJwaWRsaW5rIikgJT4lCiAgc2VsZWN0KC1DYXRlZ29yeSkKCiMgcmVjb2RlIEZhY3RvciBWYXJpYWJsZSBhcyBEdW1teSBWYXJpYWJsZQphbGxkYXRhX2JpcnRob3JkZXIgPSBsZWZ0X2pvaW4oYWxsZGF0YV9iaXJ0aG9yZGVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbGRhdGFfYmlydGhvcmRlciAlPiUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcighaXMubmEoU2VjdG9yKSkgJT4lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGUodmFyID0gMSkgJT4lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3QocGlkbGluaywgU2VjdG9yLCB2YXIpICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkKFNlY3RvciwgdmFyLCBmaWxsID0gMCwgc2VwID0gIl8iKSwgYnkgPSAicGlkbGluayIpICU+JQogIHNlbGVjdCgtU2VjdG9yKQoKCgoKCmNvcnJfcGlwZSA9IC4gJT4lICBhcy5tYXRyaXgoKSAlPiUgCkhtaXNjOjpyY29yciguKSAlPiUgewogIGxlZnRfam9pbihsZWZ0X2pvaW4oLiRyICU+JSByZXNoYXBlMjo6bWVsdCgpICU+JSByZW5hbWUociA9IHZhbHVlKSwgCiAgICAgICAgICAgICAgICAgICAgICAuJG4gJT4lIHJlc2hhcGUyOjptZWx0KCkgJT4lIHJlbmFtZShuID0gdmFsdWUpLCBieSA9IGMoIlZhcjEiLCAiVmFyMiIpKSwKICAgICAgICAgICAgLiRQICU+JSByZXNoYXBlMjo6bWVsdCgpICU+JSByZW5hbWUocCA9IHZhbHVlKSwgCiAgICAgICAgICAgIGJ5ID0gYygiVmFyMSIsICJWYXIyIikpCiAgfSAlPiUgCiAgYXJyYW5nZShkZXNjKHIpKSAlPiUgCiAgZmlsdGVyKFZhcjEgIT0gVmFyMikKCmF0dHJpYnV0ZXMoYWxsZGF0YV9iaXJ0aG9yZGVyJG1vdGhlcl9waWRsaW5rKQp6YXBfbGFiZWwgPC0gZnVuY3Rpb24oeCkgewogIFVzZU1ldGhvZCgiemFwX2xhYmVsIikKfQp6YXBfbGFiZWwuZGF0YS5mcmFtZSA8LSBmdW5jdGlvbih4KSB7CiAgeFtdIDwtIGxhcHBseSh4LCB6YXBfbGFiZWwpCiAgeAp9CnphcF9sYWJlbC5kZWZhdWx0IDwtIGZ1bmN0aW9uKHgpIHsKICBhdHRyaWJ1dGVzKHgpJGxhYmVsIDwtIE5VTEwKICB4Cn0KICAKYWxsZGF0YV9iaXJ0aG9yZGVyIDwtIGFsbGRhdGFfYmlydGhvcmRlciAlPiUgaGF2ZW46OnphcF9sYWJlbHMoKSAlPiUgaGF2ZW46OnphcF9mb3JtYXRzKCkgJT4lIHphcF9sYWJlbCgpCnN0cihhbGxkYXRhX2JpcnRob3JkZXIpCmFsbGRhdGFfYmlydGhvcmRlciAlPiUgc2VsZWN0X2lmKGZ1bmN0aW9uKC4pIWlzLm51bWVyaWMoLikpICU+JSBuYW1lcygpCgpjb3JyZWxhdGlvbnMgPSBjb3JyX3BpcGUoYWxsZGF0YV9iaXJ0aG9yZGVyICU+JSBzZWxlY3RfaWYoaXMubnVtZXJpYykpCgphbGxkYXRhX2JpcnRob3JkZXIgPC0gIGFsbGRhdGFfYmlydGhvcmRlciAlPiUgc2VsZWN0KGBtb3RoZXJfcGlkbGlua2AsICBgYWdlYCwgYG1hbGVgLCBgYmlydGhvcmRlcl9uYWl2ZWAsIGBzaWJsaW5nX2NvdW50X25haXZlYCwgYGJpcnRob3JkZXJfZ2VuZXNgLCBgc2libGluZ19jb3VudF9nZW5lc2AsICAKYHJhdmVuXzIwMTVfeW91bmdgLCBgbWF0aF8yMDE1X3lvdW5nYCwgYHJhdmVuXzIwMTVfb2xkYCwgYG1hdGhfMjAxNV9vbGRgLCBgd29yZHNfZGVsYXllZGAsIGBhZGFwdGl2ZV9udW1iZXJpbmdgLCBgcmF2ZW5fMjAwN19vbGRgLCBgcmF2ZW5fMjAwN195b3VuZ2AsIGBtYXRoXzIwMDdfeW91bmdgLCBgbWF0aF8yMDA3X29sZGAsIGBjb3VudF9iYWNrd2FyZHNgLCAKCmBiaWc1X2V4dGAsIGBiaWc1X2NvbmAsIGBiaWc1X29wZW5gLCBgYmlnNV9uZXVgLCBgYmlnNV9hZ3JlZWAsIGByaXNrQWAsIGByaXNrQmAsCgpgRWxlbWVudGFyeV9taXNzZWRgLCBgRWxlbWVudGFyeV93b3JrZWRgLCBgYXR0ZW5kZWRfc2Nob29sYCwKCmB5ZWFyc19vZl9lZHVjYXRpb25gLCBgU2VsZl9lbXBsb3llZGAsIGBldmVyX3Ntb2tlZGAsIGBzdGlsbF9zbW9raW5nYCwgYHdhZ2VfbGFzdF9tb250aF9sb2dgLCBgd2FnZV9sYXN0X3llYXJfbG9nYCwKCmBDYXRlZ29yeV9DYXN1YWwgd29ya2VyIGluIGFncmljdWx0dXJlYCwgYENhdGVnb3J5X0Nhc3VhbCB3b3JrZXIgbm90IGluIGFncmljdWx0dXJlYCwgYENhdGVnb3J5X0dvdmVybm1lbnQgd29ya2VyYCwgYENhdGVnb3J5X1ByaXZhdGUgd29ya2VyYCwgYENhdGVnb3J5X1NlbGYtZW1wbG95ZWRgLCBgQ2F0ZWdvcnlfVW5wYWlkIGZhbWlseSB3b3JrZXJgLCAKYFNlY3Rvcl9BZ3JpY3VsdHVyZSwgZm9yZXN0cnksIGZpc2hpbmcgYW5kIGh1bnRpbmdgLCBgU2VjdG9yX0NvbnN0cnVjdGlvbmAsIGBTZWN0b3JfRWxlY3RyaWNpdHksIGdhcywgd2F0ZXJgLCBgU2VjdG9yX0ZpbmFuY2UsIGluc3VyYW5jZSwgcmVhbCBlc3RhdGUgYW5kIGJ1c2luZXNzIHNlcnZpY2VzYCwgYFNlY3Rvcl9NYW51ZmFjdHVyaW5nYCwgYFNlY3Rvcl9NaW5pbmcgYW5kIHF1YXJyeWluZ2AsIGBTZWN0b3JfU29jaWFsIHNlcnZpY2VzYCwgYFNlY3Rvcl9UcmFuc3BvcnRhdGlvbiwgc3RvcmFnZSBhbmQgY29tbXVuaWNhdGlvbnNgLCBgU2VjdG9yX1dob2xlc2FsZSwgcmV0YWlsLCByZXN0YXVyYW50cyBhbmQgaG90ZWxzYCkKYGBgCgojIyBGdW5jdGlvbnMKCmBgYHtyfQpuX2ltcHV0YXRpb25zLm1pdG1sID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkaXRlciRtCn0Kbl9pbXB1dGF0aW9ucy5taWRzID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkbQp9Cm5faW1wdXRhdGlvbnMuYW1lbGlhID0gZnVuY3Rpb24oaW1wcykgewogIGxlbmd0aChpbXBzJGltcHV0YXRpb25zKQp9Cm5faW1wdXRhdGlvbnMgPSBmdW5jdGlvbihpbXBzKSB7IFVzZU1ldGhvZCgibl9pbXB1dGF0aW9ucyIpIH0KCmNvbXBsZXRlLm1pdG1sID0gbWl0bWw6Om1pdG1sQ29tcGxldGUKY29tcGxldGUubWlkcyA9IG1pY2U6OmNvbXBsZXRlCmNvbXBsZXRlID0gZnVuY3Rpb24oLi4uKSB7IFVzZU1ldGhvZCgiY29tcGxldGUiKSB9CgpsaWJyYXJ5KG1pY2UpCmxpYnJhcnkobWljZWFkZHMpCmxpYnJhcnkobWl0bWwpCmxpYnJhcnkobGF0dGljZSkKbGlicmFyeShwYW4pCgpzb3J0KHJvdW5kKG1pc3NfZnJhYyhhbGxkYXRhX2JpcnRob3JkZXIpLDIpKQojIHNraW1yOjpza2ltKGFsbGRhdGFfYmlydGhvcmRlcikKYGBgCgoKIyMgSW1wdXRhdGlvbiB7LmFjdGl2ZSAudGFic2V0fQpgYGB7cn0Kc2V0LnNlZWQoMTIzKSAjIHJhbmRvbSBzZWVkIHNvIHRoYXQgb3RoZXIgY2FuIHJlcGxpY2F0ZSBvdXIgaW1wdXRhdGlvbgoKIyBsb29rIGF0IHRoZSBkYXRhc2V0CmNvbG5hbWVzKGFsbGRhdGFfYmlydGhvcmRlcikKaGVhZChhbGxkYXRhX2JpcnRob3JkZXIpCmRpbShhbGxkYXRhX2JpcnRob3JkZXIpCm5yb3coYWxsZGF0YV9iaXJ0aG9yZGVyKQpuY29sKGFsbGRhdGFfYmlydGhvcmRlcikKc3VtbWFyeShhbGxkYXRhX2JpcnRob3JkZXIpCgojbG9vayBhdCB0aGUgbWlzc2luZyBkYXRhIHBhdHRlcm4KbWlzc2luZ25lc3NfcGF0dGVybiA9IGFzLmRhdGEuZnJhbWUobWQucGF0dGVybihhbGxkYXRhX2JpcnRob3JkZXIpKQpsZW5ndGgobWlzc2luZ25lc3NfcGF0dGVybikKCgphbGxkYXRhX2JpcnRob3JkZXIgPC0gYWxsZGF0YV9iaXJ0aG9yZGVyICU+JSBzZWxlY3QoLXBpZGxpbmspCmFsbGRhdGFfYmlydGhvcmRlciRtb3RoZXJfcGlkbGluayA9IGFzLmludGVnZXIoYWxsZGF0YV9iaXJ0aG9yZGVyJG1vdGhlcl9waWRsaW5rKQpza2ltcjo6c2tpbShhbGxkYXRhX2JpcnRob3JkZXIpCgppbXAwIDwtIG1pY2UoYWxsZGF0YV9iaXJ0aG9yZGVyLCBtYXhpdD0wKQoKcHJlZDEgPC0gaW1wMCRwcmVkaWN0b3JNYXRyaXgKcHJlZDEKcHJlZDEgPSBxdWlja3ByZWQoYWxsZGF0YV9iaXJ0aG9yZGVyLCBtaW5jb3IgPSAwLjEpICNhbGwgdmFyaWFibGVzIHRoYXQgY29ycmVsYXRlID4gLjAxCnByZWQxCm1ldGgxIDwtIGltcDAkbWV0aG9kCgojIGxpbmVhciBtdWx0aWxldmVsIGltcHV0YXRpb24gdXNpbmcgdGhlIGZ1bmN0aW9uIG1pY2UuaW1wdXRlLjJsLm5vcm0oKQojIHNwZWNpZnkgcHJlZGljdG9yX21hdHJpeCB1c2luZyAxID0gZml4ZWQgZWZmZWN0cywgMiA9IHJhbmRvbSBlZmZlY3RzLCAtMiA9IGNsYXNzIHZhcmlhYmxlLCAwID0gbm8gZWZmZWN0CiMgd2UgY2FuIHNldCB0aGUgbW90aGVyX3BpZGxpbmsgYXMgY2xhc3MgdmFyaWFibGUgKD0gLTIpCnByZWQxWywgIm1vdGhlcl9waWRsaW5rIl0gPSAtMgojIHNldCBpbXB1dGF0aW9uIHByb2NlZHVyZXMKbWV0aDFbLTFdIDwtICIybC5wYW4iCm1ldGgxCnByZWQxCgppbXAxIDwtIG1pY2UoYWxsZGF0YV9iaXJ0aG9yZGVyLCBtYXhpdCA9IDQsIG09MiwgcHJlZGljdG9yTWF0cml4ID0gcHJlZDEsIG1ldGhvZCA9IG1ldGgxKQoKbGlicmFyeShmdXR1cmUpCnBsYW4obXVsdGljb3JlKHdvcmtlcnMgPSAxMCkpCmltcHMgPSBsaXN0ZW52OjpsaXN0ZW52KCkKZm9yIChpIGluIHNlcV9hbG9uZygxOjEwKSkgewogIGltcHNbW2ldXSAlPC0lIG1pY2UoYWxsZGF0YV9iaXJ0aG9yZGVyLCBtID0gMSwgbWF4aXQgPSAxNSwgcHJlZGljdG9yTWF0cml4ID0gcHJlZDEsIG1ldGhvZCA9IG1ldGgxKQp9CnNhdmUoaW1wcywgZmlsZSA9ICJpbXBzLnJkYXRhIikKCmFsbF9pbXBzID0gYXMubGlzdChpbXBzKQpzYXZlKGFsbF9pbXBzLCBmaWxlID0gImltcHMyLnJkYXRhIikKYWxsZGF0YV9iaXJ0aG9yZGVyX2kgPSBhbGxfaW1wc1tbMV1dCmZvciAoaSBpbiBzZXFfYWxvbmcoMjpsZW5ndGgoYWxsX2ltcHMpKSkgewogIGFsbGRhdGFfYmlydGhvcmRlcl9pID0gaWJpbmQoYWxsZGF0YV9iaXJ0aG9yZGVyX2ksIGFsbF9pbXBzW1tpXV0pCn0Kc2F2ZVJEUyhhbGxkYXRhX2JpcnRob3JkZXJfaSwgZmlsZSA9ICJhbGxkYXRhX2JpcnRob3JkZXJfaV9tbC5yZHMiKQpgYGAKIAoK</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
