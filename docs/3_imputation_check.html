<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Laura Botzet &amp; Ruben Arslan" />

<meta name="date" content="2017-09-28" />

<title>3_imputation_check</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">



<head>
<style>
.dropdown-menu li:hover .sub-menu {
  visibility: visible;
}

.dropdown:hover .dropdown-menu {
  display: block;
}
</style>
</head>


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
<div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
  </button>
  <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
</div>
<div id="navbar" class="navbar-collapse collapse">
  <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>

<li class="dropdown" style="background-color: #E5C494">
        <a class="dropdown-toggle" aria-expanded="false">
          Birth Order Effects <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" style="background-color: #E5C494">
          <li class=""><a href="4_analyses.html" aria-expanded="false" aria-controls="first-tab"> Main Analyses</a></li>
          <li class=""><a href="4_analyses_robust.html" aria-expanded="false" aria-controls="first-tab"> Robustness Analyses</a></li>
        </ul>
     </li>


<li class="dropdown" style="background-color: #FFD92F">
        <a class="dropdown-toggle" aria-expanded="false">
          Birth Order Effects Imputed Data <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" style="background-color: #FFD92F">
          <li class=""><a href="3_imputation.html" aria-expanded="false" aria-controls="first-tab">Multiple Imputation</a></li>
          <li class=""><a href="3_imputation_check.html" aria-expanded="false" aria-controls="first-tab">Imputation Checks</a></li>
          <li class=""><a href="4_analyses_imputed_data.html" aria-expanded="false" aria-controls="second-tab">Birth Order Effects Imputed Data</a></li>
        </ul>
     </li>


  </ul>
  <ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
<span class="fa fa-github"></span>


  </a>
</li>
  </ul>
</div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">3_imputation_check</h1>
<h4 class="author">Laura Botzet &amp; Ruben Arslan</h4>
<h4 class="date">28 September 2017</h4>

</div>


<div id="imputation-checks" class="section level1 tabset">
<h1><span style="color:#FFD92F">Imputation Checks</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## Loading required package: usethis</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.6-5</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Matrix&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;codebook&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     bfi</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     aggregate_and_document_scale, asis_knit_child, expired, paste.knit_asis, rescue_attributes,
##     reverse_labelled_values</code></pre>
<pre><code>## 
## Attaching package: &#39;effsize&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cohen.d</code></pre>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<pre class="r"><code>### Import alldata used for birthorder and g-factors computed
alldata_birthorder = readRDS(&quot;data/alldata_birthorder_missing.rds&quot;)

alldata_birthorder_i =  readRDS(&quot;data/alldata_birthorder_i_ml.rds&quot;)

colnames(alldata_birthorder)</code></pre>
<p><em>mother_pidlink</em>, <em>age</em>, <em>male</em>, <em>birthorder_naive</em>, <em>sibling_count_naive</em>, <em>count_birthorder_naive</em>, <em>birthorder_genes</em>, <em>sibling_count_genes</em>, <em>count_birthorder_genes</em>, <em>raven_2015_young</em>, <em>math_2015_young</em>, <em>raven_2015_old</em>, <em>math_2015_old</em>, <em>words_delayed</em>, <em>adaptive_numbering</em>, <em>raven_2007_old</em>, <em>raven_2007_young</em>, <em>math_2007_young</em>, <em>math_2007_old</em>, <em>count_backwards</em>, <em>big5_ext</em>, <em>big5_con</em>, <em>big5_open</em>, <em>big5_neu</em>, <em>big5_agree</em>, <em>riskA</em>, <em>riskB</em>, <em>Elementary_missed</em>, <em>Elementary_worked</em>, <em>attended_school</em>, <em>years_of_education</em>, <em>Self_employed</em>, <em>ever_smoked</em>, <em>still_smoking</em>, <em>wage_last_month_log</em>, <em>wage_last_year_log</em>, <em>age2</em> and <em>age3</em></p>
</div>
<div id="functions-needed" class="section level2">
<h2>Functions needed</h2>
<pre class="r"><code>n_imputations.mitml = function(imps) {
  imps$iter$m
}
n_imputations.mids = function(imps) {
  imps$m
}
n_imputations.amelia = function(imps) {
  length(imps$imputations)
}
n_imputations = function(imps) { UseMethod(&quot;n_imputations&quot;) }

complete.mitml = mitml::mitmlComplete
complete.mids = mice::complete
complete = function(...) { UseMethod(&quot;complete&quot;) }

library(mice)</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     complete</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     complete</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     cbind, rbind</code></pre>
<pre class="r"><code>library(miceadds)</code></pre>
<pre><code>## * miceadds 3.7-6 (2019-12-15 13:38:43)</code></pre>
<pre class="r"><code>library(mitml)</code></pre>
<pre><code>## *** This is beta software. Please report any bugs!
## *** See the NEWS file for recent changes.</code></pre>
<pre class="r"><code>corr_pipe = . %&gt;%  as.matrix() %&gt;% 
Hmisc::rcorr(.) %&gt;% {
  left_join(left_join(.$r %&gt;% reshape2::melt() %&gt;% rename(r = value), 
                      .$n %&gt;% reshape2::melt() %&gt;% rename(n = value), by = c(&quot;Var1&quot;, &quot;Var2&quot;)),
            .$P %&gt;% reshape2::melt() %&gt;% rename(p = value), 
            by = c(&quot;Var1&quot;, &quot;Var2&quot;))
  } %&gt;% 
  arrange(desc(r)) %&gt;% 
  filter(Var1 != Var2)

alldata_birthorder_i_g_factor &lt;- mids2mitml.list(alldata_birthorder_i)

alldata_birthorder_i_tbl = alldata_birthorder_i_g_factor %&gt;% tbl_df.mitml.list</code></pre>
</div>
</div>
<div id="compute-g-factor" class="section level1">
<h1>Compute g factor</h1>
<p>Or rather simply a sum score of scaled test scores to keep things simple here.</p>
<pre class="r"><code># Imputed data
alldata_birthorder_i_g_factor &lt;- within(alldata_birthorder_i_g_factor, {
  g_factor_2015 &lt;- rowMeans(scale(cbind(raven_2015_old, math_2015_old, count_backwards,  words_delayed, adaptive_numbering)))
})

alldata_birthorder_i_g_factor &lt;- within(alldata_birthorder_i_g_factor, {
  g_factor_2007 &lt;- rowMeans(scale(cbind(raven_2007_old, math_2007_old, count_backwards,  words_delayed, adaptive_numbering)))
})</code></pre>
<div id="iterations-and-convergence" class="section level2">
<h2>Iterations and convergence</h2>
<pre class="r"><code>plot(alldata_birthorder_i)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-1.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-2.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-3.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-4.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-5.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-6.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-7.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-8.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-9.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-10.png" width="672" /><img src="3_imputation_check_files/figure-html/unnamed-chunk-4-11.png" width="672" /></p>
</div>
<div id="correlations-iterations-and-density" class="section level2 active">
<h2>Correlations, iterations and density</h2>
<pre class="r"><code># correlations
correlations_original = corr_pipe(alldata_birthorder %&gt;% select_if(is.numeric))
correlations_imputed = corr_pipe(alldata_birthorder_i_g_factor[[1]] %&gt;% select_if(is.numeric))

correlations_original = correlations_original %&gt;%
  mutate(v = paste0(Var1, Var2)) %&gt;%
  rename(Var1_original = Var1, Var2_original= Var2, n_original = n, r_original = r, p_original = p)

correlations_imputed = correlations_imputed %&gt;%
  mutate(v = paste0(Var1, Var2)) %&gt;%
  rename(Var1_imputed = Var1, Var2_imputed = Var2, n_imputed = n, r_imputed = r, p_imputed = p)

correlations = full_join(correlations_original, correlations_imputed, by = &quot;v&quot;)

cor.test(correlations$r_original, correlations$r_imputed)</code></pre>
<table>
<caption>Pearson’s product-moment correlation: <code>correlations$r_original</code> and <code>correlations$r_imputed</code></caption>
<colgroup>
<col width="22%" />
<col width="9%" />
<col width="24%" />
<col width="32%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">30.46</td>
<td align="center">1178</td>
<td align="center">8.745e-151 * * *</td>
<td align="center">two.sided</td>
<td align="center">0.6638</td>
</tr>
</tbody>
</table>
<pre class="r"><code>library(ggrepel)
sum(abs(correlations$r_original - correlations$r_imputed) &gt; 0.5, na.rm = T)</code></pre>
<pre><code>## [1] 18</code></pre>
<pre class="r"><code>correlations &lt;- correlations %&gt;% 
  mutate(label = if_else(abs(r_original - r_imputed) &gt; 0.5, 
                         paste(Var1_original, Var2_original),
                         NA_character_))
ggplot(correlations, aes(r_original, r_imputed)) +
  geom_point(alpha = 0.1) + 
  geom_text_repel(aes(label = label))</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># check densities of imputed/real

densityplot(alldata_birthorder_i, ~ birthorder_genes + sibling_count_genes + birthorder_naive)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<pre class="r"><code>densityplot(alldata_birthorder_i, ~ raven_2015_young + math_2015_young + raven_2015_old + math_2015_old)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<pre class="r"><code>densityplot(alldata_birthorder_i, ~ words_delayed + adaptive_numbering + count_backwards)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-4.png" width="672" /></p>
<pre class="r"><code>densityplot(alldata_birthorder_i, ~ raven_2007_old + raven_2007_young + math_2007_young + math_2007_old)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-5.png" width="672" /></p>
<pre class="r"><code>densityplot(alldata_birthorder_i, ~ big5_ext + big5_con + big5_open + big5_neu + big5_agree)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-6.png" width="672" /></p>
<pre class="r"><code>densityplot(alldata_birthorder_i, ~ riskA + riskB)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-7.png" width="672" /></p>
<pre class="r"><code>densityplot(alldata_birthorder_i, ~ Elementary_missed + Elementary_worked + attended_school + years_of_education + Self_employed)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-8.png" width="672" /></p>
<pre class="r"><code>densityplot(alldata_birthorder_i, ~ ever_smoked + still_smoking + wage_last_month_log + wage_last_year_log)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-9.png" width="672" /></p>
<pre class="r"><code>pdf(&quot;density.pdf&quot;)
densityplot(alldata_birthorder_i, ~ birthorder_genes + sibling_count_genes + birthorder_naive)

densityplot(alldata_birthorder_i, ~ raven_2015_young + math_2015_young + raven_2015_old + math_2015_old)

densityplot(alldata_birthorder_i, ~ words_delayed + adaptive_numbering + count_backwards)
            
densityplot(alldata_birthorder_i, ~ raven_2007_old + raven_2007_young + math_2007_young + math_2007_old)

densityplot(alldata_birthorder_i, ~ big5_ext + big5_con + big5_open + big5_neu + big5_agree)

densityplot(alldata_birthorder_i, ~ riskA + riskB)

densityplot(alldata_birthorder_i, ~ Elementary_missed + Elementary_worked + attended_school + years_of_education + Self_employed)

densityplot(alldata_birthorder_i, ~ ever_smoked + still_smoking + wage_last_month_log + wage_last_year_log)

dev.off()</code></pre>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<pre class="r"><code># additional analyses based on van Buuren &amp; Groothuis-Oudshoorn, 2011
xyplot(alldata_birthorder_i, birthorder_genes ~ birthorder_naive | .imp , pch = 20, cex = 1.4)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-10.png" width="672" /></p>
<pre class="r"><code>xyplot(alldata_birthorder_i, sibling_count_genes ~ birthorder_genes | .imp , pch = 20, cex = 1.4)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-11.png" width="672" /></p>
<pre class="r"><code>xyplot(alldata_birthorder_i, raven_2015_old ~ birthorder_genes | .imp , pch = 20, cex = 1.4)</code></pre>
<p><img src="3_imputation_check_files/figure-html/unnamed-chunk-5-12.png" width="672" /></p>
</div>
<div id="g-factor" class="section level2">
<h2>G-Factor</h2>
<pre class="r"><code># Normal data - no misses
alldata_birthorder &lt;- alldata_birthorder %&gt;%
  mutate(pidlink = row_number())
no_miss = alldata_birthorder %&gt;%
  filter(!is.na(raven_2015_old), !is.na(math_2015_old), !is.na(count_backwards),
         !is.na(words_delayed), !is.na(adaptive_numbering))
fa.parallel(no_miss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, words_delayed, adaptive_numbering) %&gt;% data.frame())</code></pre>
<p><img src="3_imputation_check_files/figure-html/g%20factor-1.png" width="672" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  2  and the number of components =  1</code></pre>
<pre class="r"><code>fa(no_miss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, words_delayed, adaptive_numbering) %&gt;% data.frame(), nfactors = 1)</code></pre>
<pre><code>## Factor Analysis using method =  minres
## Call: fa(r = no_miss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, 
##     words_delayed, adaptive_numbering) %&gt;% data.frame(), nfactors = 1)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                     MR1   h2   u2 com
## raven_2015_old     0.62 0.38 0.62   1
## math_2015_old      0.51 0.26 0.74   1
## count_backwards    0.46 0.22 0.78   1
## words_delayed      0.42 0.18 0.82   1
## adaptive_numbering 0.62 0.38 0.62   1
## 
##                 MR1
## SS loadings    1.42
## Proportion Var 0.28
## 
## Mean item complexity =  1
## Test of the hypothesis that 1 factor is sufficient.
## 
## The degrees of freedom for the null model are  10  and the objective function was  0.58 with Chi Square of  8539
## The degrees of freedom for the model are 5  and the objective function was  0.01 
## 
## The root mean square of the residuals (RMSR) is  0.02 
## The df corrected root mean square of the residuals is  0.02 
## 
## The harmonic number of observations is  14688 with the empirical chi square  77.5  with prob &lt;  2.8e-15 
## The total number of observations was  14688  with Likelihood Chi Square =  78.47  with prob &lt;  1.8e-15 
## 
## Tucker Lewis Index of factoring reliability =  0.983
## RMSEA index =  0.032  and the 90 % confidence intervals are  0.026 0.038
## BIC =  30.49
## Fit based upon off diagonal values = 1
## Measures of factor score adequacy             
##                                                    MR1
## Correlation of (regression) scores with factors   0.82
## Multiple R square of scores with factors          0.67
## Minimum correlation of possible factor scores     0.35</code></pre>
<pre class="r"><code>om_results = omega(no_miss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, words_delayed, adaptive_numbering) %&gt;% data.frame(), nfactors = 1, sl = F)</code></pre>
<pre><code>## Omega_h for 1 factor is not meaningful, just omega_t</code></pre>
<pre class="r"><code>om_results</code></pre>
<pre><code>## Omega 
## Call: omegah(m = m, nfactors = nfactors, fm = fm, key = key, flip = flip, 
##     digits = digits, title = title, sl = sl, labels = labels, 
##     plot = plot, n.obs = n.obs, rotate = rotate, Phi = Phi, option = option, 
##     covar = covar)
## Alpha:                 0.65 
## G.6:                   0.61 
## Omega Hierarchical:    0.66 
## Omega H asymptotic:    1 
## Omega Total            0.66 
## 
## Schmid Leiman Factor loadings greater than  0.2 
##                       g  F1*   h2   u2 p2
## raven_2015_old     0.62      0.38 0.62  1
## math_2015_old      0.51      0.26 0.74  1
## count_backwards    0.46      0.22 0.78  1
## words_delayed      0.42      0.18 0.82  1
## adaptive_numbering 0.62      0.38 0.62  1
## 
## With eigenvalues of:
##   g F1* 
## 1.4 0.0 
## 
## general/max  1.02e+16   max/min =   1
## mean percent general =  1    with sd =  0 and cv of  0 
## Explained Common Variance of the general factor =  1 
## 
## The degrees of freedom are 5  and the fit is  0.01 
## The number of observations was  14688  with Chi Square =  78.47  with prob &lt;  1.8e-15
## The root mean square of the residuals is  0.02 
## The df corrected root mean square of the residuals is  0.02
## RMSEA index =  0.032  and the 10 % confidence intervals are  0.026 0.038
## BIC =  30.49
## 
## Compare this with the adequacy of just a general factor and no group factors
## The degrees of freedom for just the general factor are 5  and the fit is  0.01 
## The number of observations was  14688  with Chi Square =  78.47  with prob &lt;  1.8e-15
## The root mean square of the residuals is  0.02 
## The df corrected root mean square of the residuals is  0.02 
## 
## RMSEA index =  0.032  and the 10 % confidence intervals are  0.026 0.038
## BIC =  30.49 
## 
## Measures of factor score adequacy             
##                                                  g F1*
## Correlation of scores with factors            0.82   0
## Multiple R square of scores with factors      0.67   0
## Minimum correlation of factor score estimates 0.35  -1
## 
##  Total, General and Subset omega for each subset
##                                                  g  F1*
## Omega total for total scores and subscales    0.66 0.66
## Omega general for total scores and subscales  0.66 0.66
## Omega group for total scores and subscales    0.00 0.00</code></pre>
<pre class="r"><code>omega.diagram(om_results)</code></pre>
<p><img src="3_imputation_check_files/figure-html/g%20factor-2.png" width="672" /></p>
<pre class="r"><code>&quot;g_factor_nomiss =~ raven_2015_old + math_2015_old + count_backwards +  words_delayed + adaptive_numbering&quot; %&gt;%
  cfa(data = no_miss, std.lv = T, std.ov = T) -&gt; cfa_g
summary(cfa_g)</code></pre>
<pre><code>## lavaan 0.6-5 ended normally after 14 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         10
##                                                       
##   Number of observations                         14688
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                78.411
##   Degrees of freedom                                 5
##   P-value (Chi-square)                           0.000
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard errors                             Standard
## 
## Latent Variables:
##                      Estimate  Std.Err  z-value  P(&gt;|z|)
##   g_factor_nomiss =~                                    
##     raven_2015_old      0.616    0.010   63.882    0.000
##     math_2015_old       0.514    0.010   53.360    0.000
##     count_backwrds      0.465    0.010   48.038    0.000
##     words_delayed       0.419    0.010   43.063    0.000
##     adaptiv_nmbrng      0.616    0.010   63.838    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .raven_2015_old    0.620    0.010   59.142    0.000
##    .math_2015_old     0.736    0.010   70.337    0.000
##    .count_backwrds    0.784    0.011   73.996    0.000
##    .words_delayed     0.824    0.011   76.713    0.000
##    .adaptiv_nmbrng    0.621    0.010   59.203    0.000
##     g_factor_nomss    1.000</code></pre>
<pre class="r"><code>## Explained variance:
x = inspect(cfa_g, &quot;rsquare&quot;)
no_miss$g_factor_nomiss = predict(cfa_g)[,1]

no_miss = no_miss %&gt;% select(pidlink, g_factor_nomiss)

alldata_birthorder = left_join(alldata_birthorder, no_miss, by = &quot;pidlink&quot;)
qplot(alldata_birthorder$g_factor_nomiss)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="3_imputation_check_files/figure-html/g%20factor-3.png" width="672" /></p>
<pre class="r"><code>qplot(alldata_birthorder_i_g_factor[[1]]$g_factor_2015)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="3_imputation_check_files/figure-html/g%20factor-4.png" width="672" /></p>
<pre class="r"><code>qplot(alldata_birthorder_i_g_factor[[1]]$g_factor_2007)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="3_imputation_check_files/figure-html/g%20factor-5.png" width="672" /></p>
<pre class="r"><code>summary(lm(g_factor_nomiss ~ raven_2015_old, alldata_birthorder))</code></pre>
<table style="width:62%;">
<colgroup>
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-1.798</td>
<td align="center">0.01381</td>
<td align="center">-130.1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">2.599</td>
<td align="center">0.01889</td>
<td align="center">137.6</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: g_factor_nomiss ~ raven_2015_old</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">14688</td>
<td align="center">0.5429</td>
<td align="center">0.5631</td>
<td align="center">0.5631</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(lm(g_factor_2015 ~ raven_2015_old, alldata_birthorder_i_g_factor[[1]]))</code></pre>
<table style="width:62%;">
<colgroup>
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-1.232</td>
<td align="center">0.006938</td>
<td align="center">-177.6</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1.828</td>
<td align="center">0.009684</td>
<td align="center">188.8</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: g_factor_2015 ~ raven_2015_old</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">39653</td>
<td align="center">0.4692</td>
<td align="center">0.4734</td>
<td align="center">0.4734</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(lm(g_factor_nomiss ~ raven_2015_young, alldata_birthorder))</code></pre>
<table style="width:62%;">
<colgroup>
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-1.41</td>
<td align="center">0.03367</td>
<td align="center">-41.87</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">2.097</td>
<td align="center">0.04143</td>
<td align="center">50.63</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: g_factor_nomiss ~ raven_2015_young</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">5584</td>
<td align="center">0.6084</td>
<td align="center">0.3147</td>
<td align="center">0.3146</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(lm(g_factor_2015 ~ raven_2015_young, alldata_birthorder_i_g_factor[[1]]))</code></pre>
<table style="width:65%;">
<colgroup>
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-0.1618</td>
<td align="center">0.00621</td>
<td align="center">-26.06</td>
<td align="center">1.858e-148</td>
</tr>
<tr class="even">
<td align="center">0.2324</td>
<td align="center">0.007635</td>
<td align="center">30.44</td>
<td align="center">3.43e-201</td>
</tr>
</tbody>
</table>
<table style="width:89%;">
<caption>Fitting linear model: g_factor_2015 ~ raven_2015_young</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="13%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">39653</td>
<td align="center">0.6391</td>
<td align="center">0.02283</td>
<td align="center">0.02281</td>
</tr>
</tbody>
</table>
<pre class="r"><code>alldata_birthorder %&gt;% {cor.test(.$g_factor_nomiss, .$years_of_education)}</code></pre>
<table style="width:96%;">
<caption>Pearson’s product-moment correlation: <code>.$g_factor_nomiss</code> and <code>.$years_of_education</code></caption>
<colgroup>
<col width="23%" />
<col width="11%" />
<col width="13%" />
<col width="34%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">67.47</td>
<td align="center">14435</td>
<td align="center">0 * * *</td>
<td align="center">two.sided</td>
<td align="center">0.4896</td>
</tr>
</tbody>
</table>
<pre class="r"><code>alldata_birthorder_i_g_factor[[1]] %&gt;% {cor.test(.$g_factor_2015, .$years_of_education)}</code></pre>
<table style="width:96%;">
<caption>Pearson’s product-moment correlation: <code>.$g_factor_2015</code> and <code>.$years_of_education</code></caption>
<colgroup>
<col width="23%" />
<col width="11%" />
<col width="13%" />
<col width="34%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">83.51</td>
<td align="center">39651</td>
<td align="center">0 * * *</td>
<td align="center">two.sided</td>
<td align="center">0.3868</td>
</tr>
</tbody>
</table>
<pre class="r"><code>alldata_birthorder_i_g_factor[[1]] %&gt;% {cor.test(.$g_factor_2007, .$years_of_education)}</code></pre>
<table style="width:96%;">
<caption>Pearson’s product-moment correlation: <code>.$g_factor_2007</code> and <code>.$years_of_education</code></caption>
<colgroup>
<col width="23%" />
<col width="11%" />
<col width="13%" />
<col width="34%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">141.9</td>
<td align="center">39651</td>
<td align="center">0 * * *</td>
<td align="center">two.sided</td>
<td align="center">0.5805</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiM19pbXB1dGF0aW9uX2NoZWNrIgphdXRob3I6ICJMYXVyYSBCb3R6ZXQgJiBSdWJlbiBBcnNsYW4iCmRhdGU6ICIyOCBTZXB0ZW1iZXIgMjAxNyIKb3V0cHV0OiBodG1sX2RvY3VtZW50CmVkaXRvcl9vcHRpb25zOiAKICBjaHVua19vdXRwdXRfdHlwZTogY29uc29sZQotLS0KCiMgPHNwYW4gc3R5bGU9ImNvbG9yOiNGRkQ5MkYiPkltcHV0YXRpb24gQ2hlY2tzPC9zcGFuPiB7LnRhYnNldH0KCmBgYHtyIHNldHVwLCBpbmNsdWRlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUpCmBgYAoKIyMgSGVscGVyCmBgYHtyIGhlbHBlcn0Kc291cmNlKCIwX2hlbHBlcnMuUiIpCmBgYAoKCiMjIERhdGEKYGBge3J9CiMjIyBJbXBvcnQgYWxsZGF0YSB1c2VkIGZvciBiaXJ0aG9yZGVyIGFuZCBnLWZhY3RvcnMgY29tcHV0ZWQKYWxsZGF0YV9iaXJ0aG9yZGVyID0gcmVhZFJEUygiZGF0YS9hbGxkYXRhX2JpcnRob3JkZXJfbWlzc2luZy5yZHMiKQoKYWxsZGF0YV9iaXJ0aG9yZGVyX2kgPSAgcmVhZFJEUygiZGF0YS9hbGxkYXRhX2JpcnRob3JkZXJfaV9tbC5yZHMiKQoKY29sbmFtZXMoYWxsZGF0YV9iaXJ0aG9yZGVyKQpgYGAKCgojIyBGdW5jdGlvbnMgbmVlZGVkCgpgYGB7cn0KCm5faW1wdXRhdGlvbnMubWl0bWwgPSBmdW5jdGlvbihpbXBzKSB7CiAgaW1wcyRpdGVyJG0KfQpuX2ltcHV0YXRpb25zLm1pZHMgPSBmdW5jdGlvbihpbXBzKSB7CiAgaW1wcyRtCn0Kbl9pbXB1dGF0aW9ucy5hbWVsaWEgPSBmdW5jdGlvbihpbXBzKSB7CiAgbGVuZ3RoKGltcHMkaW1wdXRhdGlvbnMpCn0Kbl9pbXB1dGF0aW9ucyA9IGZ1bmN0aW9uKGltcHMpIHsgVXNlTWV0aG9kKCJuX2ltcHV0YXRpb25zIikgfQoKY29tcGxldGUubWl0bWwgPSBtaXRtbDo6bWl0bWxDb21wbGV0ZQpjb21wbGV0ZS5taWRzID0gbWljZTo6Y29tcGxldGUKY29tcGxldGUgPSBmdW5jdGlvbiguLi4pIHsgVXNlTWV0aG9kKCJjb21wbGV0ZSIpIH0KCmxpYnJhcnkobWljZSkKbGlicmFyeShtaWNlYWRkcykKbGlicmFyeShtaXRtbCkKCmNvcnJfcGlwZSA9IC4gJT4lICBhcy5tYXRyaXgoKSAlPiUgCkhtaXNjOjpyY29yciguKSAlPiUgewogIGxlZnRfam9pbihsZWZ0X2pvaW4oLiRyICU+JSByZXNoYXBlMjo6bWVsdCgpICU+JSByZW5hbWUociA9IHZhbHVlKSwgCiAgICAgICAgICAgICAgICAgICAgICAuJG4gJT4lIHJlc2hhcGUyOjptZWx0KCkgJT4lIHJlbmFtZShuID0gdmFsdWUpLCBieSA9IGMoIlZhcjEiLCAiVmFyMiIpKSwKICAgICAgICAgICAgLiRQICU+JSByZXNoYXBlMjo6bWVsdCgpICU+JSByZW5hbWUocCA9IHZhbHVlKSwgCiAgICAgICAgICAgIGJ5ID0gYygiVmFyMSIsICJWYXIyIikpCiAgfSAlPiUgCiAgYXJyYW5nZShkZXNjKHIpKSAlPiUgCiAgZmlsdGVyKFZhcjEgIT0gVmFyMikKCmFsbGRhdGFfYmlydGhvcmRlcl9pX2dfZmFjdG9yIDwtIG1pZHMybWl0bWwubGlzdChhbGxkYXRhX2JpcnRob3JkZXJfaSkKCmFsbGRhdGFfYmlydGhvcmRlcl9pX3RibCA9IGFsbGRhdGFfYmlydGhvcmRlcl9pX2dfZmFjdG9yICU+JSB0YmxfZGYubWl0bWwubGlzdAoKYGBgCgoKIyBDb21wdXRlIGcgZmFjdG9yCk9yIHJhdGhlciBzaW1wbHkgYSBzdW0gc2NvcmUgb2Ygc2NhbGVkIHRlc3Qgc2NvcmVzIHRvIGtlZXAgdGhpbmdzIHNpbXBsZSBoZXJlLgoKYGBge3J9CgojIEltcHV0ZWQgZGF0YQphbGxkYXRhX2JpcnRob3JkZXJfaV9nX2ZhY3RvciA8LSB3aXRoaW4oYWxsZGF0YV9iaXJ0aG9yZGVyX2lfZ19mYWN0b3IsIHsKICBnX2ZhY3Rvcl8yMDE1IDwtIHJvd01lYW5zKHNjYWxlKGNiaW5kKHJhdmVuXzIwMTVfb2xkLCBtYXRoXzIwMTVfb2xkLCBjb3VudF9iYWNrd2FyZHMsICB3b3Jkc19kZWxheWVkLCBhZGFwdGl2ZV9udW1iZXJpbmcpKSkKfSkKCmFsbGRhdGFfYmlydGhvcmRlcl9pX2dfZmFjdG9yIDwtIHdpdGhpbihhbGxkYXRhX2JpcnRob3JkZXJfaV9nX2ZhY3RvciwgewogIGdfZmFjdG9yXzIwMDcgPC0gcm93TWVhbnMoc2NhbGUoY2JpbmQocmF2ZW5fMjAwN19vbGQsIG1hdGhfMjAwN19vbGQsIGNvdW50X2JhY2t3YXJkcywgIHdvcmRzX2RlbGF5ZWQsIGFkYXB0aXZlX251bWJlcmluZykpKQp9KQpgYGAKCiMjIEl0ZXJhdGlvbnMgYW5kIGNvbnZlcmdlbmNlCgpgYGB7cn0KcGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSkKYGBgCgojIyBDb3JyZWxhdGlvbnMsIGl0ZXJhdGlvbnMgYW5kIGRlbnNpdHkgey5hY3RpdmV9CmBgYHtyfQojIGNvcnJlbGF0aW9ucwpjb3JyZWxhdGlvbnNfb3JpZ2luYWwgPSBjb3JyX3BpcGUoYWxsZGF0YV9iaXJ0aG9yZGVyICU+JSBzZWxlY3RfaWYoaXMubnVtZXJpYykpCmNvcnJlbGF0aW9uc19pbXB1dGVkID0gY29ycl9waXBlKGFsbGRhdGFfYmlydGhvcmRlcl9pX2dfZmFjdG9yW1sxXV0gJT4lIHNlbGVjdF9pZihpcy5udW1lcmljKSkKCmNvcnJlbGF0aW9uc19vcmlnaW5hbCA9IGNvcnJlbGF0aW9uc19vcmlnaW5hbCAlPiUKICBtdXRhdGUodiA9IHBhc3RlMChWYXIxLCBWYXIyKSkgJT4lCiAgcmVuYW1lKFZhcjFfb3JpZ2luYWwgPSBWYXIxLCBWYXIyX29yaWdpbmFsPSBWYXIyLCBuX29yaWdpbmFsID0gbiwgcl9vcmlnaW5hbCA9IHIsIHBfb3JpZ2luYWwgPSBwKQoKY29ycmVsYXRpb25zX2ltcHV0ZWQgPSBjb3JyZWxhdGlvbnNfaW1wdXRlZCAlPiUKICBtdXRhdGUodiA9IHBhc3RlMChWYXIxLCBWYXIyKSkgJT4lCiAgcmVuYW1lKFZhcjFfaW1wdXRlZCA9IFZhcjEsIFZhcjJfaW1wdXRlZCA9IFZhcjIsIG5faW1wdXRlZCA9IG4sIHJfaW1wdXRlZCA9IHIsIHBfaW1wdXRlZCA9IHApCgpjb3JyZWxhdGlvbnMgPSBmdWxsX2pvaW4oY29ycmVsYXRpb25zX29yaWdpbmFsLCBjb3JyZWxhdGlvbnNfaW1wdXRlZCwgYnkgPSAidiIpCgpjb3IudGVzdChjb3JyZWxhdGlvbnMkcl9vcmlnaW5hbCwgY29ycmVsYXRpb25zJHJfaW1wdXRlZCkKbGlicmFyeShnZ3JlcGVsKQpzdW0oYWJzKGNvcnJlbGF0aW9ucyRyX29yaWdpbmFsIC0gY29ycmVsYXRpb25zJHJfaW1wdXRlZCkgPiAwLjUsIG5hLnJtID0gVCkKY29ycmVsYXRpb25zIDwtIGNvcnJlbGF0aW9ucyAlPiUgCiAgbXV0YXRlKGxhYmVsID0gaWZfZWxzZShhYnMocl9vcmlnaW5hbCAtIHJfaW1wdXRlZCkgPiAwLjUsIAogICAgICAgICAgICAgICAgICAgICAgICAgcGFzdGUoVmFyMV9vcmlnaW5hbCwgVmFyMl9vcmlnaW5hbCksCiAgICAgICAgICAgICAgICAgICAgICAgICBOQV9jaGFyYWN0ZXJfKSkKZ2dwbG90KGNvcnJlbGF0aW9ucywgYWVzKHJfb3JpZ2luYWwsIHJfaW1wdXRlZCkpICsKICBnZW9tX3BvaW50KGFscGhhID0gMC4xKSArIAogIGdlb21fdGV4dF9yZXBlbChhZXMobGFiZWwgPSBsYWJlbCkpCgoKIyBjaGVjayBkZW5zaXRpZXMgb2YgaW1wdXRlZC9yZWFsCgpkZW5zaXR5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgfiBiaXJ0aG9yZGVyX2dlbmVzICsgc2libGluZ19jb3VudF9nZW5lcyArIGJpcnRob3JkZXJfbmFpdmUpCgpkZW5zaXR5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgfiByYXZlbl8yMDE1X3lvdW5nICsgbWF0aF8yMDE1X3lvdW5nICsgcmF2ZW5fMjAxNV9vbGQgKyBtYXRoXzIwMTVfb2xkKQoKZGVuc2l0eXBsb3QoYWxsZGF0YV9iaXJ0aG9yZGVyX2ksIH4gd29yZHNfZGVsYXllZCArIGFkYXB0aXZlX251bWJlcmluZyArIGNvdW50X2JhY2t3YXJkcykKICAgICAgICAgICAgCmRlbnNpdHlwbG90KGFsbGRhdGFfYmlydGhvcmRlcl9pLCB+IHJhdmVuXzIwMDdfb2xkICsgcmF2ZW5fMjAwN195b3VuZyArIG1hdGhfMjAwN195b3VuZyArIG1hdGhfMjAwN19vbGQpCgpkZW5zaXR5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgfiBiaWc1X2V4dCArIGJpZzVfY29uICsgYmlnNV9vcGVuICsgYmlnNV9uZXUgKyBiaWc1X2FncmVlKQoKZGVuc2l0eXBsb3QoYWxsZGF0YV9iaXJ0aG9yZGVyX2ksIH4gcmlza0EgKyByaXNrQikKCgpkZW5zaXR5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgfiBFbGVtZW50YXJ5X21pc3NlZCArIEVsZW1lbnRhcnlfd29ya2VkICsgYXR0ZW5kZWRfc2Nob29sICsgeWVhcnNfb2ZfZWR1Y2F0aW9uICsgU2VsZl9lbXBsb3llZCkKCmRlbnNpdHlwbG90KGFsbGRhdGFfYmlydGhvcmRlcl9pLCB+IGV2ZXJfc21va2VkICsgc3RpbGxfc21va2luZyArIHdhZ2VfbGFzdF9tb250aF9sb2cgKyB3YWdlX2xhc3RfeWVhcl9sb2cpCgoKCnBkZigiZGVuc2l0eS5wZGYiKQpkZW5zaXR5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgfiBiaXJ0aG9yZGVyX2dlbmVzICsgc2libGluZ19jb3VudF9nZW5lcyArIGJpcnRob3JkZXJfbmFpdmUpCgpkZW5zaXR5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgfiByYXZlbl8yMDE1X3lvdW5nICsgbWF0aF8yMDE1X3lvdW5nICsgcmF2ZW5fMjAxNV9vbGQgKyBtYXRoXzIwMTVfb2xkKQoKZGVuc2l0eXBsb3QoYWxsZGF0YV9iaXJ0aG9yZGVyX2ksIH4gd29yZHNfZGVsYXllZCArIGFkYXB0aXZlX251bWJlcmluZyArIGNvdW50X2JhY2t3YXJkcykKICAgICAgICAgICAgCmRlbnNpdHlwbG90KGFsbGRhdGFfYmlydGhvcmRlcl9pLCB+IHJhdmVuXzIwMDdfb2xkICsgcmF2ZW5fMjAwN195b3VuZyArIG1hdGhfMjAwN195b3VuZyArIG1hdGhfMjAwN19vbGQpCgpkZW5zaXR5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgfiBiaWc1X2V4dCArIGJpZzVfY29uICsgYmlnNV9vcGVuICsgYmlnNV9uZXUgKyBiaWc1X2FncmVlKQoKZGVuc2l0eXBsb3QoYWxsZGF0YV9iaXJ0aG9yZGVyX2ksIH4gcmlza0EgKyByaXNrQikKCmRlbnNpdHlwbG90KGFsbGRhdGFfYmlydGhvcmRlcl9pLCB+IEVsZW1lbnRhcnlfbWlzc2VkICsgRWxlbWVudGFyeV93b3JrZWQgKyBhdHRlbmRlZF9zY2hvb2wgKyB5ZWFyc19vZl9lZHVjYXRpb24gKyBTZWxmX2VtcGxveWVkKQoKZGVuc2l0eXBsb3QoYWxsZGF0YV9iaXJ0aG9yZGVyX2ksIH4gZXZlcl9zbW9rZWQgKyBzdGlsbF9zbW9raW5nICsgd2FnZV9sYXN0X21vbnRoX2xvZyArIHdhZ2VfbGFzdF95ZWFyX2xvZykKCmRldi5vZmYoKQoKIyBhZGRpdGlvbmFsIGFuYWx5c2VzIGJhc2VkIG9uIHZhbiBCdXVyZW4gJiBHcm9vdGh1aXMtT3Vkc2hvb3JuLCAyMDExCnh5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgYmlydGhvcmRlcl9nZW5lcyB+IGJpcnRob3JkZXJfbmFpdmUgfCAuaW1wICwgcGNoID0gMjAsIGNleCA9IDEuNCkKCnh5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgc2libGluZ19jb3VudF9nZW5lcyB+IGJpcnRob3JkZXJfZ2VuZXMgfCAuaW1wICwgcGNoID0gMjAsIGNleCA9IDEuNCkKCnh5cGxvdChhbGxkYXRhX2JpcnRob3JkZXJfaSwgcmF2ZW5fMjAxNV9vbGQgfiBiaXJ0aG9yZGVyX2dlbmVzIHwgLmltcCAsIHBjaCA9IDIwLCBjZXggPSAxLjQpCgpgYGAKCgojIyBHLUZhY3RvcgpgYGB7ciBnIGZhY3Rvcn0KIyBOb3JtYWwgZGF0YSAtIG5vIG1pc3NlcwphbGxkYXRhX2JpcnRob3JkZXIgPC0gYWxsZGF0YV9iaXJ0aG9yZGVyICU+JQogIG11dGF0ZShwaWRsaW5rID0gcm93X251bWJlcigpKQpub19taXNzID0gYWxsZGF0YV9iaXJ0aG9yZGVyICU+JQogIGZpbHRlcighaXMubmEocmF2ZW5fMjAxNV9vbGQpLCAhaXMubmEobWF0aF8yMDE1X29sZCksICFpcy5uYShjb3VudF9iYWNrd2FyZHMpLAogICAgICAgICAhaXMubmEod29yZHNfZGVsYXllZCksICFpcy5uYShhZGFwdGl2ZV9udW1iZXJpbmcpKQpmYS5wYXJhbGxlbChub19taXNzICU+JSBzZWxlY3QocmF2ZW5fMjAxNV9vbGQsIG1hdGhfMjAxNV9vbGQsIGNvdW50X2JhY2t3YXJkcywgd29yZHNfZGVsYXllZCwgYWRhcHRpdmVfbnVtYmVyaW5nKSAlPiUgZGF0YS5mcmFtZSgpKQpmYShub19taXNzICU+JSBzZWxlY3QocmF2ZW5fMjAxNV9vbGQsIG1hdGhfMjAxNV9vbGQsIGNvdW50X2JhY2t3YXJkcywgd29yZHNfZGVsYXllZCwgYWRhcHRpdmVfbnVtYmVyaW5nKSAlPiUgZGF0YS5mcmFtZSgpLCBuZmFjdG9ycyA9IDEpCm9tX3Jlc3VsdHMgPSBvbWVnYShub19taXNzICU+JSBzZWxlY3QocmF2ZW5fMjAxNV9vbGQsIG1hdGhfMjAxNV9vbGQsIGNvdW50X2JhY2t3YXJkcywgd29yZHNfZGVsYXllZCwgYWRhcHRpdmVfbnVtYmVyaW5nKSAlPiUgZGF0YS5mcmFtZSgpLCBuZmFjdG9ycyA9IDEsIHNsID0gRikKb21fcmVzdWx0cwpvbWVnYS5kaWFncmFtKG9tX3Jlc3VsdHMpCgoiZ19mYWN0b3Jfbm9taXNzID1+IHJhdmVuXzIwMTVfb2xkICsgbWF0aF8yMDE1X29sZCArIGNvdW50X2JhY2t3YXJkcyArICB3b3Jkc19kZWxheWVkICsgYWRhcHRpdmVfbnVtYmVyaW5nIiAlPiUKICBjZmEoZGF0YSA9IG5vX21pc3MsIHN0ZC5sdiA9IFQsIHN0ZC5vdiA9IFQpIC0+IGNmYV9nCnN1bW1hcnkoY2ZhX2cpCgojIyBFeHBsYWluZWQgdmFyaWFuY2U6CnggPSBpbnNwZWN0KGNmYV9nLCAicnNxdWFyZSIpCm5vX21pc3MkZ19mYWN0b3Jfbm9taXNzID0gcHJlZGljdChjZmFfZylbLDFdCgpub19taXNzID0gbm9fbWlzcyAlPiUgc2VsZWN0KHBpZGxpbmssIGdfZmFjdG9yX25vbWlzcykKCmFsbGRhdGFfYmlydGhvcmRlciA9IGxlZnRfam9pbihhbGxkYXRhX2JpcnRob3JkZXIsIG5vX21pc3MsIGJ5ID0gInBpZGxpbmsiKQpxcGxvdChhbGxkYXRhX2JpcnRob3JkZXIkZ19mYWN0b3Jfbm9taXNzKQoKCnFwbG90KGFsbGRhdGFfYmlydGhvcmRlcl9pX2dfZmFjdG9yW1sxXV0kZ19mYWN0b3JfMjAxNSkKcXBsb3QoYWxsZGF0YV9iaXJ0aG9yZGVyX2lfZ19mYWN0b3JbWzFdXSRnX2ZhY3Rvcl8yMDA3KQoKc3VtbWFyeShsbShnX2ZhY3Rvcl9ub21pc3MgfiByYXZlbl8yMDE1X29sZCwgYWxsZGF0YV9iaXJ0aG9yZGVyKSkKc3VtbWFyeShsbShnX2ZhY3Rvcl8yMDE1IH4gcmF2ZW5fMjAxNV9vbGQsIGFsbGRhdGFfYmlydGhvcmRlcl9pX2dfZmFjdG9yW1sxXV0pKQpzdW1tYXJ5KGxtKGdfZmFjdG9yX25vbWlzcyB+IHJhdmVuXzIwMTVfeW91bmcsIGFsbGRhdGFfYmlydGhvcmRlcikpCnN1bW1hcnkobG0oZ19mYWN0b3JfMjAxNSB+IHJhdmVuXzIwMTVfeW91bmcsIGFsbGRhdGFfYmlydGhvcmRlcl9pX2dfZmFjdG9yW1sxXV0pKQoKYWxsZGF0YV9iaXJ0aG9yZGVyICU+JSB7Y29yLnRlc3QoLiRnX2ZhY3Rvcl9ub21pc3MsIC4keWVhcnNfb2ZfZWR1Y2F0aW9uKX0KYWxsZGF0YV9iaXJ0aG9yZGVyX2lfZ19mYWN0b3JbWzFdXSAlPiUge2Nvci50ZXN0KC4kZ19mYWN0b3JfMjAxNSwgLiR5ZWFyc19vZl9lZHVjYXRpb24pfQphbGxkYXRhX2JpcnRob3JkZXJfaV9nX2ZhY3RvcltbMV1dICU+JSB7Y29yLnRlc3QoLiRnX2ZhY3Rvcl8yMDA3LCAuJHllYXJzX29mX2VkdWNhdGlvbil9CmBgYAo=</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("3_imputation_check.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
