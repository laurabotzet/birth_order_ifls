<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>1_data_import.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("1_data_import.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>
<li style="background-color: #A6D854">
  <a href="4_analyses.html">Birth Order Effects</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
    <span class="fa fa-github"></span>


  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>




</div>


<div id="data-wrangling" class="section level1 tabset">
<h1><span style="color:#FC8D62">Data Wrangling</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     ggsave</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.5-23.1097</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;sjPlot&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:cowplot&#39;:
## 
##     plot_grid, save_plot</code></pre>
</div>
<div id="import-data" class="section level2 active">
<h2>Import data</h2>
<p>All data is retrieved from the <a href="http://www.rand.org/labor/FLS/IFLS.html">RAND foundation</a></p>
<pre class="r"><code>### Informations about individuals living in the household in 2014/2015
## All Individuals living in the household
bk_ar1 = read_dta(&quot;data/hh14_all_dta/bk_ar1.dta&quot;) # Book K, Section ar
# compute father pidlink
bk_ar1 = left_join(bk_ar1, bk_ar1 %&gt;% select(hhid14_9, pid14, pidlink) %&gt;% rename(ar10 = pid14, father_pidlink = pidlink), by = c(&quot;hhid14_9&quot;, &quot;ar10&quot;))</code></pre>
<pre><code>## Warning: Column `ar10` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code># compute mother pidlink
bk_ar1 = left_join(bk_ar1, bk_ar1 %&gt;% select(hhid14_9, pid14, pidlink) %&gt;% rename(ar11 = pid14, mother_pidlink = pidlink), by = c(&quot;hhid14_9&quot;, &quot;ar11&quot;))</code></pre>
<pre><code>## Warning: Column `ar11` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code>bk_sc1 = read_dta(&quot;data/hh14_all_dta/bk_sc1.dta&quot;) # Location info
bk_sc1 &lt;- bk_sc1 %&gt;% mutate(province = str_trim(recode(bk_sc1$sc01_14_14,  `11` = &#39;N. Aceh Darussalam&#39;,
 `12` = &#39;North Sumatera  &#39;,
 `13` = &#39;West Sumatera&#39;,
 `14` = &#39;Riau  &#39;,
 `15` = &#39;Jambi &#39;,
 `16` = &#39;South Sumatera  &#39;,
 `17` = &#39;Bengkulu&#39;,
 `18` = &#39;Lampung &#39;,
 `19` = &#39;Bangka Belitung &#39;,
 `31` = &#39;Jakarta &#39;,
 `32` = &#39;West Java  &#39;,
 `33` = &#39;Central Java &#39;,
 `34` = &#39;DI Yogyakarta&#39;,
 `35` = &#39;East Java  &#39;,
 `36` = &#39;Banten&#39;,
 `51` = &#39;Bali  &#39;,
 `52` = &#39;West Nusa Tenggara&#39;,
 `53` = &#39;East Nusa Tenggara&#39;,
 `61` = &#39;West Kalimantan &#39;,
 `62` = &#39;Central Kalimantan&#39;,
 `63` = &#39;South Kalimantan&#39;,
 `64` = &#39;East Kalimantan &#39;,
 `71` = &#39;North Sulawesi  &#39;,
 `72` = &#39;Central Sulawesi&#39;,
 `73` = &#39;South Sulawesi  &#39;,
 `74` = &#39;Southeast Sulawesi&#39;,
 `81` = &#39;Maluku&#39;,
 `94` = &#39;Papua &#39;,
 `98` = NA_character_,
 `99` = NA_character_, .default = NA_character_)))

### Informations from IFLS wave 5 to link data to earlier waves:
ptrack = read_dta(&quot;data/hh14_all_dta/ptrack.dta&quot;) # Tracking informations

### Pregnancy Informations from mother
## Wave 5 - 2014
w5_pregnancy = read_dta(&quot;data/hh14_all_dta/b4_ch1.dta&quot;) # Book 4, Section ch
## Wave 4 - 2007
w4_pregnancy = read_dta(&quot;data/hh07_all_dta/b4_ch1.dta&quot;) # Book 4, Section ch
## Wave 3 - 2000
w3_pregnancy = read_dta(&quot;data/hh00_all_dta/b4_ch1.dta&quot;) # Book 4, Section ch
## Wave 2 - 1997
w2_pregnancy = read_dta(&quot;data/hh97dta/b4_ch1.dta&quot;) # Book 4, Section ch
## Wave 1 - 1993
w1_pregnancy = read_dta(&quot;data/hh93dta/buk4ch1.dta&quot;) # Book 4, Section ch

### Marriage information from mother
## Wave 5 - 2014
w5_marriage= read_dta(&quot;data/hh14_all_dta/b4_kw3.dta&quot;) # Book 4, Section kw3
## Wave 4 - 2007
w4_marriage = read_dta(&quot;data/hh07_all_dta/b4_kw2.dta&quot;) # Book 4, Section kw2
## Wave 3 - 2000
w3_marriage = read_dta(&quot;data/hh00_all_dta/b4_kw3.dta&quot;) # Book 4, Section kw3
## Wave 2 - 1997
w2_marriage = read_dta(&quot;data/hh97dta/b4_kw2.dta&quot;) # Book 4, Section kw2
## Wave 1 - 1993
w1_marriage = read_dta(&quot;data/hh93dta/buk4kw2.dta&quot;) # Book 4, Section kw2

## Additional marriage information from mother
# Wave 5 - 2014
w5_marriage_additional = read_dta(&quot;data/hh14_all_dta/b4_cov.dta&quot;) # Book 4, Section cov
# Wave 4 - 2007
w4_marriage_additional = read_dta(&quot;data/hh07_all_dta/b4_cov.dta&quot;) # Book 4, Section cov
# Wave 3 - 2000
w3_marriage_additional = read_dta(&quot;data/hh00_all_dta/b4_cov.dta&quot;) # Book 4, Section cov
# Wave 2 - 1997
w2_marriage_additional = read_dta(&quot;data/hh97dta/b4_cov.dta&quot;) # Book 4, Section cov
# Wave 1 - 1993
w1_marriage_additional = read_dta(&quot;data/hh93dta/bukkar2.dta&quot;) # Book K, Section ar, household roaster

### IQ Information
ek_ek2 = read_dta(&quot;data/hh14_all_dta/ek_ek2.dta&quot;) # Book ek2: &gt;15 years
ek_ek1 = read_dta(&quot;data/hh14_all_dta/ek_ek1.dta&quot;) # Book ek1: &lt;15 years
# additional information (counting backwards, adaptive testing) for adults
b3b_cob = read_dta(&quot;data/hh14_all_dta/b3b_cob.dta&quot;) # Book 3b, Section cob
b3b_co1 = read_dta(&quot;data/hh14_all_dta/b3b_co1.dta&quot;) # Book 3b, Section co1
# additional information from earlier waves
bek_ek1 = read_dta(&quot;data/hh07_all_dta/bek_ek1.dta&quot;) # Intelligence information from wave 4 (2007): 7-14
bek_ek2 = read_dta(&quot;data/hh07_all_dta/bek_ek2.dta&quot;) # Intelligence info from wave 4 (2007): 15 - 24
bek00 = read_dta(&quot;data/hh00_all_dta/bek.dta&quot;) # Intelligence information from wave 3 (2000)
bek97 = read_dta(&quot;data/hh97dta/bek.dta&quot;) #Intelligence information from wave 2 (1997)


### Personality Information (only for adults)
b3b_psn = read_dta(&quot;data/hh14_all_dta/b3b_psn.dta&quot;) # Book 3b, Section psn

### Risk taking
b3a_si = read_dta(&quot;data/hh14_all_dta/b3a_si.dta&quot;) # Book 3a, Section si

### Educational Attainment
b3a_dl1 = read_dta(&quot;data/hh14_all_dta/b3a_dl1.dta&quot;) # Book 3a, Section dl1

### EBTANAS/UAN/UN Score
b3a_dl3 = read_dta(&quot;data/hh14_all_dta/b3a_dl3.dta&quot;) # Book 3a, Section dl3
b3a_dl4 = read_dta(&quot;data/hh14_all_dta/b3a_dl4.dta&quot;) # Book 3a, Section dl4

### Job Information
b3a_tk2 = read_dta(&quot;data/hh14_all_dta/b3a_tk2.dta&quot;) # Book 3a, Section tk2

### Smoking behavior
b3b_km = read_dta(&quot;data/hh14_all_dta/b3b_km.dta&quot;) # Book 3b, Section km</code></pre>
</div>
<div id="birth-order-information" class="section level2 tabset">
<h2>Birth order information</h2>
<div id="information-about-pregnancy" class="section level3">
<h3>Information about pregnancy</h3>
<pre class="r"><code>## Select data
w5_pregnancy = w5_pregnancy %&gt;% select(pidlink, ch05, ch06, ch06a, ch08, ch09day, ch09mth, ch09yr, ch25)
w4_pregnancy = w4_pregnancy %&gt;% select(pidlink, ch05, ch06, ch06a, ch08, ch09day, ch09mth, ch09yr, ch25)
w3_pregnancy = w3_pregnancy %&gt;% select(pidlink, ch05, ch06, ch06a, ch08, ch09day, ch09mth, ch09yr, ch25)
w2_pregnancy = w2_pregnancy %&gt;% select(pidlink, ch05, ch06, ch06a, ch08, ch09day, ch09mth, ch09yr, ch25)
w1_pregnancy = w1_pregnancy %&gt;% 
  group_by(pidlink, ch04) %&gt;% mutate(ch06a = if_else(!is.na(pidlink) &amp; !is.na(ch04), if_else( n() &gt; 1, 1, 3), 9)) %&gt;%
  ungroup() %&gt;% 
  select(pidlink, ch05, ch06, ch06a, ch08, ch09day, ch09mth, ch09yr, ch25) %&gt;% 
# In the first wave the year is named wrong
  mutate(ch09yr = ifelse(ch09yr &lt;= 93, ch09yr, NA),
          ch09yr = as.numeric(str_c(&quot;19&quot;, ch09yr)))

## Combine data
pregnancy = bind_rows(w1 = w1_pregnancy, w2 = w2_pregnancy, w3 = w3_pregnancy, w4 = w4_pregnancy, w5 = w5_pregnancy, .id = &quot;wave&quot;)</code></pre>
<pre><code>## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes</code></pre>
<pre class="r"><code>pregnancy = codebook::rescue_attributes(pregnancy, w5_pregnancy)

## Rename Variables
pregnancy = pregnancy %&gt;% rename(chron_order_birth = ch05, lifebirths = ch06, multiple_birth = ch06a, gender = ch08,
                                 birth_day = ch09day, birth_month = ch09mth, birth_year = ch09yr, 
                                 mother_pidlink = pidlink, alive = ch25) # pregnancy$lifebirths values: 1 = still pregnant, 2 = livebirth, 3 = still birth, 4 = misscarriage

## Set values as NA that are missing
pregnancy = pregnancy %&gt;%
  mutate(birth_day = ifelse(birth_day&gt;31, NA, birth_day),
         birth_month = ifelse(birth_month&gt;12, NA, birth_month),
         birth_year = ifelse(birth_year&gt;2016, NA, birth_year),
         birth_day = ifelse(is.nan(birth_day), NA, birth_day),
         birth_month = ifelse(is.nan(birth_month), NA, birth_month),
         birth_year = ifelse(is.nan(birth_year), NA, birth_year),
         multiple_birth = ifelse(multiple_birth == 9, NA, multiple_birth),
         multiple_birth = ifelse(is.nan(multiple_birth), NA, multiple_birth))

pregnancy$month = paste0(pregnancy$birth_year,&quot;-&quot;, ifelse(is.na(pregnancy$birth_month), &quot;01&quot;,
                                                          pad_month(pregnancy$birth_month)))

pregnancy = pregnancy %&gt;% 
  mutate(birthdate = all_available_info_birth_date(birth_year, birth_month, birth_day),
         mother_birthdate = str_c(mother_pidlink, &quot;-&quot;, birthdate),
         mother_birthorder = paste0(mother_pidlink , &quot;-&quot;, chron_order_birth))

pregnancy = pregnancy %&gt;% 
  mutate(wave = str_sub(wave, 2, 3) %&gt;% as.numeric()) %&gt;% # from most recent wave to oldest
  arrange(desc(wave)) %&gt;% # use most recent wave (because these will have pregnancy outcomes)
  group_by(mother_birthdate) %&gt;% 
  mutate(birthdate_duped_in_earlier_wave = min_rank(wave)) %&gt;% 
  group_by(mother_birthorder) %&gt;% 
  mutate(birthorder_duped_in_earlier_wave = min_rank(wave))
# these are pregnancy that changes status (i.e. ongoing in wave 2, miscarried/born by wave 3)
crosstabs(~ birthdate_duped_in_earlier_wave + birthorder_duped_in_earlier_wave + is.na(birthdate), pregnancy)</code></pre>
<table>
<colgroup>
<col width="32%" />
<col width="33%" />
<col width="18%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td align="center">is.na(birthdate)</td>
<td align="center">FALSE</td>
<td align="center">TRUE</td>
</tr>
<tr class="even">
<td>birthdate_duped_in_earlier_wave</td>
<td>birthorder_duped_in_earlier_wave</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td align="center"></td>
<td align="center">36830</td>
<td align="center">1339</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">9330</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">2189</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">444</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">55</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td align="center"></td>
<td align="center">182</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">2371</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">807</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">218</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">42</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td align="center"></td>
<td align="center">3</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">80</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">191</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">58</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">16</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>4</td>
<td>1</td>
<td align="center"></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">31</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">5</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>6</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>7</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>1340</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">313</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">151</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>1804</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">442</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">160</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">57</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>2463</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">590</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">56</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">23</td>
</tr>
<tr class="odd">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>3141</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">727</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">171</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">65</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">42</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<pre class="r"><code># unfortunately, sometimes chron_order_birth is inconsistent with birthdates
# to eliminate duplicates from the pregnancy file (because pregnancies changed statuses)
# now, for those where we don&#39;t know the birthdate, we keep only unique birth orders
# for those, where we know the birthdate, we keep only unique birthdates (as this is higher q information)
pregnancy = pregnancy %&gt;% 
  filter((is.na(birthdate) &amp;&amp; birthorder_duped_in_earlier_wave == 1) | birthdate_duped_in_earlier_wave == 1) %&gt;% 
  ungroup() # eliminate dupes across waves (same mother_birthdate), keep mult births
crosstabs(~ birthdate_duped_in_earlier_wave + birthorder_duped_in_earlier_wave + is.na(birthdate), pregnancy)</code></pre>
<table>
<colgroup>
<col width="32%" />
<col width="33%" />
<col width="18%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td align="center">is.na(birthdate)</td>
<td align="center">FALSE</td>
<td align="center">TRUE</td>
</tr>
<tr class="even">
<td>birthdate_duped_in_earlier_wave</td>
<td>birthorder_duped_in_earlier_wave</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td align="center"></td>
<td align="center">36830</td>
<td align="center">1339</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">9330</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">2189</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">444</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">55</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>1340</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">170</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>1804</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">167</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td>2463</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">252</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>3141</td>
<td>1</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">727</td>
</tr>
<tr class="even">
<td></td>
<td>2</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>4</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>5</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>x = (unique(pregnancy$mother_pidlink))

##remove all with missing birthdate/miscarriage date
table(is.na(pregnancy$birthdate))</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">48848</td>
<td align="center">2655</td>
</tr>
</tbody>
</table>
<pre class="r"><code># for whatever reason there are some multiple births with just one row in the data, but number are low enough
# that we consider some errors in the records the likely reason
pregnancy %&gt;% filter(!is.na(birthdate)) %&gt;% group_by(mother_birthdate)  %&gt;% 
  mutate(mult = n()) %&gt;% crosstabs(~ mult + multiple_birth + is.na(birth_month), data = .)</code></pre>
<table style="width:85%;">
<colgroup>
<col width="9%" />
<col width="23%" />
<col width="29%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td align="center">is.na(birth_month)</td>
<td align="center">FALSE</td>
<td align="center">TRUE</td>
</tr>
<tr class="even">
<td>mult</td>
<td>multiple_birth</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td align="center"></td>
<td align="center">682</td>
<td align="center">34</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">37015</td>
<td align="center">5670</td>
</tr>
<tr class="odd">
<td></td>
<td>NA</td>
<td align="center"></td>
<td align="center">2613</td>
<td align="center">1974</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td align="center"></td>
<td align="center">493</td>
<td align="center">93</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">28</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td></td>
<td>NA</td>
<td align="center"></td>
<td align="center">13</td>
<td align="center">99</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td align="center"></td>
<td align="center">8</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">1</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td></td>
<td>NA</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">17</td>
</tr>
<tr class="even">
<td>4</td>
<td>1</td>
<td align="center"></td>
<td align="center">4</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td></td>
<td>3</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>NA</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>## Form variable for any multiple birth in family
pregnancy = pregnancy %&gt;% group_by(mother_pidlink) %&gt;% mutate(any_multiple_birth = if_else(any(multiple_birth == 1, na.rm = T), 1, 0))
prop.table(crosstabs(pregnancy$multiple_birth))</code></pre>
<table style="width:39%;">
<colgroup>
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">1</th>
<th align="center">3</th>
<th align="center">NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.02604</td>
<td align="center">0.8549</td>
<td align="center">0.119</td>
</tr>
</tbody>
</table>
<pre class="r"><code>prop.table(crosstabs(pregnancy$any_multiple_birth))</code></pre>
<table style="width:25%;">
<colgroup>
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.9248</td>
<td align="center">0.07524</td>
</tr>
</tbody>
</table>
</div>
<div id="information-about-marriage-history" class="section level3">
<h3>Information about marriage history</h3>
<pre class="r"><code>## Select marriage data
w5_marriage = w5_marriage %&gt;% select(pidlink, kw10mth, kw10yr, kw18mth, kw18yr, kw11, kw19)
w4_marriage = w4_marriage %&gt;% select(pidlink, kw10mth, kw10yr, kw18mth, kw18yr, kw11, kw19)
w3_marriage = w3_marriage %&gt;% select(pidlink, kw10mth, kw10yr, kw18mth, kw18yr, kw11, kw19)
w2_marriage = w2_marriage %&gt;% select(pidlink, kw10mth, kw10yr, kw18mth, kw18yr, kw11, kw19)
w1_marriage = w1_marriage %&gt;% select(pidlink, kw05a, kw05b, kw13a, kw13b, kw06, kw14age)
# In the first wave the year is named wrong
w1_marriage = w1_marriage %&gt;%
  mutate(kw05a = ifelse(kw05a &lt;= 93, as.numeric(str_c(&quot;19&quot;, w1_marriage$kw05a)), kw05a),
         kw13a = ifelse(kw13a &lt;=93 , as.numeric(str_c(&quot;19&quot;, w1_marriage$kw13a)), kw13a))
# And the column names are wrong...
w1_marriage = w1_marriage %&gt;% rename(kw10mth = kw05b, kw10yr = kw05a, kw18mth = kw13b, kw18yr = kw13a, kw11 = kw06, kw19 = kw14age)

## Select additional marriage information (age of respondent)
w5_marriage_additional = w5_marriage_additional %&gt;% select(pidlink, age, dob_yr)
w4_marriage_additional = w4_marriage_additional %&gt;% select(pidlink, age, dob_yr)
w3_marriage_additional = w3_marriage_additional %&gt;% select(pidlink, age, dob_yr)
w2_marriage_additional = w2_marriage_additional %&gt;% select(pidlink, age, dob_yr)
w1_marriage_additional = w1_marriage_additional %&gt;% select(pidlink, ar09yr, ar08yr)
# In the first wave the year is named wrong
w1_marriage_additional = w1_marriage_additional %&gt;%
  mutate(ar08yr = ifelse(ar08yr &lt;= 93, 
                         as.numeric(str_c(&quot;19&quot;, w1_marriage_additional$ar08yr)),
                         ar08yr))
# And the column names are wrong...
w1_marriage_additional = w1_marriage_additional %&gt;% rename(age = ar09yr, dob_yr = ar08yr)

## Combine marriage information and additional marriage information:
w1_marriage = left_join(w1_marriage, w1_marriage_additional, by = &quot;pidlink&quot;) %&gt;%
  mutate(wave = as.numeric(&quot;1993&quot;))
w2_marriage = left_join(w2_marriage, w2_marriage_additional, by = &quot;pidlink&quot;) %&gt;%
  mutate(wave = as.numeric(&quot;1997&quot;))
w3_marriage = left_join(w3_marriage, w3_marriage_additional, by = &quot;pidlink&quot;)  %&gt;%
  mutate(wave = as.numeric(&quot;2000&quot;))
w4_marriage = left_join(w4_marriage, w4_marriage_additional, by = &quot;pidlink&quot;) %&gt;%
  mutate(wave = as.numeric(&quot;2007&quot;))
w5_marriage = left_join(w5_marriage, w5_marriage_additional, by = &quot;pidlink&quot;) %&gt;%
  mutate(wave = as.numeric(&quot;2014&quot;))

## Combine marriage informations
marriage = bind_rows(w1_marriage, w2_marriage, w3_marriage, w4_marriage, w5_marriage)</code></pre>
<pre><code>## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes

## Warning in bind_rows_(x, .id): Vectorizing &#39;labelled&#39; elements may not preserve their attributes</code></pre>
<pre class="r"><code># Rename columns
marriage = marriage %&gt;% rename(start_year = kw10yr, start_month = kw10mth, end_year = kw18yr, end_month = kw18mth, start_age = kw11, end_age = kw19, birth_year = dob_yr, birth_age = age)


# Set values as NA that are missing
marriage$start_year[ marriage$start_year&lt;1900] = NA
marriage$start_year[ marriage$start_year&gt;2016] = NA
marriage$start_year[ is.nan(marriage$start_year)] = NA
marriage$end_year[ marriage$end_year&lt;1900] = NA
marriage$end_year[ marriage$end_year&gt;2016] = NA
marriage$end_year[ is.nan(marriage$end_year)] = NA
marriage$start_month [marriage$start_month&gt;12] = NA
marriage$start_month [is.nan(marriage$start_month)] = NA
marriage$end_month [marriage$end_month&gt;12] = NA
marriage$end_month [is.nan(marriage$end_month)] = NA
marriage$start_age [marriage$start_age &gt; 97] = NA
marriage$start_age [is.nan(marriage$start_age)] = NA
marriage$end_age [marriage$end_age &gt; 97] = NA
marriage$end_age [is.nan(marriage$end_age)] = NA
marriage$birth_year[ marriage$birth_year&lt;1900] = NA
marriage$birth_year[ marriage$birth_year&gt;2016] = NA
marriage$birth_year[ is.nan(marriage$birth_year)] = NA
marriage$birth_age [marriage$birth_age &gt; 97] = NA
marriage$birth_age [is.nan(marriage$birth_age)] = NA

## Reconstruct marriage start year and end year for marriages with missing year
marriage = marriage %&gt;%
  mutate(birth_year = ifelse(is.na(birth_year), wave - birth_age, birth_year),
         start_year = ifelse(is.na(start_year), birth_year + start_age, start_year),
         end_year = ifelse(is.na(end_year), birth_year + end_age, end_year))


marriage = marriage %&gt;% arrange(pidlink, start_year, start_month, start_age, end_year, end_month, end_age)

marriage = marriage %&gt;% filter(!duplicated(cbind(pidlink, start_year, start_month)) | is.na(start_year) | is.na(start_month)) # nobody gets married twice on the same day, right? so these are dupes.

## Calculate date for beginning of marriage:
marriage = marriage %&gt;% 
  ungroup() %&gt;%
  mutate(start_string = str_c(start_year, &quot;-&quot;, ifelse(is.na(start_month), &quot;01&quot;,
                                                      pad_month(start_month)), &quot;-01&quot;),
        end_string = str_c(end_year, &quot;-&quot;, ifelse(is.na(end_month), &quot;12&quot;, pad_month(end_month)), &quot;-01&quot;),
        start = ymd(start_string),
        end = ymd(end_string) + months(1) - days(1))

## Count number of marriages
marriage = marriage %&gt;%
  arrange(pidlink, start, end) %&gt;%
  group_by(pidlink) %&gt;%
  mutate(number_marriages = n(),
         order_marriage = row_number(),
         marriage_id = paste0(pidlink, &quot;_&quot;, as.character(order_marriage), &quot;_&quot;,
                              as.character(start), &quot;/&quot;,as.character(end)))

### Marriage Timeline
minimum_start = min(ymd(str_c(pregnancy$month, &quot;-01&quot;)), na.rm = T)</code></pre>
<pre><code>## Warning: 2655 failed to parse.</code></pre>
<pre class="r"><code>maximum_end = max(ymd(str_c(pregnancy$month, &quot;-01&quot;)), na.rm = T)</code></pre>
<pre><code>## Warning: 2655 failed to parse.</code></pre>
<pre class="r"><code>marriage_timeline = marriage %&gt;%
    mutate(implied_start = as.Date(ifelse(is.na(start), minimum_start , start),
                                   origin=&quot;1970-01-01&quot;),
           implied_end = as.Date(ifelse(is.na(end), maximum_end , end),
                                 origin=&quot;1970-01-01&quot;)) %&gt;%
  filter(implied_start &lt; implied_end)

marriage_timeline = marriage_timeline %&gt;%
    rowwise() %&gt;%
    do(data.frame(
        marriage_id=.$marriage_id, 
        mother_pidlink = .$pidlink,
        order_marriage = .$order_marriage,
        start = .$start,
        end = .$end,
        month = seq(.$implied_start,.$implied_end, by=&quot;1 month&quot;) ))

# no duplicate mother_id - month combinations (no two marriages at the same time)
marriage_timeline = marriage_timeline %&gt;% 
  arrange(mother_pidlink, start, end) %&gt;% 
  distinct(mother_pidlink, month, .keep_all = TRUE)

marriage_timeline$month = stringr::str_sub(as.character(marriage_timeline$month),1,7)

# we assume that fathers are those to whom mothers were married in the birth month
pregnancy = pregnancy %&gt;% left_join(marriage_timeline, by = c(&quot;mother_pidlink&quot;, &quot;month&quot;)) %&gt;% ungroup()</code></pre>
<pre><code>## Warning: Column `mother_pidlink` has different attributes on LHS and RHS of join</code></pre>
</div>
<div id="birth-order-calculations" class="section level3 tabset">
<h3>Birth order calculations</h3>
<pre class="r"><code>#### Maternal Pregnancy Order
pregnancy1 = pregnancy %&gt;%
  group_by(mother_pidlink) %&gt;%
  mutate(birthorder_uterus_preg = min_rank(birthdate),
         birthorder_uterus_preg2 = ifelse(is.na(birthorder_uterus_preg), chron_order_birth, 
                                          ifelse(chron_order_birth &gt; birthorder_uterus_preg, 
                                                  chron_order_birth, birthorder_uterus_preg)),
         # birthorder_uterus_preg = ifelse(any_multiple_birth == 1, NA, birthorder_uterus_preg),
         sibling_count_uterus_preg = sum(!is.na(birthdate)),
         sibling_count_uterus_preg2 = ifelse(is.na(sibling_count_uterus_preg), max(chron_order_birth, na.rm = T),
                                             ifelse(max(chron_order_birth, na.rm = T) &gt; sibling_count_uterus_preg,
                                                     max(chron_order_birth, na.rm = T), sibling_count_uterus_preg))
         # sibling_count_uterus_preg = ifelse(any_multiple_birth == 1, NA, sibling_count_uterus_preg)
         ) %&gt;%
  ungroup()</code></pre>
<pre><code>## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf

## Warning in max(chron_order_birth, na.rm = T): no non-missing arguments to max; returning -Inf</code></pre>
<pre class="r"><code>cor.test(pregnancy1$birthorder_uterus_preg, pregnancy1$birthorder_uterus_preg2)</code></pre>
<table style="width:94%;">
<caption>Pearsons product-moment correlation: <code>pregnancy1$birthorder_uterus_preg</code> and <code>pregnancy1$birthorder_uterus_preg2</code></caption>
<colgroup>
<col width="23%" />
<col width="11%" />
<col width="13%" />
<col width="34%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1876</td>
<td align="center">48846</td>
<td align="center">0 * * *</td>
<td align="center">two.sided</td>
<td align="center">0.9931</td>
</tr>
</tbody>
</table>
<pre class="r"><code>cor.test(pregnancy1$sibling_count_uterus_preg, pregnancy1$sibling_count_uterus_preg)</code></pre>
<table style="width:90%;">
<caption>Pearsons product-moment correlation: <code>pregnancy1$sibling_count_uterus_preg</code> and <code>pregnancy1$sibling_count_uterus_preg</code></caption>
<colgroup>
<col width="23%" />
<col width="11%" />
<col width="13%" />
<col width="34%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Inf</td>
<td align="center">51501</td>
<td align="center">0 * * *</td>
<td align="center">two.sided</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>crosstabs(~ is.na(birthorder_uterus_preg) + is.na(birthorder_uterus_preg2) + is.na(birthdate), pregnancy1)</code></pre>
<table>
<colgroup>
<col width="32%" />
<col width="33%" />
<col width="19%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td align="center">is.na(birthdate)</td>
<td align="center">FALSE</td>
<td align="center">TRUE</td>
</tr>
<tr class="even">
<td>is.na(birthorder_uterus_preg)</td>
<td>is.na(birthorder_uterus_preg2)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>FALSE</td>
<td>FALSE</td>
<td align="center"></td>
<td align="center">48848</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td></td>
<td>TRUE</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td>TRUE</td>
<td>FALSE</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">2426</td>
</tr>
<tr class="even">
<td></td>
<td>TRUE</td>
<td align="center"></td>
<td align="center">0</td>
<td align="center">229</td>
</tr>
</tbody>
</table>
<pre class="r"><code>crosstabs(~ is.na(sibling_count_uterus_preg) + is.na(sibling_count_uterus_preg2) + is.na(birthdate), pregnancy1)</code></pre>
<table style="width:100%;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="17%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td align="center">is.na(birthdate)</td>
<td align="center">FALSE</td>
<td align="center">TRUE</td>
</tr>
<tr class="even">
<td>is.na(sibling_count_uterus_preg)</td>
<td>is.na(sibling_count_uterus_preg2)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>FALSE</td>
<td>FALSE</td>
<td align="center"></td>
<td align="center">48848</td>
<td align="center">2655</td>
</tr>
</tbody>
</table>
<pre class="r"><code># our birthdate based birthorder estimates are extremely consistent with chron_order_birth

#### Maternal Birth Order
pregnancy2 = pregnancy %&gt;%
  filter(lifebirths == 2) %&gt;%
  group_by(mother_pidlink) %&gt;%
    mutate(birthorder_uterus_alive = min_rank(birthdate),
           # birthorder_uterus_alive = ifelse(any_multiple_birth == 1, NA, birthorder_uterus_alive),
           sibling_count_uterus_alive = sum(!is.na(birthdate))
           # ,sibling_count_uterus_alive = ifelse(any_multiple_birth == 1, NA, sibling_count_uterus_alive)
           ) %&gt;%
  ungroup()

pregnancy2 = pregnancy2 %&gt;% select(mother_birthdate, birthorder_uterus_alive, sibling_count_uterus_alive) %&gt;% distinct()

#### Parental Full Sibling Birthorder
pregnancy3 = pregnancy %&gt;%
  filter(lifebirths == 2) %&gt;%
  group_by(marriage_id) %&gt;%
    mutate(birthorder_genes = min_rank(birthdate),
           birthorder_genes = ifelse(is.na(marriage_id), NA, birthorder_genes),
           sibling_count_genes = ifelse(is.na(marriage_id), NA, sum(!is.na(marriage_id)))) %&gt;%
  ungroup()

pregnancy3 = pregnancy3 %&gt;% select(mother_birthdate, birthorder_genes, sibling_count_genes) %&gt;% distinct()


# remove dupes because of missings and twins
pregnancy1 &lt;- pregnancy1 %&gt;% select(-birthorder_uterus_preg2, -sibling_count_uterus_preg2) %&gt;% 
  filter(!is.na(birthdate)) %&gt;% 
  distinct(mother_birthdate, .keep_all = TRUE)

pregnancy2 &lt;- pregnancy2 %&gt;%
  distinct(mother_birthdate, .keep_all = TRUE)

### Combine birthorder data
table(duplicated(pregnancy1$mother_birthdate))</code></pre>
<table style="width:10%;">
<colgroup>
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">48412</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(duplicated(pregnancy2$mother_birthdate))</code></pre>
<table style="width:10%;">
<colgroup>
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">43189</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(duplicated(pregnancy3$mother_birthdate))</code></pre>
<table style="width:10%;">
<colgroup>
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">43189</td>
</tr>
</tbody>
</table>
<pre class="r"><code>pregnancy = left_join(pregnancy1, pregnancy2, by=&quot;mother_birthdate&quot;) %&gt;% ungroup()
pregnancy = left_join(pregnancy, pregnancy3, by = &quot;mother_birthdate&quot;) %&gt;% ungroup()</code></pre>
</div>
<div id="birth-order-graphs" class="section level3">
<h3>Birth order graphs</h3>
<pre class="r"><code>### Graphs
## Biological Birthorder - Uterus_Pregnancies
ggplot(pregnancy, aes(x=sibling_count_uterus_preg, y=birthorder_uterus_preg)) + geom_jitter(alpha = 0.1)</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>## Biological Birthorder - Uterus_Births
ggplot(pregnancy, aes(x=sibling_count_uterus_alive, y=birthorder_uterus_alive)) + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 5224 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>## Biological Birthorder - Full Sibling Order
ggplot(pregnancy, aes(x=sibling_count_genes, y=birthorder_genes)) + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 5864 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<pre class="r"><code>## Bio: Uterus_preg vs. Uterus_Births
ggplot(pregnancy, aes(x=birthorder_uterus_preg, y=birthorder_uterus_alive)) + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 5224 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-2-4.png" width="672" /></p>
<pre class="r"><code># The birth_order_alive is always lower, which makes sense, becaus not live births (miscarriage, still births are excluded)

## Bio: Uterus_preg vs. Genes
ggplot(pregnancy, aes(x=birthorder_uterus_preg, y=birthorder_genes)) + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 5864 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-2-5.png" width="672" /></p>
<pre class="r"><code># The birthorder_genes is always lower, which makes sense, because different/unknown fathers are excluded

## Bio: Uterus_alive vs. Genes
ggplot(pregnancy, aes(x=birthorder_uterus_alive, y=birthorder_genes))  + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 5864 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-2-6.png" width="672" /></p>
<pre class="r"><code># children with the same father includes only live births

# chron order birth does not correlate perfectly, unsurprising given that we found chron orders sometimes started
# from 1 in new waves even though previous births were recorded
pregnancy %&gt;% select(chron_order_birth, birthorder_uterus_alive, birthorder_uterus_preg, birthorder_genes) %&gt;% na.omit() %&gt;% cor()</code></pre>
<table>
<colgroup>
<col width="22%" />
<col width="29%" />
<col width="28%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">chron_order_birth</th>
<th align="center">birthorder_uterus_alive</th>
<th align="center">birthorder_uterus_preg</th>
<th align="center">birthorder_genes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">0.7455</td>
<td align="center">0.7705</td>
<td align="center">0.7238</td>
</tr>
<tr class="even">
<td align="center">0.7455</td>
<td align="center">1</td>
<td align="center">0.9667</td>
<td align="center">0.9679</td>
</tr>
<tr class="odd">
<td align="center">0.7705</td>
<td align="center">0.9667</td>
<td align="center">1</td>
<td align="center">0.9359</td>
</tr>
<tr class="even">
<td align="center">0.7238</td>
<td align="center">0.9679</td>
<td align="center">0.9359</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>pregnancy %&gt;% select(chron_order_birth, birthorder_uterus_alive, birthorder_uterus_preg, birthorder_genes) %&gt;% missingness_patterns()</code></pre>
<pre><code>##  index                     col missings
##      1        birthorder_genes     5864
##      2 birthorder_uterus_alive     5224</code></pre>
<table style="width:50%;">
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Pattern</th>
<th align="center">Freq</th>
<th align="center">Culprit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">___</td>
<td align="center">42548</td>
<td align="center">_</td>
</tr>
<tr class="even">
<td align="center">1_2</td>
<td align="center">5224</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1__</td>
<td align="center">640</td>
<td align="center">birthorder_genes</td>
</tr>
</tbody>
</table>
<pre class="r"><code>pregnancy %&gt;% select(sibling_count_uterus_alive, sibling_count_uterus_preg, sibling_count_genes) %&gt;% missingness_patterns()</code></pre>
<pre><code>##  index                        col missings
##      1        sibling_count_genes     5864
##      2 sibling_count_uterus_alive     5224</code></pre>
<table style="width:54%;">
<colgroup>
<col width="13%" />
<col width="11%" />
<col width="29%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Pattern</th>
<th align="center">Freq</th>
<th align="center">Culprit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">___</td>
<td align="center">42548</td>
<td align="center">_</td>
</tr>
<tr class="even">
<td align="center">1_2</td>
<td align="center">5224</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1__</td>
<td align="center">640</td>
<td align="center">sibling_count_genes</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="select-individual-data-from-ifls-5" class="section level2">
<h2>Select individual data from IFLS 5</h2>
<pre class="r"><code>### Individuals
individuals = bk_ar1 %&gt;% select(hhid14_9, pidlink, father_pidlink, mother_pidlink, ar01a, ar02b, ar10, ar11, ar07, ar08day, ar08mth, ar08yr, ar09, ar18eyr, ar18emth)
individuals = left_join(individuals, bk_sc1 %&gt;% select(hhid14_9, sc05, province, sc01_14_14), by = c(&quot;hhid14_9&quot;))

#Rename variables to make it easier
individuals = rename(individuals, relation_to_HH_head = ar02b, fatherID = ar10, motherID = ar11, sex = ar07, age = ar09, status = ar01a, death_yr = ar18eyr, death_month = ar18emth) 
# Remove duplicats (some people are mentioned in two households, e.g. because they moved in the last 12 months)
individuals = individuals %&gt;% distinct(pidlink, .keep_all = TRUE)
individuals_unchanged = individuals

## people whose parents can not be identified have to be marked as NA:
individuals$fatherID[ individuals$fatherID&gt;50] = NA
individuals$motherID[ individuals$motherID&gt;50] = NA


## Create date of birth
#Set all variables missing that have not been reported:
individuals$ar08day[ individuals$ar08day&gt;31] = NA
individuals$ar08mth[ individuals$ar08mth&gt;12] = NA
individuals$ar08yr[ individuals$ar08yr&gt;2016] = NA
individuals$ar08day[ is.nan(individuals$ar08day) ] = NA
individuals$ar08mth[ is.nan(individuals$ar08mth) ] = NA
individuals$ar08yr[ is.nan(individuals$ar08yr)] = NA
individuals$death_month[ individuals$death_month&gt;12] = NA
individuals$death_yr[ individuals$death_yr&gt;2016] = NA
individuals$death_month[ is.nan(individuals$death_month) ] = NA
individuals$death_yr[ is.nan(individuals$death_yr)] = NA

## Create variable that contains pidlink of mother and birthdate of child:
individuals = individuals %&gt;%
    mutate(birthdate = all_available_info_birth_date(ar08yr, ar08mth, ar08day),
           mother_birthdate = str_c(mother_pidlink, &quot;-&quot;, birthdate)) # mother_pidlink-YYYY-MM; is NA if birth_year is missing

individuals = individuals %&gt;% group_by(mother_pidlink) %&gt;% 
  mutate(birthorder_naive_ind = if_else(!is.na(mother_pidlink), min_rank(birthdate), NA_integer_),
         sibling_count_naive_ind = if_else(!is.na(mother_pidlink), n(), NA_integer_)) %&gt;% 
  ungroup()

##Remove all with missing mother_birthdate
# individuals = individuals %&gt;%
#   filter(!is.na(mother_birthdate))

# 
# individuals = individuals %&gt;%
#   group_by(mother_birthdate) %&gt;%
#   mutate(twin_order = row_number(birthdate),
#          mother_birthdate_unique = paste0(mother_birthdate, &quot;-&quot;, twin_order)) %&gt;%
#   ungroup() %&gt;%
#   select(mother_birthdate_unique, pidlink, sex, age)
# 
# 
# pregnancy_missing = pregnancy %&gt;%
#   mutate(missing = ifelse(!(mother_birthdate_unique %in% individuals$mother_birthdate_unique),
#                           1, 0)) %&gt;%
#   filter(missing == 1)

# prevent that twins exist 4 times because they appear twice in pregnancy and twice in individuals, by eliminating dupes from pregnancy
# pregnancy_not_missing = pregnancy %&gt;%
#   mutate(missing = ifelse(!(mother_birthdate_unique %in% individuals$mother_birthdate_unique),
#                           1, 0)) %&gt;%
#   filter(missing == 0)          

alldata_pregnancy = full_join(pregnancy, individuals,
                              by = c(&quot;mother_pidlink&quot;, &quot;birthdate&quot;, &quot;mother_birthdate&quot;)) %&gt;% 
  distinct(mother_pidlink, birthdate, pidlink, .keep_all = TRUE)

alldata_pregnancy = alldata_pregnancy %&gt;% 
  group_by(mother_pidlink) %&gt;%
  mutate(any_multiple_birthdate = if_else(any(ifelse(!is.na(birth_month), duplicated(birthdate), NA), na.rm =T), 1, 0))

crosstabs(~alldata_pregnancy$any_multiple_birthdate + alldata_pregnancy$any_multiple_birth)</code></pre>
<table style="width:31%;">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
<th align="center">NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">45034</td>
<td align="center">2918</td>
<td align="center">52631</td>
</tr>
<tr class="even">
<td align="center">34</td>
<td align="center">560</td>
<td align="center">64</td>
</tr>
</tbody>
</table>
<pre class="r"><code>alldata_pregnancy = alldata_pregnancy %&gt;% mutate(any_multiple_birth = ifelse(any_multiple_birthdate == 1, 1,
                                                                             any_multiple_birth))
alldata_pregnancy = alldata_pregnancy %&gt;% group_by(mother_pidlink) %&gt;% 
  mutate(birthorder_naive = min_rank(if_else(!is.na(mother_pidlink), birthdate, NA_character_)),
         sibling_count_naive = if_else(!is.na(mother_pidlink), n(), NA_integer_)) %&gt;% 
  # filter(is.na(lifebirths) | lifebirths == 2) %&gt;% 
  # mutate(birthorder_naive3 = if_else(!is.na(mother_pidlink) &amp; (is.na(lifebirths) | lifebirths == 2), min_rank(birthdate), NA_integer_),
  #        sibling_count_naive3 = if_else(!is.na(mother_pidlink) &amp; (is.na(lifebirths) | lifebirths == 2), sum(is.na(lifebirths) | lifebirths == 2), NA_integer_)) %&gt;% 
  ungroup()

# alldata_pregnancy = bind_rows(alldata_pregnancy, pregnancy_missing)

prop.table(table(alldata_pregnancy$multiple_birth))</code></pre>
<table style="width:24%;">
<colgroup>
<col width="13%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">1</th>
<th align="center">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.02601</td>
<td align="center">0.974</td>
</tr>
</tbody>
</table>
<pre class="r"><code>prop.table(table(alldata_pregnancy$any_multiple_birth))</code></pre>
<table style="width:25%;">
<colgroup>
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.9264</td>
<td align="center">0.07357</td>
</tr>
</tbody>
</table>
<pre class="r"><code>alldata_pregnancy %&gt;% select(birthorder_naive,birthorder_naive_ind,chron_order_birth, birthorder_uterus_alive, birthorder_uterus_preg, birthorder_genes) %&gt;% cor(use=&#39;pairwise.complete.obs&#39;) %&gt;% round(2)</code></pre>
<table>
<colgroup>
<col width="14%" />
<col width="17%" />
<col width="15%" />
<col width="19%" />
<col width="19%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">birthorder_naive</th>
<th align="center">birthorder_naive_ind</th>
<th align="center">chron_order_birth</th>
<th align="center">birthorder_uterus_alive</th>
<th align="center">birthorder_uterus_preg</th>
<th align="center">birthorder_genes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">0.82</td>
<td align="center">0.74</td>
<td align="center">0.93</td>
<td align="center">0.95</td>
<td align="center">0.9</td>
</tr>
<tr class="even">
<td align="center">0.82</td>
<td align="center">1</td>
<td align="center">0.56</td>
<td align="center">0.84</td>
<td align="center">0.79</td>
<td align="center">0.83</td>
</tr>
<tr class="odd">
<td align="center">0.74</td>
<td align="center">0.56</td>
<td align="center">1</td>
<td align="center">0.75</td>
<td align="center">0.75</td>
<td align="center">0.72</td>
</tr>
<tr class="even">
<td align="center">0.93</td>
<td align="center">0.84</td>
<td align="center">0.75</td>
<td align="center">1</td>
<td align="center">0.97</td>
<td align="center">0.97</td>
</tr>
<tr class="odd">
<td align="center">0.95</td>
<td align="center">0.79</td>
<td align="center">0.75</td>
<td align="center">0.97</td>
<td align="center">1</td>
<td align="center">0.94</td>
</tr>
<tr class="even">
<td align="center">0.9</td>
<td align="center">0.83</td>
<td align="center">0.72</td>
<td align="center">0.97</td>
<td align="center">0.94</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>alldata_pregnancy %&gt;% select(birthorder_naive, chron_order_birth, birthorder_uterus_alive, birthorder_uterus_preg, birthorder_genes) %&gt;% codebook::md_pattern()</code></pre>
<table>
<colgroup>
<col width="16%" />
<col width="12%" />
<col width="12%" />
<col width="16%" />
<col width="16%" />
<col width="12%" />
<col width="7%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">description</th>
<th align="center">birthorder_naive</th>
<th align="center">chron_order_birth</th>
<th align="center">birthorder_uterus_preg</th>
<th align="center">birthorder_uterus_alive</th>
<th align="center">birthorder_genes</th>
<th align="center">var_miss</th>
<th align="center">n_miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Missings per variable</td>
<td align="center">34215</td>
<td align="center">52695</td>
<td align="center">52695</td>
<td align="center">57919</td>
<td align="center">58559</td>
<td align="center">256083</td>
<td align="center">256083</td>
</tr>
<tr class="even">
<td align="center">Missings in 0 variables</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">42682</td>
</tr>
<tr class="odd">
<td align="center">Missings in 5 variables</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">5</td>
<td align="center">34215</td>
</tr>
<tr class="even">
<td align="center">Missings in 4 variables</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">4</td>
<td align="center">18480</td>
</tr>
<tr class="odd">
<td align="center">Missings in 2 variables</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">5224</td>
</tr>
<tr class="even">
<td align="center">1 other, less frequent patterns</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">640</td>
</tr>
</tbody>
</table>
<pre class="r"><code>alldata_pregnancy %&gt;% select(sibling_count_naive, sibling_count_uterus_alive, sibling_count_uterus_preg, sibling_count_genes) %&gt;% cor(use=&#39;pairwise.complete.obs&#39;) %&gt;% round(2)</code></pre>
<table>
<colgroup>
<col width="22%" />
<col width="28%" />
<col width="28%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">sibling_count_naive</th>
<th align="center">sibling_count_uterus_alive</th>
<th align="center">sibling_count_uterus_preg</th>
<th align="center">sibling_count_genes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">0.92</td>
<td align="center">0.93</td>
<td align="center">0.9</td>
</tr>
<tr class="even">
<td align="center">0.92</td>
<td align="center">1</td>
<td align="center">0.96</td>
<td align="center">0.97</td>
</tr>
<tr class="odd">
<td align="center">0.93</td>
<td align="center">0.96</td>
<td align="center">1</td>
<td align="center">0.93</td>
</tr>
<tr class="even">
<td align="center">0.9</td>
<td align="center">0.97</td>
<td align="center">0.93</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>qplot(data=alldata_pregnancy,sibling_count_naive) + facet_wrap(~ is.na(sibling_count_uterus_preg))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 34178 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20individual%20data-1.png" width="672" /></p>
<pre class="r"><code>qplot(data=alldata_pregnancy,birthorder_naive) + facet_wrap(~ is.na(sibling_count_uterus_preg))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 34215 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20individual%20data-2.png" width="672" /></p>
<pre class="r"><code># prop.table(table(alldata_pregnancy$birthorder_uterus_alive == alldata_pregnancy$birthorder_naive3))
prop.table(table(alldata_pregnancy$birthorder_uterus_alive == alldata_pregnancy$birthorder_naive))</code></pre>
<table style="width:25%;">
<colgroup>
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.3937</td>
<td align="center">0.6063</td>
</tr>
</tbody>
</table>
<pre class="r"><code>prop.table(table(alldata_pregnancy$birthorder_uterus_preg == alldata_pregnancy$birthorder_naive))</code></pre>
<table style="width:25%;">
<colgroup>
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.3006</td>
<td align="center">0.6994</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ggplot(alldata_pregnancy, aes(x=birthorder_uterus_alive, y=birthorder_naive)) + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 57919 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20individual%20data-3.png" width="672" /></p>
<pre class="r"><code># it makes sense that the birth order based on including the pregnancy file is strictly higher, because
# this includes people who moved away
ggplot(alldata_pregnancy, aes(x=birthorder_naive_ind, y=birthorder_naive)) + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 59776 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20individual%20data-4.png" width="672" /></p>
<pre class="r"><code>ggplot(alldata_pregnancy, aes(x=sibling_count_naive_ind, y=sibling_count_naive)) + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 59739 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20individual%20data-5.png" width="672" /></p>
<pre class="r"><code># alldata_pregnancy %&gt;% filter(mother_pidlink == &quot;001060007&quot;) %&gt;% select(birthorder_naive,birthorder_naive_ind, birthorder_uterus_alive, sibling_count_naive, sibling_count_uterus_alive, mother_pidlink, birthdate, mother_birthdate) %&gt;% View()


cor.test(alldata_pregnancy$sibling_count_uterus_alive, alldata_pregnancy$sibling_count_naive)</code></pre>
<table style="width:94%;">
<caption>Pearsons product-moment correlation: <code>alldata_pregnancy$sibling_count_uterus_alive</code> and <code>alldata_pregnancy$sibling_count_naive</code></caption>
<colgroup>
<col width="23%" />
<col width="11%" />
<col width="13%" />
<col width="34%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">503.6</td>
<td align="center">43320</td>
<td align="center">0 * * *</td>
<td align="center">two.sided</td>
<td align="center">0.9242</td>
</tr>
</tbody>
</table>
<pre class="r"><code>crosstabs(alldata_pregnancy$sibling_count_uterus_alive == alldata_pregnancy$sibling_count_naive_ind)</code></pre>
<table style="width:33%;">
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
<th align="center">NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">6276</td>
<td align="center">16702</td>
<td align="center">78263</td>
</tr>
</tbody>
</table>
<pre class="r"><code>crosstabs(alldata_pregnancy$sibling_count_uterus_alive == alldata_pregnancy$sibling_count_naive)</code></pre>
<table style="width:33%;">
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
<th align="center">NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">26009</td>
<td align="center">17313</td>
<td align="center">57919</td>
</tr>
</tbody>
</table>
<pre class="r"><code>crosstabs(~ I(sibling_count_uterus_alive == sibling_count_naive_ind) + 
            I(sibling_count_uterus_alive == sibling_count_naive), alldata_pregnancy)</code></pre>
<table style="width:33%;">
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
<th align="center">NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4252</td>
<td align="center">2024</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">5428</td>
<td align="center">11274</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">16329</td>
<td align="center">4015</td>
<td align="center">57919</td>
</tr>
</tbody>
</table>
<pre class="r"><code>crosstabs(alldata_pregnancy$sibling_count_uterus_alive == alldata_pregnancy$sibling_count_naive)</code></pre>
<table style="width:33%;">
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
<th align="center">NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">26009</td>
<td align="center">17313</td>
<td align="center">57919</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ggplot(alldata_pregnancy, aes(x=sibling_count_uterus_alive, y=sibling_count_naive)) + geom_jitter(alpha = 0.1)</code></pre>
<pre><code>## Warning: Removed 57919 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20individual%20data-6.png" width="672" /></p>
<pre class="r"><code>crosstabs( ~ I(sibling_count_uterus_alive == sibling_count_naive) + is.na(birthdate), data = alldata_pregnancy)</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">26009</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">17313</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">51266</td>
<td align="center">6653</td>
</tr>
</tbody>
</table>
</div>
<div id="intelligence" class="section level2 tabset">
<h2>Intelligence</h2>
<pre class="r"><code>### IQ Informations from wave 5 (2014)
##ek2 (&gt;14yrs, includes only individuals, that are 15 years or older)
iq2.1 = ek_ek2 %&gt;% select(hhid14_9, pidlink, age, sex, ektype, resptype, result, reason, ek1_ans, ek2_ans, ek3_ans, ek4_ans, ek5_ans, ek6_ans, ek7_ans, ek8_ans, ek9_ans, ek10_ans, ek11_ans, ek12_ans, ek13_ans, ek14_ans, ek15_ans, ek16_ans, ek17_ans, ek18_ans, ek19_ans, ek20_ans, ek21_ans, ek22_ans)

##ek2 (&lt;14yrs, includes all individuals, that are younger than 15 years old)
iq3.1 = ek_ek1 %&gt;% select(hhid14_9, pidlink, age, sex, ektype, resptype, result, reason, ek1_ans, ek2_ans, ek3_ans, ek4_ans, ek5_ans, ek6_ans, ek7_ans, ek8_ans, ek9_ans, ek10_ans, ek11_ans, ek12_ans, ek13_ans, ek14_ans, ek15_ans, ek16_ans, ek17_ans, ek18_ans, ek19_ans, ek20_ans, ek21_ans, ek22_ans)

#### Raven Test (wave 2015, younger than 15 years)
answered_raven_items = iq3.1 %&gt;% select(ek1_ans:ek12_ans)
psych::alpha(data.frame(answered_raven_items))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(answered_raven_items))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd
##       0.87      0.87    0.88      0.36 6.9 0.0016 0.68 0.28
## 
##  lower alpha upper     95% confidence boundaries
## 0.87 0.87 0.87 
## 
##  Reliability if an item is dropped:
##          raw_alpha std.alpha G6(smc) average_r S/N alpha se
## ek1_ans       0.86      0.86    0.87      0.36 6.2   0.0017
## ek2_ans       0.86      0.86    0.87      0.36 6.1   0.0018
## ek3_ans       0.85      0.86    0.87      0.36 6.1   0.0018
## ek4_ans       0.86      0.86    0.87      0.36 6.2   0.0018
## ek5_ans       0.86      0.87    0.88      0.38 6.6   0.0016
## ek6_ans       0.87      0.88    0.88      0.39 7.1   0.0015
## ek7_ans       0.86      0.86    0.87      0.36 6.1   0.0017
## ek8_ans       0.85      0.86    0.86      0.35 6.0   0.0018
## ek9_ans       0.85      0.86    0.86      0.35 6.0   0.0018
## ek10_ans      0.86      0.86    0.87      0.36 6.2   0.0018
## ek11_ans      0.85      0.86    0.87      0.36 6.1   0.0018
## ek12_ans      0.87      0.88    0.89      0.40 7.3   0.0015
## 
##  Item statistics 
##              n raw.r std.r r.cor r.drop mean   sd
## ek1_ans  14943  0.66  0.68  0.64   0.60 0.87 0.33
## ek2_ans  14943  0.69  0.69  0.67   0.62 0.77 0.42
## ek3_ans  14943  0.71  0.70  0.67   0.63 0.70 0.46
## ek4_ans  14943  0.69  0.68  0.65   0.61 0.69 0.46
## ek5_ans  14943  0.59  0.57  0.51   0.48 0.61 0.49
## ek6_ans  14943  0.48  0.46  0.38   0.36 0.37 0.48
## ek7_ans  14943  0.68  0.69  0.67   0.60 0.78 0.42
## ek8_ans  14943  0.71  0.72  0.71   0.64 0.81 0.39
## ek9_ans  14943  0.73  0.74  0.73   0.67 0.79 0.41
## ek10_ans 14943  0.69  0.69  0.65   0.61 0.72 0.45
## ek11_ans 14943  0.70  0.71  0.68   0.63 0.77 0.42
## ek12_ans 14943  0.41  0.41  0.31   0.29 0.24 0.43
## 
## Non missing response frequency for each item
##             0    1 miss
## ek1_ans  0.13 0.87    0
## ek2_ans  0.23 0.77    0
## ek3_ans  0.30 0.70    0
## ek4_ans  0.31 0.69    0
## ek5_ans  0.39 0.61    0
## ek6_ans  0.63 0.37    0
## ek7_ans  0.22 0.78    0
## ek8_ans  0.19 0.81    0
## ek9_ans  0.21 0.79    0
## ek10_ans 0.28 0.72    0
## ek11_ans 0.23 0.77    0
## ek12_ans 0.76 0.24    0</code></pre>
<pre class="r"><code>iq3.1$raven_2015_young = rowMeans( answered_raven_items, na.rm = T)
qplot(iq3.1$raven_2015_young)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-1.png" width="672" /></p>
<pre class="r"><code>#### Math Test (wave 2015, younger than 15 years)
answered_math_items = iq3.1 %&gt;% select(ek13_ans:ek17_ans)
psych::alpha(data.frame(answered_math_items))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(answered_math_items))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd
##       0.62      0.62    0.59      0.24 1.6 0.0049 0.53 0.29
## 
##  lower alpha upper     95% confidence boundaries
## 0.61 0.62 0.63 
## 
##  Reliability if an item is dropped:
##          raw_alpha std.alpha G6(smc) average_r S/N alpha se
## ek13_ans      0.54      0.54    0.49      0.23 1.2   0.0061
## ek14_ans      0.51      0.51    0.46      0.21 1.1   0.0065
## ek15_ans      0.52      0.52    0.47      0.21 1.1   0.0064
## ek16_ans      0.61      0.61    0.56      0.28 1.6   0.0051
## ek17_ans      0.62      0.62    0.57      0.29 1.7   0.0050
## 
##  Item statistics 
##              n raw.r std.r r.cor r.drop mean   sd
## ek13_ans 14943  0.65  0.66  0.54   0.42 0.76 0.43
## ek14_ans 14943  0.70  0.70  0.61   0.47 0.66 0.47
## ek15_ans 14943  0.70  0.69  0.59   0.46 0.64 0.48
## ek16_ans 14943  0.57  0.56  0.36   0.28 0.34 0.47
## ek17_ans 14943  0.52  0.54  0.32   0.25 0.25 0.43
## 
## Non missing response frequency for each item
##             0    1 miss
## ek13_ans 0.24 0.76    0
## ek14_ans 0.34 0.66    0
## ek15_ans 0.36 0.64    0
## ek16_ans 0.66 0.34    0
## ek17_ans 0.75 0.25    0</code></pre>
<pre class="r"><code>iq3.1$math_2015_young = rowMeans( answered_math_items, na.rm = T)
qplot(iq3.1$math_2015_young)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-2.png" width="672" /></p>
<pre class="r"><code>iq3.1 = iq3.1 %&gt;% select(pidlink, age_2015_young = age, sex_2015_young = sex,
                         raven_2015_young, math_2015_young, reason_2015_young = reason)

##additional informations for adults: counting backwards
iq2.2 = b3b_co1 %&gt;% select(hhid14_9, pidlink, co04a, co04b, co04c, co04d, co04e, co07count, co10count)
##additional informations for adults: adaptive number test
iq2.3 = b3b_cob %&gt;% select(hhid14_9, pidlink, w_abil, cob18, cob19b)

## put all the informations for participants &gt;= 15 together
iq2 = full_join(iq2.1, iq2.2, by = &quot;pidlink&quot;)
iq2 = full_join(iq2, iq2.3, by = &quot;pidlink&quot;)
iq = iq2
iq &lt;- rename(iq, age_2015_old = age, reason_2015_old = reason, sex_2015_old = sex) 
iq = full_join(iq, iq3.1, by = &quot;pidlink&quot;)

### calculate iq scores
##Raven Test (wave 2015, older than 14 years)
answered_raven_items = iq %&gt;% select(ek1_ans:ek6_ans, ek11_ans, ek12_ans)
psych::alpha(data.frame(answered_raven_items))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(answered_raven_items))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd
##       0.85      0.85    0.84      0.41 5.5 0.0011 0.53 0.33
## 
##  lower alpha upper     95% confidence boundaries
## 0.85 0.85 0.85 
## 
##  Reliability if an item is dropped:
##          raw_alpha std.alpha G6(smc) average_r S/N alpha se
## ek1_ans       0.82      0.82    0.81      0.39 4.5   0.0013
## ek2_ans       0.81      0.81    0.80      0.38 4.3   0.0013
## ek3_ans       0.81      0.81    0.80      0.38 4.3   0.0013
## ek4_ans       0.82      0.81    0.81      0.38 4.4   0.0013
## ek5_ans       0.83      0.83    0.83      0.41 4.9   0.0012
## ek6_ans       0.85      0.85    0.84      0.44 5.6   0.0011
## ek11_ans      0.83      0.82    0.82      0.40 4.6   0.0012
## ek12_ans      0.86      0.86    0.85      0.46 5.9   0.0010
## 
##  Item statistics 
##              n raw.r std.r r.cor r.drop mean   sd
## ek1_ans  36380  0.74  0.74  0.71   0.65 0.74 0.44
## ek2_ans  36380  0.80  0.80  0.79   0.72 0.67 0.47
## ek3_ans  36380  0.79  0.79  0.77   0.71 0.58 0.49
## ek4_ans  36380  0.78  0.77  0.74   0.69 0.59 0.49
## ek5_ans  36380  0.68  0.68  0.60   0.56 0.50 0.50
## ek6_ans  36380  0.54  0.55  0.44   0.40 0.28 0.45
## ek11_ans 36380  0.73  0.72  0.67   0.62 0.61 0.49
## ek12_ans 36380  0.47  0.49  0.36   0.34 0.22 0.42
## 
## Non missing response frequency for each item
##             0    1 miss
## ek1_ans  0.26 0.74 0.18
## ek2_ans  0.33 0.67 0.18
## ek3_ans  0.42 0.58 0.18
## ek4_ans  0.41 0.59 0.18
## ek5_ans  0.50 0.50 0.18
## ek6_ans  0.72 0.28 0.18
## ek11_ans 0.39 0.61 0.18
## ek12_ans 0.78 0.22 0.18</code></pre>
<pre class="r"><code>iq$raven_2015_old = rowMeans( answered_raven_items, na.rm = T)
qplot(iq$raven_2015_old)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 8171 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-3.png" width="672" /></p>
<pre class="r"><code>##Math Test (wave 2015, older than 14 years)
answered_math_items = iq %&gt;% select(ek18_ans:ek22_ans)
psych::alpha(data.frame(answered_math_items))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(answered_math_items))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd
##       0.68      0.68    0.64       0.3 2.1 0.0023 0.26 0.29
## 
##  lower alpha upper     95% confidence boundaries
## 0.68 0.68 0.69 
## 
##  Reliability if an item is dropped:
##          raw_alpha std.alpha G6(smc) average_r S/N alpha se
## ek18_ans      0.68      0.67    0.61      0.34 2.1   0.0025
## ek19_ans      0.60      0.60    0.54      0.28 1.5   0.0030
## ek20_ans      0.60      0.60    0.53      0.27 1.5   0.0031
## ek21_ans      0.66      0.65    0.60      0.32 1.9   0.0027
## ek22_ans      0.63      0.62    0.56      0.29 1.7   0.0029
## 
##  Item statistics 
##              n raw.r std.r r.cor r.drop mean   sd
## ek18_ans 36380  0.59  0.59  0.41   0.34 0.25 0.43
## ek19_ans 36380  0.71  0.71  0.61   0.50 0.28 0.45
## ek20_ans 36380  0.73  0.72  0.63   0.51 0.34 0.47
## ek21_ans 36380  0.60  0.63  0.46   0.38 0.18 0.38
## ek22_ans 36380  0.68  0.68  0.55   0.46 0.28 0.45
## 
## Non missing response frequency for each item
##             0    1 miss
## ek18_ans 0.75 0.25 0.18
## ek19_ans 0.72 0.28 0.18
## ek20_ans 0.66 0.34 0.18
## ek21_ans 0.82 0.18 0.18
## ek22_ans 0.72 0.28 0.18</code></pre>
<pre class="r"><code>iq$math_2015_old = rowMeans( answered_math_items, na.rm = T)
qplot(iq$math_2015_old)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 8171 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-4.png" width="672" /></p>
<pre class="r"><code>##Counting Items
# Create Right/Wrong Scores for the counting items
iq$co04aright = as.numeric(iq$co04a == 93)
iq$co04bright = as.numeric(iq$co04b == iq$co04a-7)
iq$co04cright = as.numeric(iq$co04c == iq$co04b-7)
iq$co04dright = as.numeric(iq$co04d == iq$co04c-7)
iq$co04eright = as.numeric(iq$co04e == iq$co04d-7)

answered_counting_items = iq %&gt;% select(co04aright:co04eright)
psych::alpha(data.frame(answered_counting_items))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(answered_counting_items))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd
##       0.69      0.68    0.64      0.29 2.1 0.0021 0.73 0.29
## 
##  lower alpha upper     95% confidence boundaries
## 0.68 0.69 0.69 
## 
##  Reliability if an item is dropped:
##            raw_alpha std.alpha G6(smc) average_r S/N alpha se
## co04aright      0.71      0.71    0.65      0.38 2.4   0.0023
## co04bright      0.64      0.62    0.57      0.29 1.6   0.0025
## co04cright      0.60      0.59    0.54      0.27 1.5   0.0028
## co04dright      0.61      0.60    0.54      0.27 1.5   0.0027
## co04eright      0.60      0.59    0.54      0.27 1.5   0.0028
## 
##  Item statistics 
##                n raw.r std.r r.cor r.drop mean   sd
## co04aright 30452  0.43  0.51  0.27   0.23 0.95 0.22
## co04bright 29661  0.70  0.67  0.53   0.45 0.63 0.48
## co04cright 29260  0.73  0.71  0.61   0.52 0.69 0.46
## co04dright 29078  0.73  0.71  0.61   0.51 0.69 0.46
## co04eright 28983  0.73  0.71  0.61   0.52 0.70 0.46
## 
## Non missing response frequency for each item
##               0    1 miss
## co04aright 0.05 0.95 0.32
## co04bright 0.37 0.63 0.33
## co04cright 0.31 0.69 0.34
## co04dright 0.31 0.69 0.35
## co04eright 0.30 0.70 0.35</code></pre>
<pre class="r"><code>iq$count_backwards = rowMeans( answered_counting_items, na.rm = T)
qplot(iq$count_backwards)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 14099 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-5.png" width="672" /></p>
<pre class="r"><code>## Word Memory
iq$words_immediate = iq$co07count
iq$words_delayed = iq$co10count
qplot(iq$words_immediate, iq$words_delayed, geom = &quot;jitter&quot;)</code></pre>
<pre><code>## Warning: Removed 13080 rows containing missing values (geom_point).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-6.png" width="672" /></p>
<pre class="r"><code>answered_word_items = iq %&gt;% select(co07count,co10count)
psych::alpha(data.frame(answered_word_items))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(answered_word_items))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean  sd
##       0.87      0.87    0.77      0.77 6.8 0.0012  4.6 1.8
## 
##  lower alpha upper     95% confidence boundaries
## 0.87 0.87 0.87 
## 
##  Reliability if an item is dropped:
##           raw_alpha std.alpha G6(smc) average_r S/N alpha se
## co07count      0.77      0.77     0.6      0.77  NA       NA
## co10count      0.77      0.77     0.6      0.77  NA       NA
## 
##  Item statistics 
##               n raw.r std.r r.cor r.drop mean  sd
## co07count 31471  0.94  0.94  0.83   0.77  5.1 1.8
## co10count 31471  0.94  0.94  0.83   0.77  4.2 1.9</code></pre>
<pre class="r"><code>iq$words_remembered_avg = rowMeans( answered_word_items, na.rm = T)
qplot(iq$words_remembered_avg)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 13080 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-7.png" width="672" /></p>
<pre class="r"><code>##Adaptive Numbering
iq$adaptive_numbering = iq$w_abil
qplot(iq$adaptive_numbering)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 13142 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-8.png" width="672" /></p>
<pre class="r"><code># some people have reasons not to answer the test (dead, not contacted), that dont justify
# giving them zero points for that task. so i set these to NA
# additionally all participants older than 59 only answered the Raven Test, not the Math 
# Test
iq = iq %&gt;%
  mutate(reason_2015_young = ifelse(reason_2015_young == 1, &quot;refused&quot;,
                   ifelse(reason_2015_young == 2, &quot;cannot read&quot;,
                   ifelse(reason_2015_young == 3, &quot;unable to answer&quot;,
                   ifelse(reason_2015_young == 4, &quot;not enough time&quot;,
                   ifelse(reason_2015_young == 5, &quot;proxy respondent&quot;,
                   ifelse(reason_2015_young == 6, &quot;other&quot;,
                   ifelse(reason_2015_young == 7, &quot;could not be contacted&quot;, NA))))))),
         raven_2015_young = ifelse(is.na(reason_2015_young), raven_2015_young,
                             ifelse(reason_2015_young == &quot;cannot read&quot;|
                                    reason_2015_young == &quot;not enough time&quot;|
                                    reason_2015_young == &quot;proxy respondent&quot;|
                                    reason_2015_young == &quot;other&quot;|
                                    reason_2015_young == &quot;refused&quot;|
                                    reason_2015_young == &quot;could not be contacted&quot;, NA,
                                    raven_2015_young)),
         math_2015_young = ifelse(is.na(reason_2015_young), math_2015_young,
                             ifelse(reason_2015_young == &quot;cannot read&quot;|
                                    reason_2015_young == &quot;not enough time&quot;|
                                    reason_2015_young == &quot;proxy respondent&quot;|
                                    reason_2015_young == &quot;other&quot;|
                                    reason_2015_young == &quot;refused&quot;|
                                    reason_2015_young == &quot;could not be contacted&quot;, NA,
                                    math_2015_young)),
         reason_2015_old = ifelse(reason_2015_old == 1, &quot;refused&quot;,
                   ifelse(reason_2015_old == 2, &quot;cannot read&quot;,
                   ifelse(reason_2015_old == 3, &quot;unable to answer&quot;,
                   ifelse(reason_2015_old == 4, &quot;not enough time&quot;,
                   ifelse(reason_2015_old == 5, &quot;proxy respondent&quot;,
                   ifelse(reason_2015_old == 6, &quot;other&quot;,
                   ifelse(reason_2015_old == 7, &quot;could not be contacted&quot;, NA))))))),
         raven_2015_old = ifelse(is.na(reason_2015_old), raven_2015_old,
                             ifelse(reason_2015_old == &quot;cannot read&quot;|
                                    reason_2015_old == &quot;not enough time&quot;|
                                    reason_2015_old == &quot;proxy respondent&quot;|
                                    reason_2015_old == &quot;other&quot;|
                                    reason_2015_old == &quot;refused&quot;|
                                    reason_2015_old == &quot;could not be contacted&quot;, NA,
                                    raven_2015_old)),
         math_2015_old = ifelse(is.na(reason_2015_old), math_2015_old,
                             ifelse(reason_2015_old == &quot;cannot read&quot;|
                                    reason_2015_old == &quot;not enough time&quot;|
                                    reason_2015_old == &quot;proxy respondent&quot;|
                                    reason_2015_old == &quot;other&quot;|
                                    reason_2015_old == &quot;refused&quot;|
                                    reason_2015_old == &quot;could not be contacted&quot;, NA,
                                    math_2015_old)),
         math_2015_old = ifelse(age_2015_old &gt;= 60, NA, math_2015_old))

iq %&gt;% select(raven_2015_old, math_2015_old, raven_2015_young, math_2015_young, count_backwards, words_immediate, words_delayed, adaptive_numbering) %&gt;% tidyr::gather() %&gt;%
  ggplot(aes(value)) + geom_bar() + facet_wrap(~ key, scales = &quot;free&quot;)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning: Removed 143670 rows containing non-finite values (stat_count).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20IQ%20data-9.png" width="672" /></p>
<div id="iq-tests-earlier-waves" class="section level3">
<h3>IQ-Tests earlier waves</h3>
<pre class="r"><code>## Wave 4 - 2007
### Data
iq2007_ek2= bek_ek2 %&gt;%
  select(pidlink, ektype, reason_2007_old = reason, &quot;age_2007_old&quot; = age,
         sex_2007_old = sex, matches(&quot;ek[0-9]x&quot;), matches(&quot;ek[0-9][0-9]x&quot;))

iq2007_ek1= bek_ek1 %&gt;%
  select(pidlink, ektype, reason_2007_young = reason, &quot;age_2007_young&quot; = age,
         sex_2007_young = sex, matches(&quot;ek[0-9]x&quot;), matches(&quot;ek[0-9][0-9]x&quot;)) %&gt;%
  filter(!(pidlink %in% iq2007_ek2$pidlink))

# some people answered both versions of the test
# (depending on whether they had seen test ek1 already in 2000)
# In order to deal with them i form an additional dataset that includes the information from
# the people that repeated the first test and their score on the first test in 2007
# that means they have already seen the test 7 years before...
# i merge this data later in the same column as the other scores in 2007 in the first test
# check with Ruben, if that is the right way to go...

iq2007_ek1_repeater = bek_ek1 %&gt;%
  select(pidlink, ektype, reason_2007_young_repeater = reason,
         &quot;age_2007_young_repeater&quot; = age, sex_2007_young_repeater = sex,
         matches(&quot;ek[0-9]x&quot;), matches(&quot;ek[0-9][0-9]x&quot;)) %&gt;%
  filter((pidlink %in% iq2007_ek2$pidlink))

iq2007 = bind_rows(iq2007_ek1, iq2007_ek2) 

### Raven
iq2007 = iq2007 %&gt;%
  mutate(ek1x = ifelse(ek1x == 1, 1,
                       ifelse(ek1x == 6, NA, 0)),
         ek2x = ifelse(ek2x == 1,  1,
                       ifelse(ek2x == 6, NA, 0)),
         ek3x = ifelse(ek3x == 1,  1,
                       ifelse(ek3x == 6, NA, 0)),
         ek4x = ifelse(ek4x == 1,  1,
                       ifelse(ek4x == 6, NA, 0)),
         ek5x = ifelse(ek5x == 1,  1,
                       ifelse(ek5x == 6, NA, 0)),
         ek6x = ifelse(ek6x == 1,  1,
                       ifelse(ek6x == 6, NA, 0)),
         ek7x = ifelse(ek7x == 1,  1,
                       ifelse(ek7x == 6, NA, 0)),
         ek8x = ifelse(ek8x == 1,  1,
                       ifelse(ek8x == 6, NA, 0)),
         ek9x = ifelse(ek9x == 1,  1,
                       ifelse(ek9x == 6, NA, 0)),
         ek10x = ifelse(ek10x == 1, 1,
                       ifelse(ek10x == 6, NA, 0)),
         ek11x = ifelse(ek11x == 1,  1,
                       ifelse(ek11x == 6, NA, 0)),
         ek12x = ifelse(ek12x == 1,  1,
                       ifelse(ek12x == 6, NA, 0)))

answered_raven_items = iq2007 %&gt;% select(ek1x:ek12x)
psych::alpha(data.frame(answered_raven_items))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(answered_raven_items))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd
##       0.85      0.87    0.87      0.35 6.4 0.0016 0.69 0.28
## 
##  lower alpha upper     95% confidence boundaries
## 0.85 0.85 0.86 
## 
##  Reliability if an item is dropped:
##       raw_alpha std.alpha G6(smc) average_r S/N alpha se
## ek1x       0.84      0.85    0.86      0.34 5.7   0.0017
## ek2x       0.83      0.85    0.86      0.34 5.6   0.0018
## ek3x       0.83      0.85    0.85      0.34 5.6   0.0018
## ek4x       0.84      0.85    0.86      0.34 5.7   0.0018
## ek5x       0.85      0.86    0.87      0.36 6.1   0.0017
## ek6x       0.85      0.87    0.87      0.37 6.5   0.0016
## ek7x       0.84      0.85    0.85      0.34 5.8   0.0017
## ek8x       0.84      0.85    0.85      0.34 5.7   0.0017
## ek9x       0.84      0.85    0.86      0.35 5.8   0.0017
## ek10x      0.84      0.86    0.87      0.35 6.0   0.0017
## ek11x      0.84      0.85    0.86      0.34 5.7   0.0017
## ek12x      0.86      0.87    0.87      0.37 6.5   0.0015
## 
##  Item statistics 
##           n raw.r std.r r.cor r.drop mean   sd
## ek1x  18508  0.63  0.69  0.65   0.58 0.89 0.31
## ek2x  18508  0.73  0.71  0.69   0.65 0.74 0.44
## ek3x  18508  0.75  0.72  0.70   0.67 0.70 0.46
## ek4x  18508  0.72  0.69  0.66   0.62 0.69 0.46
## ek5x  18508  0.63  0.59  0.52   0.50 0.64 0.48
## ek6x  18508  0.55  0.48  0.40   0.39 0.42 0.49
## ek7x   6684  0.62  0.67  0.65   0.55 0.92 0.27
## ek8x   6684  0.63  0.68  0.67   0.56 0.91 0.29
## ek9x   6684  0.63  0.65  0.61   0.54 0.85 0.36
## ek10x  6684  0.61  0.61  0.55   0.51 0.79 0.40
## ek11x 18508  0.65  0.68  0.64   0.58 0.82 0.38
## ek12x 18508  0.54  0.47  0.38   0.37 0.40 0.49
## 
## Non missing response frequency for each item
##          0    1 miss
## ek1x  0.11 0.89 0.00
## ek2x  0.26 0.74 0.00
## ek3x  0.30 0.70 0.00
## ek4x  0.31 0.69 0.00
## ek5x  0.36 0.64 0.00
## ek6x  0.58 0.42 0.00
## ek7x  0.08 0.92 0.64
## ek8x  0.09 0.91 0.64
## ek9x  0.15 0.85 0.64
## ek10x 0.21 0.79 0.64
## ek11x 0.18 0.82 0.00
## ek12x 0.60 0.40 0.00</code></pre>
<pre class="r"><code>iq2007$raven2007 = rowMeans(answered_raven_items, na.rm = T)
iq2007 = iq2007 %&gt;%
  mutate(raven_2007_young = ifelse(ektype == 1, raven2007, NA),
         raven_2007_old = ifelse(ektype == 2, raven2007, NA))
qplot(iq2007$raven_2007_young)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 11824 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>qplot(iq2007$raven_2007_old)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 6684 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<pre class="r"><code>##Math Test
iq2007 = iq2007 %&gt;%
  mutate(ek13x = ifelse(ek13x == 1, 1,
                       ifelse(ek13x == 6, NA, 0)),
         ek14x = ifelse(ek14x == 1,  1,
                       ifelse(ek14x == 6, NA, 0)),
         ek15x = ifelse(ek15x == 1,  1,
                       ifelse(ek15x == 6, NA, 0)),
         ek16x = ifelse(ek16x == 1,  1,
                       ifelse(ek16x == 6, NA, 0)),
         ek17x = ifelse(ek17x == 1,  1,
                       ifelse(ek17x == 6, NA, 0)),
         ek18x = ifelse(ek18x == 1,  1,
                       ifelse(ek18x == 6, NA, 0)),
         ek19x = ifelse(ek19x == 1,  1,
                       ifelse(ek19x == 6, NA, 0)),
         ek20x = ifelse(ek20x == 1,  1,
                       ifelse(ek20x == 6, NA, 0)),
         ek21x = ifelse(ek21x == 1,  1,
                       ifelse(ek21x == 6, NA, 0)),
         ek22x = ifelse(ek22x == 1, 1,
                       ifelse(ek22x == 6, NA, 0)))

answered_math_items = iq2007 %&gt;% select(ek13x:ek22x)
iq2007$math2007 = rowMeans( answered_math_items, na.rm = T)
iq2007 = iq2007 %&gt;%
  mutate(math_2007_young = ifelse(ektype == 1, math2007, NA),
         math_2007_old = ifelse(ektype == 2, math2007, NA))
qplot(iq2007$math_2007_young)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 11824 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<pre class="r"><code>qplot(iq2007$math_2007_old)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 6684 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-3-4.png" width="672" /></p>
<pre class="r"><code>iq2007 = iq2007 %&gt;% select(pidlink, age_2007_young, age_2007_old, sex_2007_young,
                           sex_2007_old, raven_2007_young, raven_2007_old, math_2007_young,
                           math_2007_old, reason_2007_old, reason_2007_young)

##Do the same for the repeater
### Raven
iq2007_ek1_repeater = iq2007_ek1_repeater %&gt;%
  mutate(ek1x = ifelse(ek1x == 1, 1,
                       ifelse(ek1x == 6, NA, 0)),
         ek2x = ifelse(ek2x == 1,  1,
                       ifelse(ek2x == 6, NA, 0)),
         ek3x = ifelse(ek3x == 1,  1,
                       ifelse(ek3x == 6, NA, 0)),
         ek4x = ifelse(ek4x == 1,  1,
                       ifelse(ek4x == 6, NA, 0)),
         ek5x = ifelse(ek5x == 1,  1,
                       ifelse(ek5x == 6, NA, 0)),
         ek6x = ifelse(ek6x == 1,  1,
                       ifelse(ek6x == 6, NA, 0)),
         ek7x = ifelse(ek7x == 1,  1,
                       ifelse(ek7x == 6, NA, 0)),
         ek8x = ifelse(ek8x == 1,  1,
                       ifelse(ek8x == 6, NA, 0)),
         ek9x = ifelse(ek9x == 1,  1,
                       ifelse(ek9x == 6, NA, 0)),
         ek10x = ifelse(ek10x == 1, 1,
                       ifelse(ek10x == 6, NA, 0)),
         ek11x = ifelse(ek11x == 1,  1,
                       ifelse(ek11x == 6, NA, 0)),
         ek12x = ifelse(ek12x == 1,  1,
                       ifelse(ek12x == 6, NA, 0)))

answered_raven_items = iq2007_ek1_repeater %&gt;% select(ek1x:ek12x)
psych::alpha(data.frame(answered_raven_items))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(answered_raven_items))
## 
##   raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd
##       0.87      0.89     0.9      0.41 8.2 0.0028 0.78 0.25
## 
##  lower alpha upper     95% confidence boundaries
## 0.87 0.87 0.88 
## 
##  Reliability if an item is dropped:
##       raw_alpha std.alpha G6(smc) average_r S/N alpha se
## ek1x       0.86      0.88    0.89      0.40 7.3   0.0031
## ek2x       0.86      0.88    0.89      0.40 7.3   0.0032
## ek3x       0.85      0.88    0.89      0.40 7.3   0.0033
## ek4x       0.86      0.88    0.89      0.40 7.5   0.0032
## ek5x       0.87      0.89    0.90      0.42 8.0   0.0030
## ek6x       0.88      0.89    0.90      0.44 8.5   0.0027
## ek7x       0.86      0.88    0.88      0.39 7.1   0.0031
## ek8x       0.86      0.88    0.88      0.39 7.1   0.0031
## ek9x       0.86      0.88    0.89      0.39 7.1   0.0032
## ek10x      0.86      0.88    0.89      0.40 7.3   0.0032
## ek11x      0.86      0.88    0.89      0.40 7.5   0.0031
## ek12x      0.88      0.90    0.90      0.44 8.6   0.0027
## 
##  Item statistics 
##          n raw.r std.r r.cor r.drop mean   sd
## ek1x  4518  0.69  0.73  0.71   0.64 0.91 0.29
## ek2x  4518  0.72  0.72  0.69   0.65 0.81 0.40
## ek3x  4518  0.76  0.74  0.72   0.69 0.78 0.41
## ek4x  4518  0.71  0.69  0.65   0.62 0.76 0.43
## ek5x  4518  0.61  0.58  0.51   0.49 0.69 0.46
## ek6x  4518  0.53  0.48  0.40   0.39 0.48 0.50
## ek7x  4518  0.71  0.76  0.76   0.66 0.92 0.27
## ek8x  4518  0.73  0.78  0.78   0.68 0.92 0.27
## ek9x  4518  0.73  0.77  0.75   0.67 0.90 0.30
## ek10x 4518  0.70  0.72  0.69   0.64 0.87 0.34
## ek11x 4518  0.67  0.69  0.65   0.59 0.86 0.35
## ek12x 4518  0.51  0.46  0.37   0.37 0.46 0.50
## 
## Non missing response frequency for each item
##          0    1 miss
## ek1x  0.09 0.91    0
## ek2x  0.19 0.81    0
## ek3x  0.22 0.78    0
## ek4x  0.24 0.76    0
## ek5x  0.31 0.69    0
## ek6x  0.52 0.48    0
## ek7x  0.08 0.92    0
## ek8x  0.08 0.92    0
## ek9x  0.10 0.90    0
## ek10x 0.13 0.87    0
## ek11x 0.14 0.86    0
## ek12x 0.54 0.46    0</code></pre>
<pre class="r"><code>iq2007_ek1_repeater$raven_2007_young_repeater = rowMeans(answered_raven_items, na.rm = T)
qplot(iq2007_ek1_repeater$raven_2007_young_repeater)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-3-5.png" width="672" /></p>
<pre class="r"><code>##Math Test
iq2007_ek1_repeater = iq2007_ek1_repeater %&gt;%
  mutate(ek13x = ifelse(ek13x == 1, 1,
                       ifelse(ek13x == 6, NA, 0)),
         ek14x = ifelse(ek14x == 1,  1,
                       ifelse(ek14x == 6, NA, 0)),
         ek15x = ifelse(ek15x == 1,  1,
                       ifelse(ek15x == 6, NA, 0)),
         ek16x = ifelse(ek16x == 1,  1,
                       ifelse(ek16x == 6, NA, 0)),
         ek17x = ifelse(ek17x == 1,  1,
                       ifelse(ek17x == 6, NA, 0)),
         ek18x = ifelse(ek18x == 1,  1,
                       ifelse(ek18x == 6, NA, 0)),
         ek19x = ifelse(ek19x == 1,  1,
                       ifelse(ek19x == 6, NA, 0)),
         ek20x = ifelse(ek20x == 1,  1,
                       ifelse(ek20x == 6, NA, 0)),
         ek21x = ifelse(ek21x == 1,  1,
                       ifelse(ek21x == 6, NA, 0)),
         ek22x = ifelse(ek22x == 1, 1,
                       ifelse(ek22x == 6, NA, 0)))

answered_math_items = iq2007_ek1_repeater %&gt;% select(ek13x:ek22x)
iq2007_ek1_repeater$math_2007_young_repeater = rowMeans( answered_math_items, na.rm = T)
qplot(iq2007_ek1_repeater$math_2007_young_repeater)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-3-6.png" width="672" /></p>
<pre class="r"><code>iq2007_ek1_repeater = iq2007_ek1_repeater %&gt;%
  select(pidlink, raven_2007_young_repeater, math_2007_young_repeater,
         reason_2007_young_repeater, age_2007_young_repeater, sex_2007_young_repeater)

iq2007_all = left_join(iq2007, iq2007_ek1_repeater, by = &quot;pidlink&quot;)</code></pre>
<pre><code>## Warning: Column `pidlink` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code># Now we instert raven and math scores from the repeaters as raven and math scores young
# Treat them like all the others.
crosstabs(is.na(iq2007_all$raven_2007_young) + is.na(iq2007_all$raven_2007_young_repeater))</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">6684</td>
</tr>
<tr class="even">
<td align="center">4518</td>
<td align="center">7306</td>
</tr>
</tbody>
</table>
<pre class="r"><code>iq2007_all = iq2007_all %&gt;%
  mutate(raven_2007_young = ifelse(!is.na(raven_2007_young_repeater),
                                   raven_2007_young_repeater, raven_2007_young),
         math_2007_young = ifelse(!is.na(math_2007_young_repeater),
                                  math_2007_young_repeater, math_2007_young),
         age_2007_young = ifelse(!is.na(age_2007_young_repeater),
                                 age_2007_young_repeater, age_2007_young),
         sex_2007_young = ifelse(!is.na(sex_2007_young_repeater),
                                 sex_2007_young_repeater, sex_2007_young))

iq2007_all = iq2007_all %&gt;% select(pidlink, age_2007_young, age_2007_old, raven_2007_old,
                                   raven_2007_young, math_2007_young, math_2007_old,
                                   reason_2007_young, reason_2007_old)
# some people have reasons not to answer the test (dead, not contacted), that dont justify
# giving them zero points for that task. so i set these to NA
# it is important to note that raven and math test were only answered by participants
# aged 7 - 24
iq2007_all = iq2007_all %&gt;%
  mutate(reason_2007_young = ifelse(reason_2007_young == 1, &quot;refused&quot;,
                   ifelse(reason_2007_young == 2, &quot;cannot read&quot;,
                   ifelse(reason_2007_young == 3, &quot;unable to answer&quot;,
                   ifelse(reason_2007_young == 4, &quot;not enough time&quot;,
                   ifelse(reason_2007_young == 5, &quot;proxy respondent&quot;,
                   ifelse(reason_2007_young == 6, &quot;other&quot;,
                   ifelse(reason_2007_young == 7, &quot;could not be contacted&quot;, NA))))))),
         raven_2007_young = ifelse(is.na(reason_2007_young), raven_2007_young,
                             ifelse(reason_2007_young == &quot;cannot read&quot;|
                                    reason_2007_young == &quot;not enough time&quot;|
                                    reason_2007_young == &quot;proxy respondent&quot;|
                                    reason_2007_young == &quot;other&quot;|
                                    reason_2007_young == &quot;refused&quot;|
                                    reason_2007_young == &quot;could not be contacted&quot;, NA,
                                    raven_2007_young)),
         math_2007_young = ifelse(is.na(reason_2007_young), math_2007_young,
                             ifelse(reason_2007_young == &quot;cannot read&quot;|
                                    reason_2007_young == &quot;not enough time&quot;|
                                    reason_2007_young == &quot;proxy respondent&quot;|
                                    reason_2007_young == &quot;other&quot;|
                                    reason_2007_young == &quot;refused&quot;|
                                    reason_2007_young == &quot;could not be contacted&quot;, NA,
                                    math_2007_young)),
         reason_2007_old = ifelse(reason_2007_old == 1, &quot;refused&quot;,
                   ifelse(reason_2007_old == 2, &quot;cannot read&quot;,
                   ifelse(reason_2007_old == 3, &quot;unable to answer&quot;,
                   ifelse(reason_2007_old == 4, &quot;not enough time&quot;,
                   ifelse(reason_2007_old == 5, &quot;proxy respondent&quot;,
                   ifelse(reason_2007_old == 6, &quot;other&quot;,
                   ifelse(reason_2007_old == 7, &quot;could not be contacted&quot;, NA))))))),
         raven_2007_old = ifelse(is.na(reason_2007_old), raven_2007_old,
                             ifelse(reason_2007_old == &quot;cannot read&quot;|
                                    reason_2007_old == &quot;not enough time&quot;|
                                    reason_2007_old == &quot;proxy respondent&quot;|
                                    reason_2007_old == &quot;other&quot;|
                                    reason_2007_old == &quot;refused&quot;|
                                    reason_2007_old == &quot;could not be contacted&quot;, NA,
                                    raven_2007_old)),
         math_2007_old = ifelse(is.na(reason_2007_old), math_2007_old,
                             ifelse(reason_2007_old == &quot;cannot read&quot;|
                                    reason_2007_old == &quot;not enough time&quot;|
                                    reason_2007_old == &quot;proxy respondent&quot;|
                                    reason_2007_old == &quot;other&quot;|
                                    reason_2007_young == &quot;refused&quot;|
                                    reason_2007_old == &quot;could not be contacted&quot;, NA,
                                    math_2007_old)))

iq2007_all %&gt;% select(raven_2007_old, math_2007_old, raven_2007_young, math_2007_young) %&gt;% tidyr::gather() %&gt;%  ggplot(aes(value)) + geom_bar() + facet_wrap(~ key, scales = &quot;free&quot;)</code></pre>
<pre><code>## Warning: Removed 29971 rows containing non-finite values (stat_count).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-3-7.png" width="672" /></p>
<pre class="r"><code>iq = full_join(iq, iq2007_all, by = &quot;pidlink&quot;) %&gt;%
  select(-matches(&quot;ek[0-9]_ans&quot;), -matches(&quot;ek[0-9][0-9]_ans&quot;), -starts_with(&quot;hhid&quot;),
         -ektype, -resptype, -result, -starts_with(&quot;reason&quot;), -starts_with(&quot;co&quot;),
         count_backwards, -w_abil)</code></pre>
<pre><code>## Warning: Column `pidlink` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code>## IQ Tests 
## Correlation of all Iq-Tests
round(cor(iq %&gt;% select(raven_2015_old, math_2015_old, raven_2015_young, math_2015_young, count_backwards, words_immediate, words_delayed, adaptive_numbering, raven_2007_old, math_2007_young), use = &quot;pairwise.complete.obs&quot;), 2)</code></pre>
<table>
<colgroup>
<col width="9%" />
<col width="9%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
<col width="11%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">raven_2015_old</th>
<th align="center">math_2015_old</th>
<th align="center">raven_2015_young</th>
<th align="center">math_2015_young</th>
<th align="center">count_backwards</th>
<th align="center">words_immediate</th>
<th align="center">words_delayed</th>
<th align="center">adaptive_numbering</th>
<th align="center">raven_2007_old</th>
<th align="center">math_2007_young</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">0.36</td>
<td align="center">0.69</td>
<td align="center">0.31</td>
<td align="center">0.27</td>
<td align="center">0.39</td>
<td align="center">0.37</td>
<td align="center">0.45</td>
<td align="center">0.37</td>
<td align="center">0.19</td>
</tr>
<tr class="even">
<td align="center">0.36</td>
<td align="center">1</td>
<td align="center">0.31</td>
<td align="center">0.5</td>
<td align="center">0.21</td>
<td align="center">0.25</td>
<td align="center">0.25</td>
<td align="center">0.31</td>
<td align="center">0.21</td>
<td align="center">0.23</td>
</tr>
<tr class="odd">
<td align="center">0.69</td>
<td align="center">0.31</td>
<td align="center">1</td>
<td align="center">0.4</td>
<td align="center">0.22</td>
<td align="center">0.19</td>
<td align="center">0.19</td>
<td align="center">0.3</td>
<td align="center">0.32</td>
<td align="center">0.13</td>
</tr>
<tr class="even">
<td align="center">0.31</td>
<td align="center">0.5</td>
<td align="center">0.4</td>
<td align="center">1</td>
<td align="center">0.23</td>
<td align="center">0.18</td>
<td align="center">0.18</td>
<td align="center">0.29</td>
<td align="center">0.18</td>
<td align="center">0.19</td>
</tr>
<tr class="odd">
<td align="center">0.27</td>
<td align="center">0.21</td>
<td align="center">0.22</td>
<td align="center">0.23</td>
<td align="center">1</td>
<td align="center">0.23</td>
<td align="center">0.22</td>
<td align="center">0.33</td>
<td align="center">0.23</td>
<td align="center">0.17</td>
</tr>
<tr class="even">
<td align="center">0.39</td>
<td align="center">0.25</td>
<td align="center">0.19</td>
<td align="center">0.18</td>
<td align="center">0.23</td>
<td align="center">1</td>
<td align="center">0.77</td>
<td align="center">0.4</td>
<td align="center">0.2</td>
<td align="center">0.13</td>
</tr>
<tr class="odd">
<td align="center">0.37</td>
<td align="center">0.25</td>
<td align="center">0.19</td>
<td align="center">0.18</td>
<td align="center">0.22</td>
<td align="center">0.77</td>
<td align="center">1</td>
<td align="center">0.37</td>
<td align="center">0.18</td>
<td align="center">0.13</td>
</tr>
<tr class="even">
<td align="center">0.45</td>
<td align="center">0.31</td>
<td align="center">0.3</td>
<td align="center">0.29</td>
<td align="center">0.33</td>
<td align="center">0.4</td>
<td align="center">0.37</td>
<td align="center">1</td>
<td align="center">0.3</td>
<td align="center">0.22</td>
</tr>
<tr class="odd">
<td align="center">0.37</td>
<td align="center">0.21</td>
<td align="center">0.32</td>
<td align="center">0.18</td>
<td align="center">0.23</td>
<td align="center">0.2</td>
<td align="center">0.18</td>
<td align="center">0.3</td>
<td align="center">1</td>
<td align="center">0.32</td>
</tr>
<tr class="even">
<td align="center">0.19</td>
<td align="center">0.23</td>
<td align="center">0.13</td>
<td align="center">0.19</td>
<td align="center">0.17</td>
<td align="center">0.13</td>
<td align="center">0.13</td>
<td align="center">0.22</td>
<td align="center">0.32</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>##Missingness_Patterns
formr::missingness_patterns(iq %&gt;% select(raven_2015_old, math_2015_old, raven_2015_young, math_2015_young, count_backwards, words_immediate, words_delayed, adaptive_numbering, raven_2007_old, math_2007_young))</code></pre>
<pre><code>##  index                col missings
##      1    math_2007_young    37147
##      2     raven_2007_old    36988
##      3   raven_2015_young    34066
##      4    math_2015_young    34066
##      5      math_2015_old    19612
##      6    count_backwards    17635
##      7 adaptive_numbering    16678
##      8     raven_2015_old    16669
##      9    words_immediate    16616
##     10      words_delayed    16616</code></pre>
<table style="width:67%;">
<colgroup>
<col width="31%" />
<col width="11%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Pattern</th>
<th align="center">Freq</th>
<th align="center">Culprit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1_2_3_4_____________</td>
<td align="center">15403</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_2_____5_6_7_8_9_10</td>
<td align="center">6889</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_<strong>3_4</strong>___________</td>
<td align="center">4987</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_2_3_4_5_6_7_8_9_10</td>
<td align="center">4129</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><strong>2</strong>_______________</td>
<td align="center">3490</td>
<td align="center">raven_2007_old</td>
</tr>
<tr class="even">
<td align="center">____________________</td>
<td align="center">2629</td>
<td align="center">_</td>
</tr>
<tr class="odd">
<td align="center">1_2_3_4_5___________</td>
<td align="center">2593</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1___3_4_5_6_7_8_9_10</td>
<td align="center">1616</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">__2_3_4_5_6_7_8_9_10</td>
<td align="center">1547</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">____3_4_5_6_7_8_9_10</td>
<td align="center">1171</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><strong>2</strong>___5_6_7_8_9_10</td>
<td align="center">888</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>2_3_4</strong>___________</td>
<td align="center">601</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_2_3_4_<strong>6</strong>_______</td>
<td align="center">482</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">____3_4_____________</td>
<td align="center">416</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_2_3_4_5_____8_____</td>
<td align="center">248</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_2_3_4_5_6_________</td>
<td align="center">188</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_2_3_4_5_6_7___9_10</td>
<td align="center">160</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_2_3_4_<strong>6_7</strong>_9_10</td>
<td align="center">140</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_<strong>3_4</strong>_6_________</td>
<td align="center">121</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_2_3_4_5_6_<strong>8</strong>___</td>
<td align="center">66</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><strong>2</strong>_____6_________</td>
<td align="center">54</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_<strong>3_4_5</strong>_<strong>8</strong>___</td>
<td align="center">38</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">__________6_________</td>
<td align="center">38</td>
<td align="center">count_backwards</td>
</tr>
<tr class="even">
<td align="center">1_<strong>3_4</strong>_6_7___9_10</td>
<td align="center">33</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_2_3_4_5_6_7_8_____</td>
<td align="center">23</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>2_3_4_5</strong>_<strong>8</strong>___</td>
<td align="center">15</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><strong>2_3_4</strong>_6_________</td>
<td align="center">14</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>2</strong>_____6_7___9_10</td>
<td align="center">14</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_2_3_4_5_<strong>7_8</strong>___</td>
<td align="center">13</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">__________6_7___9_10</td>
<td align="center">13</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">____3_4_5_____8_____</td>
<td align="center">12</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>2_3_4</strong>_6_7___9_10</td>
<td align="center">11</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">____3_4_<strong>6</strong>_______</td>
<td align="center">11</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_2_3_4_<strong>6_7</strong>_____</td>
<td align="center">8</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">____3_4_5_6_7_8_____</td>
<td align="center">3</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">____3_4_<strong>6_7</strong>_9_10</td>
<td align="center">3</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_2_3_4_5_6_7_______</td>
<td align="center">2</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_2_3_4_____7_______</td>
<td align="center">2</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><strong>2_3_4_5_6_7_8</strong>___</td>
<td align="center">2</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>2_3_4_5</strong>_7_8_____</td>
<td align="center">2</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">__________6_7_______</td>
<td align="center">2</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_2_____5_____8_____</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_<strong>3_4_5_6_7_8</strong>___</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_<strong>3_4_5_6</strong>_8_____</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_<strong>3_4_5</strong>_7_8_____</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">1_<strong>3_4</strong>_<strong>7</strong>_____</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">1_______5_6_7_8_9_10</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>2_3_4_5_6</strong>_8_____</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><strong>2_3_4</strong>_6_7_______</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><strong>2</strong>_____6_7_______</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">________5_6_7_8_9_10</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<pre class="r"><code>iq %&gt;% select(raven_2015_old, math_2015_old, raven_2015_young, math_2015_young, raven_2007_old, math_2007_old, raven_2007_young, math_2007_young, count_backwards, words_immediate, words_delayed, adaptive_numbering) %&gt;% tidyr::gather() %&gt;%
  ggplot(aes(value)) + geom_bar() + facet_wrap(~ key, scales = &quot;free&quot;)</code></pre>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<pre><code>## Warning: Removed 320245 rows containing non-finite values (stat_count).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="g_factor-at-the-beginning" class="section level3">
<h3>g_factor at the beginning</h3>
<pre class="r"><code># G_factor_2015_old
nomiss = iq %&gt;%
  filter(!is.na(raven_2015_old), !is.na(math_2015_old), !is.na(count_backwards), !is.na(words_delayed),
         !is.na(adaptive_numbering))


fa.parallel(nomiss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, words_delayed, adaptive_numbering) %&gt;% data.frame())</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  2  and the number of components =  1</code></pre>
<pre class="r"><code>fa(nomiss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, words_delayed, adaptive_numbering) %&gt;% data.frame(), nfactors = 1)</code></pre>
<pre><code>## Factor Analysis using method =  minres
## Call: fa(r = nomiss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, 
##     words_delayed, adaptive_numbering) %&gt;% data.frame(), nfactors = 1)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                     MR1   h2   u2 com
## raven_2015_old     0.65 0.42 0.58   1
## math_2015_old      0.50 0.25 0.75   1
## count_backwards    0.45 0.20 0.80   1
## words_delayed      0.48 0.23 0.77   1
## adaptive_numbering 0.64 0.40 0.60   1
## 
##                 MR1
## SS loadings    1.51
## Proportion Var 0.30
## 
## Mean item complexity =  1
## Test of the hypothesis that 1 factor is sufficient.
## 
## The degrees of freedom for the null model are  10  and the objective function was  0.65 with Chi Square of  17983
## The degrees of freedom for the model are 5  and the objective function was  0.01 
## 
## The root mean square of the residuals (RMSR) is  0.02 
## The df corrected root mean square of the residuals is  0.03 
## 
## The harmonic number of observations is  27526 with the empirical chi square  189.6  with prob &lt;  4.7e-39 
## The total number of observations was  27526  with Likelihood Chi Square =  199.8  with prob &lt;  3.2e-41 
## 
## Tucker Lewis Index of factoring reliability =  0.978
## RMSEA index =  0.038  and the 90 % confidence intervals are  0.033 0.042
## BIC =  148.6
## Fit based upon off diagonal values = 1
## Measures of factor score adequacy             
##                                                    MR1
## Correlation of (regression) scores with factors   0.83
## Multiple R square of scores with factors          0.70
## Minimum correlation of possible factor scores     0.39</code></pre>
<pre class="r"><code>om_results = omega(nomiss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, words_delayed, adaptive_numbering) %&gt;% data.frame(), nfactors = 1, sl = F)</code></pre>
<pre><code>## Omega_h for 1 factor is not meaningful, just omega_t</code></pre>
<pre><code>## Warning in schmid(m, nfactors, fm, digits, rotate = rotate, n.obs = n.obs, : Omega_h and Omega_asymptotic are
## not meaningful with one factor</code></pre>
<pre class="r"><code>om_results</code></pre>
<pre><code>## Omega 
## Call: omega(m = nomiss %&gt;% select(raven_2015_old, math_2015_old, count_backwards, 
##     words_delayed, adaptive_numbering) %&gt;% data.frame(), nfactors = 1, 
##     sl = F)
## Alpha:                 0.67 
## G.6:                   0.63 
## Omega Hierarchical:    0.68 
## Omega H asymptotic:    1 
## Omega Total            0.68 
## 
## Schmid Leiman Factor loadings greater than  0.2 
##                       g  F1*   h2   u2 p2
## raven_2015_old     0.65      0.42 0.58  1
## math_2015_old      0.50      0.25 0.75  1
## count_backwards    0.45      0.20 0.80  1
## words_delayed      0.48      0.23 0.77  1
## adaptive_numbering 0.64      0.40 0.60  1
## 
## With eigenvalues of:
##   g F1* 
## 1.5 0.0 
## 
## general/max  1.808e+16   max/min =   1
## mean percent general =  1    with sd =  0 and cv of  0 
## Explained Common Variance of the general factor =  1 
## 
## The degrees of freedom are 5  and the fit is  0.01 
## The number of observations was  27526  with Chi Square =  199.8  with prob &lt;  3.2e-41
## The root mean square of the residuals is  0.02 
## The df corrected root mean square of the residuals is  0.03
## RMSEA index =  0.038  and the 10 % confidence intervals are  0.033 0.042
## BIC =  148.6
## 
## Compare this with the adequacy of just a general factor and no group factors
## The degrees of freedom for just the general factor are 5  and the fit is  0.01 
## The number of observations was  27526  with Chi Square =  199.8  with prob &lt;  3.2e-41
## The root mean square of the residuals is  0.02 
## The df corrected root mean square of the residuals is  0.03 
## 
## RMSEA index =  0.038  and the 10 % confidence intervals are  0.033 0.042
## BIC =  148.6 
## 
## Measures of factor score adequacy             
##                                                  g F1*
## Correlation of scores with factors            0.83   0
## Multiple R square of scores with factors      0.70   0
## Minimum correlation of factor score estimates 0.39  -1
## 
##  Total, General and Subset omega for each subset
##                                                  g  F1*
## Omega total for total scores and subscales    0.68 0.68
## Omega general for total scores and subscales  0.68 0.68
## Omega group for total scores and subscales    0.00 0.00</code></pre>
<pre class="r"><code>omega.diagram(om_results)</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<pre class="r"><code>&quot;g_factor_2015_old =~ raven_2015_old + math_2015_old + count_backwards +  words_delayed+  adaptive_numbering&quot; %&gt;%
  cfa(data = nomiss, std.lv = T, std.ov = T) -&gt; cfa_g
summary(cfa_g)</code></pre>
<pre><code>## lavaan (0.5-23.1097) converged normally after  15 iterations
## 
##   Number of observations                         27526
## 
##   Estimator                                         ML
##   Minimum Function Test Statistic              198.999
##   Degrees of freedom                                 5
##   P-value (Chi-square)                           0.000
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Standard Errors                             Standard
## 
## Latent Variables:
##                        Estimate  Std.Err  z-value  P(&gt;|z|)
##   g_factor_2015_old =~                                    
##     raven_2015_old        0.650    0.007   94.857    0.000
##     math_2015_old         0.501    0.007   72.702    0.000
##     count_backwrds        0.452    0.007   65.043    0.000
##     words_delayed         0.478    0.007   69.072    0.000
##     adaptiv_nmbrng        0.632    0.007   92.413    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .raven_2015_old    0.578    0.007   77.886    0.000
##    .math_2015_old     0.749    0.008   99.579    0.000
##    .count_backwrds    0.796    0.008  103.868    0.000
##    .words_delayed     0.772    0.008  101.737    0.000
##    .adaptiv_nmbrng    0.600    0.007   81.214    0.000
##     g_fctr_2015_ld    1.000</code></pre>
<pre class="r"><code>summary</code></pre>
<pre><code>## standardGeneric for &quot;summary&quot; defined from package &quot;base&quot;
## 
## function (object, ...) 
## standardGeneric(&quot;summary&quot;)
## &lt;environment: 0x7fd128c5bb40&gt;
## Methods may be defined for arguments: object
## Use  showMethods(&quot;summary&quot;)  for currently available ones.</code></pre>
<pre class="r"><code>nomiss$g_factor_2015_old = predict(cfa_g)[,1]

qplot(nomiss$g_factor_2015_old)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<pre class="r"><code>nomiss = nomiss %&gt;% select(pidlink, g_factor_2015_old)

iq = left_join(iq, nomiss, by = &quot;pidlink&quot;)

# Explained Variance


# G_factor_2015_young
nomiss = iq %&gt;%
  filter(!is.na(raven_2015_young), !is.na(math_2015_young))


fa.parallel(nomiss %&gt;% select(raven_2015_young, math_2015_young) %&gt;% data.frame())</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-4.png" width="672" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  NA  and the number of components =  1</code></pre>
<pre class="r"><code>fa(nomiss %&gt;% select(raven_2015_young, math_2015_young) %&gt;% data.frame(), nfactors = 1)</code></pre>
<pre><code>## Factor Analysis using method =  minres
## Call: fa(r = nomiss %&gt;% select(raven_2015_young, math_2015_young) %&gt;% 
##     data.frame(), nfactors = 1)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                   MR1  h2  u2 com
## raven_2015_young 0.63 0.4 0.6   1
## math_2015_young  0.63 0.4 0.6   1
## 
##                MR1
## SS loadings    0.8
## Proportion Var 0.4
## 
## Mean item complexity =  1
## Test of the hypothesis that 1 factor is sufficient.
## 
## The degrees of freedom for the null model are  1  and the objective function was  0.18 with Chi Square of  2456
## The degrees of freedom for the model are -1  and the objective function was  0 
## 
## The root mean square of the residuals (RMSR) is  0 
## The df corrected root mean square of the residuals is  NA 
## 
## The harmonic number of observations is  14021 with the empirical chi square  0  with prob &lt;  NA 
## The total number of observations was  14021  with Likelihood Chi Square =  0  with prob &lt;  NA 
## 
## Tucker Lewis Index of factoring reliability =  1
## Fit based upon off diagonal values = 1
## Measures of factor score adequacy             
##                                                    MR1
## Correlation of (regression) scores with factors   0.76
## Multiple R square of scores with factors          0.57
## Minimum correlation of possible factor scores     0.14</code></pre>
<pre class="r"><code>om_results = omega(nomiss %&gt;% select(raven_2015_young, math_2015_young) %&gt;% data.frame(), nfactors = 1, sl = F)</code></pre>
<pre><code>## Omega_h for 1 factor is not meaningful, just omega_t</code></pre>
<pre><code>## Warning in schmid(m, nfactors, fm, digits, rotate = rotate, n.obs = n.obs, : Omega_h and Omega_asymptotic are
## not meaningful with one factor</code></pre>
<pre><code>## Warning in cov2cor(t(w) %*% r %*% w): diag(.) had 0 or NA entries; non-finite result is doubtful</code></pre>
<pre class="r"><code>om_results</code></pre>
<pre><code>## Omega 
## Call: omega(m = nomiss %&gt;% select(raven_2015_young, math_2015_young) %&gt;% 
##     data.frame(), nfactors = 1, sl = F)
## Alpha:                 0.57 
## G.6:                   0.4 
## Omega Hierarchical:    0.57 
## Omega H asymptotic:    1 
## Omega Total            0.57 
## 
## Schmid Leiman Factor loadings greater than  0.2 
##                     g F1*  h2  u2 p2
## raven_2015_young 0.63     0.4 0.6  1
## math_2015_young  0.63     0.4 0.6  1
## 
## With eigenvalues of:
##   g F1* 
## 0.8 0.0 
## 
## general/max  Inf   max/min =   NaN
## mean percent general =  1    with sd =  0 and cv of  0 
## Explained Common Variance of the general factor =  1 
## 
## The degrees of freedom are -1  and the fit is  0 
## The number of observations was  14021  with Chi Square =  0  with prob &lt;  NA
## The root mean square of the residuals is  0 
## The df corrected root mean square of the residuals is  NA
## 
## Compare this with the adequacy of just a general factor and no group factors
## The degrees of freedom for just the general factor are -1  and the fit is  0 
## The number of observations was  14021  with Chi Square =  0  with prob &lt;  NA
## The root mean square of the residuals is  0 
## The df corrected root mean square of the residuals is  NA 
## 
## Measures of factor score adequacy             
##                                                  g F1*
## Correlation of scores with factors            0.76   0
## Multiple R square of scores with factors      0.57   0
## Minimum correlation of factor score estimates 0.14  -1
## 
##  Total, General and Subset omega for each subset
##                                                  g  F1*
## Omega total for total scores and subscales    0.57 0.57
## Omega general for total scores and subscales  0.57 0.57
## Omega group for total scores and subscales    0.00 0.00</code></pre>
<pre class="r"><code>omega.diagram(om_results)</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-5.png" width="672" /></p>
<pre class="r"><code>&quot;g_factor_2015_young =~ raven_2015_young + math_2015_young&quot; %&gt;%
  cfa(data = nomiss, std.lv = T, std.ov = T) -&gt; cfa_g</code></pre>
<pre><code>## Warning in lav_model_vcov(lavmodel = lavmodel, lavsamplestats = lavsamplestats, : lavaan WARNING: could not compute standard errors!
##   lavaan NOTE: this may be a symptom that the model is not identified.</code></pre>
<pre class="r"><code>summary(cfa_g)</code></pre>
<pre><code>## lavaan (0.5-23.1097) converged normally after   9 iterations
## 
##   Number of observations                         14021
## 
##   Estimator                                         ML
##   Minimum Function Test Statistic                   NA
##   Degrees of freedom                                -1
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Standard Errors                             Standard
## 
## Latent Variables:
##                          Estimate  Std.Err  z-value  P(&gt;|z|)
##   g_factor_2015_young =~                                    
##     raven_2015_yng          0.633       NA                  
##     math_2015_yong          0.633       NA                  
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .raven_2015_yng    0.599       NA                  
##    .math_2015_yong    0.599       NA                  
##     g_fctr_2015_yn    1.000</code></pre>
<pre class="r"><code>nomiss$g_factor_2015_young = predict(cfa_g)[,1]

qplot(nomiss$g_factor_2015_young)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-6.png" width="672" /></p>
<pre class="r"><code>nomiss = nomiss %&gt;% select(pidlink, g_factor_2015_young)

iq = left_join(iq, nomiss, by = &quot;pidlink&quot;)

# G_factor_2007_old
nomiss = iq %&gt;%
  filter(!is.na(raven_2007_old), !is.na(math_2007_old))


fa.parallel(nomiss %&gt;% select(raven_2007_old, math_2007_old) %&gt;% data.frame())</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-7.png" width="672" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  NA  and the number of components =  1</code></pre>
<pre class="r"><code>fa(nomiss %&gt;% select(raven_2007_old, math_2007_old) %&gt;% data.frame(), nfactors = 1)</code></pre>
<pre><code>## Factor Analysis using method =  minres
## Call: fa(r = nomiss %&gt;% select(raven_2007_old, math_2007_old) %&gt;% data.frame(), 
##     nfactors = 1)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                 MR1   h2   u2 com
## raven_2007_old 0.59 0.35 0.65   1
## math_2007_old  0.59 0.35 0.65   1
## 
##                 MR1
## SS loadings    0.70
## Proportion Var 0.35
## 
## Mean item complexity =  1
## Test of the hypothesis that 1 factor is sufficient.
## 
## The degrees of freedom for the null model are  1  and the objective function was  0.13 with Chi Square of  1467
## The degrees of freedom for the model are -1  and the objective function was  0 
## 
## The root mean square of the residuals (RMSR) is  0 
## The df corrected root mean square of the residuals is  NA 
## 
## The harmonic number of observations is  11082 with the empirical chi square  0  with prob &lt;  NA 
## The total number of observations was  11082  with Likelihood Chi Square =  0  with prob &lt;  NA 
## 
## Tucker Lewis Index of factoring reliability =  1.001
## Fit based upon off diagonal values = 1
## Measures of factor score adequacy             
##                                                    MR1
## Correlation of (regression) scores with factors   0.72
## Multiple R square of scores with factors          0.52
## Minimum correlation of possible factor scores     0.04</code></pre>
<pre class="r"><code>om_results = omega(nomiss %&gt;% select(raven_2007_old, math_2007_old) %&gt;% data.frame(), nfactors = 1, sl = F)</code></pre>
<pre><code>## Omega_h for 1 factor is not meaningful, just omega_t</code></pre>
<pre><code>## Warning in schmid(m, nfactors, fm, digits, rotate = rotate, n.obs = n.obs, : Omega_h and Omega_asymptotic are
## not meaningful with one factor

## Warning in schmid(m, nfactors, fm, digits, rotate = rotate, n.obs = n.obs, : diag(.) had 0 or NA entries; non-
## finite result is doubtful</code></pre>
<pre class="r"><code>om_results</code></pre>
<pre><code>## Omega 
## Call: omega(m = nomiss %&gt;% select(raven_2007_old, math_2007_old) %&gt;% 
##     data.frame(), nfactors = 1, sl = F)
## Alpha:                 0.52 
## G.6:                   0.35 
## Omega Hierarchical:    0.52 
## Omega H asymptotic:    1 
## Omega Total            0.52 
## 
## Schmid Leiman Factor loadings greater than  0.2 
##                   g  F1*   h2   u2 p2
## raven_2007_old 0.59      0.35 0.65  1
## math_2007_old  0.59      0.35 0.65  1
## 
## With eigenvalues of:
##   g F1* 
## 0.7 0.0 
## 
## general/max  Inf   max/min =   NaN
## mean percent general =  1    with sd =  0 and cv of  0 
## Explained Common Variance of the general factor =  1 
## 
## The degrees of freedom are -1  and the fit is  0 
## The number of observations was  11082  with Chi Square =  0  with prob &lt;  NA
## The root mean square of the residuals is  0 
## The df corrected root mean square of the residuals is  NA
## 
## Compare this with the adequacy of just a general factor and no group factors
## The degrees of freedom for just the general factor are -1  and the fit is  0 
## The number of observations was  11082  with Chi Square =  0  with prob &lt;  NA
## The root mean square of the residuals is  0 
## The df corrected root mean square of the residuals is  NA 
## 
## Measures of factor score adequacy             
##                                                  g F1*
## Correlation of scores with factors            0.72   0
## Multiple R square of scores with factors      0.52   0
## Minimum correlation of factor score estimates 0.04  -1
## 
##  Total, General and Subset omega for each subset
##                                                  g  F1*
## Omega total for total scores and subscales    0.52 0.52
## Omega general for total scores and subscales  0.52 0.52
## Omega group for total scores and subscales    0.00 0.00</code></pre>
<pre class="r"><code>omega.diagram(om_results)</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-8.png" width="672" /></p>
<pre class="r"><code>&quot;g_factor_2007_old =~ raven_2007_old + math_2007_old&quot; %&gt;%
  cfa(data = nomiss, std.lv = T, std.ov = T) -&gt; cfa_g</code></pre>
<pre><code>## Warning in lav_model_vcov(lavmodel = lavmodel, lavsamplestats = lavsamplestats, : lavaan WARNING: could not compute standard errors!
##   lavaan NOTE: this may be a symptom that the model is not identified.</code></pre>
<pre class="r"><code>summary(cfa_g)</code></pre>
<pre><code>## lavaan (0.5-23.1097) converged normally after   7 iterations
## 
##   Number of observations                         11082
## 
##   Estimator                                         ML
##   Minimum Function Test Statistic                   NA
##   Degrees of freedom                                -1
##   Minimum Function Value               0.0000000000000
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Standard Errors                             Standard
## 
## Latent Variables:
##                        Estimate  Std.Err  z-value  P(&gt;|z|)
##   g_factor_2007_old =~                                    
##     raven_2007_old        0.593       NA                  
##     math_2007_old         0.593       NA                  
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .raven_2007_old    0.648       NA                  
##    .math_2007_old     0.648       NA                  
##     g_fctr_2007_ld    1.000</code></pre>
<pre class="r"><code>nomiss$g_factor_2007_old = predict(cfa_g)[,1]

qplot(nomiss$g_factor_2007_old)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-9.png" width="672" /></p>
<pre class="r"><code>nomiss = nomiss %&gt;% select(pidlink, g_factor_2007_old)

iq = left_join(iq, nomiss, by = &quot;pidlink&quot;)

# G_factor_2007_young
nomiss = iq %&gt;%
  filter(!is.na(raven_2007_young), !is.na(math_2007_young))


fa.parallel(nomiss %&gt;% select(raven_2007_young, math_2007_young) %&gt;% data.frame())</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-10.png" width="672" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  NA  and the number of components =  1</code></pre>
<pre class="r"><code>fa(nomiss %&gt;% select(raven_2007_young, math_2007_young) %&gt;% data.frame(), nfactors = 1)</code></pre>
<pre><code>## Factor Analysis using method =  minres
## Call: fa(r = nomiss %&gt;% select(raven_2007_young, math_2007_young) %&gt;% 
##     data.frame(), nfactors = 1)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                   MR1   h2   u2 com
## raven_2007_young 0.69 0.48 0.52   1
## math_2007_young  0.69 0.48 0.52   1
## 
##                 MR1
## SS loadings    0.96
## Proportion Var 0.48
## 
## Mean item complexity =  1
## Test of the hypothesis that 1 factor is sufficient.
## 
## The degrees of freedom for the null model are  1  and the objective function was  0.26 with Chi Square of  2885
## The degrees of freedom for the model are -1  and the objective function was  0 
## 
## The root mean square of the residuals (RMSR) is  0 
## The df corrected root mean square of the residuals is  NA 
## 
## The harmonic number of observations is  10940 with the empirical chi square  0  with prob &lt;  NA 
## The total number of observations was  10940  with Likelihood Chi Square =  0  with prob &lt;  NA 
## 
## Tucker Lewis Index of factoring reliability =  1
## Fit based upon off diagonal values = 1
## Measures of factor score adequacy             
##                                                    MR1
## Correlation of (regression) scores with factors   0.81
## Multiple R square of scores with factors          0.65
## Minimum correlation of possible factor scores     0.30</code></pre>
<pre class="r"><code>om_results = omega(nomiss %&gt;% select(raven_2007_young, math_2007_young) %&gt;% data.frame(), nfactors = 1, sl = F)</code></pre>
<pre><code>## Omega_h for 1 factor is not meaningful, just omega_t</code></pre>
<pre><code>## Warning in schmid(m, nfactors, fm, digits, rotate = rotate, n.obs = n.obs, : Omega_h and Omega_asymptotic are
## not meaningful with one factor

## Warning in schmid(m, nfactors, fm, digits, rotate = rotate, n.obs = n.obs, : diag(.) had 0 or NA entries; non-
## finite result is doubtful</code></pre>
<pre class="r"><code>om_results</code></pre>
<pre><code>## Omega 
## Call: omega(m = nomiss %&gt;% select(raven_2007_young, math_2007_young) %&gt;% 
##     data.frame(), nfactors = 1, sl = F)
## Alpha:                 0.65 
## G.6:                   0.48 
## Omega Hierarchical:    0.65 
## Omega H asymptotic:    1 
## Omega Total            0.65 
## 
## Schmid Leiman Factor loadings greater than  0.2 
##                     g  F1*   h2   u2 p2
## raven_2007_young 0.69      0.48 0.52  1
## math_2007_young  0.69      0.48 0.52  1
## 
## With eigenvalues of:
##    g  F1* 
## 0.96 0.00 
## 
## general/max  Inf   max/min =   NaN
## mean percent general =  1    with sd =  0 and cv of  0 
## Explained Common Variance of the general factor =  1 
## 
## The degrees of freedom are -1  and the fit is  0 
## The number of observations was  10940  with Chi Square =  0  with prob &lt;  NA
## The root mean square of the residuals is  0 
## The df corrected root mean square of the residuals is  NA
## 
## Compare this with the adequacy of just a general factor and no group factors
## The degrees of freedom for just the general factor are -1  and the fit is  0 
## The number of observations was  10940  with Chi Square =  0  with prob &lt;  NA
## The root mean square of the residuals is  0 
## The df corrected root mean square of the residuals is  NA 
## 
## Measures of factor score adequacy             
##                                                  g F1*
## Correlation of scores with factors            0.81   0
## Multiple R square of scores with factors      0.65   0
## Minimum correlation of factor score estimates 0.30  -1
## 
##  Total, General and Subset omega for each subset
##                                                  g  F1*
## Omega total for total scores and subscales    0.65 0.65
## Omega general for total scores and subscales  0.65 0.65
## Omega group for total scores and subscales    0.00 0.00</code></pre>
<pre class="r"><code>omega.diagram(om_results)</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-11.png" width="672" /></p>
<pre class="r"><code>&quot;g_factor_2007_young =~ raven_2007_young + math_2007_young&quot; %&gt;%
  cfa(data = nomiss, std.lv = T, std.ov = T) -&gt; cfa_g</code></pre>
<pre><code>## Warning in lav_model_vcov(lavmodel = lavmodel, lavsamplestats = lavsamplestats, : lavaan WARNING: could not compute standard errors!
##   lavaan NOTE: this may be a symptom that the model is not identified.</code></pre>
<pre class="r"><code>summary(cfa_g)</code></pre>
<pre><code>## lavaan (0.5-23.1097) converged normally after   8 iterations
## 
##   Number of observations                         10940
## 
##   Estimator                                         ML
##   Minimum Function Test Statistic                   NA
##   Degrees of freedom                                -1
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Standard Errors                             Standard
## 
## Latent Variables:
##                          Estimate  Std.Err  z-value  P(&gt;|z|)
##   g_factor_2007_young =~                                    
##     raven_2007_yng          0.694       NA                  
##     math_2007_yong          0.694       NA                  
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .raven_2007_yng    0.518       NA                  
##    .math_2007_yong    0.518       NA                  
##     g_fctr_2007_yn    1.000</code></pre>
<pre class="r"><code>nomiss$g_factor_2007_young = predict(cfa_g)[,1]

qplot(nomiss$g_factor_2007_young)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-5-12.png" width="672" /></p>
<pre class="r"><code>nomiss = nomiss %&gt;% select(pidlink, g_factor_2007_young)

iq = left_join(iq, nomiss, by = &quot;pidlink&quot;)</code></pre>
</div>
</div>
<div id="personality" class="section level2">
<h2>Personality</h2>
<pre class="r"><code>### Personality
##Rearrange personality data so that every individual has only one row
pers = spread(b3b_psn, psntype, psn01)
##name columns
colnames(pers) &lt;- c(&quot;hhid14_9&quot;, &quot;pid14&quot;, &quot;hhid14&quot;, &quot;pidlink&quot;, &quot;version&quot;, &quot;module&quot;, &quot;e1&quot;, &quot;c1&quot;, &quot;o1&quot;, &quot;e2r&quot;, &quot;n1r&quot;, &quot;a1&quot;, &quot;n2r&quot;, &quot;o2&quot;, &quot;c2r&quot;, &quot;o3&quot;, &quot;a2&quot;, &quot;c3&quot;, &quot;e3&quot;, &quot;a3r&quot;, &quot;n3&quot;)
pers = pers %&gt;% select(hhid14_9, pidlink, e1, c1, o1, e2r, n1r, a1, n2r, o2, c2r, o3, a2, c3, e3, a3r, n3)

##Extraversion
pers$e2r_reversed = 6 - pers$e2r
extraversion = pers %&gt;% select(e1, e2r_reversed, e3)
psych::alpha(data.frame(extraversion), check.keys = T)</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(extraversion), check.keys = T)
## 
##   raw_alpha std.alpha G6(smc) average_r  S/N    ase mean   sd
##       0.37      0.35    0.28      0.15 0.54 0.0056  3.4 0.67
## 
##  lower alpha upper     95% confidence boundaries
## 0.36 0.37 0.38 
## 
##  Reliability if an item is dropped:
##              raw_alpha std.alpha G6(smc) average_r   S/N alpha se
## e1               0.072     0.081   0.042     0.042 0.088   0.0092
## e2r_reversed     0.218     0.246   0.140     0.140 0.326   0.0077
## e3               0.429     0.429   0.273     0.273 0.753   0.0064
## 
##  Item statistics 
##                  n raw.r std.r r.cor r.drop mean   sd
## e1           31446  0.77  0.71  0.48   0.30  3.1 1.14
## e2r_reversed 31446  0.73  0.67  0.37   0.24  3.0 1.12
## e3           31446  0.44  0.60  0.19   0.11  4.2 0.67
## 
## Non missing response frequency for each item
##                 1    2    3    4    5 miss
## e1           0.03 0.39 0.08 0.39 0.11    0
## e2r_reversed 0.07 0.36 0.09 0.43 0.05    0
## e3           0.00 0.03 0.05 0.64 0.28    0</code></pre>
<pre class="r"><code>pers$big5_ext = rowMeans(extraversion)
qplot(pers$big5_ext)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/select%20pesonality%20data-1.png" width="672" /></p>
<pre class="r"><code>##conscientiousness
pers$c2r_reversed = 6 - pers$c2r
conscientiousness = pers %&gt;% select(c1, c2r_reversed, c3)
psych::alpha(data.frame(conscientiousness), check.keys = T)</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(conscientiousness), check.keys = T)
## 
##   raw_alpha std.alpha G6(smc) average_r  S/N   ase mean   sd
##       0.29      0.31    0.24      0.13 0.45 0.007  3.8 0.55
## 
##  lower alpha upper     95% confidence boundaries
## 0.27 0.29 0.3 
## 
##  Reliability if an item is dropped:
##              raw_alpha std.alpha G6(smc) average_r  S/N alpha se
## c1                0.10      0.10   0.054     0.054 0.11   0.0101
## c2r_reversed      0.35      0.36   0.219     0.219 0.56   0.0071
## c3                0.20      0.21   0.116     0.116 0.26   0.0087
## 
##  Item statistics 
##                  n raw.r std.r r.cor r.drop mean   sd
## c1           31446  0.61  0.69  0.42   0.23  4.1 0.71
## c2r_reversed 31446  0.65  0.60  0.19   0.10  3.6 0.95
## c3           31446  0.67  0.65  0.34   0.17  3.8 0.90
## 
## Non missing response frequency for each item
##                 1    2    3    4    5 miss
## c1           0.01 0.04 0.04 0.66 0.25    0
## c2r_reversed 0.03 0.18 0.07 0.65 0.07    0
## c3           0.01 0.12 0.08 0.63 0.15    0</code></pre>
<pre class="r"><code>pers$big5_con = rowMeans(conscientiousness)
qplot(pers$big5_con)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/select%20pesonality%20data-2.png" width="672" /></p>
<pre class="r"><code>##Openness
openness = pers %&gt;% select(o1, o2, o3)
psych::alpha(data.frame(openness), check.keys = T)</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(openness), check.keys = T)
## 
##   raw_alpha std.alpha G6(smc) average_r  S/N    ase mean   sd
##       0.45      0.45    0.35      0.21 0.81 0.0054  3.7 0.67
## 
##  lower alpha upper     95% confidence boundaries
## 0.43 0.45 0.46 
## 
##  Reliability if an item is dropped:
##    raw_alpha std.alpha G6(smc) average_r  S/N alpha se
## o1      0.30      0.30    0.18      0.18 0.43   0.0078
## o2      0.39      0.39    0.25      0.25 0.65   0.0068
## o3      0.35      0.36    0.22      0.22 0.55   0.0073
## 
##  Item statistics 
##        n raw.r std.r r.cor r.drop mean   sd
## o1 31446  0.71  0.71  0.45   0.30  3.7 0.98
## o2 31446  0.70  0.67  0.37   0.25  3.5 1.05
## o3 31446  0.65  0.69  0.41   0.27  4.0 0.88
## 
## Non missing response frequency for each item
##       1    2    3    4    5 miss
## o1 0.02 0.18 0.08 0.58 0.14    0
## o2 0.03 0.22 0.09 0.54 0.12    0
## o3 0.01 0.10 0.05 0.61 0.23    0</code></pre>
<pre class="r"><code>pers$big5_open = rowMeans(openness)
qplot(pers$big5_open)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/select%20pesonality%20data-3.png" width="672" /></p>
<pre class="r"><code>## Neuroticism
pers$n1r_reversed = 6 - pers$n1r
pers$n2r_reversed = 6 - pers$n2r
neuroticism = pers %&gt;% select(n1r_reversed, n2r_reversed, n3)
pers$big5_neu = rowMeans(neuroticism)
qplot(pers$big5_neu)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/select%20pesonality%20data-4.png" width="672" /></p>
<pre class="r"><code>##Agreeableness
pers$a3r_reversed = 6- pers$a3r
agreeableness= pers %&gt;% select(a1, a2, a3r_reversed)
pers$big5_agree = rowMeans(agreeableness)
qplot(pers$big5_agree)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/select%20pesonality%20data-5.png" width="672" /></p>
</div>
<div id="risk-preference" class="section level2">
<h2>Risk preference</h2>
<pre class="r"><code>###Risktaking
risk = b3a_si %&gt;% select(hhid14_9, pidlink, random_si, si01, si02, si03, si04, si05, si11, si12, si13, si14, si15)

## 8 means they didnt know which answer they would choose
risk$si01[ risk$si01 == 8] = NA
risk$si02[ risk$si02 == 8] = NA
risk$si03[ risk$si03 == 8] = NA
risk$si04[ risk$si04 == 8] = NA
risk$si05[ risk$si05 == 8] = NA
risk$si11[ risk$si11 == 8] = NA
risk$si12[ risk$si12 == 8] = NA
risk$si13[ risk$si13 == 8] = NA
risk$si14[ risk$si14 == 8] = NA
risk$si15[ risk$si15 == 8] = NA

## calculate a risk score for risk game A 
# (5 = gamble averse, Ordinalskala : 1 = risk loving, 4 = risk averse)
risk$riskA = ifelse(risk$si01 == 1 &amp; risk$si02 == 1, 5,
             ifelse(risk$si01 == 2 &amp; risk$si03 == 1 &amp; risk$si04 == 1, 4,
             ifelse(risk$si01 == 2 &amp; risk$si03 == 1 &amp; risk$si04 == 2, 3,
             ifelse(risk$si01 == 2 &amp; risk$si03 == 2 &amp; risk$si05 == 1, 2,
             ifelse(risk$si01 == 2 &amp; risk$si03 == 2 &amp; risk$si05 == 2, 1,
             NA)))))

## calculate a risk score for risk game B 
# (5 = gamble loving, Ordinalskala : 1 = risk loving, 4 = risk averse)
risk$riskB = ifelse(risk$si11 == 2 &amp; risk$si12 == 1, 5,
             ifelse(risk$si11 == 1 &amp; risk$si13 == 1 &amp; risk$si14 == 1, 4,
             ifelse(risk$si11 == 1 &amp; risk$si13 == 1 &amp; risk$si14 == 2, 3,
             ifelse(risk$si11 == 1 &amp; risk$si13 == 2 &amp; risk$si15 == 1, 2,
             ifelse(risk$si11 == 1 &amp; risk$si13 == 2 &amp; risk$si15 == 2, 1,
             NA)))))

# risk variable is messy
risk = risk %&gt;%
  mutate(riskB = ifelse(riskB == 5, 0, riskB),
         riskB = riskB + 1)

psych::alpha(data.frame(risk %&gt;% select(riskA, riskB)), check.keys = T)</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = data.frame(risk %&gt;% select(riskA, riskB)), check.keys = T)
## 
##   raw_alpha std.alpha G6(smc) average_r  S/N    ase mean  sd
##        0.4       0.4    0.25      0.25 0.67 0.0067  3.8 1.2
## 
##  lower alpha upper     95% confidence boundaries
## 0.39 0.4 0.41 
## 
##  Reliability if an item is dropped:
##       raw_alpha std.alpha G6(smc) average_r S/N alpha se
## riskA      0.25      0.25   0.062      0.25  NA       NA
## riskB      0.25      0.25   0.062      0.25  NA       NA
## 
##  Item statistics 
##           n raw.r std.r r.cor r.drop mean  sd
## riskA 27780  0.81  0.79   0.4   0.25  3.4 1.5
## riskB 29578  0.80  0.79   0.4   0.25  4.2 1.4
## 
## Non missing response frequency for each item
##          1    2    3    4    5 miss
## riskA 0.19 0.12 0.11 0.24 0.33 0.12
## riskB 0.13 0.04 0.02 0.11 0.70 0.07</code></pre>
</div>
<div id="educational-attainment" class="section level2">
<h2>Educational Attainment</h2>
<pre class="r"><code># Select, rename and mutate data
ea = b3a_dl1 %&gt;%
  select(pidlink, dl04, dl06, dl07, dl07a, dl07aa) %&gt;%
  rename(pidlink = pidlink, attended_school = dl04, highest_education = dl06,
         highest_grade=dl07, currently_attending_school = dl07a, hours_in_class = dl07aa) %&gt;%
  mutate(attended_school = as.factor(ifelse(attended_school == 8, NA,
                                            ifelse(attended_school == 1, &quot;yes&quot;,
                                                   ifelse(attended_school == 3, &quot;no&quot;,
                                                          attended_school)))),
         highest_education = as.factor(ifelse(highest_education == 2 | highest_education == 72,
                                                     &quot;Elementary&quot;,
                                                     ifelse(highest_education == 3 |
                                                              highest_education == 4 |
                                                              highest_education == 73,
                                                            &quot;Junior High&quot;,
                                                            ifelse(highest_education == 5 |
                                                                     highest_education == 6 |
                                                                     highest_education == 74,
                                                                   &quot;Senior High&quot;,
                                                                   ifelse(highest_education == 60 |
                                                                            highest_education == 61 |
                                                                            highest_education == 62 |
                                                                            highest_education == 63 |
                                                                            highest_education == 13,
                                                                          &quot;University&quot;, NA))))),#&quot;other&quot; = NA
         highest_grade = ifelse(highest_grade == 98, NA,
                                ifelse(highest_grade == 99, NA, highest_grade)),
         currently_attending_school = as.factor(ifelse(currently_attending_school == 1, &quot;yes&quot;,
                                                       ifelse(currently_attending_school == 3, &quot;no&quot;, NA))),
         hours_in_class = ifelse(hours_in_class == 99, NA,
                                 ifelse(hours_in_class == 98, NA, hours_in_class)))

## Create variable that includes years of education (highest_education.highest_grade) as a numeric variable
ea = ea %&gt;%
  mutate(years_of_education_factor = as.factor(str_c(highest_education, &quot;.&quot;, highest_grade)),
         years_of_education = as.numeric(ifelse(attended_school == &quot;no&quot;, 0,
                                         ifelse(years_of_education_factor == &quot;Elementary.0&quot;, 0.5,
                                         ifelse(years_of_education_factor == &quot;Elementary.1&quot;, 1,
                                         ifelse(years_of_education_factor == &quot;Elementary.2&quot;, 2,
                                         ifelse(years_of_education_factor == &quot;Elementary.3&quot;, 3,
                                         ifelse(years_of_education_factor == &quot;Elementary.4&quot;, 4,
                                         ifelse(years_of_education_factor == &quot;Elementary.5&quot;, 5,
                                         ifelse(years_of_education_factor == &quot;Elementary.6&quot;, NA,
                                         ifelse(years_of_education_factor == &quot;Elementary.7&quot;, 6,
                                         ifelse(years_of_education_factor == &quot;Junior High.0&quot;, 6.5,
                                         ifelse(years_of_education_factor == &quot;Junior High.1&quot;, 7,
                                         ifelse(years_of_education_factor == &quot;Junior High.2&quot;, 8,
                                         ifelse(years_of_education_factor == &quot;Junior High.3&quot;, NA,
                                         ifelse(years_of_education_factor == &quot;Junior High.7&quot;, 9,
                                         ifelse(years_of_education_factor == &quot;Senior High.0&quot;, 9.5,
                                         ifelse(years_of_education_factor == &quot;Senior High.1&quot;, 10,
                                         ifelse(years_of_education_factor == &quot;Senior High.2&quot;, 11,
                                         ifelse(years_of_education_factor == &quot;Senior High.3&quot;, NA,
                                         ifelse(years_of_education_factor == &quot;Senior High.7&quot;, 12,
                                         ifelse(years_of_education_factor == &quot;University.0&quot;, 12.5,
                                         ifelse(years_of_education_factor == &quot;University.1&quot;, 13,
                                         ifelse(years_of_education_factor == &quot;University.2&quot;, 14,
                                         ifelse(years_of_education_factor == &quot;University.3&quot;, 15,
                                         ifelse(years_of_education_factor == &quot;University.4&quot;, 16,
                                         ifelse(years_of_education_factor == &quot;University.5&quot;, 17,
                                         ifelse(years_of_education_factor == &quot;University.6&quot;, NA,
                                         ifelse(years_of_education_factor == &quot;University.7&quot;, 18,
                                                NA)))))))))))))))))))))))))))))
qplot(ea$years_of_education)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 646 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/select%20educational%20attainment%20data-1.png" width="672" /></p>
</div>
<div id="ebtanasuanun-score" class="section level2">
<h2>EBTANAS/UAN/UN Score</h2>
<pre class="r"><code>EBTANAS_long = b3a_dl3 %&gt;%
  select(pidlink, &quot;Level_of_schooling&quot; = dl3type, &quot;Type_of_test&quot; = dl16c1, &quot;Indonesia_score&quot; = dl16db,
         &quot;English_score&quot; = dl16dc, &quot;Math_score&quot; = dl16dd, &quot;Total_score&quot; = dl16e) %&gt;%
  mutate(Level_of_schooling = ifelse(Level_of_schooling == 1, &quot;Elementary&quot;,
                                     ifelse(Level_of_schooling == 2, &quot;Junior High&quot;,
                                            ifelse(Level_of_schooling == 3, &quot;Senior High&quot;, NA))),
         Type_of_test = ifelse(Type_of_test == 1, &quot;EBTANAS&quot;,
                               ifelse(Type_of_test == 2, &quot;UAN/UN&quot;, NA))) %&gt;%
  filter(!is.na(Indonesia_score) | !is.na(English_score) | !is.na(Math_score) | !is.na(Total_score))
  # remove people with no EBTANAS Information

#Wrangle Data
EBTANAS_Elemenatry = EBTANAS_long %&gt;%
  filter(Level_of_schooling == &quot;Elementary&quot;) %&gt;%
  rename(&quot;Indonesia_score_elementary&quot; = Indonesia_score, &quot;English_score_elementary&quot; = English_score,
         &quot;Math_score_elemenatry&quot; = Math_score, &quot;Total_score_elemenatry&quot; = Total_score,
         &quot;Type_of_test_elementary&quot; = Type_of_test) %&gt;%
  select(-Level_of_schooling)

EBTANAS_Junior_High = EBTANAS_long %&gt;%
  filter(Level_of_schooling == &quot;Junior High&quot;) %&gt;%
  rename(&quot;Indonesia_score_Junior_High&quot; = Indonesia_score, &quot;English_score_Junior_High&quot; = English_score,
         &quot;Math_score_Junior_High&quot; = Math_score, &quot;Total_score_Junior_High&quot; = Total_score,
         &quot;Type_of_test_Junior_High&quot; = Type_of_test)%&gt;%
  select(-Level_of_schooling)

EBTANAS_Senior_High = EBTANAS_long %&gt;%
  filter(Level_of_schooling == &quot;Senior High&quot;) %&gt;%
  rename(&quot;Indonesia_score_Senior_High&quot; = Indonesia_score, &quot;English_score_Senior_High&quot; = English_score,
         &quot;Math_score_Senior_High&quot; = Math_score, &quot;Total_score_Senior_High&quot; = Total_score,
         &quot;Type_of_test_Senior_High&quot; = Type_of_test)%&gt;%
  select(-Level_of_schooling)

EBTANAS = full_join(EBTANAS_Elemenatry, EBTANAS_Junior_High, by = &quot;pidlink&quot;)
EBTANAS = full_join(EBTANAS, EBTANAS_Senior_High, by = &quot;pidlink&quot;) 

table(is.na(EBTANAS$Total_score_elemenatry))</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4275</td>
<td align="center">2002</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(is.na(EBTANAS$Total_score_Junior_High))</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">3911</td>
<td align="center">2366</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(is.na(EBTANAS$Total_score_Senior_High))</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2459</td>
<td align="center">3818</td>
</tr>
</tbody>
</table>
<pre class="r"><code>EBTANAS = EBTANAS %&gt;%
  mutate(Total_score_highest = Total_score_elemenatry,
         Total_score_highest = ifelse(!is.na(Total_score_Senior_High), Total_score_Senior_High,
                                      ifelse(!is.na(Total_score_Junior_High), Total_score_Junior_High,
                                             Total_score_highest)),
         Total_score_highest_type = ifelse(!is.na(Total_score_Senior_High), &quot;Senior High&quot;,
                                      ifelse(!is.na(Total_score_Junior_High), &quot;Junior High&quot;,
                                             ifelse(!is.na(Total_score_elemenatry), &quot;Elementary&quot;,
                                                           NA))),
         Math_score_highest = Math_score_elemenatry,
         Math_score_highest = ifelse(!is.na(Math_score_Senior_High), Math_score_Senior_High,
                                      ifelse(!is.na(Math_score_Junior_High), Math_score_Junior_High,
                                             Math_score_highest)),
         Math_score_highest_type = ifelse(!is.na(Math_score_Senior_High), &quot;Senior High&quot;,
                                      ifelse(!is.na(Math_score_Junior_High), &quot;Junior High&quot;,
                                             ifelse(!is.na(Math_score_elemenatry), &quot;Elementary&quot;,
                                                           NA))))
table(is.na(EBTANAS$Total_score_highest))</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">5801</td>
<td align="center">476</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(is.na(EBTANAS$Math_score_highest))</code></pre>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">FALSE</th>
<th align="center">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">5792</td>
<td align="center">485</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(EBTANAS$Total_score_highest_type)</code></pre>
<table style="width:57%;">
<colgroup>
<col width="18%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Elementary</th>
<th align="center">Junior High</th>
<th align="center">Senior High</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1042</td>
<td align="center">2300</td>
<td align="center">2459</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(EBTANAS$Math_score_highest_type)</code></pre>
<table style="width:57%;">
<colgroup>
<col width="18%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Elementary</th>
<th align="center">Junior High</th>
<th align="center">Senior High</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1066</td>
<td align="center">2270</td>
<td align="center">2456</td>
</tr>
</tbody>
</table>
<pre class="r"><code>qplot(EBTANAS$Total_score_highest)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 476 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/EBTANAS/UAN/UN%20Score-1.png" width="672" /></p>
<pre class="r"><code>qplot(EBTANAS$Math_score_highest)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 485 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/EBTANAS/UAN/UN%20Score-2.png" width="672" /></p>
<pre class="r"><code>## Working while still in school
child_labour = b3a_dl4 %&gt;%
  select(pidlink, &quot;Level_of_schooling&quot; = dl4type, &quot;Worked&quot; = dl15, &quot;Missed_school&quot; = dl14a) %&gt;%
  mutate(Level_of_schooling = ifelse(Level_of_schooling == 1, &quot;Elementary&quot;,
                                     ifelse(Level_of_schooling == 2, &quot;JuniorHigh&quot;,
                                            ifelse(Level_of_schooling == 3, &quot;SeniorHigh&quot;,
                                                   ifelse(Level_of_schooling == 4, &quot;University&quot;, NA)))),
         Worked = ifelse(Worked == 1, 1,
                         ifelse(Worked == 3, 0, NA)),
         Missed_school = ifelse(Missed_school == 1, 1,
                         ifelse(Missed_school == 3, 0, NA)))

# Wrangle Data
child_labour_work = child_labour %&gt;%
  select(pidlink, Level_of_schooling, Worked) %&gt;%
  spread(., Level_of_schooling, Worked) %&gt;%
  rename(&quot;Elementary_worked&quot; = Elementary, &quot;Junior_high_worked&quot; = JuniorHigh, 
         &quot;Senior_high_worked&quot; = SeniorHigh, &quot;University_worked&quot; = University) %&gt;%
  mutate(total_worked = ifelse(Elementary_worked == 1 | Junior_high_worked == 1 |
                                 Senior_high_worked == 1 | University_worked == 1, 1, 0),
         total_worked  = ifelse(is.na(total_worked), 0, total_worked))

child_labour_missed = child_labour %&gt;%
  select(pidlink, Level_of_schooling, Missed_school) %&gt;%
  spread(., Level_of_schooling, Missed_school) %&gt;%
  rename(&quot;Elementary_missed&quot; = Elementary, &quot;Junior_high_missed&quot; = JuniorHigh, 
         &quot;Senior_high_missed&quot; = SeniorHigh, &quot;University_missed&quot; = University) %&gt;%
  mutate(total_missed = ifelse(Elementary_missed == 1 | Junior_high_missed == 1 |
                                 Senior_high_missed == 1 | University_missed == 1, 1, 0))

child_labour = full_join(child_labour_work, child_labour_missed, by = &quot;pidlink&quot;)
table(child_labour$total_missed)</code></pre>
<table style="width:19%;">
<colgroup>
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2608</td>
<td align="center">1017</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(child_labour$total_worked)</code></pre>
<table style="width:19%;">
<colgroup>
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">9379</td>
<td align="center">3498</td>
</tr>
</tbody>
</table>
</div>
<div id="job-information" class="section level2">
<h2>Job Information</h2>
<pre class="r"><code>job = b3a_tk2 %&gt;% select(pidlink, &quot;Category&quot; = tk24a, &quot;Sector&quot; = tk19ab, &quot;wage_last_month&quot; = tk25a1,
                         &quot;wage_last_year&quot; = tk25a2) %&gt;%
  mutate(Category = ifelse(Category == 1 | Category == 2 | Category == 3, &quot;Self-employed&quot;,
                           ifelse(Category == 4, &quot;Government worker&quot;,
                                  ifelse(Category == 5, &quot;Private worker&quot;,
                                         ifelse(Category == 7, &quot;Casual worker in agriculture&quot;,
                                                ifelse(Category == 8, &quot;Casual worker not in agriculture&quot;,
                                                       ifelse(Category == 6, &quot;Unpaid family worker&quot;,
                                                              NA)))))),
         Self_employed = ifelse(Category == &quot;Self-employed&quot;, 1,
                                ifelse(is.na(Category), NA, 0)),
         Sector = ifelse(Sector == 1, &quot;Agriculture, forestry, fishing and hunting&quot;,
                  ifelse(Sector == 2, &quot;Mining and quarrying&quot;,
                  ifelse(Sector == 3, &quot;Manufacturing&quot;,
                  ifelse(Sector == 4, &quot;Electricity, gas, water&quot;,
                  ifelse(Sector == 5, &quot;Construction&quot;,
                  ifelse(Sector == 6, &quot;Wholesale, retail, restaurants and hotels&quot;,
                  ifelse(Sector == 7, &quot;Transportation, storage and communications&quot;,
                  ifelse(Sector == 8, &quot;Finance, insurance, real estate and business services&quot;,
                  ifelse(Sector == 9, &quot;Social services&quot;,
                  ifelse(Sector == 10, &quot;Activities that cannot be classified&quot;, NA)))))))))),
         wage_last_month = ifelse(wage_last_month == 8, NA, wage_last_month),
         wage_last_year = ifelse(wage_last_year == 8, NA, wage_last_year))

table(job$Category)</code></pre>
<table>
<colgroup>
<col width="24%" />
<col width="17%" />
<col width="15%" />
<col width="13%" />
<col width="12%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Casual worker in agriculture</th>
<th align="center">Casual worker not in agriculture</th>
<th align="center">Government worker</th>
<th align="center">Private worker</th>
<th align="center">Self-employed</th>
<th align="center">Unpaid family worker</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">830</td>
<td align="center">1888</td>
<td align="center">1616</td>
<td align="center">8364</td>
<td align="center">9194</td>
<td align="center">2589</td>
</tr>
</tbody>
</table>
<pre class="r"><code>table(job$Sector)</code></pre>
<table>
<colgroup>
<col width="14%" />
<col width="6%" />
<col width="11%" />
<col width="13%" />
<col width="7%" />
<col width="10%" />
<col width="8%" />
<col width="13%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Agriculture, forestry, fishing and hunting</th>
<th align="center">Construction</th>
<th align="center">Electricity, gas, water</th>
<th align="center">Finance, insurance, real estate and business services</th>
<th align="center">Manufacturing</th>
<th align="center">Mining and quarrying</th>
<th align="center">Social services</th>
<th align="center">Transportation, storage and communications</th>
<th align="center">Wholesale, retail, restaurants and hotels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">5940</td>
<td align="center">29</td>
<td align="center">394</td>
<td align="center">5003</td>
<td align="center">5469</td>
<td align="center">839</td>
<td align="center">1510</td>
<td align="center">787</td>
<td align="center">3754</td>
</tr>
</tbody>
</table>
<pre class="r"><code>qplot(job$wage_last_month)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 11970 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>summary(job$wage_last_month)</code></pre>
<table style="width:92%;">
<colgroup>
<col width="9%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="16%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Min.</th>
<th align="center">1st Qu.</th>
<th align="center">Median</th>
<th align="center">Mean</th>
<th align="center">3rd Qu.</th>
<th align="center">Max.</th>
<th align="center">NAs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">550000</td>
<td align="center">1250000</td>
<td align="center">1923793</td>
<td align="center">2400000</td>
<td align="center">999999997</td>
<td align="center">11970</td>
</tr>
</tbody>
</table>
<pre class="r"><code>x = job %&gt;% filter(wage_last_month &lt; 5000000)
qplot(x$wage_last_month)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre class="r"><code>qplot(job$wage_last_year)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 12064 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<pre class="r"><code>summary(job$wage_last_year)</code></pre>
<table style="width:96%;">
<colgroup>
<col width="9%" />
<col width="13%" />
<col width="15%" />
<col width="15%" />
<col width="15%" />
<col width="16%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Min.</th>
<th align="center">1st Qu.</th>
<th align="center">Median</th>
<th align="center">Mean</th>
<th align="center">3rd Qu.</th>
<th align="center">Max.</th>
<th align="center">NAs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">3960000</td>
<td align="center">12000000</td>
<td align="center">20680463</td>
<td align="center">27000000</td>
<td align="center">999999997</td>
<td align="center">12064</td>
</tr>
</tbody>
</table>
<pre class="r"><code>x = job %&gt;% filter(wage_last_year &lt; 50000000)
qplot(x$wage_last_year)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="1_data_import_files/figure-html/unnamed-chunk-6-4.png" width="672" /></p>
</div>
<div id="health-information---smoking-behavior" class="section level2">
<h2>Health Information - Smoking Behavior</h2>
<pre class="r"><code>smoking = b3b_km %&gt;%
  select(pidlink, &quot;ever_smoked&quot; = km01a, &quot;still_smoking&quot; = km04, &quot;amount&quot; = km08,
         &quot;money_spent_smoking&quot; = km09, &quot;age_first_smoke&quot; = km10) %&gt;%
  mutate(ever_smoked = ifelse(ever_smoked == 1, 1, 0),
         still_smoking = ifelse(still_smoking == 1, 1, 0),
         amount = ifelse(amount == 8, NA,
                         ifelse(amount == 98, NA, amount)),
         amount_still_smokers = ifelse(still_smoking == 1, amount, NA))</code></pre>
</div>
<div id="merge-data" class="section level2">
<h2>Merge data</h2>
<pre class="r"><code>### Merge all data for people with birthorder informations
alldata_birthorder = left_join(alldata_pregnancy, iq, by = &quot;pidlink&quot;)
alldata_birthorder = left_join(alldata_birthorder, pers, by = &quot;pidlink&quot;)</code></pre>
<pre><code>## Warning: Column `pidlink` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code>alldata_birthorder = left_join(alldata_birthorder, risk, by = &quot;pidlink&quot;)
alldata_birthorder = left_join(alldata_birthorder, ea, by = &quot;pidlink&quot;)
alldata_birthorder = left_join(alldata_birthorder, EBTANAS, by = &quot;pidlink&quot;)
alldata_birthorder = left_join(alldata_birthorder, child_labour, by = &quot;pidlink&quot;)</code></pre>
<pre><code>## Warning: Column `pidlink` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code>alldata_birthorder = left_join(alldata_birthorder, job, by = &quot;pidlink&quot;)
alldata_birthorder = left_join(alldata_birthorder, smoking, by = &quot;pidlink&quot;)


alldata = left_join(individuals_unchanged, iq, by = &quot;pidlink&quot;)
alldata = left_join(alldata, pers, by = &quot;pidlink&quot;)</code></pre>
<pre><code>## Warning: Column `pidlink` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code>alldata = left_join(alldata, risk, by = &quot;pidlink&quot;)
alldata = left_join(alldata, ea, by = &quot;pidlink&quot;)
alldata = left_join(alldata, EBTANAS, by = &quot;pidlink&quot;)
alldata = left_join(alldata, child_labour, by = &quot;pidlink&quot;)</code></pre>
<pre><code>## Warning: Column `pidlink` has different attributes on LHS and RHS of join</code></pre>
<pre class="r"><code>alldata = left_join(alldata, job, by = &quot;pidlink&quot;)
alldata = left_join(alldata, smoking, by = &quot;pidlink&quot;)</code></pre>
</div>
<div id="fix-types" class="section level2">
<h2>Fix types</h2>
<pre class="r"><code>alldata_birthorder &lt;- alldata_birthorder %&gt;% 
  mutate_at(vars(age_2015_old, age_2015_young, alive, death_yr, 
                 English_score_elementary, English_score_Junior_High, English_score_Senior_High,
                 Indonesia_score_elementary, Indonesia_score_Junior_High, Indonesia_score_Senior_High,
                 Math_score_elemenatry, Math_score_Junior_High, Math_score_Senior_High, 
                 ), funs(as.numeric)) %&gt;% 
  mutate_at(vars(Math_score_highest_type, Total_score_highest_type, mother_pidlink, father_pidlink, marriage_id, pidlink,  random_si,
                 Sector, Type_of_test_elementary, Type_of_test_Junior_High, Type_of_test_Senior_High, lifebirths, Category
                 ), funs(as.factor)) %&gt;% 
  mutate(male = if_else(sex == 1, 1L, 0L),
         wage_last_month_log = log(wage_last_month+1),
         wage_last_year_log = log(wage_last_year+1),
         money_spent_smoking_log = log(money_spent_smoking+1)) %&gt;% 
  mutate_at(vars(alive, Elementary_missed, Elementary_worked, ever_smoked, Junior_high_missed, Junior_high_worked, Self_employed, total_missed,
                 Senior_high_missed, Senior_high_worked,
                 still_smoking, University_missed, University_worked, wave), funs(as.integer)) %&gt;% 
  mutate_at(vars(birthdate), funs(as.Date)) %&gt;% 
    select(-motherID, -fatherID, -mother_birthorder, -mother_birthdate, -month, -end, -start, -gender, -sex, -sex_2015_old, -sex_2015_young,
           -relation_to_HH_head, -years_of_education_factor, -birthdate_duped_in_earlier_wave, -birthorder_duped_in_earlier_wave, -birthorder_naive_ind,
           -order_marriage, -matches(&quot;^si[0-9]+$&quot;),  -matches(&quot;^[a-z][0-9]r?$&quot;),  -matches(&quot;^[a-z][0-9]r_reversed$&quot;),
           -ar08day, -ar08mth, -ar08yr, -birth_day, -birth_month, -birth_year, -highest_grade, -wage_last_month, -wage_last_year, -status,
           -money_spent_smoking, -starts_with(&quot;hhid14_&quot;), sc05, province, sc01_14_14)</code></pre>
</div>
<div id="save-data" class="section level2">
<h2>Save data</h2>
<p>for future analyses</p>
<pre class="r"><code>alldata_birthorder = alldata_birthorder %&gt;% ungroup()
alldata = alldata %&gt;% ungroup()
pregnancy = pregnancy %&gt;% ungroup()
iq = iq %&gt;% ungroup()

saveRDS(alldata_birthorder, file = &quot;data/alldata_birthorder.rds&quot;)
saveRDS(alldata, file = &quot;data/alldata.rds&quot;)
saveRDS(pregnancy, file = &quot;data/pregnancy.rds&quot;)
saveRDS(iq, file = &quot;data/iq.rds&quot;)</code></pre>
</div>
</div>

<div id="rmd-source-code">LS0tCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgY29kZV9mb2xkaW5nOiAic2hvdyIKZWRpdG9yX29wdGlvbnM6IAogIGNodW5rX291dHB1dF90eXBlOiBjb25zb2xlCi0tLQoKIyAgPHNwYW4gc3R5bGU9ImNvbG9yOiNGQzhENjIiPkRhdGEgV3JhbmdsaW5nPC9zcGFuPiB7LnRhYnNldH0KCiMjIEhlbHBlcgpgYGB7ciBoZWxwZXJ9CnNvdXJjZSgiMF9oZWxwZXJzLlIiKQpgYGAKCgojIyBJbXBvcnQgZGF0YSB7LmFjdGl2ZX0KCkFsbCBkYXRhIGlzIHJldHJpZXZlZCBmcm9tIHRoZSBbUkFORCBmb3VuZGF0aW9uXShodHRwOi8vd3d3LnJhbmQub3JnL2xhYm9yL0ZMUy9JRkxTLmh0bWwpIApgYGB7ciBJbXBvcnQgZGF0YX0KIyMjIEluZm9ybWF0aW9ucyBhYm91dCBpbmRpdmlkdWFscyBsaXZpbmcgaW4gdGhlIGhvdXNlaG9sZCBpbiAyMDE0LzIwMTUKIyMgQWxsIEluZGl2aWR1YWxzIGxpdmluZyBpbiB0aGUgaG91c2Vob2xkCmJrX2FyMSA9IHJlYWRfZHRhKCJkYXRhL2hoMTRfYWxsX2R0YS9ia19hcjEuZHRhIikgIyBCb29rIEssIFNlY3Rpb24gYXIKIyBjb21wdXRlIGZhdGhlciBwaWRsaW5rCmJrX2FyMSA9IGxlZnRfam9pbihia19hcjEsIGJrX2FyMSAlPiUgc2VsZWN0KGhoaWQxNF85LCBwaWQxNCwgcGlkbGluaykgJT4lIHJlbmFtZShhcjEwID0gcGlkMTQsIGZhdGhlcl9waWRsaW5rID0gcGlkbGluayksIGJ5ID0gYygiaGhpZDE0XzkiLCAiYXIxMCIpKQojIGNvbXB1dGUgbW90aGVyIHBpZGxpbmsKYmtfYXIxID0gbGVmdF9qb2luKGJrX2FyMSwgYmtfYXIxICU+JSBzZWxlY3QoaGhpZDE0XzksIHBpZDE0LCBwaWRsaW5rKSAlPiUgcmVuYW1lKGFyMTEgPSBwaWQxNCwgbW90aGVyX3BpZGxpbmsgPSBwaWRsaW5rKSwgYnkgPSBjKCJoaGlkMTRfOSIsICJhcjExIikpCmJrX3NjMSA9IHJlYWRfZHRhKCJkYXRhL2hoMTRfYWxsX2R0YS9ia19zYzEuZHRhIikgIyBMb2NhdGlvbiBpbmZvCmJrX3NjMSA8LSBia19zYzEgJT4lIG11dGF0ZShwcm92aW5jZSA9IHN0cl90cmltKHJlY29kZShia19zYzEkc2MwMV8xNF8xNCwgIGAxMWAgPSAnTi4gQWNlaCBEYXJ1c3NhbGFtJywKIGAxMmAgPSAnTm9ydGggU3VtYXRlcmEgICcsCiBgMTNgID0gJ1dlc3QgU3VtYXRlcmEnLAogYDE0YCA9ICdSaWF1ICAnLAogYDE1YCA9ICdKYW1iaSAnLAogYDE2YCA9ICdTb3V0aCBTdW1hdGVyYSAgJywKIGAxN2AgPSAnQmVuZ2t1bHUnLAogYDE4YCA9ICdMYW1wdW5nICcsCiBgMTlgID0gJ0JhbmdrYSBCZWxpdHVuZyAnLAogYDMxYCA9ICdKYWthcnRhICcsCiBgMzJgID0gJ1dlc3QgSmF2YSAgJywKIGAzM2AgPSAnQ2VudHJhbCBKYXZhICcsCiBgMzRgID0gJ0RJIFlvZ3lha2FydGEnLAogYDM1YCA9ICdFYXN0IEphdmEgICcsCiBgMzZgID0gJ0JhbnRlbicsCiBgNTFgID0gJ0JhbGkgICcsCiBgNTJgID0gJ1dlc3QgTnVzYSBUZW5nZ2FyYScsCiBgNTNgID0gJ0Vhc3QgTnVzYSBUZW5nZ2FyYScsCiBgNjFgID0gJ1dlc3QgS2FsaW1hbnRhbiAnLAogYDYyYCA9ICdDZW50cmFsIEthbGltYW50YW4nLAogYDYzYCA9ICdTb3V0aCBLYWxpbWFudGFuJywKIGA2NGAgPSAnRWFzdCBLYWxpbWFudGFuICcsCiBgNzFgID0gJ05vcnRoIFN1bGF3ZXNpICAnLAogYDcyYCA9ICdDZW50cmFsIFN1bGF3ZXNpJywKIGA3M2AgPSAnU291dGggU3VsYXdlc2kgICcsCiBgNzRgID0gJ1NvdXRoZWFzdCBTdWxhd2VzaScsCiBgODFgID0gJ01hbHVrdScsCiBgOTRgID0gJ1BhcHVhICcsCiBgOThgID0gTkFfY2hhcmFjdGVyXywKIGA5OWAgPSBOQV9jaGFyYWN0ZXJfLCAuZGVmYXVsdCA9IE5BX2NoYXJhY3Rlcl8pKSkKCiMjIyBJbmZvcm1hdGlvbnMgZnJvbSBJRkxTIHdhdmUgNSB0byBsaW5rIGRhdGEgdG8gZWFybGllciB3YXZlczoKcHRyYWNrID0gcmVhZF9kdGEoImRhdGEvaGgxNF9hbGxfZHRhL3B0cmFjay5kdGEiKSAjIFRyYWNraW5nIGluZm9ybWF0aW9ucwoKIyMjIFByZWduYW5jeSBJbmZvcm1hdGlvbnMgZnJvbSBtb3RoZXIKIyMgV2F2ZSA1IC0gMjAxNAp3NV9wcmVnbmFuY3kgPSByZWFkX2R0YSgiZGF0YS9oaDE0X2FsbF9kdGEvYjRfY2gxLmR0YSIpICMgQm9vayA0LCBTZWN0aW9uIGNoCiMjIFdhdmUgNCAtIDIwMDcKdzRfcHJlZ25hbmN5ID0gcmVhZF9kdGEoImRhdGEvaGgwN19hbGxfZHRhL2I0X2NoMS5kdGEiKSAjIEJvb2sgNCwgU2VjdGlvbiBjaAojIyBXYXZlIDMgLSAyMDAwCnczX3ByZWduYW5jeSA9IHJlYWRfZHRhKCJkYXRhL2hoMDBfYWxsX2R0YS9iNF9jaDEuZHRhIikgIyBCb29rIDQsIFNlY3Rpb24gY2gKIyMgV2F2ZSAyIC0gMTk5Nwp3Ml9wcmVnbmFuY3kgPSByZWFkX2R0YSgiZGF0YS9oaDk3ZHRhL2I0X2NoMS5kdGEiKSAjIEJvb2sgNCwgU2VjdGlvbiBjaAojIyBXYXZlIDEgLSAxOTkzCncxX3ByZWduYW5jeSA9IHJlYWRfZHRhKCJkYXRhL2hoOTNkdGEvYnVrNGNoMS5kdGEiKSAjIEJvb2sgNCwgU2VjdGlvbiBjaAoKIyMjIE1hcnJpYWdlIGluZm9ybWF0aW9uIGZyb20gbW90aGVyCiMjIFdhdmUgNSAtIDIwMTQKdzVfbWFycmlhZ2U9IHJlYWRfZHRhKCJkYXRhL2hoMTRfYWxsX2R0YS9iNF9rdzMuZHRhIikgIyBCb29rIDQsIFNlY3Rpb24ga3czCiMjIFdhdmUgNCAtIDIwMDcKdzRfbWFycmlhZ2UgPSByZWFkX2R0YSgiZGF0YS9oaDA3X2FsbF9kdGEvYjRfa3cyLmR0YSIpICMgQm9vayA0LCBTZWN0aW9uIGt3MgojIyBXYXZlIDMgLSAyMDAwCnczX21hcnJpYWdlID0gcmVhZF9kdGEoImRhdGEvaGgwMF9hbGxfZHRhL2I0X2t3My5kdGEiKSAjIEJvb2sgNCwgU2VjdGlvbiBrdzMKIyMgV2F2ZSAyIC0gMTk5Nwp3Ml9tYXJyaWFnZSA9IHJlYWRfZHRhKCJkYXRhL2hoOTdkdGEvYjRfa3cyLmR0YSIpICMgQm9vayA0LCBTZWN0aW9uIGt3MgojIyBXYXZlIDEgLSAxOTkzCncxX21hcnJpYWdlID0gcmVhZF9kdGEoImRhdGEvaGg5M2R0YS9idWs0a3cyLmR0YSIpICMgQm9vayA0LCBTZWN0aW9uIGt3MgoKIyMgQWRkaXRpb25hbCBtYXJyaWFnZSBpbmZvcm1hdGlvbiBmcm9tIG1vdGhlcgojIFdhdmUgNSAtIDIwMTQKdzVfbWFycmlhZ2VfYWRkaXRpb25hbCA9IHJlYWRfZHRhKCJkYXRhL2hoMTRfYWxsX2R0YS9iNF9jb3YuZHRhIikgIyBCb29rIDQsIFNlY3Rpb24gY292CiMgV2F2ZSA0IC0gMjAwNwp3NF9tYXJyaWFnZV9hZGRpdGlvbmFsID0gcmVhZF9kdGEoImRhdGEvaGgwN19hbGxfZHRhL2I0X2Nvdi5kdGEiKSAjIEJvb2sgNCwgU2VjdGlvbiBjb3YKIyBXYXZlIDMgLSAyMDAwCnczX21hcnJpYWdlX2FkZGl0aW9uYWwgPSByZWFkX2R0YSgiZGF0YS9oaDAwX2FsbF9kdGEvYjRfY292LmR0YSIpICMgQm9vayA0LCBTZWN0aW9uIGNvdgojIFdhdmUgMiAtIDE5OTcKdzJfbWFycmlhZ2VfYWRkaXRpb25hbCA9IHJlYWRfZHRhKCJkYXRhL2hoOTdkdGEvYjRfY292LmR0YSIpICMgQm9vayA0LCBTZWN0aW9uIGNvdgojIFdhdmUgMSAtIDE5OTMKdzFfbWFycmlhZ2VfYWRkaXRpb25hbCA9IHJlYWRfZHRhKCJkYXRhL2hoOTNkdGEvYnVra2FyMi5kdGEiKSAjIEJvb2sgSywgU2VjdGlvbiBhciwgaG91c2Vob2xkIHJvYXN0ZXIKCiMjIyBJUSBJbmZvcm1hdGlvbgpla19lazIgPSByZWFkX2R0YSgiZGF0YS9oaDE0X2FsbF9kdGEvZWtfZWsyLmR0YSIpICMgQm9vayBlazI6ID4xNSB5ZWFycwpla19lazEgPSByZWFkX2R0YSgiZGF0YS9oaDE0X2FsbF9kdGEvZWtfZWsxLmR0YSIpICMgQm9vayBlazE6IDwxNSB5ZWFycwojIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gKGNvdW50aW5nIGJhY2t3YXJkcywgYWRhcHRpdmUgdGVzdGluZykgZm9yIGFkdWx0cwpiM2JfY29iID0gcmVhZF9kdGEoImRhdGEvaGgxNF9hbGxfZHRhL2IzYl9jb2IuZHRhIikgIyBCb29rIDNiLCBTZWN0aW9uIGNvYgpiM2JfY28xID0gcmVhZF9kdGEoImRhdGEvaGgxNF9hbGxfZHRhL2IzYl9jbzEuZHRhIikgIyBCb29rIDNiLCBTZWN0aW9uIGNvMQojIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gZnJvbSBlYXJsaWVyIHdhdmVzCmJla19lazEgPSByZWFkX2R0YSgiZGF0YS9oaDA3X2FsbF9kdGEvYmVrX2VrMS5kdGEiKSAjIEludGVsbGlnZW5jZSBpbmZvcm1hdGlvbiBmcm9tIHdhdmUgNCAoMjAwNyk6IDctMTQKYmVrX2VrMiA9IHJlYWRfZHRhKCJkYXRhL2hoMDdfYWxsX2R0YS9iZWtfZWsyLmR0YSIpICMgSW50ZWxsaWdlbmNlIGluZm8gZnJvbSB3YXZlIDQgKDIwMDcpOiAxNSAtIDI0CmJlazAwID0gcmVhZF9kdGEoImRhdGEvaGgwMF9hbGxfZHRhL2Jlay5kdGEiKSAjIEludGVsbGlnZW5jZSBpbmZvcm1hdGlvbiBmcm9tIHdhdmUgMyAoMjAwMCkKYmVrOTcgPSByZWFkX2R0YSgiZGF0YS9oaDk3ZHRhL2Jlay5kdGEiKSAjSW50ZWxsaWdlbmNlIGluZm9ybWF0aW9uIGZyb20gd2F2ZSAyICgxOTk3KQoKCiMjIyBQZXJzb25hbGl0eSBJbmZvcm1hdGlvbiAob25seSBmb3IgYWR1bHRzKQpiM2JfcHNuID0gcmVhZF9kdGEoImRhdGEvaGgxNF9hbGxfZHRhL2IzYl9wc24uZHRhIikgIyBCb29rIDNiLCBTZWN0aW9uIHBzbgoKIyMjIFJpc2sgdGFraW5nCmIzYV9zaSA9IHJlYWRfZHRhKCJkYXRhL2hoMTRfYWxsX2R0YS9iM2Ffc2kuZHRhIikgIyBCb29rIDNhLCBTZWN0aW9uIHNpCgojIyMgRWR1Y2F0aW9uYWwgQXR0YWlubWVudApiM2FfZGwxID0gcmVhZF9kdGEoImRhdGEvaGgxNF9hbGxfZHRhL2IzYV9kbDEuZHRhIikgIyBCb29rIDNhLCBTZWN0aW9uIGRsMQoKIyMjIEVCVEFOQVMvVUFOL1VOIFNjb3JlCmIzYV9kbDMgPSByZWFkX2R0YSgiZGF0YS9oaDE0X2FsbF9kdGEvYjNhX2RsMy5kdGEiKSAjIEJvb2sgM2EsIFNlY3Rpb24gZGwzCmIzYV9kbDQgPSByZWFkX2R0YSgiZGF0YS9oaDE0X2FsbF9kdGEvYjNhX2RsNC5kdGEiKSAjIEJvb2sgM2EsIFNlY3Rpb24gZGw0CgojIyMgSm9iIEluZm9ybWF0aW9uCmIzYV90azIgPSByZWFkX2R0YSgiZGF0YS9oaDE0X2FsbF9kdGEvYjNhX3RrMi5kdGEiKSAjIEJvb2sgM2EsIFNlY3Rpb24gdGsyCgojIyMgU21va2luZyBiZWhhdmlvcgpiM2Jfa20gPSByZWFkX2R0YSgiZGF0YS9oaDE0X2FsbF9kdGEvYjNiX2ttLmR0YSIpICMgQm9vayAzYiwgU2VjdGlvbiBrbQpgYGAKCiMjIEJpcnRoIG9yZGVyIGluZm9ybWF0aW9uIHsudGFic2V0fQojIyMgSW5mb3JtYXRpb24gYWJvdXQgcHJlZ25hbmN5CmBgYHtyfQojIyBTZWxlY3QgZGF0YQp3NV9wcmVnbmFuY3kgPSB3NV9wcmVnbmFuY3kgJT4lIHNlbGVjdChwaWRsaW5rLCBjaDA1LCBjaDA2LCBjaDA2YSwgY2gwOCwgY2gwOWRheSwgY2gwOW10aCwgY2gwOXlyLCBjaDI1KQp3NF9wcmVnbmFuY3kgPSB3NF9wcmVnbmFuY3kgJT4lIHNlbGVjdChwaWRsaW5rLCBjaDA1LCBjaDA2LCBjaDA2YSwgY2gwOCwgY2gwOWRheSwgY2gwOW10aCwgY2gwOXlyLCBjaDI1KQp3M19wcmVnbmFuY3kgPSB3M19wcmVnbmFuY3kgJT4lIHNlbGVjdChwaWRsaW5rLCBjaDA1LCBjaDA2LCBjaDA2YSwgY2gwOCwgY2gwOWRheSwgY2gwOW10aCwgY2gwOXlyLCBjaDI1KQp3Ml9wcmVnbmFuY3kgPSB3Ml9wcmVnbmFuY3kgJT4lIHNlbGVjdChwaWRsaW5rLCBjaDA1LCBjaDA2LCBjaDA2YSwgY2gwOCwgY2gwOWRheSwgY2gwOW10aCwgY2gwOXlyLCBjaDI1KQp3MV9wcmVnbmFuY3kgPSB3MV9wcmVnbmFuY3kgJT4lIAogIGdyb3VwX2J5KHBpZGxpbmssIGNoMDQpICU+JSBtdXRhdGUoY2gwNmEgPSBpZl9lbHNlKCFpcy5uYShwaWRsaW5rKSAmICFpcy5uYShjaDA0KSwgaWZfZWxzZSggbigpID4gMSwgMSwgMyksIDkpKSAlPiUKICB1bmdyb3VwKCkgJT4lIAogIHNlbGVjdChwaWRsaW5rLCBjaDA1LCBjaDA2LCBjaDA2YSwgY2gwOCwgY2gwOWRheSwgY2gwOW10aCwgY2gwOXlyLCBjaDI1KSAlPiUgCiMgSW4gdGhlIGZpcnN0IHdhdmUgdGhlIHllYXIgaXMgbmFtZWQgd3JvbmcKICBtdXRhdGUoY2gwOXlyID0gaWZlbHNlKGNoMDl5ciA8PSA5MywgY2gwOXlyLCBOQSksCiAgICAgICAgICBjaDA5eXIgPSBhcy5udW1lcmljKHN0cl9jKCIxOSIsIGNoMDl5cikpKQoKIyMgQ29tYmluZSBkYXRhCnByZWduYW5jeSA9IGJpbmRfcm93cyh3MSA9IHcxX3ByZWduYW5jeSwgdzIgPSB3Ml9wcmVnbmFuY3ksIHczID0gdzNfcHJlZ25hbmN5LCB3NCA9IHc0X3ByZWduYW5jeSwgdzUgPSB3NV9wcmVnbmFuY3ksIC5pZCA9ICJ3YXZlIikKcHJlZ25hbmN5ID0gY29kZWJvb2s6OnJlc2N1ZV9hdHRyaWJ1dGVzKHByZWduYW5jeSwgdzVfcHJlZ25hbmN5KQoKIyMgUmVuYW1lIFZhcmlhYmxlcwpwcmVnbmFuY3kgPSBwcmVnbmFuY3kgJT4lIHJlbmFtZShjaHJvbl9vcmRlcl9iaXJ0aCA9IGNoMDUsIGxpZmViaXJ0aHMgPSBjaDA2LCBtdWx0aXBsZV9iaXJ0aCA9IGNoMDZhLCBnZW5kZXIgPSBjaDA4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXJ0aF9kYXkgPSBjaDA5ZGF5LCBiaXJ0aF9tb250aCA9IGNoMDltdGgsIGJpcnRoX3llYXIgPSBjaDA5eXIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3RoZXJfcGlkbGluayA9IHBpZGxpbmssIGFsaXZlID0gY2gyNSkgIyBwcmVnbmFuY3kkbGlmZWJpcnRocyB2YWx1ZXM6IDEgPSBzdGlsbCBwcmVnbmFudCwgMiA9IGxpdmViaXJ0aCwgMyA9IHN0aWxsIGJpcnRoLCA0ID0gbWlzc2NhcnJpYWdlCgojIyBTZXQgdmFsdWVzIGFzIE5BIHRoYXQgYXJlIG1pc3NpbmcKcHJlZ25hbmN5ID0gcHJlZ25hbmN5ICU+JQogIG11dGF0ZShiaXJ0aF9kYXkgPSBpZmVsc2UoYmlydGhfZGF5PjMxLCBOQSwgYmlydGhfZGF5KSwKICAgICAgICAgYmlydGhfbW9udGggPSBpZmVsc2UoYmlydGhfbW9udGg+MTIsIE5BLCBiaXJ0aF9tb250aCksCiAgICAgICAgIGJpcnRoX3llYXIgPSBpZmVsc2UoYmlydGhfeWVhcj4yMDE2LCBOQSwgYmlydGhfeWVhciksCiAgICAgICAgIGJpcnRoX2RheSA9IGlmZWxzZShpcy5uYW4oYmlydGhfZGF5KSwgTkEsIGJpcnRoX2RheSksCiAgICAgICAgIGJpcnRoX21vbnRoID0gaWZlbHNlKGlzLm5hbihiaXJ0aF9tb250aCksIE5BLCBiaXJ0aF9tb250aCksCiAgICAgICAgIGJpcnRoX3llYXIgPSBpZmVsc2UoaXMubmFuKGJpcnRoX3llYXIpLCBOQSwgYmlydGhfeWVhciksCiAgICAgICAgIG11bHRpcGxlX2JpcnRoID0gaWZlbHNlKG11bHRpcGxlX2JpcnRoID09IDksIE5BLCBtdWx0aXBsZV9iaXJ0aCksCiAgICAgICAgIG11bHRpcGxlX2JpcnRoID0gaWZlbHNlKGlzLm5hbihtdWx0aXBsZV9iaXJ0aCksIE5BLCBtdWx0aXBsZV9iaXJ0aCkpCgpwcmVnbmFuY3kkbW9udGggPSBwYXN0ZTAocHJlZ25hbmN5JGJpcnRoX3llYXIsIi0iLCBpZmVsc2UoaXMubmEocHJlZ25hbmN5JGJpcnRoX21vbnRoKSwgIjAxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZF9tb250aChwcmVnbmFuY3kkYmlydGhfbW9udGgpKSkKCnByZWduYW5jeSA9IHByZWduYW5jeSAlPiUgCiAgbXV0YXRlKGJpcnRoZGF0ZSA9IGFsbF9hdmFpbGFibGVfaW5mb19iaXJ0aF9kYXRlKGJpcnRoX3llYXIsIGJpcnRoX21vbnRoLCBiaXJ0aF9kYXkpLAogICAgICAgICBtb3RoZXJfYmlydGhkYXRlID0gc3RyX2MobW90aGVyX3BpZGxpbmssICItIiwgYmlydGhkYXRlKSwKICAgICAgICAgbW90aGVyX2JpcnRob3JkZXIgPSBwYXN0ZTAobW90aGVyX3BpZGxpbmsgLCAiLSIsIGNocm9uX29yZGVyX2JpcnRoKSkKCnByZWduYW5jeSA9IHByZWduYW5jeSAlPiUgCiAgbXV0YXRlKHdhdmUgPSBzdHJfc3ViKHdhdmUsIDIsIDMpICU+JSBhcy5udW1lcmljKCkpICU+JSAjIGZyb20gbW9zdCByZWNlbnQgd2F2ZSB0byBvbGRlc3QKICBhcnJhbmdlKGRlc2Mod2F2ZSkpICU+JSAjIHVzZSBtb3N0IHJlY2VudCB3YXZlIChiZWNhdXNlIHRoZXNlIHdpbGwgaGF2ZSBwcmVnbmFuY3kgb3V0Y29tZXMpCiAgZ3JvdXBfYnkobW90aGVyX2JpcnRoZGF0ZSkgJT4lIAogIG11dGF0ZShiaXJ0aGRhdGVfZHVwZWRfaW5fZWFybGllcl93YXZlID0gbWluX3Jhbmsod2F2ZSkpICU+JSAKICBncm91cF9ieShtb3RoZXJfYmlydGhvcmRlcikgJT4lIAogIG11dGF0ZShiaXJ0aG9yZGVyX2R1cGVkX2luX2VhcmxpZXJfd2F2ZSA9IG1pbl9yYW5rKHdhdmUpKQojIHRoZXNlIGFyZSBwcmVnbmFuY3kgdGhhdCBjaGFuZ2VzIHN0YXR1cyAoaS5lLiBvbmdvaW5nIGluIHdhdmUgMiwgbWlzY2FycmllZC9ib3JuIGJ5IHdhdmUgMykKY3Jvc3N0YWJzKH4gYmlydGhkYXRlX2R1cGVkX2luX2VhcmxpZXJfd2F2ZSArIGJpcnRob3JkZXJfZHVwZWRfaW5fZWFybGllcl93YXZlICsgaXMubmEoYmlydGhkYXRlKSwgcHJlZ25hbmN5KQoKIyB1bmZvcnR1bmF0ZWx5LCBzb21ldGltZXMgY2hyb25fb3JkZXJfYmlydGggaXMgaW5jb25zaXN0ZW50IHdpdGggYmlydGhkYXRlcwojIHRvIGVsaW1pbmF0ZSBkdXBsaWNhdGVzIGZyb20gdGhlIHByZWduYW5jeSBmaWxlIChiZWNhdXNlIHByZWduYW5jaWVzIGNoYW5nZWQgc3RhdHVzZXMpCiMgbm93LCBmb3IgdGhvc2Ugd2hlcmUgd2UgZG9uJ3Qga25vdyB0aGUgYmlydGhkYXRlLCB3ZSBrZWVwIG9ubHkgdW5pcXVlIGJpcnRoIG9yZGVycwojIGZvciB0aG9zZSwgd2hlcmUgd2Uga25vdyB0aGUgYmlydGhkYXRlLCB3ZSBrZWVwIG9ubHkgdW5pcXVlIGJpcnRoZGF0ZXMgKGFzIHRoaXMgaXMgaGlnaGVyIHEgaW5mb3JtYXRpb24pCnByZWduYW5jeSA9IHByZWduYW5jeSAlPiUgCiAgZmlsdGVyKChpcy5uYShiaXJ0aGRhdGUpICYmIGJpcnRob3JkZXJfZHVwZWRfaW5fZWFybGllcl93YXZlID09IDEpIHwgYmlydGhkYXRlX2R1cGVkX2luX2VhcmxpZXJfd2F2ZSA9PSAxKSAlPiUgCiAgdW5ncm91cCgpICMgZWxpbWluYXRlIGR1cGVzIGFjcm9zcyB3YXZlcyAoc2FtZSBtb3RoZXJfYmlydGhkYXRlKSwga2VlcCBtdWx0IGJpcnRocwpjcm9zc3RhYnMofiBiaXJ0aGRhdGVfZHVwZWRfaW5fZWFybGllcl93YXZlICsgYmlydGhvcmRlcl9kdXBlZF9pbl9lYXJsaWVyX3dhdmUgKyBpcy5uYShiaXJ0aGRhdGUpLCBwcmVnbmFuY3kpCgp4ID0gKHVuaXF1ZShwcmVnbmFuY3kkbW90aGVyX3BpZGxpbmspKQoKIyNyZW1vdmUgYWxsIHdpdGggbWlzc2luZyBiaXJ0aGRhdGUvbWlzY2FycmlhZ2UgZGF0ZQp0YWJsZShpcy5uYShwcmVnbmFuY3kkYmlydGhkYXRlKSkKCiMgZm9yIHdoYXRldmVyIHJlYXNvbiB0aGVyZSBhcmUgc29tZSBtdWx0aXBsZSBiaXJ0aHMgd2l0aCBqdXN0IG9uZSByb3cgaW4gdGhlIGRhdGEsIGJ1dCBudW1iZXIgYXJlIGxvdyBlbm91Z2gKIyB0aGF0IHdlIGNvbnNpZGVyIHNvbWUgZXJyb3JzIGluIHRoZSByZWNvcmRzIHRoZSBsaWtlbHkgcmVhc29uCnByZWduYW5jeSAlPiUgZmlsdGVyKCFpcy5uYShiaXJ0aGRhdGUpKSAlPiUgZ3JvdXBfYnkobW90aGVyX2JpcnRoZGF0ZSkgICU+JSAKICBtdXRhdGUobXVsdCA9IG4oKSkgJT4lIGNyb3NzdGFicyh+IG11bHQgKyBtdWx0aXBsZV9iaXJ0aCArIGlzLm5hKGJpcnRoX21vbnRoKSwgZGF0YSA9IC4pCgojIyBGb3JtIHZhcmlhYmxlIGZvciBhbnkgbXVsdGlwbGUgYmlydGggaW4gZmFtaWx5CnByZWduYW5jeSA9IHByZWduYW5jeSAlPiUgZ3JvdXBfYnkobW90aGVyX3BpZGxpbmspICU+JSBtdXRhdGUoYW55X211bHRpcGxlX2JpcnRoID0gaWZfZWxzZShhbnkobXVsdGlwbGVfYmlydGggPT0gMSwgbmEucm0gPSBUKSwgMSwgMCkpCnByb3AudGFibGUoY3Jvc3N0YWJzKHByZWduYW5jeSRtdWx0aXBsZV9iaXJ0aCkpCnByb3AudGFibGUoY3Jvc3N0YWJzKHByZWduYW5jeSRhbnlfbXVsdGlwbGVfYmlydGgpKQpgYGAKCiMjIyBJbmZvcm1hdGlvbiBhYm91dCBtYXJyaWFnZSBoaXN0b3J5CmBgYHtyIG1hcnJpYWdlIGhpc3Rvcnl9CiMjIFNlbGVjdCBtYXJyaWFnZSBkYXRhCnc1X21hcnJpYWdlID0gdzVfbWFycmlhZ2UgJT4lIHNlbGVjdChwaWRsaW5rLCBrdzEwbXRoLCBrdzEweXIsIGt3MThtdGgsIGt3MTh5ciwga3cxMSwga3cxOSkKdzRfbWFycmlhZ2UgPSB3NF9tYXJyaWFnZSAlPiUgc2VsZWN0KHBpZGxpbmssIGt3MTBtdGgsIGt3MTB5ciwga3cxOG10aCwga3cxOHlyLCBrdzExLCBrdzE5KQp3M19tYXJyaWFnZSA9IHczX21hcnJpYWdlICU+JSBzZWxlY3QocGlkbGluaywga3cxMG10aCwga3cxMHlyLCBrdzE4bXRoLCBrdzE4eXIsIGt3MTEsIGt3MTkpCncyX21hcnJpYWdlID0gdzJfbWFycmlhZ2UgJT4lIHNlbGVjdChwaWRsaW5rLCBrdzEwbXRoLCBrdzEweXIsIGt3MThtdGgsIGt3MTh5ciwga3cxMSwga3cxOSkKdzFfbWFycmlhZ2UgPSB3MV9tYXJyaWFnZSAlPiUgc2VsZWN0KHBpZGxpbmssIGt3MDVhLCBrdzA1Yiwga3cxM2EsIGt3MTNiLCBrdzA2LCBrdzE0YWdlKQojIEluIHRoZSBmaXJzdCB3YXZlIHRoZSB5ZWFyIGlzIG5hbWVkIHdyb25nCncxX21hcnJpYWdlID0gdzFfbWFycmlhZ2UgJT4lCiAgbXV0YXRlKGt3MDVhID0gaWZlbHNlKGt3MDVhIDw9IDkzLCBhcy5udW1lcmljKHN0cl9jKCIxOSIsIHcxX21hcnJpYWdlJGt3MDVhKSksIGt3MDVhKSwKICAgICAgICAga3cxM2EgPSBpZmVsc2Uoa3cxM2EgPD05MyAsIGFzLm51bWVyaWMoc3RyX2MoIjE5IiwgdzFfbWFycmlhZ2Uka3cxM2EpKSwga3cxM2EpKQojIEFuZCB0aGUgY29sdW1uIG5hbWVzIGFyZSB3cm9uZy4uLgp3MV9tYXJyaWFnZSA9IHcxX21hcnJpYWdlICU+JSByZW5hbWUoa3cxMG10aCA9IGt3MDViLCBrdzEweXIgPSBrdzA1YSwga3cxOG10aCA9IGt3MTNiLCBrdzE4eXIgPSBrdzEzYSwga3cxMSA9IGt3MDYsIGt3MTkgPSBrdzE0YWdlKQoKIyMgU2VsZWN0IGFkZGl0aW9uYWwgbWFycmlhZ2UgaW5mb3JtYXRpb24gKGFnZSBvZiByZXNwb25kZW50KQp3NV9tYXJyaWFnZV9hZGRpdGlvbmFsID0gdzVfbWFycmlhZ2VfYWRkaXRpb25hbCAlPiUgc2VsZWN0KHBpZGxpbmssIGFnZSwgZG9iX3lyKQp3NF9tYXJyaWFnZV9hZGRpdGlvbmFsID0gdzRfbWFycmlhZ2VfYWRkaXRpb25hbCAlPiUgc2VsZWN0KHBpZGxpbmssIGFnZSwgZG9iX3lyKQp3M19tYXJyaWFnZV9hZGRpdGlvbmFsID0gdzNfbWFycmlhZ2VfYWRkaXRpb25hbCAlPiUgc2VsZWN0KHBpZGxpbmssIGFnZSwgZG9iX3lyKQp3Ml9tYXJyaWFnZV9hZGRpdGlvbmFsID0gdzJfbWFycmlhZ2VfYWRkaXRpb25hbCAlPiUgc2VsZWN0KHBpZGxpbmssIGFnZSwgZG9iX3lyKQp3MV9tYXJyaWFnZV9hZGRpdGlvbmFsID0gdzFfbWFycmlhZ2VfYWRkaXRpb25hbCAlPiUgc2VsZWN0KHBpZGxpbmssIGFyMDl5ciwgYXIwOHlyKQojIEluIHRoZSBmaXJzdCB3YXZlIHRoZSB5ZWFyIGlzIG5hbWVkIHdyb25nCncxX21hcnJpYWdlX2FkZGl0aW9uYWwgPSB3MV9tYXJyaWFnZV9hZGRpdGlvbmFsICU+JQogIG11dGF0ZShhcjA4eXIgPSBpZmVsc2UoYXIwOHlyIDw9IDkzLCAKICAgICAgICAgICAgICAgICAgICAgICAgIGFzLm51bWVyaWMoc3RyX2MoIjE5IiwgdzFfbWFycmlhZ2VfYWRkaXRpb25hbCRhcjA4eXIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgIGFyMDh5cikpCiMgQW5kIHRoZSBjb2x1bW4gbmFtZXMgYXJlIHdyb25nLi4uCncxX21hcnJpYWdlX2FkZGl0aW9uYWwgPSB3MV9tYXJyaWFnZV9hZGRpdGlvbmFsICU+JSByZW5hbWUoYWdlID0gYXIwOXlyLCBkb2JfeXIgPSBhcjA4eXIpCgojIyBDb21iaW5lIG1hcnJpYWdlIGluZm9ybWF0aW9uIGFuZCBhZGRpdGlvbmFsIG1hcnJpYWdlIGluZm9ybWF0aW9uOgp3MV9tYXJyaWFnZSA9IGxlZnRfam9pbih3MV9tYXJyaWFnZSwgdzFfbWFycmlhZ2VfYWRkaXRpb25hbCwgYnkgPSAicGlkbGluayIpICU+JQogIG11dGF0ZSh3YXZlID0gYXMubnVtZXJpYygiMTk5MyIpKQp3Ml9tYXJyaWFnZSA9IGxlZnRfam9pbih3Ml9tYXJyaWFnZSwgdzJfbWFycmlhZ2VfYWRkaXRpb25hbCwgYnkgPSAicGlkbGluayIpICU+JQogIG11dGF0ZSh3YXZlID0gYXMubnVtZXJpYygiMTk5NyIpKQp3M19tYXJyaWFnZSA9IGxlZnRfam9pbih3M19tYXJyaWFnZSwgdzNfbWFycmlhZ2VfYWRkaXRpb25hbCwgYnkgPSAicGlkbGluayIpICAlPiUKICBtdXRhdGUod2F2ZSA9IGFzLm51bWVyaWMoIjIwMDAiKSkKdzRfbWFycmlhZ2UgPSBsZWZ0X2pvaW4odzRfbWFycmlhZ2UsIHc0X21hcnJpYWdlX2FkZGl0aW9uYWwsIGJ5ID0gInBpZGxpbmsiKSAlPiUKICBtdXRhdGUod2F2ZSA9IGFzLm51bWVyaWMoIjIwMDciKSkKdzVfbWFycmlhZ2UgPSBsZWZ0X2pvaW4odzVfbWFycmlhZ2UsIHc1X21hcnJpYWdlX2FkZGl0aW9uYWwsIGJ5ID0gInBpZGxpbmsiKSAlPiUKICBtdXRhdGUod2F2ZSA9IGFzLm51bWVyaWMoIjIwMTQiKSkKCiMjIENvbWJpbmUgbWFycmlhZ2UgaW5mb3JtYXRpb25zCm1hcnJpYWdlID0gYmluZF9yb3dzKHcxX21hcnJpYWdlLCB3Ml9tYXJyaWFnZSwgdzNfbWFycmlhZ2UsIHc0X21hcnJpYWdlLCB3NV9tYXJyaWFnZSkKCiMgUmVuYW1lIGNvbHVtbnMKbWFycmlhZ2UgPSBtYXJyaWFnZSAlPiUgcmVuYW1lKHN0YXJ0X3llYXIgPSBrdzEweXIsIHN0YXJ0X21vbnRoID0ga3cxMG10aCwgZW5kX3llYXIgPSBrdzE4eXIsIGVuZF9tb250aCA9IGt3MThtdGgsIHN0YXJ0X2FnZSA9IGt3MTEsIGVuZF9hZ2UgPSBrdzE5LCBiaXJ0aF95ZWFyID0gZG9iX3lyLCBiaXJ0aF9hZ2UgPSBhZ2UpCgoKIyBTZXQgdmFsdWVzIGFzIE5BIHRoYXQgYXJlIG1pc3NpbmcKbWFycmlhZ2Ukc3RhcnRfeWVhclsgbWFycmlhZ2Ukc3RhcnRfeWVhcjwxOTAwXSA9IE5BCm1hcnJpYWdlJHN0YXJ0X3llYXJbIG1hcnJpYWdlJHN0YXJ0X3llYXI+MjAxNl0gPSBOQQptYXJyaWFnZSRzdGFydF95ZWFyWyBpcy5uYW4obWFycmlhZ2Ukc3RhcnRfeWVhcildID0gTkEKbWFycmlhZ2UkZW5kX3llYXJbIG1hcnJpYWdlJGVuZF95ZWFyPDE5MDBdID0gTkEKbWFycmlhZ2UkZW5kX3llYXJbIG1hcnJpYWdlJGVuZF95ZWFyPjIwMTZdID0gTkEKbWFycmlhZ2UkZW5kX3llYXJbIGlzLm5hbihtYXJyaWFnZSRlbmRfeWVhcildID0gTkEKbWFycmlhZ2Ukc3RhcnRfbW9udGggW21hcnJpYWdlJHN0YXJ0X21vbnRoPjEyXSA9IE5BCm1hcnJpYWdlJHN0YXJ0X21vbnRoIFtpcy5uYW4obWFycmlhZ2Ukc3RhcnRfbW9udGgpXSA9IE5BCm1hcnJpYWdlJGVuZF9tb250aCBbbWFycmlhZ2UkZW5kX21vbnRoPjEyXSA9IE5BCm1hcnJpYWdlJGVuZF9tb250aCBbaXMubmFuKG1hcnJpYWdlJGVuZF9tb250aCldID0gTkEKbWFycmlhZ2Ukc3RhcnRfYWdlIFttYXJyaWFnZSRzdGFydF9hZ2UgPiA5N10gPSBOQQptYXJyaWFnZSRzdGFydF9hZ2UgW2lzLm5hbihtYXJyaWFnZSRzdGFydF9hZ2UpXSA9IE5BCm1hcnJpYWdlJGVuZF9hZ2UgW21hcnJpYWdlJGVuZF9hZ2UgPiA5N10gPSBOQQptYXJyaWFnZSRlbmRfYWdlIFtpcy5uYW4obWFycmlhZ2UkZW5kX2FnZSldID0gTkEKbWFycmlhZ2UkYmlydGhfeWVhclsgbWFycmlhZ2UkYmlydGhfeWVhcjwxOTAwXSA9IE5BCm1hcnJpYWdlJGJpcnRoX3llYXJbIG1hcnJpYWdlJGJpcnRoX3llYXI+MjAxNl0gPSBOQQptYXJyaWFnZSRiaXJ0aF95ZWFyWyBpcy5uYW4obWFycmlhZ2UkYmlydGhfeWVhcildID0gTkEKbWFycmlhZ2UkYmlydGhfYWdlIFttYXJyaWFnZSRiaXJ0aF9hZ2UgPiA5N10gPSBOQQptYXJyaWFnZSRiaXJ0aF9hZ2UgW2lzLm5hbihtYXJyaWFnZSRiaXJ0aF9hZ2UpXSA9IE5BCgojIyBSZWNvbnN0cnVjdCBtYXJyaWFnZSBzdGFydCB5ZWFyIGFuZCBlbmQgeWVhciBmb3IgbWFycmlhZ2VzIHdpdGggbWlzc2luZyB5ZWFyCm1hcnJpYWdlID0gbWFycmlhZ2UgJT4lCiAgbXV0YXRlKGJpcnRoX3llYXIgPSBpZmVsc2UoaXMubmEoYmlydGhfeWVhciksIHdhdmUgLSBiaXJ0aF9hZ2UsIGJpcnRoX3llYXIpLAogICAgICAgICBzdGFydF95ZWFyID0gaWZlbHNlKGlzLm5hKHN0YXJ0X3llYXIpLCBiaXJ0aF95ZWFyICsgc3RhcnRfYWdlLCBzdGFydF95ZWFyKSwKICAgICAgICAgZW5kX3llYXIgPSBpZmVsc2UoaXMubmEoZW5kX3llYXIpLCBiaXJ0aF95ZWFyICsgZW5kX2FnZSwgZW5kX3llYXIpKQoKCm1hcnJpYWdlID0gbWFycmlhZ2UgJT4lIGFycmFuZ2UocGlkbGluaywgc3RhcnRfeWVhciwgc3RhcnRfbW9udGgsIHN0YXJ0X2FnZSwgZW5kX3llYXIsIGVuZF9tb250aCwgZW5kX2FnZSkKCm1hcnJpYWdlID0gbWFycmlhZ2UgJT4lIGZpbHRlcighZHVwbGljYXRlZChjYmluZChwaWRsaW5rLCBzdGFydF95ZWFyLCBzdGFydF9tb250aCkpIHwgaXMubmEoc3RhcnRfeWVhcikgfCBpcy5uYShzdGFydF9tb250aCkpICMgbm9ib2R5IGdldHMgbWFycmllZCB0d2ljZSBvbiB0aGUgc2FtZSBkYXksIHJpZ2h0PyBzbyB0aGVzZSBhcmUgZHVwZXMuCgojIyBDYWxjdWxhdGUgZGF0ZSBmb3IgYmVnaW5uaW5nIG9mIG1hcnJpYWdlOgptYXJyaWFnZSA9IG1hcnJpYWdlICU+JSAKICB1bmdyb3VwKCkgJT4lCiAgbXV0YXRlKHN0YXJ0X3N0cmluZyA9IHN0cl9jKHN0YXJ0X3llYXIsICItIiwgaWZlbHNlKGlzLm5hKHN0YXJ0X21vbnRoKSwgIjAxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkX21vbnRoKHN0YXJ0X21vbnRoKSksICItMDEiKSwKICAgICAgICBlbmRfc3RyaW5nID0gc3RyX2MoZW5kX3llYXIsICItIiwgaWZlbHNlKGlzLm5hKGVuZF9tb250aCksICIxMiIsIHBhZF9tb250aChlbmRfbW9udGgpKSwgIi0wMSIpLAogICAgICAgIHN0YXJ0ID0geW1kKHN0YXJ0X3N0cmluZyksCiAgICAgICAgZW5kID0geW1kKGVuZF9zdHJpbmcpICsgbW9udGhzKDEpIC0gZGF5cygxKSkKCiMjIENvdW50IG51bWJlciBvZiBtYXJyaWFnZXMKbWFycmlhZ2UgPSBtYXJyaWFnZSAlPiUKICBhcnJhbmdlKHBpZGxpbmssIHN0YXJ0LCBlbmQpICU+JQogIGdyb3VwX2J5KHBpZGxpbmspICU+JQogIG11dGF0ZShudW1iZXJfbWFycmlhZ2VzID0gbigpLAogICAgICAgICBvcmRlcl9tYXJyaWFnZSA9IHJvd19udW1iZXIoKSwKICAgICAgICAgbWFycmlhZ2VfaWQgPSBwYXN0ZTAocGlkbGluaywgIl8iLCBhcy5jaGFyYWN0ZXIob3JkZXJfbWFycmlhZ2UpLCAiXyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzLmNoYXJhY3RlcihzdGFydCksICIvIixhcy5jaGFyYWN0ZXIoZW5kKSkpCgojIyMgTWFycmlhZ2UgVGltZWxpbmUKbWluaW11bV9zdGFydCA9IG1pbih5bWQoc3RyX2MocHJlZ25hbmN5JG1vbnRoLCAiLTAxIikpLCBuYS5ybSA9IFQpCm1heGltdW1fZW5kID0gbWF4KHltZChzdHJfYyhwcmVnbmFuY3kkbW9udGgsICItMDEiKSksIG5hLnJtID0gVCkKbWFycmlhZ2VfdGltZWxpbmUgPSBtYXJyaWFnZSAlPiUKICAgIG11dGF0ZShpbXBsaWVkX3N0YXJ0ID0gYXMuRGF0ZShpZmVsc2UoaXMubmEoc3RhcnQpLCBtaW5pbXVtX3N0YXJ0ICwgc3RhcnQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbj0iMTk3MC0wMS0wMSIpLAogICAgICAgICAgIGltcGxpZWRfZW5kID0gYXMuRGF0ZShpZmVsc2UoaXMubmEoZW5kKSwgbWF4aW11bV9lbmQgLCBlbmQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW49IjE5NzAtMDEtMDEiKSkgJT4lCiAgZmlsdGVyKGltcGxpZWRfc3RhcnQgPCBpbXBsaWVkX2VuZCkKCm1hcnJpYWdlX3RpbWVsaW5lID0gbWFycmlhZ2VfdGltZWxpbmUgJT4lCiAgICByb3d3aXNlKCkgJT4lCiAgICBkbyhkYXRhLmZyYW1lKAogICAgICAgIG1hcnJpYWdlX2lkPS4kbWFycmlhZ2VfaWQsIAogICAgICAgIG1vdGhlcl9waWRsaW5rID0gLiRwaWRsaW5rLAogICAgICAgIG9yZGVyX21hcnJpYWdlID0gLiRvcmRlcl9tYXJyaWFnZSwKICAgICAgICBzdGFydCA9IC4kc3RhcnQsCiAgICAgICAgZW5kID0gLiRlbmQsCiAgICAgICAgbW9udGggPSBzZXEoLiRpbXBsaWVkX3N0YXJ0LC4kaW1wbGllZF9lbmQsIGJ5PSIxIG1vbnRoIikgKSkKCiMgbm8gZHVwbGljYXRlIG1vdGhlcl9pZCAtIG1vbnRoIGNvbWJpbmF0aW9ucyAobm8gdHdvIG1hcnJpYWdlcyBhdCB0aGUgc2FtZSB0aW1lKQptYXJyaWFnZV90aW1lbGluZSA9IG1hcnJpYWdlX3RpbWVsaW5lICU+JSAKICBhcnJhbmdlKG1vdGhlcl9waWRsaW5rLCBzdGFydCwgZW5kKSAlPiUgCiAgZGlzdGluY3QobW90aGVyX3BpZGxpbmssIG1vbnRoLCAua2VlcF9hbGwgPSBUUlVFKQoKbWFycmlhZ2VfdGltZWxpbmUkbW9udGggPSBzdHJpbmdyOjpzdHJfc3ViKGFzLmNoYXJhY3RlcihtYXJyaWFnZV90aW1lbGluZSRtb250aCksMSw3KQoKIyB3ZSBhc3N1bWUgdGhhdCBmYXRoZXJzIGFyZSB0aG9zZSB0byB3aG9tIG1vdGhlcnMgd2VyZSBtYXJyaWVkIGluIHRoZSBiaXJ0aCBtb250aApwcmVnbmFuY3kgPSBwcmVnbmFuY3kgJT4lIGxlZnRfam9pbihtYXJyaWFnZV90aW1lbGluZSwgYnkgPSBjKCJtb3RoZXJfcGlkbGluayIsICJtb250aCIpKSAlPiUgdW5ncm91cCgpCmBgYAoKCiMjIyBCaXJ0aCBvcmRlciBjYWxjdWxhdGlvbnMgey50YWJzZXR9CmBgYHtyIFV0ZXJ1cyBiaXJ0aG9yZGVyIGFuZCBtYXRlcm5hbCBzaWJsaW5nIGNvdW50fQojIyMjIE1hdGVybmFsIFByZWduYW5jeSBPcmRlcgpwcmVnbmFuY3kxID0gcHJlZ25hbmN5ICU+JQogIGdyb3VwX2J5KG1vdGhlcl9waWRsaW5rKSAlPiUKICBtdXRhdGUoYmlydGhvcmRlcl91dGVydXNfcHJlZyA9IG1pbl9yYW5rKGJpcnRoZGF0ZSksCiAgICAgICAgIGJpcnRob3JkZXJfdXRlcnVzX3ByZWcyID0gaWZlbHNlKGlzLm5hKGJpcnRob3JkZXJfdXRlcnVzX3ByZWcpLCBjaHJvbl9vcmRlcl9iaXJ0aCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShjaHJvbl9vcmRlcl9iaXJ0aCA+IGJpcnRob3JkZXJfdXRlcnVzX3ByZWcsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNocm9uX29yZGVyX2JpcnRoLCBiaXJ0aG9yZGVyX3V0ZXJ1c19wcmVnKSksCiAgICAgICAgICMgYmlydGhvcmRlcl91dGVydXNfcHJlZyA9IGlmZWxzZShhbnlfbXVsdGlwbGVfYmlydGggPT0gMSwgTkEsIGJpcnRob3JkZXJfdXRlcnVzX3ByZWcpLAogICAgICAgICBzaWJsaW5nX2NvdW50X3V0ZXJ1c19wcmVnID0gc3VtKCFpcy5uYShiaXJ0aGRhdGUpKSwKICAgICAgICAgc2libGluZ19jb3VudF91dGVydXNfcHJlZzIgPSBpZmVsc2UoaXMubmEoc2libGluZ19jb3VudF91dGVydXNfcHJlZyksIG1heChjaHJvbl9vcmRlcl9iaXJ0aCwgbmEucm0gPSBUKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKG1heChjaHJvbl9vcmRlcl9iaXJ0aCwgbmEucm0gPSBUKSA+IHNpYmxpbmdfY291bnRfdXRlcnVzX3ByZWcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4KGNocm9uX29yZGVyX2JpcnRoLCBuYS5ybSA9IFQpLCBzaWJsaW5nX2NvdW50X3V0ZXJ1c19wcmVnKSkKICAgICAgICAgIyBzaWJsaW5nX2NvdW50X3V0ZXJ1c19wcmVnID0gaWZlbHNlKGFueV9tdWx0aXBsZV9iaXJ0aCA9PSAxLCBOQSwgc2libGluZ19jb3VudF91dGVydXNfcHJlZykKICAgICAgICAgKSAlPiUKICB1bmdyb3VwKCkKY29yLnRlc3QocHJlZ25hbmN5MSRiaXJ0aG9yZGVyX3V0ZXJ1c19wcmVnLCBwcmVnbmFuY3kxJGJpcnRob3JkZXJfdXRlcnVzX3ByZWcyKQpjb3IudGVzdChwcmVnbmFuY3kxJHNpYmxpbmdfY291bnRfdXRlcnVzX3ByZWcsIHByZWduYW5jeTEkc2libGluZ19jb3VudF91dGVydXNfcHJlZykKY3Jvc3N0YWJzKH4gaXMubmEoYmlydGhvcmRlcl91dGVydXNfcHJlZykgKyBpcy5uYShiaXJ0aG9yZGVyX3V0ZXJ1c19wcmVnMikgKyBpcy5uYShiaXJ0aGRhdGUpLCBwcmVnbmFuY3kxKQpjcm9zc3RhYnMofiBpcy5uYShzaWJsaW5nX2NvdW50X3V0ZXJ1c19wcmVnKSArIGlzLm5hKHNpYmxpbmdfY291bnRfdXRlcnVzX3ByZWcyKSArIGlzLm5hKGJpcnRoZGF0ZSksIHByZWduYW5jeTEpCiMgb3VyIGJpcnRoZGF0ZSBiYXNlZCBiaXJ0aG9yZGVyIGVzdGltYXRlcyBhcmUgZXh0cmVtZWx5IGNvbnNpc3RlbnQgd2l0aCBjaHJvbl9vcmRlcl9iaXJ0aAoKIyMjIyBNYXRlcm5hbCBCaXJ0aCBPcmRlcgpwcmVnbmFuY3kyID0gcHJlZ25hbmN5ICU+JQogIGZpbHRlcihsaWZlYmlydGhzID09IDIpICU+JQogIGdyb3VwX2J5KG1vdGhlcl9waWRsaW5rKSAlPiUKICAgIG11dGF0ZShiaXJ0aG9yZGVyX3V0ZXJ1c19hbGl2ZSA9IG1pbl9yYW5rKGJpcnRoZGF0ZSksCiAgICAgICAgICAgIyBiaXJ0aG9yZGVyX3V0ZXJ1c19hbGl2ZSA9IGlmZWxzZShhbnlfbXVsdGlwbGVfYmlydGggPT0gMSwgTkEsIGJpcnRob3JkZXJfdXRlcnVzX2FsaXZlKSwKICAgICAgICAgICBzaWJsaW5nX2NvdW50X3V0ZXJ1c19hbGl2ZSA9IHN1bSghaXMubmEoYmlydGhkYXRlKSkKICAgICAgICAgICAjICxzaWJsaW5nX2NvdW50X3V0ZXJ1c19hbGl2ZSA9IGlmZWxzZShhbnlfbXVsdGlwbGVfYmlydGggPT0gMSwgTkEsIHNpYmxpbmdfY291bnRfdXRlcnVzX2FsaXZlKQogICAgICAgICAgICkgJT4lCiAgdW5ncm91cCgpCgpwcmVnbmFuY3kyID0gcHJlZ25hbmN5MiAlPiUgc2VsZWN0KG1vdGhlcl9iaXJ0aGRhdGUsIGJpcnRob3JkZXJfdXRlcnVzX2FsaXZlLCBzaWJsaW5nX2NvdW50X3V0ZXJ1c19hbGl2ZSkgJT4lIGRpc3RpbmN0KCkKCiMjIyMgUGFyZW50YWwgRnVsbCBTaWJsaW5nIEJpcnRob3JkZXIKcHJlZ25hbmN5MyA9IHByZWduYW5jeSAlPiUKICBmaWx0ZXIobGlmZWJpcnRocyA9PSAyKSAlPiUKICBncm91cF9ieShtYXJyaWFnZV9pZCkgJT4lCiAgICBtdXRhdGUoYmlydGhvcmRlcl9nZW5lcyA9IG1pbl9yYW5rKGJpcnRoZGF0ZSksCiAgICAgICAgICAgYmlydGhvcmRlcl9nZW5lcyA9IGlmZWxzZShpcy5uYShtYXJyaWFnZV9pZCksIE5BLCBiaXJ0aG9yZGVyX2dlbmVzKSwKICAgICAgICAgICBzaWJsaW5nX2NvdW50X2dlbmVzID0gaWZlbHNlKGlzLm5hKG1hcnJpYWdlX2lkKSwgTkEsIHN1bSghaXMubmEobWFycmlhZ2VfaWQpKSkpICU+JQogIHVuZ3JvdXAoKQoKcHJlZ25hbmN5MyA9IHByZWduYW5jeTMgJT4lIHNlbGVjdChtb3RoZXJfYmlydGhkYXRlLCBiaXJ0aG9yZGVyX2dlbmVzLCBzaWJsaW5nX2NvdW50X2dlbmVzKSAlPiUgZGlzdGluY3QoKQoKCiMgcmVtb3ZlIGR1cGVzIGJlY2F1c2Ugb2YgbWlzc2luZ3MgYW5kIHR3aW5zCnByZWduYW5jeTEgPC0gcHJlZ25hbmN5MSAlPiUgc2VsZWN0KC1iaXJ0aG9yZGVyX3V0ZXJ1c19wcmVnMiwgLXNpYmxpbmdfY291bnRfdXRlcnVzX3ByZWcyKSAlPiUgCiAgZmlsdGVyKCFpcy5uYShiaXJ0aGRhdGUpKSAlPiUgCiAgZGlzdGluY3QobW90aGVyX2JpcnRoZGF0ZSwgLmtlZXBfYWxsID0gVFJVRSkKCnByZWduYW5jeTIgPC0gcHJlZ25hbmN5MiAlPiUKICBkaXN0aW5jdChtb3RoZXJfYmlydGhkYXRlLCAua2VlcF9hbGwgPSBUUlVFKQoKIyMjIENvbWJpbmUgYmlydGhvcmRlciBkYXRhCnRhYmxlKGR1cGxpY2F0ZWQocHJlZ25hbmN5MSRtb3RoZXJfYmlydGhkYXRlKSkKdGFibGUoZHVwbGljYXRlZChwcmVnbmFuY3kyJG1vdGhlcl9iaXJ0aGRhdGUpKQp0YWJsZShkdXBsaWNhdGVkKHByZWduYW5jeTMkbW90aGVyX2JpcnRoZGF0ZSkpCgpwcmVnbmFuY3kgPSBsZWZ0X2pvaW4ocHJlZ25hbmN5MSwgcHJlZ25hbmN5MiwgYnk9Im1vdGhlcl9iaXJ0aGRhdGUiKSAlPiUgdW5ncm91cCgpCnByZWduYW5jeSA9IGxlZnRfam9pbihwcmVnbmFuY3ksIHByZWduYW5jeTMsIGJ5ID0gIm1vdGhlcl9iaXJ0aGRhdGUiKSAlPiUgdW5ncm91cCgpCmBgYAoKCiMjIyBCaXJ0aCBvcmRlciBncmFwaHMKYGBge3J9CiMjIyBHcmFwaHMKIyMgQmlvbG9naWNhbCBCaXJ0aG9yZGVyIC0gVXRlcnVzX1ByZWduYW5jaWVzCmdncGxvdChwcmVnbmFuY3ksIGFlcyh4PXNpYmxpbmdfY291bnRfdXRlcnVzX3ByZWcsIHk9YmlydGhvcmRlcl91dGVydXNfcHJlZykpICsgZ2VvbV9qaXR0ZXIoYWxwaGEgPSAwLjEpCgojIyBCaW9sb2dpY2FsIEJpcnRob3JkZXIgLSBVdGVydXNfQmlydGhzCmdncGxvdChwcmVnbmFuY3ksIGFlcyh4PXNpYmxpbmdfY291bnRfdXRlcnVzX2FsaXZlLCB5PWJpcnRob3JkZXJfdXRlcnVzX2FsaXZlKSkgKyBnZW9tX2ppdHRlcihhbHBoYSA9IDAuMSkKCiMjIEJpb2xvZ2ljYWwgQmlydGhvcmRlciAtIEZ1bGwgU2libGluZyBPcmRlcgpnZ3Bsb3QocHJlZ25hbmN5LCBhZXMoeD1zaWJsaW5nX2NvdW50X2dlbmVzLCB5PWJpcnRob3JkZXJfZ2VuZXMpKSArIGdlb21faml0dGVyKGFscGhhID0gMC4xKQoKIyMgQmlvOiBVdGVydXNfcHJlZyB2cy4gVXRlcnVzX0JpcnRocwpnZ3Bsb3QocHJlZ25hbmN5LCBhZXMoeD1iaXJ0aG9yZGVyX3V0ZXJ1c19wcmVnLCB5PWJpcnRob3JkZXJfdXRlcnVzX2FsaXZlKSkgKyBnZW9tX2ppdHRlcihhbHBoYSA9IDAuMSkKIyBUaGUgYmlydGhfb3JkZXJfYWxpdmUgaXMgYWx3YXlzIGxvd2VyLCB3aGljaCBtYWtlcyBzZW5zZSwgYmVjYXVzIG5vdCBsaXZlIGJpcnRocyAobWlzY2FycmlhZ2UsIHN0aWxsIGJpcnRocyBhcmUgZXhjbHVkZWQpCgojIyBCaW86IFV0ZXJ1c19wcmVnIHZzLiBHZW5lcwpnZ3Bsb3QocHJlZ25hbmN5LCBhZXMoeD1iaXJ0aG9yZGVyX3V0ZXJ1c19wcmVnLCB5PWJpcnRob3JkZXJfZ2VuZXMpKSArIGdlb21faml0dGVyKGFscGhhID0gMC4xKQojIFRoZSBiaXJ0aG9yZGVyX2dlbmVzIGlzIGFsd2F5cyBsb3dlciwgd2hpY2ggbWFrZXMgc2Vuc2UsIGJlY2F1c2UgZGlmZmVyZW50L3Vua25vd24gZmF0aGVycyBhcmUgZXhjbHVkZWQKCiMjIEJpbzogVXRlcnVzX2FsaXZlIHZzLiBHZW5lcwpnZ3Bsb3QocHJlZ25hbmN5LCBhZXMoeD1iaXJ0aG9yZGVyX3V0ZXJ1c19hbGl2ZSwgeT1iaXJ0aG9yZGVyX2dlbmVzKSkgICsgZ2VvbV9qaXR0ZXIoYWxwaGEgPSAwLjEpCiMgY2hpbGRyZW4gd2l0aCB0aGUgc2FtZSBmYXRoZXIgaW5jbHVkZXMgb25seSBsaXZlIGJpcnRocwoKIyBjaHJvbiBvcmRlciBiaXJ0aCBkb2VzIG5vdCBjb3JyZWxhdGUgcGVyZmVjdGx5LCB1bnN1cnByaXNpbmcgZ2l2ZW4gdGhhdCB3ZSBmb3VuZCBjaHJvbiBvcmRlcnMgc29tZXRpbWVzIHN0YXJ0ZWQKIyBmcm9tIDEgaW4gbmV3IHdhdmVzIGV2ZW4gdGhvdWdoIHByZXZpb3VzIGJpcnRocyB3ZXJlIHJlY29yZGVkCnByZWduYW5jeSAlPiUgc2VsZWN0KGNocm9uX29yZGVyX2JpcnRoLCBiaXJ0aG9yZGVyX3V0ZXJ1c19hbGl2ZSwgYmlydGhvcmRlcl91dGVydXNfcHJlZywgYmlydGhvcmRlcl9nZW5lcykgJT4lIG5hLm9taXQoKSAlPiUgY29yKCkKcHJlZ25hbmN5ICU+JSBzZWxlY3QoY2hyb25fb3JkZXJfYmlydGgsIGJpcnRob3JkZXJfdXRlcnVzX2FsaXZlLCBiaXJ0aG9yZGVyX3V0ZXJ1c19wcmVnLCBiaXJ0aG9yZGVyX2dlbmVzKSAlPiUgbWlzc2luZ25lc3NfcGF0dGVybnMoKQpwcmVnbmFuY3kgJT4lIHNlbGVjdChzaWJsaW5nX2NvdW50X3V0ZXJ1c19hbGl2ZSwgc2libGluZ19jb3VudF91dGVydXNfcHJlZywgc2libGluZ19jb3VudF9nZW5lcykgJT4lIG1pc3NpbmduZXNzX3BhdHRlcm5zKCkKYGBgCgojIyBTZWxlY3QgaW5kaXZpZHVhbCBkYXRhIGZyb20gSUZMUyA1CmBgYHtyIHNlbGVjdCBpbmRpdmlkdWFsIGRhdGF9CiMjIyBJbmRpdmlkdWFscwppbmRpdmlkdWFscyA9IGJrX2FyMSAlPiUgc2VsZWN0KGhoaWQxNF85LCBwaWRsaW5rLCBmYXRoZXJfcGlkbGluaywgbW90aGVyX3BpZGxpbmssIGFyMDFhLCBhcjAyYiwgYXIxMCwgYXIxMSwgYXIwNywgYXIwOGRheSwgYXIwOG10aCwgYXIwOHlyLCBhcjA5LCBhcjE4ZXlyLCBhcjE4ZW10aCkKaW5kaXZpZHVhbHMgPSBsZWZ0X2pvaW4oaW5kaXZpZHVhbHMsIGJrX3NjMSAlPiUgc2VsZWN0KGhoaWQxNF85LCBzYzA1LCBwcm92aW5jZSwgc2MwMV8xNF8xNCksIGJ5ID0gYygiaGhpZDE0XzkiKSkKCiNSZW5hbWUgdmFyaWFibGVzIHRvIG1ha2UgaXQgZWFzaWVyCmluZGl2aWR1YWxzID0gcmVuYW1lKGluZGl2aWR1YWxzLCByZWxhdGlvbl90b19ISF9oZWFkID0gYXIwMmIsIGZhdGhlcklEID0gYXIxMCwgbW90aGVySUQgPSBhcjExLCBzZXggPSBhcjA3LCBhZ2UgPSBhcjA5LCBzdGF0dXMgPSBhcjAxYSwgZGVhdGhfeXIgPSBhcjE4ZXlyLCBkZWF0aF9tb250aCA9IGFyMThlbXRoKSAKIyBSZW1vdmUgZHVwbGljYXRzIChzb21lIHBlb3BsZSBhcmUgbWVudGlvbmVkIGluIHR3byBob3VzZWhvbGRzLCBlLmcuIGJlY2F1c2UgdGhleSBtb3ZlZCBpbiB0aGUgbGFzdCAxMiBtb250aHMpCmluZGl2aWR1YWxzID0gaW5kaXZpZHVhbHMgJT4lIGRpc3RpbmN0KHBpZGxpbmssIC5rZWVwX2FsbCA9IFRSVUUpCmluZGl2aWR1YWxzX3VuY2hhbmdlZCA9IGluZGl2aWR1YWxzCgojIyBwZW9wbGUgd2hvc2UgcGFyZW50cyBjYW4gbm90IGJlIGlkZW50aWZpZWQgaGF2ZSB0byBiZSBtYXJrZWQgYXMgTkE6CmluZGl2aWR1YWxzJGZhdGhlcklEWyBpbmRpdmlkdWFscyRmYXRoZXJJRD41MF0gPSBOQQppbmRpdmlkdWFscyRtb3RoZXJJRFsgaW5kaXZpZHVhbHMkbW90aGVySUQ+NTBdID0gTkEKCgojIyBDcmVhdGUgZGF0ZSBvZiBiaXJ0aAojU2V0IGFsbCB2YXJpYWJsZXMgbWlzc2luZyB0aGF0IGhhdmUgbm90IGJlZW4gcmVwb3J0ZWQ6CmluZGl2aWR1YWxzJGFyMDhkYXlbIGluZGl2aWR1YWxzJGFyMDhkYXk+MzFdID0gTkEKaW5kaXZpZHVhbHMkYXIwOG10aFsgaW5kaXZpZHVhbHMkYXIwOG10aD4xMl0gPSBOQQppbmRpdmlkdWFscyRhcjA4eXJbIGluZGl2aWR1YWxzJGFyMDh5cj4yMDE2XSA9IE5BCmluZGl2aWR1YWxzJGFyMDhkYXlbIGlzLm5hbihpbmRpdmlkdWFscyRhcjA4ZGF5KSBdID0gTkEKaW5kaXZpZHVhbHMkYXIwOG10aFsgaXMubmFuKGluZGl2aWR1YWxzJGFyMDhtdGgpIF0gPSBOQQppbmRpdmlkdWFscyRhcjA4eXJbIGlzLm5hbihpbmRpdmlkdWFscyRhcjA4eXIpXSA9IE5BCmluZGl2aWR1YWxzJGRlYXRoX21vbnRoWyBpbmRpdmlkdWFscyRkZWF0aF9tb250aD4xMl0gPSBOQQppbmRpdmlkdWFscyRkZWF0aF95clsgaW5kaXZpZHVhbHMkZGVhdGhfeXI+MjAxNl0gPSBOQQppbmRpdmlkdWFscyRkZWF0aF9tb250aFsgaXMubmFuKGluZGl2aWR1YWxzJGRlYXRoX21vbnRoKSBdID0gTkEKaW5kaXZpZHVhbHMkZGVhdGhfeXJbIGlzLm5hbihpbmRpdmlkdWFscyRkZWF0aF95cildID0gTkEKCiMjIENyZWF0ZSB2YXJpYWJsZSB0aGF0IGNvbnRhaW5zIHBpZGxpbmsgb2YgbW90aGVyIGFuZCBiaXJ0aGRhdGUgb2YgY2hpbGQ6CmluZGl2aWR1YWxzID0gaW5kaXZpZHVhbHMgJT4lCiAgICBtdXRhdGUoYmlydGhkYXRlID0gYWxsX2F2YWlsYWJsZV9pbmZvX2JpcnRoX2RhdGUoYXIwOHlyLCBhcjA4bXRoLCBhcjA4ZGF5KSwKICAgICAgICAgICBtb3RoZXJfYmlydGhkYXRlID0gc3RyX2MobW90aGVyX3BpZGxpbmssICItIiwgYmlydGhkYXRlKSkgIyBtb3RoZXJfcGlkbGluay1ZWVlZLU1NOyBpcyBOQSBpZiBiaXJ0aF95ZWFyIGlzIG1pc3NpbmcKCmluZGl2aWR1YWxzID0gaW5kaXZpZHVhbHMgJT4lIGdyb3VwX2J5KG1vdGhlcl9waWRsaW5rKSAlPiUgCiAgbXV0YXRlKGJpcnRob3JkZXJfbmFpdmVfaW5kID0gaWZfZWxzZSghaXMubmEobW90aGVyX3BpZGxpbmspLCBtaW5fcmFuayhiaXJ0aGRhdGUpLCBOQV9pbnRlZ2VyXyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmVfaW5kID0gaWZfZWxzZSghaXMubmEobW90aGVyX3BpZGxpbmspLCBuKCksIE5BX2ludGVnZXJfKSkgJT4lIAogIHVuZ3JvdXAoKQoKIyNSZW1vdmUgYWxsIHdpdGggbWlzc2luZyBtb3RoZXJfYmlydGhkYXRlCiMgaW5kaXZpZHVhbHMgPSBpbmRpdmlkdWFscyAlPiUKIyAgIGZpbHRlcighaXMubmEobW90aGVyX2JpcnRoZGF0ZSkpCgojIAojIGluZGl2aWR1YWxzID0gaW5kaXZpZHVhbHMgJT4lCiMgICBncm91cF9ieShtb3RoZXJfYmlydGhkYXRlKSAlPiUKIyAgIG11dGF0ZSh0d2luX29yZGVyID0gcm93X251bWJlcihiaXJ0aGRhdGUpLAojICAgICAgICAgIG1vdGhlcl9iaXJ0aGRhdGVfdW5pcXVlID0gcGFzdGUwKG1vdGhlcl9iaXJ0aGRhdGUsICItIiwgdHdpbl9vcmRlcikpICU+JQojICAgdW5ncm91cCgpICU+JQojICAgc2VsZWN0KG1vdGhlcl9iaXJ0aGRhdGVfdW5pcXVlLCBwaWRsaW5rLCBzZXgsIGFnZSkKIyAKIyAKIyBwcmVnbmFuY3lfbWlzc2luZyA9IHByZWduYW5jeSAlPiUKIyAgIG11dGF0ZShtaXNzaW5nID0gaWZlbHNlKCEobW90aGVyX2JpcnRoZGF0ZV91bmlxdWUgJWluJSBpbmRpdmlkdWFscyRtb3RoZXJfYmlydGhkYXRlX3VuaXF1ZSksCiMgICAgICAgICAgICAgICAgICAgICAgICAgICAxLCAwKSkgJT4lCiMgICBmaWx0ZXIobWlzc2luZyA9PSAxKQoKIyBwcmV2ZW50IHRoYXQgdHdpbnMgZXhpc3QgNCB0aW1lcyBiZWNhdXNlIHRoZXkgYXBwZWFyIHR3aWNlIGluIHByZWduYW5jeSBhbmQgdHdpY2UgaW4gaW5kaXZpZHVhbHMsIGJ5IGVsaW1pbmF0aW5nIGR1cGVzIGZyb20gcHJlZ25hbmN5CiMgcHJlZ25hbmN5X25vdF9taXNzaW5nID0gcHJlZ25hbmN5ICU+JQojICAgbXV0YXRlKG1pc3NpbmcgPSBpZmVsc2UoIShtb3RoZXJfYmlydGhkYXRlX3VuaXF1ZSAlaW4lIGluZGl2aWR1YWxzJG1vdGhlcl9iaXJ0aGRhdGVfdW5pcXVlKSwKIyAgICAgICAgICAgICAgICAgICAgICAgICAgIDEsIDApKSAlPiUKIyAgIGZpbHRlcihtaXNzaW5nID09IDApICAgICAgICAgIAoKYWxsZGF0YV9wcmVnbmFuY3kgPSBmdWxsX2pvaW4ocHJlZ25hbmN5LCBpbmRpdmlkdWFscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnkgPSBjKCJtb3RoZXJfcGlkbGluayIsICJiaXJ0aGRhdGUiLCAibW90aGVyX2JpcnRoZGF0ZSIpKSAlPiUgCiAgZGlzdGluY3QobW90aGVyX3BpZGxpbmssIGJpcnRoZGF0ZSwgcGlkbGluaywgLmtlZXBfYWxsID0gVFJVRSkKCmFsbGRhdGFfcHJlZ25hbmN5ID0gYWxsZGF0YV9wcmVnbmFuY3kgJT4lIAogIGdyb3VwX2J5KG1vdGhlcl9waWRsaW5rKSAlPiUKICBtdXRhdGUoYW55X211bHRpcGxlX2JpcnRoZGF0ZSA9IGlmX2Vsc2UoYW55KGlmZWxzZSghaXMubmEoYmlydGhfbW9udGgpLCBkdXBsaWNhdGVkKGJpcnRoZGF0ZSksIE5BKSwgbmEucm0gPVQpLCAxLCAwKSkKCmNyb3NzdGFicyh+YWxsZGF0YV9wcmVnbmFuY3kkYW55X211bHRpcGxlX2JpcnRoZGF0ZSArIGFsbGRhdGFfcHJlZ25hbmN5JGFueV9tdWx0aXBsZV9iaXJ0aCkKCmFsbGRhdGFfcHJlZ25hbmN5ID0gYWxsZGF0YV9wcmVnbmFuY3kgJT4lIG11dGF0ZShhbnlfbXVsdGlwbGVfYmlydGggPSBpZmVsc2UoYW55X211bHRpcGxlX2JpcnRoZGF0ZSA9PSAxLCAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFueV9tdWx0aXBsZV9iaXJ0aCkpCmFsbGRhdGFfcHJlZ25hbmN5ID0gYWxsZGF0YV9wcmVnbmFuY3kgJT4lIGdyb3VwX2J5KG1vdGhlcl9waWRsaW5rKSAlPiUgCiAgbXV0YXRlKGJpcnRob3JkZXJfbmFpdmUgPSBtaW5fcmFuayhpZl9lbHNlKCFpcy5uYShtb3RoZXJfcGlkbGluayksIGJpcnRoZGF0ZSwgTkFfY2hhcmFjdGVyXykpLAogICAgICAgICBzaWJsaW5nX2NvdW50X25haXZlID0gaWZfZWxzZSghaXMubmEobW90aGVyX3BpZGxpbmspLCBuKCksIE5BX2ludGVnZXJfKSkgJT4lIAogICMgZmlsdGVyKGlzLm5hKGxpZmViaXJ0aHMpIHwgbGlmZWJpcnRocyA9PSAyKSAlPiUgCiAgIyBtdXRhdGUoYmlydGhvcmRlcl9uYWl2ZTMgPSBpZl9lbHNlKCFpcy5uYShtb3RoZXJfcGlkbGluaykgJiAoaXMubmEobGlmZWJpcnRocykgfCBsaWZlYmlydGhzID09IDIpLCBtaW5fcmFuayhiaXJ0aGRhdGUpLCBOQV9pbnRlZ2VyXyksCiAgIyAgICAgICAgc2libGluZ19jb3VudF9uYWl2ZTMgPSBpZl9lbHNlKCFpcy5uYShtb3RoZXJfcGlkbGluaykgJiAoaXMubmEobGlmZWJpcnRocykgfCBsaWZlYmlydGhzID09IDIpLCBzdW0oaXMubmEobGlmZWJpcnRocykgfCBsaWZlYmlydGhzID09IDIpLCBOQV9pbnRlZ2VyXykpICU+JSAKICB1bmdyb3VwKCkKCiMgYWxsZGF0YV9wcmVnbmFuY3kgPSBiaW5kX3Jvd3MoYWxsZGF0YV9wcmVnbmFuY3ksIHByZWduYW5jeV9taXNzaW5nKQoKcHJvcC50YWJsZSh0YWJsZShhbGxkYXRhX3ByZWduYW5jeSRtdWx0aXBsZV9iaXJ0aCkpCnByb3AudGFibGUodGFibGUoYWxsZGF0YV9wcmVnbmFuY3kkYW55X211bHRpcGxlX2JpcnRoKSkKCmFsbGRhdGFfcHJlZ25hbmN5ICU+JSBzZWxlY3QoYmlydGhvcmRlcl9uYWl2ZSxiaXJ0aG9yZGVyX25haXZlX2luZCxjaHJvbl9vcmRlcl9iaXJ0aCwgYmlydGhvcmRlcl91dGVydXNfYWxpdmUsIGJpcnRob3JkZXJfdXRlcnVzX3ByZWcsIGJpcnRob3JkZXJfZ2VuZXMpICU+JSBjb3IodXNlPSdwYWlyd2lzZS5jb21wbGV0ZS5vYnMnKSAlPiUgcm91bmQoMikKYWxsZGF0YV9wcmVnbmFuY3kgJT4lIHNlbGVjdChiaXJ0aG9yZGVyX25haXZlLCBjaHJvbl9vcmRlcl9iaXJ0aCwgYmlydGhvcmRlcl91dGVydXNfYWxpdmUsIGJpcnRob3JkZXJfdXRlcnVzX3ByZWcsIGJpcnRob3JkZXJfZ2VuZXMpICU+JSBjb2RlYm9vazo6bWRfcGF0dGVybigpCmFsbGRhdGFfcHJlZ25hbmN5ICU+JSBzZWxlY3Qoc2libGluZ19jb3VudF9uYWl2ZSwgc2libGluZ19jb3VudF91dGVydXNfYWxpdmUsIHNpYmxpbmdfY291bnRfdXRlcnVzX3ByZWcsIHNpYmxpbmdfY291bnRfZ2VuZXMpICU+JSBjb3IodXNlPSdwYWlyd2lzZS5jb21wbGV0ZS5vYnMnKSAlPiUgcm91bmQoMikKCnFwbG90KGRhdGE9YWxsZGF0YV9wcmVnbmFuY3ksc2libGluZ19jb3VudF9uYWl2ZSkgKyBmYWNldF93cmFwKH4gaXMubmEoc2libGluZ19jb3VudF91dGVydXNfcHJlZykpCnFwbG90KGRhdGE9YWxsZGF0YV9wcmVnbmFuY3ksYmlydGhvcmRlcl9uYWl2ZSkgKyBmYWNldF93cmFwKH4gaXMubmEoc2libGluZ19jb3VudF91dGVydXNfcHJlZykpCgojIHByb3AudGFibGUodGFibGUoYWxsZGF0YV9wcmVnbmFuY3kkYmlydGhvcmRlcl91dGVydXNfYWxpdmUgPT0gYWxsZGF0YV9wcmVnbmFuY3kkYmlydGhvcmRlcl9uYWl2ZTMpKQpwcm9wLnRhYmxlKHRhYmxlKGFsbGRhdGFfcHJlZ25hbmN5JGJpcnRob3JkZXJfdXRlcnVzX2FsaXZlID09IGFsbGRhdGFfcHJlZ25hbmN5JGJpcnRob3JkZXJfbmFpdmUpKQpwcm9wLnRhYmxlKHRhYmxlKGFsbGRhdGFfcHJlZ25hbmN5JGJpcnRob3JkZXJfdXRlcnVzX3ByZWcgPT0gYWxsZGF0YV9wcmVnbmFuY3kkYmlydGhvcmRlcl9uYWl2ZSkpCmdncGxvdChhbGxkYXRhX3ByZWduYW5jeSwgYWVzKHg9YmlydGhvcmRlcl91dGVydXNfYWxpdmUsIHk9YmlydGhvcmRlcl9uYWl2ZSkpICsgZ2VvbV9qaXR0ZXIoYWxwaGEgPSAwLjEpCiMgaXQgbWFrZXMgc2Vuc2UgdGhhdCB0aGUgYmlydGggb3JkZXIgYmFzZWQgb24gaW5jbHVkaW5nIHRoZSBwcmVnbmFuY3kgZmlsZSBpcyBzdHJpY3RseSBoaWdoZXIsIGJlY2F1c2UKIyB0aGlzIGluY2x1ZGVzIHBlb3BsZSB3aG8gbW92ZWQgYXdheQpnZ3Bsb3QoYWxsZGF0YV9wcmVnbmFuY3ksIGFlcyh4PWJpcnRob3JkZXJfbmFpdmVfaW5kLCB5PWJpcnRob3JkZXJfbmFpdmUpKSArIGdlb21faml0dGVyKGFscGhhID0gMC4xKQpnZ3Bsb3QoYWxsZGF0YV9wcmVnbmFuY3ksIGFlcyh4PXNpYmxpbmdfY291bnRfbmFpdmVfaW5kLCB5PXNpYmxpbmdfY291bnRfbmFpdmUpKSArIGdlb21faml0dGVyKGFscGhhID0gMC4xKQoKCiMgYWxsZGF0YV9wcmVnbmFuY3kgJT4lIGZpbHRlcihtb3RoZXJfcGlkbGluayA9PSAiMDAxMDYwMDA3IikgJT4lIHNlbGVjdChiaXJ0aG9yZGVyX25haXZlLGJpcnRob3JkZXJfbmFpdmVfaW5kLCBiaXJ0aG9yZGVyX3V0ZXJ1c19hbGl2ZSwgc2libGluZ19jb3VudF9uYWl2ZSwgc2libGluZ19jb3VudF91dGVydXNfYWxpdmUsIG1vdGhlcl9waWRsaW5rLCBiaXJ0aGRhdGUsIG1vdGhlcl9iaXJ0aGRhdGUpICU+JSBWaWV3KCkKCgpjb3IudGVzdChhbGxkYXRhX3ByZWduYW5jeSRzaWJsaW5nX2NvdW50X3V0ZXJ1c19hbGl2ZSwgYWxsZGF0YV9wcmVnbmFuY3kkc2libGluZ19jb3VudF9uYWl2ZSkKY3Jvc3N0YWJzKGFsbGRhdGFfcHJlZ25hbmN5JHNpYmxpbmdfY291bnRfdXRlcnVzX2FsaXZlID09IGFsbGRhdGFfcHJlZ25hbmN5JHNpYmxpbmdfY291bnRfbmFpdmVfaW5kKQpjcm9zc3RhYnMoYWxsZGF0YV9wcmVnbmFuY3kkc2libGluZ19jb3VudF91dGVydXNfYWxpdmUgPT0gYWxsZGF0YV9wcmVnbmFuY3kkc2libGluZ19jb3VudF9uYWl2ZSkKY3Jvc3N0YWJzKH4gSShzaWJsaW5nX2NvdW50X3V0ZXJ1c19hbGl2ZSA9PSBzaWJsaW5nX2NvdW50X25haXZlX2luZCkgKyAKICAgICAgICAgICAgSShzaWJsaW5nX2NvdW50X3V0ZXJ1c19hbGl2ZSA9PSBzaWJsaW5nX2NvdW50X25haXZlKSwgYWxsZGF0YV9wcmVnbmFuY3kpCmNyb3NzdGFicyhhbGxkYXRhX3ByZWduYW5jeSRzaWJsaW5nX2NvdW50X3V0ZXJ1c19hbGl2ZSA9PSBhbGxkYXRhX3ByZWduYW5jeSRzaWJsaW5nX2NvdW50X25haXZlKQpnZ3Bsb3QoYWxsZGF0YV9wcmVnbmFuY3ksIGFlcyh4PXNpYmxpbmdfY291bnRfdXRlcnVzX2FsaXZlLCB5PXNpYmxpbmdfY291bnRfbmFpdmUpKSArIGdlb21faml0dGVyKGFscGhhID0gMC4xKQoKY3Jvc3N0YWJzKCB+IEkoc2libGluZ19jb3VudF91dGVydXNfYWxpdmUgPT0gc2libGluZ19jb3VudF9uYWl2ZSkgKyBpcy5uYShiaXJ0aGRhdGUpLCBkYXRhID0gYWxsZGF0YV9wcmVnbmFuY3kpCmBgYAoKCiMjIEludGVsbGlnZW5jZSB7LnRhYnNldH0KYGBge3Igc2VsZWN0IElRIGRhdGF9CiMjIyBJUSBJbmZvcm1hdGlvbnMgZnJvbSB3YXZlIDUgKDIwMTQpCiMjZWsyICg+MTR5cnMsIGluY2x1ZGVzIG9ubHkgaW5kaXZpZHVhbHMsIHRoYXQgYXJlIDE1IHllYXJzIG9yIG9sZGVyKQppcTIuMSA9IGVrX2VrMiAlPiUgc2VsZWN0KGhoaWQxNF85LCBwaWRsaW5rLCBhZ2UsIHNleCwgZWt0eXBlLCByZXNwdHlwZSwgcmVzdWx0LCByZWFzb24sIGVrMV9hbnMsIGVrMl9hbnMsIGVrM19hbnMsIGVrNF9hbnMsIGVrNV9hbnMsIGVrNl9hbnMsIGVrN19hbnMsIGVrOF9hbnMsIGVrOV9hbnMsIGVrMTBfYW5zLCBlazExX2FucywgZWsxMl9hbnMsIGVrMTNfYW5zLCBlazE0X2FucywgZWsxNV9hbnMsIGVrMTZfYW5zLCBlazE3X2FucywgZWsxOF9hbnMsIGVrMTlfYW5zLCBlazIwX2FucywgZWsyMV9hbnMsIGVrMjJfYW5zKQoKIyNlazIgKDwxNHlycywgaW5jbHVkZXMgYWxsIGluZGl2aWR1YWxzLCB0aGF0IGFyZSB5b3VuZ2VyIHRoYW4gMTUgeWVhcnMgb2xkKQppcTMuMSA9IGVrX2VrMSAlPiUgc2VsZWN0KGhoaWQxNF85LCBwaWRsaW5rLCBhZ2UsIHNleCwgZWt0eXBlLCByZXNwdHlwZSwgcmVzdWx0LCByZWFzb24sIGVrMV9hbnMsIGVrMl9hbnMsIGVrM19hbnMsIGVrNF9hbnMsIGVrNV9hbnMsIGVrNl9hbnMsIGVrN19hbnMsIGVrOF9hbnMsIGVrOV9hbnMsIGVrMTBfYW5zLCBlazExX2FucywgZWsxMl9hbnMsIGVrMTNfYW5zLCBlazE0X2FucywgZWsxNV9hbnMsIGVrMTZfYW5zLCBlazE3X2FucywgZWsxOF9hbnMsIGVrMTlfYW5zLCBlazIwX2FucywgZWsyMV9hbnMsIGVrMjJfYW5zKQoKIyMjIyBSYXZlbiBUZXN0ICh3YXZlIDIwMTUsIHlvdW5nZXIgdGhhbiAxNSB5ZWFycykKYW5zd2VyZWRfcmF2ZW5faXRlbXMgPSBpcTMuMSAlPiUgc2VsZWN0KGVrMV9hbnM6ZWsxMl9hbnMpCnBzeWNoOjphbHBoYShkYXRhLmZyYW1lKGFuc3dlcmVkX3JhdmVuX2l0ZW1zKSkKaXEzLjEkcmF2ZW5fMjAxNV95b3VuZyA9IHJvd01lYW5zKCBhbnN3ZXJlZF9yYXZlbl9pdGVtcywgbmEucm0gPSBUKQpxcGxvdChpcTMuMSRyYXZlbl8yMDE1X3lvdW5nKQoKIyMjIyBNYXRoIFRlc3QgKHdhdmUgMjAxNSwgeW91bmdlciB0aGFuIDE1IHllYXJzKQphbnN3ZXJlZF9tYXRoX2l0ZW1zID0gaXEzLjEgJT4lIHNlbGVjdChlazEzX2FuczplazE3X2FucykKcHN5Y2g6OmFscGhhKGRhdGEuZnJhbWUoYW5zd2VyZWRfbWF0aF9pdGVtcykpCmlxMy4xJG1hdGhfMjAxNV95b3VuZyA9IHJvd01lYW5zKCBhbnN3ZXJlZF9tYXRoX2l0ZW1zLCBuYS5ybSA9IFQpCnFwbG90KGlxMy4xJG1hdGhfMjAxNV95b3VuZykKCmlxMy4xID0gaXEzLjEgJT4lIHNlbGVjdChwaWRsaW5rLCBhZ2VfMjAxNV95b3VuZyA9IGFnZSwgc2V4XzIwMTVfeW91bmcgPSBzZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICByYXZlbl8yMDE1X3lvdW5nLCBtYXRoXzIwMTVfeW91bmcsIHJlYXNvbl8yMDE1X3lvdW5nID0gcmVhc29uKQoKIyNhZGRpdGlvbmFsIGluZm9ybWF0aW9ucyBmb3IgYWR1bHRzOiBjb3VudGluZyBiYWNrd2FyZHMKaXEyLjIgPSBiM2JfY28xICU+JSBzZWxlY3QoaGhpZDE0XzksIHBpZGxpbmssIGNvMDRhLCBjbzA0YiwgY28wNGMsIGNvMDRkLCBjbzA0ZSwgY28wN2NvdW50LCBjbzEwY291bnQpCiMjYWRkaXRpb25hbCBpbmZvcm1hdGlvbnMgZm9yIGFkdWx0czogYWRhcHRpdmUgbnVtYmVyIHRlc3QKaXEyLjMgPSBiM2JfY29iICU+JSBzZWxlY3QoaGhpZDE0XzksIHBpZGxpbmssIHdfYWJpbCwgY29iMTgsIGNvYjE5YikKCiMjIHB1dCBhbGwgdGhlIGluZm9ybWF0aW9ucyBmb3IgcGFydGljaXBhbnRzID49IDE1IHRvZ2V0aGVyCmlxMiA9IGZ1bGxfam9pbihpcTIuMSwgaXEyLjIsIGJ5ID0gInBpZGxpbmsiKQppcTIgPSBmdWxsX2pvaW4oaXEyLCBpcTIuMywgYnkgPSAicGlkbGluayIpCmlxID0gaXEyCmlxIDwtIHJlbmFtZShpcSwgYWdlXzIwMTVfb2xkID0gYWdlLCByZWFzb25fMjAxNV9vbGQgPSByZWFzb24sIHNleF8yMDE1X29sZCA9IHNleCkgCmlxID0gZnVsbF9qb2luKGlxLCBpcTMuMSwgYnkgPSAicGlkbGluayIpCgojIyMgY2FsY3VsYXRlIGlxIHNjb3JlcwojI1JhdmVuIFRlc3QgKHdhdmUgMjAxNSwgb2xkZXIgdGhhbiAxNCB5ZWFycykKYW5zd2VyZWRfcmF2ZW5faXRlbXMgPSBpcSAlPiUgc2VsZWN0KGVrMV9hbnM6ZWs2X2FucywgZWsxMV9hbnMsIGVrMTJfYW5zKQpwc3ljaDo6YWxwaGEoZGF0YS5mcmFtZShhbnN3ZXJlZF9yYXZlbl9pdGVtcykpCmlxJHJhdmVuXzIwMTVfb2xkID0gcm93TWVhbnMoIGFuc3dlcmVkX3JhdmVuX2l0ZW1zLCBuYS5ybSA9IFQpCnFwbG90KGlxJHJhdmVuXzIwMTVfb2xkKQoKIyNNYXRoIFRlc3QgKHdhdmUgMjAxNSwgb2xkZXIgdGhhbiAxNCB5ZWFycykKYW5zd2VyZWRfbWF0aF9pdGVtcyA9IGlxICU+JSBzZWxlY3QoZWsxOF9hbnM6ZWsyMl9hbnMpCnBzeWNoOjphbHBoYShkYXRhLmZyYW1lKGFuc3dlcmVkX21hdGhfaXRlbXMpKQppcSRtYXRoXzIwMTVfb2xkID0gcm93TWVhbnMoIGFuc3dlcmVkX21hdGhfaXRlbXMsIG5hLnJtID0gVCkKcXBsb3QoaXEkbWF0aF8yMDE1X29sZCkKCgojI0NvdW50aW5nIEl0ZW1zCiMgQ3JlYXRlIFJpZ2h0L1dyb25nIFNjb3JlcyBmb3IgdGhlIGNvdW50aW5nIGl0ZW1zCmlxJGNvMDRhcmlnaHQgPSBhcy5udW1lcmljKGlxJGNvMDRhID09IDkzKQppcSRjbzA0YnJpZ2h0ID0gYXMubnVtZXJpYyhpcSRjbzA0YiA9PSBpcSRjbzA0YS03KQppcSRjbzA0Y3JpZ2h0ID0gYXMubnVtZXJpYyhpcSRjbzA0YyA9PSBpcSRjbzA0Yi03KQppcSRjbzA0ZHJpZ2h0ID0gYXMubnVtZXJpYyhpcSRjbzA0ZCA9PSBpcSRjbzA0Yy03KQppcSRjbzA0ZXJpZ2h0ID0gYXMubnVtZXJpYyhpcSRjbzA0ZSA9PSBpcSRjbzA0ZC03KQoKYW5zd2VyZWRfY291bnRpbmdfaXRlbXMgPSBpcSAlPiUgc2VsZWN0KGNvMDRhcmlnaHQ6Y28wNGVyaWdodCkKcHN5Y2g6OmFscGhhKGRhdGEuZnJhbWUoYW5zd2VyZWRfY291bnRpbmdfaXRlbXMpKQppcSRjb3VudF9iYWNrd2FyZHMgPSByb3dNZWFucyggYW5zd2VyZWRfY291bnRpbmdfaXRlbXMsIG5hLnJtID0gVCkKcXBsb3QoaXEkY291bnRfYmFja3dhcmRzKQoKIyMgV29yZCBNZW1vcnkKaXEkd29yZHNfaW1tZWRpYXRlID0gaXEkY28wN2NvdW50CmlxJHdvcmRzX2RlbGF5ZWQgPSBpcSRjbzEwY291bnQKcXBsb3QoaXEkd29yZHNfaW1tZWRpYXRlLCBpcSR3b3Jkc19kZWxheWVkLCBnZW9tID0gImppdHRlciIpCmFuc3dlcmVkX3dvcmRfaXRlbXMgPSBpcSAlPiUgc2VsZWN0KGNvMDdjb3VudCxjbzEwY291bnQpCnBzeWNoOjphbHBoYShkYXRhLmZyYW1lKGFuc3dlcmVkX3dvcmRfaXRlbXMpKQppcSR3b3Jkc19yZW1lbWJlcmVkX2F2ZyA9IHJvd01lYW5zKCBhbnN3ZXJlZF93b3JkX2l0ZW1zLCBuYS5ybSA9IFQpCnFwbG90KGlxJHdvcmRzX3JlbWVtYmVyZWRfYXZnKQoKIyNBZGFwdGl2ZSBOdW1iZXJpbmcKaXEkYWRhcHRpdmVfbnVtYmVyaW5nID0gaXEkd19hYmlsCnFwbG90KGlxJGFkYXB0aXZlX251bWJlcmluZykKCgojIHNvbWUgcGVvcGxlIGhhdmUgcmVhc29ucyBub3QgdG8gYW5zd2VyIHRoZSB0ZXN0IChkZWFkLCBub3QgY29udGFjdGVkKSwgdGhhdCBkb250IGp1c3RpZnkKIyBnaXZpbmcgdGhlbSB6ZXJvIHBvaW50cyBmb3IgdGhhdCB0YXNrLiBzbyBpIHNldCB0aGVzZSB0byBOQQojIGFkZGl0aW9uYWxseSBhbGwgcGFydGljaXBhbnRzIG9sZGVyIHRoYW4gNTkgb25seSBhbnN3ZXJlZCB0aGUgUmF2ZW4gVGVzdCwgbm90IHRoZSBNYXRoIAojIFRlc3QKaXEgPSBpcSAlPiUKICBtdXRhdGUocmVhc29uXzIwMTVfeW91bmcgPSBpZmVsc2UocmVhc29uXzIwMTVfeW91bmcgPT0gMSwgInJlZnVzZWQiLAogICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDE1X3lvdW5nID09IDIsICJjYW5ub3QgcmVhZCIsCiAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMTVfeW91bmcgPT0gMywgInVuYWJsZSB0byBhbnN3ZXIiLAogICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDE1X3lvdW5nID09IDQsICJub3QgZW5vdWdoIHRpbWUiLAogICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDE1X3lvdW5nID09IDUsICJwcm94eSByZXNwb25kZW50IiwKICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAxNV95b3VuZyA9PSA2LCAib3RoZXIiLAogICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDE1X3lvdW5nID09IDcsICJjb3VsZCBub3QgYmUgY29udGFjdGVkIiwgTkEpKSkpKSkpLAogICAgICAgICByYXZlbl8yMDE1X3lvdW5nID0gaWZlbHNlKGlzLm5hKHJlYXNvbl8yMDE1X3lvdW5nKSwgcmF2ZW5fMjAxNV95b3VuZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMTVfeW91bmcgPT0gImNhbm5vdCByZWFkInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfeW91bmcgPT0gIm5vdCBlbm91Z2ggdGltZSJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDE1X3lvdW5nID09ICJwcm94eSByZXNwb25kZW50InwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfeW91bmcgPT0gIm90aGVyInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfeW91bmcgPT0gInJlZnVzZWQifAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAxNV95b3VuZyA9PSAiY291bGQgbm90IGJlIGNvbnRhY3RlZCIsIE5BLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXZlbl8yMDE1X3lvdW5nKSksCiAgICAgICAgIG1hdGhfMjAxNV95b3VuZyA9IGlmZWxzZShpcy5uYShyZWFzb25fMjAxNV95b3VuZyksIG1hdGhfMjAxNV95b3VuZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMTVfeW91bmcgPT0gImNhbm5vdCByZWFkInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfeW91bmcgPT0gIm5vdCBlbm91Z2ggdGltZSJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDE1X3lvdW5nID09ICJwcm94eSByZXNwb25kZW50InwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfeW91bmcgPT0gIm90aGVyInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfeW91bmcgPT0gInJlZnVzZWQifAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAxNV95b3VuZyA9PSAiY291bGQgbm90IGJlIGNvbnRhY3RlZCIsIE5BLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRoXzIwMTVfeW91bmcpKSwKICAgICAgICAgcmVhc29uXzIwMTVfb2xkID0gaWZlbHNlKHJlYXNvbl8yMDE1X29sZCA9PSAxLCAicmVmdXNlZCIsCiAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMTVfb2xkID09IDIsICJjYW5ub3QgcmVhZCIsCiAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMTVfb2xkID09IDMsICJ1bmFibGUgdG8gYW5zd2VyIiwKICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAxNV9vbGQgPT0gNCwgIm5vdCBlbm91Z2ggdGltZSIsCiAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMTVfb2xkID09IDUsICJwcm94eSByZXNwb25kZW50IiwKICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAxNV9vbGQgPT0gNiwgIm90aGVyIiwKICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAxNV9vbGQgPT0gNywgImNvdWxkIG5vdCBiZSBjb250YWN0ZWQiLCBOQSkpKSkpKSksCiAgICAgICAgIHJhdmVuXzIwMTVfb2xkID0gaWZlbHNlKGlzLm5hKHJlYXNvbl8yMDE1X29sZCksIHJhdmVuXzIwMTVfb2xkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAxNV9vbGQgPT0gImNhbm5vdCByZWFkInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfb2xkID09ICJub3QgZW5vdWdoIHRpbWUifAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAxNV9vbGQgPT0gInByb3h5IHJlc3BvbmRlbnQifAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAxNV9vbGQgPT0gIm90aGVyInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfb2xkID09ICJyZWZ1c2VkInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfb2xkID09ICJjb3VsZCBub3QgYmUgY29udGFjdGVkIiwgTkEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdmVuXzIwMTVfb2xkKSksCiAgICAgICAgIG1hdGhfMjAxNV9vbGQgPSBpZmVsc2UoaXMubmEocmVhc29uXzIwMTVfb2xkKSwgbWF0aF8yMDE1X29sZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMTVfb2xkID09ICJjYW5ub3QgcmVhZCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDE1X29sZCA9PSAibm90IGVub3VnaCB0aW1lInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfb2xkID09ICJwcm94eSByZXNwb25kZW50InwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMTVfb2xkID09ICJvdGhlciJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDE1X29sZCA9PSAicmVmdXNlZCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDE1X29sZCA9PSAiY291bGQgbm90IGJlIGNvbnRhY3RlZCIsIE5BLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRoXzIwMTVfb2xkKSksCiAgICAgICAgIG1hdGhfMjAxNV9vbGQgPSBpZmVsc2UoYWdlXzIwMTVfb2xkID49IDYwLCBOQSwgbWF0aF8yMDE1X29sZCkpCgppcSAlPiUgc2VsZWN0KHJhdmVuXzIwMTVfb2xkLCBtYXRoXzIwMTVfb2xkLCByYXZlbl8yMDE1X3lvdW5nLCBtYXRoXzIwMTVfeW91bmcsIGNvdW50X2JhY2t3YXJkcywgd29yZHNfaW1tZWRpYXRlLCB3b3Jkc19kZWxheWVkLCBhZGFwdGl2ZV9udW1iZXJpbmcpICU+JSB0aWR5cjo6Z2F0aGVyKCkgJT4lCiAgZ2dwbG90KGFlcyh2YWx1ZSkpICsgZ2VvbV9iYXIoKSArIGZhY2V0X3dyYXAofiBrZXksIHNjYWxlcyA9ICJmcmVlIikKYGBgCgojIyMgSVEtVGVzdHMgZWFybGllciB3YXZlcwpgYGB7cn0KIyMgV2F2ZSA0IC0gMjAwNwojIyMgRGF0YQppcTIwMDdfZWsyPSBiZWtfZWsyICU+JQogIHNlbGVjdChwaWRsaW5rLCBla3R5cGUsIHJlYXNvbl8yMDA3X29sZCA9IHJlYXNvbiwgImFnZV8yMDA3X29sZCIgPSBhZ2UsCiAgICAgICAgIHNleF8yMDA3X29sZCA9IHNleCwgbWF0Y2hlcygiZWtbMC05XXgiKSwgbWF0Y2hlcygiZWtbMC05XVswLTldeCIpKQoKaXEyMDA3X2VrMT0gYmVrX2VrMSAlPiUKICBzZWxlY3QocGlkbGluaywgZWt0eXBlLCByZWFzb25fMjAwN195b3VuZyA9IHJlYXNvbiwgImFnZV8yMDA3X3lvdW5nIiA9IGFnZSwKICAgICAgICAgc2V4XzIwMDdfeW91bmcgPSBzZXgsIG1hdGNoZXMoImVrWzAtOV14IiksIG1hdGNoZXMoImVrWzAtOV1bMC05XXgiKSkgJT4lCiAgZmlsdGVyKCEocGlkbGluayAlaW4lIGlxMjAwN19lazIkcGlkbGluaykpCgojIHNvbWUgcGVvcGxlIGFuc3dlcmVkIGJvdGggdmVyc2lvbnMgb2YgdGhlIHRlc3QKIyAoZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhleSBoYWQgc2VlbiB0ZXN0IGVrMSBhbHJlYWR5IGluIDIwMDApCiMgSW4gb3JkZXIgdG8gZGVhbCB3aXRoIHRoZW0gaSBmb3JtIGFuIGFkZGl0aW9uYWwgZGF0YXNldCB0aGF0IGluY2x1ZGVzIHRoZSBpbmZvcm1hdGlvbiBmcm9tCiMgdGhlIHBlb3BsZSB0aGF0IHJlcGVhdGVkIHRoZSBmaXJzdCB0ZXN0IGFuZCB0aGVpciBzY29yZSBvbiB0aGUgZmlyc3QgdGVzdCBpbiAyMDA3CiMgdGhhdCBtZWFucyB0aGV5IGhhdmUgYWxyZWFkeSBzZWVuIHRoZSB0ZXN0IDcgeWVhcnMgYmVmb3JlLi4uCiMgaSBtZXJnZSB0aGlzIGRhdGEgbGF0ZXIgaW4gdGhlIHNhbWUgY29sdW1uIGFzIHRoZSBvdGhlciBzY29yZXMgaW4gMjAwNyBpbiB0aGUgZmlyc3QgdGVzdAojIGNoZWNrIHdpdGggUnViZW4sIGlmIHRoYXQgaXMgdGhlIHJpZ2h0IHdheSB0byBnby4uLgoKaXEyMDA3X2VrMV9yZXBlYXRlciA9IGJla19lazEgJT4lCiAgc2VsZWN0KHBpZGxpbmssIGVrdHlwZSwgcmVhc29uXzIwMDdfeW91bmdfcmVwZWF0ZXIgPSByZWFzb24sCiAgICAgICAgICJhZ2VfMjAwN195b3VuZ19yZXBlYXRlciIgPSBhZ2UsIHNleF8yMDA3X3lvdW5nX3JlcGVhdGVyID0gc2V4LAogICAgICAgICBtYXRjaGVzKCJla1swLTldeCIpLCBtYXRjaGVzKCJla1swLTldWzAtOV14IikpICU+JQogIGZpbHRlcigocGlkbGluayAlaW4lIGlxMjAwN19lazIkcGlkbGluaykpCgppcTIwMDcgPSBiaW5kX3Jvd3MoaXEyMDA3X2VrMSwgaXEyMDA3X2VrMikgCgojIyMgUmF2ZW4KaXEyMDA3ID0gaXEyMDA3ICU+JQogIG11dGF0ZShlazF4ID0gaWZlbHNlKGVrMXggPT0gMSwgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsxeCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazJ4ID0gaWZlbHNlKGVrMnggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMnggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWszeCA9IGlmZWxzZShlazN4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazN4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrNHggPSBpZmVsc2UoZWs0eCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWs0eCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazV4ID0gaWZlbHNlKGVrNXggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrNXggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWs2eCA9IGlmZWxzZShlazZ4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazZ4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrN3ggPSBpZmVsc2UoZWs3eCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWs3eCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazh4ID0gaWZlbHNlKGVrOHggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrOHggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWs5eCA9IGlmZWxzZShlazl4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazl4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMTB4ID0gaWZlbHNlKGVrMTB4ID09IDEsIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMTB4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMTF4ID0gaWZlbHNlKGVrMTF4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazExeCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazEyeCA9IGlmZWxzZShlazEyeCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsxMnggPT0gNiwgTkEsIDApKSkKCmFuc3dlcmVkX3JhdmVuX2l0ZW1zID0gaXEyMDA3ICU+JSBzZWxlY3QoZWsxeDplazEyeCkKcHN5Y2g6OmFscGhhKGRhdGEuZnJhbWUoYW5zd2VyZWRfcmF2ZW5faXRlbXMpKQppcTIwMDckcmF2ZW4yMDA3ID0gcm93TWVhbnMoYW5zd2VyZWRfcmF2ZW5faXRlbXMsIG5hLnJtID0gVCkKaXEyMDA3ID0gaXEyMDA3ICU+JQogIG11dGF0ZShyYXZlbl8yMDA3X3lvdW5nID0gaWZlbHNlKGVrdHlwZSA9PSAxLCByYXZlbjIwMDcsIE5BKSwKICAgICAgICAgcmF2ZW5fMjAwN19vbGQgPSBpZmVsc2UoZWt0eXBlID09IDIsIHJhdmVuMjAwNywgTkEpKQpxcGxvdChpcTIwMDckcmF2ZW5fMjAwN195b3VuZykKcXBsb3QoaXEyMDA3JHJhdmVuXzIwMDdfb2xkKQoKCiMjTWF0aCBUZXN0CmlxMjAwNyA9IGlxMjAwNyAlPiUKICBtdXRhdGUoZWsxM3ggPSBpZmVsc2UoZWsxM3ggPT0gMSwgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsxM3ggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWsxNHggPSBpZmVsc2UoZWsxNHggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMTR4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMTV4ID0gaWZlbHNlKGVrMTV4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazE1eCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazE2eCA9IGlmZWxzZShlazE2eCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsxNnggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWsxN3ggPSBpZmVsc2UoZWsxN3ggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMTd4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMTh4ID0gaWZlbHNlKGVrMTh4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazE4eCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazE5eCA9IGlmZWxzZShlazE5eCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsxOXggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWsyMHggPSBpZmVsc2UoZWsyMHggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMjB4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMjF4ID0gaWZlbHNlKGVrMjF4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazIxeCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazIyeCA9IGlmZWxzZShlazIyeCA9PSAxLCAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazIyeCA9PSA2LCBOQSwgMCkpKQoKYW5zd2VyZWRfbWF0aF9pdGVtcyA9IGlxMjAwNyAlPiUgc2VsZWN0KGVrMTN4OmVrMjJ4KQppcTIwMDckbWF0aDIwMDcgPSByb3dNZWFucyggYW5zd2VyZWRfbWF0aF9pdGVtcywgbmEucm0gPSBUKQppcTIwMDcgPSBpcTIwMDcgJT4lCiAgbXV0YXRlKG1hdGhfMjAwN195b3VuZyA9IGlmZWxzZShla3R5cGUgPT0gMSwgbWF0aDIwMDcsIE5BKSwKICAgICAgICAgbWF0aF8yMDA3X29sZCA9IGlmZWxzZShla3R5cGUgPT0gMiwgbWF0aDIwMDcsIE5BKSkKcXBsb3QoaXEyMDA3JG1hdGhfMjAwN195b3VuZykKcXBsb3QoaXEyMDA3JG1hdGhfMjAwN19vbGQpCgoKaXEyMDA3ID0gaXEyMDA3ICU+JSBzZWxlY3QocGlkbGluaywgYWdlXzIwMDdfeW91bmcsIGFnZV8yMDA3X29sZCwgc2V4XzIwMDdfeW91bmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNleF8yMDA3X29sZCwgcmF2ZW5fMjAwN195b3VuZywgcmF2ZW5fMjAwN19vbGQsIG1hdGhfMjAwN195b3VuZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0aF8yMDA3X29sZCwgcmVhc29uXzIwMDdfb2xkLCByZWFzb25fMjAwN195b3VuZykKCiMjRG8gdGhlIHNhbWUgZm9yIHRoZSByZXBlYXRlcgojIyMgUmF2ZW4KaXEyMDA3X2VrMV9yZXBlYXRlciA9IGlxMjAwN19lazFfcmVwZWF0ZXIgJT4lCiAgbXV0YXRlKGVrMXggPSBpZmVsc2UoZWsxeCA9PSAxLCAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazF4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMnggPSBpZmVsc2UoZWsyeCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsyeCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazN4ID0gaWZlbHNlKGVrM3ggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrM3ggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWs0eCA9IGlmZWxzZShlazR4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazR4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrNXggPSBpZmVsc2UoZWs1eCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWs1eCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazZ4ID0gaWZlbHNlKGVrNnggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrNnggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWs3eCA9IGlmZWxzZShlazd4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazd4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrOHggPSBpZmVsc2UoZWs4eCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWs4eCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazl4ID0gaWZlbHNlKGVrOXggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrOXggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWsxMHggPSBpZmVsc2UoZWsxMHggPT0gMSwgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsxMHggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWsxMXggPSBpZmVsc2UoZWsxMXggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMTF4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMTJ4ID0gaWZlbHNlKGVrMTJ4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazEyeCA9PSA2LCBOQSwgMCkpKQoKYW5zd2VyZWRfcmF2ZW5faXRlbXMgPSBpcTIwMDdfZWsxX3JlcGVhdGVyICU+JSBzZWxlY3QoZWsxeDplazEyeCkKcHN5Y2g6OmFscGhhKGRhdGEuZnJhbWUoYW5zd2VyZWRfcmF2ZW5faXRlbXMpKQppcTIwMDdfZWsxX3JlcGVhdGVyJHJhdmVuXzIwMDdfeW91bmdfcmVwZWF0ZXIgPSByb3dNZWFucyhhbnN3ZXJlZF9yYXZlbl9pdGVtcywgbmEucm0gPSBUKQpxcGxvdChpcTIwMDdfZWsxX3JlcGVhdGVyJHJhdmVuXzIwMDdfeW91bmdfcmVwZWF0ZXIpCgoKIyNNYXRoIFRlc3QKaXEyMDA3X2VrMV9yZXBlYXRlciA9IGlxMjAwN19lazFfcmVwZWF0ZXIgJT4lCiAgbXV0YXRlKGVrMTN4ID0gaWZlbHNlKGVrMTN4ID09IDEsIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMTN4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMTR4ID0gaWZlbHNlKGVrMTR4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazE0eCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazE1eCA9IGlmZWxzZShlazE1eCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsxNXggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWsxNnggPSBpZmVsc2UoZWsxNnggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMTZ4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMTd4ID0gaWZlbHNlKGVrMTd4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazE3eCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazE4eCA9IGlmZWxzZShlazE4eCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsxOHggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWsxOXggPSBpZmVsc2UoZWsxOXggPT0gMSwgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVrMTl4ID09IDYsIE5BLCAwKSksCiAgICAgICAgIGVrMjB4ID0gaWZlbHNlKGVrMjB4ID09IDEsICAxLAogICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShlazIweCA9PSA2LCBOQSwgMCkpLAogICAgICAgICBlazIxeCA9IGlmZWxzZShlazIxeCA9PSAxLCAgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsyMXggPT0gNiwgTkEsIDApKSwKICAgICAgICAgZWsyMnggPSBpZmVsc2UoZWsyMnggPT0gMSwgMSwKICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoZWsyMnggPT0gNiwgTkEsIDApKSkKCmFuc3dlcmVkX21hdGhfaXRlbXMgPSBpcTIwMDdfZWsxX3JlcGVhdGVyICU+JSBzZWxlY3QoZWsxM3g6ZWsyMngpCmlxMjAwN19lazFfcmVwZWF0ZXIkbWF0aF8yMDA3X3lvdW5nX3JlcGVhdGVyID0gcm93TWVhbnMoIGFuc3dlcmVkX21hdGhfaXRlbXMsIG5hLnJtID0gVCkKcXBsb3QoaXEyMDA3X2VrMV9yZXBlYXRlciRtYXRoXzIwMDdfeW91bmdfcmVwZWF0ZXIpCgppcTIwMDdfZWsxX3JlcGVhdGVyID0gaXEyMDA3X2VrMV9yZXBlYXRlciAlPiUKICBzZWxlY3QocGlkbGluaywgcmF2ZW5fMjAwN195b3VuZ19yZXBlYXRlciwgbWF0aF8yMDA3X3lvdW5nX3JlcGVhdGVyLAogICAgICAgICByZWFzb25fMjAwN195b3VuZ19yZXBlYXRlciwgYWdlXzIwMDdfeW91bmdfcmVwZWF0ZXIsIHNleF8yMDA3X3lvdW5nX3JlcGVhdGVyKQoKaXEyMDA3X2FsbCA9IGxlZnRfam9pbihpcTIwMDcsIGlxMjAwN19lazFfcmVwZWF0ZXIsIGJ5ID0gInBpZGxpbmsiKQoKIyBOb3cgd2UgaW5zdGVydCByYXZlbiBhbmQgbWF0aCBzY29yZXMgZnJvbSB0aGUgcmVwZWF0ZXJzIGFzIHJhdmVuIGFuZCBtYXRoIHNjb3JlcyB5b3VuZwojIFRyZWF0IHRoZW0gbGlrZSBhbGwgdGhlIG90aGVycy4KY3Jvc3N0YWJzKGlzLm5hKGlxMjAwN19hbGwkcmF2ZW5fMjAwN195b3VuZykgKyBpcy5uYShpcTIwMDdfYWxsJHJhdmVuXzIwMDdfeW91bmdfcmVwZWF0ZXIpKQoKaXEyMDA3X2FsbCA9IGlxMjAwN19hbGwgJT4lCiAgbXV0YXRlKHJhdmVuXzIwMDdfeW91bmcgPSBpZmVsc2UoIWlzLm5hKHJhdmVuXzIwMDdfeW91bmdfcmVwZWF0ZXIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdmVuXzIwMDdfeW91bmdfcmVwZWF0ZXIsIHJhdmVuXzIwMDdfeW91bmcpLAogICAgICAgICBtYXRoXzIwMDdfeW91bmcgPSBpZmVsc2UoIWlzLm5hKG1hdGhfMjAwN195b3VuZ19yZXBlYXRlciksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRoXzIwMDdfeW91bmdfcmVwZWF0ZXIsIG1hdGhfMjAwN195b3VuZyksCiAgICAgICAgIGFnZV8yMDA3X3lvdW5nID0gaWZlbHNlKCFpcy5uYShhZ2VfMjAwN195b3VuZ19yZXBlYXRlciksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnZV8yMDA3X3lvdW5nX3JlcGVhdGVyLCBhZ2VfMjAwN195b3VuZyksCiAgICAgICAgIHNleF8yMDA3X3lvdW5nID0gaWZlbHNlKCFpcy5uYShzZXhfMjAwN195b3VuZ19yZXBlYXRlciksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNleF8yMDA3X3lvdW5nX3JlcGVhdGVyLCBzZXhfMjAwN195b3VuZykpCgppcTIwMDdfYWxsID0gaXEyMDA3X2FsbCAlPiUgc2VsZWN0KHBpZGxpbmssIGFnZV8yMDA3X3lvdW5nLCBhZ2VfMjAwN19vbGQsIHJhdmVuXzIwMDdfb2xkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdmVuXzIwMDdfeW91bmcsIG1hdGhfMjAwN195b3VuZywgbWF0aF8yMDA3X29sZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAwN195b3VuZywgcmVhc29uXzIwMDdfb2xkKQojIHNvbWUgcGVvcGxlIGhhdmUgcmVhc29ucyBub3QgdG8gYW5zd2VyIHRoZSB0ZXN0IChkZWFkLCBub3QgY29udGFjdGVkKSwgdGhhdCBkb250IGp1c3RpZnkKIyBnaXZpbmcgdGhlbSB6ZXJvIHBvaW50cyBmb3IgdGhhdCB0YXNrLiBzbyBpIHNldCB0aGVzZSB0byBOQQojIGl0IGlzIGltcG9ydGFudCB0byBub3RlIHRoYXQgcmF2ZW4gYW5kIG1hdGggdGVzdCB3ZXJlIG9ubHkgYW5zd2VyZWQgYnkgcGFydGljaXBhbnRzCiMgYWdlZCA3IC0gMjQKaXEyMDA3X2FsbCA9IGlxMjAwN19hbGwgJT4lCiAgbXV0YXRlKHJlYXNvbl8yMDA3X3lvdW5nID0gaWZlbHNlKHJlYXNvbl8yMDA3X3lvdW5nID09IDEsICJyZWZ1c2VkIiwKICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAwN195b3VuZyA9PSAyLCAiY2Fubm90IHJlYWQiLAogICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDA3X3lvdW5nID09IDMsICJ1bmFibGUgdG8gYW5zd2VyIiwKICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAwN195b3VuZyA9PSA0LCAibm90IGVub3VnaCB0aW1lIiwKICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAwN195b3VuZyA9PSA1LCAicHJveHkgcmVzcG9uZGVudCIsCiAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMDdfeW91bmcgPT0gNiwgIm90aGVyIiwKICAgICAgICAgICAgICAgICAgIGlmZWxzZShyZWFzb25fMjAwN195b3VuZyA9PSA3LCAiY291bGQgbm90IGJlIGNvbnRhY3RlZCIsIE5BKSkpKSkpKSwKICAgICAgICAgcmF2ZW5fMjAwN195b3VuZyA9IGlmZWxzZShpcy5uYShyZWFzb25fMjAwN195b3VuZyksIHJhdmVuXzIwMDdfeW91bmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDA3X3lvdW5nID09ICJjYW5ub3QgcmVhZCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X3lvdW5nID09ICJub3QgZW5vdWdoIHRpbWUifAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAwN195b3VuZyA9PSAicHJveHkgcmVzcG9uZGVudCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X3lvdW5nID09ICJvdGhlciJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X3lvdW5nID09ICJyZWZ1c2VkInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMDdfeW91bmcgPT0gImNvdWxkIG5vdCBiZSBjb250YWN0ZWQiLCBOQSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF2ZW5fMjAwN195b3VuZykpLAogICAgICAgICBtYXRoXzIwMDdfeW91bmcgPSBpZmVsc2UoaXMubmEocmVhc29uXzIwMDdfeW91bmcpLCBtYXRoXzIwMDdfeW91bmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDA3X3lvdW5nID09ICJjYW5ub3QgcmVhZCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X3lvdW5nID09ICJub3QgZW5vdWdoIHRpbWUifAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAwN195b3VuZyA9PSAicHJveHkgcmVzcG9uZGVudCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X3lvdW5nID09ICJvdGhlciJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X3lvdW5nID09ICJyZWZ1c2VkInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMDdfeW91bmcgPT0gImNvdWxkIG5vdCBiZSBjb250YWN0ZWQiLCBOQSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0aF8yMDA3X3lvdW5nKSksCiAgICAgICAgIHJlYXNvbl8yMDA3X29sZCA9IGlmZWxzZShyZWFzb25fMjAwN19vbGQgPT0gMSwgInJlZnVzZWQiLAogICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDA3X29sZCA9PSAyLCAiY2Fubm90IHJlYWQiLAogICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDA3X29sZCA9PSAzLCAidW5hYmxlIHRvIGFuc3dlciIsCiAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMDdfb2xkID09IDQsICJub3QgZW5vdWdoIHRpbWUiLAogICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDA3X29sZCA9PSA1LCAicHJveHkgcmVzcG9uZGVudCIsCiAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMDdfb2xkID09IDYsICJvdGhlciIsCiAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMDdfb2xkID09IDcsICJjb3VsZCBub3QgYmUgY29udGFjdGVkIiwgTkEpKSkpKSkpLAogICAgICAgICByYXZlbl8yMDA3X29sZCA9IGlmZWxzZShpcy5uYShyZWFzb25fMjAwN19vbGQpLCByYXZlbl8yMDA3X29sZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocmVhc29uXzIwMDdfb2xkID09ICJjYW5ub3QgcmVhZCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X29sZCA9PSAibm90IGVub3VnaCB0aW1lInwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMDdfb2xkID09ICJwcm94eSByZXNwb25kZW50InwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uXzIwMDdfb2xkID09ICJvdGhlciJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X29sZCA9PSAicmVmdXNlZCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X29sZCA9PSAiY291bGQgbm90IGJlIGNvbnRhY3RlZCIsIE5BLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXZlbl8yMDA3X29sZCkpLAogICAgICAgICBtYXRoXzIwMDdfb2xkID0gaWZlbHNlKGlzLm5hKHJlYXNvbl8yMDA3X29sZCksIG1hdGhfMjAwN19vbGQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHJlYXNvbl8yMDA3X29sZCA9PSAiY2Fubm90IHJlYWQifAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAwN19vbGQgPT0gIm5vdCBlbm91Z2ggdGltZSJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X29sZCA9PSAicHJveHkgcmVzcG9uZGVudCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X29sZCA9PSAib3RoZXIifAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb25fMjAwN195b3VuZyA9PSAicmVmdXNlZCJ8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbl8yMDA3X29sZCA9PSAiY291bGQgbm90IGJlIGNvbnRhY3RlZCIsIE5BLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRoXzIwMDdfb2xkKSkpCgppcTIwMDdfYWxsICU+JSBzZWxlY3QocmF2ZW5fMjAwN19vbGQsIG1hdGhfMjAwN19vbGQsIHJhdmVuXzIwMDdfeW91bmcsIG1hdGhfMjAwN195b3VuZykgJT4lIHRpZHlyOjpnYXRoZXIoKSAlPiUgIGdncGxvdChhZXModmFsdWUpKSArIGdlb21fYmFyKCkgKyBmYWNldF93cmFwKH4ga2V5LCBzY2FsZXMgPSAiZnJlZSIpCgppcSA9IGZ1bGxfam9pbihpcSwgaXEyMDA3X2FsbCwgYnkgPSAicGlkbGluayIpICU+JQogIHNlbGVjdCgtbWF0Y2hlcygiZWtbMC05XV9hbnMiKSwgLW1hdGNoZXMoImVrWzAtOV1bMC05XV9hbnMiKSwgLXN0YXJ0c193aXRoKCJoaGlkIiksCiAgICAgICAgIC1la3R5cGUsIC1yZXNwdHlwZSwgLXJlc3VsdCwgLXN0YXJ0c193aXRoKCJyZWFzb24iKSwgLXN0YXJ0c193aXRoKCJjbyIpLAogICAgICAgICBjb3VudF9iYWNrd2FyZHMsIC13X2FiaWwpCmBgYAoKYGBge3J9CiMjIElRIFRlc3RzIAojIyBDb3JyZWxhdGlvbiBvZiBhbGwgSXEtVGVzdHMKcm91bmQoY29yKGlxICU+JSBzZWxlY3QocmF2ZW5fMjAxNV9vbGQsIG1hdGhfMjAxNV9vbGQsIHJhdmVuXzIwMTVfeW91bmcsIG1hdGhfMjAxNV95b3VuZywgY291bnRfYmFja3dhcmRzLCB3b3Jkc19pbW1lZGlhdGUsIHdvcmRzX2RlbGF5ZWQsIGFkYXB0aXZlX251bWJlcmluZywgcmF2ZW5fMjAwN19vbGQsIG1hdGhfMjAwN195b3VuZyksIHVzZSA9ICJwYWlyd2lzZS5jb21wbGV0ZS5vYnMiKSwgMikKCiMjTWlzc2luZ25lc3NfUGF0dGVybnMKZm9ybXI6Om1pc3NpbmduZXNzX3BhdHRlcm5zKGlxICU+JSBzZWxlY3QocmF2ZW5fMjAxNV9vbGQsIG1hdGhfMjAxNV9vbGQsIHJhdmVuXzIwMTVfeW91bmcsIG1hdGhfMjAxNV95b3VuZywgY291bnRfYmFja3dhcmRzLCB3b3Jkc19pbW1lZGlhdGUsIHdvcmRzX2RlbGF5ZWQsIGFkYXB0aXZlX251bWJlcmluZywgcmF2ZW5fMjAwN19vbGQsIG1hdGhfMjAwN195b3VuZykpCgppcSAlPiUgc2VsZWN0KHJhdmVuXzIwMTVfb2xkLCBtYXRoXzIwMTVfb2xkLCByYXZlbl8yMDE1X3lvdW5nLCBtYXRoXzIwMTVfeW91bmcsIHJhdmVuXzIwMDdfb2xkLCBtYXRoXzIwMDdfb2xkLCByYXZlbl8yMDA3X3lvdW5nLCBtYXRoXzIwMDdfeW91bmcsIGNvdW50X2JhY2t3YXJkcywgd29yZHNfaW1tZWRpYXRlLCB3b3Jkc19kZWxheWVkLCBhZGFwdGl2ZV9udW1iZXJpbmcpICU+JSB0aWR5cjo6Z2F0aGVyKCkgJT4lCiAgZ2dwbG90KGFlcyh2YWx1ZSkpICsgZ2VvbV9iYXIoKSArIGZhY2V0X3dyYXAofiBrZXksIHNjYWxlcyA9ICJmcmVlIikKYGBgCgoKIyMjIGdfZmFjdG9yIGF0IHRoZSBiZWdpbm5pbmcKYGBge3J9CiMgR19mYWN0b3JfMjAxNV9vbGQKbm9taXNzID0gaXEgJT4lCiAgZmlsdGVyKCFpcy5uYShyYXZlbl8yMDE1X29sZCksICFpcy5uYShtYXRoXzIwMTVfb2xkKSwgIWlzLm5hKGNvdW50X2JhY2t3YXJkcyksICFpcy5uYSh3b3Jkc19kZWxheWVkKSwKICAgICAgICAgIWlzLm5hKGFkYXB0aXZlX251bWJlcmluZykpCgoKZmEucGFyYWxsZWwobm9taXNzICU+JSBzZWxlY3QocmF2ZW5fMjAxNV9vbGQsIG1hdGhfMjAxNV9vbGQsIGNvdW50X2JhY2t3YXJkcywgd29yZHNfZGVsYXllZCwgYWRhcHRpdmVfbnVtYmVyaW5nKSAlPiUgZGF0YS5mcmFtZSgpKQpmYShub21pc3MgJT4lIHNlbGVjdChyYXZlbl8yMDE1X29sZCwgbWF0aF8yMDE1X29sZCwgY291bnRfYmFja3dhcmRzLCB3b3Jkc19kZWxheWVkLCBhZGFwdGl2ZV9udW1iZXJpbmcpICU+JSBkYXRhLmZyYW1lKCksIG5mYWN0b3JzID0gMSkKb21fcmVzdWx0cyA9IG9tZWdhKG5vbWlzcyAlPiUgc2VsZWN0KHJhdmVuXzIwMTVfb2xkLCBtYXRoXzIwMTVfb2xkLCBjb3VudF9iYWNrd2FyZHMsIHdvcmRzX2RlbGF5ZWQsIGFkYXB0aXZlX251bWJlcmluZykgJT4lIGRhdGEuZnJhbWUoKSwgbmZhY3RvcnMgPSAxLCBzbCA9IEYpCm9tX3Jlc3VsdHMKb21lZ2EuZGlhZ3JhbShvbV9yZXN1bHRzKQoKImdfZmFjdG9yXzIwMTVfb2xkID1+IHJhdmVuXzIwMTVfb2xkICsgbWF0aF8yMDE1X29sZCArIGNvdW50X2JhY2t3YXJkcyArICB3b3Jkc19kZWxheWVkKyAgYWRhcHRpdmVfbnVtYmVyaW5nIiAlPiUKICBjZmEoZGF0YSA9IG5vbWlzcywgc3RkLmx2ID0gVCwgc3RkLm92ID0gVCkgLT4gY2ZhX2cKc3VtbWFyeShjZmFfZykKc3VtbWFyeQoKbm9taXNzJGdfZmFjdG9yXzIwMTVfb2xkID0gcHJlZGljdChjZmFfZylbLDFdCgpxcGxvdChub21pc3MkZ19mYWN0b3JfMjAxNV9vbGQpCgpub21pc3MgPSBub21pc3MgJT4lIHNlbGVjdChwaWRsaW5rLCBnX2ZhY3Rvcl8yMDE1X29sZCkKCmlxID0gbGVmdF9qb2luKGlxLCBub21pc3MsIGJ5ID0gInBpZGxpbmsiKQoKIyBFeHBsYWluZWQgVmFyaWFuY2UKCgojIEdfZmFjdG9yXzIwMTVfeW91bmcKbm9taXNzID0gaXEgJT4lCiAgZmlsdGVyKCFpcy5uYShyYXZlbl8yMDE1X3lvdW5nKSwgIWlzLm5hKG1hdGhfMjAxNV95b3VuZykpCgoKZmEucGFyYWxsZWwobm9taXNzICU+JSBzZWxlY3QocmF2ZW5fMjAxNV95b3VuZywgbWF0aF8yMDE1X3lvdW5nKSAlPiUgZGF0YS5mcmFtZSgpKQpmYShub21pc3MgJT4lIHNlbGVjdChyYXZlbl8yMDE1X3lvdW5nLCBtYXRoXzIwMTVfeW91bmcpICU+JSBkYXRhLmZyYW1lKCksIG5mYWN0b3JzID0gMSkKb21fcmVzdWx0cyA9IG9tZWdhKG5vbWlzcyAlPiUgc2VsZWN0KHJhdmVuXzIwMTVfeW91bmcsIG1hdGhfMjAxNV95b3VuZykgJT4lIGRhdGEuZnJhbWUoKSwgbmZhY3RvcnMgPSAxLCBzbCA9IEYpCm9tX3Jlc3VsdHMKb21lZ2EuZGlhZ3JhbShvbV9yZXN1bHRzKQoKImdfZmFjdG9yXzIwMTVfeW91bmcgPX4gcmF2ZW5fMjAxNV95b3VuZyArIG1hdGhfMjAxNV95b3VuZyIgJT4lCiAgY2ZhKGRhdGEgPSBub21pc3MsIHN0ZC5sdiA9IFQsIHN0ZC5vdiA9IFQpIC0+IGNmYV9nCnN1bW1hcnkoY2ZhX2cpCgpub21pc3MkZ19mYWN0b3JfMjAxNV95b3VuZyA9IHByZWRpY3QoY2ZhX2cpWywxXQoKcXBsb3Qobm9taXNzJGdfZmFjdG9yXzIwMTVfeW91bmcpCgpub21pc3MgPSBub21pc3MgJT4lIHNlbGVjdChwaWRsaW5rLCBnX2ZhY3Rvcl8yMDE1X3lvdW5nKQoKaXEgPSBsZWZ0X2pvaW4oaXEsIG5vbWlzcywgYnkgPSAicGlkbGluayIpCgojIEdfZmFjdG9yXzIwMDdfb2xkCm5vbWlzcyA9IGlxICU+JQogIGZpbHRlcighaXMubmEocmF2ZW5fMjAwN19vbGQpLCAhaXMubmEobWF0aF8yMDA3X29sZCkpCgoKZmEucGFyYWxsZWwobm9taXNzICU+JSBzZWxlY3QocmF2ZW5fMjAwN19vbGQsIG1hdGhfMjAwN19vbGQpICU+JSBkYXRhLmZyYW1lKCkpCmZhKG5vbWlzcyAlPiUgc2VsZWN0KHJhdmVuXzIwMDdfb2xkLCBtYXRoXzIwMDdfb2xkKSAlPiUgZGF0YS5mcmFtZSgpLCBuZmFjdG9ycyA9IDEpCm9tX3Jlc3VsdHMgPSBvbWVnYShub21pc3MgJT4lIHNlbGVjdChyYXZlbl8yMDA3X29sZCwgbWF0aF8yMDA3X29sZCkgJT4lIGRhdGEuZnJhbWUoKSwgbmZhY3RvcnMgPSAxLCBzbCA9IEYpCm9tX3Jlc3VsdHMKb21lZ2EuZGlhZ3JhbShvbV9yZXN1bHRzKQoKImdfZmFjdG9yXzIwMDdfb2xkID1+IHJhdmVuXzIwMDdfb2xkICsgbWF0aF8yMDA3X29sZCIgJT4lCiAgY2ZhKGRhdGEgPSBub21pc3MsIHN0ZC5sdiA9IFQsIHN0ZC5vdiA9IFQpIC0+IGNmYV9nCnN1bW1hcnkoY2ZhX2cpCgpub21pc3MkZ19mYWN0b3JfMjAwN19vbGQgPSBwcmVkaWN0KGNmYV9nKVssMV0KCnFwbG90KG5vbWlzcyRnX2ZhY3Rvcl8yMDA3X29sZCkKCm5vbWlzcyA9IG5vbWlzcyAlPiUgc2VsZWN0KHBpZGxpbmssIGdfZmFjdG9yXzIwMDdfb2xkKQoKaXEgPSBsZWZ0X2pvaW4oaXEsIG5vbWlzcywgYnkgPSAicGlkbGluayIpCgojIEdfZmFjdG9yXzIwMDdfeW91bmcKbm9taXNzID0gaXEgJT4lCiAgZmlsdGVyKCFpcy5uYShyYXZlbl8yMDA3X3lvdW5nKSwgIWlzLm5hKG1hdGhfMjAwN195b3VuZykpCgoKZmEucGFyYWxsZWwobm9taXNzICU+JSBzZWxlY3QocmF2ZW5fMjAwN195b3VuZywgbWF0aF8yMDA3X3lvdW5nKSAlPiUgZGF0YS5mcmFtZSgpKQpmYShub21pc3MgJT4lIHNlbGVjdChyYXZlbl8yMDA3X3lvdW5nLCBtYXRoXzIwMDdfeW91bmcpICU+JSBkYXRhLmZyYW1lKCksIG5mYWN0b3JzID0gMSkKb21fcmVzdWx0cyA9IG9tZWdhKG5vbWlzcyAlPiUgc2VsZWN0KHJhdmVuXzIwMDdfeW91bmcsIG1hdGhfMjAwN195b3VuZykgJT4lIGRhdGEuZnJhbWUoKSwgbmZhY3RvcnMgPSAxLCBzbCA9IEYpCm9tX3Jlc3VsdHMKb21lZ2EuZGlhZ3JhbShvbV9yZXN1bHRzKQoKImdfZmFjdG9yXzIwMDdfeW91bmcgPX4gcmF2ZW5fMjAwN195b3VuZyArIG1hdGhfMjAwN195b3VuZyIgJT4lCiAgY2ZhKGRhdGEgPSBub21pc3MsIHN0ZC5sdiA9IFQsIHN0ZC5vdiA9IFQpIC0+IGNmYV9nCnN1bW1hcnkoY2ZhX2cpCgpub21pc3MkZ19mYWN0b3JfMjAwN195b3VuZyA9IHByZWRpY3QoY2ZhX2cpWywxXQoKcXBsb3Qobm9taXNzJGdfZmFjdG9yXzIwMDdfeW91bmcpCgpub21pc3MgPSBub21pc3MgJT4lIHNlbGVjdChwaWRsaW5rLCBnX2ZhY3Rvcl8yMDA3X3lvdW5nKQoKaXEgPSBsZWZ0X2pvaW4oaXEsIG5vbWlzcywgYnkgPSAicGlkbGluayIpCgpgYGAKCgojIyBQZXJzb25hbGl0eQpgYGB7ciBzZWxlY3QgcGVzb25hbGl0eSBkYXRhfQojIyMgUGVyc29uYWxpdHkKIyNSZWFycmFuZ2UgcGVyc29uYWxpdHkgZGF0YSBzbyB0aGF0IGV2ZXJ5IGluZGl2aWR1YWwgaGFzIG9ubHkgb25lIHJvdwpwZXJzID0gc3ByZWFkKGIzYl9wc24sIHBzbnR5cGUsIHBzbjAxKQojI25hbWUgY29sdW1ucwpjb2xuYW1lcyhwZXJzKSA8LSBjKCJoaGlkMTRfOSIsICJwaWQxNCIsICJoaGlkMTQiLCAicGlkbGluayIsICJ2ZXJzaW9uIiwgIm1vZHVsZSIsICJlMSIsICJjMSIsICJvMSIsICJlMnIiLCAibjFyIiwgImExIiwgIm4yciIsICJvMiIsICJjMnIiLCAibzMiLCAiYTIiLCAiYzMiLCAiZTMiLCAiYTNyIiwgIm4zIikKcGVycyA9IHBlcnMgJT4lIHNlbGVjdChoaGlkMTRfOSwgcGlkbGluaywgZTEsIGMxLCBvMSwgZTJyLCBuMXIsIGExLCBuMnIsIG8yLCBjMnIsIG8zLCBhMiwgYzMsIGUzLCBhM3IsIG4zKQoKIyNFeHRyYXZlcnNpb24KcGVycyRlMnJfcmV2ZXJzZWQgPSA2IC0gcGVycyRlMnIKZXh0cmF2ZXJzaW9uID0gcGVycyAlPiUgc2VsZWN0KGUxLCBlMnJfcmV2ZXJzZWQsIGUzKQpwc3ljaDo6YWxwaGEoZGF0YS5mcmFtZShleHRyYXZlcnNpb24pLCBjaGVjay5rZXlzID0gVCkKcGVycyRiaWc1X2V4dCA9IHJvd01lYW5zKGV4dHJhdmVyc2lvbikKcXBsb3QocGVycyRiaWc1X2V4dCkKCiMjY29uc2NpZW50aW91c25lc3MKcGVycyRjMnJfcmV2ZXJzZWQgPSA2IC0gcGVycyRjMnIKY29uc2NpZW50aW91c25lc3MgPSBwZXJzICU+JSBzZWxlY3QoYzEsIGMycl9yZXZlcnNlZCwgYzMpCnBzeWNoOjphbHBoYShkYXRhLmZyYW1lKGNvbnNjaWVudGlvdXNuZXNzKSwgY2hlY2sua2V5cyA9IFQpCnBlcnMkYmlnNV9jb24gPSByb3dNZWFucyhjb25zY2llbnRpb3VzbmVzcykKcXBsb3QocGVycyRiaWc1X2NvbikKCiMjT3Blbm5lc3MKb3Blbm5lc3MgPSBwZXJzICU+JSBzZWxlY3QobzEsIG8yLCBvMykKcHN5Y2g6OmFscGhhKGRhdGEuZnJhbWUob3Blbm5lc3MpLCBjaGVjay5rZXlzID0gVCkKcGVycyRiaWc1X29wZW4gPSByb3dNZWFucyhvcGVubmVzcykKcXBsb3QocGVycyRiaWc1X29wZW4pCgojIyBOZXVyb3RpY2lzbQpwZXJzJG4xcl9yZXZlcnNlZCA9IDYgLSBwZXJzJG4xcgpwZXJzJG4ycl9yZXZlcnNlZCA9IDYgLSBwZXJzJG4ycgpuZXVyb3RpY2lzbSA9IHBlcnMgJT4lIHNlbGVjdChuMXJfcmV2ZXJzZWQsIG4ycl9yZXZlcnNlZCwgbjMpCnBlcnMkYmlnNV9uZXUgPSByb3dNZWFucyhuZXVyb3RpY2lzbSkKcXBsb3QocGVycyRiaWc1X25ldSkKCiMjQWdyZWVhYmxlbmVzcwpwZXJzJGEzcl9yZXZlcnNlZCA9IDYtIHBlcnMkYTNyCmFncmVlYWJsZW5lc3M9IHBlcnMgJT4lIHNlbGVjdChhMSwgYTIsIGEzcl9yZXZlcnNlZCkKcGVycyRiaWc1X2FncmVlID0gcm93TWVhbnMoYWdyZWVhYmxlbmVzcykKcXBsb3QocGVycyRiaWc1X2FncmVlKQpgYGAKCgojIyBSaXNrIHByZWZlcmVuY2UKYGBge3Igc2VsZWN0IHJpc2sgdGFraW5nIGRhdGF9CiMjI1Jpc2t0YWtpbmcKcmlzayA9IGIzYV9zaSAlPiUgc2VsZWN0KGhoaWQxNF85LCBwaWRsaW5rLCByYW5kb21fc2ksIHNpMDEsIHNpMDIsIHNpMDMsIHNpMDQsIHNpMDUsIHNpMTEsIHNpMTIsIHNpMTMsIHNpMTQsIHNpMTUpCgojIyA4IG1lYW5zIHRoZXkgZGlkbnQga25vdyB3aGljaCBhbnN3ZXIgdGhleSB3b3VsZCBjaG9vc2UKcmlzayRzaTAxWyByaXNrJHNpMDEgPT0gOF0gPSBOQQpyaXNrJHNpMDJbIHJpc2skc2kwMiA9PSA4XSA9IE5BCnJpc2skc2kwM1sgcmlzayRzaTAzID09IDhdID0gTkEKcmlzayRzaTA0WyByaXNrJHNpMDQgPT0gOF0gPSBOQQpyaXNrJHNpMDVbIHJpc2skc2kwNSA9PSA4XSA9IE5BCnJpc2skc2kxMVsgcmlzayRzaTExID09IDhdID0gTkEKcmlzayRzaTEyWyByaXNrJHNpMTIgPT0gOF0gPSBOQQpyaXNrJHNpMTNbIHJpc2skc2kxMyA9PSA4XSA9IE5BCnJpc2skc2kxNFsgcmlzayRzaTE0ID09IDhdID0gTkEKcmlzayRzaTE1WyByaXNrJHNpMTUgPT0gOF0gPSBOQQoKIyMgY2FsY3VsYXRlIGEgcmlzayBzY29yZSBmb3IgcmlzayBnYW1lIEEgCiMgKDUgPSBnYW1ibGUgYXZlcnNlLCBPcmRpbmFsc2thbGEgOiAxID0gcmlzayBsb3ZpbmcsIDQgPSByaXNrIGF2ZXJzZSkKcmlzayRyaXNrQSA9IGlmZWxzZShyaXNrJHNpMDEgPT0gMSAmIHJpc2skc2kwMiA9PSAxLCA1LAogICAgICAgICAgICAgaWZlbHNlKHJpc2skc2kwMSA9PSAyICYgcmlzayRzaTAzID09IDEgJiByaXNrJHNpMDQgPT0gMSwgNCwKICAgICAgICAgICAgIGlmZWxzZShyaXNrJHNpMDEgPT0gMiAmIHJpc2skc2kwMyA9PSAxICYgcmlzayRzaTA0ID09IDIsIDMsCiAgICAgICAgICAgICBpZmVsc2UocmlzayRzaTAxID09IDIgJiByaXNrJHNpMDMgPT0gMiAmIHJpc2skc2kwNSA9PSAxLCAyLAogICAgICAgICAgICAgaWZlbHNlKHJpc2skc2kwMSA9PSAyICYgcmlzayRzaTAzID09IDIgJiByaXNrJHNpMDUgPT0gMiwgMSwKICAgICAgICAgICAgIE5BKSkpKSkKCiMjIGNhbGN1bGF0ZSBhIHJpc2sgc2NvcmUgZm9yIHJpc2sgZ2FtZSBCIAojICg1ID0gZ2FtYmxlIGxvdmluZywgT3JkaW5hbHNrYWxhIDogMSA9IHJpc2sgbG92aW5nLCA0ID0gcmlzayBhdmVyc2UpCnJpc2skcmlza0IgPSBpZmVsc2UocmlzayRzaTExID09IDIgJiByaXNrJHNpMTIgPT0gMSwgNSwKICAgICAgICAgICAgIGlmZWxzZShyaXNrJHNpMTEgPT0gMSAmIHJpc2skc2kxMyA9PSAxICYgcmlzayRzaTE0ID09IDEsIDQsCiAgICAgICAgICAgICBpZmVsc2UocmlzayRzaTExID09IDEgJiByaXNrJHNpMTMgPT0gMSAmIHJpc2skc2kxNCA9PSAyLCAzLAogICAgICAgICAgICAgaWZlbHNlKHJpc2skc2kxMSA9PSAxICYgcmlzayRzaTEzID09IDIgJiByaXNrJHNpMTUgPT0gMSwgMiwKICAgICAgICAgICAgIGlmZWxzZShyaXNrJHNpMTEgPT0gMSAmIHJpc2skc2kxMyA9PSAyICYgcmlzayRzaTE1ID09IDIsIDEsCiAgICAgICAgICAgICBOQSkpKSkpCgojIHJpc2sgdmFyaWFibGUgaXMgbWVzc3kKcmlzayA9IHJpc2sgJT4lCiAgbXV0YXRlKHJpc2tCID0gaWZlbHNlKHJpc2tCID09IDUsIDAsIHJpc2tCKSwKICAgICAgICAgcmlza0IgPSByaXNrQiArIDEpCgpwc3ljaDo6YWxwaGEoZGF0YS5mcmFtZShyaXNrICU+JSBzZWxlY3Qocmlza0EsIHJpc2tCKSksIGNoZWNrLmtleXMgPSBUKQoKCmBgYAoKIyMgRWR1Y2F0aW9uYWwgQXR0YWlubWVudApgYGB7ciBzZWxlY3QgZWR1Y2F0aW9uYWwgYXR0YWlubWVudCBkYXRhfQojIFNlbGVjdCwgcmVuYW1lIGFuZCBtdXRhdGUgZGF0YQplYSA9IGIzYV9kbDEgJT4lCiAgc2VsZWN0KHBpZGxpbmssIGRsMDQsIGRsMDYsIGRsMDcsIGRsMDdhLCBkbDA3YWEpICU+JQogIHJlbmFtZShwaWRsaW5rID0gcGlkbGluaywgYXR0ZW5kZWRfc2Nob29sID0gZGwwNCwgaGlnaGVzdF9lZHVjYXRpb24gPSBkbDA2LAogICAgICAgICBoaWdoZXN0X2dyYWRlPWRsMDcsIGN1cnJlbnRseV9hdHRlbmRpbmdfc2Nob29sID0gZGwwN2EsIGhvdXJzX2luX2NsYXNzID0gZGwwN2FhKSAlPiUKICBtdXRhdGUoYXR0ZW5kZWRfc2Nob29sID0gYXMuZmFjdG9yKGlmZWxzZShhdHRlbmRlZF9zY2hvb2wgPT0gOCwgTkEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGF0dGVuZGVkX3NjaG9vbCA9PSAxLCAieWVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGF0dGVuZGVkX3NjaG9vbCA9PSAzLCAibm8iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0ZW5kZWRfc2Nob29sKSkpKSwKICAgICAgICAgaGlnaGVzdF9lZHVjYXRpb24gPSBhcy5mYWN0b3IoaWZlbHNlKGhpZ2hlc3RfZWR1Y2F0aW9uID09IDIgfCBoaWdoZXN0X2VkdWNhdGlvbiA9PSA3MiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRWxlbWVudGFyeSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGhpZ2hlc3RfZWR1Y2F0aW9uID09IDMgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hlc3RfZWR1Y2F0aW9uID09IDQgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hlc3RfZWR1Y2F0aW9uID09IDczLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSnVuaW9yIEhpZ2giLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoaGlnaGVzdF9lZHVjYXRpb24gPT0gNSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hlc3RfZWR1Y2F0aW9uID09IDYgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWdoZXN0X2VkdWNhdGlvbiA9PSA3NCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJTZW5pb3IgSGlnaCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoaGlnaGVzdF9lZHVjYXRpb24gPT0gNjAgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGVzdF9lZHVjYXRpb24gPT0gNjEgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGVzdF9lZHVjYXRpb24gPT0gNjIgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGVzdF9lZHVjYXRpb24gPT0gNjMgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGVzdF9lZHVjYXRpb24gPT0gMTMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlVuaXZlcnNpdHkiLCBOQSkpKSkpLCMib3RoZXIiID0gTkEKICAgICAgICAgaGlnaGVzdF9ncmFkZSA9IGlmZWxzZShoaWdoZXN0X2dyYWRlID09IDk4LCBOQSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoaGlnaGVzdF9ncmFkZSA9PSA5OSwgTkEsIGhpZ2hlc3RfZ3JhZGUpKSwKICAgICAgICAgY3VycmVudGx5X2F0dGVuZGluZ19zY2hvb2wgPSBhcy5mYWN0b3IoaWZlbHNlKGN1cnJlbnRseV9hdHRlbmRpbmdfc2Nob29sID09IDEsICJ5ZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGN1cnJlbnRseV9hdHRlbmRpbmdfc2Nob29sID09IDMsICJubyIsIE5BKSkpLAogICAgICAgICBob3Vyc19pbl9jbGFzcyA9IGlmZWxzZShob3Vyc19pbl9jbGFzcyA9PSA5OSwgTkEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShob3Vyc19pbl9jbGFzcyA9PSA5OCwgTkEsIGhvdXJzX2luX2NsYXNzKSkpCgojIyBDcmVhdGUgdmFyaWFibGUgdGhhdCBpbmNsdWRlcyB5ZWFycyBvZiBlZHVjYXRpb24gKGhpZ2hlc3RfZWR1Y2F0aW9uLmhpZ2hlc3RfZ3JhZGUpIGFzIGEgbnVtZXJpYyB2YXJpYWJsZQplYSA9IGVhICU+JQogIG11dGF0ZSh5ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yID0gYXMuZmFjdG9yKHN0cl9jKGhpZ2hlc3RfZWR1Y2F0aW9uLCAiLiIsIGhpZ2hlc3RfZ3JhZGUpKSwKICAgICAgICAgeWVhcnNfb2ZfZWR1Y2F0aW9uID0gYXMubnVtZXJpYyhpZmVsc2UoYXR0ZW5kZWRfc2Nob29sID09ICJubyIsIDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHllYXJzX29mX2VkdWNhdGlvbl9mYWN0b3IgPT0gIkVsZW1lbnRhcnkuMCIsIDAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiRWxlbWVudGFyeS4xIiwgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiRWxlbWVudGFyeS4yIiwgMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiRWxlbWVudGFyeS4zIiwgMywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiRWxlbWVudGFyeS40IiwgNCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiRWxlbWVudGFyeS41IiwgNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiRWxlbWVudGFyeS42IiwgTkEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHllYXJzX29mX2VkdWNhdGlvbl9mYWN0b3IgPT0gIkVsZW1lbnRhcnkuNyIsIDYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHllYXJzX29mX2VkdWNhdGlvbl9mYWN0b3IgPT0gIkp1bmlvciBIaWdoLjAiLCA2LjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHllYXJzX29mX2VkdWNhdGlvbl9mYWN0b3IgPT0gIkp1bmlvciBIaWdoLjEiLCA3LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSh5ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yID09ICJKdW5pb3IgSGlnaC4yIiwgOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiSnVuaW9yIEhpZ2guMyIsIE5BLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSh5ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yID09ICJKdW5pb3IgSGlnaC43IiwgOSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiU2VuaW9yIEhpZ2guMCIsIDkuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiU2VuaW9yIEhpZ2guMSIsIDEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSh5ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yID09ICJTZW5pb3IgSGlnaC4yIiwgMTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHllYXJzX29mX2VkdWNhdGlvbl9mYWN0b3IgPT0gIlNlbmlvciBIaWdoLjMiLCBOQSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiU2VuaW9yIEhpZ2guNyIsIDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSh5ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yID09ICJVbml2ZXJzaXR5LjAiLCAxMi41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSh5ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yID09ICJVbml2ZXJzaXR5LjEiLCAxMywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiVW5pdmVyc2l0eS4yIiwgMTQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHllYXJzX29mX2VkdWNhdGlvbl9mYWN0b3IgPT0gIlVuaXZlcnNpdHkuMyIsIDE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSh5ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yID09ICJVbml2ZXJzaXR5LjQiLCAxNiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoeWVhcnNfb2ZfZWR1Y2F0aW9uX2ZhY3RvciA9PSAiVW5pdmVyc2l0eS41IiwgMTcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHllYXJzX29mX2VkdWNhdGlvbl9mYWN0b3IgPT0gIlVuaXZlcnNpdHkuNiIsIE5BLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSh5ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yID09ICJVbml2ZXJzaXR5LjciLCAxOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkEpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKSkpKQpxcGxvdChlYSR5ZWFyc19vZl9lZHVjYXRpb24pCmBgYAoKIyMgRUJUQU5BUy9VQU4vVU4gU2NvcmUKYGBge3IgRUJUQU5BUy9VQU4vVU4gU2NvcmV9CkVCVEFOQVNfbG9uZyA9IGIzYV9kbDMgJT4lCiAgc2VsZWN0KHBpZGxpbmssICJMZXZlbF9vZl9zY2hvb2xpbmciID0gZGwzdHlwZSwgIlR5cGVfb2ZfdGVzdCIgPSBkbDE2YzEsICJJbmRvbmVzaWFfc2NvcmUiID0gZGwxNmRiLAogICAgICAgICAiRW5nbGlzaF9zY29yZSIgPSBkbDE2ZGMsICJNYXRoX3Njb3JlIiA9IGRsMTZkZCwgIlRvdGFsX3Njb3JlIiA9IGRsMTZlKSAlPiUKICBtdXRhdGUoTGV2ZWxfb2Zfc2Nob29saW5nID0gaWZlbHNlKExldmVsX29mX3NjaG9vbGluZyA9PSAxLCAiRWxlbWVudGFyeSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoTGV2ZWxfb2Zfc2Nob29saW5nID09IDIsICJKdW5pb3IgSGlnaCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKExldmVsX29mX3NjaG9vbGluZyA9PSAzLCAiU2VuaW9yIEhpZ2giLCBOQSkpKSwKICAgICAgICAgVHlwZV9vZl90ZXN0ID0gaWZlbHNlKFR5cGVfb2ZfdGVzdCA9PSAxLCAiRUJUQU5BUyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoVHlwZV9vZl90ZXN0ID09IDIsICJVQU4vVU4iLCBOQSkpKSAlPiUKICBmaWx0ZXIoIWlzLm5hKEluZG9uZXNpYV9zY29yZSkgfCAhaXMubmEoRW5nbGlzaF9zY29yZSkgfCAhaXMubmEoTWF0aF9zY29yZSkgfCAhaXMubmEoVG90YWxfc2NvcmUpKQogICMgcmVtb3ZlIHBlb3BsZSB3aXRoIG5vIEVCVEFOQVMgSW5mb3JtYXRpb24KCiNXcmFuZ2xlIERhdGEKRUJUQU5BU19FbGVtZW5hdHJ5ID0gRUJUQU5BU19sb25nICU+JQogIGZpbHRlcihMZXZlbF9vZl9zY2hvb2xpbmcgPT0gIkVsZW1lbnRhcnkiKSAlPiUKICByZW5hbWUoIkluZG9uZXNpYV9zY29yZV9lbGVtZW50YXJ5IiA9IEluZG9uZXNpYV9zY29yZSwgIkVuZ2xpc2hfc2NvcmVfZWxlbWVudGFyeSIgPSBFbmdsaXNoX3Njb3JlLAogICAgICAgICAiTWF0aF9zY29yZV9lbGVtZW5hdHJ5IiA9IE1hdGhfc2NvcmUsICJUb3RhbF9zY29yZV9lbGVtZW5hdHJ5IiA9IFRvdGFsX3Njb3JlLAogICAgICAgICAiVHlwZV9vZl90ZXN0X2VsZW1lbnRhcnkiID0gVHlwZV9vZl90ZXN0KSAlPiUKICBzZWxlY3QoLUxldmVsX29mX3NjaG9vbGluZykKCkVCVEFOQVNfSnVuaW9yX0hpZ2ggPSBFQlRBTkFTX2xvbmcgJT4lCiAgZmlsdGVyKExldmVsX29mX3NjaG9vbGluZyA9PSAiSnVuaW9yIEhpZ2giKSAlPiUKICByZW5hbWUoIkluZG9uZXNpYV9zY29yZV9KdW5pb3JfSGlnaCIgPSBJbmRvbmVzaWFfc2NvcmUsICJFbmdsaXNoX3Njb3JlX0p1bmlvcl9IaWdoIiA9IEVuZ2xpc2hfc2NvcmUsCiAgICAgICAgICJNYXRoX3Njb3JlX0p1bmlvcl9IaWdoIiA9IE1hdGhfc2NvcmUsICJUb3RhbF9zY29yZV9KdW5pb3JfSGlnaCIgPSBUb3RhbF9zY29yZSwKICAgICAgICAgIlR5cGVfb2ZfdGVzdF9KdW5pb3JfSGlnaCIgPSBUeXBlX29mX3Rlc3QpJT4lCiAgc2VsZWN0KC1MZXZlbF9vZl9zY2hvb2xpbmcpCgpFQlRBTkFTX1Nlbmlvcl9IaWdoID0gRUJUQU5BU19sb25nICU+JQogIGZpbHRlcihMZXZlbF9vZl9zY2hvb2xpbmcgPT0gIlNlbmlvciBIaWdoIikgJT4lCiAgcmVuYW1lKCJJbmRvbmVzaWFfc2NvcmVfU2VuaW9yX0hpZ2giID0gSW5kb25lc2lhX3Njb3JlLCAiRW5nbGlzaF9zY29yZV9TZW5pb3JfSGlnaCIgPSBFbmdsaXNoX3Njb3JlLAogICAgICAgICAiTWF0aF9zY29yZV9TZW5pb3JfSGlnaCIgPSBNYXRoX3Njb3JlLCAiVG90YWxfc2NvcmVfU2VuaW9yX0hpZ2giID0gVG90YWxfc2NvcmUsCiAgICAgICAgICJUeXBlX29mX3Rlc3RfU2VuaW9yX0hpZ2giID0gVHlwZV9vZl90ZXN0KSU+JQogIHNlbGVjdCgtTGV2ZWxfb2Zfc2Nob29saW5nKQoKRUJUQU5BUyA9IGZ1bGxfam9pbihFQlRBTkFTX0VsZW1lbmF0cnksIEVCVEFOQVNfSnVuaW9yX0hpZ2gsIGJ5ID0gInBpZGxpbmsiKQpFQlRBTkFTID0gZnVsbF9qb2luKEVCVEFOQVMsIEVCVEFOQVNfU2VuaW9yX0hpZ2gsIGJ5ID0gInBpZGxpbmsiKSAKCnRhYmxlKGlzLm5hKEVCVEFOQVMkVG90YWxfc2NvcmVfZWxlbWVuYXRyeSkpCnRhYmxlKGlzLm5hKEVCVEFOQVMkVG90YWxfc2NvcmVfSnVuaW9yX0hpZ2gpKQp0YWJsZShpcy5uYShFQlRBTkFTJFRvdGFsX3Njb3JlX1Nlbmlvcl9IaWdoKSkKCkVCVEFOQVMgPSBFQlRBTkFTICU+JQogIG11dGF0ZShUb3RhbF9zY29yZV9oaWdoZXN0ID0gVG90YWxfc2NvcmVfZWxlbWVuYXRyeSwKICAgICAgICAgVG90YWxfc2NvcmVfaGlnaGVzdCA9IGlmZWxzZSghaXMubmEoVG90YWxfc2NvcmVfU2VuaW9yX0hpZ2gpLCBUb3RhbF9zY29yZV9TZW5pb3JfSGlnaCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoIWlzLm5hKFRvdGFsX3Njb3JlX0p1bmlvcl9IaWdoKSwgVG90YWxfc2NvcmVfSnVuaW9yX0hpZ2gsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvdGFsX3Njb3JlX2hpZ2hlc3QpKSwKICAgICAgICAgVG90YWxfc2NvcmVfaGlnaGVzdF90eXBlID0gaWZlbHNlKCFpcy5uYShUb3RhbF9zY29yZV9TZW5pb3JfSGlnaCksICJTZW5pb3IgSGlnaCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKCFpcy5uYShUb3RhbF9zY29yZV9KdW5pb3JfSGlnaCksICJKdW5pb3IgSGlnaCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSghaXMubmEoVG90YWxfc2NvcmVfZWxlbWVuYXRyeSksICJFbGVtZW50YXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOQSkpKSwKICAgICAgICAgTWF0aF9zY29yZV9oaWdoZXN0ID0gTWF0aF9zY29yZV9lbGVtZW5hdHJ5LAogICAgICAgICBNYXRoX3Njb3JlX2hpZ2hlc3QgPSBpZmVsc2UoIWlzLm5hKE1hdGhfc2NvcmVfU2VuaW9yX0hpZ2gpLCBNYXRoX3Njb3JlX1Nlbmlvcl9IaWdoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSghaXMubmEoTWF0aF9zY29yZV9KdW5pb3JfSGlnaCksIE1hdGhfc2NvcmVfSnVuaW9yX0hpZ2gsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGhfc2NvcmVfaGlnaGVzdCkpLAogICAgICAgICBNYXRoX3Njb3JlX2hpZ2hlc3RfdHlwZSA9IGlmZWxzZSghaXMubmEoTWF0aF9zY29yZV9TZW5pb3JfSGlnaCksICJTZW5pb3IgSGlnaCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKCFpcy5uYShNYXRoX3Njb3JlX0p1bmlvcl9IaWdoKSwgIkp1bmlvciBIaWdoIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKCFpcy5uYShNYXRoX3Njb3JlX2VsZW1lbmF0cnkpLCAiRWxlbWVudGFyeSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTkEpKSkpCnRhYmxlKGlzLm5hKEVCVEFOQVMkVG90YWxfc2NvcmVfaGlnaGVzdCkpCnRhYmxlKGlzLm5hKEVCVEFOQVMkTWF0aF9zY29yZV9oaWdoZXN0KSkKdGFibGUoRUJUQU5BUyRUb3RhbF9zY29yZV9oaWdoZXN0X3R5cGUpCnRhYmxlKEVCVEFOQVMkTWF0aF9zY29yZV9oaWdoZXN0X3R5cGUpCgpxcGxvdChFQlRBTkFTJFRvdGFsX3Njb3JlX2hpZ2hlc3QpCnFwbG90KEVCVEFOQVMkTWF0aF9zY29yZV9oaWdoZXN0KQoKIyMgV29ya2luZyB3aGlsZSBzdGlsbCBpbiBzY2hvb2wKY2hpbGRfbGFib3VyID0gYjNhX2RsNCAlPiUKICBzZWxlY3QocGlkbGluaywgIkxldmVsX29mX3NjaG9vbGluZyIgPSBkbDR0eXBlLCAiV29ya2VkIiA9IGRsMTUsICJNaXNzZWRfc2Nob29sIiA9IGRsMTRhKSAlPiUKICBtdXRhdGUoTGV2ZWxfb2Zfc2Nob29saW5nID0gaWZlbHNlKExldmVsX29mX3NjaG9vbGluZyA9PSAxLCAiRWxlbWVudGFyeSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoTGV2ZWxfb2Zfc2Nob29saW5nID09IDIsICJKdW5pb3JIaWdoIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoTGV2ZWxfb2Zfc2Nob29saW5nID09IDMsICJTZW5pb3JIaWdoIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKExldmVsX29mX3NjaG9vbGluZyA9PSA0LCAiVW5pdmVyc2l0eSIsIE5BKSkpKSwKICAgICAgICAgV29ya2VkID0gaWZlbHNlKFdvcmtlZCA9PSAxLCAxLAogICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKFdvcmtlZCA9PSAzLCAwLCBOQSkpLAogICAgICAgICBNaXNzZWRfc2Nob29sID0gaWZlbHNlKE1pc3NlZF9zY2hvb2wgPT0gMSwgMSwKICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShNaXNzZWRfc2Nob29sID09IDMsIDAsIE5BKSkpCgojIFdyYW5nbGUgRGF0YQpjaGlsZF9sYWJvdXJfd29yayA9IGNoaWxkX2xhYm91ciAlPiUKICBzZWxlY3QocGlkbGluaywgTGV2ZWxfb2Zfc2Nob29saW5nLCBXb3JrZWQpICU+JQogIHNwcmVhZCguLCBMZXZlbF9vZl9zY2hvb2xpbmcsIFdvcmtlZCkgJT4lCiAgcmVuYW1lKCJFbGVtZW50YXJ5X3dvcmtlZCIgPSBFbGVtZW50YXJ5LCAiSnVuaW9yX2hpZ2hfd29ya2VkIiA9IEp1bmlvckhpZ2gsIAogICAgICAgICAiU2VuaW9yX2hpZ2hfd29ya2VkIiA9IFNlbmlvckhpZ2gsICJVbml2ZXJzaXR5X3dvcmtlZCIgPSBVbml2ZXJzaXR5KSAlPiUKICBtdXRhdGUodG90YWxfd29ya2VkID0gaWZlbHNlKEVsZW1lbnRhcnlfd29ya2VkID09IDEgfCBKdW5pb3JfaGlnaF93b3JrZWQgPT0gMSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNlbmlvcl9oaWdoX3dvcmtlZCA9PSAxIHwgVW5pdmVyc2l0eV93b3JrZWQgPT0gMSwgMSwgMCksCiAgICAgICAgIHRvdGFsX3dvcmtlZCAgPSBpZmVsc2UoaXMubmEodG90YWxfd29ya2VkKSwgMCwgdG90YWxfd29ya2VkKSkKCmNoaWxkX2xhYm91cl9taXNzZWQgPSBjaGlsZF9sYWJvdXIgJT4lCiAgc2VsZWN0KHBpZGxpbmssIExldmVsX29mX3NjaG9vbGluZywgTWlzc2VkX3NjaG9vbCkgJT4lCiAgc3ByZWFkKC4sIExldmVsX29mX3NjaG9vbGluZywgTWlzc2VkX3NjaG9vbCkgJT4lCiAgcmVuYW1lKCJFbGVtZW50YXJ5X21pc3NlZCIgPSBFbGVtZW50YXJ5LCAiSnVuaW9yX2hpZ2hfbWlzc2VkIiA9IEp1bmlvckhpZ2gsIAogICAgICAgICAiU2VuaW9yX2hpZ2hfbWlzc2VkIiA9IFNlbmlvckhpZ2gsICJVbml2ZXJzaXR5X21pc3NlZCIgPSBVbml2ZXJzaXR5KSAlPiUKICBtdXRhdGUodG90YWxfbWlzc2VkID0gaWZlbHNlKEVsZW1lbnRhcnlfbWlzc2VkID09IDEgfCBKdW5pb3JfaGlnaF9taXNzZWQgPT0gMSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNlbmlvcl9oaWdoX21pc3NlZCA9PSAxIHwgVW5pdmVyc2l0eV9taXNzZWQgPT0gMSwgMSwgMCkpCgpjaGlsZF9sYWJvdXIgPSBmdWxsX2pvaW4oY2hpbGRfbGFib3VyX3dvcmssIGNoaWxkX2xhYm91cl9taXNzZWQsIGJ5ID0gInBpZGxpbmsiKQp0YWJsZShjaGlsZF9sYWJvdXIkdG90YWxfbWlzc2VkKQp0YWJsZShjaGlsZF9sYWJvdXIkdG90YWxfd29ya2VkKQpgYGAgCgojIyBKb2IgSW5mb3JtYXRpb24KYGBge3J9CmpvYiA9IGIzYV90azIgJT4lIHNlbGVjdChwaWRsaW5rLCAiQ2F0ZWdvcnkiID0gdGsyNGEsICJTZWN0b3IiID0gdGsxOWFiLCAid2FnZV9sYXN0X21vbnRoIiA9IHRrMjVhMSwKICAgICAgICAgICAgICAgICAgICAgICAgICJ3YWdlX2xhc3RfeWVhciIgPSB0azI1YTIpICU+JQogIG11dGF0ZShDYXRlZ29yeSA9IGlmZWxzZShDYXRlZ29yeSA9PSAxIHwgQ2F0ZWdvcnkgPT0gMiB8IENhdGVnb3J5ID09IDMsICJTZWxmLWVtcGxveWVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKENhdGVnb3J5ID09IDQsICJHb3Zlcm5tZW50IHdvcmtlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoQ2F0ZWdvcnkgPT0gNSwgIlByaXZhdGUgd29ya2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoQ2F0ZWdvcnkgPT0gNywgIkNhc3VhbCB3b3JrZXIgaW4gYWdyaWN1bHR1cmUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoQ2F0ZWdvcnkgPT0gOCwgIkNhc3VhbCB3b3JrZXIgbm90IGluIGFncmljdWx0dXJlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShDYXRlZ29yeSA9PSA2LCAiVW5wYWlkIGZhbWlseSB3b3JrZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5BKSkpKSkpLAogICAgICAgICBTZWxmX2VtcGxveWVkID0gaWZlbHNlKENhdGVnb3J5ID09ICJTZWxmLWVtcGxveWVkIiwgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoaXMubmEoQ2F0ZWdvcnkpLCBOQSwgMCkpLAogICAgICAgICBTZWN0b3IgPSBpZmVsc2UoU2VjdG9yID09IDEsICJBZ3JpY3VsdHVyZSwgZm9yZXN0cnksIGZpc2hpbmcgYW5kIGh1bnRpbmciLAogICAgICAgICAgICAgICAgICBpZmVsc2UoU2VjdG9yID09IDIsICJNaW5pbmcgYW5kIHF1YXJyeWluZyIsCiAgICAgICAgICAgICAgICAgIGlmZWxzZShTZWN0b3IgPT0gMywgIk1hbnVmYWN0dXJpbmciLAogICAgICAgICAgICAgICAgICBpZmVsc2UoU2VjdG9yID09IDQsICJFbGVjdHJpY2l0eSwgZ2FzLCB3YXRlciIsCiAgICAgICAgICAgICAgICAgIGlmZWxzZShTZWN0b3IgPT0gNSwgIkNvbnN0cnVjdGlvbiIsCiAgICAgICAgICAgICAgICAgIGlmZWxzZShTZWN0b3IgPT0gNiwgIldob2xlc2FsZSwgcmV0YWlsLCByZXN0YXVyYW50cyBhbmQgaG90ZWxzIiwKICAgICAgICAgICAgICAgICAgaWZlbHNlKFNlY3RvciA9PSA3LCAiVHJhbnNwb3J0YXRpb24sIHN0b3JhZ2UgYW5kIGNvbW11bmljYXRpb25zIiwKICAgICAgICAgICAgICAgICAgaWZlbHNlKFNlY3RvciA9PSA4LCAiRmluYW5jZSwgaW5zdXJhbmNlLCByZWFsIGVzdGF0ZSBhbmQgYnVzaW5lc3Mgc2VydmljZXMiLAogICAgICAgICAgICAgICAgICBpZmVsc2UoU2VjdG9yID09IDksICJTb2NpYWwgc2VydmljZXMiLAogICAgICAgICAgICAgICAgICBpZmVsc2UoU2VjdG9yID09IDEwLCAiQWN0aXZpdGllcyB0aGF0IGNhbm5vdCBiZSBjbGFzc2lmaWVkIiwgTkEpKSkpKSkpKSkpLAogICAgICAgICB3YWdlX2xhc3RfbW9udGggPSBpZmVsc2Uod2FnZV9sYXN0X21vbnRoID09IDgsIE5BLCB3YWdlX2xhc3RfbW9udGgpLAogICAgICAgICB3YWdlX2xhc3RfeWVhciA9IGlmZWxzZSh3YWdlX2xhc3RfeWVhciA9PSA4LCBOQSwgd2FnZV9sYXN0X3llYXIpKQoKdGFibGUoam9iJENhdGVnb3J5KQp0YWJsZShqb2IkU2VjdG9yKQpxcGxvdChqb2Ikd2FnZV9sYXN0X21vbnRoKQpzdW1tYXJ5KGpvYiR3YWdlX2xhc3RfbW9udGgpCnggPSBqb2IgJT4lIGZpbHRlcih3YWdlX2xhc3RfbW9udGggPCA1MDAwMDAwKQpxcGxvdCh4JHdhZ2VfbGFzdF9tb250aCkKCnFwbG90KGpvYiR3YWdlX2xhc3RfeWVhcikKc3VtbWFyeShqb2Ikd2FnZV9sYXN0X3llYXIpCnggPSBqb2IgJT4lIGZpbHRlcih3YWdlX2xhc3RfeWVhciA8IDUwMDAwMDAwKQpxcGxvdCh4JHdhZ2VfbGFzdF95ZWFyKQpgYGAKCiMjIEhlYWx0aCBJbmZvcm1hdGlvbiAtIFNtb2tpbmcgQmVoYXZpb3IKYGBge3J9CnNtb2tpbmcgPSBiM2Jfa20gJT4lCiAgc2VsZWN0KHBpZGxpbmssICJldmVyX3Ntb2tlZCIgPSBrbTAxYSwgInN0aWxsX3Ntb2tpbmciID0ga20wNCwgImFtb3VudCIgPSBrbTA4LAogICAgICAgICAibW9uZXlfc3BlbnRfc21va2luZyIgPSBrbTA5LCAiYWdlX2ZpcnN0X3Ntb2tlIiA9IGttMTApICU+JQogIG11dGF0ZShldmVyX3Ntb2tlZCA9IGlmZWxzZShldmVyX3Ntb2tlZCA9PSAxLCAxLCAwKSwKICAgICAgICAgc3RpbGxfc21va2luZyA9IGlmZWxzZShzdGlsbF9zbW9raW5nID09IDEsIDEsIDApLAogICAgICAgICBhbW91bnQgPSBpZmVsc2UoYW1vdW50ID09IDgsIE5BLAogICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGFtb3VudCA9PSA5OCwgTkEsIGFtb3VudCkpLAogICAgICAgICBhbW91bnRfc3RpbGxfc21va2VycyA9IGlmZWxzZShzdGlsbF9zbW9raW5nID09IDEsIGFtb3VudCwgTkEpKQpgYGAKCiMjIE1lcmdlIGRhdGEKCmBgYHtyIG1lcmdlIGRhdGF9CiMjIyBNZXJnZSBhbGwgZGF0YSBmb3IgcGVvcGxlIHdpdGggYmlydGhvcmRlciBpbmZvcm1hdGlvbnMKYWxsZGF0YV9iaXJ0aG9yZGVyID0gbGVmdF9qb2luKGFsbGRhdGFfcHJlZ25hbmN5LCBpcSwgYnkgPSAicGlkbGluayIpCmFsbGRhdGFfYmlydGhvcmRlciA9IGxlZnRfam9pbihhbGxkYXRhX2JpcnRob3JkZXIsIHBlcnMsIGJ5ID0gInBpZGxpbmsiKQphbGxkYXRhX2JpcnRob3JkZXIgPSBsZWZ0X2pvaW4oYWxsZGF0YV9iaXJ0aG9yZGVyLCByaXNrLCBieSA9ICJwaWRsaW5rIikKYWxsZGF0YV9iaXJ0aG9yZGVyID0gbGVmdF9qb2luKGFsbGRhdGFfYmlydGhvcmRlciwgZWEsIGJ5ID0gInBpZGxpbmsiKQphbGxkYXRhX2JpcnRob3JkZXIgPSBsZWZ0X2pvaW4oYWxsZGF0YV9iaXJ0aG9yZGVyLCBFQlRBTkFTLCBieSA9ICJwaWRsaW5rIikKYWxsZGF0YV9iaXJ0aG9yZGVyID0gbGVmdF9qb2luKGFsbGRhdGFfYmlydGhvcmRlciwgY2hpbGRfbGFib3VyLCBieSA9ICJwaWRsaW5rIikKYWxsZGF0YV9iaXJ0aG9yZGVyID0gbGVmdF9qb2luKGFsbGRhdGFfYmlydGhvcmRlciwgam9iLCBieSA9ICJwaWRsaW5rIikKYWxsZGF0YV9iaXJ0aG9yZGVyID0gbGVmdF9qb2luKGFsbGRhdGFfYmlydGhvcmRlciwgc21va2luZywgYnkgPSAicGlkbGluayIpCgoKYWxsZGF0YSA9IGxlZnRfam9pbihpbmRpdmlkdWFsc191bmNoYW5nZWQsIGlxLCBieSA9ICJwaWRsaW5rIikKYWxsZGF0YSA9IGxlZnRfam9pbihhbGxkYXRhLCBwZXJzLCBieSA9ICJwaWRsaW5rIikKYWxsZGF0YSA9IGxlZnRfam9pbihhbGxkYXRhLCByaXNrLCBieSA9ICJwaWRsaW5rIikKYWxsZGF0YSA9IGxlZnRfam9pbihhbGxkYXRhLCBlYSwgYnkgPSAicGlkbGluayIpCmFsbGRhdGEgPSBsZWZ0X2pvaW4oYWxsZGF0YSwgRUJUQU5BUywgYnkgPSAicGlkbGluayIpCmFsbGRhdGEgPSBsZWZ0X2pvaW4oYWxsZGF0YSwgY2hpbGRfbGFib3VyLCBieSA9ICJwaWRsaW5rIikKYWxsZGF0YSA9IGxlZnRfam9pbihhbGxkYXRhLCBqb2IsIGJ5ID0gInBpZGxpbmsiKQphbGxkYXRhID0gbGVmdF9qb2luKGFsbGRhdGEsIHNtb2tpbmcsIGJ5ID0gInBpZGxpbmsiKQoKYGBgCgojIyBGaXggdHlwZXMKYGBge3J9CmFsbGRhdGFfYmlydGhvcmRlciA8LSBhbGxkYXRhX2JpcnRob3JkZXIgJT4lIAogIG11dGF0ZV9hdCh2YXJzKGFnZV8yMDE1X29sZCwgYWdlXzIwMTVfeW91bmcsIGFsaXZlLCBkZWF0aF95ciwgCiAgICAgICAgICAgICAgICAgRW5nbGlzaF9zY29yZV9lbGVtZW50YXJ5LCBFbmdsaXNoX3Njb3JlX0p1bmlvcl9IaWdoLCBFbmdsaXNoX3Njb3JlX1Nlbmlvcl9IaWdoLAogICAgICAgICAgICAgICAgIEluZG9uZXNpYV9zY29yZV9lbGVtZW50YXJ5LCBJbmRvbmVzaWFfc2NvcmVfSnVuaW9yX0hpZ2gsIEluZG9uZXNpYV9zY29yZV9TZW5pb3JfSGlnaCwKICAgICAgICAgICAgICAgICBNYXRoX3Njb3JlX2VsZW1lbmF0cnksIE1hdGhfc2NvcmVfSnVuaW9yX0hpZ2gsIE1hdGhfc2NvcmVfU2VuaW9yX0hpZ2gsIAogICAgICAgICAgICAgICAgICksIGZ1bnMoYXMubnVtZXJpYykpICU+JSAKICBtdXRhdGVfYXQodmFycyhNYXRoX3Njb3JlX2hpZ2hlc3RfdHlwZSwgVG90YWxfc2NvcmVfaGlnaGVzdF90eXBlLCBtb3RoZXJfcGlkbGluaywgZmF0aGVyX3BpZGxpbmssIG1hcnJpYWdlX2lkLCBwaWRsaW5rLCAgcmFuZG9tX3NpLAogICAgICAgICAgICAgICAgIFNlY3RvciwgVHlwZV9vZl90ZXN0X2VsZW1lbnRhcnksIFR5cGVfb2ZfdGVzdF9KdW5pb3JfSGlnaCwgVHlwZV9vZl90ZXN0X1Nlbmlvcl9IaWdoLCBsaWZlYmlydGhzLCBDYXRlZ29yeQogICAgICAgICAgICAgICAgICksIGZ1bnMoYXMuZmFjdG9yKSkgJT4lIAogIG11dGF0ZShtYWxlID0gaWZfZWxzZShzZXggPT0gMSwgMUwsIDBMKSwKICAgICAgICAgd2FnZV9sYXN0X21vbnRoX2xvZyA9IGxvZyh3YWdlX2xhc3RfbW9udGgrMSksCiAgICAgICAgIHdhZ2VfbGFzdF95ZWFyX2xvZyA9IGxvZyh3YWdlX2xhc3RfeWVhcisxKSwKICAgICAgICAgbW9uZXlfc3BlbnRfc21va2luZ19sb2cgPSBsb2cobW9uZXlfc3BlbnRfc21va2luZysxKSkgJT4lIAogIG11dGF0ZV9hdCh2YXJzKGFsaXZlLCBFbGVtZW50YXJ5X21pc3NlZCwgRWxlbWVudGFyeV93b3JrZWQsIGV2ZXJfc21va2VkLCBKdW5pb3JfaGlnaF9taXNzZWQsIEp1bmlvcl9oaWdoX3dvcmtlZCwgU2VsZl9lbXBsb3llZCwgdG90YWxfbWlzc2VkLAogICAgICAgICAgICAgICAgIFNlbmlvcl9oaWdoX21pc3NlZCwgU2VuaW9yX2hpZ2hfd29ya2VkLAogICAgICAgICAgICAgICAgIHN0aWxsX3Ntb2tpbmcsIFVuaXZlcnNpdHlfbWlzc2VkLCBVbml2ZXJzaXR5X3dvcmtlZCwgd2F2ZSksIGZ1bnMoYXMuaW50ZWdlcikpICU+JSAKICBtdXRhdGVfYXQodmFycyhiaXJ0aGRhdGUpLCBmdW5zKGFzLkRhdGUpKSAlPiUgCiAgICBzZWxlY3QoLW1vdGhlcklELCAtZmF0aGVySUQsIC1tb3RoZXJfYmlydGhvcmRlciwgLW1vdGhlcl9iaXJ0aGRhdGUsIC1tb250aCwgLWVuZCwgLXN0YXJ0LCAtZ2VuZGVyLCAtc2V4LCAtc2V4XzIwMTVfb2xkLCAtc2V4XzIwMTVfeW91bmcsCiAgICAgICAgICAgLXJlbGF0aW9uX3RvX0hIX2hlYWQsIC15ZWFyc19vZl9lZHVjYXRpb25fZmFjdG9yLCAtYmlydGhkYXRlX2R1cGVkX2luX2VhcmxpZXJfd2F2ZSwgLWJpcnRob3JkZXJfZHVwZWRfaW5fZWFybGllcl93YXZlLCAtYmlydGhvcmRlcl9uYWl2ZV9pbmQsCiAgICAgICAgICAgLW9yZGVyX21hcnJpYWdlLCAtbWF0Y2hlcygiXnNpWzAtOV0rJCIpLCAgLW1hdGNoZXMoIl5bYS16XVswLTldcj8kIiksICAtbWF0Y2hlcygiXlthLXpdWzAtOV1yX3JldmVyc2VkJCIpLAogICAgICAgICAgIC1hcjA4ZGF5LCAtYXIwOG10aCwgLWFyMDh5ciwgLWJpcnRoX2RheSwgLWJpcnRoX21vbnRoLCAtYmlydGhfeWVhciwgLWhpZ2hlc3RfZ3JhZGUsIC13YWdlX2xhc3RfbW9udGgsIC13YWdlX2xhc3RfeWVhciwgLXN0YXR1cywKICAgICAgICAgICAtbW9uZXlfc3BlbnRfc21va2luZywgLXN0YXJ0c193aXRoKCJoaGlkMTRfIiksIHNjMDUsIHByb3ZpbmNlLCBzYzAxXzE0XzE0KQpgYGAKCiMjIFNhdmUgZGF0YQoKZm9yIGZ1dHVyZSBhbmFseXNlcwoKYGBge3Igc2F2ZSBkYXRhfQphbGxkYXRhX2JpcnRob3JkZXIgPSBhbGxkYXRhX2JpcnRob3JkZXIgJT4lIHVuZ3JvdXAoKQphbGxkYXRhID0gYWxsZGF0YSAlPiUgdW5ncm91cCgpCnByZWduYW5jeSA9IHByZWduYW5jeSAlPiUgdW5ncm91cCgpCmlxID0gaXEgJT4lIHVuZ3JvdXAoKQoKc2F2ZVJEUyhhbGxkYXRhX2JpcnRob3JkZXIsIGZpbGUgPSAiZGF0YS9hbGxkYXRhX2JpcnRob3JkZXIucmRzIikKc2F2ZVJEUyhhbGxkYXRhLCBmaWxlID0gImRhdGEvYWxsZGF0YS5yZHMiKQpzYXZlUkRTKHByZWduYW5jeSwgZmlsZSA9ICJkYXRhL3ByZWduYW5jeS5yZHMiKQpzYXZlUkRTKGlxLCBmaWxlID0gImRhdGEvaXEucmRzIikKYGBgCg==</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
