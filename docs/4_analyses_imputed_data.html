<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>4_analyses_imputed_data.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("4_analyses_imputed_data.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>





<head>
<style>
.dropdown-menu li:hover .sub-menu {
  visibility: visible;
}

.dropdown:hover .dropdown-menu {
  display: block;
}
</style>
</head>


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
<div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
  </button>
  <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
</div>
<div id="navbar" class="navbar-collapse collapse">
  <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>

<li class="dropdown" style="background-color: #E5C494">
        <a class="dropdown-toggle" aria-expanded="false">
          Birth Order Effects <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" style="background-color: #E5C494">
          <li class=""><a href="4_analyses.html" aria-expanded="false" aria-controls="first-tab"> Main Analyses</a></li>
          <li class=""><a href="4_analyses_robust.html" aria-expanded="false" aria-controls="first-tab"> Robustness Analyses</a></li>
        </ul>
     </li>


<li class="dropdown" style="background-color: #FFD92F">
        <a class="dropdown-toggle" aria-expanded="false">
          Birth Order Effects Imputed Data <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" style="background-color: #FFD92F">
          <li class=""><a href="3_imputation.html" aria-expanded="false" aria-controls="first-tab">Multiple Imputation</a></li>
          <li class=""><a href="3_imputation_check.html" aria-expanded="false" aria-controls="first-tab">Imputation Checks</a></li>
          <li class=""><a href="4_analyses_imputed_data.html" aria-expanded="false" aria-controls="second-tab">Birth Order Effects Imputed Data</a></li>
        </ul>
     </li>


  </ul>
  <ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
<span class="fa fa-github"></span>


  </a>
</li>
  </ul>
</div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>




</div>

<div id="birth-order-effects" class="section level1 tabset">
<h1><span style="color:#A6D854">Birth Order Effects</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     ggsave</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.5-23.1097</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;sjPlot&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:cowplot&#39;:
## 
##     plot_grid, save_plot</code></pre>
<pre class="r"><code>opts_chunk$set(warning = FALSE)
detach(&quot;package:lmerTest&quot;, unload=TRUE)</code></pre>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<pre class="r"><code>options(mc.cores=4)
n_imputations.mitml = function(imps) {
  imps$iter$m
}
n_imputations.mids = function(imps) {
  imps$m
}
n_imputations.amelia = function(imps) {
  length(imps$imputations)
}
n_imputations = function(imps) { UseMethod(&quot;n_imputations&quot;) }

complete.mitml = mitml::mitmlComplete
complete.mids = mice::complete
complete = function(...) { UseMethod(&quot;complete&quot;) }

library(mice)</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     complete</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     complete</code></pre>
<pre class="r"><code>library(miceadds)</code></pre>
<pre><code>## * miceadds 2.7-19 (2017-08-24 17:34:44)</code></pre>
<pre class="r"><code>library(mitml)</code></pre>
<pre><code>## *** This is beta software. Please report any bugs!
## *** See the NEWS file for recent changes.</code></pre>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code>birthorder = readRDS(&quot;data/alldata_birthorder_i_ml.rds&quot;)</code></pre>
</div>
<div id="data-preparations" class="section level2">
<h2>Data preparations</h2>
<pre class="r"><code>birthorder &lt;- mids2mitml.list(birthorder)

## Calculate g_factors (for now with rowMeans: better to run factor analysis here as well?)
birthorder &lt;- within(birthorder, {
  g_factor_2015_old &lt;- rowMeans(scale(cbind(raven_2015_old, math_2015_old, count_backwards,  words_delayed, adaptive_numbering)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2015_young &lt;- rowMeans(scale(cbind(raven_2015_young, math_2015_young)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_old &lt;- rowMeans(scale(cbind(raven_2007_old, math_2007_old)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_young &lt;- rowMeans(scale(cbind(raven_2007_young, math_2007_young)))
})


birthorder = birthorder %&gt;% tbl_df.mitml.list

### Birthorder and Sibling Count
# for factor variables we have to round birth order position and eliminate all unlikely numbers (negative ones)
birthorder_data = birthorder[[1]]

birthorder = birthorder %&gt;%
  mutate(birthorder_genes = ifelse(birthorder_genes &lt; 0, 0, birthorder_genes),
         birthorder_naive = ifelse(birthorder_naive &lt; 0, 0, birthorder_naive),
         birthorder_genes = round(birthorder_genes),
         birthorder_naive = round(birthorder_naive),
         sibling_count_genes = ifelse(sibling_count_genes &lt; 0, 0, sibling_count_genes),
         sibling_count_naive = ifelse(sibling_count_naive &lt; 0, 0, sibling_count_naive),
         sibling_count_genes = round(sibling_count_genes),
         sibling_count_naive = round(sibling_count_naive)
         )


birthorder = birthorder %&gt;% 
  mutate(
# birthorder as factors with levels of 1, 2, 3, 4, 5, 5+
    birthorder_naive_factor = as.character(birthorder_naive),
    birthorder_naive_factor = ifelse(birthorder_naive &gt; 5, &quot;5+&quot;,
                                            birthorder_naive_factor),
    birthorder_naive_factor = factor(birthorder_naive_factor, 
                                            levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    sibling_count_naive_factor = as.character(sibling_count_naive),
    sibling_count_naive_factor = ifelse(sibling_count_naive &gt; 5, &quot;5+&quot;,
                                               sibling_count_naive_factor),
    sibling_count_naive_factor = factor(sibling_count_naive_factor, 
                                               levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    birthorder_genes_factor = as.character(birthorder_genes),
    birthorder_genes_factor = ifelse(birthorder_genes &gt;5 , &quot;5+&quot;, birthorder_genes_factor),
    birthorder_genes_factor = factor(birthorder_genes_factor, 
                                     levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    sibling_count_genes_factor = as.character(sibling_count_genes),
    sibling_count_genes_factor = ifelse(sibling_count_genes &gt;5 , &quot;5+&quot;,
                                        sibling_count_genes_factor),
    sibling_count_genes_factor = factor(sibling_count_genes_factor, 
                                        levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    # interaction birthorder * siblingcout for each birthorder
    count_birthorder_naive =
      factor(str_replace(as.character(interaction(birthorder_naive_factor,                                                              sibling_count_naive_factor)),
                        &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;,
                                                        &quot;1/5+&quot;, &quot;2/5+&quot;, &quot;3/5+&quot;, &quot;4/5+&quot;,
                                                        &quot;5/5+&quot;, &quot;5+/5+&quot;)),
    count_birthorder_genes =
      factor(str_replace(as.character(interaction(birthorder_genes_factor,                                                              sibling_count_genes_factor)), &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;,
                                                        &quot;1/5+&quot;, &quot;2/5+&quot;, &quot;3/5+&quot;, &quot;4/5+&quot;,
                                                        &quot;5/5+&quot;, &quot;5+/5+&quot;)))



### Variables
birthorder = birthorder %&gt;%
  mutate(
    g_factor_2015_old = (g_factor_2015_old - mean(g_factor_2015_old, na.rm=T)) / sd(g_factor_2015_old, na.rm=T),
    g_factor_2015_young = (g_factor_2015_young - mean(g_factor_2015_young, na.rm=T)) / sd(g_factor_2015_young, na.rm=T),
    g_factor_2007_old = (g_factor_2007_old - mean(g_factor_2007_old, na.rm=T)) / sd(g_factor_2007_old, na.rm=T),
g_factor_2007_young = (g_factor_2007_young - mean(g_factor_2007_young, na.rm=T)) / sd(g_factor_2007_young, na.rm=T),
    raven_2015_old = (raven_2015_old - mean(raven_2015_old, na.rm=T)) / sd(raven_2015_old),
    math_2015_old = (math_2015_old - mean(math_2015_old, na.rm=T)) / sd(math_2015_old, na.rm=T),
    raven_2015_young = (raven_2015_young - mean(raven_2015_young, na.rm=T)) / sd(raven_2015_young),
    math_2015_young = (math_2015_young - mean(math_2015_young, na.rm=T)) /
      sd(math_2015_young, na.rm=T),
    raven_2007_old = (raven_2007_old - mean(raven_2007_old, na.rm=T)) / sd(raven_2007_old),
math_2007_old = (math_2007_old - mean(math_2007_old, na.rm=T)) / sd(math_2007_old, na.rm=T),
raven_2007_young = (raven_2007_young - mean(raven_2007_young, na.rm=T)) / sd(raven_2007_young),
math_2007_young = (math_2007_young - mean(math_2007_young, na.rm=T)) /
  sd(math_2007_young, na.rm=T),
    count_backwards = (count_backwards - mean(count_backwards, na.rm=T)) /
      sd(count_backwards, na.rm=T),
    words_delayed = (words_delayed - mean(words_delayed, na.rm=T)) /
      sd(words_delayed, na.rm=T),
    adaptive_numbering = (adaptive_numbering - mean(adaptive_numbering, na.rm=T)) /
      sd(adaptive_numbering, na.rm=T),
    big5_ext = (big5_ext - mean(big5_ext, na.rm=T)) / sd(big5_ext, na.rm=T),
    big5_con = (big5_con - mean(big5_con, na.rm=T)) / sd(big5_con, na.rm=T),
    big5_agree = (big5_agree - mean(big5_agree, na.rm=T)) / sd(big5_agree, na.rm=T),
    big5_open = (big5_open - mean(big5_open, na.rm=T)) / sd(big5_open, na.rm=T),
    big5_neu = (big5_neu - mean(big5_neu, na.rm=T)) / sd(big5_neu, na.rm=T),
    riskA = (riskA - mean(riskA, na.rm=T)) / sd(riskA, na.rm=T),
    riskB = (riskB - mean(riskB, na.rm=T)) / sd(riskB, na.rm=T),
    years_of_education_z = (years_of_education - mean(years_of_education, na.rm=T)) /
      sd(years_of_education, na.rm=T),
    wage_last_month_z = (wage_last_month_log - mean(wage_last_month_log, na.rm=T)) /
      sd(wage_last_month_log, na.rm=T),
    wage_last_year_z = (wage_last_year_log - mean(wage_last_year_log, na.rm=T)) /
      sd(wage_last_year_log, na.rm=T),
    attended_school = as.integer(attended_school),
    attended_school = ifelse(attended_school == 1, 0,
                           ifelse(attended_school == 2, 1, NA)))
        
data_used &lt;- birthorder %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)</code></pre>
</div>
<div id="intelligence" class="section level2 active tabset">
<h2>Intelligence</h2>
<div id="g-factor-2015-old" class="section level3 tabset">
<h3>g-factor 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.464     0.029     0.408     0.521    16.157   299.180     0.000     1.354     0.578 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.026    -0.011    -4.943   325.538     0.000     1.229     0.554 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.407   446.575     0.684     0.890     0.473 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.341   486.279     0.020     0.822     0.453 
## male                         -0.006     0.012    -0.030     0.018    -0.485   672.427     0.628     0.623     0.386 
## sibling_count3                0.012     0.021    -0.029     0.054     0.590   446.241     0.556     0.890     0.473 
## sibling_count4               -0.022     0.025    -0.071     0.027    -0.868   506.631     0.386     0.792     0.444 
## sibling_count5               -0.086     0.031    -0.147    -0.024    -2.733   421.563     0.007     0.940     0.487 
## sibling_count5+              -0.160     0.025    -0.210    -0.110    -6.299   638.606     0.000     0.649     0.396 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.661 
## ICC|mother_pidlink                     0.239 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-1" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.450     0.030     0.390     0.509    14.876   328.201     0.000     1.218     0.552 
## birth_order                   0.007     0.005    -0.003     0.016     1.420   555.362     0.156     0.731     0.424 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.026    -0.011    -4.924   326.334     0.000     1.226     0.554 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.494   445.001     0.622     0.893     0.474 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.444   487.201     0.015     0.821     0.453 
## male                         -0.006     0.012    -0.030     0.018    -0.486   670.815     0.627     0.624     0.386 
## sibling_count3                0.008     0.021    -0.034     0.050     0.376   448.915     0.707     0.885     0.472 
## sibling_count4               -0.031     0.025    -0.080     0.019    -1.216   569.860     0.225     0.715     0.419 
## sibling_count5               -0.099     0.032    -0.163    -0.036    -3.053   445.868     0.002     0.891     0.474 
## sibling_count5+              -0.183     0.029    -0.241    -0.125    -6.222   718.209     0.000     0.591     0.373 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.661 
## ICC|mother_pidlink                     0.239 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-1" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-2" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.465     0.032     0.401     0.528    14.351   311.641     0.000     1.292     0.566 
## birth_order_nonlinear2        0.000     0.017    -0.033     0.034     0.020   439.846     0.984     0.903     0.477 
## birth_order_nonlinear3        0.005     0.022    -0.039     0.048     0.217   407.979     0.828     0.971     0.495 
## birth_order_nonlinear4        0.006     0.028    -0.048     0.060     0.222   475.737     0.825     0.839     0.458 
## birth_order_nonlinear5        0.009     0.033    -0.056     0.073     0.262   690.855     0.793     0.609     0.380 
## birth_order_nonlinear5+       0.016     0.033    -0.049     0.081     0.473   664.783     0.637     0.628     0.388 
## poly(age, 3, raw = TRUE)1    -0.019     0.004    -0.026    -0.011    -4.856   328.088     0.000     1.219     0.552 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.602   449.729     0.547     0.884     0.472 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.504   497.068     0.013     0.806     0.448 
## male                         -0.007     0.012    -0.031     0.017    -0.574   709.993     0.566     0.596     0.375 
## sibling_count3                0.009     0.022    -0.034     0.052     0.396   463.306     0.692     0.860     0.465 
## sibling_count4               -0.027     0.026    -0.079     0.024    -1.038   596.423     0.300     0.688     0.409 
## sibling_count5               -0.093     0.034    -0.159    -0.027    -2.761   467.621     0.006     0.852     0.462 
## sibling_count5+              -0.174     0.030    -0.232    -0.115    -5.798   799.598     0.000     0.543     0.353 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.660 
## ICC|mother_pidlink                     0.239 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-2" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-3" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.453     0.037     0.381     0.525    12.350   291.532     0.000     1.397     0.586 
## count_birth_order2/2          0.011     0.025    -0.038     0.060     0.440   414.660     0.660     0.955     0.491 
## count_birth_order1/3          0.015     0.031    -0.046     0.076     0.485   522.795     0.628     0.770     0.437 
## count_birth_order2/3          0.003     0.030    -0.055     0.061     0.106   473.626     0.916     0.842     0.459 
## count_birth_order3/3          0.026     0.031    -0.034     0.087     0.850   520.678     0.395     0.773     0.438 
## count_birth_order1/4         -0.031     0.040    -0.110     0.048    -0.758   641.279     0.449     0.647     0.395 
## count_birth_order2/4         -0.016     0.039    -0.092     0.059    -0.416   496.116     0.678     0.807     0.449 
## count_birth_order3/4         -0.037     0.038    -0.111     0.037    -0.981   580.068     0.327     0.704     0.415 
## count_birth_order4/4          0.000     0.043    -0.084     0.085     0.009   361.601     0.993     1.098     0.526 
## count_birth_order1/5         -0.064     0.057    -0.176     0.049    -1.112   508.657     0.267     0.789     0.443 
## count_birth_order2/5         -0.089     0.050    -0.188     0.009    -1.776   649.957     0.076     0.640     0.392 
## count_birth_order3/5         -0.093     0.050    -0.192     0.006    -1.844   518.879     0.066     0.776     0.439 
## count_birth_order4/5         -0.106     0.050    -0.204    -0.008    -2.125   532.475     0.034     0.758     0.433 
## count_birth_order5/5         -0.072     0.052    -0.174     0.030    -1.378   535.506     0.169     0.754     0.432 
## count_birth_order1/5+        -0.181     0.053    -0.284    -0.078    -3.434   541.265     0.001     0.747     0.430 
## count_birth_order2/5+        -0.193     0.046    -0.283    -0.103    -4.214   651.325     0.000     0.639     0.392 
## count_birth_order3/5+        -0.149     0.044    -0.236    -0.063    -3.378   627.764     0.001     0.659     0.399 
## count_birth_order4/5+        -0.168     0.046    -0.257    -0.078    -3.671   502.306     0.000     0.798     0.446 
## count_birth_order5/5+        -0.165     0.042    -0.248    -0.082    -3.903   705.155     0.000     0.599     0.376 
## count_birth_order5+/5+       -0.154     0.034    -0.221    -0.087    -4.505   570.348     0.000     0.714     0.419 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.025    -0.010    -4.370   322.723     0.000     1.241     0.557 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.380   445.616     0.704     0.892     0.474 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.300   496.763     0.022     0.806     0.449 
## male                         -0.007     0.013    -0.031     0.018    -0.538   714.086     0.591     0.593     0.374 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.660 
## ICC|mother_pidlink                     0.238 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-3" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.408       10 1005.346    0.943  128.741 
##   2 vs 3:    0.443        4  398.120    0.777  368.403 
##   3 vs 4:    2.015        1  524.519    0.156    0.731</code></pre>
</div>
</div>
</div>
<div id="g-factor-2015-young" class="section level3 tabset">
<h3>g-factor 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-1" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-1" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-4" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.540     0.037    -0.613    -0.466   -14.445   178.873     0.000     2.906     0.747 
## poly(age, 3, raw = TRUE)1     0.039     0.004     0.031     0.046    10.354   328.444     0.000     1.217     0.552 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.863   388.479     0.004     1.019     0.507 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.307   366.716     0.192     1.082     0.522 
## male                         -0.062     0.013    -0.087    -0.036    -4.665   494.874     0.000     0.809     0.449 
## sibling_count3                0.007     0.020    -0.031     0.046     0.379   665.499     0.705     0.628     0.388 
## sibling_count4               -0.023     0.023    -0.068     0.022    -1.012   949.156     0.312     0.477     0.324 
## sibling_count5               -0.084     0.029    -0.141    -0.028    -2.926   674.390     0.004     0.621     0.385 
## sibling_count5+              -0.133     0.026    -0.183    -0.082    -5.163   612.528     0.000     0.672     0.404 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-4" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-1" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-5" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.538     0.039    -0.614    -0.463   -13.932   191.575     0.000     2.557     0.722 
## birth_order                  -0.001     0.005    -0.010     0.009    -0.132   531.403     0.895     0.759     0.434 
## poly(age, 3, raw = TRUE)1     0.039     0.004     0.031     0.046    10.350   328.465     0.000     1.217     0.552 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.867   389.188     0.004     1.018     0.507 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.313   366.635     0.190     1.082     0.522 
## male                         -0.062     0.013    -0.087    -0.036    -4.665   494.925     0.000     0.809     0.449 
## sibling_count3                0.008     0.020    -0.031     0.047     0.393   649.355     0.694     0.641     0.392 
## sibling_count4               -0.022     0.024    -0.069     0.024    -0.940   911.104     0.348     0.492     0.331 
## sibling_count5               -0.083     0.031    -0.143    -0.023    -2.710   631.691     0.007     0.655     0.398 
## sibling_count5+              -0.131     0.031    -0.192    -0.069    -4.150   505.915     0.000     0.793     0.445 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-5" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-1" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-6" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.534     0.040    -0.612    -0.456   -13.446   199.707     0.000     2.379     0.707 
## birth_order_nonlinear2       -0.003     0.016    -0.034     0.028    -0.186   660.390     0.853     0.632     0.389 
## birth_order_nonlinear3       -0.011     0.020    -0.050     0.029    -0.522   689.408     0.602     0.610     0.381 
## birth_order_nonlinear4       -0.011     0.026    -0.062     0.040    -0.423   726.788     0.672     0.585     0.371 
## birth_order_nonlinear5       -0.028     0.033    -0.093     0.038    -0.828   702.224     0.408     0.601     0.377 
## birth_order_nonlinear5+      -0.011     0.035    -0.080     0.059    -0.300   496.131     0.764     0.807     0.449 
## poly(age, 3, raw = TRUE)1     0.039     0.004     0.031     0.046    10.057   339.287     0.000     1.175     0.543 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.728   398.365     0.007     0.994     0.501 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.214   375.491     0.225     1.055     0.516 
## male                         -0.062     0.013    -0.088    -0.036    -4.688   510.459     0.000     0.787     0.443 
## sibling_count3                0.009     0.021    -0.032     0.050     0.423   647.829     0.672     0.642     0.393 
## sibling_count4               -0.019     0.025    -0.068     0.029    -0.782   939.862     0.434     0.481     0.326 
## sibling_count5               -0.077     0.032    -0.140    -0.015    -2.419   648.752     0.016     0.641     0.393 
## sibling_count5+              -0.126     0.032    -0.189    -0.063    -3.917   539.745     0.000     0.749     0.430 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-6" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-1" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-7" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.546     0.041    -0.627    -0.465   -13.170   222.415     0.000     2.005     0.670 
## count_birth_order2/2          0.009     0.023    -0.036     0.055     0.409   613.214     0.683     0.672     0.404 
## count_birth_order1/3          0.021     0.030    -0.037     0.080     0.716   686.023     0.474     0.613     0.382 
## count_birth_order2/3         -0.000     0.029    -0.057     0.057    -0.001   548.458     0.999     0.739     0.427 
## count_birth_order3/3          0.007     0.030    -0.051     0.065     0.224   709.864     0.823     0.596     0.375 
## count_birth_order1/4         -0.018     0.043    -0.102     0.066    -0.417   492.250     0.677     0.813     0.451 
## count_birth_order2/4         -0.020     0.036    -0.090     0.049    -0.569   871.849     0.569     0.508     0.338 
## count_birth_order3/4         -0.044     0.035    -0.113     0.025    -1.246   989.072     0.213     0.463     0.318 
## count_birth_order4/4         -0.003     0.041    -0.083     0.076    -0.075   484.972     0.940     0.824     0.454 
## count_birth_order1/5         -0.046     0.056    -0.157     0.064    -0.824   597.731     0.410     0.686     0.409 
## count_birth_order2/5         -0.066     0.051    -0.166     0.033    -1.308   653.259     0.191     0.637     0.391 
## count_birth_order3/5         -0.078     0.049    -0.174     0.019    -1.580   624.553     0.115     0.662     0.400 
## count_birth_order4/5         -0.119     0.048    -0.214    -0.024    -2.458   686.489     0.014     0.612     0.382 
## count_birth_order5/5         -0.104     0.051    -0.204    -0.004    -2.040   642.659     0.042     0.646     0.394 
## count_birth_order1/5+        -0.147     0.053    -0.250    -0.043    -2.781   571.237     0.006     0.713     0.418 
## count_birth_order2/5+        -0.138     0.051    -0.239    -0.038    -2.689   387.163     0.007     1.023     0.508 
## count_birth_order3/5+        -0.111     0.048    -0.205    -0.017    -2.320   443.255     0.021     0.896     0.475 
## count_birth_order4/5+        -0.136     0.046    -0.227    -0.046    -2.945   497.699     0.003     0.805     0.448 
## count_birth_order5/5+        -0.149     0.044    -0.236    -0.062    -3.351   554.903     0.001     0.731     0.424 
## count_birth_order5+/5+       -0.133     0.034    -0.199    -0.067    -3.945   667.257     0.000     0.627     0.387 
## poly(age, 3, raw = TRUE)1     0.040     0.004     0.032     0.047    10.148   371.641     0.000     1.067     0.519 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.905   434.179     0.004     0.914     0.480 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.360   401.315     0.174     0.987     0.499 
## male                         -0.062     0.013    -0.088    -0.036    -4.665   531.260     0.000     0.760     0.434 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-7" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-1" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.421       10 1005.347    0.937  128.728 
##   2 vs 3:    0.445        4  398.121    0.776  368.227 
##   3 vs 4:    0.018        1  501.383    0.894    0.761</code></pre>
</div>
</div>
</div>
</div>
<div id="personality" class="section level2 tabset">
<h2>Personality</h2>
<div id="extraversion" class="section level3 tabset">
<h3>Extraversion</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_ext)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-2" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-2" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-8" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.173     0.033     0.109     0.237     5.291   240.897     0.000     1.786     0.644 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.005    -0.642   334.090     0.521     1.195     0.547 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.546   526.394     0.585     0.766     0.436 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.920   624.644     0.358     0.661     0.400 
## male                         -0.243     0.016    -0.274    -0.212   -15.204   335.703     0.000     1.188     0.546 
## sibling_count3               -0.007     0.020    -0.046     0.032    -0.369   603.366     0.712     0.681     0.407 
## sibling_count4               -0.015     0.024    -0.063     0.033    -0.620   518.440     0.535     0.776     0.439 
## sibling_count5               -0.025     0.029    -0.081     0.032    -0.857   556.856     0.392     0.729     0.424 
## sibling_count5+              -0.045     0.025    -0.095     0.005    -1.766   427.114     0.078     0.928     0.484 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.065 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-8" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-2" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-9" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.172     0.034     0.105     0.238     5.054   263.450     0.000     1.584     0.616 
## birth_order                   0.001     0.006    -0.010     0.011     0.120   428.137     0.905     0.926     0.483 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.005    -0.640   335.350     0.522     1.190     0.546 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.550   521.192     0.583     0.773     0.438 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.924   619.998     0.356     0.666     0.402 
## male                         -0.243     0.016    -0.274    -0.212   -15.206   335.777     0.000     1.188     0.546 
## sibling_count3               -0.008     0.020    -0.048     0.032    -0.382   584.491     0.702     0.699     0.414 
## sibling_count4               -0.016     0.025    -0.066     0.034    -0.629   506.163     0.530     0.793     0.444 
## sibling_count5               -0.026     0.030    -0.084     0.033    -0.866   610.801     0.387     0.674     0.405 
## sibling_count5+              -0.047     0.031    -0.108     0.014    -1.520   463.294     0.129     0.860     0.465 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.065 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-9" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-2" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-10" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.166     0.036     0.096     0.237     4.635   264.582     0.000     1.575     0.615 
## birth_order_nonlinear2        0.007     0.020    -0.032     0.046     0.334   387.801     0.739     1.021     0.508 
## birth_order_nonlinear3        0.007     0.025    -0.041     0.055     0.275   444.272     0.783     0.894     0.474 
## birth_order_nonlinear4        0.021     0.031    -0.040     0.082     0.662   506.766     0.508     0.792     0.444 
## birth_order_nonlinear5        0.038     0.041    -0.042     0.118     0.927   444.726     0.354     0.893     0.474 
## birth_order_nonlinear5+      -0.016     0.039    -0.092     0.060    -0.411   516.752     0.682     0.778     0.440 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.010     0.006    -0.494   343.004     0.622     1.161     0.540 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.434   524.688     0.665     0.768     0.437 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.826   617.342     0.409     0.668     0.402 
## male                         -0.244     0.016    -0.275    -0.212   -15.086   337.695     0.000     1.181     0.544 
## sibling_count3               -0.009     0.022    -0.052     0.034    -0.425   512.077     0.671     0.785     0.442 
## sibling_count4               -0.021     0.027    -0.075     0.032    -0.780   476.414     0.436     0.838     0.458 
## sibling_count5               -0.037     0.032    -0.099     0.025    -1.177   637.785     0.240     0.650     0.396 
## sibling_count5+              -0.050     0.032    -0.113     0.013    -1.550   499.961     0.122     0.802     0.447 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-10" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-2" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-11" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.171     0.038     0.095     0.246     4.442   290.105     0.000     1.405     0.587 
## count_birth_order2/2         -0.002     0.028    -0.058     0.053    -0.076   410.837     0.939     0.964     0.493 
## count_birth_order1/3         -0.023     0.033    -0.088     0.042    -0.706   536.371     0.481     0.753     0.432 
## count_birth_order2/3         -0.003     0.031    -0.065     0.058    -0.099   507.901     0.921     0.791     0.444 
## count_birth_order3/3         -0.006     0.033    -0.070     0.058    -0.181   582.924     0.857     0.701     0.414 
## count_birth_order1/4         -0.035     0.044    -0.122     0.052    -0.787   579.793     0.431     0.704     0.415 
## count_birth_order2/4         -0.028     0.044    -0.114     0.058    -0.647   387.001     0.518     1.023     0.508 
## count_birth_order3/4         -0.020     0.043    -0.104     0.064    -0.469   435.944     0.639     0.910     0.479 
## count_birth_order4/4          0.007     0.042    -0.075     0.089     0.170   581.175     0.865     0.703     0.415 
## count_birth_order1/5         -0.051     0.061    -0.170     0.068    -0.838   603.231     0.402     0.681     0.407 
## count_birth_order2/5         -0.032     0.056    -0.143     0.079    -0.569   537.778     0.569     0.751     0.431 
## count_birth_order3/5         -0.033     0.052    -0.134     0.068    -0.634   733.113     0.526     0.581     0.369 
## count_birth_order4/5         -0.030     0.054    -0.135     0.075    -0.565   570.681     0.573     0.714     0.419 
## count_birth_order5/5         -0.006     0.061    -0.126     0.114    -0.097   376.960     0.922     1.051     0.515 
## count_birth_order1/5+        -0.058     0.055    -0.166     0.049    -1.061   706.737     0.289     0.598     0.376 
## count_birth_order2/5+        -0.044     0.054    -0.149     0.062    -0.813   427.794     0.417     0.927     0.483 
## count_birth_order3/5+        -0.050     0.048    -0.145     0.044    -1.049   604.782     0.295     0.680     0.407 
## count_birth_order4/5+        -0.041     0.045    -0.129     0.047    -0.911   902.427     0.362     0.495     0.333 
## count_birth_order5/5+        -0.018     0.051    -0.118     0.083    -0.341   389.852     0.733     1.016     0.506 
## count_birth_order5+/5+       -0.073     0.037    -0.146    -0.001    -1.984   433.506     0.048     0.915     0.480 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.010     0.006    -0.455   379.199     0.649     1.045     0.514 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.430   593.402     0.668     0.690     0.410 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.841   696.551     0.400     0.605     0.379 
## male                         -0.244     0.016    -0.276    -0.212   -15.026   343.754     0.000     1.158     0.539 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.065 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-11" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-2" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.513       10 1005.348    0.882  128.720 
##   2 vs 3:    0.515        4  398.120    0.724  368.484 
##   3 vs 4:    0.014        1  406.183    0.906    0.926</code></pre>
</div>
</div>
</div>
<div id="neuroticism" class="section level3 tabset">
<h3>Neuroticism</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-3" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-3" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-12" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.182     0.033     0.117     0.246     5.538   236.684     0.000     1.831     0.650 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.721   351.705     0.086     1.130     0.533 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.460   512.367     0.145     0.784     0.442 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.104   562.772     0.036     0.722     0.421 
## male                          0.038     0.014     0.011     0.065     2.754   634.068     0.006     0.653     0.397 
## sibling_count3                0.007     0.019    -0.031     0.045     0.373   717.627     0.709     0.591     0.373 
## sibling_count4               -0.011     0.023    -0.057     0.034    -0.482   627.420     0.630     0.659     0.399 
## sibling_count5               -0.021     0.028    -0.077     0.034    -0.747   579.302     0.456     0.705     0.415 
## sibling_count5+              -0.049     0.024    -0.095    -0.003    -2.091   604.356     0.037     0.680     0.407 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.925 
## ICC|mother_pidlink                     0.056 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-12" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-3" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-13" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.183     0.035     0.116     0.251     5.301   248.743     0.000     1.709     0.634 
## birth_order                  -0.001     0.005    -0.012     0.010    -0.165   443.892     0.869     0.895     0.475 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.726   353.016     0.085     1.126     0.532 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.463   507.839     0.144     0.791     0.444 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.107   558.573     0.036     0.727     0.423 
## male                          0.038     0.014     0.011     0.065     2.754   633.710     0.006     0.654     0.397 
## sibling_count3                0.008     0.019    -0.030     0.045     0.403   799.311     0.687     0.543     0.354 
## sibling_count4               -0.010     0.023    -0.056     0.036    -0.432   766.289     0.666     0.561     0.361 
## sibling_count5               -0.019     0.030    -0.078     0.039    -0.655   600.886     0.513     0.683     0.408 
## sibling_count5+              -0.046     0.029    -0.102     0.010    -1.608   693.331     0.108     0.607     0.380 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.925 
## ICC|mother_pidlink                     0.056 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-13" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-3" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-14" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.181     0.036     0.111     0.251     5.077   265.577     0.000     1.568     0.613 
## birth_order_nonlinear2       -0.003     0.019    -0.040     0.035    -0.131   453.390     0.896     0.877     0.470 
## birth_order_nonlinear3        0.009     0.024    -0.038     0.056     0.387   504.714     0.699     0.795     0.445 
## birth_order_nonlinear4       -0.015     0.031    -0.075     0.046    -0.476   545.302     0.635     0.742     0.428 
## birth_order_nonlinear5        0.017     0.038    -0.058     0.092     0.444   614.873     0.658     0.670     0.403 
## birth_order_nonlinear5+      -0.001     0.039    -0.079     0.076    -0.033   478.837     0.974     0.834     0.457 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.678   372.334     0.094     1.065     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.440   540.270     0.151     0.748     0.430 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.059   585.851     0.040     0.698     0.413 
## male                          0.039     0.014     0.012     0.067     2.783   627.941     0.006     0.659     0.399 
## sibling_count3                0.005     0.020    -0.035     0.045     0.251   750.535     0.802     0.570     0.365 
## sibling_count4               -0.009     0.025    -0.059     0.040    -0.372   698.039     0.710     0.604     0.378 
## sibling_count5               -0.023     0.032    -0.085     0.039    -0.723   584.828     0.470     0.699     0.413 
## sibling_count5+              -0.051     0.030    -0.110     0.007    -1.719   732.494     0.086     0.581     0.369 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.054 
## Residual~~Residual                     0.924 
## ICC|mother_pidlink                     0.056 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-14" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-3" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-15" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.038     0.106     0.254     4.767   299.320     0.000     1.354     0.578 
## count_birth_order2/2          0.004     0.026    -0.048     0.056     0.157   564.847     0.875     0.720     0.421 
## count_birth_order1/3          0.025     0.032    -0.037     0.088     0.799   677.497     0.425     0.619     0.384 
## count_birth_order2/3          0.003     0.029    -0.054     0.061     0.117   742.773     0.907     0.575     0.367 
## count_birth_order3/3          0.007     0.032    -0.055     0.070     0.226   633.137     0.821     0.654     0.397 
## count_birth_order1/4         -0.006     0.045    -0.094     0.082    -0.142   545.190     0.887     0.743     0.428 
## count_birth_order2/4          0.000     0.042    -0.082     0.082     0.008   466.600     0.994     0.854     0.463 
## count_birth_order3/4          0.004     0.041    -0.076     0.084     0.102   550.581     0.919     0.736     0.426 
## count_birth_order4/4         -0.025     0.043    -0.109     0.060    -0.572   498.484     0.567     0.804     0.448 
## count_birth_order1/5         -0.035     0.058    -0.149     0.078    -0.613   829.562     0.540     0.528     0.347 
## count_birth_order2/5         -0.030     0.057    -0.141     0.081    -0.532   520.866     0.595     0.773     0.438 
## count_birth_order3/5          0.000     0.051    -0.100     0.101     0.005   749.091     0.996     0.571     0.365 
## count_birth_order4/5         -0.026     0.057    -0.138     0.085    -0.459   419.814     0.646     0.944     0.488 
## count_birth_order5/5          0.003     0.056    -0.107     0.113     0.051   565.042     0.959     0.720     0.421 
## count_birth_order1/5+        -0.050     0.054    -0.156     0.056    -0.919   762.354     0.358     0.563     0.362 
## count_birth_order2/5+        -0.057     0.049    -0.153     0.038    -1.185   740.141     0.236     0.577     0.367 
## count_birth_order3/5+        -0.018     0.047    -0.110     0.074    -0.387   694.075     0.699     0.607     0.379 
## count_birth_order4/5+        -0.064     0.048    -0.157     0.030    -1.329   583.360     0.184     0.701     0.414 
## count_birth_order5/5+        -0.030     0.046    -0.121     0.061    -0.641   620.000     0.522     0.666     0.402 
## count_birth_order5+/5+       -0.048     0.036    -0.118     0.021    -1.358   489.722     0.175     0.817     0.452 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.736   373.332     0.083     1.062     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.307   532.293     0.192     0.758     0.433 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.941   578.759     0.053     0.705     0.416 
## male                          0.039     0.014     0.011     0.067     2.698   565.657     0.007     0.719     0.420 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.923 
## ICC|mother_pidlink                     0.056 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-15" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-3" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.521       10 1005.351    0.876  128.697 
##   2 vs 3:    0.539        4  398.120    0.707  368.476 
##   3 vs 4:    0.027        1  420.892    0.869    0.895</code></pre>
</div>
</div>
</div>
<div id="conscientiousness" class="section level3 tabset">
<h3>Conscientiousness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-4" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-4" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-16" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.182     0.033     0.117     0.246     5.538   236.684     0.000     1.831     0.650 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.721   351.705     0.086     1.130     0.533 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.460   512.367     0.145     0.784     0.442 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.104   562.772     0.036     0.722     0.421 
## male                          0.038     0.014     0.011     0.065     2.754   634.068     0.006     0.653     0.397 
## sibling_count3                0.007     0.019    -0.031     0.045     0.373   717.627     0.709     0.591     0.373 
## sibling_count4               -0.011     0.023    -0.057     0.034    -0.482   627.420     0.630     0.659     0.399 
## sibling_count5               -0.021     0.028    -0.077     0.034    -0.747   579.302     0.456     0.705     0.415 
## sibling_count5+              -0.049     0.024    -0.095    -0.003    -2.091   604.356     0.037     0.680     0.407 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.925 
## ICC|mother_pidlink                     0.056 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-16" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-4" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-17" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.183     0.035     0.116     0.251     5.301   248.743     0.000     1.709     0.634 
## birth_order                  -0.001     0.005    -0.012     0.010    -0.165   443.892     0.869     0.895     0.475 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.726   353.016     0.085     1.126     0.532 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.463   507.839     0.144     0.791     0.444 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.107   558.573     0.036     0.727     0.423 
## male                          0.038     0.014     0.011     0.065     2.754   633.710     0.006     0.654     0.397 
## sibling_count3                0.008     0.019    -0.030     0.045     0.403   799.311     0.687     0.543     0.354 
## sibling_count4               -0.010     0.023    -0.056     0.036    -0.432   766.289     0.666     0.561     0.361 
## sibling_count5               -0.019     0.030    -0.078     0.039    -0.655   600.886     0.513     0.683     0.408 
## sibling_count5+              -0.046     0.029    -0.102     0.010    -1.608   693.331     0.108     0.607     0.380 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.925 
## ICC|mother_pidlink                     0.056 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-17" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-4" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-18" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.181     0.036     0.111     0.251     5.077   265.577     0.000     1.568     0.613 
## birth_order_nonlinear2       -0.003     0.019    -0.040     0.035    -0.131   453.390     0.896     0.877     0.470 
## birth_order_nonlinear3        0.009     0.024    -0.038     0.056     0.387   504.714     0.699     0.795     0.445 
## birth_order_nonlinear4       -0.015     0.031    -0.075     0.046    -0.476   545.302     0.635     0.742     0.428 
## birth_order_nonlinear5        0.017     0.038    -0.058     0.092     0.444   614.873     0.658     0.670     0.403 
## birth_order_nonlinear5+      -0.001     0.039    -0.079     0.076    -0.033   478.837     0.974     0.834     0.457 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.001    -1.678   372.334     0.094     1.065     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.440   540.270     0.151     0.748     0.430 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.059   585.851     0.040     0.698     0.413 
## male                          0.039     0.014     0.012     0.067     2.783   627.941     0.006     0.659     0.399 
## sibling_count3                0.005     0.020    -0.035     0.045     0.251   750.535     0.802     0.570     0.365 
## sibling_count4               -0.009     0.025    -0.059     0.040    -0.372   698.039     0.710     0.604     0.378 
## sibling_count5               -0.023     0.032    -0.085     0.039    -0.723   584.828     0.470     0.699     0.413 
## sibling_count5+              -0.051     0.030    -0.110     0.007    -1.719   732.494     0.086     0.581     0.369 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.054 
## Residual~~Residual                     0.924 
## ICC|mother_pidlink                     0.056 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-18" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-4" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-19" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.038     0.106     0.254     4.767   299.320     0.000     1.354     0.578 
## count_birth_order2/2          0.004     0.026    -0.048     0.056     0.157   564.847     0.875     0.720     0.421 
## count_birth_order1/3          0.025     0.032    -0.037     0.088     0.799   677.497     0.425     0.619     0.384 
## count_birth_order2/3          0.003     0.029    -0.054     0.061     0.117   742.773     0.907     0.575     0.367 
## count_birth_order3/3          0.007     0.032    -0.055     0.070     0.226   633.137     0.821     0.654     0.397 
## count_birth_order1/4         -0.006     0.045    -0.094     0.082    -0.142   545.190     0.887     0.743     0.428 
## count_birth_order2/4          0.000     0.042    -0.082     0.082     0.008   466.600     0.994     0.854     0.463 
## count_birth_order3/4          0.004     0.041    -0.076     0.084     0.102   550.581     0.919     0.736     0.426 
## count_birth_order4/4         -0.025     0.043    -0.109     0.060    -0.572   498.484     0.567     0.804     0.448 
## count_birth_order1/5         -0.035     0.058    -0.149     0.078    -0.613   829.562     0.540     0.528     0.347 
## count_birth_order2/5         -0.030     0.057    -0.141     0.081    -0.532   520.866     0.595     0.773     0.438 
## count_birth_order3/5          0.000     0.051    -0.100     0.101     0.005   749.091     0.996     0.571     0.365 
## count_birth_order4/5         -0.026     0.057    -0.138     0.085    -0.459   419.814     0.646     0.944     0.488 
## count_birth_order5/5          0.003     0.056    -0.107     0.113     0.051   565.042     0.959     0.720     0.421 
## count_birth_order1/5+        -0.050     0.054    -0.156     0.056    -0.919   762.354     0.358     0.563     0.362 
## count_birth_order2/5+        -0.057     0.049    -0.153     0.038    -1.185   740.141     0.236     0.577     0.367 
## count_birth_order3/5+        -0.018     0.047    -0.110     0.074    -0.387   694.075     0.699     0.607     0.379 
## count_birth_order4/5+        -0.064     0.048    -0.157     0.030    -1.329   583.360     0.184     0.701     0.414 
## count_birth_order5/5+        -0.030     0.046    -0.121     0.061    -0.641   620.000     0.522     0.666     0.402 
## count_birth_order5+/5+       -0.048     0.036    -0.118     0.021    -1.358   489.722     0.175     0.817     0.452 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.736   373.332     0.083     1.062     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.307   532.293     0.192     0.758     0.433 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.941   578.759     0.053     0.705     0.416 
## male                          0.039     0.014     0.011     0.067     2.698   565.657     0.007     0.719     0.420 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.923 
## ICC|mother_pidlink                     0.056 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-19" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-4" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.521       10 1005.351    0.876  128.697 
##   2 vs 3:    0.539        4  398.120    0.707  368.476 
##   3 vs 4:    0.027        1  420.892    0.869    0.895</code></pre>
</div>
</div>
</div>
<div id="agreeableness" class="section level3 tabset">
<h3>Agreeableness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_agree)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-5" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-5" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-20" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.148     0.034    -0.214    -0.083    -4.413   228.979     0.000     1.920     0.660 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.005     0.010     0.616   370.419     0.538     1.070     0.520 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.173   615.022     0.030     0.670     0.403 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.883   717.759     0.004     0.591     0.373 
## male                          0.017     0.013    -0.009     0.043     1.249   834.041     0.212     0.526     0.346 
## sibling_count3               -0.001     0.022    -0.044     0.042    -0.062   393.254     0.951     1.007     0.504 
## sibling_count4               -0.001     0.025    -0.050     0.047    -0.050   518.373     0.960     0.776     0.439 
## sibling_count5                0.028     0.029    -0.028     0.085     0.981   578.617     0.327     0.705     0.416 
## sibling_count5+               0.005     0.024    -0.042     0.053     0.225   609.673     0.822     0.675     0.405 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.080 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.081 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-20" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-5" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-21" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.156     0.035    -0.224    -0.087    -4.436   247.193     0.000     1.724     0.636 
## birth_order                   0.004     0.005    -0.007     0.014     0.657   493.389     0.512     0.811     0.450 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.005     0.010     0.628   371.673     0.530     1.067     0.519 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.196   606.271     0.028     0.678     0.406 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.909   704.791     0.004     0.599     0.377 
## male                          0.017     0.013    -0.009     0.043     1.248   834.429     0.212     0.525     0.346 
## sibling_count3               -0.004     0.022    -0.047     0.040    -0.159   400.111     0.873     0.990     0.500 
## sibling_count4               -0.006     0.025    -0.055     0.044    -0.222   534.177     0.825     0.756     0.433 
## sibling_count5                0.022     0.030    -0.038     0.081     0.712   585.632     0.477     0.698     0.413 
## sibling_count5+              -0.007     0.030    -0.066     0.053    -0.215   559.090     0.830     0.727     0.423 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.080 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.081 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-21" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-5" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-22" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.147     0.037    -0.219    -0.076    -4.028   256.366     0.000     1.641     0.624 
## birth_order_nonlinear2       -0.001     0.020    -0.040     0.038    -0.046   378.609     0.963     1.046     0.514 
## birth_order_nonlinear3       -0.006     0.027    -0.058     0.046    -0.220   324.913     0.826     1.232     0.555 
## birth_order_nonlinear4        0.018     0.031    -0.044     0.079     0.569   475.287     0.570     0.840     0.459 
## birth_order_nonlinear5        0.011     0.041    -0.069     0.092     0.276   431.500     0.783     0.919     0.481 
## birth_order_nonlinear5+       0.021     0.038    -0.055     0.096     0.542   541.485     0.588     0.747     0.430 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.009     0.505   411.713     0.614     0.962     0.493 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.330   707.895     0.020     0.597     0.376 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.039   825.316     0.002     0.530     0.348 
## male                          0.016     0.014    -0.011     0.043     1.183   789.932     0.237     0.548     0.356 
## sibling_count3               -0.000     0.023    -0.046     0.045    -0.009   412.339     0.992     0.961     0.492 
## sibling_count4               -0.005     0.027    -0.058     0.047    -0.190   555.741     0.850     0.730     0.424 
## sibling_count5                0.024     0.032    -0.039     0.088     0.747   587.585     0.455     0.696     0.412 
## sibling_count5+              -0.006     0.032    -0.070     0.057    -0.197   503.538     0.844     0.797     0.446 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.081 
## Residual~~Residual                     0.906 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-22" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-5" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-23" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.145     0.040    -0.223    -0.067    -3.632   264.976     0.000     1.572     0.614 
## count_birth_order2/2         -0.006     0.030    -0.064     0.052    -0.187   341.147     0.852     1.168     0.541 
## count_birth_order1/3         -0.003     0.035    -0.072     0.066    -0.083   416.956     0.934     0.950     0.490 
## count_birth_order2/3          0.000     0.031    -0.061     0.061     0.001   533.523     0.999     0.757     0.433 
## count_birth_order3/3         -0.012     0.035    -0.081     0.058    -0.332   388.509     0.740     1.019     0.507 
## count_birth_order1/4         -0.014     0.043    -0.099     0.071    -0.323   688.723     0.747     0.611     0.381 
## count_birth_order2/4         -0.016     0.040    -0.094     0.063    -0.392   614.006     0.696     0.671     0.403 
## count_birth_order3/4         -0.008     0.044    -0.094     0.079    -0.172   388.577     0.863     1.019     0.507 
## count_birth_order4/4          0.018     0.045    -0.070     0.105     0.393   428.974     0.695     0.925     0.483 
## count_birth_order1/5          0.030     0.059    -0.086     0.146     0.500   716.521     0.617     0.592     0.373 
## count_birth_order2/5          0.019     0.058    -0.094     0.132     0.331   478.308     0.741     0.835     0.457 
## count_birth_order3/5          0.009     0.053    -0.095     0.114     0.174   593.716     0.862     0.690     0.410 
## count_birth_order4/5          0.022     0.058    -0.093     0.136     0.372   382.067     0.710     1.037     0.512 
## count_birth_order5/5          0.054     0.056    -0.056     0.164     0.963   576.258     0.336     0.708     0.417 
## count_birth_order1/5+        -0.019     0.054    -0.124     0.086    -0.351   863.843     0.725     0.512     0.340 
## count_birth_order2/5+         0.007     0.052    -0.095     0.108     0.126   517.395     0.900     0.778     0.440 
## count_birth_order3/5+        -0.009     0.051    -0.109     0.090    -0.187   462.516     0.852     0.861     0.465 
## count_birth_order4/5+         0.015     0.048    -0.079     0.109     0.310   591.762     0.756     0.692     0.411 
## count_birth_order5/5+        -0.012     0.049    -0.108     0.083    -0.247   489.980     0.805     0.817     0.452 
## count_birth_order5+/5+        0.011     0.034    -0.056     0.078     0.326   680.311     0.744     0.617     0.383 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.473   411.677     0.636     0.962     0.493 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.281   707.657     0.023     0.598     0.376 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.981   836.667     0.003     0.524     0.346 
## male                          0.016     0.014    -0.010     0.043     1.201   805.397     0.230     0.540     0.352 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.082 
## Residual~~Residual                     0.906 
## ICC|mother_pidlink                     0.083 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-23" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-5" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.509       10 1005.346    0.885  128.737 
##   2 vs 3:    0.552        4  398.119    0.698  368.570 
##   3 vs 4:    0.431        1  466.692    0.512    0.812</code></pre>
</div>
</div>
</div>
<div id="openness" class="section level3 tabset">
<h3>Openness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_open)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-6" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-6" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-24" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.088     0.028     0.033     0.144     3.133   379.032     0.002     1.045     0.514 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.001    -2.150   516.966     0.032     0.778     0.440 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.779   621.545     0.076     0.664     0.401 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.323   593.516     0.021     0.690     0.410 
## male                          0.045     0.014     0.017     0.072     3.199   629.210     0.001     0.657     0.399 
## sibling_count3               -0.015     0.022    -0.058     0.029    -0.653   374.548     0.514     1.058     0.517 
## sibling_count4               -0.015     0.024    -0.061     0.032    -0.626   644.196     0.532     0.645     0.394 
## sibling_count5               -0.046     0.028    -0.101     0.009    -1.629   692.914     0.104     0.608     0.380 
## sibling_count5+              -0.074     0.027    -0.126    -0.021    -2.757   378.947     0.006     1.046     0.514 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.077 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.078 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-24" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-6" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-25" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.101     0.031     0.041     0.161     3.279   366.883     0.001     1.081     0.522 
## birth_order                  -0.006     0.005    -0.017     0.004    -1.136   480.073     0.256     0.832     0.456 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.001    -2.171   515.269     0.030     0.780     0.440 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.730   630.371     0.084     0.656     0.398 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.264   606.314     0.024     0.678     0.406 
## male                          0.045     0.014     0.017     0.072     3.201   630.269     0.001     0.657     0.398 
## sibling_count3               -0.011     0.022    -0.055     0.033    -0.482   388.109     0.630     1.020     0.508 
## sibling_count4               -0.007     0.025    -0.055     0.041    -0.290   629.533     0.772     0.657     0.398 
## sibling_count5               -0.034     0.029    -0.091     0.023    -1.175   799.219     0.240     0.543     0.354 
## sibling_count5+              -0.053     0.032    -0.115     0.009    -1.671   459.232     0.095     0.867     0.467 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.077 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.078 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-25" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-6" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-26" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.101     0.031     0.040     0.161     3.266   453.639     0.001     0.877     0.469 
## birth_order_nonlinear2       -0.012     0.019    -0.049     0.025    -0.611   497.077     0.541     0.806     0.448 
## birth_order_nonlinear3       -0.023     0.023    -0.069     0.022    -1.008   597.417     0.314     0.687     0.409 
## birth_order_nonlinear4       -0.016     0.031    -0.075     0.044    -0.509   560.307     0.611     0.725     0.422 
## birth_order_nonlinear5       -0.022     0.038    -0.096     0.053    -0.568   667.199     0.570     0.627     0.387 
## birth_order_nonlinear5+      -0.063     0.039    -0.140     0.014    -1.595   483.912     0.111     0.826     0.455 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.001    -2.149   523.991     0.032     0.769     0.437 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.715   600.106     0.087     0.684     0.408 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.224   568.807     0.027     0.716     0.419 
## male                          0.043     0.014     0.015     0.071     3.010   608.895     0.003     0.676     0.405 
## sibling_count3               -0.010     0.023    -0.056     0.036    -0.416   388.535     0.677     1.019     0.507 
## sibling_count4               -0.006     0.027    -0.059     0.046    -0.238   541.919     0.812     0.746     0.430 
## sibling_count5               -0.033     0.030    -0.093     0.026    -1.107   933.176     0.269     0.483     0.327 
## sibling_count5+              -0.049     0.033    -0.114     0.016    -1.471   454.784     0.142     0.875     0.469 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.077 
## Residual~~Residual                     0.916 
## ICC|mother_pidlink                     0.077 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-26" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-6" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-27" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.100     0.035     0.031     0.168     2.844   405.652     0.005     0.976     0.496 
## count_birth_order2/2         -0.016     0.027    -0.070     0.037    -0.605   490.813     0.545     0.815     0.451 
## count_birth_order1/3         -0.022     0.034    -0.088     0.044    -0.649   499.716     0.516     0.802     0.447 
## count_birth_order2/3         -0.030     0.032    -0.093     0.033    -0.922   461.253     0.357     0.863     0.466 
## count_birth_order3/3         -0.024     0.034    -0.090     0.042    -0.716   488.144     0.475     0.819     0.453 
## count_birth_order1/4         -0.013     0.045    -0.101     0.075    -0.288   553.623     0.774     0.733     0.425 
## count_birth_order2/4         -0.022     0.042    -0.104     0.060    -0.530   494.879     0.596     0.809     0.449 
## count_birth_order3/4         -0.047     0.040    -0.125     0.031    -1.187   674.620     0.236     0.621     0.385 
## count_birth_order4/4         -0.012     0.044    -0.099     0.075    -0.269   454.248     0.788     0.876     0.469 
## count_birth_order1/5         -0.071     0.063    -0.194     0.053    -1.120   504.502     0.263     0.795     0.445 
## count_birth_order2/5         -0.032     0.054    -0.138     0.074    -0.594   703.329     0.552     0.600     0.377 
## count_birth_order3/5         -0.069     0.054    -0.175     0.037    -1.268   559.029     0.205     0.727     0.423 
## count_birth_order4/5         -0.053     0.054    -0.158     0.052    -0.986   571.657     0.325     0.713     0.418 
## count_birth_order5/5         -0.043     0.058    -0.156     0.070    -0.744   497.541     0.457     0.805     0.448 
## count_birth_order1/5+        -0.028     0.056    -0.138     0.082    -0.502   635.709     0.616     0.652     0.397 
## count_birth_order2/5+        -0.053     0.053    -0.157     0.050    -1.013   480.323     0.312     0.831     0.456 
## count_birth_order3/5+        -0.082     0.049    -0.178     0.014    -1.667   555.910     0.096     0.730     0.424 
## count_birth_order4/5+        -0.087     0.048    -0.182     0.007    -1.812   577.891     0.071     0.706     0.416 
## count_birth_order5/5+        -0.087     0.046    -0.178     0.004    -1.863   648.789     0.063     0.641     0.393 
## count_birth_order5+/5+       -0.116     0.036    -0.186    -0.047    -3.269   541.302     0.001     0.747     0.430 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.000    -1.920   470.401     0.055     0.848     0.461 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.604   554.767     0.109     0.731     0.425 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.157   540.132     0.031     0.749     0.430 
## male                          0.043     0.014     0.015     0.071     3.001   617.475     0.003     0.668     0.402 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.077 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.078 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-27" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-6" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.524       10 1005.343    0.874  128.767 
##   2 vs 3:    0.553        4  398.120    0.697  368.421 
##   3 vs 4:    1.288        1  453.897    0.257    0.833</code></pre>
</div>
</div>
</div>
</div>
<div id="riskpreference" class="section level2 tabset">
<h2>Riskpreference</h2>
<div id="risk-a" class="section level3 tabset">
<h3>Risk A</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskA)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-7" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-7" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-28" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.171     0.032     0.107     0.234     5.281   248.926     0.000     1.707     0.634 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.958   328.523     0.339     1.217     0.552 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.412   467.641     0.680     0.852     0.462 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.191   556.174     0.234     0.730     0.424 
## male                         -0.204     0.016    -0.236    -0.173   -12.649   325.666     0.000     1.229     0.554 
## sibling_count3               -0.004     0.023    -0.048     0.041    -0.157   344.730     0.875     1.155     0.539 
## sibling_count4                0.000     0.025    -0.050     0.050     0.003   435.224     0.998     0.912     0.479 
## sibling_count5                0.009     0.029    -0.048     0.066     0.310   534.674     0.757     0.755     0.432 
## sibling_count5+               0.040     0.026    -0.011     0.092     1.528   381.968     0.127     1.037     0.512 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.069 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.070 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-28" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-7" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-29" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.035     0.112     0.248     5.187   252.674     0.000     1.673     0.629 
## birth_order                  -0.005     0.006    -0.015     0.006    -0.821   434.350     0.412     0.914     0.480 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.972   328.044     0.332     1.219     0.552 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.447   465.879     0.655     0.855     0.463 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.233   551.179     0.218     0.736     0.426 
## male                         -0.204     0.016    -0.236    -0.173   -12.646   325.400     0.000     1.230     0.554 
## sibling_count3               -0.001     0.023    -0.046     0.044    -0.034   342.345     0.973     1.163     0.540 
## sibling_count4                0.006     0.026    -0.046     0.058     0.216   424.863     0.829     0.933     0.485 
## sibling_count5                0.018     0.031    -0.043     0.078     0.565   511.539     0.572     0.785     0.442 
## sibling_count5+               0.056     0.032    -0.007     0.119     1.729   406.778     0.084     0.974     0.496 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.069 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.070 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-29" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-7" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-30" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.173     0.035     0.104     0.243     4.917   278.603     0.000     1.476     0.599 
## birth_order_nonlinear2       -0.002     0.019    -0.039     0.035    -0.115   513.879     0.909     0.782     0.441 
## birth_order_nonlinear3       -0.004     0.026    -0.054     0.046    -0.155   381.971     0.877     1.037     0.512 
## birth_order_nonlinear4       -0.019     0.031    -0.080     0.042    -0.624   504.375     0.533     0.795     0.445 
## birth_order_nonlinear5       -0.020     0.039    -0.096     0.057    -0.503   553.858     0.615     0.732     0.425 
## birth_order_nonlinear5+      -0.017     0.040    -0.094     0.061    -0.415   463.895     0.678     0.859     0.464 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.928   349.204     0.354     1.139     0.535 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.505   501.748     0.614     0.799     0.446 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.290   590.085     0.198     0.694     0.412 
## male                         -0.205     0.016    -0.237    -0.173   -12.459   318.744     0.000     1.259     0.560 
## sibling_count3               -0.002     0.024    -0.049     0.044    -0.103   353.470     0.918     1.124     0.532 
## sibling_count4                0.007     0.028    -0.047     0.061     0.263   463.432     0.793     0.859     0.465 
## sibling_count5                0.019     0.033    -0.047     0.084     0.566   478.697     0.571     0.834     0.457 
## sibling_count5+               0.054     0.034    -0.012     0.120     1.616   412.205     0.107     0.961     0.493 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.069 
## Residual~~Residual                     0.918 
## ICC|mother_pidlink                     0.070 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-30" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-7" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-31" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.181     0.039     0.104     0.258     4.612   273.473     0.000     1.511     0.605 
## count_birth_order2/2         -0.012     0.027    -0.066     0.041    -0.455   474.205     0.650     0.841     0.459 
## count_birth_order1/3         -0.020     0.033    -0.085     0.045    -0.610   536.467     0.542     0.753     0.432 
## count_birth_order2/3         -0.004     0.032    -0.066     0.058    -0.130   479.463     0.897     0.833     0.457 
## count_birth_order3/3         -0.005     0.035    -0.074     0.064    -0.142   393.472     0.887     1.006     0.504 
## count_birth_order1/4          0.019     0.044    -0.068     0.106     0.427   590.669     0.670     0.693     0.411 
## count_birth_order2/4          0.009     0.043    -0.075     0.092     0.202   440.981     0.840     0.900     0.476 
## count_birth_order3/4         -0.013     0.043    -0.097     0.072    -0.291   435.653     0.771     0.911     0.479 
## count_birth_order4/4         -0.024     0.044    -0.111     0.062    -0.551   448.695     0.582     0.886     0.472 
## count_birth_order1/5          0.024     0.061    -0.096     0.143     0.392   600.713     0.695     0.683     0.408 
## count_birth_order2/5          0.001     0.057    -0.111     0.113     0.024   506.898     0.981     0.792     0.444 
## count_birth_order3/5          0.008     0.056    -0.103     0.118     0.137   448.798     0.891     0.886     0.472 
## count_birth_order4/5          0.021     0.053    -0.082     0.124     0.399   631.505     0.690     0.655     0.398 
## count_birth_order5/5         -0.025     0.056    -0.134     0.084    -0.446   600.629     0.656     0.683     0.408 
## count_birth_order1/5+         0.045     0.059    -0.070     0.160     0.763   490.770     0.446     0.815     0.451 
## count_birth_order2/5+         0.067     0.051    -0.032     0.166     1.331   586.505     0.184     0.697     0.413 
## count_birth_order3/5+         0.046     0.052    -0.056     0.147     0.879   415.989     0.380     0.953     0.490 
## count_birth_order4/5+         0.013     0.050    -0.084     0.111     0.269   490.350     0.788     0.816     0.452 
## count_birth_order5/5+         0.043     0.047    -0.049     0.135     0.921   594.679     0.358     0.689     0.410 
## count_birth_order5+/5+        0.033     0.037    -0.040     0.107     0.894   414.119     0.372     0.957     0.491 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.004    -0.988   338.285     0.324     1.179     0.544 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.412   465.350     0.680     0.856     0.464 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.194   536.547     0.233     0.753     0.432 
## male                         -0.206     0.017    -0.239    -0.173   -12.278   310.883     0.000     1.295     0.567 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.068 
## Residual~~Residual                     0.918 
## ICC|mother_pidlink                     0.069 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-31" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-7" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.514       10 1005.353    0.881  128.684 
##   2 vs 3:    0.539        4  398.120    0.707  368.515 
##   3 vs 4:    0.667        1  408.145    0.415    0.922</code></pre>
</div>
</div>
</div>
<div id="risk-b" class="section level3 tabset">
<h3>Risk B</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskB)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-8" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-8" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-32" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.091     0.031     0.030     0.151     2.919   276.396     0.004     1.491     0.601 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.006    -0.436   384.480     0.663     1.030     0.510 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.221   535.797     0.825     0.754     0.432 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.330   597.582     0.741     0.686     0.409 
## male                         -0.105     0.014    -0.131    -0.078    -7.667   743.884     0.000     0.574     0.367 
## sibling_count3               -0.007     0.021    -0.049     0.035    -0.339   426.842     0.735     0.929     0.484 
## sibling_count4               -0.007     0.025    -0.055     0.041    -0.273   496.350     0.785     0.807     0.449 
## sibling_count5               -0.023     0.028    -0.078     0.031    -0.847   694.411     0.397     0.607     0.379 
## sibling_count5+              -0.027     0.026    -0.079     0.024    -1.041   363.635     0.299     1.091     0.524 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.941 
## ICC|mother_pidlink                     0.055 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-32" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-8" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-33" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.095     0.033     0.031     0.159     2.908   292.837     0.004     1.389     0.584 
## birth_order                  -0.002     0.006    -0.014     0.009    -0.397   319.265     0.691     1.257     0.560 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.006    -0.445   386.003     0.657     1.026     0.509 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.203   529.121     0.839     0.762     0.435 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.306   592.011     0.759     0.692     0.411 
## male                         -0.105     0.014    -0.131    -0.078    -7.665   742.892     0.000     0.575     0.367 
## sibling_count3               -0.006     0.022    -0.049     0.037    -0.264   407.147     0.792     0.973     0.496 
## sibling_count4               -0.004     0.025    -0.053     0.045    -0.149   547.077     0.881     0.740     0.427 
## sibling_count5               -0.019     0.030    -0.077     0.039    -0.638   626.238     0.524     0.660     0.400 
## sibling_count5+              -0.019     0.032    -0.083     0.044    -0.600   393.057     0.549     1.008     0.504 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.941 
## ICC|mother_pidlink                     0.055 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-33" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-8" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-34" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.087     0.034     0.020     0.154     2.547   304.651     0.011     1.326     0.573 
## birth_order_nonlinear2        0.004     0.020    -0.035     0.043     0.222   402.919     0.825     0.983     0.498 
## birth_order_nonlinear3        0.004     0.026    -0.047     0.055     0.152   361.453     0.880     1.098     0.526 
## birth_order_nonlinear4        0.002     0.033    -0.063     0.066     0.051   403.633     0.959     0.981     0.498 
## birth_order_nonlinear5        0.008     0.041    -0.071     0.088     0.208   465.530     0.835     0.856     0.463 
## birth_order_nonlinear5+      -0.013     0.042    -0.096     0.069    -0.311   375.881     0.756     1.054     0.516 
## poly(age, 3, raw = TRUE)1    -0.001     0.004    -0.009     0.006    -0.324   403.696     0.746     0.981     0.498 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.093   548.354     0.926     0.739     0.427 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.194   600.573     0.846     0.684     0.408 
## male                         -0.106     0.014    -0.133    -0.079    -7.629   708.019     0.000     0.597     0.376 
## sibling_count3               -0.008     0.022    -0.052     0.036    -0.360   452.436     0.719     0.879     0.470 
## sibling_count4               -0.007     0.027    -0.059     0.046    -0.259   533.277     0.796     0.757     0.433 
## sibling_count5               -0.025     0.032    -0.087     0.037    -0.787   616.269     0.432     0.669     0.403 
## sibling_count5+              -0.024     0.034    -0.090     0.043    -0.698   401.391     0.486     0.987     0.499 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.054 
## Residual~~Residual                     0.940 
## ICC|mother_pidlink                     0.055 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-34" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-8" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-35" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.094     0.038     0.019     0.168     2.470   302.352     0.014     1.338     0.575 
## count_birth_order2/2         -0.006     0.029    -0.064     0.051    -0.217   368.815     0.828     1.075     0.521 
## count_birth_order1/3         -0.031     0.034    -0.097     0.036    -0.905   494.511     0.366     0.810     0.450 
## count_birth_order2/3         -0.005     0.032    -0.067     0.057    -0.166   491.760     0.868     0.814     0.451 
## count_birth_order3/3         -0.001     0.037    -0.073     0.071    -0.039   346.485     0.969     1.148     0.537 
## count_birth_order1/4         -0.009     0.045    -0.098     0.080    -0.202   541.030     0.840     0.748     0.430 
## count_birth_order2/4         -0.006     0.041    -0.087     0.075    -0.147   518.838     0.883     0.776     0.439 
## count_birth_order3/4         -0.019     0.041    -0.098     0.061    -0.465   603.128     0.642     0.681     0.407 
## count_birth_order4/4         -0.009     0.047    -0.100     0.083    -0.186   364.308     0.852     1.089     0.524 
## count_birth_order1/5         -0.003     0.062    -0.125     0.119    -0.042   546.792     0.966     0.741     0.428 
## count_birth_order2/5         -0.046     0.056    -0.156     0.063    -0.827   582.003     0.409     0.702     0.414 
## count_birth_order3/5         -0.011     0.052    -0.113     0.091    -0.213   701.620     0.831     0.602     0.377 
## count_birth_order4/5         -0.031     0.056    -0.140     0.078    -0.556   481.520     0.578     0.830     0.456 
## count_birth_order5/5         -0.038     0.057    -0.149     0.073    -0.667   553.168     0.505     0.733     0.425 
## count_birth_order1/5+        -0.049     0.058    -0.162     0.064    -0.849   549.220     0.396     0.738     0.427 
## count_birth_order2/5+        -0.006     0.051    -0.105     0.094    -0.109   576.896     0.913     0.707     0.416 
## count_birth_order3/5+        -0.041     0.050    -0.139     0.057    -0.822   510.414     0.411     0.787     0.443 
## count_birth_order4/5+        -0.033     0.051    -0.133     0.066    -0.656   453.296     0.512     0.877     0.470 
## count_birth_order5/5+        -0.013     0.048    -0.107     0.081    -0.275   536.813     0.784     0.753     0.432 
## count_birth_order5+/5+       -0.041     0.038    -0.116     0.033    -1.082   385.130     0.280     1.028     0.510 
## poly(age, 3, raw = TRUE)1    -0.001     0.004    -0.009     0.007    -0.331   397.003     0.741     0.997     0.502 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.122   536.780     0.903     0.753     0.432 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.226   591.214     0.821     0.693     0.411 
## male                         -0.107     0.014    -0.134    -0.079    -7.614   731.321     0.000     0.582     0.370 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.054 
## Residual~~Residual                     0.940 
## ICC|mother_pidlink                     0.055 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-35" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-8" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.529       10 1005.337    0.871  128.811 
##   2 vs 3:    0.536        4  398.120    0.709  368.483 
##   3 vs 4:    0.158        1  304.993    0.691    1.256</code></pre>
</div>
</div>
</div>
</div>
<div id="educational-attainment" class="section level2 tabset">
<h2>Educational Attainment</h2>
<div id="years-of-education---z-standardized" class="section level3 tabset">
<h3>Years of Education - z-standardized</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = years_of_education_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-9" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-9" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-36" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.206     0.028     0.150     0.262     7.239   350.966     0.000     1.133     0.534 
## poly(age, 3, raw = TRUE)1    -0.012     0.003    -0.019    -0.005    -3.436   416.063     0.001     0.952     0.490 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     3.587   579.672     0.000     0.704     0.415 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.443   618.980     0.000     0.666     0.402 
## male                         -0.015     0.012    -0.038     0.008    -1.284   707.704     0.199     0.597     0.376 
## sibling_count3                0.021     0.022    -0.023     0.065     0.951   477.850     0.342     0.835     0.457 
## sibling_count4                0.008     0.026    -0.044     0.059     0.291   658.959     0.771     0.633     0.389 
## sibling_count5               -0.065     0.032    -0.128    -0.002    -2.010   563.961     0.045     0.721     0.421 
## sibling_count5+              -0.179     0.029    -0.235    -0.123    -6.259   698.355     0.000     0.604     0.378 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.396 
## Residual~~Residual                     0.564 
## ICC|mother_pidlink                     0.412 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-36" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-9" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-37" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.155     0.031     0.095     0.216     5.012   350.552     0.000     1.134     0.534 
## birth_order                   0.021     0.005     0.012     0.030     4.391   472.696     0.000     0.844     0.460 
## poly(age, 3, raw = TRUE)1    -0.012     0.003    -0.019    -0.005    -3.354   416.200     0.001     0.952     0.490 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     3.969   570.998     0.000     0.713     0.418 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.873   605.421     0.000     0.679     0.406 
## male                         -0.015     0.012    -0.038     0.008    -1.287   704.619     0.199     0.600     0.377 
## sibling_count3                0.007     0.022    -0.037     0.050     0.291   512.956     0.771     0.784     0.441 
## sibling_count4               -0.023     0.026    -0.073     0.028    -0.869   849.392     0.385     0.518     0.343 
## sibling_count5               -0.111     0.033    -0.174    -0.047    -3.403   696.343     0.001     0.605     0.379 
## sibling_count5+              -0.252     0.032    -0.314    -0.190    -7.958   844.986     0.000     0.520     0.344 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.396 
## Residual~~Residual                     0.564 
## ICC|mother_pidlink                     0.413 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-37" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-9" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-38" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.202     0.034     0.135     0.268     5.955   309.116     0.000     1.304     0.569 
## birth_order_nonlinear2       -0.004     0.017    -0.037     0.030    -0.210   377.454     0.834     1.050     0.515 
## birth_order_nonlinear3        0.019     0.021    -0.022     0.060     0.899   419.779     0.369     0.944     0.488 
## birth_order_nonlinear4        0.051     0.025     0.002     0.100     2.035   628.679     0.042     0.658     0.399 
## birth_order_nonlinear5        0.075     0.032     0.012     0.138     2.317   578.407     0.021     0.706     0.416 
## birth_order_nonlinear5+       0.108     0.033     0.044     0.172     3.318   600.903     0.001     0.683     0.408 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.006    -3.667   405.566     0.000     0.977     0.497 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.330   571.577     0.000     0.713     0.418 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -7.124   620.188     0.000     0.665     0.401 
## male                         -0.017     0.012    -0.041     0.007    -1.399   677.866     0.162     0.619     0.384 
## sibling_count3                0.010     0.023    -0.035     0.055     0.420   532.032     0.674     0.759     0.433 
## sibling_count4               -0.020     0.027    -0.072     0.033    -0.734   897.129     0.463     0.497     0.334 
## sibling_count5               -0.108     0.033    -0.174    -0.042    -3.231   721.976     0.001     0.588     0.372 
## sibling_count5+              -0.249     0.031    -0.311    -0.188    -7.930  1112.520     0.000     0.425     0.300 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.394 
## Residual~~Residual                     0.562 
## ICC|mother_pidlink                     0.412 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-38" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-9" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-39" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.037     0.106     0.253     4.796   311.106     0.000     1.294     0.567 
## count_birth_order2/2          0.020     0.025    -0.029     0.069     0.810   357.106     0.419     1.112     0.529 
## count_birth_order1/3          0.033     0.031    -0.028     0.094     1.062   545.726     0.289     0.742     0.428 
## count_birth_order2/3         -0.002     0.032    -0.064     0.061    -0.053   375.877     0.958     1.054     0.516 
## count_birth_order3/3          0.050     0.034    -0.017     0.117     1.461   355.695     0.145     1.117     0.530 
## count_birth_order1/4          0.003     0.040    -0.074     0.081     0.083   750.557     0.934     0.570     0.365 
## count_birth_order2/4         -0.020     0.039    -0.096     0.055    -0.525   526.425     0.600     0.766     0.436 
## count_birth_order3/4          0.005     0.038    -0.071     0.080     0.119   556.721     0.906     0.729     0.424 
## count_birth_order4/4          0.049     0.040    -0.030     0.127     1.217   522.746     0.224     0.770     0.437 
## count_birth_order1/5         -0.090     0.053    -0.193     0.013    -1.710   819.061     0.088     0.533     0.349 
## count_birth_order2/5         -0.104     0.054    -0.210     0.002    -1.923   437.970     0.055     0.906     0.478 
## count_birth_order3/5         -0.082     0.048    -0.175     0.011    -1.721   721.579     0.086     0.588     0.372 
## count_birth_order4/5         -0.062     0.050    -0.159     0.035    -1.249   553.804     0.212     0.733     0.425 
## count_birth_order5/5         -0.011     0.054    -0.116     0.095    -0.195   436.350     0.846     0.910     0.479 
## count_birth_order1/5+        -0.250     0.052    -0.352    -0.148    -4.810   574.499     0.000     0.710     0.417 
## count_birth_order2/5+        -0.236     0.046    -0.326    -0.146    -5.154   693.225     0.000     0.607     0.380 
## count_birth_order3/5+        -0.239     0.043    -0.323    -0.154    -5.528   805.737     0.000     0.540     0.352 
## count_birth_order4/5+        -0.186     0.044    -0.272    -0.099    -4.205   655.715     0.000     0.635     0.390 
## count_birth_order5/5+        -0.170     0.043    -0.255    -0.085    -3.921   661.654     0.000     0.631     0.389 
## count_birth_order5+/5+       -0.131     0.037    -0.203    -0.059    -3.560   547.978     0.000     0.739     0.427 
## poly(age, 3, raw = TRUE)1    -0.012     0.004    -0.020    -0.004    -3.107   398.755     0.002     0.993     0.501 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     3.839   537.550     0.000     0.752     0.431 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.616   572.723     0.000     0.712     0.418 
## male                         -0.016     0.012    -0.040     0.009    -1.274   612.021     0.203     0.673     0.404 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.394 
## Residual~~Residual                     0.562 
## ICC|mother_pidlink                     0.412 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-39" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-9" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.370       10 1005.343    0.960  128.763 
##   2 vs 3:    0.452        4  398.120    0.771  368.424 
##   3 vs 4:   19.370        1  453.479    0.000    0.834</code></pre>
</div>
</div>
</div>
<div id="elementary_missed" class="section level3">
<h3>elementary_missed</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_missed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-10" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-10" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-40" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.008     0.004     0.034     2.505   167.250     0.013     3.336     0.772 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.385   351.474     0.701     1.131     0.533 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.146   418.644     0.884     0.947     0.489 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.108   413.316     0.914     0.959     0.492 
## male                          0.002     0.002    -0.003     0.007     0.812   638.637     0.417     0.649     0.396 
## sibling_count3                0.002     0.004    -0.006     0.011     0.499   323.654     0.618     1.237     0.556 
## sibling_count4                0.005     0.005    -0.006     0.015     0.879   358.122     0.380     1.109     0.528 
## sibling_count5                0.010     0.006    -0.002     0.022     1.659   355.829     0.098     1.116     0.530 
## sibling_count5+               0.025     0.006     0.014     0.037     4.278   255.956     0.000     1.645     0.625 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-40" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-10" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-41" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.008     0.004     0.035     2.432   172.506     0.016     3.125     0.760 
## birth_order                  -0.000     0.001    -0.003     0.002    -0.175   222.784     0.861     2.000     0.670 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.380   348.224     0.704     1.142     0.536 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.135   438.284     0.893     0.906     0.478 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.095   438.383     0.924     0.906     0.478 
## male                          0.002     0.002    -0.003     0.007     0.812   638.673     0.417     0.649     0.396 
## sibling_count3                0.002     0.004    -0.006     0.011     0.520   315.579     0.604     1.273     0.563 
## sibling_count4                0.005     0.005    -0.006     0.015     0.889   337.903     0.375     1.180     0.544 
## sibling_count5                0.011     0.007    -0.003     0.024     1.587   318.830     0.114     1.259     0.560 
## sibling_count5+               0.026     0.008     0.011     0.041     3.417   220.843     0.001     2.026     0.672 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-41" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-10" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-42" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.008     0.003     0.035     2.356   181.374     0.020     2.829     0.742 
## birth_order_nonlinear2        0.000     0.003    -0.007     0.007     0.017   419.525     0.986     0.945     0.488 
## birth_order_nonlinear3       -0.001     0.005    -0.010     0.008    -0.238   386.566     0.812     1.025     0.509 
## birth_order_nonlinear4       -0.002     0.006    -0.013     0.009    -0.332   452.485     0.740     0.879     0.470 
## birth_order_nonlinear5       -0.000     0.008    -0.016     0.015    -0.051   303.117     0.960     1.334     0.574 
## birth_order_nonlinear5+      -0.000     0.009    -0.018     0.017    -0.020   228.659     0.984     1.924     0.661 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.365   352.402     0.715     1.128     0.533 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.119   440.846     0.905     0.901     0.476 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.076   452.063     0.939     0.880     0.470 
## male                          0.002     0.003    -0.003     0.007     0.848   673.279     0.397     0.622     0.385 
## sibling_count3                0.002     0.005    -0.007     0.012     0.503   299.853     0.615     1.351     0.577 
## sibling_count4                0.005     0.006    -0.006     0.016     0.927   368.784     0.355     1.075     0.521 
## sibling_count5                0.011     0.007    -0.003     0.024     1.570   347.015     0.117     1.147     0.537 
## sibling_count5+               0.026     0.008     0.011     0.042     3.329   227.804     0.001     1.935     0.662 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-42" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-10" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-43" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.009     0.003     0.036     2.264   195.637     0.025     2.465     0.714 
## count_birth_order2/2         -0.000     0.005    -0.010     0.010    -0.073   392.425     0.942     1.009     0.505 
## count_birth_order1/3          0.001     0.007    -0.012     0.014     0.107   372.145     0.915     1.065     0.518 
## count_birth_order2/3          0.003     0.006    -0.010     0.015     0.409   337.966     0.683     1.180     0.544 
## count_birth_order3/3          0.002     0.006    -0.011     0.015     0.316   398.401     0.752     0.994     0.501 
## count_birth_order1/4          0.006     0.009    -0.012     0.024     0.626   350.096     0.531     1.136     0.534 
## count_birth_order2/4          0.007     0.008    -0.010     0.023     0.796   335.748     0.427     1.188     0.546 
## count_birth_order3/4          0.002     0.008    -0.014     0.018     0.268   400.817     0.789     0.988     0.499 
## count_birth_order4/4          0.003     0.008    -0.013     0.018     0.325   483.960     0.746     0.826     0.455 
## count_birth_order1/5          0.013     0.011    -0.009     0.035     1.164   588.090     0.245     0.696     0.412 
## count_birth_order2/5          0.010     0.011    -0.011     0.032     0.944   387.786     0.346     1.021     0.508 
## count_birth_order3/5          0.010     0.010    -0.010     0.031     1.017   445.244     0.309     0.892     0.474 
## count_birth_order4/5          0.010     0.011    -0.011     0.031     0.944   397.339     0.346     0.997     0.502 
## count_birth_order5/5          0.006     0.011    -0.016     0.029     0.547   346.948     0.585     1.147     0.537 
## count_birth_order1/5+         0.026     0.012     0.002     0.050     2.162   294.331     0.031     1.381     0.583 
## count_birth_order2/5+         0.023     0.010     0.003     0.043     2.200   341.508     0.028     1.166     0.541 
## count_birth_order3/5+         0.024     0.010     0.005     0.043     2.472   366.516     0.014     1.082     0.522 
## count_birth_order4/5+         0.024     0.010     0.004     0.043     2.378   334.641     0.018     1.193     0.547 
## count_birth_order5/5+         0.028     0.010     0.010     0.047     2.986   370.905     0.003     1.069     0.519 
## count_birth_order5+/5+        0.026     0.008     0.010     0.042     3.239   273.442     0.001     1.511     0.605 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.357   362.419     0.721     1.095     0.525 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.114   457.087     0.909     0.871     0.468 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.074   468.291     0.941     0.851     0.462 
## male                          0.002     0.003    -0.003     0.007     0.826   658.607     0.409     0.633     0.390 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-43" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-10" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -1.345       10 1005.325    1.000  128.913 
##   2 vs 3:   -1.293        4  398.120    1.000  368.505 
##   3 vs 4:    0.030        1  215.404    0.862    1.992</code></pre>
</div>
</div>
</div>
<div id="elementary_worked" class="section level3">
<h3>elementary_worked</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_worked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-11" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-11" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-44" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.020     0.009     0.002     0.037     2.147   184.506     0.033     2.738     0.735 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.474   410.981     0.635     0.964     0.493 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.056   543.673     0.291     0.744     0.429 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.802   618.216     0.423     0.667     0.402 
## male                          0.007     0.004     0.000     0.014     2.079   390.319     0.038     1.015     0.506 
## sibling_count3                0.002     0.006    -0.009     0.013     0.360   337.156     0.719     1.183     0.545 
## sibling_count4                0.011     0.006    -0.002     0.023     1.692   467.359     0.091     0.853     0.463 
## sibling_count5                0.022     0.008     0.006     0.039     2.670   315.295     0.008     1.275     0.563 
## sibling_count5+               0.045     0.008     0.029     0.061     5.655   248.368     0.000     1.713     0.634 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.188 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-44" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-11" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-45" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.028     0.010     0.009     0.046     2.883   194.214     0.004     2.496     0.717 
## birth_order                  -0.004     0.002    -0.007    -0.000    -2.079   181.251     0.039     2.832     0.742 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.421   411.880     0.674     0.962     0.493 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.882   565.860     0.378     0.719     0.420 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.582   657.832     0.561     0.634     0.390 
## male                          0.007     0.004     0.000     0.014     2.082   390.336     0.038     1.015     0.506 
## sibling_count3                0.004     0.006    -0.007     0.016     0.773   328.951     0.440     1.215     0.551 
## sibling_count4                0.016     0.007     0.003     0.029     2.339   421.532     0.020     0.940     0.487 
## sibling_count5                0.030     0.009     0.012     0.048     3.219   273.136     0.001     1.513     0.605 
## sibling_count5+               0.058     0.010     0.038     0.078     5.748   220.114     0.000     2.036     0.674 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.189 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-45" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-11" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-46" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.023     0.010     0.004     0.042     2.330   200.157     0.021     2.370     0.706 
## birth_order_nonlinear2       -0.003     0.004    -0.011     0.006    -0.655   463.136     0.513     0.860     0.465 
## birth_order_nonlinear3       -0.006     0.006    -0.019     0.007    -0.939   278.950     0.349     1.474     0.599 
## birth_order_nonlinear4       -0.011     0.008    -0.027     0.005    -1.382   289.878     0.168     1.406     0.587 
## birth_order_nonlinear5       -0.019     0.011    -0.041     0.002    -1.734   253.834     0.084     1.663     0.627 
## birth_order_nonlinear5+      -0.020     0.012    -0.044     0.003    -1.670   207.838     0.096     2.228     0.693 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.417   422.491     0.677     0.938     0.486 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.842   588.772     0.400     0.695     0.412 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.538   685.614     0.591     0.613     0.382 
## male                          0.008     0.004     0.001     0.015     2.103   389.251     0.036     1.017     0.507 
## sibling_count3                0.004     0.006    -0.008     0.016     0.690   310.927     0.490     1.295     0.567 
## sibling_count4                0.015     0.007     0.002     0.029     2.171   399.043     0.030     0.992     0.501 
## sibling_count5                0.030     0.010     0.011     0.049     3.130   276.255     0.002     1.491     0.602 
## sibling_count5+               0.058     0.010     0.037     0.078     5.490   217.557     0.000     2.073     0.678 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.188 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-46" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-11" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-47" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.024     0.011     0.003     0.045     2.233   208.173     0.027     2.222     0.693 
## count_birth_order2/2         -0.004     0.007    -0.018     0.010    -0.551   301.445     0.582     1.342     0.576 
## count_birth_order1/3          0.003     0.008    -0.013     0.020     0.372   382.780     0.710     1.035     0.511 
## count_birth_order2/3          0.002     0.008    -0.013     0.017     0.292   442.018     0.770     0.898     0.476 
## count_birth_order3/3         -0.003     0.009    -0.020     0.014    -0.328   339.732     0.743     1.173     0.543 
## count_birth_order1/4          0.017     0.011    -0.004     0.039     1.621   487.676     0.106     0.820     0.453 
## count_birth_order2/4          0.012     0.010    -0.007     0.032     1.221   439.804     0.223     0.903     0.477 
## count_birth_order3/4          0.008     0.010    -0.012     0.027     0.789   477.156     0.431     0.837     0.458 
## count_birth_order4/4          0.003     0.011    -0.018     0.024     0.283   409.696     0.777     0.967     0.494 
## count_birth_order1/5          0.025     0.016    -0.006     0.056     1.573   368.343     0.117     1.077     0.521 
## count_birth_order2/5          0.030     0.015     0.000     0.060     1.985   312.514     0.048     1.287     0.566 
## count_birth_order3/5          0.023     0.013    -0.003     0.048     1.725   460.874     0.085     0.864     0.466 
## count_birth_order4/5          0.019     0.013    -0.008     0.045     1.389   415.602     0.166     0.953     0.491 
## count_birth_order5/5          0.013     0.014    -0.015     0.041     0.930   381.563     0.353     1.038     0.512 
## count_birth_order1/5+         0.059     0.015     0.030     0.088     3.928   338.457     0.000     1.178     0.544 
## count_birth_order2/5+         0.052     0.014     0.025     0.080     3.705   289.767     0.000     1.407     0.587 
## count_birth_order3/5+         0.055     0.013     0.030     0.080     4.351   355.677     0.000     1.117     0.530 
## count_birth_order4/5+         0.047     0.013     0.021     0.072     3.570   318.404     0.000     1.260     0.560 
## count_birth_order5/5+         0.036     0.012     0.012     0.061     2.930   353.991     0.004     1.122     0.531 
## count_birth_order5+/5+        0.037     0.011     0.016     0.058     3.450   251.250     0.001     1.686     0.631 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.323   443.480     0.747     0.896     0.475 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.900   626.817     0.368     0.660     0.399 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.594   745.126     0.553     0.574     0.366 
## male                          0.008     0.004     0.000     0.015     2.042   366.359     0.042     1.083     0.522 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.189 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-47" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-11" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -1.036       10 1005.334    1.000  128.842 
##   2 vs 3:   -0.996        4  398.120    1.000  368.466 
##   3 vs 4:    4.327        1  176.302    0.039    2.826</code></pre>
</div>
</div>
</div>
<div id="attended_school" class="section level3">
<h3>attended_school</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = attended_school)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-12" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-12" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-48" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.483     0.018     0.448     0.518    27.022   170.603     0.000     3.198     0.765 
## poly(age, 3, raw = TRUE)1     0.021     0.002     0.018     0.024    12.411   373.266     0.000     1.062     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -7.044   607.465     0.000     0.677     0.406 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     3.368   749.515     0.001     0.571     0.365 
## male                         -0.017     0.006    -0.030    -0.005    -2.666   450.227     0.008     0.883     0.471 
## sibling_count3                0.009     0.010    -0.011     0.028     0.864   401.534     0.388     0.986     0.499 
## sibling_count4                0.022     0.011     0.001     0.043     2.035   619.524     0.042     0.666     0.402 
## sibling_count5                0.026     0.014    -0.002     0.054     1.830   396.605     0.068     0.998     0.502 
## sibling_count5+               0.036     0.011     0.014     0.059     3.232   578.271     0.001     0.706     0.416 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.026 
## Residual~~Residual                     0.165 
## ICC|mother_pidlink                     0.138 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-48" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-12" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-49" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.463     0.019     0.426     0.500    24.567   176.274     0.000     2.991     0.752 
## birth_order                   0.010     0.002     0.005     0.014     4.261   510.615     0.000     0.787     0.443 
## poly(age, 3, raw = TRUE)1     0.021     0.002     0.018     0.024    12.482   372.862     0.000     1.063     0.518 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -6.808   607.541     0.000     0.677     0.406 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     3.068   744.992     0.002     0.574     0.366 
## male                         -0.017     0.006    -0.030    -0.005    -2.669   448.982     0.008     0.885     0.472 
## sibling_count3                0.002     0.010    -0.017     0.022     0.228   398.166     0.820     0.995     0.501 
## sibling_count4                0.009     0.011    -0.013     0.032     0.823   563.500     0.411     0.722     0.421 
## sibling_count5                0.007     0.015    -0.022     0.036     0.463   419.250     0.644     0.945     0.488 
## sibling_count5+               0.003     0.014    -0.024     0.030     0.197   566.297     0.844     0.719     0.420 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.164 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-49" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-12" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-50" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.482     0.019     0.445     0.520    25.309   187.385     0.000     2.661     0.730 
## birth_order_nonlinear2       -0.001     0.009    -0.018     0.016    -0.087   363.823     0.931     1.090     0.524 
## birth_order_nonlinear3        0.005     0.010    -0.016     0.025     0.453   481.409     0.651     0.830     0.456 
## birth_order_nonlinear4        0.019     0.014    -0.009     0.046     1.312   395.913     0.190     1.000     0.503 
## birth_order_nonlinear5        0.034     0.018    -0.001     0.069     1.881   412.418     0.061     0.961     0.492 
## birth_order_nonlinear5+       0.062     0.017     0.029     0.094     3.697   546.869     0.000     0.741     0.428 
## poly(age, 3, raw = TRUE)1     0.020     0.002     0.017     0.024    11.630   362.371     0.000     1.095     0.525 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -6.111   558.382     0.000     0.727     0.423 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.560   701.532     0.011     0.602     0.377 
## male                         -0.017     0.007    -0.029    -0.004    -2.549   443.820     0.011     0.895     0.475 
## sibling_count3                0.006     0.010    -0.014     0.026     0.558   452.058     0.577     0.880     0.470 
## sibling_count4                0.013     0.012    -0.010     0.037     1.118   572.770     0.264     0.712     0.418 
## sibling_count5                0.010     0.016    -0.020     0.041     0.664   412.152     0.507     0.961     0.493 
## sibling_count5+               0.004     0.014    -0.024     0.032     0.293   601.483     0.769     0.683     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.026 
## Residual~~Residual                     0.164 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-50" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-12" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-51" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.467     0.020     0.427     0.506    23.330   204.069     0.000     2.295     0.699 
## count_birth_order2/2          0.019     0.013    -0.006     0.045     1.468   313.287     0.143     1.284     0.565 
## count_birth_order1/3          0.021     0.015    -0.008     0.050     1.424   510.371     0.155     0.787     0.443 
## count_birth_order2/3         -0.002     0.014    -0.029     0.025    -0.145   494.026     0.885     0.810     0.450 
## count_birth_order3/3          0.030     0.016    -0.001     0.062     1.900   349.524     0.058     1.138     0.535 
## count_birth_order1/4          0.033     0.019    -0.004     0.069     1.738   732.397     0.083     0.581     0.369 
## count_birth_order2/4          0.020     0.018    -0.016     0.056     1.065   474.794     0.288     0.840     0.459 
## count_birth_order3/4          0.019     0.019    -0.017     0.056     1.029   468.839     0.304     0.850     0.462 
## count_birth_order4/4          0.038     0.019    -0.001     0.076     1.926   438.257     0.055     0.906     0.478 
## count_birth_order1/5          0.031     0.028    -0.023     0.085     1.128   493.993     0.260     0.811     0.450 
## count_birth_order2/5          0.009     0.025    -0.040     0.058     0.356   504.489     0.722     0.795     0.445 
## count_birth_order3/5          0.025     0.024    -0.022     0.072     1.041   500.533     0.298     0.801     0.447 
## count_birth_order4/5          0.036     0.023    -0.008     0.081     1.595   687.015     0.111     0.612     0.381 
## count_birth_order5/5          0.045     0.026    -0.006     0.095     1.725   442.859     0.085     0.897     0.475 
## count_birth_order1/5+         0.015     0.024    -0.032     0.062     0.640   722.842     0.522     0.588     0.372 
## count_birth_order2/5+         0.008     0.022    -0.036     0.052     0.356   570.346     0.722     0.714     0.419 
## count_birth_order3/5+         0.005     0.020    -0.034     0.045     0.251   815.226     0.802     0.535     0.350 
## count_birth_order4/5+         0.035     0.020    -0.004     0.074     1.740   824.836     0.082     0.530     0.348 
## count_birth_order5/5+         0.050     0.021     0.008     0.091     2.345   518.499     0.019     0.776     0.439 
## count_birth_order5+/5+        0.073     0.016     0.041     0.104     4.537   512.688     0.000     0.784     0.442 
## poly(age, 3, raw = TRUE)1     0.021     0.002     0.018     0.025    11.857   375.974     0.000     1.054     0.516 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -6.407   556.769     0.000     0.729     0.424 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.879   701.529     0.004     0.602     0.377 
## male                         -0.016     0.007    -0.029    -0.003    -2.463   428.550     0.014     0.925     0.483 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.026 
## Residual~~Residual                     0.164 
## ICC|mother_pidlink                     0.138 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-51" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-12" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.351       10 1005.347    1.000  128.734 
##   2 vs 3:   -0.337        4  398.118    1.000  368.711 
##   3 vs 4:   18.185        1  486.611    0.000    0.781</code></pre>
</div>
</div>
</div>
</div>
<div id="work" class="section level2 tabset">
<h2>Work</h2>
<div id="income-last-month-log---z-standardized" class="section level3 tabset">
<h3>Income Last Month (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_month_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-13" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-13" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-52" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.200     0.042    -0.281    -0.118    -4.777   163.832     0.000     3.491     0.780 
## poly(age, 3, raw = TRUE)1     0.006     0.004    -0.003     0.015     1.387   242.839     0.167     1.766     0.641 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.782   335.999     0.435     1.187     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.313   341.754     0.190     1.166     0.541 
## male                          0.084     0.020     0.044     0.124     4.132   191.627     0.000     2.556     0.722 
## sibling_count3                0.012     0.023    -0.033     0.056     0.508   358.066     0.612     1.109     0.528 
## sibling_count4                0.008     0.028    -0.046     0.062     0.281   333.693     0.779     1.196     0.547 
## sibling_count5                0.003     0.032    -0.060     0.065     0.086   382.988     0.931     1.034     0.511 
## sibling_count5+               0.004     0.034    -0.063     0.071     0.119   208.228     0.906     2.221     0.692 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.098 
## Residual~~Residual                     0.887 
## ICC|mother_pidlink                     0.100 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-52" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-13" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-53" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.216     0.044    -0.301    -0.131    -4.955   170.658     0.000     3.195     0.764 
## birth_order                   0.008     0.005    -0.002     0.019     1.533   507.099     0.126     0.792     0.444 
## poly(age, 3, raw = TRUE)1     0.006     0.004    -0.002     0.015     1.409   242.355     0.160     1.771     0.642 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.846   337.108     0.398     1.183     0.545 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.392   342.993     0.165     1.161     0.540 
## male                          0.084     0.020     0.044     0.123     4.133   191.681     0.000     2.555     0.722 
## sibling_count3                0.006     0.023    -0.038     0.051     0.283   365.317     0.777     1.086     0.523 
## sibling_count4               -0.002     0.029    -0.059     0.054    -0.086   324.268     0.932     1.235     0.555 
## sibling_count5               -0.013     0.033    -0.078     0.052    -0.384   402.756     0.701     0.983     0.498 
## sibling_count5+              -0.024     0.039    -0.100     0.053    -0.609   240.434     0.543     1.791     0.645 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.098 
## Residual~~Residual                     0.887 
## ICC|mother_pidlink                     0.100 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-53" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-13" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-54" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.205     0.046    -0.294    -0.115    -4.493   173.238     0.000     3.098     0.759 
## birth_order_nonlinear2        0.004     0.019    -0.034     0.042     0.199   427.547     0.842     0.928     0.484 
## birth_order_nonlinear3        0.019     0.024    -0.028     0.067     0.796   442.501     0.426     0.898     0.475 
## birth_order_nonlinear4        0.023     0.031    -0.038     0.084     0.728   476.113     0.467     0.838     0.458 
## birth_order_nonlinear5        0.032     0.039    -0.045     0.110     0.820   498.257     0.412     0.804     0.448 
## birth_order_nonlinear5+       0.044     0.039    -0.032     0.120     1.126   500.629     0.261     0.801     0.447 
## poly(age, 3, raw = TRUE)1     0.006     0.005    -0.003     0.015     1.349   247.316     0.179     1.723     0.636 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.867   347.118     0.387     1.146     0.537 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.397   349.964     0.163     1.136     0.535 
## male                          0.083     0.020     0.043     0.123     4.066   192.781     0.000     2.529     0.720 
## sibling_count3                0.005     0.024    -0.041     0.051     0.218   393.149     0.828     1.007     0.504 
## sibling_count4               -0.004     0.031    -0.065     0.057    -0.131   316.094     0.896     1.271     0.562 
## sibling_count5               -0.014     0.035    -0.083     0.054    -0.410   414.387     0.682     0.956     0.491 
## sibling_count5+              -0.023     0.040    -0.102     0.057    -0.558   244.741     0.577     1.747     0.639 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.098 
## Residual~~Residual                     0.886 
## ICC|mother_pidlink                     0.100 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-54" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-13" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-55" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.205     0.048    -0.299    -0.110    -4.244   184.270     0.000     2.745     0.736 
## count_birth_order2/2          0.004     0.028    -0.051     0.059     0.139   394.240     0.889     1.004     0.504 
## count_birth_order1/3          0.006     0.036    -0.065     0.078     0.167   354.149     0.868     1.122     0.531 
## count_birth_order2/3          0.008     0.034    -0.059     0.076     0.236   344.084     0.813     1.157     0.539 
## count_birth_order3/3          0.024     0.036    -0.047     0.095     0.661   360.573     0.509     1.101     0.527 
## count_birth_order1/4         -0.016     0.048    -0.109     0.077    -0.337   414.725     0.736     0.955     0.491 
## count_birth_order2/4          0.006     0.043    -0.078     0.090     0.139   428.484     0.889     0.926     0.483 
## count_birth_order3/4          0.016     0.043    -0.069     0.101     0.369   417.086     0.713     0.950     0.490 
## count_birth_order4/4          0.018     0.047    -0.073     0.110     0.393   361.848     0.695     1.097     0.526 
## count_birth_order1/5          0.003     0.063    -0.121     0.127     0.050   477.688     0.960     0.836     0.458 
## count_birth_order2/5         -0.003     0.060    -0.120     0.115    -0.044   405.459     0.965     0.977     0.497 
## count_birth_order3/5         -0.008     0.059    -0.123     0.107    -0.135   378.366     0.893     1.047     0.514 
## count_birth_order4/5         -0.002     0.055    -0.110     0.106    -0.036   482.623     0.972     0.828     0.455 
## count_birth_order5/5          0.015     0.059    -0.100     0.129     0.248   455.399     0.804     0.874     0.469 
## count_birth_order1/5+        -0.031     0.062    -0.152     0.090    -0.501   392.768     0.617     1.008     0.505 
## count_birth_order2/5+        -0.042     0.059    -0.158     0.075    -0.701   299.869     0.484     1.351     0.577 
## count_birth_order3/5+         0.009     0.055    -0.098     0.116     0.164   336.433     0.870     1.186     0.545 
## count_birth_order4/5+         0.009     0.055    -0.099     0.118     0.171   316.498     0.864     1.269     0.562 
## count_birth_order5/5+         0.011     0.054    -0.094     0.117     0.212   329.887     0.833     1.211     0.551 
## count_birth_order5+/5+        0.020     0.041    -0.061     0.101     0.478   298.992     0.633     1.355     0.578 
## poly(age, 3, raw = TRUE)1     0.006     0.005    -0.003     0.015     1.301   246.667     0.195     1.729     0.636 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.843   330.922     0.400     1.207     0.550 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.364   334.108     0.174     1.195     0.547 
## male                          0.083     0.020     0.043     0.123     4.074   196.713     0.000     2.441     0.712 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.098 
## Residual~~Residual                     0.887 
## ICC|mother_pidlink                     0.100 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-55" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-13" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.493       10 1005.343    0.895  128.762 
##   2 vs 3:    0.526        4  398.119    0.717  368.589 
##   3 vs 4:    2.355        1  481.223    0.126    0.789</code></pre>
</div>
</div>
</div>
<div id="income-last-year-log---z-standardized" class="section level3 tabset">
<h3>Income last year (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_year_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-14" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-14" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-56" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.420     0.041    -0.500    -0.340   -10.333   164.538     0.000     3.458     0.778 
## poly(age, 3, raw = TRUE)1     0.017     0.004     0.009     0.025     3.976   248.321     0.000     1.713     0.634 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.923   344.589     0.356     1.155     0.539 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.684   355.876     0.093     1.116     0.530 
## male                          0.088     0.019     0.051     0.125     4.657   206.212     0.000     2.256     0.696 
## sibling_count3                0.004     0.022    -0.039     0.047     0.187   382.402     0.852     1.036     0.511 
## sibling_count4                0.003     0.027    -0.049     0.055     0.121   360.752     0.904     1.100     0.526 
## sibling_count5               -0.012     0.032    -0.074     0.051    -0.367   363.302     0.714     1.092     0.525 
## sibling_count5+              -0.018     0.032    -0.081     0.046    -0.550   221.987     0.583     2.010     0.671 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.104 
## Residual~~Residual                     0.834 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-56" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-14" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-57" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.437     0.043    -0.520    -0.353   -10.197   169.637     0.000     3.236     0.767 
## birth_order                   0.008     0.005    -0.002     0.018     1.614   614.965     0.107     0.670     0.403 
## poly(age, 3, raw = TRUE)1     0.017     0.004     0.009     0.025     3.998   248.089     0.000     1.715     0.635 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.990   344.301     0.323     1.156     0.539 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.766   355.693     0.078     1.117     0.530 
## male                          0.088     0.019     0.051     0.125     4.659   206.358     0.000     2.254     0.696 
## sibling_count3               -0.001     0.022    -0.044     0.042    -0.044   402.055     0.965     0.985     0.499 
## sibling_count4               -0.007     0.027    -0.060     0.046    -0.260   386.360     0.795     1.025     0.509 
## sibling_count5               -0.027     0.033    -0.091     0.037    -0.829   400.397     0.407     0.989     0.500 
## sibling_count5+              -0.045     0.035    -0.114     0.023    -1.296   302.150     0.196     1.339     0.575 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.104 
## Residual~~Residual                     0.834 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-57" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-14" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-58" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.424     0.044    -0.510    -0.338    -9.638   175.960     0.000     3.001     0.753 
## birth_order_nonlinear2        0.002     0.018    -0.034     0.038     0.114   456.539     0.909     0.872     0.468 
## birth_order_nonlinear3        0.018     0.024    -0.029     0.065     0.745   422.466     0.457     0.938     0.487 
## birth_order_nonlinear4        0.026     0.028    -0.029     0.081     0.920   709.295     0.358     0.596     0.375 
## birth_order_nonlinear5        0.025     0.039    -0.052     0.101     0.632   462.175     0.528     0.862     0.465 
## birth_order_nonlinear5+       0.042     0.038    -0.032     0.116     1.117   514.268     0.265     0.782     0.441 
## poly(age, 3, raw = TRUE)1     0.017     0.004     0.008     0.026     3.820   247.018     0.000     1.725     0.636 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.008   334.233     0.314     1.194     0.547 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.751   344.709     0.081     1.155     0.539 
## male                          0.088     0.019     0.050     0.125     4.552   203.990     0.000     2.297     0.700 
## sibling_count3               -0.002     0.022    -0.046     0.042    -0.093   440.467     0.926     0.901     0.476 
## sibling_count4               -0.009     0.029    -0.065     0.047    -0.317   387.183     0.752     1.023     0.508 
## sibling_count5               -0.028     0.034    -0.094     0.038    -0.823   454.708     0.411     0.875     0.469 
## sibling_count5+              -0.043     0.036    -0.113     0.027    -1.210   324.486     0.227     1.234     0.555 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.104 
## Residual~~Residual                     0.834 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-58" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-14" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-59" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.430     0.048    -0.523    -0.336    -9.013   181.353     0.000     2.829     0.742 
## count_birth_order2/2          0.009     0.027    -0.044     0.063     0.350   414.901     0.726     0.955     0.491 
## count_birth_order1/3          0.001     0.035    -0.067     0.069     0.023   388.077     0.982     1.021     0.508 
## count_birth_order2/3          0.003     0.032    -0.060     0.065     0.080   417.951     0.937     0.948     0.489 
## count_birth_order3/3          0.019     0.036    -0.052     0.090     0.523   325.871     0.602     1.228     0.554 
## count_birth_order1/4         -0.007     0.045    -0.095     0.081    -0.155   486.013     0.877     0.823     0.454 
## count_birth_order2/4         -0.009     0.041    -0.090     0.071    -0.228   465.499     0.820     0.856     0.463 
## count_birth_order3/4          0.012     0.043    -0.072     0.096     0.284   402.124     0.777     0.985     0.499 
## count_birth_order4/4          0.023     0.046    -0.067     0.114     0.505   339.734     0.614     1.173     0.543 
## count_birth_order1/5          0.003     0.063    -0.119     0.126     0.054   446.783     0.957     0.889     0.473 
## count_birth_order2/5         -0.017     0.058    -0.132     0.097    -0.295   408.735     0.768     0.969     0.495 
## count_birth_order3/5         -0.018     0.057    -0.130     0.093    -0.325   388.390     0.745     1.020     0.507 
## count_birth_order4/5         -0.014     0.052    -0.116     0.089    -0.264   568.801     0.792     0.716     0.419 
## count_birth_order5/5         -0.006     0.061    -0.126     0.113    -0.104   349.120     0.918     1.139     0.535 
## count_birth_order1/5+        -0.047     0.058    -0.162     0.068    -0.805   437.282     0.421     0.908     0.478 
## count_birth_order2/5+        -0.063     0.053    -0.168     0.041    -1.189   401.731     0.235     0.986     0.499 
## count_birth_order3/5+        -0.009     0.053    -0.113     0.094    -0.180   356.134     0.857     1.115     0.530 
## count_birth_order4/5+        -0.006     0.051    -0.106     0.094    -0.122   391.553     0.903     1.011     0.505 
## count_birth_order5/5+        -0.013     0.051    -0.113     0.087    -0.255   361.340     0.799     1.098     0.526 
## count_birth_order5+/5+        0.000     0.042    -0.083     0.083     0.004   268.449     0.996     1.546     0.610 
## poly(age, 3, raw = TRUE)1     0.017     0.005     0.008     0.026     3.696   239.461     0.000     1.801     0.646 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.915   309.864     0.361     1.300     0.568 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.651   322.646     0.100     1.242     0.557 
## male                          0.088     0.019     0.050     0.126     4.567   207.735     0.000     2.229     0.693 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.104 
## Residual~~Residual                     0.834 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-59" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-14" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.473       10 1005.337    0.908  128.814 
##   2 vs 3:    0.478        4  398.119    0.752  368.600 
##   3 vs 4:    2.590        1  570.626    0.108    0.679</code></pre>
</div>
</div>
</div>
<div id="self-employment---non-standardized" class="section level3 tabset">
<h3>Self-Employment - non standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = Self_employed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-15" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-15" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-60" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.046     0.067     0.247     3.417   139.473     0.001     5.349     0.845 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.011     0.004    -0.829   283.262     0.408     1.446     0.594 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.196   458.125     0.029     0.869     0.467 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.766   542.609     0.078     0.746     0.429 
## male                          0.060     0.017     0.026     0.094     3.447   220.515     0.001     2.031     0.673 
## sibling_count3               -0.002     0.024    -0.048     0.045    -0.074   244.696     0.941     1.748     0.639 
## sibling_count4               -0.009     0.025    -0.059     0.041    -0.345   327.647     0.730     1.221     0.552 
## sibling_count5                0.005     0.029    -0.051     0.061     0.169   418.466     0.866     0.947     0.489 
## sibling_count5+               0.006     0.026    -0.045     0.057     0.221   318.415     0.825     1.260     0.560 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.782 
## ICC|mother_pidlink                     0.078 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-60" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-15" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-61" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.048     0.065     0.253     3.312   143.018     0.001     4.952     0.834 
## birth_order                  -0.001     0.005    -0.012     0.010    -0.184   350.565     0.854     1.134     0.534 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.011     0.004    -0.831   282.811     0.406     1.449     0.595 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.191   463.699     0.029     0.859     0.464 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.760   555.043     0.079     0.731     0.424 
## male                          0.060     0.017     0.026     0.094     3.447   220.503     0.001     2.031     0.673 
## sibling_count3               -0.001     0.024    -0.047     0.045    -0.049   256.943     0.961     1.637     0.624 
## sibling_count4               -0.008     0.025    -0.058     0.042    -0.296   369.671     0.767     1.073     0.520 
## sibling_count5                0.007     0.029    -0.050     0.063     0.233   524.268     0.816     0.769     0.437 
## sibling_count5+               0.009     0.030    -0.049     0.067     0.308   423.515     0.759     0.936     0.486 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.782 
## ICC|mother_pidlink                     0.078 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-61" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-15" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-62" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.050     0.060     0.255     3.169   145.843     0.002     4.679     0.826 
## birth_order_nonlinear2        0.000     0.018    -0.036     0.036     0.020   391.317     0.984     1.012     0.506 
## birth_order_nonlinear3       -0.002     0.023    -0.048     0.044    -0.081   402.529     0.935     0.984     0.498 
## birth_order_nonlinear4       -0.002     0.030    -0.061     0.058    -0.061   400.697     0.951     0.988     0.500 
## birth_order_nonlinear5       -0.004     0.040    -0.083     0.075    -0.104   347.903     0.917     1.143     0.536 
## birth_order_nonlinear5+      -0.010     0.039    -0.086     0.066    -0.255   379.295     0.799     1.045     0.513 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.011     0.005    -0.789   281.172     0.431     1.459     0.596 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.076   431.298     0.038     0.920     0.482 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.654   499.263     0.099     0.803     0.448 
## male                          0.060     0.017     0.026     0.094     3.430   224.500     0.001     1.977     0.667 
## sibling_count3               -0.001     0.024    -0.048     0.046    -0.044   284.044     0.965     1.441     0.593 
## sibling_count4               -0.008     0.026    -0.060     0.044    -0.315   410.312     0.753     0.965     0.494 
## sibling_count5                0.006     0.030    -0.053     0.066     0.209   540.310     0.834     0.748     0.430 
## sibling_count5+               0.010     0.031    -0.050     0.070     0.332   455.824     0.740     0.873     0.468 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.067 
## Residual~~Residual                     0.783 
## ICC|mother_pidlink                     0.078 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-62" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-160-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-15" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-63" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.052     0.057     0.261     3.048   153.208     0.003     4.098     0.806 
## count_birth_order2/2         -0.000     0.026    -0.050     0.050    -0.017   457.023     0.987     0.871     0.468 
## count_birth_order1/3          0.001     0.033    -0.064     0.066     0.036   391.633     0.971     1.011     0.505 
## count_birth_order2/3          0.001     0.031    -0.061     0.062     0.021   367.220     0.983     1.080     0.522 
## count_birth_order3/3         -0.007     0.036    -0.077     0.063    -0.198   299.777     0.843     1.351     0.577 
## count_birth_order1/4         -0.010     0.044    -0.097     0.077    -0.229   411.641     0.819     0.962     0.493 
## count_birth_order2/4         -0.014     0.042    -0.097     0.070    -0.320   333.836     0.749     1.196     0.547 
## count_birth_order3/4         -0.004     0.041    -0.085     0.076    -0.101   388.299     0.920     1.020     0.507 
## count_birth_order4/4         -0.008     0.044    -0.093     0.078    -0.172   351.557     0.863     1.131     0.533 
## count_birth_order1/5          0.015     0.058    -0.099     0.128     0.254   527.685     0.800     0.764     0.435 
## count_birth_order2/5          0.020     0.050    -0.078     0.118     0.400   736.057     0.689     0.579     0.368 
## count_birth_order3/5          0.002     0.053    -0.101     0.105     0.034   435.351     0.973     0.912     0.479 
## count_birth_order4/5          0.000     0.054    -0.105     0.105     0.004   401.135     0.997     0.987     0.499 
## count_birth_order5/5         -0.009     0.056    -0.119     0.100    -0.170   410.665     0.865     0.965     0.493 
## count_birth_order1/5+         0.001     0.054    -0.104     0.105     0.010   536.775     0.992     0.753     0.432 
## count_birth_order2/5+         0.010     0.049    -0.085     0.106     0.214   473.229     0.831     0.843     0.460 
## count_birth_order3/5+         0.010     0.048    -0.084     0.103     0.201   435.765     0.841     0.911     0.479 
## count_birth_order4/5+         0.007     0.047    -0.085     0.099     0.144   452.258     0.886     0.879     0.470 
## count_birth_order5/5+         0.015     0.048    -0.079     0.109     0.314   374.310     0.754     1.059     0.517 
## count_birth_order5+/5+        0.000     0.039    -0.075     0.076     0.011   289.849     0.991     1.406     0.587 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.011     0.005    -0.791   273.760     0.430     1.509     0.604 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.013   401.027     0.045     0.988     0.499 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.609   461.009     0.108     0.864     0.466 
## male                          0.060     0.018     0.025     0.094     3.375   224.436     0.001     1.978     0.667 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.067 
## Residual~~Residual                     0.783 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-63" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-15" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.425       10 1005.347    0.935  128.729 
##   2 vs 3:    0.398        4  398.120    0.810  368.505 
##   3 vs 4:    0.034        1  335.080    0.853    1.130</code></pre>
</div>
</div>
</div>
</div>
<div id="smoking-behaviour" class="section level2 tabset">
<h2>Smoking Behaviour</h2>
<div id="ever_smoked" class="section level3 tabset">
<h3>ever_smoked</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = ever_smoked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-16" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-16" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-64" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.177     0.013    -0.204    -0.151   -13.274   175.864     0.000     3.005     0.753 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.029   295.107     0.000     1.376     0.582 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.523   415.848     0.129     0.953     0.490 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.847   478.634     0.005     0.834     0.457 
## male                          0.662     0.005     0.651     0.672   120.944   309.151     0.000     1.304     0.569 
## sibling_count3                0.002     0.007    -0.013     0.016     0.218   486.251     0.828     0.822     0.453 
## sibling_count4                0.009     0.009    -0.008     0.027     1.087   466.186     0.277     0.855     0.463 
## sibling_count5                0.026     0.010     0.006     0.045     2.552   589.247     0.011     0.695     0.412 
## sibling_count5+               0.038     0.008     0.022     0.055     4.505   626.547     0.000     0.660     0.399 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-64" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-16" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-65" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.178     0.014    -0.205    -0.151   -12.791   185.448     0.000     2.713     0.734 
## birth_order                   0.000     0.002    -0.003     0.004     0.122   402.822     0.903     0.983     0.498 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.034   295.804     0.000     1.373     0.581 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.523   411.375     0.128     0.963     0.493 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.837   469.023     0.005     0.850     0.462 
## male                          0.662     0.005     0.651     0.672   120.949   309.179     0.000     1.303     0.569 
## sibling_count3                0.001     0.007    -0.013     0.016     0.195   483.927     0.845     0.826     0.455 
## sibling_count4                0.009     0.009    -0.008     0.026     1.045   530.631     0.296     0.760     0.434 
## sibling_count5                0.025     0.011     0.004     0.046     2.362   567.847     0.019     0.717     0.420 
## sibling_count5+               0.037     0.011     0.017     0.058     3.525   531.279     0.000     0.760     0.434 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-65" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-16" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-66" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.182     0.014    -0.209    -0.154   -12.916   198.975     0.000     2.394     0.708 
## birth_order_nonlinear2        0.006     0.006    -0.006     0.019     0.984   459.031     0.325     0.867     0.467 
## birth_order_nonlinear3        0.008     0.008    -0.008     0.023     0.947   473.314     0.344     0.843     0.460 
## birth_order_nonlinear4        0.006     0.010    -0.015     0.026     0.538   474.695     0.591     0.841     0.459 
## birth_order_nonlinear5       -0.001     0.013    -0.027     0.025    -0.083   488.599     0.934     0.819     0.452 
## birth_order_nonlinear5+       0.003     0.013    -0.023     0.029     0.231   434.299     0.818     0.914     0.480 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.009     4.167   322.935     0.000     1.241     0.556 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.340   445.163     0.181     0.892     0.474 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.625   497.131     0.009     0.806     0.448 
## male                          0.661     0.005     0.650     0.671   120.256   317.200     0.000     1.266     0.561 
## sibling_count3               -0.000     0.008    -0.015     0.015    -0.036   493.984     0.971     0.811     0.450 
## sibling_count4                0.007     0.009    -0.011     0.025     0.789   572.243     0.431     0.712     0.418 
## sibling_count5                0.024     0.011     0.002     0.046     2.155   554.717     0.032     0.731     0.425 
## sibling_count5+               0.037     0.011     0.016     0.059     3.381   530.032     0.001     0.761     0.434 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-66" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-16" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-67" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.186     0.015    -0.216    -0.156   -12.124   204.680     0.000     2.284     0.698 
## count_birth_order2/2          0.011     0.009    -0.007     0.028     1.157   455.832     0.248     0.873     0.468 
## count_birth_order1/3          0.001     0.011    -0.021     0.023     0.096   485.457     0.924     0.823     0.454 
## count_birth_order2/3          0.006     0.010    -0.014     0.026     0.593   596.455     0.553     0.687     0.409 
## count_birth_order3/3          0.012     0.011    -0.010     0.034     1.049   528.143     0.295     0.764     0.435 
## count_birth_order1/4          0.007     0.015    -0.022     0.036     0.474   588.989     0.636     0.695     0.412 
## count_birth_order2/4          0.015     0.014    -0.012     0.042     1.066   507.660     0.287     0.791     0.444 
## count_birth_order3/4          0.017     0.013    -0.008     0.043     1.317   727.370     0.188     0.585     0.371 
## count_birth_order4/4          0.015     0.015    -0.014     0.044     1.039   474.528     0.299     0.841     0.459 
## count_birth_order1/5          0.032     0.020    -0.008     0.071     1.568   630.363     0.117     0.656     0.398 
## count_birth_order2/5          0.027     0.019    -0.011     0.065     1.400   480.241     0.162     0.832     0.456 
## count_birth_order3/5          0.031     0.018    -0.004     0.066     1.726   580.307     0.085     0.704     0.415 
## count_birth_order4/5          0.029     0.018    -0.006     0.063     1.612   621.418     0.107     0.664     0.401 
## count_birth_order5/5          0.034     0.019    -0.004     0.071     1.773   544.047     0.077     0.744     0.429 
## count_birth_order1/5+         0.057     0.019     0.020     0.095     2.999   575.999     0.003     0.708     0.417 
## count_birth_order2/5+         0.047     0.017     0.013     0.080     2.740   571.514     0.006     0.713     0.418 
## count_birth_order3/5+         0.041     0.016     0.009     0.073     2.480   566.914     0.013     0.718     0.420 
## count_birth_order4/5+         0.045     0.017     0.012     0.078     2.688   474.201     0.007     0.841     0.459 
## count_birth_order5/5+         0.031     0.016     0.001     0.062     1.998   633.849     0.046     0.653     0.397 
## count_birth_order5+/5+        0.042     0.012     0.019     0.066     3.511   585.165     0.000     0.699     0.413 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.009     4.217   325.156     0.000     1.231     0.555 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.129   453.043     0.259     0.878     0.470 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.433   511.370     0.015     0.786     0.442 
## male                          0.660     0.006     0.650     0.671   118.662   315.095     0.000     1.275     0.563 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-67" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-16" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.639       10 1005.352    1.000  128.690 
##   2 vs 3:   -0.675        4  398.120    1.000  368.416 
##   3 vs 4:    0.015        1  382.724    0.904    0.983</code></pre>
</div>
</div>
</div>
<div id="still_smoking" class="section level3 tabset">
<h3>still_smoking</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = still_smoking)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-17" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-17" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-68" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.757     0.024     0.710     0.804    31.684   111.256     0.000    16.640     0.944 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.539   318.850     0.125     1.258     0.560 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.049   444.485     0.961     0.894     0.474 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.036   448.272     0.971     0.887     0.472 
## male                          0.213     0.020     0.173     0.252    10.542   103.613     0.000    43.419     0.978 
## sibling_count3                0.001     0.007    -0.013     0.014     0.134   324.505     0.894     1.234     0.555 
## sibling_count4                0.004     0.008    -0.013     0.020     0.431   318.222     0.667     1.261     0.561 
## sibling_count5                0.006     0.011    -0.015     0.027     0.594   268.507     0.553     1.546     0.610 
## sibling_count5+               0.013     0.010    -0.007     0.032     1.253   219.070     0.212     2.051     0.675 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.014 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.170 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-68" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-17" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-69" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.758     0.024     0.711     0.805    31.658   113.508     0.000    14.131     0.935 
## birth_order                  -0.000     0.002    -0.003     0.003    -0.230   440.978     0.818     0.900     0.476 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.544   320.203     0.123     1.252     0.559 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.062   436.623     0.951     0.909     0.479 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.020   440.314     0.984     0.902     0.477 
## male                          0.213     0.020     0.173     0.252    10.541   103.612     0.000    43.427     0.978 
## sibling_count3                0.001     0.007    -0.013     0.015     0.164   316.020     0.870     1.271     0.562 
## sibling_count4                0.004     0.008    -0.013     0.021     0.476   330.773     0.634     1.208     0.550 
## sibling_count5                0.007     0.011    -0.015     0.029     0.632   275.596     0.528     1.496     0.602 
## sibling_count5+               0.014     0.011    -0.007     0.035     1.278   283.942     0.202     1.442     0.593 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.014 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.170 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-69" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-17" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-70" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.758     0.024     0.710     0.806    31.228   114.886     0.000    12.945     0.930 
## birth_order_nonlinear2       -0.001     0.005    -0.011     0.009    -0.190   498.873     0.850     0.803     0.448 
## birth_order_nonlinear3       -0.002     0.007    -0.015     0.012    -0.240   447.755     0.810     0.888     0.473 
## birth_order_nonlinear4       -0.002     0.009    -0.019     0.016    -0.194   410.546     0.846     0.965     0.494 
## birth_order_nonlinear5        0.001     0.012    -0.023     0.024     0.064   356.173     0.949     1.115     0.530 
## birth_order_nonlinear5+       0.000     0.011    -0.022     0.022     0.001   453.601     1.000     0.877     0.470 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.568   345.159     0.118     1.153     0.538 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.013   471.257     0.990     0.846     0.461 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.072   464.938     0.943     0.857     0.464 
## male                          0.213     0.020     0.173     0.252    10.530   103.720     0.000    42.443     0.977 
## sibling_count3                0.001     0.007    -0.013     0.015     0.161   318.143     0.873     1.262     0.561 
## sibling_count4                0.004     0.009    -0.014     0.022     0.454   328.275     0.650     1.218     0.552 
## sibling_count5                0.006     0.012    -0.016     0.029     0.545   280.765     0.586     1.462     0.597 
## sibling_count5+               0.012     0.011    -0.009     0.034     1.111   293.185     0.268     1.387     0.584 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.014 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.170 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-70" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-17" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-71" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 100 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.756     0.025     0.706     0.805    29.973   117.327     0.000    11.282     0.920 
## count_birth_order2/2          0.001     0.008    -0.015     0.017     0.163   358.579     0.871     1.107     0.528 
## count_birth_order1/3          0.001     0.010    -0.019     0.021     0.124   364.945     0.901     1.087     0.523 
## count_birth_order2/3          0.000     0.010    -0.019     0.019     0.011   356.589     0.991     1.114     0.530 
## count_birth_order3/3          0.003     0.010    -0.017     0.023     0.288   379.412     0.773     1.044     0.513 
## count_birth_order1/4          0.009     0.013    -0.017     0.035     0.673   436.257     0.501     0.910     0.479 
## count_birth_order2/4          0.001     0.013    -0.025     0.027     0.076   319.842     0.939     1.254     0.559 
## count_birth_order3/4          0.003     0.013    -0.022     0.029     0.263   333.977     0.793     1.195     0.547 
## count_birth_order4/4          0.004     0.013    -0.021     0.030     0.323   379.727     0.747     1.043     0.513 
## count_birth_order1/5          0.011     0.019    -0.026     0.049     0.586   356.927     0.558     1.113     0.529 
## count_birth_order2/5          0.009     0.017    -0.025     0.043     0.526   380.095     0.599     1.042     0.513 
## count_birth_order3/5          0.002     0.016    -0.030     0.034     0.133   423.482     0.894     0.936     0.486 
## count_birth_order4/5          0.007     0.017    -0.027     0.040     0.396   344.625     0.692     1.155     0.539 
## count_birth_order5/5          0.005     0.018    -0.029     0.039     0.285   364.621     0.776     1.088     0.524 
## count_birth_order1/5+         0.017     0.017    -0.017     0.051     0.992   397.438     0.322     0.996     0.502 
## count_birth_order2/5+         0.015     0.015    -0.014     0.045     1.015   444.439     0.311     0.894     0.474 
## count_birth_order3/5+         0.008     0.016    -0.022     0.039     0.529   336.436     0.597     1.186     0.545 
## count_birth_order4/5+         0.009     0.015    -0.021     0.039     0.562   349.721     0.575     1.137     0.535 
## count_birth_order5/5+         0.016     0.015    -0.013     0.045     1.081   360.558     0.280     1.101     0.527 
## count_birth_order5+/5+        0.013     0.012    -0.011     0.037     1.092   292.120     0.276     1.393     0.585 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.317   305.199     0.189     1.323     0.572 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.151   403.851     0.880     0.981     0.498 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.056   415.682     0.955     0.953     0.490 
## male                          0.213     0.020     0.173     0.252    10.533   103.837     0.000    41.432     0.977 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.014 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.170 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-71" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-17" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 100 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.829       10 1005.336    1.000  128.823 
##   2 vs 3:   -0.829        4  398.122    1.000  368.143 
##   3 vs 4:    0.048        1  414.040    0.826    0.909</code></pre>
</div>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCm91dHB1dDogaHRtbF9kb2N1bWVudAplZGl0b3Jfb3B0aW9uczogCiAgY2h1bmtfb3V0cHV0X3R5cGU6IGNvbnNvbGUKLS0tCiMgPHNwYW4gc3R5bGU9ImNvbG9yOiNBNkQ4NTQiPkJpcnRoIE9yZGVyIEVmZmVjdHM8L3NwYW4+IHsudGFic2V0fQoKIyMgSGVscGVyCmBgYHtyIGhlbHBlcn0Kc291cmNlKCIwX2hlbHBlcnMuUiIpCm9wdHNfY2h1bmskc2V0KHdhcm5pbmcgPSBGQUxTRSkKZGV0YWNoKCJwYWNrYWdlOmxtZXJUZXN0IiwgdW5sb2FkPVRSVUUpCmBgYAoKCiMjIEZ1bmN0aW9ucwoKYGBge3J9Cm9wdGlvbnMobWMuY29yZXM9NCkKbl9pbXB1dGF0aW9ucy5taXRtbCA9IGZ1bmN0aW9uKGltcHMpIHsKICBpbXBzJGl0ZXIkbQp9Cm5faW1wdXRhdGlvbnMubWlkcyA9IGZ1bmN0aW9uKGltcHMpIHsKICBpbXBzJG0KfQpuX2ltcHV0YXRpb25zLmFtZWxpYSA9IGZ1bmN0aW9uKGltcHMpIHsKICBsZW5ndGgoaW1wcyRpbXB1dGF0aW9ucykKfQpuX2ltcHV0YXRpb25zID0gZnVuY3Rpb24oaW1wcykgeyBVc2VNZXRob2QoIm5faW1wdXRhdGlvbnMiKSB9Cgpjb21wbGV0ZS5taXRtbCA9IG1pdG1sOjptaXRtbENvbXBsZXRlCmNvbXBsZXRlLm1pZHMgPSBtaWNlOjpjb21wbGV0ZQpjb21wbGV0ZSA9IGZ1bmN0aW9uKC4uLikgeyBVc2VNZXRob2QoImNvbXBsZXRlIikgfQoKbGlicmFyeShtaWNlKQpsaWJyYXJ5KG1pY2VhZGRzKQpsaWJyYXJ5KG1pdG1sKQpgYGAKCgojIyBMb2FkIGRhdGEKYGBge3IgTG9hZCBEYXRhfQpiaXJ0aG9yZGVyID0gcmVhZFJEUygiZGF0YS9hbGxkYXRhX2JpcnRob3JkZXJfaV9tbC5yZHMiKQpgYGAKCiMjIERhdGEgcHJlcGFyYXRpb25zCmBgYHtyIGRhdGEgcHJlcGFyYXRpb25zfQpiaXJ0aG9yZGVyIDwtIG1pZHMybWl0bWwubGlzdChiaXJ0aG9yZGVyKQoKIyMgQ2FsY3VsYXRlIGdfZmFjdG9ycyAoZm9yIG5vdyB3aXRoIHJvd01lYW5zOiBiZXR0ZXIgdG8gcnVuIGZhY3RvciBhbmFseXNpcyBoZXJlIGFzIHdlbGw/KQpiaXJ0aG9yZGVyIDwtIHdpdGhpbihiaXJ0aG9yZGVyLCB7CiAgZ19mYWN0b3JfMjAxNV9vbGQgPC0gcm93TWVhbnMoc2NhbGUoY2JpbmQocmF2ZW5fMjAxNV9vbGQsIG1hdGhfMjAxNV9vbGQsIGNvdW50X2JhY2t3YXJkcywgIHdvcmRzX2RlbGF5ZWQsIGFkYXB0aXZlX251bWJlcmluZykpKQp9KQoKYmlydGhvcmRlciA8LSB3aXRoaW4oYmlydGhvcmRlciwgewogIGdfZmFjdG9yXzIwMTVfeW91bmcgPC0gcm93TWVhbnMoc2NhbGUoY2JpbmQocmF2ZW5fMjAxNV95b3VuZywgbWF0aF8yMDE1X3lvdW5nKSkpCn0pCgpiaXJ0aG9yZGVyIDwtIHdpdGhpbihiaXJ0aG9yZGVyLCB7CiAgZ19mYWN0b3JfMjAwN19vbGQgPC0gcm93TWVhbnMoc2NhbGUoY2JpbmQocmF2ZW5fMjAwN19vbGQsIG1hdGhfMjAwN19vbGQpKSkKfSkKCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDA3X3lvdW5nIDwtIHJvd01lYW5zKHNjYWxlKGNiaW5kKHJhdmVuXzIwMDdfeW91bmcsIG1hdGhfMjAwN195b3VuZykpKQp9KQoKCmJpcnRob3JkZXIgPSBiaXJ0aG9yZGVyICU+JSB0YmxfZGYubWl0bWwubGlzdAoKIyMjIEJpcnRob3JkZXIgYW5kIFNpYmxpbmcgQ291bnQKIyBmb3IgZmFjdG9yIHZhcmlhYmxlcyB3ZSBoYXZlIHRvIHJvdW5kIGJpcnRoIG9yZGVyIHBvc2l0aW9uIGFuZCBlbGltaW5hdGUgYWxsIHVubGlrZWx5IG51bWJlcnMgKG5lZ2F0aXZlIG9uZXMpCmJpcnRob3JkZXJfZGF0YSA9IGJpcnRob3JkZXJbWzFdXQoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lCiAgbXV0YXRlKGJpcnRob3JkZXJfZ2VuZXMgPSBpZmVsc2UoYmlydGhvcmRlcl9nZW5lcyA8IDAsIDAsIGJpcnRob3JkZXJfZ2VuZXMpLAogICAgICAgICBiaXJ0aG9yZGVyX25haXZlID0gaWZlbHNlKGJpcnRob3JkZXJfbmFpdmUgPCAwLCAwLCBiaXJ0aG9yZGVyX25haXZlKSwKICAgICAgICAgYmlydGhvcmRlcl9nZW5lcyA9IHJvdW5kKGJpcnRob3JkZXJfZ2VuZXMpLAogICAgICAgICBiaXJ0aG9yZGVyX25haXZlID0gcm91bmQoYmlydGhvcmRlcl9uYWl2ZSksCiAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgPSBpZmVsc2Uoc2libGluZ19jb3VudF9nZW5lcyA8IDAsIDAsIHNpYmxpbmdfY291bnRfZ2VuZXMpLAogICAgICAgICBzaWJsaW5nX2NvdW50X25haXZlID0gaWZlbHNlKHNpYmxpbmdfY291bnRfbmFpdmUgPCAwLCAwLCBzaWJsaW5nX2NvdW50X25haXZlKSwKICAgICAgICAgc2libGluZ19jb3VudF9nZW5lcyA9IHJvdW5kKHNpYmxpbmdfY291bnRfZ2VuZXMpLAogICAgICAgICBzaWJsaW5nX2NvdW50X25haXZlID0gcm91bmQoc2libGluZ19jb3VudF9uYWl2ZSkKICAgICAgICAgKQoKCmJpcnRob3JkZXIgPSBiaXJ0aG9yZGVyICU+JSAKICBtdXRhdGUoCiMgYmlydGhvcmRlciBhcyBmYWN0b3JzIHdpdGggbGV2ZWxzIG9mIDEsIDIsIDMsIDQsIDUsIDUrCiAgICBiaXJ0aG9yZGVyX25haXZlX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihiaXJ0aG9yZGVyX25haXZlKSwKICAgIGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yID0gaWZlbHNlKGJpcnRob3JkZXJfbmFpdmUgPiA1LCAiNSsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yKSwKICAgIGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yID0gZmFjdG9yKGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIxIiwiMiIsIjMiLCI0IiwiNSIsIjUrIikpLAogICAgc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IgPSBhcy5jaGFyYWN0ZXIoc2libGluZ19jb3VudF9uYWl2ZSksCiAgICBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciA9IGlmZWxzZShzaWJsaW5nX2NvdW50X25haXZlID4gNSwgIjUrIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciksCiAgICBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciA9IGZhY3RvcihzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gYygiMiIsIjMiLCI0IiwiNSIsIjUrIikpLAogICAgYmlydGhvcmRlcl9nZW5lc19mYWN0b3IgPSBhcy5jaGFyYWN0ZXIoYmlydGhvcmRlcl9nZW5lcyksCiAgICBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciA9IGlmZWxzZShiaXJ0aG9yZGVyX2dlbmVzID41ICwgIjUrIiwgYmlydGhvcmRlcl9nZW5lc19mYWN0b3IpLAogICAgYmlydGhvcmRlcl9nZW5lc19mYWN0b3IgPSBmYWN0b3IoYmlydGhvcmRlcl9nZW5lc19mYWN0b3IsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gYygiMSIsIjIiLCIzIiwiNCIsIjUiLCI1KyIpKSwKICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yID0gYXMuY2hhcmFjdGVyKHNpYmxpbmdfY291bnRfZ2VuZXMpLAogICAgc2libGluZ19jb3VudF9nZW5lc19mYWN0b3IgPSBpZmVsc2Uoc2libGluZ19jb3VudF9nZW5lcyA+NSAsICI1KyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciksCiAgICBzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciA9IGZhY3RvcihzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIyIiwiMyIsIjQiLCI1IiwiNSsiKSksCiAgICAjIGludGVyYWN0aW9uIGJpcnRob3JkZXIgKiBzaWJsaW5nY291dCBmb3IgZWFjaCBiaXJ0aG9yZGVyCiAgICBjb3VudF9iaXJ0aG9yZGVyX25haXZlID0KICAgICAgZmFjdG9yKHN0cl9yZXBsYWNlKGFzLmNoYXJhY3RlcihpbnRlcmFjdGlvbihiaXJ0aG9yZGVyX25haXZlX2ZhY3RvciwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yKSksCiAgICAgICAgICAgICAgICAgICAgICAgICJcXC4iLCAiLyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gICBjKCIxLzIiLCIyLzIiLCAiMS8zIiwgICIyLzMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIzLzMiLCAiMS80IiwgIjIvNCIsICIzLzQiLCAiNC80IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81IiwgIjIvNSIsICIzLzUiLCAiNC81IiwgIjUvNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjEvNSsiLCAiMi81KyIsICIzLzUrIiwgIjQvNSsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI1LzUrIiwgIjUrLzUrIikpLAogICAgY291bnRfYmlydGhvcmRlcl9nZW5lcyA9CiAgICAgIGZhY3RvcihzdHJfcmVwbGFjZShhcy5jaGFyYWN0ZXIoaW50ZXJhY3Rpb24oYmlydGhvcmRlcl9nZW5lc19mYWN0b3IsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvcikpLCAiXFwuIiwgIi8iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9ICAgYygiMS8yIiwiMi8yIiwgIjEvMyIsICAiMi8zIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMy8zIiwgIjEvNCIsICIyLzQiLCAiMy80IiwgIjQvNCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjEvNSIsICIyLzUiLCAiMy81IiwgIjQvNSIsICI1LzUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIxLzUrIiwgIjIvNSsiLCAiMy81KyIsICI0LzUrIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiNS81KyIsICI1Ky81KyIpKSkKCgoKIyMjIFZhcmlhYmxlcwpiaXJ0aG9yZGVyID0gYmlydGhvcmRlciAlPiUKICBtdXRhdGUoCiAgICBnX2ZhY3Rvcl8yMDE1X29sZCA9IChnX2ZhY3Rvcl8yMDE1X29sZCAtIG1lYW4oZ19mYWN0b3JfMjAxNV9vbGQsIG5hLnJtPVQpKSAvIHNkKGdfZmFjdG9yXzIwMTVfb2xkLCBuYS5ybT1UKSwKICAgIGdfZmFjdG9yXzIwMTVfeW91bmcgPSAoZ19mYWN0b3JfMjAxNV95b3VuZyAtIG1lYW4oZ19mYWN0b3JfMjAxNV95b3VuZywgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAxNV95b3VuZywgbmEucm09VCksCiAgICBnX2ZhY3Rvcl8yMDA3X29sZCA9IChnX2ZhY3Rvcl8yMDA3X29sZCAtIG1lYW4oZ19mYWN0b3JfMjAwN19vbGQsIG5hLnJtPVQpKSAvIHNkKGdfZmFjdG9yXzIwMDdfb2xkLCBuYS5ybT1UKSwKZ19mYWN0b3JfMjAwN195b3VuZyA9IChnX2ZhY3Rvcl8yMDA3X3lvdW5nIC0gbWVhbihnX2ZhY3Rvcl8yMDA3X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChnX2ZhY3Rvcl8yMDA3X3lvdW5nLCBuYS5ybT1UKSwKICAgIHJhdmVuXzIwMTVfb2xkID0gKHJhdmVuXzIwMTVfb2xkIC0gbWVhbihyYXZlbl8yMDE1X29sZCwgbmEucm09VCkpIC8gc2QocmF2ZW5fMjAxNV9vbGQpLAogICAgbWF0aF8yMDE1X29sZCA9IChtYXRoXzIwMTVfb2xkIC0gbWVhbihtYXRoXzIwMTVfb2xkLCBuYS5ybT1UKSkgLyBzZChtYXRoXzIwMTVfb2xkLCBuYS5ybT1UKSwKICAgIHJhdmVuXzIwMTVfeW91bmcgPSAocmF2ZW5fMjAxNV95b3VuZyAtIG1lYW4ocmF2ZW5fMjAxNV95b3VuZywgbmEucm09VCkpIC8gc2QocmF2ZW5fMjAxNV95b3VuZyksCiAgICBtYXRoXzIwMTVfeW91bmcgPSAobWF0aF8yMDE1X3lvdW5nIC0gbWVhbihtYXRoXzIwMTVfeW91bmcsIG5hLnJtPVQpKSAvCiAgICAgIHNkKG1hdGhfMjAxNV95b3VuZywgbmEucm09VCksCiAgICByYXZlbl8yMDA3X29sZCA9IChyYXZlbl8yMDA3X29sZCAtIG1lYW4ocmF2ZW5fMjAwN19vbGQsIG5hLnJtPVQpKSAvIHNkKHJhdmVuXzIwMDdfb2xkKSwKbWF0aF8yMDA3X29sZCA9IChtYXRoXzIwMDdfb2xkIC0gbWVhbihtYXRoXzIwMDdfb2xkLCBuYS5ybT1UKSkgLyBzZChtYXRoXzIwMDdfb2xkLCBuYS5ybT1UKSwKcmF2ZW5fMjAwN195b3VuZyA9IChyYXZlbl8yMDA3X3lvdW5nIC0gbWVhbihyYXZlbl8yMDA3X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDA3X3lvdW5nKSwKbWF0aF8yMDA3X3lvdW5nID0gKG1hdGhfMjAwN195b3VuZyAtIG1lYW4obWF0aF8yMDA3X3lvdW5nLCBuYS5ybT1UKSkgLwogIHNkKG1hdGhfMjAwN195b3VuZywgbmEucm09VCksCiAgICBjb3VudF9iYWNrd2FyZHMgPSAoY291bnRfYmFja3dhcmRzIC0gbWVhbihjb3VudF9iYWNrd2FyZHMsIG5hLnJtPVQpKSAvCiAgICAgIHNkKGNvdW50X2JhY2t3YXJkcywgbmEucm09VCksCiAgICB3b3Jkc19kZWxheWVkID0gKHdvcmRzX2RlbGF5ZWQgLSBtZWFuKHdvcmRzX2RlbGF5ZWQsIG5hLnJtPVQpKSAvCiAgICAgIHNkKHdvcmRzX2RlbGF5ZWQsIG5hLnJtPVQpLAogICAgYWRhcHRpdmVfbnVtYmVyaW5nID0gKGFkYXB0aXZlX251bWJlcmluZyAtIG1lYW4oYWRhcHRpdmVfbnVtYmVyaW5nLCBuYS5ybT1UKSkgLwogICAgICBzZChhZGFwdGl2ZV9udW1iZXJpbmcsIG5hLnJtPVQpLAogICAgYmlnNV9leHQgPSAoYmlnNV9leHQgLSBtZWFuKGJpZzVfZXh0LCBuYS5ybT1UKSkgLyBzZChiaWc1X2V4dCwgbmEucm09VCksCiAgICBiaWc1X2NvbiA9IChiaWc1X2NvbiAtIG1lYW4oYmlnNV9jb24sIG5hLnJtPVQpKSAvIHNkKGJpZzVfY29uLCBuYS5ybT1UKSwKICAgIGJpZzVfYWdyZWUgPSAoYmlnNV9hZ3JlZSAtIG1lYW4oYmlnNV9hZ3JlZSwgbmEucm09VCkpIC8gc2QoYmlnNV9hZ3JlZSwgbmEucm09VCksCiAgICBiaWc1X29wZW4gPSAoYmlnNV9vcGVuIC0gbWVhbihiaWc1X29wZW4sIG5hLnJtPVQpKSAvIHNkKGJpZzVfb3BlbiwgbmEucm09VCksCiAgICBiaWc1X25ldSA9IChiaWc1X25ldSAtIG1lYW4oYmlnNV9uZXUsIG5hLnJtPVQpKSAvIHNkKGJpZzVfbmV1LCBuYS5ybT1UKSwKICAgIHJpc2tBID0gKHJpc2tBIC0gbWVhbihyaXNrQSwgbmEucm09VCkpIC8gc2Qocmlza0EsIG5hLnJtPVQpLAogICAgcmlza0IgPSAocmlza0IgLSBtZWFuKHJpc2tCLCBuYS5ybT1UKSkgLyBzZChyaXNrQiwgbmEucm09VCksCiAgICB5ZWFyc19vZl9lZHVjYXRpb25feiA9ICh5ZWFyc19vZl9lZHVjYXRpb24gLSBtZWFuKHllYXJzX29mX2VkdWNhdGlvbiwgbmEucm09VCkpIC8KICAgICAgc2QoeWVhcnNfb2ZfZWR1Y2F0aW9uLCBuYS5ybT1UKSwKICAgIHdhZ2VfbGFzdF9tb250aF96ID0gKHdhZ2VfbGFzdF9tb250aF9sb2cgLSBtZWFuKHdhZ2VfbGFzdF9tb250aF9sb2csIG5hLnJtPVQpKSAvCiAgICAgIHNkKHdhZ2VfbGFzdF9tb250aF9sb2csIG5hLnJtPVQpLAogICAgd2FnZV9sYXN0X3llYXJfeiA9ICh3YWdlX2xhc3RfeWVhcl9sb2cgLSBtZWFuKHdhZ2VfbGFzdF95ZWFyX2xvZywgbmEucm09VCkpIC8KICAgICAgc2Qod2FnZV9sYXN0X3llYXJfbG9nLCBuYS5ybT1UKSwKICAgIGF0dGVuZGVkX3NjaG9vbCA9IGFzLmludGVnZXIoYXR0ZW5kZWRfc2Nob29sKSwKICAgIGF0dGVuZGVkX3NjaG9vbCA9IGlmZWxzZShhdHRlbmRlZF9zY2hvb2wgPT0gMSwgMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGF0dGVuZGVkX3NjaG9vbCA9PSAyLCAxLCBOQSkpKQogICAgICAgIApkYXRhX3VzZWQgPC0gYmlydGhvcmRlciAlPiUKICBtdXRhdGUoc2libGluZ19jb3VudCA9IHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yLAogICAgICAgICBiaXJ0aF9vcmRlcl9ub25saW5lYXIgPSBiaXJ0aG9yZGVyX25haXZlX2ZhY3RvciwKICAgICAgICAgYmlydGhfb3JkZXIgPSBiaXJ0aG9yZGVyX25haXZlLAogICAgICAgICBjb3VudF9iaXJ0aF9vcmRlciA9IGNvdW50X2JpcnRob3JkZXJfbmFpdmUpCgpgYGAKCiMjIEludGVsbGlnZW5jZSB7LmFjdGl2ZSAudGFic2V0fQojIyMgZy1mYWN0b3IgMjAxNSBvbGQgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gZ19mYWN0b3JfMjAxNV9vbGQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgZy1mYWN0b3IgMjAxNSB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBnX2ZhY3Rvcl8yMDE1X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMgUGVyc29uYWxpdHkgey50YWJzZXR9CgojIyMgRXh0cmF2ZXJzaW9uIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfZXh0KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBOZXVyb3RpY2lzbSB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBiaWc1X25ldSkKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIENvbnNjaWVudGlvdXNuZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfbmV1KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBBZ3JlZWFibGVuZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfYWdyZWUpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIE9wZW5uZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfb3BlbikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIFJpc2twcmVmZXJlbmNlIHsudGFic2V0fQojIyMgUmlzayBBIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJpc2tBKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIFJpc2sgQiB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByaXNrQikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIEVkdWNhdGlvbmFsIEF0dGFpbm1lbnQgey50YWJzZXR9CiMjIyBZZWFycyBvZiBFZHVjYXRpb24gLSB6LXN0YW5kYXJkaXplZHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHllYXJzX29mX2VkdWNhdGlvbl96KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIGVsZW1lbnRhcnlfbWlzc2VkCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gRWxlbWVudGFyeV9taXNzZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIGVsZW1lbnRhcnlfd29ya2VkCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gRWxlbWVudGFyeV93b3JrZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgYXR0ZW5kZWRfc2Nob29sCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYXR0ZW5kZWRfc2Nob29sKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCgojIyBXb3JrIHsudGFic2V0fQoKIyMjIEluY29tZSBMYXN0IE1vbnRoIChsb2cpIC0gei1zdGFuZGFyZGl6ZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHdhZ2VfbGFzdF9tb250aF96KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIEluY29tZSBsYXN0IHllYXIgKGxvZykgLSB6LXN0YW5kYXJkaXplZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gd2FnZV9sYXN0X3llYXJfeikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoKIyMjIFNlbGYtRW1wbG95bWVudCAtIG5vbiBzdGFuZGFyZGl6ZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IFNlbGZfZW1wbG95ZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQpgYGAKCiMjIFNtb2tpbmcgQmVoYXZpb3VyIHsudGFic2V0fQojIyMgZXZlcl9zbW9rZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGV2ZXJfc21va2VkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgojIyMgc3RpbGxfc21va2luZyB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gc3RpbGxfc21va2luZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoK</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
