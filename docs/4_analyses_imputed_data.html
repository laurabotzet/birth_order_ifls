<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("4_analyses_imputed_data.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>
<li style="background-color: #A6D854">
  <a href="4_analyses.html">Birth Order Effects</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
    <span class="fa fa-github"></span>


  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>




</div>


<div id="birth-order-effects" class="section level1 tabset">
<h1><span style="color:#A6D854">Birth Order Effects</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     ggsave</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.5-23.1097</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;sjPlot&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:cowplot&#39;:
## 
##     plot_grid, save_plot</code></pre>
<pre class="r"><code>opts_chunk$set(warning = FALSE)
detach(&quot;package:lmerTest&quot;, unload=TRUE)</code></pre>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<pre class="r"><code>n_imputations.mitml = function(imps) {
  imps$iter$m
}
n_imputations.mids = function(imps) {
  imps$m
}
n_imputations.amelia = function(imps) {
  length(imps$imputations)
}
n_imputations = function(imps) { UseMethod(&quot;n_imputations&quot;) }

complete.mitml = mitml::mitmlComplete
complete.mids = mice::complete
complete = function(...) { UseMethod(&quot;complete&quot;) }

library(mice)</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     complete</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     complete</code></pre>
<pre class="r"><code>library(miceadds)</code></pre>
<pre><code>## * miceadds 2.7-19 (2017-08-24 17:34:44)</code></pre>
<pre class="r"><code>library(mitml)</code></pre>
<pre><code>## *** This is beta software. Please report any bugs!
## *** See the NEWS file for recent changes.</code></pre>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code>birthorder = readRDS(&quot;data/alldata_birthorder_i_ml.rds&quot;)</code></pre>
</div>
<div id="data-preparations" class="section level2">
<h2>Data preparations</h2>
<pre class="r"><code>birthorder &lt;- mids2mitml.list(birthorder)

## Calculate g_factors (for now with rowMeans: better to run factor analysis here as well?)
birthorder &lt;- within(birthorder, {
  g_factor_2015_old &lt;- rowMeans(scale(cbind(raven_2015_old, math_2015_old, count_backwards,  words_delayed, adaptive_numbering)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2015_young &lt;- rowMeans(scale(cbind(raven_2015_young, math_2015_young)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_old &lt;- rowMeans(scale(cbind(raven_2007_old, math_2007_old)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_young &lt;- rowMeans(scale(cbind(raven_2007_young, math_2007_young)))
})


birthorder = birthorder %&gt;% tbl_df.mitml.list

### Birthorder and Sibling Count
# for factor variables we have to round birth order position and eliminate all unlikely numbers (negative ones)
birthorder_data = birthorder[[1]]

birthorder = birthorder %&gt;%
  mutate(birthorder_genes = ifelse(birthorder_genes &lt; 0, 0, birthorder_genes),
         birthorder_naive = ifelse(birthorder_naive &lt; 0, 0, birthorder_naive),
         birthorder_genes = round(birthorder_genes),
         birthorder_naive = round(birthorder_naive),
         sibling_count_genes = ifelse(sibling_count_genes &lt; 0, 0, sibling_count_genes),
         sibling_count_naive = ifelse(sibling_count_naive &lt; 0, 0, sibling_count_naive),
         sibling_count_genes = round(sibling_count_genes),
         sibling_count_naive = round(sibling_count_naive)
         )


birthorder = birthorder %&gt;% 
  mutate(
# birthorder as factors with levels of 1, 2, 3, 4, 5, 5+
    birthorder_naive_factor = as.character(birthorder_naive),
    birthorder_naive_factor = ifelse(birthorder_naive &gt; 5, &quot;5+&quot;,
                                            birthorder_naive_factor),
    birthorder_naive_factor = factor(birthorder_naive_factor, 
                                            levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    sibling_count_naive_factor = as.character(sibling_count_naive),
    sibling_count_naive_factor = ifelse(sibling_count_naive &gt; 5, &quot;5+&quot;,
                                               sibling_count_naive_factor),
    sibling_count_naive_factor = factor(sibling_count_naive_factor, 
                                               levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    birthorder_genes_factor = as.character(birthorder_genes),
    birthorder_genes_factor = ifelse(birthorder_genes &gt;5 , &quot;5+&quot;, birthorder_genes_factor),
    birthorder_genes_factor = factor(birthorder_genes_factor, 
                                     levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    sibling_count_genes_factor = as.character(sibling_count_genes),
    sibling_count_genes_factor = ifelse(sibling_count_genes &gt;5 , &quot;5+&quot;,
                                        sibling_count_genes_factor),
    sibling_count_genes_factor = factor(sibling_count_genes_factor, 
                                        levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    # interaction birthorder * siblingcout for each birthorder
    count_birthorder_naive =
      factor(str_replace(as.character(interaction(birthorder_naive_factor,                                                              sibling_count_naive_factor)),
                        &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;,
                                                        &quot;1/5+&quot;, &quot;2/5+&quot;, &quot;3/5+&quot;, &quot;4/5+&quot;,
                                                        &quot;5/5+&quot;, &quot;5+/5+&quot;)),
    count_birthorder_genes =
      factor(str_replace(as.character(interaction(birthorder_genes_factor,                                                              sibling_count_genes_factor)), &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;,
                                                        &quot;1/5+&quot;, &quot;2/5+&quot;, &quot;3/5+&quot;, &quot;4/5+&quot;,
                                                        &quot;5/5+&quot;, &quot;5+/5+&quot;)))



### Variables
birthorder = birthorder %&gt;%
  mutate(
    g_factor_2015_old = (g_factor_2015_old - mean(g_factor_2015_old, na.rm=T)) / sd(g_factor_2015_old, na.rm=T),
    g_factor_2015_young = (g_factor_2015_young - mean(g_factor_2015_young, na.rm=T)) / sd(g_factor_2015_young, na.rm=T),
    g_factor_2007_old = (g_factor_2007_old - mean(g_factor_2007_old, na.rm=T)) / sd(g_factor_2007_old, na.rm=T),
g_factor_2007_young = (g_factor_2007_young - mean(g_factor_2007_young, na.rm=T)) / sd(g_factor_2007_young, na.rm=T),
    raven_2015_old = (raven_2015_old - mean(raven_2015_old, na.rm=T)) / sd(raven_2015_old),
    math_2015_old = (math_2015_old - mean(math_2015_old, na.rm=T)) / sd(math_2015_old, na.rm=T),
    raven_2015_young = (raven_2015_young - mean(raven_2015_young, na.rm=T)) / sd(raven_2015_young),
    math_2015_young = (math_2015_young - mean(math_2015_young, na.rm=T)) /
      sd(math_2015_young, na.rm=T),
    raven_2007_old = (raven_2007_old - mean(raven_2007_old, na.rm=T)) / sd(raven_2007_old),
math_2007_old = (math_2007_old - mean(math_2007_old, na.rm=T)) / sd(math_2007_old, na.rm=T),
raven_2007_young = (raven_2007_young - mean(raven_2007_young, na.rm=T)) / sd(raven_2007_young),
math_2007_young = (math_2007_young - mean(math_2007_young, na.rm=T)) /
  sd(math_2007_young, na.rm=T),
    count_backwards = (count_backwards - mean(count_backwards, na.rm=T)) /
      sd(count_backwards, na.rm=T),
    words_delayed = (words_delayed - mean(words_delayed, na.rm=T)) /
      sd(words_delayed, na.rm=T),
    adaptive_numbering = (adaptive_numbering - mean(adaptive_numbering, na.rm=T)) /
      sd(adaptive_numbering, na.rm=T),
    big5_ext = (big5_ext - mean(big5_ext, na.rm=T)) / sd(big5_ext, na.rm=T),
    big5_con = (big5_con - mean(big5_con, na.rm=T)) / sd(big5_con, na.rm=T),
    big5_agree = (big5_agree - mean(big5_agree, na.rm=T)) / sd(big5_agree, na.rm=T),
    big5_open = (big5_open - mean(big5_open, na.rm=T)) / sd(big5_open, na.rm=T),
    big5_neu = (big5_neu - mean(big5_neu, na.rm=T)) / sd(big5_neu, na.rm=T),
    riskA = (riskA - mean(riskA, na.rm=T)) / sd(riskA, na.rm=T),
    riskB = (riskB - mean(riskB, na.rm=T)) / sd(riskB, na.rm=T),
    years_of_education_z = (years_of_education - mean(years_of_education, na.rm=T)) /
      sd(years_of_education, na.rm=T),
    wage_last_month_z = (wage_last_month_log - mean(wage_last_month_log, na.rm=T)) /
      sd(wage_last_month_log, na.rm=T),
    wage_last_year_z = (wage_last_year_log - mean(wage_last_year_log, na.rm=T)) /
      sd(wage_last_year_log, na.rm=T),
    attended_school = as.integer(attended_school),
    attended_school = ifelse(attended_school == 1, 0,
                           ifelse(attended_school == 2, 1, NA)))
        
data_used &lt;- birthorder %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)</code></pre>
</div>
<div id="intelligence" class="section level2 active tabset">
<h2>Intelligence</h2>
<div id="g-factor-2015-old" class="section level3 tabset">
<h3>g-factor 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.476     0.032     0.414     0.538    15.041    22.094     0.000     1.764     0.667 
## poly(age, 3, raw = TRUE)1    -0.019     0.004    -0.027    -0.012    -4.856    27.728     0.000     1.324     0.598 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.106    54.026     0.274     0.690     0.429 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.036    94.465     0.003     0.446     0.323 
## male                         -0.016     0.011    -0.038     0.006    -1.416   117.088     0.160     0.384     0.289 
## sibling_count3                0.006     0.020    -0.032     0.045     0.325   265.777     0.746     0.226     0.190 
## sibling_count4               -0.012     0.023    -0.058     0.034    -0.516   167.771     0.606     0.301     0.241 
## sibling_count5               -0.006     0.026    -0.057     0.044    -0.243   245.139     0.809     0.237     0.198 
## sibling_count5+              -0.151     0.020    -0.190    -0.113    -7.678   218.818     0.000     0.254     0.210 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.662 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-1" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.484     0.033     0.419     0.549    14.621    21.876     0.000     1.789     0.670 
## birth_order                  -0.004     0.003    -0.010     0.002    -1.152    71.682     0.253     0.549     0.372 
## poly(age, 3, raw = TRUE)1    -0.019     0.004    -0.027    -0.012    -4.855    27.742     0.000     1.323     0.598 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.040    57.069     0.303     0.659     0.417 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.980   101.448     0.004     0.424     0.311 
## male                         -0.016     0.011    -0.038     0.006    -1.411   116.908     0.161     0.384     0.290 
## sibling_count3                0.009     0.020    -0.030     0.047     0.439   268.084     0.661     0.224     0.189 
## sibling_count4               -0.007     0.023    -0.053     0.038    -0.306   199.228     0.760     0.270     0.220 
## sibling_count5                0.001     0.027    -0.053     0.055     0.041   141.572     0.967     0.337     0.262 
## sibling_count5+              -0.135     0.022    -0.179    -0.092    -6.092   614.290     0.000     0.138     0.124 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.662 
## ICC|mother_pidlink                     0.234 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-1" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-2" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.486     0.036     0.416     0.555    13.661    22.918     0.000     1.679     0.655 
## birth_order_nonlinear2       -0.008     0.019    -0.045     0.029    -0.423    32.087     0.675     1.126     0.556 
## birth_order_nonlinear3       -0.011     0.019    -0.048     0.026    -0.600   105.271     0.549     0.413     0.305 
## birth_order_nonlinear4       -0.026     0.028    -0.082     0.029    -0.925    31.236     0.362     1.159     0.564 
## birth_order_nonlinear5       -0.012     0.031    -0.072     0.049    -0.378    43.968     0.707     0.826     0.476 
## birth_order_nonlinear5+      -0.029     0.028    -0.084     0.026    -1.040    39.245     0.305     0.919     0.504 
## poly(age, 3, raw = TRUE)1    -0.020     0.004    -0.028    -0.012    -4.716    26.191     0.000     1.417     0.615 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.095    46.143     0.279     0.791     0.464 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.920    72.950     0.005     0.541     0.368 
## male                         -0.016     0.011    -0.038     0.006    -1.411   114.077     0.161     0.391     0.293 
## sibling_count3                0.010     0.021    -0.031     0.050     0.469   281.058     0.640     0.218     0.185 
## sibling_count4               -0.002     0.024    -0.049     0.044    -0.101   410.000     0.920     0.174     0.152 
## sibling_count5                0.004     0.030    -0.056     0.063     0.117    93.213     0.907     0.451     0.325 
## sibling_count5+              -0.133     0.025    -0.182    -0.083    -5.249   163.612     0.000     0.306     0.244 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.662 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-2" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-3" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.477     0.035     0.407     0.546    13.490    32.577     0.000     1.108     0.552 
## count_birth_order2/2          0.000     0.026    -0.050     0.050     0.013    51.060     0.990     0.724     0.441 
## count_birth_order1/3          0.015     0.029    -0.041     0.071     0.512   178.523     0.610     0.290     0.233 
## count_birth_order2/3         -0.007     0.031    -0.069     0.055    -0.229    69.399     0.820     0.563     0.378 
## count_birth_order3/3          0.012     0.028    -0.043     0.066     0.430   189.976     0.668     0.278     0.226 
## count_birth_order1/4         -0.003     0.034    -0.070     0.063    -0.099   565.762     0.921     0.144     0.129 
## count_birth_order2/4          0.011     0.035    -0.058     0.080     0.306   242.123     0.760     0.239     0.199 
## count_birth_order3/4         -0.034     0.037    -0.107     0.040    -0.897    82.850     0.373     0.492     0.345 
## count_birth_order4/4         -0.015     0.037    -0.088     0.057    -0.415    67.143     0.680     0.578     0.384 
## count_birth_order1/5         -0.024     0.044    -0.111     0.063    -0.547   205.142     0.585     0.265     0.217 
## count_birth_order2/5          0.025     0.045    -0.063     0.114     0.559   201.729     0.577     0.268     0.219 
## count_birth_order3/5          0.009     0.041    -0.071     0.089     0.217   578.666     0.828     0.142     0.128 
## count_birth_order4/5         -0.040     0.046    -0.131     0.050    -0.881    82.495     0.381     0.493     0.346 
## count_birth_order5/5          0.005     0.042    -0.078     0.088     0.115    87.734     0.909     0.471     0.335 
## count_birth_order1/5+        -0.103     0.036    -0.174    -0.031    -2.824   117.416     0.006     0.383     0.289 
## count_birth_order2/5+        -0.157     0.036    -0.229    -0.086    -4.317   119.310     0.000     0.379     0.287 
## count_birth_order3/5+        -0.144     0.039    -0.221    -0.068    -3.685    52.961     0.001     0.701     0.433 
## count_birth_order4/5+        -0.154     0.037    -0.227    -0.081    -4.136    62.356     0.000     0.613     0.399 
## count_birth_order5/5+        -0.147     0.035    -0.215    -0.079    -4.257    96.471     0.000     0.440     0.319 
## count_birth_order5+/5+       -0.159     0.026    -0.209    -0.109    -6.233   103.944     0.000     0.417     0.307 
## poly(age, 3, raw = TRUE)1    -0.019     0.004    -0.027    -0.011    -4.469    28.782     0.000     1.269     0.587 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.871    46.195     0.388     0.790     0.464 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.649    66.604     0.010     0.581     0.386 
## male                         -0.016     0.011    -0.038     0.006    -1.432   112.441     0.155     0.395     0.295 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.662 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-3" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.434      10 248.442   0.929   1.425 
##  2 vs 3:   0.188       4  64.081   0.944   2.551 
##  3 vs 4:   1.313       1  32.544   0.260   0.560</code></pre>
</div>
</div>
<div id="parental-full-sibling-order" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-1" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-4" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.463     0.031     0.402     0.524    14.860    22.010     0.000     1.774     0.668 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.026    -0.010    -4.380    22.102     0.000     1.763     0.667 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.307    30.652     0.761     1.183     0.569 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.248    40.217     0.030     0.898     0.497 
## male                         -0.010     0.012    -0.033     0.012    -0.902   103.951     0.369     0.417     0.307 
## sibling_count3                0.019     0.022    -0.025     0.062     0.843    34.300     0.405     1.050     0.538 
## sibling_count4               -0.025     0.023    -0.071     0.020    -1.085    70.027     0.282     0.559     0.376 
## sibling_count5               -0.082     0.028    -0.137    -0.027    -2.904    65.348     0.005     0.590     0.390 
## sibling_count5+              -0.162     0.022    -0.205    -0.120    -7.445   280.078     0.000     0.218     0.185 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.663 
## ICC|mother_pidlink                     0.238 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-4" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-1" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-5" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.451     0.032     0.388     0.514    14.070    25.035     0.000     1.497     0.628 
## birth_order                   0.005     0.005    -0.004     0.015     1.124    43.788     0.267     0.829     0.477 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.026    -0.010    -4.363    22.113     0.000     1.762     0.667 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.373    30.712     0.712     1.180     0.569 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.331    40.406     0.025     0.894     0.496 
## male                         -0.010     0.012    -0.033     0.012    -0.901   104.137     0.370     0.416     0.307 
## sibling_count3                0.015     0.022    -0.028     0.058     0.682    36.454     0.500     0.988     0.522 
## sibling_count4               -0.033     0.024    -0.080     0.015    -1.345    66.230     0.183     0.584     0.387 
## sibling_count5               -0.093     0.031    -0.154    -0.032    -3.001    50.125     0.004     0.735     0.445 
## sibling_count5+              -0.181     0.028    -0.235    -0.127    -6.539   105.626     0.000     0.412     0.305 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.663 
## ICC|mother_pidlink                     0.238 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-5" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-1" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-6" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.468     0.033     0.403     0.534    14.011    25.747     0.000     1.446     0.620 
## birth_order_nonlinear2       -0.005     0.017    -0.038     0.028    -0.297    44.977     0.768     0.809     0.470 
## birth_order_nonlinear3       -0.000     0.021    -0.042     0.041    -0.021    46.746     0.983     0.782     0.461 
## birth_order_nonlinear4        0.003     0.028    -0.053     0.058     0.093    38.593     0.926     0.934     0.508 
## birth_order_nonlinear5        0.004     0.033    -0.061     0.069     0.108    61.325     0.914     0.621     0.402 
## birth_order_nonlinear5+       0.007     0.033    -0.058     0.072     0.211    58.266     0.834     0.647     0.413 
## poly(age, 3, raw = TRUE)1    -0.019     0.004    -0.027    -0.010    -4.288    21.263     0.000     1.862     0.679 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.529    27.124     0.601     1.359     0.604 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.363    34.393     0.024     1.047     0.538 
## male                         -0.011     0.012    -0.034     0.012    -0.971   106.044     0.334     0.411     0.304 
## sibling_count3                0.015     0.022    -0.027     0.058     0.717    46.142     0.477     0.791     0.464 
## sibling_count4               -0.030     0.024    -0.078     0.018    -1.243    89.697     0.217     0.464     0.332 
## sibling_count5               -0.087     0.032    -0.148    -0.025    -2.749    59.431     0.008     0.637     0.409 
## sibling_count5+              -0.173     0.030    -0.232    -0.113    -5.704    66.856     0.000     0.580     0.385 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.663 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-6" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-1" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-7" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.456     0.031     0.396     0.516    14.930    55.827     0.000     0.671     0.422 
## count_birth_order2/2          0.007     0.026    -0.044     0.059     0.281    29.932     0.780     1.214     0.576 
## count_birth_order1/3          0.022     0.034    -0.044     0.089     0.656    31.411     0.517     1.152     0.562 
## count_birth_order2/3          0.003     0.033    -0.060     0.067     0.101    29.739     0.920     1.223     0.578 
## count_birth_order3/3          0.030     0.031    -0.031     0.091     0.955    44.351     0.345     0.820     0.474 
## count_birth_order1/4         -0.025     0.044    -0.111     0.062    -0.563    38.037     0.577     0.947     0.511 
## count_birth_order2/4         -0.025     0.036    -0.096     0.047    -0.680    62.614     0.499     0.611     0.398 
## count_birth_order3/4         -0.046     0.033    -0.111     0.020    -1.363   141.034     0.175     0.338     0.263 
## count_birth_order4/4         -0.014     0.039    -0.092     0.063    -0.359    48.290     0.722     0.760     0.454 
## count_birth_order1/5         -0.069     0.048    -0.162     0.024    -1.451   222.382     0.148     0.252     0.208 
## count_birth_order2/5         -0.101     0.051    -0.201    -0.001    -1.976    54.154     0.053     0.688     0.428 
## count_birth_order3/5         -0.082     0.045    -0.170     0.006    -1.836   109.499     0.069     0.402     0.299 
## count_birth_order4/5         -0.092     0.058    -0.205     0.020    -1.607    27.066     0.120     1.362     0.605 
## count_birth_order5/5         -0.067     0.052    -0.169     0.035    -1.289    48.988     0.203     0.750     0.451 
## count_birth_order1/5+        -0.181     0.047    -0.273    -0.089    -3.859   109.316     0.000     0.402     0.300 
## count_birth_order2/5+        -0.187     0.046    -0.277    -0.096    -4.032    57.435     0.000     0.655     0.416 
## count_birth_order3/5+        -0.159     0.044    -0.246    -0.073    -3.610    57.347     0.001     0.656     0.416 
## count_birth_order4/5+        -0.167     0.044    -0.252    -0.081    -3.822    60.844     0.000     0.625     0.404 
## count_birth_order5/5+        -0.172     0.043    -0.257    -0.087    -3.981    56.204     0.000     0.667     0.420 
## count_birth_order5+/5+       -0.161     0.031    -0.223    -0.099    -5.119    94.835     0.000     0.445     0.322 
## poly(age, 3, raw = TRUE)1    -0.017     0.004    -0.026    -0.009    -4.162    25.616     0.000     1.455     0.621 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.314    31.337     0.756     1.155     0.563 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.189    37.659     0.035     0.956     0.514 
## male                         -0.013     0.012    -0.037     0.011    -1.054    80.504     0.295     0.502     0.350 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.662 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-7" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-1" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.351      10  91.065   0.964 158.430 
##  2 vs 3:   0.353       4  36.141   0.840 428.916 
##  3 vs 4:   1.273       1  23.010   0.271   0.819</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2015-old" class="section level3 tabset">
<h3>Raven 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-1" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-2" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-8" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.340     0.031     0.279     0.401    10.951    24.278     0.000     1.557     0.638 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.021    -0.006    -3.683    41.067     0.001     0.880     0.492 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.460    87.239     0.647     0.473     0.336 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.653   140.314     0.009     0.339     0.264 
## male                          0.043     0.011     0.021     0.065     3.773   125.081     0.000     0.367     0.280 
## sibling_count3                0.008     0.020    -0.031     0.046     0.382   328.664     0.703     0.198     0.171 
## sibling_count4                0.002     0.025    -0.047     0.050     0.065    96.023     0.948     0.441     0.320 
## sibling_count5                0.018     0.028    -0.036     0.072     0.660   117.045     0.511     0.384     0.289 
## sibling_count5+              -0.073     0.025    -0.122    -0.025    -2.967    39.467     0.005     0.914     0.502 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.698 
## ICC|mother_pidlink                     0.224 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-8" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-2" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-9" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.351     0.032     0.287     0.415    10.820    24.061     0.000     1.575     0.640 
## birth_order                  -0.005     0.003    -0.011     0.001    -1.644   112.783     0.103     0.394     0.295 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.021    -0.006    -3.682    41.089     0.001     0.880     0.492 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.359    93.506     0.721     0.450     0.325 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.565   152.386     0.011     0.321     0.253 
## male                          0.043     0.011     0.021     0.066     3.778   124.825     0.000     0.367     0.280 
## sibling_count3                0.011     0.020    -0.028     0.050     0.537   312.263     0.592     0.204     0.175 
## sibling_count4                0.008     0.024    -0.039     0.056     0.343   136.893     0.732     0.345     0.267 
## sibling_count5                0.028     0.028    -0.027     0.084     0.998   111.156     0.320     0.398     0.297 
## sibling_count5+              -0.051     0.025    -0.100    -0.003    -2.065   122.159     0.041     0.373     0.283 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.698 
## ICC|mother_pidlink                     0.224 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-9" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-2" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-10" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.347     0.033     0.282     0.412    10.455    29.313     0.000     1.243     0.582 
## birth_order_nonlinear2       -0.009     0.015    -0.039     0.021    -0.565   132.436     0.573     0.353     0.272 
## birth_order_nonlinear3        0.008     0.019    -0.029     0.044     0.423   157.533     0.673     0.314     0.249 
## birth_order_nonlinear4       -0.021     0.027    -0.073     0.032    -0.777    44.485     0.441     0.817     0.473 
## birth_order_nonlinear5       -0.012     0.026    -0.063     0.040    -0.451   213.191     0.653     0.259     0.213 
## birth_order_nonlinear5+      -0.039     0.023    -0.084     0.005    -1.737   336.609     0.083     0.195     0.168 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.006    -3.459    38.095     0.001     0.946     0.511 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.310    80.188     0.757     0.504     0.351 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.434   122.372     0.016     0.372     0.283 
## male                          0.043     0.011     0.021     0.066     3.775   124.572     0.000     0.368     0.280 
## sibling_count3                0.003     0.022    -0.040     0.046     0.149   135.488     0.882     0.347     0.268 
## sibling_count4                0.004     0.027    -0.048     0.057     0.157    91.638     0.875     0.456     0.328 
## sibling_count5                0.023     0.032    -0.040     0.085     0.705    69.097     0.483     0.565     0.379 
## sibling_count5+              -0.054     0.027    -0.107     0.000    -1.955    83.233     0.054     0.490     0.344 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.698 
## ICC|mother_pidlink                     0.224 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-10" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-2" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-11" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.349     0.034     0.282     0.416    10.204    40.265     0.000     0.897     0.497 
## count_birth_order2/2         -0.017     0.024    -0.063     0.029    -0.719   107.290     0.474     0.408     0.303 
## count_birth_order1/3         -0.007     0.034    -0.073     0.058    -0.217    52.860     0.829     0.702     0.434 
## count_birth_order2/3         -0.015     0.035    -0.084     0.054    -0.423    40.194     0.675     0.898     0.498 
## count_birth_order3/3          0.016     0.026    -0.035     0.068     0.619  1085.467     0.536     0.100     0.093 
## count_birth_order1/4         -0.004     0.038    -0.079     0.070    -0.117   122.939     0.907     0.371     0.282 
## count_birth_order2/4          0.021     0.037    -0.051     0.093     0.575   188.312     0.566     0.280     0.227 
## count_birth_order3/4         -0.031     0.039    -0.108     0.046    -0.783    65.324     0.436     0.590     0.390 
## count_birth_order4/4         -0.008     0.036    -0.079     0.063    -0.224    96.395     0.823     0.440     0.320 
## count_birth_order1/5          0.001     0.045    -0.088     0.090     0.032   197.209     0.975     0.272     0.221 
## count_birth_order2/5          0.027     0.046    -0.063     0.117     0.578   210.776     0.564     0.260     0.214 
## count_birth_order3/5          0.039     0.046    -0.051     0.129     0.841   111.227     0.402     0.398     0.297 
## count_birth_order4/5         -0.038     0.044    -0.124     0.047    -0.883   183.425     0.378     0.285     0.230 
## count_birth_order5/5          0.024     0.053    -0.080     0.128     0.455    30.224     0.653     1.201     0.573 
## count_birth_order1/5+        -0.051     0.040    -0.129     0.026    -1.294    66.637     0.200     0.581     0.386 
## count_birth_order2/5+        -0.079     0.039    -0.156    -0.003    -2.028    75.671     0.046     0.526     0.362 
## count_birth_order3/5+        -0.040     0.039    -0.115     0.036    -1.037    67.034     0.304     0.578     0.385 
## count_birth_order4/5+        -0.074     0.040    -0.152     0.005    -1.833    45.496     0.073     0.801     0.468 
## count_birth_order5/5+        -0.081     0.035    -0.149    -0.013    -2.340   112.326     0.021     0.395     0.295 
## count_birth_order5+/5+       -0.098     0.031    -0.159    -0.037    -3.163    35.646     0.003     1.010     0.528 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.005    -3.332    44.524     0.002     0.817     0.473 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.206    89.586     0.837     0.464     0.332 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.307   126.439     0.023     0.364     0.278 
## male                          0.043     0.011     0.021     0.066     3.752   119.574     0.000     0.378     0.286 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.698 
## ICC|mother_pidlink                     0.225 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-11" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-2" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.433      10 240.325   0.929   1.487 
##  2 vs 3:   0.298       4  68.823   0.879   2.231 
##  3 vs 4:   2.665       1  45.854   0.109   0.411</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-1" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-3" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-12" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.324     0.030     0.265     0.383    10.777    25.171     0.000     1.487     0.627 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.017    -0.003    -2.750    36.467     0.009     0.987     0.522 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.131    48.829     0.264     0.752     0.451 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.002    54.873     0.321     0.681     0.426 
## male                          0.048     0.013     0.024     0.073     3.846    64.928     0.000     0.593     0.391 
## sibling_count3                0.012     0.022    -0.031     0.054     0.535    38.507     0.595     0.936     0.508 
## sibling_count4               -0.014     0.024    -0.061     0.034    -0.568    60.693     0.572     0.626     0.404 
## sibling_count5               -0.055     0.031    -0.116     0.006    -1.760    41.220     0.086     0.877     0.491 
## sibling_count5+              -0.085     0.025    -0.134    -0.037    -3.449    73.566     0.001     0.538     0.367 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.700 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-12" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-3" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-13" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.324     0.032     0.262     0.386    10.263    27.504     0.000     1.337     0.600 
## birth_order                  -0.000     0.005    -0.009     0.009    -0.020    77.559     0.984     0.517     0.357 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.017    -0.003    -2.750    36.450     0.009     0.988     0.522 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.134    49.541     0.262     0.743     0.448 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.999    55.666     0.322     0.673     0.422 
## male                          0.048     0.013     0.024     0.073     3.847    64.928     0.000     0.593     0.391 
## sibling_count3                0.012     0.021    -0.030     0.054     0.547    43.572     0.587     0.833     0.478 
## sibling_count4               -0.014     0.024    -0.061     0.033    -0.567    80.473     0.572     0.502     0.350 
## sibling_count5               -0.055     0.031    -0.116     0.006    -1.753    53.440     0.085     0.696     0.431 
## sibling_count5+              -0.085     0.026    -0.136    -0.034    -3.268   293.932     0.001     0.212     0.181 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.700 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-13" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-3" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-14" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.323     0.034     0.256     0.389     9.480    25.747     0.000     1.446     0.620 
## birth_order_nonlinear2        0.003     0.015    -0.026     0.033     0.210   100.018     0.834     0.429     0.314 
## birth_order_nonlinear3        0.007     0.023    -0.039     0.053     0.311    32.172     0.758     1.123     0.556 
## birth_order_nonlinear4       -0.002     0.027    -0.055     0.050    -0.083    59.925     0.934     0.633     0.407 
## birth_order_nonlinear5       -0.016     0.033    -0.082     0.049    -0.483    68.201     0.631     0.571     0.381 
## birth_order_nonlinear5+      -0.016     0.029    -0.072     0.041    -0.540   460.786     0.589     0.162     0.143 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.017    -0.002    -2.572    32.630     0.015     1.106     0.552 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.020    44.232     0.313     0.822     0.474 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.065    53.113     0.292     0.700     0.433 
## male                          0.048     0.013     0.023     0.074     3.719    56.891     0.000     0.660     0.418 
## sibling_count3                0.008     0.023    -0.036     0.053     0.370    38.962     0.713     0.925     0.505 
## sibling_count4               -0.015     0.023    -0.061     0.031    -0.633   168.312     0.528     0.301     0.240 
## sibling_count5               -0.052     0.031    -0.113     0.009    -1.673    71.464     0.099     0.550     0.372 
## sibling_count5+              -0.081     0.028    -0.137    -0.026    -2.879   140.681     0.005     0.339     0.263 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.698 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-14" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-3" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-15" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.314     0.037     0.242     0.386     8.559    27.845     0.000     1.318     0.597 
## count_birth_order2/2          0.012     0.027    -0.040     0.064     0.440    32.206     0.663     1.121     0.555 
## count_birth_order1/3          0.012     0.034    -0.054     0.078     0.360    35.095     0.721     1.026     0.532 
## count_birth_order2/3         -0.000     0.034    -0.066     0.065    -0.011    28.679     0.992     1.274     0.588 
## count_birth_order3/3          0.029     0.029    -0.027     0.086     1.012    80.620     0.314     0.502     0.350 
## count_birth_order1/4         -0.015     0.035    -0.084     0.053    -0.430   395.465     0.667     0.178     0.155 
## count_birth_order2/4         -0.003     0.040    -0.082     0.076    -0.072    41.079     0.943     0.880     0.492 
## count_birth_order3/4         -0.028     0.042    -0.110     0.054    -0.666    35.337     0.509     1.019     0.531 
## count_birth_order4/4          0.001     0.039    -0.076     0.078     0.021    55.022     0.983     0.679     0.425 
## count_birth_order1/5         -0.039     0.055    -0.147     0.069    -0.706    63.080     0.483     0.607     0.397 
## count_birth_order2/5         -0.048     0.053    -0.152     0.056    -0.902    49.777     0.371     0.740     0.447 
## count_birth_order3/5         -0.034     0.047    -0.126     0.059    -0.712    81.531     0.479     0.498     0.348 
## count_birth_order4/5         -0.070     0.066    -0.199     0.058    -1.071    20.534     0.297     1.959     0.691 
## count_birth_order5/5         -0.072     0.056    -0.181     0.038    -1.286    39.250     0.206     0.919     0.504 
## count_birth_order1/5+        -0.095     0.051    -0.195     0.005    -1.868    66.421     0.066     0.583     0.386 
## count_birth_order2/5+        -0.080     0.050    -0.179     0.018    -1.593    41.296     0.119     0.876     0.491 
## count_birth_order3/5+        -0.064     0.056    -0.173     0.046    -1.137    24.313     0.266     1.554     0.637 
## count_birth_order4/5+        -0.089     0.046    -0.180     0.001    -1.944    49.679     0.058     0.741     0.447 
## count_birth_order5/5+        -0.097     0.043    -0.182    -0.012    -2.233    62.111     0.029     0.615     0.400 
## count_birth_order5+/5+       -0.095     0.034    -0.163    -0.028    -2.777    56.321     0.007     0.666     0.420 
## poly(age, 3, raw = TRUE)1    -0.009     0.004    -0.016    -0.001    -2.270    35.983     0.029     1.000     0.526 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.214    49.178     0.231     0.748     0.450 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.906    57.449     0.368     0.655     0.416 
## male                          0.047     0.013     0.022     0.072     3.715    71.642     0.000     0.549     0.372 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.697 
## ICC|mother_pidlink                     0.226 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-15" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-3" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.385      10  91.063   0.950 158.636 
##  2 vs 3:   0.402       4  36.141   0.806 428.931 
##  3 vs 4:   0.000       1  35.081   0.988   0.521</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-1" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2015-old" class="section level3 tabset">
<h3>Numeracy 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-2" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-4" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-16" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.306     0.030     0.247     0.365    10.161    28.552     0.000     1.280     0.589 
## poly(age, 3, raw = TRUE)1    -0.008     0.003    -0.015    -0.001    -2.247    65.607     0.028     0.588     0.389 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.188   107.515     0.851     0.407     0.302 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.868    84.836     0.388     0.483     0.341 
## male                         -0.075     0.014    -0.102    -0.048    -5.398    42.436     0.000     0.854     0.484 
## sibling_count3                0.004     0.023    -0.040     0.049     0.188    69.434     0.851     0.563     0.378 
## sibling_count4               -0.032     0.024    -0.079     0.014    -1.365   160.877     0.174     0.310     0.246 
## sibling_count5               -0.019     0.030    -0.079     0.041    -0.626    56.091     0.534     0.668     0.421 
## sibling_count5+              -0.147     0.021    -0.188    -0.106    -7.002   127.480     0.000     0.362     0.277 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.179 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-16" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-4" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-17" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.315     0.034     0.248     0.381     9.302    23.157     0.000     1.655     0.652 
## birth_order                  -0.004     0.004    -0.011     0.003    -1.044    37.231     0.303     0.967     0.517 
## poly(age, 3, raw = TRUE)1    -0.008     0.003    -0.015    -0.001    -2.248    65.567     0.028     0.589     0.389 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.259   112.688     0.796     0.394     0.295 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.806    86.664     0.423     0.475     0.337 
## male                         -0.075     0.014    -0.102    -0.048    -5.396    42.513     0.000     0.852     0.484 
## sibling_count3                0.007     0.023    -0.038     0.051     0.297    75.489     0.767     0.527     0.362 
## sibling_count4               -0.027     0.024    -0.073     0.019    -1.159   223.951     0.248     0.251     0.208 
## sibling_count5               -0.011     0.032    -0.073     0.051    -0.353    49.748     0.726     0.740     0.447 
## sibling_count5+              -0.129     0.024    -0.177    -0.082    -5.373   200.642     0.000     0.269     0.220 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.171 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.179 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-17" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-4" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-18" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.313     0.035     0.244     0.381     8.898    26.811     0.000     1.377     0.608 
## birth_order_nonlinear2       -0.011     0.022    -0.055     0.033    -0.490    23.598     0.628     1.615     0.646 
## birth_order_nonlinear3       -0.000     0.022    -0.043     0.043    -0.012    57.170     0.990     0.658     0.417 
## birth_order_nonlinear4       -0.001     0.033    -0.065     0.063    -0.033    25.572     0.974     1.459     0.622 
## birth_order_nonlinear5        0.012     0.037    -0.060     0.085     0.340    29.279     0.737     1.244     0.582 
## birth_order_nonlinear5+      -0.011     0.030    -0.071     0.048    -0.374    37.913     0.710     0.950     0.512 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.001    -2.262    79.444     0.026     0.507     0.353 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.158   117.913     0.875     0.382     0.288 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.878    82.517     0.382     0.493     0.346 
## male                         -0.075     0.014    -0.102    -0.048    -5.408    42.748     0.000     0.848     0.482 
## sibling_count3                0.002     0.023    -0.042     0.047     0.100   107.548     0.920     0.407     0.302 
## sibling_count4               -0.035     0.025    -0.084     0.013    -1.416   282.859     0.158     0.217     0.184 
## sibling_count5               -0.025     0.034    -0.092     0.041    -0.752    51.709     0.455     0.716     0.438 
## sibling_count5+              -0.147     0.027    -0.200    -0.094    -5.430   107.691     0.000     0.407     0.302 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.179 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-18" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-4" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-19" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.300     0.038     0.226     0.374     7.944    30.844     0.000     1.175     0.567 
## count_birth_order2/2          0.007     0.026    -0.044     0.059     0.277    70.148     0.782     0.558     0.376 
## count_birth_order1/3          0.027     0.037    -0.046     0.100     0.724    37.371     0.474     0.964     0.516 
## count_birth_order2/3         -0.014     0.038    -0.088     0.059    -0.383    35.982     0.704     1.000     0.526 
## count_birth_order3/3          0.010     0.031    -0.051     0.072     0.327    87.268     0.744     0.473     0.336 
## count_birth_order1/4         -0.026     0.036    -0.096     0.045    -0.717   524.796     0.474     0.151     0.134 
## count_birth_order2/4         -0.035     0.039    -0.111     0.042    -0.888   135.429     0.376     0.347     0.269 
## count_birth_order3/4         -0.033     0.043    -0.118     0.052    -0.762    45.947     0.450     0.794     0.465 
## count_birth_order4/4         -0.024     0.040    -0.102     0.053    -0.614    61.551     0.542     0.619     0.402 
## count_birth_order1/5         -0.046     0.050    -0.145     0.053    -0.909    91.106     0.366     0.458     0.329 
## count_birth_order2/5         -0.037     0.051    -0.137     0.062    -0.735    99.144     0.464     0.431     0.315 
## count_birth_order3/5          0.008     0.046    -0.083     0.098     0.166   153.596     0.868     0.319     0.252 
## count_birth_order4/5         -0.032     0.052    -0.134     0.070    -0.609    52.417     0.545     0.708     0.436 
## count_birth_order5/5          0.015     0.048    -0.080     0.109     0.304    53.048     0.762     0.700     0.433 
## count_birth_order1/5+        -0.125     0.037    -0.197    -0.052    -3.357   177.547     0.001     0.291     0.234 
## count_birth_order2/5+        -0.151     0.039    -0.228    -0.075    -3.869   106.306     0.000     0.410     0.304 
## count_birth_order3/5+        -0.144     0.044    -0.230    -0.058    -3.281    39.690     0.002     0.909     0.501 
## count_birth_order4/5+        -0.135     0.039    -0.211    -0.058    -3.448    66.186     0.001     0.584     0.387 
## count_birth_order5/5+        -0.138     0.036    -0.209    -0.067    -3.798   104.183     0.000     0.416     0.307 
## count_birth_order5+/5+       -0.150     0.026    -0.201    -0.099    -5.775   131.031     0.000     0.355     0.273 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014    -0.000    -2.024    84.379     0.046     0.485     0.342 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.308   148.557     0.759     0.326     0.256 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.754    97.829     0.452     0.435     0.317 
## male                         -0.075     0.014    -0.102    -0.048    -5.430    43.215     0.000     0.839     0.480 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.784 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-19" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-4" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.398      10 243.569   0.947   1.461 
##  2 vs 3:   0.154       4  63.182   0.960   2.624 
##  3 vs 4:   1.082       1  20.146   0.311   0.976</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-2" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-5" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-20" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.304     0.026     0.253     0.355    11.642    46.776     0.000     0.781     0.461 
## poly(age, 3, raw = TRUE)1    -0.009     0.004    -0.016    -0.002    -2.401    32.661     0.022     1.105     0.552 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.098    40.175     0.922     0.899     0.498 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.008    44.531     0.319     0.817     0.473 
## male                         -0.071     0.014    -0.098    -0.044    -5.133    47.861     0.000     0.766     0.456 
## sibling_count3                0.007     0.020    -0.032     0.047     0.364    62.565     0.717     0.611     0.398 
## sibling_count4               -0.029     0.022    -0.073     0.014    -1.335   150.723     0.184     0.323     0.254 
## sibling_count5               -0.089     0.026    -0.140    -0.038    -3.431   184.509     0.001     0.283     0.229 
## sibling_count5+              -0.146     0.024    -0.194    -0.099    -6.023    84.488     0.000     0.485     0.342 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.173 
## Residual~~Residual                     0.783 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-20" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-5" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-21" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.291     0.031     0.231     0.352     9.413    31.728     0.000     1.140     0.560 
## birth_order                   0.006     0.006    -0.006     0.018     0.976    26.020     0.338     1.428     0.617 
## poly(age, 3, raw = TRUE)1    -0.009     0.004    -0.016    -0.002    -2.381    32.601     0.023     1.107     0.552 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.034    39.132     0.973     0.921     0.504 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.077    42.717     0.288     0.848     0.483 
## male                         -0.071     0.014    -0.098    -0.044    -5.136    48.056     0.000     0.763     0.455 
## sibling_count3                0.004     0.020    -0.035     0.043     0.179    72.357     0.859     0.545     0.370 
## sibling_count4               -0.037     0.025    -0.086     0.011    -1.497    69.501     0.139     0.562     0.378 
## sibling_count5               -0.101     0.031    -0.161    -0.041    -3.288    63.100     0.002     0.607     0.396 
## sibling_count5+              -0.166     0.030    -0.226    -0.107    -5.502    63.708     0.000     0.602     0.395 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.173 
## Residual~~Residual                     0.783 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-21" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-5" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-22" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.302     0.032     0.240     0.365     9.501    35.010     0.000     1.028     0.533 
## birth_order_nonlinear2       -0.001     0.023    -0.046     0.043    -0.051    20.893     0.960     1.910     0.685 
## birth_order_nonlinear3        0.015     0.024    -0.032     0.062     0.623    35.870     0.537     1.004     0.527 
## birth_order_nonlinear4        0.021     0.036    -0.050     0.092     0.575    22.710     0.571     1.699     0.658 
## birth_order_nonlinear5        0.021     0.036    -0.049     0.091     0.582    60.298     0.563     0.630     0.406 
## birth_order_nonlinear5+       0.014     0.045    -0.074     0.101     0.306    24.015     0.762     1.578     0.641 
## poly(age, 3, raw = TRUE)1    -0.009     0.004    -0.016    -0.002    -2.433    38.489     0.020     0.936     0.508 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.053    47.895     0.958     0.765     0.456 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.183    52.043     0.242     0.712     0.437 
## male                         -0.070     0.014    -0.098    -0.043    -5.040    48.700     0.000     0.754     0.452 
## sibling_count3               -0.001     0.020    -0.040     0.038    -0.036   104.134     0.971     0.416     0.307 
## sibling_count4               -0.043     0.026    -0.093     0.007    -1.685    79.613     0.096     0.507     0.352 
## sibling_count5               -0.106     0.031    -0.166    -0.046    -3.454    94.146     0.001     0.448     0.323 
## sibling_count5+              -0.165     0.031    -0.225    -0.105    -5.407    77.803     0.000     0.515     0.356 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-22" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-5" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-23" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.292     0.035     0.224     0.360     8.404    36.977     0.000     0.974     0.519 
## count_birth_order2/2          0.013     0.028    -0.042     0.068     0.456    30.794     0.652     1.177     0.568 
## count_birth_order1/3          0.016     0.031    -0.045     0.078     0.517    60.192     0.607     0.630     0.406 
## count_birth_order2/3         -0.009     0.036    -0.079     0.061    -0.251    26.748     0.803     1.381     0.608 
## count_birth_order3/3          0.024     0.034    -0.043     0.090     0.700    39.061     0.488     0.923     0.505 
## count_birth_order1/4         -0.033     0.045    -0.122     0.056    -0.727    42.723     0.471     0.848     0.483 
## count_birth_order2/4         -0.043     0.039    -0.121     0.034    -1.098    53.260     0.277     0.698     0.432 
## count_birth_order3/4         -0.030     0.034    -0.098     0.037    -0.884   209.989     0.378     0.261     0.214 
## count_birth_order4/4         -0.011     0.047    -0.102     0.080    -0.237    30.509     0.814     1.189     0.570 
## count_birth_order1/5         -0.076     0.049    -0.173     0.021    -1.536   337.615     0.126     0.195     0.168 
## count_birth_order2/5         -0.114     0.049    -0.209    -0.018    -2.327   125.054     0.022     0.367     0.280 
## count_birth_order3/5         -0.079     0.051    -0.178     0.021    -1.554    62.806     0.125     0.609     0.397 
## count_birth_order4/5         -0.104     0.055    -0.211     0.003    -1.902    40.167     0.064     0.899     0.498 
## count_birth_order5/5         -0.070     0.055    -0.178     0.038    -1.272    50.701     0.209     0.728     0.443 
## count_birth_order1/5+        -0.213     0.054    -0.318    -0.107    -3.959    60.486     0.000     0.628     0.405 
## count_birth_order2/5+        -0.163     0.058    -0.278    -0.049    -2.794    27.116     0.009     1.359     0.604 
## count_birth_order3/5+        -0.143     0.047    -0.236    -0.050    -3.026    53.157     0.004     0.699     0.432 
## count_birth_order4/5+        -0.118     0.040    -0.198    -0.039    -2.937   231.676     0.004     0.245     0.204 
## count_birth_order5/5+        -0.140     0.040    -0.219    -0.061    -3.481   174.379     0.001     0.294     0.236 
## count_birth_order5+/5+       -0.146     0.043    -0.231    -0.061    -3.352    24.249     0.003     1.559     0.638 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.016    -0.001    -2.237    49.655     0.030     0.741     0.448 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.139    69.089     0.890     0.565     0.379 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.078    78.979     0.285     0.510     0.354 
## male                         -0.071     0.015    -0.100    -0.043    -4.879    41.167     0.000     0.878     0.492 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.784 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-23" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-5" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.408      10  91.064   0.940 158.511 
##  2 vs 3:   0.360       4  36.141   0.836 429.309 
##  3 vs 4:   0.967       1  16.067   0.340   1.405</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-2" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
</div>
<div id="counting-backwards" class="section level3 tabset">
<h3>Counting Backwards</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = count_backwards)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-3" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-6" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-24" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.097     0.029     0.040     0.154     3.335    33.572     0.002     1.074     0.544 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.530    36.913     0.599     0.975     0.519 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.494    60.403     0.140     0.629     0.405 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.901    70.244     0.371     0.557     0.375 
## male                          0.000     0.013    -0.025     0.026     0.032    77.746     0.974     0.516     0.357 
## sibling_count3               -0.009     0.021    -0.051     0.032    -0.435   134.302     0.665     0.349     0.270 
## sibling_count4               -0.003     0.025    -0.052     0.045    -0.133   110.181     0.895     0.400     0.298 
## sibling_count5               -0.010     0.025    -0.059     0.039    -0.393   784.343     0.694     0.120     0.109 
## sibling_count5+              -0.106     0.021    -0.147    -0.065    -5.057   135.123     0.000     0.348     0.269 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.827 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-24" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-6" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-25" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.109     0.029     0.053     0.165     3.807    43.082     0.000     0.842     0.481 
## birth_order                  -0.005     0.004    -0.012     0.002    -1.467    42.290     0.150     0.856     0.485 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.527    36.909     0.601     0.976     0.519 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.583    62.347     0.118     0.613     0.399 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.987    74.139     0.327     0.535     0.365 
## male                          0.000     0.013    -0.025     0.026     0.038    77.619     0.970     0.516     0.357 
## sibling_count3               -0.006     0.022    -0.048     0.036    -0.274   121.802     0.785     0.373     0.283 
## sibling_count4                0.004     0.025    -0.046     0.054     0.151    97.006     0.880     0.438     0.319 
## sibling_count5                0.001     0.026    -0.050     0.051     0.036   645.929     0.971     0.134     0.121 
## sibling_count5+              -0.082     0.025    -0.131    -0.033    -3.290   138.002     0.001     0.343     0.266 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.827 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-25" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-6" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-26" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.113     0.031     0.052     0.174     3.614    43.749     0.001     0.830     0.477 
## birth_order_nonlinear2       -0.010     0.018    -0.045     0.026    -0.545    60.795     0.588     0.625     0.404 
## birth_order_nonlinear3       -0.036     0.023    -0.081     0.009    -1.563    50.554     0.124     0.730     0.444 
## birth_order_nonlinear4       -0.041     0.030    -0.099     0.017    -1.384    38.838     0.174     0.928     0.506 
## birth_order_nonlinear5       -0.045     0.034    -0.113     0.022    -1.313    40.914     0.197     0.883     0.493 
## birth_order_nonlinear5+      -0.052     0.033    -0.115     0.012    -1.584    31.282     0.123     1.157     0.563 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.009     0.235    33.886     0.816     1.063     0.542 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.262    49.765     0.213     0.740     0.447 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.733    58.215     0.467     0.648     0.413 
## male                          0.001     0.013    -0.025     0.026     0.039    74.934     0.969     0.530     0.363 
## sibling_count3                0.003     0.023    -0.041     0.048     0.147   115.348     0.883     0.388     0.292 
## sibling_count4                0.018     0.025    -0.032     0.067     0.701   241.429     0.484     0.239     0.200 
## sibling_count5                0.017     0.027    -0.036     0.071     0.638  1068.716     0.524     0.101     0.093 
## sibling_count5+              -0.067     0.028    -0.122    -0.011    -2.365    82.517     0.020     0.493     0.346 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.827 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-26" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-6" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-27" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.103     0.035     0.035     0.172     2.954    44.362     0.005     0.820     0.474 
## count_birth_order2/2          0.001     0.030    -0.058     0.060     0.044    37.827     0.965     0.952     0.513 
## count_birth_order1/3          0.010     0.031    -0.051     0.071     0.320   144.517     0.749     0.333     0.260 
## count_birth_order2/3         -0.011     0.031    -0.072     0.049    -0.368   154.044     0.713     0.319     0.251 
## count_birth_order3/3         -0.020     0.036    -0.090     0.051    -0.541    40.966     0.591     0.882     0.493 
## count_birth_order1/4          0.041     0.043    -0.042     0.125     0.965    68.345     0.338     0.570     0.381 
## count_birth_order2/4          0.000     0.042    -0.082     0.083     0.003    75.701     0.998     0.526     0.361 
## count_birth_order3/4         -0.030     0.040    -0.109     0.050    -0.731    76.838     0.467     0.520     0.359 
## count_birth_order4/4         -0.008     0.041    -0.088     0.071    -0.205    59.855     0.838     0.633     0.407 
## count_birth_order1/5          0.001     0.047    -0.091     0.092     0.014   284.976     0.989     0.216     0.183 
## count_birth_order2/5          0.042     0.057    -0.070     0.154     0.738    49.093     0.464     0.749     0.450 
## count_birth_order3/5         -0.000     0.048    -0.094     0.093    -0.007   129.264     0.994     0.358     0.275 
## count_birth_order4/5         -0.033     0.051    -0.133     0.067    -0.652    66.797     0.517     0.580     0.385 
## count_birth_order5/5         -0.027     0.044    -0.113     0.059    -0.621   123.100     0.536     0.371     0.282 
## count_birth_order1/5+        -0.055     0.042    -0.136     0.027    -1.316    69.837     0.193     0.560     0.377 
## count_birth_order2/5+        -0.074     0.038    -0.148    -0.001    -1.979   211.378     0.049     0.260     0.214 
## count_birth_order3/5+        -0.104     0.040    -0.182    -0.026    -2.603    76.292     0.011     0.523     0.360 
## count_birth_order4/5+        -0.104     0.040    -0.182    -0.026    -2.621    65.854     0.011     0.587     0.388 
## count_birth_order5/5+        -0.104     0.039    -0.181    -0.027    -2.661    64.894     0.010     0.593     0.391 
## count_birth_order5+/5+       -0.113     0.028    -0.169    -0.058    -4.014    69.459     0.000     0.562     0.378 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.007     0.010     0.372    30.362     0.712     1.195     0.572 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.321    40.064     0.194     0.901     0.498 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.825    47.562     0.413     0.770     0.457 
## male                          0.000     0.013    -0.025     0.026     0.026    73.107     0.980     0.541     0.368 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.827 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-27" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-6" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.238      10 222.593   0.992   1.645 
##  2 vs 3:   0.497       4  66.190   0.738   2.397 
##  3 vs 4:   2.160       1  22.355   0.156   0.849</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-3" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-7" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-28" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.090     0.031     0.030     0.151     2.929    26.327     0.007     1.408     0.613 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.009     0.465    36.259     0.645     0.993     0.524 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.800    81.392     0.076     0.498     0.348 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.360   138.669     0.176     0.342     0.265 
## male                          0.004     0.013    -0.020     0.029     0.357   113.726     0.721     0.391     0.294 
## sibling_count3                0.003     0.022    -0.041     0.047     0.132    38.344     0.896     0.940     0.509 
## sibling_count4               -0.018     0.022    -0.060     0.025    -0.807   210.891     0.421     0.260     0.214 
## sibling_count5               -0.054     0.032    -0.117     0.009    -1.666    38.644     0.104     0.933     0.507 
## sibling_count5+              -0.129     0.028    -0.185    -0.073    -4.518    35.077     0.000     1.026     0.532 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.161 
## Residual~~Residual                     0.829 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-28" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-7" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-29" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.096     0.030     0.037     0.154     3.218    39.245     0.003     0.919     0.504 
## birth_order                  -0.003     0.005    -0.013     0.007    -0.518    53.776     0.607     0.692     0.430 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.009     0.457    36.563     0.650     0.985     0.522 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.822    79.205     0.072     0.508     0.353 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.394   135.937     0.165     0.346     0.268 
## male                          0.004     0.013    -0.020     0.029     0.357   113.597     0.722     0.392     0.294 
## sibling_count3                0.005     0.022    -0.039     0.048     0.209    41.473     0.836     0.872     0.490 
## sibling_count4               -0.014     0.023    -0.059     0.031    -0.612   145.902     0.541     0.330     0.258 
## sibling_count5               -0.048     0.032    -0.112     0.015    -1.505    49.890     0.139     0.738     0.446 
## sibling_count5+              -0.120     0.034    -0.186    -0.054    -3.555    37.894     0.001     0.951     0.512 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.161 
## Residual~~Residual                     0.829 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-29" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-7" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-30" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.112     0.032     0.049     0.176     3.457    34.394     0.001     1.047     0.538 
## birth_order_nonlinear2       -0.022     0.018    -0.059     0.014    -1.218    43.185     0.230     0.840     0.480 
## birth_order_nonlinear3       -0.037     0.022    -0.079     0.005    -1.706    72.126     0.092     0.546     0.370 
## birth_order_nonlinear4       -0.031     0.032    -0.094     0.032    -0.966    34.904     0.341     1.032     0.534 
## birth_order_nonlinear5       -0.028     0.035    -0.096     0.041    -0.785    84.086     0.434     0.486     0.343 
## birth_order_nonlinear5+      -0.029     0.037    -0.102     0.044    -0.774    50.937     0.442     0.725     0.442 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.008     0.142    34.831     0.888     1.034     0.534 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.403    59.025     0.166     0.641     0.410 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.031    86.652     0.306     0.476     0.337 
## male                          0.005     0.013    -0.020     0.029     0.359   115.268     0.720     0.388     0.292 
## sibling_count3                0.012     0.023    -0.033     0.057     0.517    43.779     0.608     0.830     0.477 
## sibling_count4               -0.005     0.024    -0.052     0.041    -0.222   194.525     0.825     0.274     0.223 
## sibling_count5               -0.037     0.031    -0.098     0.024    -1.189    85.116     0.238     0.482     0.340 
## sibling_count5+              -0.111     0.037    -0.183    -0.040    -3.049    31.988     0.005     1.130     0.557 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.160 
## Residual~~Residual                     0.828 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-30" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-7" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-31" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.097     0.035     0.027     0.166     2.734    36.615     0.010     0.983     0.521 
## count_birth_order2/2         -0.003     0.030    -0.062     0.057    -0.096    26.311     0.924     1.409     0.613 
## count_birth_order1/3          0.025     0.031    -0.036     0.086     0.811    72.286     0.420     0.545     0.370 
## count_birth_order2/3         -0.014     0.028    -0.070     0.041    -0.502    89.214     0.617     0.465     0.332 
## count_birth_order3/3         -0.009     0.034    -0.076     0.058    -0.258    39.754     0.798     0.908     0.500 
## count_birth_order1/4          0.010     0.052    -0.091     0.112     0.201    28.041     0.842     1.307     0.594 
## count_birth_order2/4         -0.014     0.038    -0.088     0.060    -0.370    83.807     0.712     0.487     0.343 
## count_birth_order3/4         -0.045     0.040    -0.123     0.032    -1.149    61.289     0.255     0.621     0.402 
## count_birth_order4/4         -0.029     0.035    -0.097     0.040    -0.821   391.480     0.412     0.179     0.156 
## count_birth_order1/5         -0.008     0.064    -0.133     0.118    -0.118    38.924     0.907     0.926     0.506 
## count_birth_order2/5         -0.067     0.053    -0.170     0.036    -1.273    75.313     0.207     0.528     0.362 
## count_birth_order3/5         -0.088     0.046    -0.177     0.002    -1.925   214.776     0.056     0.257     0.212 
## count_birth_order4/5         -0.046     0.055    -0.154     0.062    -0.829    42.248     0.412     0.857     0.485 
## count_birth_order5/5         -0.061     0.060    -0.178     0.055    -1.028    37.972     0.310     0.949     0.512 
## count_birth_order1/5+        -0.102     0.057    -0.213     0.009    -1.800    49.438     0.078     0.744     0.449 
## count_birth_order2/5+        -0.149     0.048    -0.243    -0.054    -3.095    74.219     0.003     0.534     0.365 
## count_birth_order3/5+        -0.116     0.049    -0.212    -0.021    -2.389    49.690     0.021     0.741     0.447 
## count_birth_order4/5+        -0.149     0.063    -0.272    -0.026    -2.382    21.025     0.027     1.892     0.683 
## count_birth_order5/5+        -0.129     0.050    -0.227    -0.031    -2.570    38.677     0.014     0.932     0.507 
## count_birth_order5+/5+       -0.134     0.038    -0.208    -0.059    -3.493    38.611     0.001     0.933     0.508 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.387    34.730     0.701     1.037     0.535 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.527    49.411     0.133     0.745     0.449 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.137    67.300     0.260     0.577     0.384 
## male                          0.003     0.013    -0.022     0.029     0.253    90.072     0.801     0.462     0.331 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.160 
## Residual~~Residual                     0.828 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-31" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-7" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.430      10  91.065   0.928 158.404 
##  2 vs 3:   0.436       4  36.141   0.781 428.977 
##  3 vs 4:   0.269       1  26.495   0.608   0.694</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-3" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
</div>
</div>
<div id="delayed-word-recall" class="section level3 tabset">
<h3>Delayed Word Recall</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = words_delayed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-4" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-8" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-32" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.534     0.034     0.468     0.600    15.905    19.380     0.000     2.139     0.710 
## poly(age, 3, raw = TRUE)1    -0.028     0.004    -0.036    -0.021    -7.414    33.328     0.000     1.082     0.546 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.473    49.938     0.017     0.738     0.446 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.527    80.130     0.001     0.504     0.351 
## male                         -0.044     0.011    -0.065    -0.023    -4.095   333.667     0.000     0.197     0.169 
## sibling_count3                0.009     0.021    -0.032     0.051     0.444    66.057     0.658     0.585     0.387 
## sibling_count4                0.012     0.024    -0.036     0.060     0.482    61.778     0.632     0.617     0.401 
## sibling_count5               -0.002     0.025    -0.052     0.047    -0.096   123.155     0.924     0.370     0.282 
## sibling_count5+              -0.056     0.021    -0.097    -0.014    -2.642    63.389     0.010     0.605     0.396 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-32" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-8" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-33" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.537     0.035     0.468     0.607    15.170    18.848     0.000     2.236     0.719 
## birth_order                  -0.001     0.003    -0.007     0.004    -0.499   125.938     0.619     0.365     0.279 
## poly(age, 3, raw = TRUE)1    -0.028     0.004    -0.036    -0.021    -7.411    33.254     0.000     1.084     0.547 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.460    51.210     0.017     0.722     0.441 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.513    82.110     0.001     0.495     0.347 
## male                         -0.044     0.011    -0.065    -0.023    -4.092   331.258     0.000     0.197     0.170 
## sibling_count3                0.010     0.021    -0.031     0.052     0.489    69.903     0.627     0.560     0.376 
## sibling_count4                0.014     0.025    -0.034     0.062     0.560    67.538     0.577     0.575     0.383 
## sibling_count5                0.000     0.026    -0.051     0.052     0.018   111.739     0.985     0.396     0.296 
## sibling_count5+              -0.049     0.024    -0.096    -0.002    -2.061   100.545     0.042     0.427     0.313 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-33" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-8" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-34" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.533     0.034     0.467     0.600    15.720    25.731     0.000     1.447     0.620 
## birth_order_nonlinear2        0.003     0.018    -0.032     0.038     0.169    47.859     0.866     0.766     0.456 
## birth_order_nonlinear3       -0.005     0.023    -0.051     0.041    -0.232    37.177     0.818     0.969     0.517 
## birth_order_nonlinear4       -0.000     0.030    -0.059     0.058    -0.016    30.502     0.987     1.189     0.570 
## birth_order_nonlinear5        0.003     0.030    -0.056     0.062     0.100    65.957     0.921     0.586     0.388 
## birth_order_nonlinear5+      -0.017     0.026    -0.069     0.035    -0.632    66.122     0.529     0.585     0.387 
## poly(age, 3, raw = TRUE)1    -0.028     0.004    -0.036    -0.020    -6.992    30.657     0.000     1.183     0.569 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.280    42.588     0.028     0.851     0.483 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.291    63.871     0.002     0.601     0.394 
## male                         -0.044     0.011    -0.066    -0.023    -4.099   333.322     0.000     0.197     0.169 
## sibling_count3                0.012     0.022    -0.030     0.055     0.561    86.243     0.576     0.477     0.338 
## sibling_count4                0.015     0.028    -0.039     0.069     0.528    50.338     0.600     0.733     0.444 
## sibling_count5               -0.000     0.031    -0.061     0.060    -0.014    59.646     0.989     0.635     0.408 
## sibling_count5+              -0.046     0.027    -0.098     0.006    -1.717    72.584     0.090     0.544     0.369 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-34" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-8" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-35" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.535     0.033     0.470     0.601    15.990    40.860     0.000     0.884     0.494 
## count_birth_order2/2          0.001     0.031    -0.060     0.062     0.031    29.166     0.975     1.250     0.583 
## count_birth_order1/3          0.016     0.035    -0.053     0.084     0.450    40.796     0.655     0.886     0.494 
## count_birth_order2/3          0.008     0.028    -0.047     0.063     0.272   289.766     0.786     0.214     0.182 
## count_birth_order3/3          0.008     0.030    -0.050     0.066     0.264   101.285     0.793     0.425     0.312 
## count_birth_order1/4          0.010     0.043    -0.073     0.094     0.244    47.279     0.808     0.774     0.459 
## count_birth_order2/4          0.044     0.039    -0.031     0.120     1.146    96.332     0.255     0.440     0.320 
## count_birth_order3/4         -0.002     0.035    -0.069     0.066    -0.052   231.192     0.959     0.246     0.204 
## count_birth_order4/4          0.003     0.037    -0.069     0.074     0.072    81.623     0.943     0.497     0.348 
## count_birth_order1/5         -0.029     0.047    -0.121     0.062    -0.627   130.631     0.531     0.356     0.274 
## count_birth_order2/5          0.010     0.049    -0.086     0.105     0.200   101.341     0.842     0.425     0.311 
## count_birth_order3/5          0.002     0.048    -0.092     0.095     0.036    75.581     0.971     0.527     0.362 
## count_birth_order4/5         -0.005     0.039    -0.082     0.072    -0.127  2960.685     0.899     0.058     0.056 
## count_birth_order5/5          0.012     0.041    -0.068     0.093     0.301   132.027     0.764     0.353     0.272 
## count_birth_order1/5+        -0.039     0.040    -0.118     0.040    -0.960    57.276     0.341     0.657     0.416 
## count_birth_order2/5+        -0.058     0.035    -0.127     0.012    -1.633   231.963     0.104     0.245     0.204 
## count_birth_order3/5+        -0.051     0.039    -0.127     0.025    -1.308    59.638     0.196     0.635     0.408 
## count_birth_order4/5+        -0.035     0.035    -0.104     0.033    -1.008   119.820     0.316     0.378     0.286 
## count_birth_order5/5+        -0.050     0.031    -0.111     0.010    -1.623   865.321     0.105     0.114     0.104 
## count_birth_order5+/5+       -0.063     0.027    -0.116    -0.011    -2.373    64.959     0.021     0.593     0.391 
## poly(age, 3, raw = TRUE)1    -0.028     0.004    -0.037    -0.020    -6.751    30.239     0.000     1.200     0.573 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.169    35.937     0.037     1.002     0.526 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.127    49.736     0.003     0.740     0.447 
## male                         -0.044     0.011    -0.066    -0.023    -4.119   349.610     0.000     0.191     0.165 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-35" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-8" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.268      10 227.645   0.987   1.596 
##  2 vs 3:   0.301       4  63.578   0.876   2.591 
##  3 vs 4:   0.244       1  51.719   0.623   0.372</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-4" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-9" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-36" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.527     0.032     0.465     0.590    16.487    20.481     0.000     1.966     0.692 
## poly(age, 3, raw = TRUE)1    -0.027     0.004    -0.035    -0.019    -6.880    25.278     0.000     1.479     0.625 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.720    25.556     0.098     1.460     0.622 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.621    25.524     0.015     1.462     0.622 
## male                         -0.045     0.012    -0.068    -0.022    -3.907   156.458     0.000     0.316     0.249 
## sibling_count3                0.026     0.018    -0.009     0.061     1.436    85.337     0.155     0.481     0.340 
## sibling_count4               -0.001     0.024    -0.048     0.045    -0.054    47.499     0.957     0.771     0.458 
## sibling_count5               -0.023     0.027    -0.075     0.029    -0.866    73.907     0.390     0.536     0.366 
## sibling_count5+              -0.058     0.021    -0.100    -0.017    -2.762   149.195     0.006     0.326     0.256 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.758 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-36" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-9" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-37" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.516     0.034     0.450     0.582    15.384    21.878     0.000     1.788     0.670 
## birth_order                   0.006     0.005    -0.004     0.015     1.176    59.527     0.244     0.636     0.408 
## poly(age, 3, raw = TRUE)1    -0.027     0.004    -0.035    -0.019    -6.871    25.370     0.000     1.473     0.624 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.761    25.357     0.090     1.474     0.624 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.665    25.253     0.013     1.481     0.626 
## male                         -0.045     0.012    -0.068    -0.022    -3.909   158.764     0.000     0.312     0.248 
## sibling_count3                0.022     0.018    -0.013     0.058     1.253   103.690     0.213     0.418     0.308 
## sibling_count4               -0.008     0.025    -0.058     0.041    -0.334    41.645     0.740     0.869     0.489 
## sibling_count5               -0.034     0.029    -0.092     0.024    -1.145    52.433     0.257     0.707     0.435 
## sibling_count5+              -0.077     0.027    -0.129    -0.025    -2.913   102.415     0.004     0.421     0.310 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.114 
## Residual~~Residual                     0.758 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-37" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-9" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-38" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.527     0.032     0.464     0.591    16.245    27.404     0.000     1.342     0.601 
## birth_order_nonlinear2        0.002     0.017    -0.031     0.035     0.118    55.875     0.907     0.670     0.422 
## birth_order_nonlinear3        0.009     0.022    -0.034     0.052     0.411    45.354     0.683     0.803     0.468 
## birth_order_nonlinear4        0.004     0.028    -0.049     0.058     0.163    57.023     0.871     0.659     0.417 
## birth_order_nonlinear5       -0.003     0.033    -0.068     0.062    -0.094    90.242     0.925     0.462     0.330 
## birth_order_nonlinear5+       0.021     0.034    -0.046     0.087     0.609    66.602     0.545     0.581     0.386 
## poly(age, 3, raw = TRUE)1    -0.027     0.004    -0.035    -0.019    -6.626    24.156     0.000     1.567     0.639 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.777    24.101     0.088     1.571     0.640 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.648    24.328     0.014     1.552     0.637 
## male                         -0.047     0.012    -0.069    -0.024    -4.041   178.715     0.000     0.289     0.233 
## sibling_count3                0.022     0.018    -0.014     0.058     1.195   139.191     0.234     0.341     0.265 
## sibling_count4               -0.007     0.026    -0.058     0.045    -0.264    45.204     0.793     0.806     0.469 
## sibling_count5               -0.026     0.031    -0.086     0.034    -0.857    57.804     0.395     0.652     0.415 
## sibling_count5+              -0.070     0.027    -0.123    -0.016    -2.548   115.378     0.012     0.388     0.291 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.113 
## Residual~~Residual                     0.758 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-38" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-9" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-39" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.531     0.033     0.467     0.595    16.186    37.873     0.000     0.951     0.513 
## count_birth_order2/2         -0.003     0.031    -0.064     0.059    -0.085    21.322     0.933     1.855     0.679 
## count_birth_order1/3          0.018     0.035    -0.050     0.087     0.524    30.460     0.604     1.191     0.571 
## count_birth_order2/3          0.023     0.026    -0.028     0.074     0.899   112.663     0.371     0.394     0.295 
## count_birth_order3/3          0.027     0.030    -0.031     0.086     0.910    58.266     0.367     0.647     0.413 
## count_birth_order1/4         -0.000     0.048    -0.094     0.094    -0.006    29.560     0.995     1.231     0.579 
## count_birth_order2/4          0.004     0.035    -0.064     0.071     0.108   103.259     0.914     0.419     0.308 
## count_birth_order3/4         -0.011     0.038    -0.085     0.064    -0.281    54.982     0.780     0.680     0.425 
## count_birth_order4/4         -0.008     0.035    -0.076     0.060    -0.239   153.208     0.812     0.320     0.252 
## count_birth_order1/5         -0.059     0.049    -0.155     0.038    -1.197   187.935     0.233     0.280     0.227 
## count_birth_order2/5         -0.028     0.046    -0.118     0.061    -0.616   171.612     0.539     0.297     0.238 
## count_birth_order3/5         -0.014     0.047    -0.107     0.078    -0.305    77.586     0.761     0.517     0.357 
## count_birth_order4/5         -0.034     0.054    -0.141     0.073    -0.620    34.389     0.539     1.047     0.538 
## count_birth_order5/5          0.011     0.054    -0.095     0.117     0.207    45.751     0.837     0.797     0.466 
## count_birth_order1/5+        -0.073     0.051    -0.174     0.027    -1.432    63.358     0.157     0.605     0.396 
## count_birth_order2/5+        -0.079     0.040    -0.156    -0.002    -2.000   422.813     0.046     0.171     0.150 
## count_birth_order3/5+        -0.044     0.042    -0.126     0.038    -1.053    91.359     0.295     0.457     0.328 
## count_birth_order4/5+        -0.058     0.040    -0.138     0.021    -1.445   126.049     0.151     0.365     0.279 
## count_birth_order5/5+        -0.097     0.044    -0.184    -0.011    -2.199    52.966     0.032     0.701     0.433 
## count_birth_order5+/5+       -0.048     0.029    -0.105     0.009    -1.656   180.328     0.099     0.288     0.232 
## poly(age, 3, raw = TRUE)1    -0.027     0.004    -0.035    -0.019    -6.599    26.039     0.000     1.427     0.616 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.785    25.339     0.086     1.475     0.624 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.639    25.197     0.014     1.485     0.626 
## male                         -0.047     0.012    -0.071    -0.024    -3.905   118.077     0.000     0.381     0.288 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.113 
## Residual~~Residual                     0.758 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-39" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-9" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.369      10  91.064   0.957 158.562 
##  2 vs 3:   0.374       4  36.141   0.826 428.720 
##  3 vs 4:   1.416       1  29.939   0.243   0.609</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-4" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
</div>
</div>
<div id="adaptive-numbering" class="section level3 tabset">
<h3>Adaptive Numbering</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = adaptive_numbering)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-5" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-10" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-40" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.297     0.038     0.221     0.372     7.717    16.376     0.000     2.866     0.768 
## poly(age, 3, raw = TRUE)1    -0.017     0.005    -0.026    -0.008    -3.659    20.844     0.001     1.916     0.686 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.427    31.400     0.021     1.152     0.562 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.709    41.576     0.001     0.870     0.489 
## male                          0.020     0.011    -0.002     0.042     1.821   438.612     0.069     0.167     0.147 
## sibling_count3                0.009     0.022    -0.035     0.052     0.393    62.542     0.695     0.611     0.398 
## sibling_count4               -0.019     0.027    -0.071     0.033    -0.701    44.089     0.487     0.824     0.475 
## sibling_count5               -0.010     0.025    -0.059     0.039    -0.413   199.371     0.680     0.270     0.220 
## sibling_count5+              -0.129     0.019    -0.166    -0.092    -6.807   230.557     0.000     0.246     0.204 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.104 
## Residual~~Residual                     0.831 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-40" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-10" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-41" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.300     0.041     0.219     0.380     7.257    15.668     0.000     3.131     0.784 
## birth_order                  -0.001     0.003    -0.008     0.005    -0.369    48.829     0.714     0.752     0.451 
## poly(age, 3, raw = TRUE)1    -0.017     0.005    -0.026    -0.008    -3.657    20.797     0.001     1.923     0.687 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.424    32.046     0.021     1.127     0.557 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.706    42.312     0.001     0.856     0.485 
## male                          0.020     0.011    -0.002     0.042     1.822   434.722     0.069     0.168     0.148 
## sibling_count3                0.009     0.022    -0.033     0.052     0.435    70.776     0.665     0.554     0.374 
## sibling_count4               -0.017     0.026    -0.069     0.035    -0.644    49.728     0.522     0.740     0.447 
## sibling_count5               -0.008     0.026    -0.059     0.043    -0.301   169.182     0.764     0.300     0.240 
## sibling_count5+              -0.123     0.023    -0.169    -0.078    -5.308   175.957     0.000     0.292     0.235 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.103 
## Residual~~Residual                     0.831 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-41" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-10" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-42" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.297     0.045     0.209     0.386     6.606    15.891     0.000     3.041     0.779 
## birth_order_nonlinear2        0.002     0.019    -0.035     0.039     0.127    47.529     0.899     0.770     0.458 
## birth_order_nonlinear3       -0.005     0.021    -0.047     0.037    -0.222    77.254     0.825     0.518     0.358 
## birth_order_nonlinear4       -0.022     0.029    -0.079     0.035    -0.760    41.387     0.452     0.874     0.490 
## birth_order_nonlinear5        0.007     0.033    -0.057     0.071     0.221    52.599     0.826     0.705     0.435 
## birth_order_nonlinear5+      -0.001     0.030    -0.060     0.058    -0.026    40.583     0.979     0.890     0.495 
## poly(age, 3, raw = TRUE)1    -0.017     0.005    -0.027    -0.008    -3.456    19.244     0.003     2.163     0.712 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.314    27.418     0.028     1.342     0.601 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.523    34.725     0.001     1.037     0.535 
## male                          0.020     0.011    -0.002     0.042     1.812   404.987     0.071     0.175     0.153 
## sibling_count3                0.011     0.024    -0.036     0.058     0.455    50.394     0.651     0.732     0.444 
## sibling_count4               -0.010     0.026    -0.060     0.040    -0.401   105.144     0.689     0.414     0.306 
## sibling_count5               -0.006     0.029    -0.061     0.050    -0.194   132.997     0.847     0.352     0.271 
## sibling_count5+              -0.125     0.026    -0.175    -0.075    -4.865   131.939     0.000     0.354     0.272 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.104 
## Residual~~Residual                     0.831 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-42" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-10" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-43" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.286     0.043     0.202     0.370     6.699    21.184     0.000     1.872     0.681 
## count_birth_order2/2          0.011     0.030    -0.048     0.069     0.364    38.884     0.718     0.927     0.506 
## count_birth_order1/3          0.003     0.032    -0.059     0.065     0.093    95.251     0.926     0.444     0.321 
## count_birth_order2/3          0.011     0.037    -0.062     0.084     0.285    36.145     0.777     0.996     0.525 
## count_birth_order3/3          0.026     0.031    -0.036     0.087     0.819    85.093     0.415     0.482     0.341 
## count_birth_order1/4         -0.030     0.035    -0.099     0.039    -0.844   718.918     0.399     0.126     0.114 
## count_birth_order2/4          0.002     0.042    -0.080     0.085     0.058    62.012     0.954     0.615     0.400 
## count_birth_order3/4         -0.019     0.045    -0.106     0.069    -0.417    38.144     0.679     0.945     0.511 
## count_birth_order4/4         -0.011     0.046    -0.102     0.080    -0.236    29.423     0.815     1.237     0.581 
## count_birth_order1/5         -0.007     0.043    -0.092     0.078    -0.152  1272.522     0.879     0.092     0.086 
## count_birth_order2/5          0.042     0.047    -0.050     0.133     0.895   273.998     0.372     0.221     0.187 
## count_birth_order3/5         -0.022     0.044    -0.108     0.065    -0.492   307.325     0.623     0.206     0.176 
## count_birth_order4/5         -0.036     0.052    -0.139     0.067    -0.691    48.087     0.493     0.762     0.455 
## count_birth_order5/5         -0.003     0.047    -0.095     0.089    -0.056    58.050     0.956     0.649     0.414 
## count_birth_order1/5+        -0.073     0.043    -0.157     0.011    -1.705    50.420     0.094     0.732     0.444 
## count_birth_order2/5+        -0.149     0.040    -0.228    -0.070    -3.711    78.574     0.000     0.512     0.355 
## count_birth_order3/5+        -0.141     0.040    -0.219    -0.063    -3.540    65.588     0.001     0.588     0.389 
## count_birth_order4/5+        -0.155     0.037    -0.228    -0.083    -4.197    97.202     0.000     0.437     0.318 
## count_birth_order5/5+        -0.110     0.036    -0.181    -0.040    -3.072   109.331     0.003     0.402     0.300 
## count_birth_order5+/5+       -0.124     0.028    -0.179    -0.068    -4.393    56.311     0.000     0.666     0.420 
## poly(age, 3, raw = TRUE)1    -0.016     0.005    -0.026    -0.007    -3.336    22.294     0.003     1.743     0.664 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.131    32.104     0.041     1.125     0.556 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.361    39.479     0.002     0.914     0.502 
## male                          0.020     0.011    -0.002     0.042     1.785   392.361     0.075     0.178     0.156 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.104 
## Residual~~Residual                     0.830 
## ICC|mother_pidlink                     0.111 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-43" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-10" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.501      10 239.232   0.888   1.495 
##  2 vs 3:   0.214       4  64.299   0.930   2.534 
##  3 vs 4:   0.134       1  24.556   0.717   0.757</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-5" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-11" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-44" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.285     0.035     0.215     0.354     8.053    18.241     0.000     2.360     0.730 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.025    -0.008    -3.827    22.478     0.001     1.723     0.662 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.398    38.093     0.021     0.946     0.511 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.236    52.499     0.000     0.707     0.435 
## male                          0.026     0.012     0.003     0.049     2.229   232.742     0.027     0.245     0.203 
## sibling_count3                0.013     0.022    -0.030     0.055     0.596    36.225     0.555     0.994     0.524 
## sibling_count4               -0.019     0.023    -0.064     0.026    -0.815    68.845     0.418     0.566     0.379 
## sibling_count5               -0.059     0.028    -0.113    -0.004    -2.116    67.223     0.038     0.577     0.384 
## sibling_count5+              -0.130     0.022    -0.173    -0.088    -6.042   154.835     0.000     0.318     0.251 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.836 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-44" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-11" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-45" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.265     0.038     0.191     0.338     7.049    18.797     0.000     2.246     0.720 
## birth_order                   0.010     0.004     0.001     0.019     2.177   137.309     0.031     0.344     0.267 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.025    -0.008    -3.787    22.334     0.001     1.738     0.664 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.496    38.934     0.017     0.926     0.506 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.362    53.718     0.000     0.693     0.430 
## male                          0.026     0.012     0.003     0.049     2.235   237.864     0.026     0.241     0.201 
## sibling_count3                0.007     0.022    -0.037     0.051     0.305    34.048     0.762     1.058     0.540 
## sibling_count4               -0.031     0.023    -0.077     0.014    -1.339    81.776     0.184     0.496     0.348 
## sibling_count5               -0.077     0.030    -0.136    -0.019    -2.607    60.573     0.011     0.627     0.405 
## sibling_count5+              -0.164     0.027    -0.217    -0.111    -6.036   112.700     0.000     0.394     0.295 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.836 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-45" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-11" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-46" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.283     0.040     0.205     0.361     7.099    18.562     0.000     2.293     0.724 
## birth_order_nonlinear2        0.001     0.019    -0.035     0.038     0.070    39.116     0.944     0.922     0.504 
## birth_order_nonlinear3        0.006     0.023    -0.040     0.051     0.238    44.450     0.813     0.818     0.473 
## birth_order_nonlinear4        0.024     0.029    -0.034     0.081     0.804    50.749     0.425     0.727     0.443 
## birth_order_nonlinear5        0.040     0.036    -0.029     0.110     1.139    72.201     0.258     0.546     0.370 
## birth_order_nonlinear5+       0.028     0.033    -0.038     0.093     0.831   112.623     0.407     0.394     0.295 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.025    -0.008    -3.737    22.555     0.001     1.715     0.661 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.450    34.941     0.019     1.031     0.533 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.221    45.799     0.000     0.796     0.466 
## male                          0.024     0.012     0.001     0.048     2.016   188.760     0.045     0.279     0.227 
## sibling_count3                0.008     0.022    -0.035     0.052     0.384    42.921     0.703     0.845     0.482 
## sibling_count4               -0.030     0.024    -0.077     0.018    -1.230    94.258     0.222     0.447     0.323 
## sibling_count5               -0.076     0.031    -0.137    -0.014    -2.413    59.706     0.019     0.635     0.408 
## sibling_count5+              -0.157     0.028    -0.211    -0.102    -5.644   134.767     0.000     0.348     0.269 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.105 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.112 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-46" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-11" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-47" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.272     0.038     0.197     0.346     7.152    25.916     0.000     1.435     0.618 
## count_birth_order2/2          0.009     0.028    -0.046     0.064     0.324    33.935     0.748     1.062     0.541 
## count_birth_order1/3          0.001     0.038    -0.073     0.074     0.020    27.176     0.984     1.356     0.604 
## count_birth_order2/3          0.007     0.033    -0.058     0.071     0.205    33.394     0.839     1.080     0.546 
## count_birth_order3/3          0.033     0.040    -0.045     0.111     0.834    23.122     0.413     1.659     0.653 
## count_birth_order1/4         -0.043     0.042    -0.125     0.040    -1.019    65.074     0.312     0.592     0.390 
## count_birth_order2/4         -0.028     0.039    -0.105     0.049    -0.717    53.585     0.476     0.694     0.431 
## count_birth_order3/4         -0.033     0.044    -0.118     0.053    -0.746    33.775     0.461     1.067     0.543 
## count_birth_order4/4          0.015     0.049    -0.081     0.110     0.306    26.494     0.762     1.397     0.611 
## count_birth_order1/5         -0.057     0.052    -0.158     0.044    -1.107   173.482     0.270     0.295     0.237 
## count_birth_order2/5         -0.092     0.061    -0.212     0.027    -1.513    31.517     0.140     1.148     0.561 
## count_birth_order3/5         -0.064     0.048    -0.158     0.030    -1.341    98.171     0.183     0.434     0.317 
## count_birth_order4/5         -0.056     0.055    -0.164     0.053    -1.004    37.927     0.322     0.950     0.512 
## count_birth_order5/5         -0.032     0.059    -0.148     0.085    -0.534    35.765     0.597     1.007     0.527 
## count_birth_order1/5+        -0.125     0.057    -0.237    -0.013    -2.190    43.358     0.034     0.837     0.479 
## count_birth_order2/5+        -0.164     0.046    -0.254    -0.073    -3.549    85.905     0.001     0.479     0.339 
## count_birth_order3/5+        -0.177     0.042    -0.259    -0.095    -4.236   140.922     0.000     0.338     0.263 
## count_birth_order4/5+        -0.140     0.052    -0.243    -0.038    -2.679    32.300     0.012     1.118     0.555 
## count_birth_order5/5+        -0.115     0.046    -0.205    -0.025    -2.506    53.166     0.015     0.699     0.432 
## count_birth_order5+/5+       -0.127     0.031    -0.189    -0.066    -4.066   111.294     0.000     0.397     0.297 
## poly(age, 3, raw = TRUE)1    -0.015     0.004    -0.023    -0.007    -3.517    26.694     0.002     1.385     0.609 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.238    43.282     0.030     0.838     0.480 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.074    54.141     0.000     0.688     0.428 
## male                          0.024     0.012     0.000     0.047     2.001   291.183     0.046     0.213     0.181 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.105 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.112 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-47" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-11" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.405      10  91.065   0.941 158.467 
##  2 vs 3:   0.455       4  36.141   0.768 429.243 
##  3 vs 4:   4.751       1  57.757   0.033   0.341</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-5" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2015-young" class="section level3 tabset">
<h3>g-factor 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-6" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-12" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-48" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.536     0.043    -0.620    -0.452   -12.532    14.172     0.000     3.924     0.821 
## poly(age, 3, raw = TRUE)1     0.040     0.004     0.032     0.047    10.239    32.173     0.000     1.123     0.556 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.875    69.755     0.005     0.561     0.377 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.191   102.237     0.236     0.422     0.310 
## male                         -0.065     0.016    -0.097    -0.034    -4.030    21.535     0.001     1.829     0.675 
## sibling_count3                0.001     0.025    -0.047     0.049     0.037    40.770     0.970     0.886     0.494 
## sibling_count4               -0.024     0.026    -0.074     0.027    -0.923    69.347     0.359     0.563     0.378 
## sibling_count5               -0.003     0.029    -0.060     0.053    -0.113    77.965     0.910     0.515     0.356 
## sibling_count5+              -0.127     0.026    -0.178    -0.076    -4.872    31.595     0.000     1.145     0.561 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-48" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-12" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-49" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.526     0.043    -0.611    -0.441   -12.127    14.566     0.000     3.674     0.810 
## birth_order                  -0.004     0.003    -0.011     0.002    -1.277    41.478     0.209     0.872     0.490 
## poly(age, 3, raw = TRUE)1     0.040     0.004     0.032     0.047    10.241    32.164     0.000     1.123     0.556 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.939    66.094     0.005     0.585     0.387 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.276    99.436     0.205     0.430     0.315 
## male                         -0.065     0.016    -0.097    -0.034    -4.029    21.563     0.001     1.825     0.675 
## sibling_count3                0.004     0.025    -0.045     0.052     0.151    41.220     0.881     0.877     0.491 
## sibling_count4               -0.018     0.027    -0.071     0.035    -0.661    56.950     0.511     0.660     0.418 
## sibling_count5                0.006     0.029    -0.052     0.064     0.198    78.899     0.844     0.510     0.354 
## sibling_count5+              -0.107     0.030    -0.166    -0.049    -3.607    36.243     0.001     0.993     0.524 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-49" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-12" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-50" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.529     0.046    -0.620    -0.438   -11.435    15.010     0.000     3.431     0.799 
## birth_order_nonlinear2       -0.005     0.019    -0.042     0.032    -0.272    33.560     0.787     1.074     0.544 
## birth_order_nonlinear3       -0.002     0.022    -0.046     0.041    -0.100    39.744     0.921     0.908     0.500 
## birth_order_nonlinear4       -0.027     0.027    -0.080     0.026    -0.999    39.822     0.324     0.906     0.500 
## birth_order_nonlinear5       -0.022     0.029    -0.078     0.034    -0.779    74.453     0.438     0.533     0.365 
## birth_order_nonlinear5+      -0.034     0.029    -0.091     0.023    -1.165    35.190     0.252     1.023     0.532 
## poly(age, 3, raw = TRUE)1     0.039     0.004     0.032     0.047     9.927    33.086     0.000     1.090     0.548 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.817    65.032     0.006     0.592     0.390 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.193    85.416     0.236     0.481     0.340 
## male                         -0.065     0.016    -0.097    -0.033    -4.016    21.402     0.001     1.845     0.677 
## sibling_count3                0.001     0.025    -0.048     0.051     0.054    46.080     0.957     0.792     0.465 
## sibling_count4               -0.015     0.029    -0.073     0.042    -0.526    49.269     0.601     0.746     0.449 
## sibling_count5                0.009     0.030    -0.049     0.066     0.293   138.474     0.770     0.342     0.265 
## sibling_count5+              -0.105     0.031    -0.165    -0.044    -3.409    41.342     0.001     0.875     0.491 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.235 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-50" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-12" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-51" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.541     0.045    -0.630    -0.452   -11.925    18.087     0.000     2.394     0.733 
## count_birth_order2/2          0.007     0.027    -0.046     0.060     0.256    40.262     0.799     0.897     0.497 
## count_birth_order1/3          0.006     0.030    -0.053     0.064     0.187   123.567     0.852     0.370     0.281 
## count_birth_order2/3         -0.006     0.036    -0.075     0.064    -0.155    37.665     0.878     0.956     0.514 
## count_birth_order3/3          0.012     0.033    -0.052     0.076     0.371    50.688     0.712     0.728     0.443 
## count_birth_order1/4         -0.010     0.043    -0.095     0.074    -0.238    44.490     0.813     0.817     0.473 
## count_birth_order2/4         -0.000     0.035    -0.070     0.069    -0.009   293.867     0.993     0.212     0.181 
## count_birth_order3/4         -0.041     0.038    -0.115     0.034    -1.063    76.942     0.291     0.520     0.358 
## count_birth_order4/4         -0.024     0.033    -0.090     0.041    -0.733   238.712     0.464     0.241     0.201 
## count_birth_order1/5          0.004     0.054    -0.102     0.109     0.065    44.814     0.948     0.812     0.471 
## count_birth_order2/5          0.007     0.045    -0.081     0.095     0.148   265.527     0.882     0.226     0.190 
## count_birth_order3/5          0.033     0.048    -0.061     0.127     0.681    71.822     0.498     0.548     0.371 
## count_birth_order4/5         -0.048     0.047    -0.140     0.044    -1.020    75.534     0.311     0.527     0.362 
## count_birth_order5/5          0.010     0.042    -0.072     0.093     0.247   106.400     0.805     0.410     0.304 
## count_birth_order1/5+        -0.078     0.039    -0.154    -0.002    -2.013    72.683     0.048     0.543     0.369 
## count_birth_order2/5+        -0.124     0.043    -0.209    -0.039    -2.858    39.717     0.007     0.909     0.501 
## count_birth_order3/5+        -0.100     0.037    -0.172    -0.027    -2.697    85.896     0.008     0.479     0.339 
## count_birth_order4/5+        -0.121     0.040    -0.199    -0.043    -3.046    46.133     0.004     0.791     0.464 
## count_birth_order5/5+        -0.133     0.043    -0.218    -0.048    -3.069    29.722     0.005     1.224     0.578 
## count_birth_order5+/5+       -0.134     0.029    -0.190    -0.078    -4.682    49.701     0.000     0.741     0.447 
## poly(age, 3, raw = TRUE)1     0.040     0.004     0.032     0.049     9.756    32.981     0.000     1.094     0.549 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.962    62.841     0.004     0.609     0.397 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.384    85.847     0.170     0.479     0.339 
## male                         -0.066     0.016    -0.098    -0.034    -4.022    21.338     0.001     1.853     0.678 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.677 
## ICC|mother_pidlink                     0.236 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-51" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-12" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.352      10 237.777   0.965   1.507 
##  2 vs 3:   0.254       4  63.486   0.906   2.599 
##  3 vs 4:   1.638       1  22.086   0.214   0.862</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-6" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-13" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-52" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.542     0.036    -0.612    -0.472   -15.154    17.298     0.000     2.588     0.749 
## poly(age, 3, raw = TRUE)1     0.039     0.004     0.032     0.046    11.139    35.728     0.000     1.008     0.528 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.236    49.564     0.002     0.743     0.448 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.543    51.775     0.129     0.715     0.438 
## male                         -0.062     0.016    -0.094    -0.030    -3.797    21.995     0.001     1.775     0.669 
## sibling_count3                0.004     0.021    -0.036     0.045     0.211    47.289     0.834     0.774     0.459 
## sibling_count4               -0.032     0.027    -0.084     0.020    -1.197    36.726     0.239     0.980     0.520 
## sibling_count5               -0.094     0.036    -0.165    -0.023    -2.598    24.365     0.016     1.549     0.636 
## sibling_count5+              -0.137     0.024    -0.184    -0.090    -5.720    96.015     0.000     0.441     0.320 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-52" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-13" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-53" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.542     0.036    -0.613    -0.470   -14.895    19.290     0.000     2.155     0.711 
## birth_order                  -0.000     0.005    -0.010     0.010    -0.028    39.221     0.978     0.919     0.504 
## poly(age, 3, raw = TRUE)1     0.039     0.004     0.032     0.046    11.167    36.115     0.000     0.997     0.525 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.202    47.237     0.002     0.775     0.459 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.532    50.119     0.132     0.735     0.445 
## male                         -0.062     0.016    -0.094    -0.030    -3.797    22.007     0.001     1.774     0.668 
## sibling_count3                0.004     0.021    -0.037     0.046     0.211    45.122     0.834     0.807     0.470 
## sibling_count4               -0.032     0.028    -0.086     0.023    -1.133    34.264     0.265     1.051     0.539 
## sibling_count5               -0.094     0.037    -0.167    -0.020    -2.496    25.295     0.019     1.478     0.625 
## sibling_count5+              -0.136     0.030    -0.196    -0.077    -4.504    57.383     0.000     0.656     0.416 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-53" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-13" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-54" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.538     0.040    -0.617    -0.459   -13.346    17.646     0.000     2.498     0.742 
## birth_order_nonlinear2       -0.003     0.017    -0.036     0.031    -0.156    41.317     0.877     0.875     0.491 
## birth_order_nonlinear3       -0.004     0.021    -0.044     0.036    -0.193    55.694     0.848     0.672     0.422 
## birth_order_nonlinear4       -0.009     0.025    -0.058     0.040    -0.371    85.885     0.712     0.479     0.339 
## birth_order_nonlinear5       -0.024     0.033    -0.088     0.040    -0.730    70.418     0.468     0.556     0.375 
## birth_order_nonlinear5+      -0.006     0.032    -0.070     0.057    -0.191    76.268     0.849     0.523     0.360 
## poly(age, 3, raw = TRUE)1     0.039     0.004     0.032     0.047    10.537    33.192     0.000     1.086     0.547 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.962    42.107     0.005     0.860     0.486 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.367    44.223     0.179     0.822     0.474 
## male                         -0.062     0.016    -0.094    -0.030    -3.822    22.891     0.001     1.681     0.656 
## sibling_count3                0.004     0.021    -0.037     0.045     0.188    56.178     0.851     0.667     0.421 
## sibling_count4               -0.030     0.026    -0.081     0.022    -1.137    58.705     0.260     0.644     0.411 
## sibling_count5               -0.089     0.037    -0.162    -0.016    -2.384    29.300     0.024     1.243     0.582 
## sibling_count5+              -0.133     0.030    -0.192    -0.074    -4.426    74.685     0.000     0.532     0.364 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-54" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-13" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-55" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.553     0.039    -0.631    -0.476   -14.009    22.345     0.000     1.737     0.663 
## count_birth_order2/2          0.012     0.024    -0.034     0.059     0.531    51.864     0.597     0.714     0.438 
## count_birth_order1/3          0.013     0.030    -0.046     0.072     0.423    57.340     0.674     0.656     0.416 
## count_birth_order2/3         -0.006     0.031    -0.066     0.055    -0.187    36.824     0.852     0.978     0.520 
## count_birth_order3/3          0.013     0.027    -0.041     0.067     0.477   121.448     0.635     0.374     0.284 
## count_birth_order1/4         -0.026     0.042    -0.109     0.057    -0.610    47.263     0.545     0.774     0.459 
## count_birth_order2/4         -0.039     0.037    -0.111     0.034    -1.048    60.935     0.299     0.624     0.404 
## count_birth_order3/4         -0.049     0.038    -0.124     0.026    -1.288    51.136     0.203     0.723     0.441 
## count_birth_order4/4         -0.003     0.034    -0.071     0.064    -0.101   159.887     0.920     0.311     0.247 
## count_birth_order1/5         -0.058     0.049    -0.155     0.039    -1.164   148.137     0.246     0.327     0.256 
## count_birth_order2/5         -0.079     0.054    -0.184     0.026    -1.470    44.525     0.149     0.817     0.473 
## count_birth_order3/5         -0.078     0.062    -0.199     0.043    -1.257    23.450     0.221     1.628     0.648 
## count_birth_order4/5         -0.130     0.072    -0.270     0.011    -1.809    17.239     0.088     2.604     0.750 
## count_birth_order5/5         -0.115     0.046    -0.205    -0.026    -2.522   152.545     0.013     0.321     0.253 
## count_birth_order1/5+        -0.145     0.045    -0.234    -0.056    -3.194   179.446     0.002     0.289     0.232 
## count_birth_order2/5+        -0.138     0.052    -0.240    -0.035    -2.631    33.316     0.013     1.082     0.546 
## count_birth_order3/5+        -0.120     0.040    -0.198    -0.042    -3.014   148.402     0.003     0.327     0.256 
## count_birth_order4/5+        -0.149     0.048    -0.243    -0.055    -3.107    38.739     0.004     0.930     0.507 
## count_birth_order5/5+        -0.153     0.049    -0.249    -0.057    -3.121    32.772     0.004     1.101     0.551 
## count_birth_order5+/5+       -0.136     0.032    -0.199    -0.073    -4.246    85.582     0.000     0.480     0.340 
## poly(age, 3, raw = TRUE)1     0.041     0.004     0.033     0.048    10.495    33.520     0.000     1.075     0.545 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.164    42.394     0.003     0.854     0.485 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.536    43.666     0.132     0.831     0.477 
## male                         -0.063     0.016    -0.095    -0.031    -3.870    23.303     0.001     1.642     0.650 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.238 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-55" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-13" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.376      10  91.064   0.954 158.600 
##  2 vs 3:   0.371       4  36.141   0.828 428.370 
##  3 vs 4:   0.001       1  21.062   0.979   0.918</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-6" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2015-young" class="section level3 tabset">
<h3>Raven 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-7" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-14" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-56" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.651     0.044    -0.738    -0.565   -14.801    13.520     0.000     4.432     0.838 
## poly(age, 3, raw = TRUE)1     0.041     0.004     0.033     0.049    10.339    26.966     0.000     1.368     0.606 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.167    38.067     0.037     0.946     0.511 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.590    40.809     0.559     0.885     0.494 
## male                          0.023     0.012    -0.000     0.045     1.943    79.391     0.056     0.508     0.353 
## sibling_count3               -0.003     0.022    -0.047     0.041    -0.133    62.432     0.894     0.612     0.399 
## sibling_count4               -0.013     0.027    -0.066     0.041    -0.464    45.876     0.645     0.795     0.466 
## sibling_count5                0.002     0.026    -0.049     0.053     0.083   172.245     0.934     0.296     0.237 
## sibling_count5+              -0.098     0.025    -0.147    -0.050    -3.995    36.547     0.000     0.985     0.522 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.646 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-56" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-14" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-57" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.641     0.044    -0.727    -0.554   -14.478    13.975     0.000     4.063     0.826 
## birth_order                  -0.005     0.003    -0.011     0.001    -1.578    75.391     0.119     0.528     0.362 
## poly(age, 3, raw = TRUE)1     0.041     0.004     0.033     0.049    10.343    26.977     0.000     1.367     0.606 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.272    39.212     0.029     0.920     0.504 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.682    42.196     0.499     0.858     0.486 
## male                          0.023     0.012    -0.000     0.045     1.949    79.262     0.055     0.508     0.353 
## sibling_count3                0.000     0.023    -0.044     0.045     0.003    58.638     0.997     0.644     0.412 
## sibling_count4               -0.006     0.027    -0.058     0.046    -0.225    53.387     0.823     0.697     0.431 
## sibling_count5                0.012     0.026    -0.039     0.063     0.462   246.093     0.644     0.236     0.198 
## sibling_count5+              -0.077     0.028    -0.132    -0.022    -2.733    42.694     0.009     0.849     0.483 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.646 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-57" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-14" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-58" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.642     0.045    -0.730    -0.553   -14.220    15.090     0.000     3.391     0.797 
## birth_order_nonlinear2       -0.008     0.017    -0.041     0.024    -0.502    52.054     0.618     0.712     0.437 
## birth_order_nonlinear3       -0.008     0.020    -0.047     0.032    -0.371    56.175     0.712     0.667     0.421 
## birth_order_nonlinear4       -0.024     0.030    -0.083     0.034    -0.820    25.756     0.420     1.446     0.620 
## birth_order_nonlinear5       -0.027     0.032    -0.090     0.035    -0.852    35.582     0.400     1.012     0.529 
## birth_order_nonlinear5+      -0.039     0.024    -0.087     0.009    -1.596    84.898     0.114     0.483     0.341 
## poly(age, 3, raw = TRUE)1     0.041     0.004     0.033     0.049     9.921    27.034     0.000     1.364     0.605 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.088    35.313     0.044     1.020     0.531 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.589    37.728     0.560     0.955     0.514 
## male                          0.023     0.012    -0.000     0.045     1.941    76.596     0.056     0.522     0.359 
## sibling_count3               -0.001     0.025    -0.049     0.047    -0.046    48.383     0.964     0.758     0.453 
## sibling_count4               -0.004     0.029    -0.060     0.052    -0.147    49.743     0.884     0.740     0.447 
## sibling_count5                0.015     0.029    -0.041     0.071     0.529   166.285     0.598     0.303     0.242 
## sibling_count5+              -0.074     0.032    -0.137    -0.010    -2.274    30.955     0.030     1.170     0.566 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.646 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-58" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-14" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-59" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.649     0.044    -0.736    -0.562   -14.638    18.160     0.000     2.378     0.732 
## count_birth_order2/2         -0.006     0.026    -0.057     0.045    -0.232    42.232     0.818     0.857     0.485 
## count_birth_order1/3         -0.012     0.031    -0.072     0.048    -0.398    82.648     0.691     0.493     0.346 
## count_birth_order2/3         -0.020     0.035    -0.088     0.048    -0.587    39.067     0.561     0.923     0.505 
## count_birth_order3/3          0.012     0.028    -0.044     0.067     0.410   147.604     0.682     0.328     0.257 
## count_birth_order1/4          0.005     0.039    -0.070     0.081     0.135    78.384     0.893     0.513     0.355 
## count_birth_order2/4          0.017     0.036    -0.053     0.088     0.486   172.134     0.628     0.296     0.237 
## count_birth_order3/4         -0.058     0.041    -0.139     0.023    -1.409    42.286     0.166     0.856     0.485 
## count_birth_order4/4         -0.019     0.034    -0.085     0.048    -0.556   140.190     0.579     0.339     0.264 
## count_birth_order1/5          0.007     0.045    -0.081     0.095     0.155   143.511     0.877     0.334     0.261 
## count_birth_order2/5          0.010     0.048    -0.084     0.103     0.199    91.457     0.843     0.457     0.328 
## count_birth_order3/5          0.024     0.049    -0.072     0.119     0.487    55.993     0.628     0.669     0.421 
## count_birth_order4/5         -0.041     0.045    -0.129     0.047    -0.916    94.023     0.362     0.448     0.324 
## count_birth_order5/5          0.004     0.040    -0.074     0.082     0.097   157.392     0.923     0.314     0.249 
## count_birth_order1/5+        -0.060     0.044    -0.147     0.026    -1.365    33.405     0.181     1.079     0.545 
## count_birth_order2/5+        -0.093     0.044    -0.178    -0.007    -2.126    35.464     0.041     1.015     0.530 
## count_birth_order3/5+        -0.083     0.034    -0.150    -0.015    -2.401   138.502     0.018     0.342     0.265 
## count_birth_order4/5+        -0.091     0.041    -0.171    -0.010    -2.208    35.747     0.034     1.007     0.527 
## count_birth_order5/5+        -0.111     0.039    -0.186    -0.035    -2.859    42.984     0.007     0.844     0.481 
## count_birth_order5+/5+       -0.113     0.028    -0.168    -0.058    -4.043    50.591     0.000     0.729     0.443 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.034     0.050    10.032    29.377     0.000     1.240     0.581 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.331    39.681     0.025     0.909     0.501 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.807    42.862     0.424     0.846     0.482 
## male                          0.022     0.012    -0.000     0.045     1.924    75.517     0.058     0.527     0.362 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.646 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-59" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-14" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.465      10 224.665   0.911   1.625 
##  2 vs 3:   0.188       4  62.982   0.944   2.641 
##  3 vs 4:   2.487       1  34.535   0.124   0.529</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-7" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-15" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-60" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.659     0.037    -0.731    -0.586   -17.833    16.015     0.000     2.994     0.776 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.035     0.050    11.188    26.434     0.000     1.401     0.612 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.768    29.870     0.010     1.217     0.576 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.199    28.227     0.240     1.297     0.593 
## male                          0.025     0.012     0.001     0.049     2.077    64.192     0.042     0.599     0.393 
## sibling_count3               -0.002     0.018    -0.039     0.034    -0.134    85.477     0.894     0.480     0.340 
## sibling_count4               -0.031     0.023    -0.076     0.013    -1.371    73.072     0.175     0.541     0.368 
## sibling_count5               -0.088     0.030    -0.147    -0.029    -2.940    44.192     0.005     0.822     0.475 
## sibling_count5+              -0.113     0.025    -0.163    -0.063    -4.447    53.229     0.000     0.698     0.432 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.646 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-60" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-15" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-61" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.654     0.037    -0.726    -0.581   -17.664    18.015     0.000     2.411     0.735 
## birth_order                  -0.002     0.004    -0.011     0.006    -0.522    99.933     0.603     0.429     0.314 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.035     0.050    11.183    26.464     0.000     1.399     0.611 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.798    30.164     0.009     1.204     0.574 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.235    28.714     0.227     1.272     0.588 
## male                          0.025     0.012     0.001     0.049     2.079    64.348     0.042     0.597     0.393 
## sibling_count3               -0.001     0.019    -0.038     0.036    -0.054    86.983     0.957     0.474     0.337 
## sibling_count4               -0.028     0.024    -0.075     0.018    -1.192    68.554     0.237     0.568     0.380 
## sibling_count5               -0.083     0.031    -0.145    -0.022    -2.653    44.374     0.011     0.819     0.474 
## sibling_count5+              -0.106     0.031    -0.166    -0.046    -3.450    48.115     0.001     0.762     0.455 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.645 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-61" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-15" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-62" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.654     0.039    -0.731    -0.576   -16.601    17.731     0.000     2.478     0.740 
## birth_order_nonlinear2       -0.007     0.015    -0.036     0.023    -0.443    72.188     0.659     0.546     0.370 
## birth_order_nonlinear3        0.001     0.021    -0.041     0.043     0.042    40.815     0.967     0.885     0.494 
## birth_order_nonlinear4       -0.011     0.024    -0.059     0.037    -0.432    86.865     0.667     0.475     0.337 
## birth_order_nonlinear5       -0.026     0.034    -0.092     0.040    -0.772    51.549     0.444     0.718     0.439 
## birth_order_nonlinear5+      -0.012     0.031    -0.072     0.048    -0.393   104.392     0.695     0.416     0.307 
## poly(age, 3, raw = TRUE)1     0.042     0.004     0.034     0.050    10.563    24.858     0.000     1.511     0.630 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.567    27.243     0.016     1.352     0.603 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.091    26.603     0.285     1.390     0.610 
## male                          0.025     0.012     0.002     0.049     2.093    71.545     0.040     0.550     0.372 
## sibling_count3               -0.004     0.020    -0.042     0.035    -0.187    75.530     0.852     0.527     0.362 
## sibling_count4               -0.030     0.024    -0.078     0.018    -1.236    85.472     0.220     0.480     0.340 
## sibling_count5               -0.083     0.035    -0.152    -0.015    -2.374    33.814     0.023     1.066     0.542 
## sibling_count5+              -0.109     0.034    -0.175    -0.042    -3.192    34.638     0.003     1.040     0.536 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.203 
## Residual~~Residual                     0.645 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-62" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-15" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-63" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.667     0.038    -0.741    -0.593   -17.701    23.748     0.000     1.602     0.644 
## count_birth_order2/2          0.005     0.022    -0.038     0.048     0.246    68.646     0.807     0.568     0.380 
## count_birth_order1/3         -0.004     0.029    -0.061     0.052    -0.143    68.027     0.887     0.572     0.382 
## count_birth_order2/3         -0.021     0.028    -0.076     0.034    -0.743    51.056     0.461     0.724     0.441 
## count_birth_order3/3          0.016     0.028    -0.039     0.071     0.568    74.586     0.572     0.532     0.364 
## count_birth_order1/4         -0.018     0.040    -0.096     0.059    -0.465    61.581     0.643     0.619     0.401 
## count_birth_order2/4         -0.036     0.034    -0.103     0.031    -1.043    91.888     0.300     0.456     0.327 
## count_birth_order3/4         -0.060     0.038    -0.135     0.015    -1.564    44.682     0.125     0.814     0.472 
## count_birth_order4/4         -0.011     0.034    -0.077     0.055    -0.324   161.988     0.746     0.308     0.245 
## count_birth_order1/5         -0.064     0.052    -0.165     0.038    -1.231    77.260     0.222     0.518     0.358 
## count_birth_order2/5         -0.080     0.054    -0.186     0.026    -1.473    38.021     0.149     0.948     0.512 
## count_birth_order3/5         -0.059     0.060    -0.176     0.059    -0.975    23.687     0.340     1.607     0.645 
## count_birth_order4/5         -0.139     0.060    -0.257    -0.021    -2.305    23.121     0.031     1.659     0.653 
## count_birth_order5/5         -0.108     0.042    -0.191    -0.025    -2.558   363.100     0.011     0.187     0.162 
## count_birth_order1/5+        -0.112     0.051    -0.211    -0.012    -2.198    54.636     0.032     0.683     0.426 
## count_birth_order2/5+        -0.117     0.053    -0.220    -0.013    -2.206    29.887     0.035     1.216     0.576 
## count_birth_order3/5+        -0.097     0.040    -0.175    -0.018    -2.422   111.876     0.017     0.396     0.296 
## count_birth_order4/5+        -0.121     0.050    -0.220    -0.022    -2.405    29.700     0.023     1.225     0.578 
## count_birth_order5/5+        -0.138     0.047    -0.231    -0.045    -2.907    33.841     0.006     1.065     0.542 
## count_birth_order5+/5+       -0.120     0.035    -0.189    -0.051    -3.430    43.490     0.001     0.835     0.478 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.036     0.052    10.810    27.291     0.000     1.349     0.602 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.797    29.234     0.009     1.246     0.582 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.258    28.091     0.219     1.304     0.594 
## male                          0.024     0.012     0.000     0.049     1.966    64.553     0.054     0.596     0.392 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.643 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-63" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-15" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.358      10  91.063   0.961 158.673 
##  2 vs 3:   0.358       4  36.141   0.837 428.634 
##  3 vs 4:   0.273       1  43.760   0.604   0.427</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-7" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2015-young" class="section level3 tabset">
<h3>Numeracy 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-8" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-16" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-64" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.252     0.035    -0.320    -0.183    -7.154    19.797     0.000     2.070     0.703 
## poly(age, 3, raw = TRUE)1     0.025     0.004     0.018     0.032     7.138    59.264     0.000     0.639     0.409 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.557   138.432     0.012     0.342     0.266 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.342   164.317     0.181     0.306     0.243 
## male                         -0.133     0.020    -0.173    -0.093    -6.549    16.066     0.000     2.975     0.775 
## sibling_count3                0.005     0.024    -0.043     0.053     0.194    47.862     0.847     0.766     0.456 
## sibling_count4               -0.028     0.029    -0.084     0.029    -0.949    40.379     0.348     0.894     0.496 
## sibling_count5               -0.008     0.030    -0.067     0.051    -0.251    65.819     0.803     0.587     0.388 
## sibling_count5+              -0.116     0.025    -0.165    -0.067    -4.614    39.797     0.000     0.907     0.500 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.200 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-64" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-16" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-65" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.245     0.036    -0.316    -0.174    -6.780    20.239     0.000     2.002     0.696 
## birth_order                  -0.003     0.004    -0.011     0.005    -0.735    29.832     0.468     1.219     0.577 
## poly(age, 3, raw = TRUE)1     0.025     0.004     0.018     0.032     7.139    59.272     0.000     0.638     0.409 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.579   121.152     0.011     0.375     0.284 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.387   154.200     0.167     0.319     0.251 
## male                         -0.133     0.020    -0.173    -0.093    -6.551    16.082     0.000     2.970     0.774 
## sibling_count3                0.007     0.024    -0.041     0.055     0.268    49.222     0.789     0.747     0.450 
## sibling_count4               -0.024     0.031    -0.084     0.036    -0.774    34.520     0.444     1.043     0.537 
## sibling_count5               -0.002     0.032    -0.064     0.061    -0.052    55.325     0.958     0.676     0.424 
## sibling_count5+              -0.103     0.031    -0.164    -0.042    -3.305    33.499     0.002     1.076     0.545 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.200 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-65" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-16" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-66" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.250     0.041    -0.329    -0.170    -6.162    19.436     0.000     2.130     0.709 
## birth_order_nonlinear2       -0.000     0.020    -0.040     0.040    -0.013    31.054     0.990     1.166     0.565 
## birth_order_nonlinear3        0.004     0.026    -0.048     0.055     0.142    26.760     0.888     1.381     0.608 
## birth_order_nonlinear4       -0.021     0.029    -0.077     0.035    -0.733    39.967     0.468     0.903     0.499 
## birth_order_nonlinear5       -0.010     0.028    -0.064     0.044    -0.367   189.522     0.714     0.279     0.226 
## birth_order_nonlinear5+      -0.020     0.035    -0.088     0.049    -0.560    23.477     0.581     1.626     0.648 
## poly(age, 3, raw = TRUE)1     0.025     0.004     0.018     0.033     7.023    65.633     0.000     0.588     0.389 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.594   165.967     0.010     0.304     0.242 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.386   176.420     0.167     0.292     0.234 
## male                         -0.133     0.020    -0.173    -0.093    -6.545    16.055     0.000     2.980     0.775 
## sibling_count3                0.004     0.023    -0.042     0.049     0.156    91.537     0.876     0.457     0.328 
## sibling_count4               -0.022     0.032    -0.085     0.042    -0.670    34.598     0.508     1.041     0.536 
## sibling_count5               -0.000     0.032    -0.064     0.063    -0.014    72.559     0.989     0.544     0.369 
## sibling_count5+              -0.102     0.032    -0.164    -0.040    -3.233    41.265     0.002     0.876     0.491 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.200 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-66" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-16" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-67" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.263     0.040    -0.342    -0.184    -6.511    25.464     0.000     1.466     0.623 
## count_birth_order2/2          0.018     0.028    -0.036     0.072     0.647    48.010     0.521     0.764     0.455 
## count_birth_order1/3          0.022     0.029    -0.036     0.079     0.743   295.806     0.458     0.211     0.180 
## count_birth_order2/3          0.011     0.033    -0.054     0.076     0.333    68.796     0.740     0.567     0.379 
## count_birth_order3/3          0.009     0.039    -0.066     0.085     0.244    30.293     0.809     1.198     0.572 
## count_birth_order1/4         -0.023     0.043    -0.108     0.063    -0.522    55.142     0.604     0.678     0.424 
## count_birth_order2/4         -0.018     0.037    -0.091     0.055    -0.489   261.400     0.625     0.228     0.192 
## count_birth_order3/4         -0.010     0.041    -0.090     0.070    -0.254    65.018     0.801     0.592     0.391 
## count_birth_order4/4         -0.022     0.039    -0.099     0.056    -0.551    65.167     0.583     0.591     0.390 
## count_birth_order1/5         -0.000     0.059    -0.116     0.116    -0.006    35.756     0.995     1.007     0.527 
## count_birth_order2/5          0.001     0.049    -0.095     0.098     0.029   141.199     0.977     0.338     0.263 
## count_birth_order3/5          0.031     0.047    -0.062     0.124     0.660   117.502     0.510     0.383     0.289 
## count_birth_order4/5         -0.041     0.049    -0.136     0.054    -0.841    85.290     0.403     0.481     0.340 
## count_birth_order5/5          0.015     0.044    -0.071     0.100     0.339   115.581     0.735     0.387     0.291 
## count_birth_order1/5+        -0.071     0.047    -0.164     0.022    -1.497    32.798     0.144     1.100     0.550 
## count_birth_order2/5+        -0.115     0.041    -0.196    -0.035    -2.808    70.964     0.006     0.553     0.374 
## count_birth_order3/5+        -0.085     0.039    -0.162    -0.008    -2.174    77.866     0.033     0.515     0.356 
## count_birth_order4/5+        -0.113     0.037    -0.184    -0.041    -3.075   115.836     0.003     0.386     0.291 
## count_birth_order5/5+        -0.114     0.043    -0.198    -0.030    -2.668    37.466     0.011     0.961     0.515 
## count_birth_order5+/5+       -0.114     0.029    -0.171    -0.057    -3.929    57.083     0.000     0.659     0.417 
## poly(age, 3, raw = TRUE)1     0.026     0.004     0.019     0.033     6.938    67.087     0.000     0.578     0.384 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.696   180.763     0.008     0.287     0.232 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.511   210.506     0.132     0.261     0.214 
## male                         -0.133     0.020    -0.173    -0.093    -6.551    16.052     0.000     2.980     0.775 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.200 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-67" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-16" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.313      10 243.034   0.977   1.466 
##  2 vs 3:   0.252       4  63.781   0.907   2.575 
##  3 vs 4:   0.533       1  17.336   0.475   1.228</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-8" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-17" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-68" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.254     0.033    -0.318    -0.189    -7.695    21.655     0.000     1.814     0.673 
## poly(age, 3, raw = TRUE)1     0.024     0.003     0.018     0.031     7.243    62.730     0.000     0.610     0.398 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.442    75.473     0.017     0.527     0.362 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.239    70.008     0.220     0.559     0.376 
## male                         -0.130     0.019    -0.168    -0.093    -6.799    18.019     0.000     2.410     0.735 
## sibling_count3                0.010     0.022    -0.033     0.054     0.457    38.826     0.651     0.928     0.506 
## sibling_count4               -0.021     0.027    -0.075     0.032    -0.785    36.198     0.438     0.995     0.524 
## sibling_count5               -0.071     0.040    -0.150     0.008    -1.753    20.092     0.095     2.024     0.698 
## sibling_count5+              -0.118     0.023    -0.163    -0.073    -5.117   179.833     0.000     0.288     0.232 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.194 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.201 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-68" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-17" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-69" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.258     0.035    -0.326    -0.190    -7.469    23.378     0.000     1.635     0.649 
## birth_order                   0.002     0.005    -0.009     0.013     0.381    35.172     0.705     1.024     0.532 
## poly(age, 3, raw = TRUE)1     0.024     0.003     0.018     0.031     7.277    64.273     0.000     0.598     0.393 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.384    69.260     0.020     0.564     0.378 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.194    65.968     0.237     0.586     0.388 
## male                         -0.130     0.019    -0.168    -0.093    -6.797    18.016     0.000     2.411     0.735 
## sibling_count3                0.009     0.023    -0.036     0.053     0.386    36.806     0.702     0.978     0.520 
## sibling_count4               -0.024     0.029    -0.081     0.033    -0.836    32.931     0.409     1.095     0.549 
## sibling_count5               -0.075     0.042    -0.157     0.007    -1.799    20.962     0.086     1.901     0.684 
## sibling_count5+              -0.125     0.030    -0.183    -0.067    -4.207    78.910     0.000     0.510     0.354 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.194 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.201 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-69" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-17" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-70" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.253     0.038    -0.328    -0.178    -6.639    21.125     0.000     1.879     0.682 
## birth_order_nonlinear2        0.002     0.019    -0.036     0.040     0.103    31.506     0.918     1.148     0.561 
## birth_order_nonlinear3       -0.007     0.025    -0.057     0.042    -0.293    28.427     0.772     1.287     0.591 
## birth_order_nonlinear4       -0.005     0.026    -0.055     0.045    -0.186   120.606     0.853     0.376     0.285 
## birth_order_nonlinear5       -0.014     0.033    -0.079     0.051    -0.421   105.118     0.674     0.414     0.306 
## birth_order_nonlinear5+       0.001     0.034    -0.065     0.068     0.039    79.532     0.969     0.507     0.352 
## poly(age, 3, raw = TRUE)1     0.024     0.003     0.017     0.031     6.967    61.643     0.000     0.618     0.401 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.276    73.045     0.026     0.541     0.368 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.119    73.382     0.267     0.539     0.367 
## male                         -0.130     0.019    -0.168    -0.093    -6.869    18.663     0.000     2.273     0.723 
## sibling_count3                0.011     0.022    -0.033     0.054     0.480    50.836     0.634     0.726     0.442 
## sibling_count4               -0.020     0.029    -0.076     0.036    -0.690    43.692     0.494     0.831     0.477 
## sibling_count5               -0.068     0.041    -0.148     0.013    -1.652    24.575     0.111     1.533     0.634 
## sibling_count5+              -0.117     0.028    -0.171    -0.062    -4.174   237.046     0.000     0.242     0.202 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.201 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-70" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-17" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-71" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.265     0.039    -0.341    -0.189    -6.844    26.077     0.000     1.424     0.616 
## count_birth_order2/2          0.016     0.025    -0.034     0.065     0.626    48.945     0.534     0.751     0.451 
## count_birth_order1/3          0.026     0.031    -0.034     0.087     0.843    67.696     0.402     0.574     0.383 
## count_birth_order2/3          0.011     0.031    -0.051     0.073     0.352    42.189     0.727     0.858     0.486 
## count_birth_order3/3          0.007     0.032    -0.056     0.070     0.218    52.418     0.828     0.708     0.435 
## count_birth_order1/4         -0.025     0.043    -0.108     0.059    -0.584    61.240     0.561     0.622     0.403 
## count_birth_order2/4         -0.030     0.040    -0.108     0.049    -0.741    50.441     0.462     0.731     0.444 
## count_birth_order3/4         -0.023     0.037    -0.096     0.050    -0.611    85.374     0.543     0.481     0.340 
## count_birth_order4/4          0.007     0.035    -0.061     0.075     0.200   284.829     0.842     0.216     0.183 
## count_birth_order1/5         -0.034     0.055    -0.142     0.074    -0.621    85.672     0.536     0.480     0.339 
## count_birth_order2/5         -0.055     0.057    -0.167     0.058    -0.955    40.348     0.345     0.895     0.497 
## count_birth_order3/5         -0.073     0.056    -0.183     0.037    -1.301    37.180     0.201     0.969     0.517 
## count_birth_order4/5         -0.080     0.076    -0.230     0.069    -1.055    16.940     0.306     2.689     0.756 
## count_birth_order5/5         -0.086     0.052    -0.189     0.017    -1.634    67.397     0.107     0.576     0.383 
## count_birth_order1/5+        -0.133     0.045    -0.221    -0.046    -2.975   630.104     0.003     0.136     0.122 
## count_birth_order2/5+        -0.116     0.052    -0.219    -0.014    -2.221    40.920     0.032     0.883     0.493 
## count_birth_order3/5+        -0.107     0.042    -0.189    -0.025    -2.547   145.863     0.012     0.330     0.258 
## count_birth_order4/5+        -0.131     0.043    -0.216    -0.046    -3.010    95.324     0.003     0.444     0.321 
## count_birth_order5/5+        -0.120     0.045    -0.207    -0.032    -2.684    65.834     0.009     0.587     0.388 
## count_birth_order5+/5+       -0.111     0.033    -0.176    -0.045    -3.323    86.380     0.001     0.477     0.338 
## poly(age, 3, raw = TRUE)1     0.025     0.004     0.018     0.032     6.783    51.825     0.000     0.714     0.438 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.381    61.752     0.020     0.618     0.401 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.218    58.523     0.228     0.645     0.412 
## male                         -0.131     0.019    -0.168    -0.094    -6.918    19.090     0.000     2.191     0.715 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.194 
## Residual~~Residual                     0.769 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-71" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-17" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.413      10  91.065   0.937 158.446 
##  2 vs 3:   0.409       4  36.141   0.801 428.559 
##  3 vs 4:   0.144       1  19.445   0.708   1.027</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-8" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2007-old" class="section level3 tabset">
<h3>g-factor 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-9" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-18" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-72" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.205     0.062     0.083     0.328     3.286    11.201     0.007     8.653     0.911 
## poly(age, 3, raw = TRUE)1    -0.006     0.006    -0.018     0.006    -1.012    14.584     0.328     3.663     0.810 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.547    21.535     0.590     1.829     0.675 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.678    25.787     0.105     1.444     0.619 
## male                          0.002     0.013    -0.023     0.027     0.133    57.138     0.895     0.658     0.417 
## sibling_count3                0.009     0.026    -0.041     0.060     0.367    46.537     0.715     0.785     0.462 
## sibling_count4               -0.048     0.031    -0.109     0.013    -1.538    36.947     0.132     0.975     0.519 
## sibling_count5               -0.036     0.029    -0.092     0.020    -1.250   161.229     0.213     0.309     0.246 
## sibling_count5+              -0.180     0.029    -0.236    -0.124    -6.264    28.801     0.000     1.268     0.587 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.279 
## Residual~~Residual                     0.683 
## ICC|mother_pidlink                     0.290 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-72" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-18" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-73" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.197     0.065     0.069     0.325     3.009    11.174     0.012     8.753     0.912 
## birth_order                   0.004     0.005    -0.007     0.014     0.660    15.150     0.519     3.362     0.796 
## poly(age, 3, raw = TRUE)1    -0.006     0.006    -0.018     0.006    -1.017    14.606     0.326     3.651     0.809 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.635    23.883     0.531     1.590     0.643 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.819    29.654     0.079     1.227     0.578 
## male                          0.002     0.013    -0.023     0.026     0.130    56.926     0.897     0.660     0.418 
## sibling_count3                0.007     0.026    -0.043     0.057     0.278    48.128     0.782     0.762     0.455 
## sibling_count4               -0.053     0.032    -0.116     0.010    -1.639    33.847     0.110     1.065     0.542 
## sibling_count5               -0.044     0.032    -0.107     0.019    -1.356    70.820     0.179     0.554     0.374 
## sibling_count5+              -0.196     0.037    -0.269    -0.124    -5.288    22.343     0.000     1.737     0.663 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.683 
## ICC|mother_pidlink                     0.291 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-73" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-18" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-74" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.196     0.065     0.068     0.324     2.991    11.684     0.012     7.173     0.894 
## birth_order_nonlinear2        0.012     0.020    -0.027     0.050     0.604    29.409     0.551     1.238     0.581 
## birth_order_nonlinear3        0.007     0.027    -0.047     0.060     0.244    21.317     0.810     1.855     0.679 
## birth_order_nonlinear4        0.004     0.033    -0.061     0.069     0.119    21.973     0.906     1.778     0.669 
## birth_order_nonlinear5        0.002     0.038    -0.073     0.077     0.054    22.872     0.957     1.683     0.656 
## birth_order_nonlinear5+       0.030     0.040    -0.048     0.107     0.744    17.323     0.467     2.582     0.748 
## poly(age, 3, raw = TRUE)1    -0.006     0.006    -0.018     0.006    -0.973    15.004     0.346     3.435     0.800 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.553    22.580     0.586     1.713     0.660 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.678    27.235     0.105     1.352     0.603 
## male                          0.002     0.013    -0.023     0.027     0.133    56.367     0.895     0.666     0.420 
## sibling_count3                0.009     0.027    -0.045     0.063     0.330    42.202     0.743     0.858     0.486 
## sibling_count4               -0.048     0.032    -0.111     0.014    -1.516    44.097     0.137     0.824     0.475 
## sibling_count5               -0.036     0.036    -0.107     0.035    -0.991    46.587     0.327     0.784     0.462 
## sibling_count5+              -0.192     0.038    -0.267    -0.117    -5.023    23.823     0.000     1.595     0.643 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.682 
## ICC|mother_pidlink                     0.291 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-74" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-18" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-75" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.065     0.052     0.306     2.765    12.634     0.016     5.411     0.864 
## count_birth_order2/2          0.028     0.025    -0.022     0.077     1.099    64.530     0.276     0.596     0.392 
## count_birth_order1/3          0.020     0.040    -0.057     0.098     0.512    29.510     0.612     1.233     0.580 
## count_birth_order2/3          0.014     0.044    -0.073     0.101     0.310    21.642     0.760     1.816     0.674 
## count_birth_order3/3          0.032     0.038    -0.042     0.105     0.840    32.605     0.407     1.107     0.552 
## count_birth_order1/4         -0.043     0.044    -0.130     0.044    -0.969    46.620     0.338     0.784     0.462 
## count_birth_order2/4         -0.013     0.050    -0.110     0.085    -0.257    29.569     0.799     1.231     0.579 
## count_birth_order3/4         -0.072     0.041    -0.152     0.009    -1.753    59.654     0.085     0.635     0.408 
## count_birth_order4/4         -0.018     0.052    -0.120     0.083    -0.356    21.914     0.725     1.784     0.670 
## count_birth_order1/5         -0.040     0.055    -0.149     0.068    -0.732    45.975     0.468     0.794     0.465 
## count_birth_order2/5         -0.037     0.052    -0.139     0.065    -0.716    73.527     0.476     0.538     0.367 
## count_birth_order3/5         -0.016     0.050    -0.113     0.082    -0.312    68.583     0.756     0.568     0.380 
## count_birth_order4/5         -0.044     0.051    -0.145     0.057    -0.855    52.682     0.397     0.705     0.434 
## count_birth_order5/5          0.001     0.045    -0.088     0.090     0.023    75.951     0.982     0.525     0.361 
## count_birth_order1/5+        -0.169     0.048    -0.263    -0.075    -3.541    30.575     0.001     1.186     0.570 
## count_birth_order2/5+        -0.180     0.044    -0.267    -0.092    -4.039    41.091     0.000     0.880     0.492 
## count_birth_order3/5+        -0.163     0.049    -0.259    -0.067    -3.321    25.702     0.003     1.449     0.620 
## count_birth_order4/5+        -0.191     0.049    -0.287    -0.096    -3.922    24.607     0.001     1.530     0.633 
## count_birth_order5/5+        -0.201     0.043    -0.285    -0.117    -4.699    35.225     0.000     1.022     0.531 
## count_birth_order5+/5+       -0.157     0.034    -0.224    -0.090    -4.587    29.232     0.000     1.247     0.582 
## poly(age, 3, raw = TRUE)1    -0.004     0.006    -0.016     0.007    -0.733    16.025     0.474     2.991     0.776 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.292    24.412     0.773     1.546     0.636 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.453    29.386     0.157     1.239     0.581 
## male                          0.001     0.013    -0.023     0.026     0.114    55.679     0.909     0.672     0.422 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.279 
## Residual~~Residual                     0.682 
## ICC|mother_pidlink                     0.291 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-75" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-18" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.421      10 221.282   0.936   1.659 
##  2 vs 3:   0.380       4  64.831   0.822   2.494 
##  3 vs 4:   0.442       1  11.616   0.519   3.321</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-9" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-19" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-76" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.195     0.062     0.073     0.317     3.137    11.123     0.009     8.953     0.914 
## poly(age, 3, raw = TRUE)1    -0.005     0.006    -0.016     0.006    -0.935    14.422     0.365     3.761     0.814 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.080    18.456     0.937     2.315     0.726 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.061    18.033     0.303     2.407     0.734 
## male                          0.007     0.013    -0.019     0.032     0.526    55.393     0.601     0.675     0.424 
## sibling_count3               -0.002     0.024    -0.048     0.044    -0.085    32.972     0.933     1.094     0.549 
## sibling_count4               -0.043     0.031    -0.104     0.018    -1.385    26.534     0.178     1.395     0.611 
## sibling_count5               -0.109     0.030    -0.167    -0.051    -3.690    77.296     0.000     0.518     0.358 
## sibling_count5+              -0.195     0.029    -0.251    -0.139    -6.806    46.528     0.000     0.785     0.462 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.282 
## Residual~~Residual                     0.684 
## ICC|mother_pidlink                     0.292 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-76" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-19" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-77" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.066     0.029     0.288     2.404    11.241     0.035     8.505     0.910 
## birth_order                   0.016     0.007     0.002     0.030     2.305    17.312     0.034     2.584     0.748 
## poly(age, 3, raw = TRUE)1    -0.005     0.006    -0.016     0.006    -0.896    14.373     0.385     3.792     0.815 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.259    19.175     0.798     2.176     0.714 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.308    19.106     0.206     2.188     0.715 
## male                          0.007     0.013    -0.019     0.032     0.527    54.892     0.600     0.680     0.425 
## sibling_count3               -0.013     0.024    -0.059     0.034    -0.545    34.333     0.589     1.049     0.538 
## sibling_count4               -0.065     0.032    -0.128    -0.002    -2.031    26.339     0.052     1.407     0.613 
## sibling_count5               -0.143     0.030    -0.203    -0.083    -4.698    91.535     0.000     0.457     0.328 
## sibling_count5+              -0.251     0.037    -0.325    -0.178    -6.734    29.699     0.000     1.225     0.578 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.283 
## Residual~~Residual                     0.683 
## ICC|mother_pidlink                     0.293 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-77" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-216-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-19" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-78" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.185     0.064     0.060     0.310     2.910    11.770     0.013     6.965     0.891 
## birth_order_nonlinear2        0.009     0.018    -0.027     0.045     0.485    33.378     0.631     1.080     0.546 
## birth_order_nonlinear3        0.025     0.024    -0.022     0.073     1.051    29.455     0.302     1.236     0.580 
## birth_order_nonlinear4        0.028     0.033    -0.037     0.093     0.834    24.734     0.412     1.520     0.632 
## birth_order_nonlinear5        0.021     0.041    -0.060     0.102     0.515    26.441     0.611     1.400     0.612 
## birth_order_nonlinear5+       0.086     0.051    -0.014     0.187     1.681    16.996     0.111     2.672     0.755 
## poly(age, 3, raw = TRUE)1    -0.005     0.006    -0.017     0.006    -0.972    14.990     0.347     3.442     0.800 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.359    20.152     0.724     2.015     0.697 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.429    20.375     0.168     1.982     0.693 
## male                          0.005     0.013    -0.021     0.032     0.401    49.633     0.690     0.742     0.448 
## sibling_count3               -0.011     0.025    -0.060     0.038    -0.435    32.117     0.666     1.125     0.556 
## sibling_count4               -0.061     0.034    -0.127     0.005    -1.811    25.710     0.082     1.449     0.620 
## sibling_count5               -0.132     0.031    -0.193    -0.071    -4.265   113.204     0.000     0.393     0.294 
## sibling_count5+              -0.241     0.041    -0.321    -0.161    -5.917    25.060     0.000     1.495     0.628 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.283 
## Residual~~Residual                     0.682 
## ICC|mother_pidlink                     0.293 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-78" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-19" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-79" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.173     0.062     0.052     0.294     2.808    12.868     0.015     5.109     0.857 
## count_birth_order2/2          0.021     0.031    -0.040     0.082     0.678    20.914     0.505     1.907     0.685 
## count_birth_order1/3         -0.001     0.035    -0.069     0.068    -0.019    34.193     0.985     1.054     0.539 
## count_birth_order2/3         -0.005     0.033    -0.069     0.060    -0.138    32.769     0.891     1.101     0.551 
## count_birth_order3/3          0.022     0.035    -0.048     0.091     0.612    31.942     0.545     1.131     0.558 
## count_birth_order1/4         -0.047     0.052    -0.148     0.055    -0.906    25.267     0.374     1.480     0.625 
## count_birth_order2/4         -0.049     0.047    -0.141     0.043    -1.046    25.626     0.305     1.455     0.621 
## count_birth_order3/4         -0.055     0.041    -0.136     0.025    -1.355    43.132     0.182     0.841     0.480 
## count_birth_order4/4         -0.015     0.052    -0.116     0.087    -0.283    22.055     0.780     1.769     0.668 
## count_birth_order1/5         -0.115     0.062    -0.237     0.006    -1.865    37.304     0.070     0.965     0.516 
## count_birth_order2/5         -0.152     0.051    -0.252    -0.053    -2.998    72.695     0.004     0.543     0.369 
## count_birth_order3/5         -0.085     0.059    -0.200     0.030    -1.453    29.464     0.157     1.236     0.580 
## count_birth_order4/5         -0.109     0.061    -0.229     0.010    -1.797    25.723     0.084     1.448     0.620 
## count_birth_order5/5         -0.086     0.060    -0.204     0.032    -1.428    30.924     0.163     1.171     0.567 
## count_birth_order1/5+        -0.270     0.061    -0.390    -0.151    -4.431    30.433     0.000     1.192     0.571 
## count_birth_order2/5+        -0.227     0.063    -0.351    -0.104    -3.603    21.471     0.002     1.836     0.676 
## count_birth_order3/5+        -0.191     0.043    -0.275    -0.106    -4.421    92.180     0.000     0.454     0.327 
## count_birth_order4/5+        -0.217     0.056    -0.327    -0.107    -3.856    25.135     0.001     1.490     0.627 
## count_birth_order5/5+        -0.227     0.044    -0.313    -0.142    -5.218    70.886     0.000     0.554     0.374 
## count_birth_order5+/5+       -0.148     0.039    -0.224    -0.072    -3.829    38.352     0.000     0.940     0.509 
## poly(age, 3, raw = TRUE)1    -0.005     0.006    -0.015     0.006    -0.807    16.027     0.431     2.990     0.776 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.209    21.113     0.836     1.881     0.682 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.314    20.904     0.203     1.908     0.685 
## male                          0.006     0.013    -0.020     0.031     0.433    58.223     0.667     0.648     0.413 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.283 
## Residual~~Residual                     0.680 
## ICC|mother_pidlink                     0.294 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-79" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-19" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.393      10  91.062   0.947 158.895 
##  2 vs 3:   0.405       4  36.141   0.804 428.895 
##  3 vs 4:   5.452       1  12.609   0.037   2.492</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-9" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2007-old" class="section level3 tabset">
<h3>Raven 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-10" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-20" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-80" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.028     0.059    -0.144     0.089    -0.463    11.559     0.652     7.504     0.899 
## poly(age, 3, raw = TRUE)1     0.004     0.006    -0.008     0.016     0.648    14.078     0.527     3.989     0.823 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.330    18.218     0.746     2.365     0.731 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.318    21.696     0.201     1.810     0.673 
## male                          0.046     0.012     0.023     0.069     3.868   112.200     0.000     0.395     0.296 
## sibling_count3                0.003     0.025    -0.046     0.052     0.108    55.899     0.914     0.670     0.422 
## sibling_count4               -0.030     0.036    -0.101     0.040    -0.842    23.199     0.409     1.652     0.652 
## sibling_count5               -0.028     0.031    -0.090     0.034    -0.891    72.912     0.376     0.542     0.368 
## sibling_count5+              -0.146     0.028    -0.201    -0.091    -5.235    32.398     0.000     1.114     0.554 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.272 
## Residual~~Residual                     0.715 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-80" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-20" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-81" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.032     0.061    -0.150     0.087    -0.526    11.704     0.609     7.124     0.894 
## birth_order                   0.002     0.005    -0.008     0.011     0.388    17.886     0.702     2.441     0.737 
## poly(age, 3, raw = TRUE)1     0.004     0.006    -0.008     0.016     0.647    14.085     0.528     3.984     0.823 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.364    18.811     0.720     2.244     0.720 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.367    22.528     0.185     1.718     0.661 
## male                          0.046     0.012     0.023     0.069     3.864   111.683     0.000     0.396     0.296 
## sibling_count3                0.001     0.025    -0.047     0.050     0.060    58.807     0.953     0.643     0.411 
## sibling_count4               -0.033     0.037    -0.106     0.040    -0.889    22.445     0.383     1.726     0.662 
## sibling_count5               -0.032     0.035    -0.100     0.036    -0.921    45.727     0.362     0.797     0.466 
## sibling_count5+              -0.155     0.037    -0.227    -0.082    -4.171    22.780     0.000     1.692     0.657 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.273 
## Residual~~Residual                     0.715 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-81" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-226-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-20" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-82" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.029     0.059    -0.145     0.087    -0.493    12.577     0.631     5.491     0.866 
## birth_order_nonlinear2        0.003     0.021    -0.037     0.043     0.149    27.291     0.883     1.349     0.602 
## birth_order_nonlinear3        0.001     0.027    -0.052     0.055     0.047    22.405     0.963     1.731     0.663 
## birth_order_nonlinear4       -0.005     0.027    -0.057     0.047    -0.195    50.037     0.846     0.736     0.446 
## birth_order_nonlinear5       -0.008     0.037    -0.081     0.065    -0.212    25.584     0.834     1.458     0.622 
## birth_order_nonlinear5+       0.013     0.035    -0.055     0.082     0.374    22.927     0.712     1.678     0.655 
## poly(age, 3, raw = TRUE)1     0.004     0.006    -0.008     0.016     0.637    14.934     0.534     3.470     0.801 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.373    19.684     0.713     2.088     0.705 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.375    23.770     0.182     1.600     0.644 
## male                          0.046     0.012     0.023     0.069     3.859   108.523     0.000     0.404     0.301 
## sibling_count3                0.003     0.028    -0.052     0.058     0.103    38.090     0.919     0.946     0.511 
## sibling_count4               -0.029     0.040    -0.106     0.049    -0.719    21.842     0.480     1.793     0.671 
## sibling_count5               -0.024     0.039    -0.102     0.053    -0.618    33.620     0.541     1.072     0.544 
## sibling_count5+              -0.150     0.040    -0.228    -0.071    -3.715    21.510     0.001     1.832     0.676 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.272 
## Residual~~Residual                     0.715 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-82" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-20" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-83" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.042     0.059    -0.157     0.074    -0.705    13.879     0.492     4.135     0.828 
## count_birth_order2/2          0.015     0.028    -0.040     0.069     0.533    40.955     0.597     0.882     0.493 
## count_birth_order1/3          0.011     0.038    -0.063     0.085     0.280    36.912     0.781     0.975     0.519 
## count_birth_order2/3         -0.000     0.048    -0.095     0.094    -0.010    19.026     0.992     2.203     0.716 
## count_birth_order3/3          0.018     0.038    -0.056     0.092     0.476    34.250     0.637     1.052     0.539 
## count_birth_order1/4         -0.015     0.053    -0.120     0.089    -0.288    25.039     0.776     1.497     0.628 
## count_birth_order2/4          0.003     0.053    -0.101     0.107     0.056    25.227     0.956     1.483     0.626 
## count_birth_order3/4         -0.068     0.043    -0.152     0.017    -1.574    48.689     0.122     0.754     0.452 
## count_birth_order4/4         -0.014     0.059    -0.129     0.101    -0.245    17.833     0.810     2.453     0.738 
## count_birth_order1/5         -0.024     0.055    -0.133     0.085    -0.435    48.621     0.666     0.755     0.452 
## count_birth_order2/5         -0.032     0.059    -0.147     0.082    -0.552    40.124     0.584     0.900     0.498 
## count_birth_order3/5         -0.019     0.052    -0.121     0.082    -0.377    60.329     0.707     0.629     0.406 
## count_birth_order4/5         -0.038     0.053    -0.143     0.067    -0.710    46.278     0.482     0.789     0.464 
## count_birth_order5/5         -0.002     0.046    -0.093     0.089    -0.049    70.746     0.961     0.554     0.374 
## count_birth_order1/5+        -0.140     0.055    -0.249    -0.032    -2.531    21.364     0.019     1.849     0.678 
## count_birth_order2/5+        -0.153     0.047    -0.246    -0.060    -3.238    34.192     0.003     1.054     0.539 
## count_birth_order3/5+        -0.115     0.050    -0.213    -0.016    -2.279    25.148     0.031     1.489     0.627 
## count_birth_order4/5+        -0.157     0.046    -0.247    -0.067    -3.427    30.780     0.002     1.177     0.568 
## count_birth_order5/5+        -0.168     0.043    -0.253    -0.083    -3.884    35.820     0.000     1.005     0.527 
## count_birth_order5+/5+       -0.132     0.035    -0.202    -0.063    -3.733    27.087     0.001     1.361     0.605 
## poly(age, 3, raw = TRUE)1     0.005     0.006    -0.007     0.017     0.838    16.249     0.414     2.910     0.771 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.190    21.487     0.851     1.834     0.676 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.224    26.026     0.232     1.428     0.616 
## male                          0.046     0.012     0.022     0.069     3.835   106.072     0.000     0.411     0.304 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.272 
## Residual~~Residual                     0.715 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-83" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-20" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.425      10 217.151   0.934   1.702 
##  2 vs 3:   0.384       4  63.185   0.819   2.624 
##  3 vs 4:   0.153       1  12.741   0.702   2.414</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-10" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-21" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-84" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.038     0.058    -0.152     0.076    -0.653    11.569     0.526     7.476     0.898 
## poly(age, 3, raw = TRUE)1     0.005     0.006    -0.006     0.016     0.888    14.447     0.389     3.746     0.813 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.159    18.643     0.876     2.277     0.723 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.772    19.432     0.449     2.130     0.709 
## male                          0.052     0.012     0.028     0.075     4.311   123.132     0.000     0.371     0.282 
## sibling_count3               -0.003     0.021    -0.044     0.039    -0.123    60.286     0.903     0.630     0.406 
## sibling_count4               -0.039     0.028    -0.095     0.016    -1.386    37.510     0.174     0.960     0.515 
## sibling_count5               -0.087     0.029    -0.143    -0.031    -3.039   110.230     0.003     0.400     0.298 
## sibling_count5+              -0.159     0.026    -0.209    -0.109    -6.206   107.050     0.000     0.408     0.303 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.275 
## Residual~~Residual                     0.717 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-84" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-233-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-21" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-85" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.063     0.061    -0.182     0.057    -1.029    11.791     0.324     6.916     0.891 
## birth_order                   0.011     0.007    -0.002     0.025     1.614    18.491     0.123     2.308     0.726 
## poly(age, 3, raw = TRUE)1     0.005     0.006    -0.006     0.016     0.910    14.409     0.378     3.769     0.814 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.044    18.809     0.965     2.244     0.720 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.914    19.563     0.372     2.108     0.707 
## male                          0.052     0.012     0.028     0.075     4.310   122.251     0.000     0.372     0.283 
## sibling_count3               -0.010     0.021    -0.051     0.031    -0.476    66.579     0.636     0.581     0.386 
## sibling_count4               -0.054     0.032    -0.117     0.008    -1.707    27.662     0.099     1.328     0.598 
## sibling_count5               -0.110     0.033    -0.174    -0.046    -3.363    57.412     0.001     0.655     0.416 
## sibling_count5+              -0.197     0.038    -0.271    -0.123    -5.217    29.242     0.000     1.246     0.582 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.275 
## Residual~~Residual                     0.716 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-85" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-21" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-86" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.041     0.060    -0.159     0.076    -0.685    12.299     0.506     5.917     0.874 
## birth_order_nonlinear2        0.003     0.018    -0.033     0.039     0.158    36.045     0.876     0.999     0.525 
## birth_order_nonlinear3        0.017     0.023    -0.028     0.062     0.754    38.630     0.456     0.933     0.508 
## birth_order_nonlinear4        0.006     0.034    -0.061     0.073     0.175    24.650     0.863     1.527     0.633 
## birth_order_nonlinear5        0.004     0.043    -0.080     0.087     0.090    25.917     0.929     1.435     0.618 
## birth_order_nonlinear5+       0.062     0.050    -0.037     0.161     1.230    18.002     0.234     2.414     0.735 
## poly(age, 3, raw = TRUE)1     0.005     0.006    -0.007     0.016     0.795    14.751     0.439     3.568     0.806 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.093    19.504     0.927     2.118     0.708 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.050    20.127     0.306     2.018     0.697 
## male                          0.051     0.012     0.026     0.075     4.107   101.302     0.000     0.425     0.312 
## sibling_count3               -0.009     0.023    -0.053     0.036    -0.385    53.080     0.702     0.700     0.433 
## sibling_count4               -0.048     0.036    -0.119     0.022    -1.350    22.699     0.190     1.700     0.658 
## sibling_count5               -0.098     0.035    -0.166    -0.030    -2.832    52.046     0.007     0.712     0.437 
## sibling_count5+              -0.189     0.041    -0.268    -0.109    -4.633    25.684     0.000     1.451     0.620 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.274 
## Residual~~Residual                     0.715 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-86" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-21" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-87" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.054     0.058    -0.167     0.058    -0.943    13.811     0.362     4.188     0.830 
## count_birth_order2/2          0.015     0.029    -0.042     0.073     0.524    25.634     0.605     1.454     0.621 
## count_birth_order1/3          0.000     0.030    -0.058     0.059     0.007    89.645     0.994     0.464     0.332 
## count_birth_order2/3         -0.008     0.031    -0.070     0.053    -0.266    43.606     0.792     0.833     0.478 
## count_birth_order3/3          0.017     0.032    -0.046     0.081     0.537    50.210     0.594     0.734     0.445 
## count_birth_order1/4         -0.033     0.061    -0.152     0.086    -0.551    18.492     0.588     2.307     0.726 
## count_birth_order2/4         -0.041     0.042    -0.123     0.042    -0.971    39.514     0.337     0.913     0.502 
## count_birth_order3/4         -0.053     0.047    -0.146     0.040    -1.123    26.668     0.271     1.386     0.609 
## count_birth_order4/4         -0.020     0.047    -0.112     0.073    -0.422    29.359     0.676     1.241     0.581 
## count_birth_order1/5         -0.081     0.064    -0.207     0.044    -1.274    35.051     0.211     1.027     0.533 
## count_birth_order2/5         -0.125     0.061    -0.244    -0.006    -2.052    31.955     0.048     1.131     0.558 
## count_birth_order3/5         -0.048     0.061    -0.167     0.071    -0.794    28.016     0.434     1.308     0.595 
## count_birth_order4/5         -0.111     0.055    -0.218    -0.004    -2.040    40.026     0.048     0.902     0.499 
## count_birth_order5/5         -0.071     0.062    -0.193     0.052    -1.134    29.127     0.266     1.252     0.584 
## count_birth_order1/5+        -0.212     0.060    -0.329    -0.095    -3.561    35.175     0.001     1.024     0.532 
## count_birth_order2/5+        -0.183     0.052    -0.285    -0.081    -3.529    42.057     0.001     0.861     0.486 
## count_birth_order3/5+        -0.152     0.048    -0.246    -0.057    -3.150    48.870     0.003     0.752     0.451 
## count_birth_order4/5+        -0.183     0.057    -0.294    -0.072    -3.230    25.836     0.003     1.440     0.619 
## count_birth_order5/5+        -0.190     0.040    -0.268    -0.112    -4.774   212.673     0.000     0.259     0.213 
## count_birth_order5+/5+       -0.120     0.040    -0.199    -0.042    -3.005    34.680     0.005     1.038     0.535 
## poly(age, 3, raw = TRUE)1     0.006     0.006    -0.005     0.017     1.023    16.398     0.321     2.858     0.768 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.072    21.974     0.943     1.778     0.669 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.951    22.026     0.352     1.772     0.668 
## male                          0.051     0.012     0.027     0.076     4.100   100.585     0.000     0.427     0.313 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.274 
## Residual~~Residual                     0.713 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-87" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-21" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.416      10  91.062   0.936 158.882 
##  2 vs 3:   0.427       4  36.141   0.788 429.131 
##  3 vs 4:   2.669       1  13.075   0.126   2.240</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-10" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2007-old" class="section level3 tabset">
<h3>Numeracy 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-11" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-22" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-88" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.365     0.056     0.255     0.474     6.528    11.770     0.000     6.964     0.891 
## poly(age, 3, raw = TRUE)1    -0.014     0.005    -0.023    -0.005    -2.981    20.905     0.007     1.908     0.685 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.663    39.174     0.511     0.921     0.504 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.482    33.957     0.148     1.061     0.541 
## male                         -0.043     0.013    -0.069    -0.018    -3.338    47.877     0.002     0.765     0.456 
## sibling_count3                0.013     0.024    -0.034     0.059     0.529    59.581     0.599     0.636     0.408 
## sibling_count4               -0.049     0.028    -0.104     0.006    -1.746    53.557     0.087     0.695     0.431 
## sibling_count5               -0.032     0.026    -0.083     0.019    -1.231   568.782     0.219     0.144     0.129 
## sibling_count5+              -0.152     0.029    -0.209    -0.096    -5.318    26.643     0.000     1.388     0.609 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-88" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-243-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-22" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-89" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.357     0.063     0.234     0.480     5.699    11.319     0.000     8.235     0.907 
## birth_order                   0.003     0.006    -0.009     0.015     0.533    13.225     0.603     4.712     0.847 
## poly(age, 3, raw = TRUE)1    -0.014     0.005    -0.023    -0.005    -2.989    20.983     0.007     1.898     0.684 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.772    52.788     0.444     0.703     0.434 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.631    43.715     0.110     0.831     0.477 
## male                         -0.043     0.013    -0.069    -0.018    -3.341    47.806     0.002     0.766     0.456 
## sibling_count3                0.011     0.024    -0.037     0.058     0.439    58.929     0.662     0.642     0.410 
## sibling_count4               -0.053     0.027    -0.106    -0.001    -1.982    75.616     0.051     0.527     0.362 
## sibling_count5               -0.039     0.028    -0.094     0.016    -1.392   218.980     0.165     0.254     0.210 
## sibling_count5+              -0.167     0.033    -0.232    -0.102    -5.035    28.108     0.000     1.303     0.594 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-89" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-245-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-22" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-90" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.351     0.063     0.228     0.474     5.585    11.863     0.000     6.753     0.888 
## birth_order_nonlinear2        0.017     0.019    -0.021     0.055     0.860    30.965     0.396     1.170     0.566 
## birth_order_nonlinear3        0.010     0.024    -0.037     0.057     0.418    29.843     0.679     1.218     0.577 
## birth_order_nonlinear4        0.012     0.035    -0.057     0.080     0.335    19.459     0.741     2.126     0.709 
## birth_order_nonlinear5        0.012     0.037    -0.061     0.084     0.316    24.813     0.754     1.514     0.631 
## birth_order_nonlinear5+       0.033     0.042    -0.050     0.115     0.780    15.859     0.447     3.054     0.779 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.023    -0.004    -2.742    20.347     0.012     1.986     0.694 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.601    41.999     0.551     0.862     0.487 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.440    37.969     0.158     0.949     0.512 
## male                         -0.043     0.013    -0.069    -0.018    -3.338    47.528     0.002     0.770     0.458 
## sibling_count3                0.012     0.024    -0.036     0.059     0.484    76.739     0.630     0.521     0.359 
## sibling_count4               -0.052     0.026    -0.103     0.000    -1.957   158.384     0.052     0.313     0.248 
## sibling_count5               -0.036     0.031    -0.096     0.025    -1.161   133.142     0.248     0.351     0.271 
## sibling_count5+              -0.167     0.031    -0.228    -0.106    -5.347    44.638     0.000     0.815     0.472 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-90" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-22" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-91" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.336     0.064     0.210     0.462     5.225    12.589     0.000     5.474     0.865 
## count_birth_order2/2          0.031     0.026    -0.019     0.082     1.210    54.321     0.232     0.686     0.428 
## count_birth_order1/3          0.023     0.036    -0.047     0.093     0.634    41.134     0.530     0.879     0.492 
## count_birth_order2/3          0.023     0.037    -0.049     0.096     0.629    35.148     0.534     1.024     0.532 
## count_birth_order3/3          0.035     0.034    -0.033     0.102     1.005    44.887     0.321     0.811     0.471 
## count_birth_order1/4         -0.056     0.039    -0.131     0.020    -1.446   118.961     0.151     0.379     0.287 
## count_birth_order2/4         -0.024     0.044    -0.111     0.063    -0.545    44.266     0.588     0.821     0.474 
## count_birth_order3/4         -0.052     0.039    -0.129     0.025    -1.317    73.939     0.192     0.536     0.366 
## count_birth_order4/4         -0.015     0.046    -0.106     0.075    -0.332    28.909     0.742     1.262     0.586 
## count_birth_order1/5         -0.042     0.055    -0.149     0.066    -0.760    44.787     0.451     0.813     0.471 
## count_birth_order2/5         -0.030     0.048    -0.125     0.064    -0.624   131.171     0.534     0.355     0.273 
## count_birth_order3/5         -0.006     0.044    -0.093     0.080    -0.147   224.701     0.883     0.250     0.207 
## count_birth_order4/5         -0.036     0.046    -0.126     0.054    -0.789   118.647     0.432     0.380     0.287 
## count_birth_order5/5          0.005     0.043    -0.080     0.090     0.105    97.728     0.917     0.436     0.317 
## count_birth_order1/5+        -0.138     0.037    -0.211    -0.066    -3.729   134.457     0.000     0.349     0.270 
## count_birth_order2/5+        -0.144     0.042    -0.225    -0.062    -3.436    53.585     0.001     0.694     0.431 
## count_birth_order3/5+        -0.153     0.042    -0.234    -0.071    -3.671    45.500     0.001     0.801     0.468 
## count_birth_order4/5+        -0.158     0.045    -0.246    -0.071    -3.547    31.052     0.001     1.166     0.565 
## count_birth_order5/5+        -0.163     0.041    -0.243    -0.084    -4.032    42.276     0.000     0.857     0.485 
## count_birth_order5+/5+       -0.129     0.035    -0.198    -0.060    -3.689    25.765     0.001     1.445     0.619 
## poly(age, 3, raw = TRUE)1    -0.012     0.005    -0.022    -0.002    -2.396    20.877     0.026     1.912     0.685 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.314    43.924     0.755     0.827     0.476 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.201    39.353     0.237     0.917     0.503 
## male                         -0.044     0.013    -0.069    -0.018    -3.355    47.701     0.002     0.768     0.457 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-91" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-249-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-22" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.324      10 238.520   0.974   1.501 
##  2 vs 3:   0.338       4  69.324   0.851   2.203 
##  3 vs 4:   0.289       1  10.811   0.602   4.654</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-11" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-23" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-92" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.358     0.056     0.249     0.467     6.453    11.678     0.000     7.189     0.895 
## poly(age, 3, raw = TRUE)1    -0.014     0.005    -0.023    -0.005    -3.001    19.138     0.007     2.182     0.714 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.336    22.333     0.740     1.738     0.664 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.039    18.227     0.312     2.363     0.731 
## male                         -0.041     0.013    -0.067    -0.015    -3.059    47.149     0.004     0.776     0.459 
## sibling_count3               -0.001     0.024    -0.048     0.046    -0.042    30.284     0.967     1.198     0.572 
## sibling_count4               -0.032     0.033    -0.096     0.032    -0.982    21.918     0.337     1.784     0.670 
## sibling_count5               -0.095     0.036    -0.165    -0.024    -2.644    27.603     0.013     1.331     0.599 
## sibling_count5+              -0.166     0.031    -0.226    -0.106    -5.393    30.475     0.000     1.190     0.571 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.688 
## ICC|mother_pidlink                     0.265 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-92" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-252-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-23" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-93" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.324     0.065     0.197     0.451     5.008    11.257     0.000     8.447     0.909 
## birth_order                   0.016     0.008    -0.001     0.032     1.877    14.092     0.081     3.979     0.823 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.022    -0.004    -2.935    18.853     0.009     2.236     0.719 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.532    24.672     0.600     1.525     0.633 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.298    20.191     0.209     2.009     0.696 
## male                         -0.041     0.013    -0.067    -0.015    -3.053    46.724     0.004     0.782     0.461 
## sibling_count3               -0.011     0.024    -0.058     0.036    -0.469    30.042     0.643     1.209     0.575 
## sibling_count4               -0.053     0.029    -0.111     0.005    -1.797    31.778     0.082     1.138     0.559 
## sibling_count5               -0.127     0.031    -0.188    -0.065    -4.053    63.208     0.000     0.606     0.396 
## sibling_count5+              -0.220     0.036    -0.291    -0.148    -6.036    29.793     0.000     1.220     0.577 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.265 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-93" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-23" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-94" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.345     0.058     0.232     0.459     5.954    12.352     0.000     5.831     0.873 
## birth_order_nonlinear2        0.012     0.018    -0.024     0.047     0.645    34.439     0.523     1.046     0.537 
## birth_order_nonlinear3        0.025     0.023    -0.021     0.071     1.061    32.318     0.297     1.117     0.554 
## birth_order_nonlinear4        0.040     0.030    -0.019     0.099     1.338    33.818     0.190     1.066     0.542 
## birth_order_nonlinear5        0.032     0.037    -0.041     0.106     0.858    36.952     0.396     0.974     0.519 
## birth_order_nonlinear5+       0.078     0.059    -0.037     0.193     1.329    14.324     0.205     3.823     0.817 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.022    -0.005    -3.037    21.514     0.006     1.831     0.676 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.554    26.713     0.584     1.383     0.609 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.358    22.304     0.188     1.741     0.664 
## male                         -0.042     0.014    -0.069    -0.015    -3.037    40.576     0.004     0.890     0.495 
## sibling_count3               -0.010     0.025    -0.059     0.040    -0.379    29.108     0.707     1.252     0.584 
## sibling_count4               -0.053     0.031    -0.113     0.007    -1.719    32.035     0.095     1.128     0.557 
## sibling_count5               -0.121     0.031    -0.183    -0.060    -3.867    84.818     0.000     0.483     0.341 
## sibling_count5+              -0.211     0.037    -0.284    -0.139    -5.711    31.381     0.000     1.153     0.563 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.249 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.266 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-94" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-256-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-23" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-95" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.338     0.057     0.226     0.450     5.923    13.555     0.000     4.401     0.837 
## count_birth_order2/2          0.020     0.029    -0.037     0.078     0.684    23.895     0.500     1.589     0.642 
## count_birth_order1/3         -0.001     0.039    -0.079     0.076    -0.035    22.809     0.973     1.689     0.657 
## count_birth_order2/3          0.000     0.034    -0.067     0.067     0.011    28.389     0.992     1.289     0.591 
## count_birth_order3/3          0.019     0.033    -0.047     0.085     0.568    37.520     0.573     0.960     0.515 
## count_birth_order1/4         -0.044     0.044    -0.129     0.042    -1.001    45.819     0.322     0.796     0.466 
## count_birth_order2/4         -0.041     0.050    -0.140     0.058    -0.817    21.003     0.423     1.895     0.683 
## count_birth_order3/4         -0.038     0.041    -0.118     0.042    -0.936    42.587     0.354     0.851     0.483 
## count_birth_order4/4         -0.003     0.051    -0.103     0.097    -0.061    22.141     0.952     1.759     0.666 
## count_birth_order1/5         -0.110     0.055    -0.219    -0.002    -1.990    63.722     0.051     0.602     0.395 
## count_birth_order2/5         -0.128     0.052    -0.230    -0.027    -2.478    59.983     0.016     0.632     0.407 
## count_birth_order3/5         -0.094     0.057    -0.205     0.017    -1.653    31.901     0.108     1.133     0.558 
## count_birth_order4/5         -0.070     0.062    -0.191     0.052    -1.122    23.913     0.273     1.587     0.642 
## count_birth_order5/5         -0.071     0.055    -0.179     0.037    -1.281    42.797     0.207     0.847     0.482 
## count_birth_order1/5+        -0.235     0.060    -0.353    -0.117    -3.911    31.105     0.000     1.164     0.565 
## count_birth_order2/5+        -0.194     0.066    -0.324    -0.064    -2.919    19.058     0.009     2.197     0.716 
## count_birth_order3/5+        -0.165     0.044    -0.251    -0.080    -3.799    78.832     0.000     0.510     0.354 
## count_birth_order4/5+        -0.177     0.050    -0.276    -0.079    -3.535    35.376     0.001     1.018     0.530 
## count_birth_order5/5+        -0.186     0.046    -0.276    -0.096    -4.058    48.244     0.000     0.760     0.454 
## count_birth_order5+/5+       -0.128     0.043    -0.213    -0.043    -2.948    24.432     0.007     1.544     0.636 
## poly(age, 3, raw = TRUE)1    -0.013     0.005    -0.022    -0.004    -2.786    21.479     0.011     1.835     0.676 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.444    26.162     0.660     1.418     0.615 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.281    22.460     0.213     1.725     0.662 
## male                         -0.042     0.014    -0.069    -0.015    -3.040    43.290     0.004     0.838     0.479 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.249 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.266 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-95" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-258-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-23" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.371      10  91.063   0.956 158.752 
##  2 vs 3:   0.374       4  36.141   0.825 428.472 
##  3 vs 4:   3.628       1  11.235   0.083   3.832</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-11" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2007-young" class="section level3 tabset">
<h3>g-factor 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-12" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-24" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-96" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.502     0.048    -0.597    -0.408   -10.424    12.718     0.000     5.299     0.861 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.018     0.039     5.472    15.967     0.000     3.012     0.777 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.316    21.496     0.755     1.833     0.676 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.524    27.847     0.139     1.318     0.596 
## male                          0.002     0.013    -0.024     0.028     0.130    36.549     0.898     0.985     0.522 
## sibling_count3                0.004     0.023    -0.040     0.049     0.179    76.268     0.859     0.523     0.360 
## sibling_count4               -0.045     0.032    -0.108     0.019    -1.376    27.658     0.180     1.328     0.598 
## sibling_count5               -0.023     0.027    -0.076     0.030    -0.860   228.791     0.391     0.247     0.205 
## sibling_count5+              -0.172     0.025    -0.220    -0.123    -6.900    42.964     0.000     0.844     0.481 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.263 
## Residual~~Residual                     0.615 
## ICC|mother_pidlink                     0.300 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-96" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-24" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-97" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.526     0.049    -0.622    -0.429   -10.691    12.942     0.000     5.021     0.855 
## birth_order                   0.010     0.005     0.000     0.020     1.964    15.252     0.068     3.313     0.794 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.018     0.039     5.463    15.966     0.000     3.013     0.777 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.511    22.136     0.614     1.760     0.666 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.750    29.686     0.091     1.225     0.578 
## male                          0.002     0.013    -0.024     0.027     0.120    36.606     0.905     0.984     0.521 
## sibling_count3               -0.002     0.023    -0.048     0.043    -0.105    63.164     0.917     0.606     0.396 
## sibling_count4               -0.059     0.033    -0.124     0.007    -1.755    26.206     0.091     1.416     0.614 
## sibling_count5               -0.045     0.027    -0.097     0.008    -1.654   370.013     0.099     0.185     0.160 
## sibling_count5+              -0.218     0.033    -0.283    -0.152    -6.529    26.485     0.000     1.398     0.611 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.265 
## Residual~~Residual                     0.613 
## ICC|mother_pidlink                     0.301 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-97" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-264-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-24" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-98" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.526     0.051    -0.626    -0.426   -10.340    13.539     0.000     4.415     0.838 
## birth_order_nonlinear2        0.023     0.017    -0.011     0.057     1.350    39.282     0.185     0.918     0.503 
## birth_order_nonlinear3        0.024     0.023    -0.021     0.069     1.033    29.230     0.310     1.247     0.583 
## birth_order_nonlinear4        0.033     0.031    -0.028     0.093     1.058    22.788     0.301     1.691     0.657 
## birth_order_nonlinear5        0.036     0.040    -0.042     0.115     0.902    18.654     0.378     2.274     0.723 
## birth_order_nonlinear5+       0.071     0.039    -0.006     0.147     1.817    16.626     0.087     2.784     0.763 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.020     0.039     5.838    17.680     0.000     2.490     0.741 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.287    25.514     0.777     1.463     0.622 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.558    35.398     0.128     1.017     0.530 
## male                          0.002     0.013    -0.024     0.027     0.122    37.222     0.903     0.967     0.517 
## sibling_count3               -0.002     0.023    -0.047     0.044    -0.066    86.504     0.947     0.476     0.338 
## sibling_count4               -0.057     0.033    -0.121     0.007    -1.745    33.224     0.090     1.085     0.547 
## sibling_count5               -0.041     0.028    -0.096     0.015    -1.443   481.444     0.150     0.158     0.140 
## sibling_count5+              -0.212     0.034    -0.278    -0.145    -6.266    29.917     0.000     1.215     0.576 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.614 
## ICC|mother_pidlink                     0.301 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-98" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-266-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-24" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-99" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.543     0.052    -0.644    -0.441   -10.459    14.870     0.000     3.504     0.803 
## count_birth_order2/2          0.038     0.026    -0.013     0.090     1.461    38.122     0.152     0.945     0.511 
## count_birth_order1/3          0.010     0.035    -0.058     0.078     0.279    41.387     0.781     0.874     0.490 
## count_birth_order2/3          0.011     0.038    -0.063     0.085     0.291    29.996     0.773     1.211     0.575 
## count_birth_order3/3          0.041     0.033    -0.024     0.105     1.238    48.981     0.222     0.750     0.451 
## count_birth_order1/4         -0.046     0.042    -0.129     0.036    -1.101    48.577     0.276     0.756     0.453 
## count_birth_order2/4         -0.014     0.046    -0.103     0.076    -0.297    33.149     0.769     1.088     0.548 
## count_birth_order3/4         -0.062     0.038    -0.138     0.013    -1.630    69.163     0.108     0.564     0.378 
## count_birth_order4/4         -0.002     0.057    -0.113     0.109    -0.037    17.142     0.971     2.631     0.752 
## count_birth_order1/5         -0.042     0.049    -0.139     0.054    -0.860    69.439     0.393     0.563     0.378 
## count_birth_order2/5         -0.032     0.052    -0.133     0.070    -0.613    55.225     0.542     0.677     0.424 
## count_birth_order3/5         -0.006     0.048    -0.100     0.087    -0.132    68.582     0.895     0.568     0.380 
## count_birth_order4/5         -0.017     0.044    -0.104     0.069    -0.390   117.622     0.697     0.382     0.289 
## count_birth_order5/5          0.029     0.049    -0.068     0.126     0.587    36.426     0.561     0.988     0.523 
## count_birth_order1/5+        -0.198     0.042    -0.280    -0.115    -4.703    41.846     0.000     0.865     0.488 
## count_birth_order2/5+        -0.178     0.046    -0.268    -0.087    -3.844    29.615     0.001     1.229     0.579 
## count_birth_order3/5+        -0.171     0.050    -0.269    -0.072    -3.402    21.653     0.003     1.815     0.674 
## count_birth_order4/5+        -0.181     0.047    -0.273    -0.089    -3.847    23.961     0.001     1.583     0.642 
## count_birth_order5/5+        -0.187     0.038    -0.262    -0.111    -4.847    45.494     0.000     0.801     0.468 
## count_birth_order5+/5+       -0.136     0.031    -0.196    -0.075    -4.406    35.922     0.000     1.002     0.526 
## poly(age, 3, raw = TRUE)1     0.031     0.005     0.021     0.041     6.348    20.426     0.000     1.974     0.692 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.002    32.119     0.998     1.125     0.556 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.351    46.785     0.183     0.781     0.461 
## male                          0.001     0.013    -0.024     0.027     0.112    37.584     0.911     0.958     0.515 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.614 
## ICC|mother_pidlink                     0.301 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-99" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-24" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.369      10 209.141   0.959   1.796 
##  2 vs 3:  -0.066       4  64.209   1.000   2.541 
##  3 vs 4:   3.813       1  11.592   0.075   3.349</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-12" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-25" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-100" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.509     0.044    -0.596    -0.423   -11.519    13.420     0.000     4.523     0.841 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.018     0.039     5.420    14.700     0.000     3.597     0.807 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.078    16.799     0.939     2.731     0.759 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.801    16.484     0.435     2.830     0.766 
## male                          0.006     0.013    -0.020     0.032     0.467    39.111     0.643     0.922     0.504 
## sibling_count3                0.005     0.024    -0.042     0.052     0.222    27.144     0.826     1.357     0.604 
## sibling_count4               -0.035     0.027    -0.088     0.018    -1.280    36.409     0.209     0.989     0.523 
## sibling_count5               -0.095     0.027    -0.147    -0.042    -3.530   126.698     0.001     0.363     0.278 
## sibling_count5+              -0.182     0.027    -0.234    -0.130    -6.842    56.821     0.000     0.661     0.418 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.267 
## Residual~~Residual                     0.615 
## ICC|mother_pidlink                     0.303 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-100" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-271-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-25" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-101" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.563     0.046    -0.654    -0.472   -12.122    13.849     0.000     4.158     0.829 
## birth_order                   0.024     0.007     0.011     0.036     3.622    18.152     0.002     2.380     0.732 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.019     0.039     5.455    14.624     0.000     3.640     0.809 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.177    16.853     0.861     2.714     0.758 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.111    16.675     0.282     2.769     0.762 
## male                          0.006     0.013    -0.020     0.032     0.470    38.939     0.641     0.926     0.506 
## sibling_count3               -0.011     0.025    -0.060     0.038    -0.423    25.128     0.676     1.490     0.627 
## sibling_count4               -0.067     0.029    -0.123    -0.011    -2.340    32.857     0.025     1.098     0.550 
## sibling_count5               -0.144     0.030    -0.202    -0.086    -4.872    80.691     0.000     0.501     0.350 
## sibling_count5+              -0.263     0.035    -0.331    -0.195    -7.570    32.703     0.000     1.103     0.551 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.267 
## Residual~~Residual                     0.614 
## ICC|mother_pidlink                     0.303 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-101" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-273-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-25" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-102" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.533     0.046    -0.623    -0.443   -11.597    14.763     0.000     3.562     0.805 
## birth_order_nonlinear2        0.018     0.015    -0.011     0.048     1.238    76.173     0.220     0.524     0.360 
## birth_order_nonlinear3        0.042     0.021     0.002     0.082     2.049    45.264     0.046     0.805     0.469 
## birth_order_nonlinear4        0.051     0.026     0.001     0.102     1.984    54.508     0.052     0.684     0.427 
## birth_order_nonlinear5        0.051     0.042    -0.031     0.133     1.223    22.407     0.234     1.731     0.663 
## birth_order_nonlinear5+       0.128     0.043     0.043     0.212     2.956    21.085     0.008     1.885     0.682 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.019     0.039     5.472    15.330     0.000     3.277     0.792 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.198    18.123     0.845     2.386     0.733 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.167    18.099     0.258     2.392     0.733 
## male                          0.005     0.014    -0.022     0.032     0.379    35.638     0.707     1.010     0.528 
## sibling_count3               -0.008     0.026    -0.059     0.043    -0.314    24.863     0.756     1.510     0.630 
## sibling_count4               -0.062     0.029    -0.119    -0.005    -2.139    36.450     0.039     0.988     0.522 
## sibling_count5               -0.132     0.030    -0.192    -0.072    -4.329    87.768     0.000     0.471     0.335 
## sibling_count5+              -0.250     0.036    -0.320    -0.180    -7.004    33.107     0.000     1.089     0.548 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.267 
## Residual~~Residual                     0.612 
## ICC|mother_pidlink                     0.304 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-102" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-275-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-25" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-103" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.546     0.045    -0.634    -0.458   -12.181    17.465     0.000     2.544     0.745 
## count_birth_order2/2          0.035     0.025    -0.014     0.084     1.384    33.084     0.176     1.090     0.548 
## count_birth_order1/3          0.013     0.031    -0.048     0.074     0.411    45.565     0.683     0.800     0.467 
## count_birth_order2/3          0.005     0.027    -0.047     0.057     0.191    79.096     0.849     0.509     0.353 
## count_birth_order3/3          0.040     0.033    -0.024     0.104     1.230    35.863     0.227     1.004     0.527 
## count_birth_order1/4         -0.053     0.037    -0.127     0.020    -1.420    97.504     0.159     0.436     0.318 
## count_birth_order2/4         -0.038     0.041    -0.120     0.043    -0.924    32.495     0.362     1.111     0.553 
## count_birth_order3/4         -0.034     0.035    -0.102     0.035    -0.963    84.087     0.338     0.486     0.343 
## count_birth_order4/4          0.013     0.038    -0.062     0.087     0.334    59.256     0.740     0.639     0.409 
## count_birth_order1/5         -0.097     0.055    -0.204     0.010    -1.781    54.746     0.080     0.682     0.426 
## count_birth_order2/5         -0.134     0.048    -0.229    -0.039    -2.770    72.214     0.007     0.546     0.370 
## count_birth_order3/5         -0.071     0.054    -0.177     0.034    -1.330    33.846     0.192     1.065     0.542 
## count_birth_order4/5         -0.101     0.045    -0.189    -0.012    -2.228    85.406     0.028     0.481     0.340 
## count_birth_order5/5         -0.049     0.061    -0.168     0.070    -0.806    25.936     0.428     1.434     0.617 
## count_birth_order1/5+        -0.296     0.052    -0.398    -0.195    -5.718    49.577     0.000     0.742     0.448 
## count_birth_order2/5+        -0.229     0.056    -0.338    -0.120    -4.123    26.137     0.000     1.420     0.615 
## count_birth_order3/5+        -0.171     0.049    -0.268    -0.075    -3.480    33.313     0.001     1.082     0.546 
## count_birth_order4/5+        -0.191     0.047    -0.283    -0.098    -4.029    38.522     0.000     0.936     0.508 
## count_birth_order5/5+        -0.207     0.038    -0.282    -0.132    -5.408   154.160     0.000     0.319     0.251 
## count_birth_order5+/5+       -0.113     0.036    -0.185    -0.042    -3.111    40.766     0.003     0.886     0.494 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.020     0.039     6.059    18.053     0.000     2.402     0.734 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.041    21.741     0.968     1.804     0.672 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.085    20.321     0.291     1.990     0.694 
## male                          0.005     0.013    -0.021     0.032     0.410    40.416     0.684     0.894     0.496 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.268 
## Residual~~Residual                     0.610 
## ICC|mother_pidlink                     0.305 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-103" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-25" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.355      10  91.064   0.962 158.519 
##  2 vs 3:   0.378       4  36.141   0.823 428.842 
##  3 vs 4:  12.606       1  12.575   0.004   2.513</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-12" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-279-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2007-young" class="section level3 tabset">
<h3>Raven 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-13" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-26" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-104" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.554     0.045    -0.642    -0.465   -12.232    13.280     0.000     4.657     0.845 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.021     0.040     6.166    17.384     0.000     2.565     0.747 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.245    22.552     0.809     1.715     0.661 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.349    28.866     0.188     1.264     0.586 
## male                          0.037     0.013     0.011     0.062     2.832    38.135     0.007     0.945     0.511 
## sibling_count3               -0.001     0.023    -0.046     0.043    -0.056    70.673     0.955     0.555     0.374 
## sibling_count4               -0.036     0.032    -0.100     0.028    -1.111    26.134     0.277     1.420     0.615 
## sibling_count5               -0.036     0.028    -0.091     0.019    -1.277   114.149     0.204     0.390     0.293 
## sibling_count5+              -0.166     0.025    -0.215    -0.118    -6.736    41.253     0.000     0.876     0.491 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-104" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-26" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-105" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.568     0.045    -0.656    -0.480   -12.651    13.906     0.000     4.115     0.828 
## birth_order                   0.006     0.005    -0.003     0.015     1.301    16.680     0.211     2.767     0.762 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.021     0.040     6.158    17.370     0.000     2.569     0.747 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.360    22.672     0.722     1.703     0.659 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.475    29.646     0.151     1.227     0.578 
## male                          0.037     0.013     0.011     0.062     2.829    38.264     0.007     0.942     0.510 
## sibling_count3               -0.005     0.023    -0.050     0.040    -0.229    63.388     0.820     0.605     0.396 
## sibling_count4               -0.045     0.033    -0.110     0.020    -1.348    25.590     0.189     1.457     0.622 
## sibling_count5               -0.049     0.027    -0.102     0.004    -1.814   267.459     0.071     0.225     0.189 
## sibling_count5+              -0.194     0.034    -0.260    -0.128    -5.775    24.725     0.000     1.521     0.632 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-105" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-26" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-106" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.569     0.045    -0.658    -0.480   -12.552    15.136     0.000     3.369     0.796 
## birth_order_nonlinear2        0.015     0.017    -0.019     0.049     0.852    39.336     0.399     0.917     0.503 
## birth_order_nonlinear3        0.015     0.022    -0.028     0.059     0.685    33.577     0.498     1.074     0.544 
## birth_order_nonlinear4        0.023     0.029    -0.034     0.080     0.785    25.980     0.440     1.431     0.617 
## birth_order_nonlinear5        0.024     0.036    -0.047     0.095     0.658    22.595     0.517     1.711     0.660 
## birth_order_nonlinear5+       0.043     0.039    -0.034     0.120     1.096    16.214     0.289     2.922     0.772 
## poly(age, 3, raw = TRUE)1     0.031     0.005     0.021     0.040     6.475    19.407     0.000     2.135     0.709 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.207    24.996     0.838     1.500     0.629 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.339    33.553     0.189     1.074     0.544 
## male                          0.037     0.013     0.011     0.062     2.833    38.507     0.007     0.936     0.508 
## sibling_count3               -0.005     0.023    -0.051     0.041    -0.205    73.045     0.838     0.541     0.368 
## sibling_count4               -0.044     0.033    -0.110     0.021    -1.340    29.700     0.191     1.225     0.578 
## sibling_count5               -0.047     0.030    -0.106     0.011    -1.592   137.856     0.114     0.343     0.266 
## sibling_count5+              -0.191     0.037    -0.263    -0.119    -5.219    22.946     0.000     1.676     0.655 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-106" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-26" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-107" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.582     0.045    -0.670    -0.493   -12.917    17.849     0.000     2.449     0.738 
## count_birth_order2/2          0.025     0.023    -0.020     0.071     1.102    81.087     0.274     0.500     0.349 
## count_birth_order1/3          0.004     0.032    -0.058     0.066     0.125    63.816     0.901     0.601     0.394 
## count_birth_order2/3         -0.000     0.036    -0.071     0.071    -0.000    32.946     1.000     1.095     0.549 
## count_birth_order3/3          0.024     0.033    -0.040     0.089     0.737    46.101     0.465     0.792     0.465 
## count_birth_order1/4         -0.039     0.042    -0.122     0.044    -0.913    44.841     0.366     0.812     0.471 
## count_birth_order2/4         -0.012     0.046    -0.103     0.079    -0.262    30.961     0.795     1.170     0.566 
## count_birth_order3/4         -0.059     0.038    -0.134     0.016    -1.535    66.354     0.130     0.583     0.387 
## count_birth_order4/4         -0.000     0.053    -0.105     0.104    -0.008    18.637     0.993     2.278     0.723 
## count_birth_order1/5         -0.045     0.045    -0.134     0.043    -1.010   148.324     0.314     0.327     0.256 
## count_birth_order2/5         -0.036     0.049    -0.133     0.060    -0.739    74.081     0.462     0.535     0.365 
## count_birth_order3/5         -0.043     0.042    -0.126     0.041    -1.005   204.371     0.316     0.266     0.217 
## count_birth_order4/5         -0.036     0.049    -0.132     0.060    -0.730    51.104     0.469     0.723     0.441 
## count_birth_order5/5          0.010     0.049    -0.085     0.105     0.205    37.473     0.839     0.961     0.515 
## count_birth_order1/5+        -0.185     0.040    -0.264    -0.105    -4.567    49.196     0.000     0.747     0.450 
## count_birth_order2/5+        -0.172     0.053    -0.276    -0.068    -3.241    20.386     0.004     1.980     0.693 
## count_birth_order3/5+        -0.149     0.045    -0.236    -0.061    -3.338    29.186     0.002     1.249     0.583 
## count_birth_order4/5+        -0.173     0.039    -0.250    -0.096    -4.421    44.592     0.000     0.816     0.472 
## count_birth_order5/5+        -0.182     0.038    -0.255    -0.108    -4.814    48.864     0.000     0.752     0.451 
## count_birth_order5+/5+       -0.145     0.029    -0.202    -0.088    -4.956    43.463     0.000     0.835     0.479 
## poly(age, 3, raw = TRUE)1     0.032     0.005     0.023     0.041     6.804    21.659     0.000     1.814     0.673 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.037    27.806     0.971     1.320     0.597 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.135    38.105     0.264     0.945     0.511 
## male                          0.037     0.013     0.011     0.062     2.828    38.547     0.007     0.935     0.508 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-107" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-26" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.377      10 214.079   0.956   1.737 
##  2 vs 3:   0.134       4  64.145   0.969   2.546 
##  3 vs 4:   1.704       1  12.247   0.216   2.736</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-13" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-27" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-108" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.561     0.044    -0.648    -0.474   -12.676    13.307     0.000     4.631     0.844 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.021     0.040     6.178    16.115     0.000     2.957     0.774 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.088    18.548     0.930     2.296     0.725 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.783    19.188     0.443     2.173     0.713 
## male                          0.042     0.013     0.017     0.067     3.280    43.552     0.002     0.833     0.478 
## sibling_count3               -0.000     0.022    -0.043     0.042    -0.011    36.689     0.991     0.981     0.521 
## sibling_count4               -0.040     0.024    -0.087     0.008    -1.622    56.457     0.110     0.665     0.419 
## sibling_count5               -0.093     0.025    -0.143    -0.043    -3.659   218.229     0.000     0.255     0.210 
## sibling_count5+              -0.175     0.029    -0.232    -0.118    -5.987    33.282     0.000     1.083     0.546 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.618 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-108" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-27" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-109" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.599     0.044    -0.685    -0.513   -13.634    14.524     0.000     3.699     0.811 
## birth_order                   0.017     0.006     0.004     0.029     2.612    18.473     0.017     2.311     0.726 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.021     0.040     6.213    16.076     0.000     2.972     0.775 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.098    18.326     0.923     2.342     0.729 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.009    19.077     0.326     2.193     0.715 
## male                          0.042     0.013     0.017     0.068     3.280    43.363     0.002     0.837     0.479 
## sibling_count3               -0.011     0.024    -0.058     0.035    -0.488    28.824     0.629     1.266     0.587 
## sibling_count4               -0.062     0.026    -0.113    -0.012    -2.408    47.731     0.020     0.768     0.457 
## sibling_count5               -0.128     0.029    -0.185    -0.071    -4.424    88.222     0.000     0.469     0.334 
## sibling_count5+              -0.233     0.042    -0.315    -0.151    -5.546    19.293     0.000     2.155     0.711 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.617 
## ICC|mother_pidlink                     0.287 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-109" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-27" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-110" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.575     0.044    -0.661    -0.489   -13.035    15.307     0.000     3.288     0.792 
## birth_order_nonlinear2        0.012     0.015    -0.017     0.041     0.797    81.624     0.428     0.497     0.348 
## birth_order_nonlinear3        0.031     0.020    -0.009     0.071     1.509    47.315     0.138     0.773     0.459 
## birth_order_nonlinear4        0.029     0.025    -0.021     0.078     1.138    61.384     0.259     0.621     0.402 
## birth_order_nonlinear5        0.023     0.045    -0.064     0.111     0.524    19.601     0.606     2.102     0.706 
## birth_order_nonlinear5+       0.093     0.041     0.014     0.173     2.300    24.214     0.030     1.562     0.638 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.020     0.039     6.194    17.054     0.000     2.656     0.754 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.185    19.187     0.855     2.173     0.713 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.098    19.587     0.285     2.104     0.706 
## male                          0.041     0.013     0.016     0.067     3.148    41.015     0.003     0.881     0.493 
## sibling_count3               -0.010     0.024    -0.058     0.037    -0.418    29.455     0.679     1.236     0.580 
## sibling_count4               -0.057     0.028    -0.111    -0.003    -2.083    43.954     0.043     0.826     0.476 
## sibling_count5               -0.116     0.031    -0.175    -0.056    -3.781    77.743     0.000     0.516     0.357 
## sibling_count5+              -0.222     0.042    -0.305    -0.139    -5.257    20.156     0.000     2.014     0.697 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.614 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-110" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-27" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-111" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.587     0.043    -0.671    -0.502   -13.643    18.410     0.000     2.324     0.727 
## count_birth_order2/2          0.024     0.024    -0.023     0.071     0.999    38.605     0.324     0.934     0.508 
## count_birth_order1/3          0.001     0.030    -0.058     0.061     0.034    49.488     0.973     0.744     0.448 
## count_birth_order2/3         -0.003     0.027    -0.056     0.051    -0.105    63.930     0.917     0.601     0.394 
## count_birth_order3/3          0.028     0.029    -0.029     0.085     0.961    60.770     0.340     0.626     0.404 
## count_birth_order1/4         -0.047     0.044    -0.133     0.039    -1.067    36.059     0.293     0.998     0.525 
## count_birth_order2/4         -0.045     0.041    -0.124     0.035    -1.102    34.551     0.278     1.042     0.536 
## count_birth_order3/4         -0.044     0.033    -0.110     0.021    -1.329   123.375     0.186     0.370     0.282 
## count_birth_order4/4         -0.005     0.037    -0.077     0.067    -0.131    68.048     0.896     0.572     0.382 
## count_birth_order1/5         -0.104     0.051    -0.205    -0.004    -2.037    81.869     0.045     0.496     0.347 
## count_birth_order2/5         -0.122     0.043    -0.207    -0.038    -2.851   257.486     0.005     0.230     0.193 
## count_birth_order3/5         -0.066     0.051    -0.166     0.035    -1.282    39.981     0.207     0.903     0.499 
## count_birth_order4/5         -0.104     0.056    -0.215     0.006    -1.848    27.406     0.075     1.342     0.601 
## count_birth_order5/5         -0.066     0.056    -0.177     0.044    -1.180    32.526     0.246     1.110     0.553 
## count_birth_order1/5+        -0.249     0.046    -0.339    -0.160    -5.469   126.487     0.000     0.364     0.278 
## count_birth_order2/5+        -0.211     0.058    -0.325    -0.097    -3.616    22.685     0.001     1.702     0.659 
## count_birth_order3/5+        -0.163     0.068    -0.296    -0.030    -2.397    15.967     0.029     3.012     0.777 
## count_birth_order4/5+        -0.197     0.048    -0.292    -0.103    -4.096    34.863     0.000     1.033     0.534 
## count_birth_order5/5+        -0.205     0.041    -0.286    -0.125    -4.994    72.702     0.000     0.543     0.369 
## count_birth_order5+/5+       -0.124     0.034    -0.190    -0.057    -3.633    54.803     0.001     0.681     0.426 
## poly(age, 3, raw = TRUE)1     0.031     0.005     0.022     0.040     6.740    20.176     0.000     2.011     0.697 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.032    23.143     0.975     1.657     0.652 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.045    23.392     0.307     1.633     0.649 
## male                          0.042     0.013     0.017     0.067     3.258    49.915     0.002     0.738     0.446 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.249 
## Residual~~Residual                     0.613 
## ICC|mother_pidlink                     0.289 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-111" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-296-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-27" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.348      10  91.062   0.965 158.901 
##  2 vs 3:   0.391       4  36.141   0.813 428.690 
##  3 vs 4:   6.865       1  12.966   0.021   2.294</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-13" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2007-young" class="section level3 tabset">
<h3>Numeracy 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-14" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-28" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-112" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.316     0.048    -0.411    -0.222    -6.581    13.122     0.000     4.820     0.849 
## poly(age, 3, raw = TRUE)1     0.019     0.005     0.009     0.030     3.544    15.865     0.003     3.051     0.779 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.280    19.409     0.783     2.134     0.709 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.155    21.909     0.261     1.785     0.670 
## male                         -0.034     0.013    -0.060    -0.008    -2.552    41.475     0.014     0.872     0.490 
## sibling_count3                0.008     0.022    -0.034     0.051     0.380   161.165     0.705     0.309     0.246 
## sibling_count4               -0.041     0.033    -0.105     0.022    -1.269    30.318     0.214     1.197     0.572 
## sibling_count5               -0.005     0.030    -0.063     0.054    -0.161   101.904     0.873     0.423     0.311 
## sibling_count5+              -0.132     0.027    -0.185    -0.078    -4.816    33.445     0.000     1.078     0.545 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.277 
## Residual~~Residual                     0.669 
## ICC|mother_pidlink                     0.293 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-112" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-300-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-28" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-113" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.341     0.052    -0.443    -0.240    -6.578    12.772     0.000     5.228     0.860 
## birth_order                   0.011     0.005     0.000     0.021     2.008    15.044     0.063     3.414     0.799 
## poly(age, 3, raw = TRUE)1     0.019     0.005     0.009     0.030     3.541    15.895     0.003     3.040     0.779 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.479    20.841     0.637     1.917     0.686 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.387    24.122     0.178     1.570     0.640 
## male                         -0.034     0.013    -0.060    -0.008    -2.566    41.619     0.014     0.869     0.489 
## sibling_count3                0.001     0.023    -0.043     0.046     0.056   100.988     0.955     0.426     0.312 
## sibling_count4               -0.056     0.032    -0.119     0.006    -1.763    33.681     0.087     1.070     0.543 
## sibling_count5               -0.028     0.031    -0.089     0.033    -0.890    86.033     0.376     0.478     0.339 
## sibling_count5+              -0.181     0.038    -0.256    -0.106    -4.738    20.696     0.000     1.936     0.688 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.278 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.294 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-113" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-28" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-114" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.342     0.053    -0.445    -0.239    -6.500    13.578     0.000     4.381     0.837 
## birth_order_nonlinear2        0.026     0.017    -0.007     0.059     1.540    56.588     0.129     0.663     0.419 
## birth_order_nonlinear3        0.026     0.023    -0.019     0.072     1.145    33.774     0.260     1.067     0.543 
## birth_order_nonlinear4        0.034     0.029    -0.023     0.090     1.166    31.305     0.252     1.156     0.563 
## birth_order_nonlinear5        0.039     0.040    -0.040     0.118     0.972    19.987     0.343     2.040     0.700 
## birth_order_nonlinear5+       0.078     0.039     0.001     0.154     1.991    17.531     0.062     2.527     0.744 
## poly(age, 3, raw = TRUE)1     0.020     0.005     0.010     0.031     3.888    17.821     0.001     2.456     0.738 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.262    25.185     0.795     1.486     0.626 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.225    29.595     0.230     1.229     0.579 
## male                         -0.034     0.013    -0.060    -0.008    -2.574    42.410     0.014     0.854     0.484 
## sibling_count3                0.002     0.022    -0.042     0.046     0.092   204.411     0.927     0.266     0.217 
## sibling_count4               -0.054     0.033    -0.118     0.010    -1.660    37.805     0.105     0.953     0.513 
## sibling_count5               -0.023     0.031    -0.085     0.039    -0.734   128.353     0.464     0.360     0.276 
## sibling_count5+              -0.175     0.037    -0.248    -0.102    -4.699    24.867     0.000     1.510     0.630 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.277 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.293 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-114" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-304-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-28" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-115" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.358     0.054    -0.464    -0.251    -6.575    14.703     0.000     3.595     0.807 
## count_birth_order2/2          0.041     0.029    -0.016     0.098     1.423    30.550     0.165     1.187     0.570 
## count_birth_order1/3          0.013     0.035    -0.056     0.082     0.361    45.720     0.720     0.798     0.467 
## count_birth_order2/3          0.019     0.035    -0.050     0.088     0.546    45.106     0.588     0.807     0.470 
## count_birth_order3/3          0.046     0.032    -0.017     0.110     1.425    65.168     0.159     0.591     0.390 
## count_birth_order1/4         -0.041     0.043    -0.126     0.043    -0.964    52.686     0.339     0.704     0.434 
## count_birth_order2/4         -0.011     0.045    -0.100     0.078    -0.251    40.343     0.803     0.895     0.497 
## count_birth_order3/4         -0.050     0.040    -0.127     0.028    -1.248    69.941     0.216     0.559     0.376 
## count_birth_order4/4         -0.003     0.053    -0.106     0.101    -0.051    20.651     0.960     1.943     0.689 
## count_birth_order1/5         -0.027     0.052    -0.128     0.074    -0.527    64.913     0.600     0.593     0.391 
## count_birth_order2/5         -0.019     0.054    -0.126     0.087    -0.352    51.726     0.727     0.716     0.438 
## count_birth_order3/5          0.032     0.055    -0.075     0.139     0.584    39.693     0.563     0.909     0.501 
## count_birth_order4/5          0.005     0.045    -0.083     0.093     0.116   155.038     0.908     0.317     0.251 
## count_birth_order5/5          0.041     0.053    -0.063     0.144     0.768    32.335     0.448     1.117     0.554 
## count_birth_order1/5+        -0.157     0.048    -0.251    -0.064    -3.312    30.147     0.002     1.205     0.574 
## count_birth_order2/5+        -0.135     0.045    -0.224    -0.046    -2.981    36.423     0.005     0.988     0.523 
## count_birth_order3/5+        -0.146     0.053    -0.249    -0.042    -2.764    21.133     0.012     1.878     0.681 
## count_birth_order4/5+        -0.140     0.055    -0.247    -0.032    -2.548    18.726     0.020     2.260     0.722 
## count_birth_order5/5+        -0.141     0.039    -0.218    -0.064    -3.576    49.355     0.001     0.745     0.449 
## count_birth_order5+/5+       -0.092     0.030    -0.151    -0.032    -3.014    45.108     0.004     0.807     0.470 
## poly(age, 3, raw = TRUE)1     0.022     0.005     0.012     0.031     4.275    20.553     0.000     1.956     0.690 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.020    32.275     0.984     1.119     0.555 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.059    37.807     0.297     0.953     0.513 
## male                         -0.034     0.013    -0.060    -0.008    -2.592    42.942     0.013     0.844     0.481 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.277 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.293 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-115" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-306-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-28" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.304      10 210.259   0.980   1.782 
##  2 vs 3:  -0.051       4  64.823   1.000   2.494 
##  3 vs 4:   3.950       1  11.475   0.071   3.492</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-14" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-29" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-116" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.321     0.042    -0.404    -0.238    -7.562    14.463     0.000     3.736     0.813 
## poly(age, 3, raw = TRUE)1     0.019     0.005     0.009     0.030     3.613    14.971     0.003     3.451     0.800 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.047    16.458     0.963     2.839     0.766 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.625    15.336     0.541     3.275     0.792 
## male                         -0.032     0.013    -0.058    -0.005    -2.361    44.036     0.023     0.825     0.475 
## sibling_count3                0.009     0.026    -0.041     0.060     0.361    24.878     0.721     1.509     0.630 
## sibling_count4               -0.021     0.031    -0.082     0.041    -0.657    24.771     0.517     1.517     0.631 
## sibling_count5               -0.072     0.034    -0.139    -0.005    -2.095    33.330     0.044     1.082     0.546 
## sibling_count5+              -0.141     0.034    -0.207    -0.075    -4.203    25.230     0.000     1.483     0.626 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.279 
## Residual~~Residual                     0.669 
## ICC|mother_pidlink                     0.295 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-116" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-29" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-117" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.375     0.049    -0.471    -0.279    -7.675    13.657     0.000     4.313     0.834 
## birth_order                   0.024     0.007     0.010     0.038     3.353    16.750     0.004     2.745     0.760 
## poly(age, 3, raw = TRUE)1     0.020     0.005     0.009     0.030     3.641    14.828     0.002     3.527     0.804 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.199    17.082     0.844     2.648     0.753 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.933    16.047     0.365     2.983     0.775 
## male                         -0.032     0.013    -0.058    -0.005    -2.357    43.873     0.023     0.828     0.476 
## sibling_count3               -0.007     0.026    -0.058     0.044    -0.260    24.364     0.797     1.550     0.636 
## sibling_count4               -0.053     0.032    -0.116     0.009    -1.683    26.306     0.104     1.409     0.613 
## sibling_count5               -0.122     0.039    -0.199    -0.045    -3.107    25.511     0.005     1.463     0.622 
## sibling_count5+              -0.224     0.044    -0.309    -0.138    -5.106    19.513     0.000     2.117     0.708 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.667 
## ICC|mother_pidlink                     0.295 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-117" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-311-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-29" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-118" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.347     0.046    -0.437    -0.257    -7.561    15.444     0.000     3.226     0.789 
## birth_order_nonlinear2        0.020     0.015    -0.010     0.050     1.330    92.797     0.187     0.452     0.326 
## birth_order_nonlinear3        0.042     0.021     0.001     0.083     2.022    51.818     0.048     0.715     0.438 
## birth_order_nonlinear4        0.060     0.028     0.005     0.115     2.124    41.846     0.040     0.865     0.488 
## birth_order_nonlinear5        0.066     0.043    -0.018     0.149     1.546    23.829     0.135     1.595     0.643 
## birth_order_nonlinear5+       0.126     0.050     0.027     0.225     2.504    17.164     0.023     2.625     0.751 
## poly(age, 3, raw = TRUE)1     0.020     0.005     0.010     0.030     3.744    15.807     0.002     3.075     0.781 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.153    19.431     0.880     2.131     0.709 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.935    18.115     0.362     2.388     0.733 
## male                         -0.033     0.014    -0.060    -0.005    -2.325    37.853     0.026     0.952     0.513 
## sibling_count3               -0.004     0.027    -0.057     0.048    -0.156    25.309     0.877     1.477     0.625 
## sibling_count4               -0.051     0.032    -0.113     0.012    -1.585    29.542     0.124     1.232     0.579 
## sibling_count5               -0.113     0.040    -0.191    -0.036    -2.866    27.970     0.008     1.311     0.595 
## sibling_count5+              -0.211     0.047    -0.303    -0.120    -4.527    18.373     0.000     2.332     0.728 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.667 
## ICC|mother_pidlink                     0.295 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-118" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-313-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-29" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-119" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.358     0.045    -0.447    -0.270    -7.942    18.348     0.000     2.337     0.728 
## count_birth_order2/2          0.036     0.024    -0.011     0.084     1.511    47.360     0.137     0.773     0.458 
## count_birth_order1/3          0.021     0.031    -0.040     0.082     0.678    56.091     0.500     0.668     0.421 
## count_birth_order2/3          0.011     0.028    -0.044     0.067     0.401    65.577     0.690     0.588     0.389 
## count_birth_order3/3          0.042     0.035    -0.027     0.110     1.189    31.756     0.243     1.138     0.559 
## count_birth_order1/4         -0.045     0.042    -0.127     0.036    -1.089    58.753     0.281     0.643     0.411 
## count_birth_order2/4         -0.022     0.040    -0.101     0.057    -0.544    42.435     0.589     0.854     0.484 
## count_birth_order3/4         -0.014     0.040    -0.093     0.065    -0.351    44.982     0.727     0.809     0.470 
## count_birth_order4/4          0.027     0.044    -0.060     0.114     0.615    33.643     0.543     1.071     0.544 
## count_birth_order1/5         -0.064     0.057    -0.177     0.048    -1.118    50.898     0.269     0.726     0.442 
## count_birth_order2/5         -0.110     0.059    -0.226     0.005    -1.877    32.476     0.069     1.112     0.553 
## count_birth_order3/5         -0.058     0.058    -0.173     0.056    -0.998    28.914     0.326     1.262     0.586 
## count_birth_order4/5         -0.070     0.047    -0.163     0.023    -1.470    78.190     0.145     0.513     0.356 
## count_birth_order5/5         -0.018     0.062    -0.140     0.104    -0.289    26.918     0.775     1.371     0.606 
## count_birth_order1/5+        -0.264     0.066    -0.394    -0.134    -3.970    23.180     0.001     1.653     0.652 
## count_birth_order2/5+        -0.186     0.061    -0.306    -0.066    -3.034    22.378     0.006     1.734     0.663 
## count_birth_order3/5+        -0.135     0.065    -0.261    -0.008    -2.082    18.379     0.052     2.331     0.728 
## count_birth_order4/5+        -0.133     0.048    -0.228    -0.039    -2.757    41.591     0.009     0.870     0.489 
## count_birth_order5/5+        -0.153     0.042    -0.234    -0.072    -3.687    96.967     0.000     0.438     0.319 
## count_birth_order5+/5+       -0.075     0.041    -0.155     0.006    -1.814    29.348     0.080     1.241     0.581 
## poly(age, 3, raw = TRUE)1     0.021     0.005     0.011     0.031     4.118    18.527     0.001     2.300     0.725 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.025    22.459     0.981     1.725     0.662 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.838    19.208     0.412     2.170     0.713 
## male                         -0.032     0.014    -0.059    -0.005    -2.326    41.561     0.025     0.870     0.489 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.280 
## Residual~~Residual                     0.665 
## ICC|mother_pidlink                     0.297 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-119" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-315-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-29" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.390      10  91.065   0.948 158.343 
##  2 vs 3:   0.374       4  36.141   0.826 428.952 
##  3 vs 4:  10.528       1  11.941   0.007   2.989</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-14" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-317-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="personality" class="section level2 tabset">
<h2>Personality</h2>
<div id="extraversion" class="section level3 tabset">
<h3>Extraversion</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_ext)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-15" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-30" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-120" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.184     0.039     0.107     0.260     4.711    16.474     0.000     2.833     0.766 
## poly(age, 3, raw = TRUE)1    -0.004     0.005    -0.013     0.005    -0.825    23.748     0.418     1.602     0.644 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.699    32.335     0.490     1.117     0.554 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.010    40.089     0.319     0.900     0.498 
## male                         -0.248     0.017    -0.280    -0.215   -14.935    25.983     0.000     1.430     0.617 
## sibling_count3               -0.004     0.021    -0.046     0.038    -0.188    83.585     0.851     0.488     0.344 
## sibling_count4               -0.016     0.025    -0.065     0.034    -0.617    56.551     0.539     0.664     0.419 
## sibling_count5               -0.019     0.028    -0.075     0.036    -0.690    59.072     0.493     0.640     0.410 
## sibling_count5+              -0.017     0.025    -0.067     0.033    -0.672    28.817     0.507     1.267     0.587 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-120" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-30" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-121" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.188     0.040     0.109     0.268     4.651    16.473     0.000     2.834     0.766 
## birth_order                  -0.002     0.004    -0.009     0.005    -0.589    46.216     0.559     0.790     0.464 
## poly(age, 3, raw = TRUE)1    -0.004     0.005    -0.013     0.005    -0.829    23.778     0.415     1.599     0.644 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.679    32.230     0.502     1.121     0.555 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.991    40.213     0.328     0.898     0.497 
## male                         -0.248     0.017    -0.280    -0.215   -14.940    26.016     0.000     1.428     0.617 
## sibling_count3               -0.003     0.021    -0.044     0.038    -0.129    93.558     0.898     0.450     0.324 
## sibling_count4               -0.013     0.025    -0.063     0.037    -0.510    61.330     0.612     0.621     0.402 
## sibling_count5               -0.015     0.028    -0.070     0.039    -0.550    74.957     0.584     0.530     0.363 
## sibling_count5+              -0.008     0.026    -0.059     0.043    -0.305    61.790     0.761     0.617     0.401 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-121" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-30" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-122" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.177     0.045     0.089     0.265     3.931    16.303     0.001     2.891     0.770 
## birth_order_nonlinear2        0.012     0.020    -0.026     0.051     0.625    46.506     0.535     0.785     0.463 
## birth_order_nonlinear3       -0.004     0.024    -0.052     0.044    -0.174    45.255     0.863     0.805     0.469 
## birth_order_nonlinear4       -0.007     0.026    -0.059     0.045    -0.269   103.570     0.788     0.418     0.308 
## birth_order_nonlinear5        0.009     0.037    -0.064     0.082     0.243    35.167     0.810     1.024     0.532 
## birth_order_nonlinear5+       0.005     0.031    -0.056     0.066     0.156    40.931     0.877     0.883     0.493 
## poly(age, 3, raw = TRUE)1    -0.004     0.005    -0.013     0.005    -0.783    23.850     0.441     1.593     0.643 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.670    34.303     0.507     1.050     0.538 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.991    45.638     0.327     0.799     0.467 
## male                         -0.248     0.017    -0.280    -0.215   -14.904    25.814     0.000     1.442     0.619 
## sibling_count3                0.000     0.023    -0.044     0.044     0.002    84.406     0.999     0.485     0.342 
## sibling_count4               -0.009     0.028    -0.065     0.047    -0.319    49.528     0.751     0.743     0.448 
## sibling_count5               -0.015     0.030    -0.075     0.044    -0.499    76.025     0.619     0.525     0.361 
## sibling_count5+              -0.014     0.028    -0.069     0.042    -0.490    60.912     0.626     0.624     0.404 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-122" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-30" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-123" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.184     0.045     0.095     0.273     4.046    19.584     0.001     2.105     0.706 
## count_birth_order2/2          0.004     0.029    -0.054     0.061     0.122    54.069     0.904     0.689     0.429 
## count_birth_order1/3         -0.003     0.030    -0.062     0.056    -0.114   244.731     0.909     0.237     0.198 
## count_birth_order2/3          0.005     0.040    -0.073     0.082     0.117    31.857     0.907     1.135     0.558 
## count_birth_order3/3         -0.006     0.033    -0.070     0.058    -0.182    72.160     0.856     0.546     0.370 
## count_birth_order1/4         -0.023     0.045    -0.111     0.065    -0.506    51.382     0.615     0.720     0.440 
## count_birth_order2/4          0.036     0.041    -0.044     0.116     0.884   101.950     0.379     0.423     0.311 
## count_birth_order3/4         -0.028     0.041    -0.109     0.053    -0.673    68.729     0.503     0.567     0.380 
## count_birth_order4/4         -0.033     0.041    -0.112     0.047    -0.812    60.615     0.420     0.627     0.405 
## count_birth_order1/5         -0.021     0.048    -0.116     0.074    -0.433   182.544     0.665     0.285     0.230 
## count_birth_order2/5         -0.037     0.049    -0.133     0.059    -0.750   198.062     0.454     0.271     0.221 
## count_birth_order3/5         -0.019     0.050    -0.118     0.080    -0.380    83.529     0.705     0.489     0.344 
## count_birth_order4/5         -0.003     0.057    -0.115     0.109    -0.049    37.189     0.961     0.968     0.517 
## count_birth_order5/5         -0.009     0.049    -0.105     0.086    -0.193    53.836     0.848     0.692     0.430 
## count_birth_order1/5+        -0.021     0.042    -0.103     0.061    -0.499    68.667     0.619     0.567     0.380 
## count_birth_order2/5+        -0.003     0.041    -0.083     0.077    -0.083    89.776     0.934     0.463     0.331 
## count_birth_order3/5+        -0.020     0.038    -0.095     0.055    -0.524   114.035     0.601     0.391     0.293 
## count_birth_order4/5+        -0.025     0.036    -0.096     0.047    -0.681   156.322     0.497     0.316     0.249 
## count_birth_order5/5+        -0.009     0.047    -0.102     0.083    -0.201    28.524     0.842     1.282     0.590 
## count_birth_order5+/5+       -0.013     0.032    -0.076     0.051    -0.394    31.541     0.696     1.147     0.561 
## poly(age, 3, raw = TRUE)1    -0.004     0.005    -0.014     0.006    -0.824    22.834     0.419     1.687     0.657 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.718    31.726     0.478     1.140     0.560 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.032    42.775     0.308     0.847     0.482 
## male                         -0.248     0.017    -0.280    -0.215   -14.953    26.081     0.000     1.424     0.616 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-123" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-325-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-30" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.298      10 228.123   0.981   1.592 
##  2 vs 3:   0.266       4  63.923   0.899   2.563 
##  3 vs 4:   0.342       1  23.518   0.564   0.797</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-15" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-31" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-124" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.174     0.033     0.109     0.238     5.266    21.348     0.000     1.851     0.678 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.010     0.006    -0.509    27.480     0.615     1.338     0.600 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.356    34.632     0.724     1.040     0.536 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.724    38.926     0.474     0.926     0.506 
## male                         -0.246     0.017    -0.279    -0.213   -14.658    26.316     0.000     1.408     0.613 
## sibling_count3               -0.009     0.019    -0.047     0.029    -0.464    65.631     0.644     0.588     0.389 
## sibling_count4               -0.013     0.026    -0.063     0.037    -0.503    37.625     0.618     0.957     0.514 
## sibling_count5               -0.031     0.027    -0.083     0.022    -1.152    79.081     0.253     0.509     0.354 
## sibling_count5+              -0.040     0.027    -0.094     0.013    -1.483    29.985     0.149     1.212     0.575 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.921 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-124" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-328-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-31" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-125" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.171     0.037     0.099     0.244     4.639    19.768     0.000     2.075     0.703 
## birth_order                   0.001     0.006    -0.010     0.012     0.193    33.280     0.848     1.083     0.546 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.010     0.006    -0.504    27.327     0.619     1.347     0.602 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.364    34.995     0.718     1.029     0.533 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.734    39.385     0.467     0.916     0.503 
## male                         -0.246     0.017    -0.279    -0.213   -14.660    26.322     0.000     1.408     0.613 
## sibling_count3               -0.010     0.020    -0.049     0.030    -0.483    58.048     0.631     0.650     0.414 
## sibling_count4               -0.014     0.026    -0.066     0.038    -0.538    37.940     0.593     0.950     0.512 
## sibling_count5               -0.033     0.028    -0.087     0.021    -1.191    96.615     0.237     0.439     0.319 
## sibling_count5+              -0.044     0.034    -0.111     0.022    -1.299    29.683     0.204     1.225     0.578 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.921 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-125" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-31" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-126" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.168     0.037     0.094     0.241     4.478    21.570     0.000     1.824     0.675 
## birth_order_nonlinear2        0.002     0.015    -0.027     0.032     0.164   393.322     0.870     0.178     0.156 
## birth_order_nonlinear3        0.011     0.028    -0.044     0.066     0.392    25.336     0.699     1.475     0.625 
## birth_order_nonlinear4        0.030     0.029    -0.028     0.087     1.011    62.689     0.316     0.610     0.398 
## birth_order_nonlinear5        0.044     0.041    -0.035     0.124     1.091    41.730     0.282     0.867     0.488 
## birth_order_nonlinear5+      -0.016     0.039    -0.092     0.060    -0.409    48.003     0.684     0.764     0.455 
## poly(age, 3, raw = TRUE)1    -0.001     0.004    -0.010     0.007    -0.337    27.264     0.739     1.350     0.603 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.247    36.206     0.806     0.994     0.524 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.655    42.021     0.516     0.861     0.487 
## male                         -0.245     0.016    -0.278    -0.213   -14.977    29.187     0.000     1.249     0.583 
## sibling_count3               -0.013     0.022    -0.056     0.029    -0.612    48.240     0.544     0.760     0.454 
## sibling_count4               -0.025     0.029    -0.080     0.031    -0.862    36.115     0.394     0.997     0.525 
## sibling_count5               -0.049     0.031    -0.111     0.012    -1.576    59.389     0.120     0.637     0.409 
## sibling_count5+              -0.051     0.037    -0.122     0.021    -1.384    27.232     0.178     1.352     0.603 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.921 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-126" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-332-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-31" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-127" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.168     0.036     0.098     0.239     4.669    32.136     0.000     1.124     0.556 
## count_birth_order2/2          0.001     0.023    -0.043     0.046     0.059   222.745     0.953     0.252     0.208 
## count_birth_order1/3         -0.023     0.034    -0.090     0.044    -0.678    42.466     0.502     0.853     0.484 
## count_birth_order2/3         -0.011     0.030    -0.069     0.047    -0.367    62.612     0.715     0.611     0.398 
## count_birth_order3/3          0.000     0.034    -0.067     0.067     0.001    41.179     0.999     0.878     0.492 
## count_birth_order1/4         -0.013     0.045    -0.101     0.076    -0.279    48.821     0.781     0.752     0.451 
## count_birth_order2/4         -0.041     0.045    -0.128     0.047    -0.911    32.777     0.369     1.101     0.551 
## count_birth_order3/4         -0.017     0.039    -0.094     0.059    -0.438    68.264     0.663     0.570     0.381 
## count_birth_order4/4          0.006     0.046    -0.084     0.095     0.126    35.725     0.901     1.008     0.528 
## count_birth_order1/5         -0.057     0.065    -0.184     0.069    -0.889    38.774     0.379     0.930     0.507 
## count_birth_order2/5         -0.053     0.046    -0.144     0.038    -1.140   378.027     0.255     0.182     0.159 
## count_birth_order3/5         -0.033     0.055    -0.141     0.075    -0.601    44.706     0.551     0.814     0.472 
## count_birth_order4/5         -0.017     0.068    -0.150     0.116    -0.248    21.677     0.806     1.812     0.673 
## count_birth_order5/5         -0.021     0.063    -0.145     0.103    -0.336    31.160     0.739     1.162     0.565 
## count_birth_order1/5+        -0.067     0.054    -0.172     0.038    -1.245    73.065     0.217     0.541     0.368 
## count_birth_order2/5+        -0.036     0.049    -0.133     0.060    -0.737    64.459     0.464     0.597     0.392 
## count_birth_order3/5+        -0.046     0.044    -0.133     0.041    -1.027    95.037     0.307     0.445     0.322 
## count_birth_order4/5+        -0.025     0.056    -0.135     0.084    -0.451    28.124     0.656     1.303     0.594 
## count_birth_order5/5+        -0.006     0.050    -0.103     0.092    -0.111    40.266     0.912     0.897     0.497 
## count_birth_order5+/5+       -0.071     0.035    -0.141    -0.002    -2.013    47.237     0.050     0.775     0.459 
## poly(age, 3, raw = TRUE)1    -0.001     0.004    -0.009     0.007    -0.277    30.798     0.784     1.177     0.568 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.202    41.457     0.841     0.872     0.490 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.617    46.432     0.540     0.787     0.463 
## male                         -0.246     0.017    -0.278    -0.213   -14.707    28.436     0.000     1.286     0.590 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-127" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-334-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-31" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.428      10  91.063   0.929 158.630 
##  2 vs 3:   0.440       4  36.141   0.779 428.826 
##  3 vs 4:   0.037       1  18.722   0.849   1.086</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-15" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
</div>
</div>
<div id="neuroticism" class="section level3 tabset">
<h3>Neuroticism</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-16" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-32" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-128" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.170     0.028     0.115     0.224     6.143    38.169     0.000     0.944     0.511 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.003    -1.125    49.539     0.266     0.743     0.448 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.154    61.277     0.035     0.621     0.402 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.594    63.486     0.012     0.604     0.395 
## male                          0.034     0.013     0.010     0.059     2.745   111.594     0.007     0.397     0.296 
## sibling_count3                0.017     0.024    -0.030     0.064     0.704    36.700     0.486     0.981     0.521 
## sibling_count4                0.002     0.026    -0.048     0.052     0.060    49.726     0.952     0.740     0.447 
## sibling_count5                0.004     0.025    -0.046     0.053     0.143   126.841     0.886     0.363     0.278 
## sibling_count5+              -0.037     0.021    -0.079     0.005    -1.721    57.606     0.091     0.654     0.415 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-128" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-338-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-32" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-129" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.173     0.029     0.117     0.229     6.025    37.448     0.000     0.962     0.515 
## birth_order                  -0.002     0.003    -0.008     0.004    -0.553   108.751     0.582     0.404     0.300 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.003    -1.127    48.959     0.265     0.751     0.451 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.187    64.567     0.032     0.596     0.392 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.626    66.531     0.011     0.582     0.386 
## male                          0.034     0.013     0.010     0.059     2.746   110.863     0.007     0.398     0.297 
## sibling_count3                0.018     0.024    -0.030     0.066     0.740    36.001     0.464     1.000     0.526 
## sibling_count4                0.004     0.026    -0.048     0.055     0.143    46.918     0.887     0.779     0.460 
## sibling_count5                0.007     0.026    -0.045     0.059     0.262   104.107     0.794     0.416     0.307 
## sibling_count5+              -0.029     0.026    -0.081     0.022    -1.117    55.120     0.269     0.678     0.425 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-129" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-340-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-32" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-130" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.034     0.096     0.230     4.768    28.636     0.000     1.276     0.588 
## birth_order_nonlinear2        0.008     0.022    -0.036     0.051     0.355    29.337     0.725     1.242     0.581 
## birth_order_nonlinear3        0.003     0.020    -0.035     0.042     0.162   498.681     0.872     0.155     0.138 
## birth_order_nonlinear4        0.004     0.029    -0.052     0.061     0.151    54.405     0.880     0.686     0.427 
## birth_order_nonlinear5        0.032     0.036    -0.040     0.103     0.868    37.501     0.391     0.960     0.515 
## birth_order_nonlinear5+      -0.003     0.025    -0.052     0.046    -0.122   248.863     0.903     0.235     0.197 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.958    43.371     0.344     0.837     0.479 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.200    60.031     0.032     0.632     0.407 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.631    62.615     0.011     0.611     0.398 
## male                          0.034     0.013     0.010     0.059     2.729   109.222     0.007     0.403     0.300 
## sibling_count3                0.017     0.026    -0.034     0.068     0.659    35.715     0.514     1.008     0.528 
## sibling_count4                0.001     0.028    -0.053     0.056     0.049    53.955     0.961     0.690     0.429 
## sibling_count5               -0.004     0.029    -0.061     0.053    -0.125    95.448     0.901     0.443     0.321 
## sibling_count5+              -0.038     0.028    -0.093     0.017    -1.342    59.572     0.185     0.636     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-130" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-342-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-32" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-131" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.037     0.085     0.230     4.273    33.802     0.000     1.066     0.542 
## count_birth_order2/2          0.017     0.030    -0.042     0.076     0.573    46.914     0.569     0.779     0.461 
## count_birth_order1/3          0.037     0.039    -0.040     0.114     0.944    32.013     0.352     1.129     0.557 
## count_birth_order2/3          0.015     0.040    -0.065     0.094     0.361    29.238     0.720     1.246     0.582 
## count_birth_order3/3          0.024     0.033    -0.040     0.089     0.739    64.302     0.463     0.598     0.393 
## count_birth_order1/4         -0.012     0.045    -0.099     0.076    -0.259    51.047     0.797     0.724     0.441 
## count_birth_order2/4          0.022     0.042    -0.061     0.105     0.520    74.522     0.604     0.533     0.364 
## count_birth_order3/4          0.017     0.046    -0.074     0.107     0.360    36.636     0.721     0.983     0.521 
## count_birth_order4/4          0.011     0.043    -0.073     0.095     0.257    43.716     0.798     0.831     0.477 
## count_birth_order1/5         -0.011     0.048    -0.106     0.084    -0.232   175.015     0.817     0.293     0.235 
## count_birth_order2/5         -0.006     0.049    -0.101     0.089    -0.120   216.042     0.905     0.256     0.211 
## count_birth_order3/5          0.012     0.051    -0.087     0.111     0.240    77.904     0.811     0.515     0.356 
## count_birth_order4/5          0.029     0.050    -0.068     0.127     0.588    78.338     0.558     0.513     0.355 
## count_birth_order5/5          0.025     0.055    -0.083     0.133     0.455    31.446     0.652     1.150     0.562 
## count_birth_order1/5+        -0.024     0.046    -0.115     0.066    -0.523    38.699     0.604     0.931     0.507 
## count_birth_order2/5+        -0.015     0.043    -0.099     0.069    -0.346    61.112     0.731     0.623     0.403 
## count_birth_order3/5+        -0.040     0.038    -0.115     0.034    -1.053   119.326     0.294     0.379     0.286 
## count_birth_order4/5+        -0.042     0.037    -0.114     0.030    -1.145   135.040     0.254     0.348     0.269 
## count_birth_order5/5+         0.003     0.035    -0.065     0.071     0.083   216.203     0.934     0.256     0.211 
## count_birth_order5+/5+       -0.037     0.027    -0.089     0.016    -1.362    82.249     0.177     0.494     0.346 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.948    62.687     0.347     0.610     0.398 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.312    94.524     0.023     0.446     0.323 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.748    92.861     0.007     0.452     0.326 
## male                          0.034     0.013     0.010     0.059     2.734   110.795     0.007     0.399     0.298 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-131" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-32" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.293      10 231.895   0.982   1.557 
##  2 vs 3:   0.482       4  64.653   0.749   2.507 
##  3 vs 4:   0.305       1  46.645   0.583   0.405</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-16" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-33" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-132" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.182     0.025     0.133     0.231     7.320    59.033     0.000     0.641     0.410 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012     0.001    -1.752    60.547     0.085     0.627     0.405 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.911    78.273     0.060     0.513     0.355 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.546    74.365     0.013     0.533     0.365 
## male                          0.037     0.012     0.013     0.061     2.993   174.326     0.003     0.294     0.236 
## sibling_count3                0.009     0.019    -0.029     0.046     0.454    65.754     0.652     0.587     0.388 
## sibling_count4               -0.010     0.024    -0.057     0.036    -0.426    51.145     0.672     0.723     0.441 
## sibling_count5               -0.018     0.031    -0.079     0.042    -0.602    35.056     0.551     1.027     0.533 
## sibling_count5+              -0.058     0.023    -0.103    -0.013    -2.546    65.589     0.013     0.588     0.389 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-132" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-347-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-33" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-133" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.188     0.027     0.134     0.241     6.855    52.648     0.000     0.705     0.435 
## birth_order                  -0.003     0.005    -0.012     0.006    -0.611   170.547     0.542     0.298     0.239 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012     0.001    -1.758    59.800     0.084     0.634     0.407 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.936    79.631     0.056     0.506     0.352 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.571    74.179     0.012     0.534     0.365 
## male                          0.037     0.012     0.013     0.061     2.994   175.608     0.003     0.293     0.235 
## sibling_count3                0.010     0.020    -0.028     0.049     0.530    62.587     0.598     0.611     0.398 
## sibling_count4               -0.007     0.024    -0.053     0.040    -0.284    64.901     0.777     0.593     0.391 
## sibling_count5               -0.013     0.033    -0.079     0.052    -0.400    31.745     0.692     1.139     0.559 
## sibling_count5+              -0.049     0.026    -0.100     0.003    -1.852   132.382     0.066     0.353     0.272 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-133" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-349-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-33" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-134" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.182     0.030     0.124     0.240     6.172    47.495     0.000     0.771     0.458 
## birth_order_nonlinear2       -0.003     0.018    -0.039     0.033    -0.163    56.012     0.871     0.669     0.421 
## birth_order_nonlinear3        0.004     0.024    -0.043     0.052     0.172    42.820     0.865     0.847     0.482 
## birth_order_nonlinear4       -0.017     0.031    -0.077     0.044    -0.539    49.014     0.592     0.750     0.450 
## birth_order_nonlinear5        0.012     0.042    -0.070     0.095     0.293    35.601     0.771     1.011     0.529 
## birth_order_nonlinear5+      -0.005     0.033    -0.070     0.059    -0.166   173.066     0.869     0.295     0.237 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012     0.001    -1.620    58.199     0.111     0.648     0.413 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.952    75.934     0.055     0.525     0.361 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.565    71.853     0.012     0.548     0.371 
## male                          0.038     0.013     0.013     0.063     2.993   129.728     0.003     0.358     0.274 
## sibling_count3                0.007     0.021    -0.034     0.048     0.329    55.009     0.743     0.679     0.425 
## sibling_count4               -0.007     0.027    -0.059     0.046    -0.256    45.772     0.799     0.797     0.466 
## sibling_count5               -0.018     0.034    -0.084     0.048    -0.531    38.633     0.599     0.933     0.508 
## sibling_count5+              -0.057     0.027    -0.110    -0.004    -2.098   161.149     0.037     0.309     0.246 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-134" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-351-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-33" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-135" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.032     0.117     0.243     5.601    51.694     0.000     0.716     0.439 
## count_birth_order2/2          0.004     0.028    -0.052     0.059     0.125    36.305     0.901     0.992     0.523 
## count_birth_order1/3          0.029     0.034    -0.037     0.095     0.868    44.928     0.390     0.810     0.471 
## count_birth_order2/3          0.001     0.031    -0.061     0.063     0.035    44.321     0.972     0.820     0.474 
## count_birth_order3/3          0.006     0.035    -0.062     0.074     0.163    37.646     0.872     0.957     0.514 
## count_birth_order1/4         -0.016     0.051    -0.116     0.084    -0.305    29.357     0.763     1.241     0.581 
## count_birth_order2/4          0.008     0.035    -0.062     0.077     0.214   154.826     0.831     0.318     0.251 
## count_birth_order3/4         -0.002     0.036    -0.073     0.069    -0.051   130.360     0.960     0.356     0.274 
## count_birth_order4/4         -0.023     0.041    -0.103     0.057    -0.565    63.595     0.574     0.603     0.395 
## count_birth_order1/5         -0.028     0.075    -0.174     0.119    -0.371    23.989     0.714     1.581     0.641 
## count_birth_order2/5         -0.025     0.055    -0.133     0.083    -0.452    54.976     0.653     0.680     0.425 
## count_birth_order3/5          0.005     0.059    -0.112     0.121     0.077    32.308     0.939     1.118     0.555 
## count_birth_order4/5         -0.031     0.049    -0.127     0.065    -0.637    90.397     0.526     0.461     0.330 
## count_birth_order5/5          0.001     0.064    -0.124     0.125     0.008    30.294     0.994     1.198     0.572 
## count_birth_order1/5+        -0.057     0.050    -0.156     0.042    -1.126   127.038     0.262     0.363     0.277 
## count_birth_order2/5+        -0.066     0.053    -0.169     0.038    -1.242    42.539     0.221     0.852     0.484 
## count_birth_order3/5+        -0.035     0.052    -0.136     0.066    -0.676    37.137     0.503     0.970     0.518 
## count_birth_order4/5+        -0.066     0.043    -0.151     0.018    -1.549   127.080     0.124     0.363     0.277 
## count_birth_order5/5+        -0.042     0.050    -0.139     0.055    -0.842    40.163     0.405     0.899     0.498 
## count_birth_order5+/5+       -0.059     0.030    -0.119     0.000    -1.959   155.549     0.052     0.317     0.250 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.013     0.001    -1.728    79.356     0.088     0.508     0.353 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.855    92.947     0.067     0.452     0.326 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.490    87.941     0.015     0.470     0.335 
## male                          0.037     0.013     0.012     0.063     2.910   129.903     0.004     0.357     0.274 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-135" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-353-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-33" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.426      10  91.065   0.931 158.440 
##  2 vs 3:   0.441       4  36.141   0.778 429.027 
##  3 vs 4:   0.376       1  70.199   0.542   0.295</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-16" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-355-1.png" width="672" /></p>
</div>
</div>
<div id="conscientiousness" class="section level3 tabset">
<h3>Conscientiousness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-17" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-34" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-136" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.170     0.028     0.115     0.224     6.143    38.169     0.000     0.944     0.511 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.003    -1.125    49.539     0.266     0.743     0.448 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.154    61.277     0.035     0.621     0.402 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.594    63.486     0.012     0.604     0.395 
## male                          0.034     0.013     0.010     0.059     2.745   111.594     0.007     0.397     0.296 
## sibling_count3                0.017     0.024    -0.030     0.064     0.704    36.700     0.486     0.981     0.521 
## sibling_count4                0.002     0.026    -0.048     0.052     0.060    49.726     0.952     0.740     0.447 
## sibling_count5                0.004     0.025    -0.046     0.053     0.143   126.841     0.886     0.363     0.278 
## sibling_count5+              -0.037     0.021    -0.079     0.005    -1.721    57.606     0.091     0.654     0.415 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-136" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-357-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-34" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-137" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.173     0.029     0.117     0.229     6.025    37.448     0.000     0.962     0.515 
## birth_order                  -0.002     0.003    -0.008     0.004    -0.553   108.751     0.582     0.404     0.300 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.003    -1.127    48.959     0.265     0.751     0.451 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.187    64.567     0.032     0.596     0.392 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.626    66.531     0.011     0.582     0.386 
## male                          0.034     0.013     0.010     0.059     2.746   110.863     0.007     0.398     0.297 
## sibling_count3                0.018     0.024    -0.030     0.066     0.740    36.001     0.464     1.000     0.526 
## sibling_count4                0.004     0.026    -0.048     0.055     0.143    46.918     0.887     0.779     0.460 
## sibling_count5                0.007     0.026    -0.045     0.059     0.262   104.107     0.794     0.416     0.307 
## sibling_count5+              -0.029     0.026    -0.081     0.022    -1.117    55.120     0.269     0.678     0.425 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-137" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-359-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-34" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-138" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.034     0.096     0.230     4.768    28.636     0.000     1.276     0.588 
## birth_order_nonlinear2        0.008     0.022    -0.036     0.051     0.355    29.337     0.725     1.242     0.581 
## birth_order_nonlinear3        0.003     0.020    -0.035     0.042     0.162   498.681     0.872     0.155     0.138 
## birth_order_nonlinear4        0.004     0.029    -0.052     0.061     0.151    54.405     0.880     0.686     0.427 
## birth_order_nonlinear5        0.032     0.036    -0.040     0.103     0.868    37.501     0.391     0.960     0.515 
## birth_order_nonlinear5+      -0.003     0.025    -0.052     0.046    -0.122   248.863     0.903     0.235     0.197 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.958    43.371     0.344     0.837     0.479 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.200    60.031     0.032     0.632     0.407 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.631    62.615     0.011     0.611     0.398 
## male                          0.034     0.013     0.010     0.059     2.729   109.222     0.007     0.403     0.300 
## sibling_count3                0.017     0.026    -0.034     0.068     0.659    35.715     0.514     1.008     0.528 
## sibling_count4                0.001     0.028    -0.053     0.056     0.049    53.955     0.961     0.690     0.429 
## sibling_count5               -0.004     0.029    -0.061     0.053    -0.125    95.448     0.901     0.443     0.321 
## sibling_count5+              -0.038     0.028    -0.093     0.017    -1.342    59.572     0.185     0.636     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-138" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-361-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-34" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-139" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.037     0.085     0.230     4.273    33.802     0.000     1.066     0.542 
## count_birth_order2/2          0.017     0.030    -0.042     0.076     0.573    46.914     0.569     0.779     0.461 
## count_birth_order1/3          0.037     0.039    -0.040     0.114     0.944    32.013     0.352     1.129     0.557 
## count_birth_order2/3          0.015     0.040    -0.065     0.094     0.361    29.238     0.720     1.246     0.582 
## count_birth_order3/3          0.024     0.033    -0.040     0.089     0.739    64.302     0.463     0.598     0.393 
## count_birth_order1/4         -0.012     0.045    -0.099     0.076    -0.259    51.047     0.797     0.724     0.441 
## count_birth_order2/4          0.022     0.042    -0.061     0.105     0.520    74.522     0.604     0.533     0.364 
## count_birth_order3/4          0.017     0.046    -0.074     0.107     0.360    36.636     0.721     0.983     0.521 
## count_birth_order4/4          0.011     0.043    -0.073     0.095     0.257    43.716     0.798     0.831     0.477 
## count_birth_order1/5         -0.011     0.048    -0.106     0.084    -0.232   175.015     0.817     0.293     0.235 
## count_birth_order2/5         -0.006     0.049    -0.101     0.089    -0.120   216.042     0.905     0.256     0.211 
## count_birth_order3/5          0.012     0.051    -0.087     0.111     0.240    77.904     0.811     0.515     0.356 
## count_birth_order4/5          0.029     0.050    -0.068     0.127     0.588    78.338     0.558     0.513     0.355 
## count_birth_order5/5          0.025     0.055    -0.083     0.133     0.455    31.446     0.652     1.150     0.562 
## count_birth_order1/5+        -0.024     0.046    -0.115     0.066    -0.523    38.699     0.604     0.931     0.507 
## count_birth_order2/5+        -0.015     0.043    -0.099     0.069    -0.346    61.112     0.731     0.623     0.403 
## count_birth_order3/5+        -0.040     0.038    -0.115     0.034    -1.053   119.326     0.294     0.379     0.286 
## count_birth_order4/5+        -0.042     0.037    -0.114     0.030    -1.145   135.040     0.254     0.348     0.269 
## count_birth_order5/5+         0.003     0.035    -0.065     0.071     0.083   216.203     0.934     0.256     0.211 
## count_birth_order5+/5+       -0.037     0.027    -0.089     0.016    -1.362    82.249     0.177     0.494     0.346 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.948    62.687     0.347     0.610     0.398 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.312    94.524     0.023     0.446     0.323 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.748    92.861     0.007     0.452     0.326 
## male                          0.034     0.013     0.010     0.059     2.734   110.795     0.007     0.399     0.298 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-139" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-363-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-34" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.293      10 231.895   0.982   1.557 
##  2 vs 3:   0.482       4  64.653   0.749   2.507 
##  3 vs 4:   0.305       1  46.645   0.583   0.405</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-17" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-35" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-140" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.182     0.025     0.133     0.231     7.320    59.033     0.000     0.641     0.410 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012     0.001    -1.752    60.547     0.085     0.627     0.405 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.911    78.273     0.060     0.513     0.355 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.546    74.365     0.013     0.533     0.365 
## male                          0.037     0.012     0.013     0.061     2.993   174.326     0.003     0.294     0.236 
## sibling_count3                0.009     0.019    -0.029     0.046     0.454    65.754     0.652     0.587     0.388 
## sibling_count4               -0.010     0.024    -0.057     0.036    -0.426    51.145     0.672     0.723     0.441 
## sibling_count5               -0.018     0.031    -0.079     0.042    -0.602    35.056     0.551     1.027     0.533 
## sibling_count5+              -0.058     0.023    -0.103    -0.013    -2.546    65.589     0.013     0.588     0.389 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-140" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-366-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-35" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-141" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.188     0.027     0.134     0.241     6.855    52.648     0.000     0.705     0.435 
## birth_order                  -0.003     0.005    -0.012     0.006    -0.611   170.547     0.542     0.298     0.239 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012     0.001    -1.758    59.800     0.084     0.634     0.407 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.936    79.631     0.056     0.506     0.352 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.571    74.179     0.012     0.534     0.365 
## male                          0.037     0.012     0.013     0.061     2.994   175.608     0.003     0.293     0.235 
## sibling_count3                0.010     0.020    -0.028     0.049     0.530    62.587     0.598     0.611     0.398 
## sibling_count4               -0.007     0.024    -0.053     0.040    -0.284    64.901     0.777     0.593     0.391 
## sibling_count5               -0.013     0.033    -0.079     0.052    -0.400    31.745     0.692     1.139     0.559 
## sibling_count5+              -0.049     0.026    -0.100     0.003    -1.852   132.382     0.066     0.353     0.272 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-141" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-368-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-35" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-142" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.182     0.030     0.124     0.240     6.172    47.495     0.000     0.771     0.458 
## birth_order_nonlinear2       -0.003     0.018    -0.039     0.033    -0.163    56.012     0.871     0.669     0.421 
## birth_order_nonlinear3        0.004     0.024    -0.043     0.052     0.172    42.820     0.865     0.847     0.482 
## birth_order_nonlinear4       -0.017     0.031    -0.077     0.044    -0.539    49.014     0.592     0.750     0.450 
## birth_order_nonlinear5        0.012     0.042    -0.070     0.095     0.293    35.601     0.771     1.011     0.529 
## birth_order_nonlinear5+      -0.005     0.033    -0.070     0.059    -0.166   173.066     0.869     0.295     0.237 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.012     0.001    -1.620    58.199     0.111     0.648     0.413 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.952    75.934     0.055     0.525     0.361 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.565    71.853     0.012     0.548     0.371 
## male                          0.038     0.013     0.013     0.063     2.993   129.728     0.003     0.358     0.274 
## sibling_count3                0.007     0.021    -0.034     0.048     0.329    55.009     0.743     0.679     0.425 
## sibling_count4               -0.007     0.027    -0.059     0.046    -0.256    45.772     0.799     0.797     0.466 
## sibling_count5               -0.018     0.034    -0.084     0.048    -0.531    38.633     0.599     0.933     0.508 
## sibling_count5+              -0.057     0.027    -0.110    -0.004    -2.098   161.149     0.037     0.309     0.246 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-142" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-370-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-35" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-143" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.032     0.117     0.243     5.601    51.694     0.000     0.716     0.439 
## count_birth_order2/2          0.004     0.028    -0.052     0.059     0.125    36.305     0.901     0.992     0.523 
## count_birth_order1/3          0.029     0.034    -0.037     0.095     0.868    44.928     0.390     0.810     0.471 
## count_birth_order2/3          0.001     0.031    -0.061     0.063     0.035    44.321     0.972     0.820     0.474 
## count_birth_order3/3          0.006     0.035    -0.062     0.074     0.163    37.646     0.872     0.957     0.514 
## count_birth_order1/4         -0.016     0.051    -0.116     0.084    -0.305    29.357     0.763     1.241     0.581 
## count_birth_order2/4          0.008     0.035    -0.062     0.077     0.214   154.826     0.831     0.318     0.251 
## count_birth_order3/4         -0.002     0.036    -0.073     0.069    -0.051   130.360     0.960     0.356     0.274 
## count_birth_order4/4         -0.023     0.041    -0.103     0.057    -0.565    63.595     0.574     0.603     0.395 
## count_birth_order1/5         -0.028     0.075    -0.174     0.119    -0.371    23.989     0.714     1.581     0.641 
## count_birth_order2/5         -0.025     0.055    -0.133     0.083    -0.452    54.976     0.653     0.680     0.425 
## count_birth_order3/5          0.005     0.059    -0.112     0.121     0.077    32.308     0.939     1.118     0.555 
## count_birth_order4/5         -0.031     0.049    -0.127     0.065    -0.637    90.397     0.526     0.461     0.330 
## count_birth_order5/5          0.001     0.064    -0.124     0.125     0.008    30.294     0.994     1.198     0.572 
## count_birth_order1/5+        -0.057     0.050    -0.156     0.042    -1.126   127.038     0.262     0.363     0.277 
## count_birth_order2/5+        -0.066     0.053    -0.169     0.038    -1.242    42.539     0.221     0.852     0.484 
## count_birth_order3/5+        -0.035     0.052    -0.136     0.066    -0.676    37.137     0.503     0.970     0.518 
## count_birth_order4/5+        -0.066     0.043    -0.151     0.018    -1.549   127.080     0.124     0.363     0.277 
## count_birth_order5/5+        -0.042     0.050    -0.139     0.055    -0.842    40.163     0.405     0.899     0.498 
## count_birth_order5+/5+       -0.059     0.030    -0.119     0.000    -1.959   155.549     0.052     0.317     0.250 
## poly(age, 3, raw = TRUE)1    -0.006     0.003    -0.013     0.001    -1.728    79.356     0.088     0.508     0.353 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.855    92.947     0.067     0.452     0.326 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.490    87.941     0.015     0.470     0.335 
## male                          0.037     0.013     0.012     0.063     2.910   129.903     0.004     0.357     0.274 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.051 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.052 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-143" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-372-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-35" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.426      10  91.065   0.931 158.440 
##  2 vs 3:   0.441       4  36.141   0.778 429.027 
##  3 vs 4:   0.376       1  70.199   0.542   0.295</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-17" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-374-1.png" width="672" /></p>
</div>
</div>
<div id="agreeableness" class="section level3 tabset">
<h3>Agreeableness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_agree)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-18" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-36" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-144" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.149     0.043    -0.233    -0.066    -3.496    14.801     0.003     3.541     0.805 
## poly(age, 3, raw = TRUE)1     0.002     0.006    -0.010     0.013     0.305    15.564     0.764     3.174     0.786 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.407    19.059     0.176     2.197     0.716 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.714    22.037     0.100     1.771     0.668 
## male                          0.020     0.013    -0.005     0.046     1.582    87.878     0.117     0.471     0.335 
## sibling_count3               -0.003     0.021    -0.044     0.039    -0.131    91.005     0.896     0.459     0.329 
## sibling_count4                0.025     0.023    -0.020     0.070     1.080   144.476     0.282     0.333     0.260 
## sibling_count5                0.002     0.024    -0.045     0.049     0.072   454.062     0.942     0.164     0.145 
## sibling_count5+               0.016     0.018    -0.020     0.051     0.860   632.862     0.390     0.135     0.122 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-144" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-36" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-145" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.159     0.045    -0.248    -0.070    -3.494    14.392     0.003     3.780     0.815 
## birth_order                   0.005     0.003    -0.002     0.011     1.428    92.259     0.157     0.454     0.327 
## poly(age, 3, raw = TRUE)1     0.002     0.006    -0.010     0.013     0.311    15.540     0.760     3.185     0.787 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.453    19.304     0.162     2.153     0.711 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.760    22.343     0.092     1.737     0.664 
## male                          0.020     0.013    -0.005     0.046     1.577    88.004     0.118     0.470     0.335 
## sibling_count3               -0.006     0.022    -0.048     0.037    -0.259    80.293     0.796     0.503     0.351 
## sibling_count4                0.019     0.023    -0.027     0.065     0.804   134.715     0.423     0.349     0.269 
## sibling_count5               -0.007     0.024    -0.055     0.041    -0.295   573.791     0.768     0.143     0.128 
## sibling_count5+              -0.004     0.022    -0.047     0.038    -0.204  1190.166     0.838     0.095     0.088 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-145" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-378-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-36" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-146" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.157     0.047    -0.248    -0.065    -3.357    15.673     0.004     3.129     0.784 
## birth_order_nonlinear2        0.007     0.024    -0.040     0.055     0.294    22.758     0.772     1.694     0.658 
## birth_order_nonlinear3        0.009     0.024    -0.039     0.056     0.357    46.776     0.722     0.781     0.461 
## birth_order_nonlinear4        0.020     0.028    -0.035     0.074     0.707    65.124     0.482     0.592     0.390 
## birth_order_nonlinear5        0.012     0.030    -0.046     0.069     0.392   178.059     0.695     0.290     0.233 
## birth_order_nonlinear5+       0.039     0.030    -0.020     0.098     1.291    46.602     0.203     0.784     0.462 
## poly(age, 3, raw = TRUE)1     0.002     0.006    -0.009     0.013     0.345    16.444     0.735     2.843     0.767 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.465    21.319     0.158     1.855     0.679 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.785    25.079     0.086     1.494     0.628 
## male                          0.020     0.013    -0.005     0.046     1.586    88.234     0.116     0.469     0.334 
## sibling_count3               -0.005     0.022    -0.048     0.038    -0.228   123.547     0.820     0.370     0.281 
## sibling_count4                0.018     0.025    -0.032     0.067     0.703   130.998     0.483     0.355     0.273 
## sibling_count5               -0.006     0.027    -0.058     0.046    -0.225   573.870     0.822     0.143     0.128 
## sibling_count5+              -0.006     0.023    -0.052     0.040    -0.251  1422.093     0.802     0.086     0.081 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-146" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-380-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-36" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-147" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.144     0.046    -0.234    -0.054    -3.146    19.330     0.005     2.148     0.711 
## count_birth_order2/2         -0.010     0.036    -0.081     0.061    -0.265    23.697     0.793     1.606     0.645 
## count_birth_order1/3         -0.013     0.032    -0.075     0.049    -0.404   129.750     0.687     0.358     0.274 
## count_birth_order2/3          0.007     0.039    -0.068     0.083     0.187    35.055     0.852     1.027     0.533 
## count_birth_order3/3         -0.016     0.032    -0.078     0.045    -0.523    99.649     0.602     0.430     0.314 
## count_birth_order1/4          0.001     0.039    -0.076     0.078     0.016   152.847     0.987     0.320     0.252 
## count_birth_order2/4          0.022     0.038    -0.053     0.096     0.576   262.216     0.565     0.227     0.191 
## count_birth_order3/4          0.011     0.050    -0.086     0.108     0.218    29.187     0.829     1.249     0.583 
## count_birth_order4/4          0.040     0.043    -0.044     0.124     0.939    45.182     0.353     0.806     0.469 
## count_birth_order1/5          0.007     0.056    -0.103     0.117     0.125    50.533     0.901     0.730     0.444 
## count_birth_order2/5         -0.014     0.053    -0.117     0.089    -0.274    91.379     0.784     0.457     0.328 
## count_birth_order3/5         -0.026     0.049    -0.122     0.070    -0.527   104.549     0.599     0.415     0.307 
## count_birth_order4/5          0.004     0.064    -0.121     0.130     0.068    25.477     0.947     1.465     0.623 
## count_birth_order5/5          0.006     0.046    -0.084     0.096     0.136    82.787     0.892     0.492     0.345 
## count_birth_order1/5+        -0.040     0.039    -0.116     0.035    -1.048   145.393     0.297     0.331     0.259 
## count_birth_order2/5+        -0.004     0.038    -0.078     0.069    -0.112   239.552     0.911     0.240     0.200 
## count_birth_order3/5+         0.034     0.044    -0.053     0.121     0.773    42.358     0.444     0.855     0.485 
## count_birth_order4/5+        -0.004     0.038    -0.079     0.070    -0.111    99.924     0.912     0.429     0.314 
## count_birth_order5/5+        -0.007     0.035    -0.075     0.061    -0.205   274.152     0.837     0.221     0.187 
## count_birth_order5+/5+        0.026     0.029    -0.031     0.082     0.879    52.765     0.383     0.704     0.434 
## poly(age, 3, raw = TRUE)1     0.001     0.006    -0.010     0.012     0.232    17.409     0.819     2.559     0.747 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.580    22.514     0.128     1.719     0.661 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.901    26.526     0.068     1.395     0.611 
## male                          0.021     0.013    -0.005     0.046     1.607    89.355     0.112     0.465     0.332 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.080 
## Residual~~Residual                     0.910 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-147" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-382-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-36" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.415      10 213.560   0.939   1.743 
##  2 vs 3:   0.194       4  64.646   0.941   2.507 
##  3 vs 4:   2.037       1  40.510   0.161   0.457</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-18" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-37" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-148" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.149     0.040    -0.227    -0.072    -3.772    15.823     0.002     3.068     0.780 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.008     0.012     0.472    17.033     0.643     2.662     0.754 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.760    22.954     0.092     1.675     0.655 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.435    27.777     0.022     1.321     0.597 
## male                          0.019     0.014    -0.009     0.046     1.329    56.051     0.189     0.669     0.421 
## sibling_count3               -0.005     0.021    -0.046     0.036    -0.243    43.941     0.809     0.827     0.476 
## sibling_count4               -0.004     0.020    -0.044     0.036    -0.211   281.129     0.833     0.218     0.185 
## sibling_count5                0.023     0.027    -0.030     0.076     0.848    78.910     0.399     0.510     0.354 
## sibling_count5+              -0.000     0.026    -0.051     0.050    -0.007    39.777     0.995     0.907     0.500 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-148" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-385-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-37" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-149" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.156     0.045    -0.245    -0.068    -3.467    14.818     0.004     3.532     0.804 
## birth_order                   0.004     0.006    -0.008     0.015     0.613    32.808     0.544     1.100     0.550 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.008     0.012     0.478    16.930     0.639     2.692     0.756 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.794    23.303     0.086     1.642     0.650 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.473    28.131     0.020     1.302     0.594 
## male                          0.019     0.014    -0.009     0.046     1.331    56.154     0.189     0.668     0.421 
## sibling_count3               -0.007     0.022    -0.050     0.035    -0.336    40.050     0.739     0.901     0.498 
## sibling_count4               -0.009     0.022    -0.053     0.035    -0.389   119.037     0.698     0.379     0.287 
## sibling_count5                0.016     0.028    -0.039     0.072     0.574    84.199     0.568     0.486     0.342 
## sibling_count5+              -0.012     0.033    -0.076     0.052    -0.376    36.078     0.709     0.998     0.525 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.909 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-149" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-37" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-150" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.149     0.043    -0.232    -0.065    -3.490    17.185     0.003     2.619     0.751 
## birth_order_nonlinear2       -0.001     0.021    -0.041     0.039    -0.044    31.079     0.965     1.165     0.565 
## birth_order_nonlinear3       -0.004     0.021    -0.045     0.037    -0.183   107.800     0.855     0.406     0.302 
## birth_order_nonlinear4        0.010     0.033    -0.055     0.075     0.310    33.831     0.759     1.065     0.542 
## birth_order_nonlinear5        0.025     0.045    -0.063     0.113     0.557    27.848     0.582     1.317     0.596 
## birth_order_nonlinear5+       0.012     0.038    -0.064     0.087     0.306    48.904     0.761     0.751     0.451 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.008     0.012     0.428    18.769     0.673     2.252     0.721 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.946    27.556     0.062     1.334     0.600 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.622    32.538     0.013     1.109     0.553 
## male                          0.018     0.015    -0.010     0.047     1.250    44.941     0.218     0.810     0.471 
## sibling_count3               -0.004     0.022    -0.047     0.038    -0.193    50.515     0.848     0.730     0.444 
## sibling_count4               -0.007     0.024    -0.054     0.039    -0.298   131.465     0.766     0.354     0.273 
## sibling_count5                0.018     0.029    -0.039     0.076     0.628   104.605     0.531     0.415     0.306 
## sibling_count5+              -0.010     0.034    -0.077     0.057    -0.293    36.504     0.771     0.986     0.522 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.080 
## Residual~~Residual                     0.906 
## ICC|mother_pidlink                     0.081 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-150" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-389-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-37" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-151" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.143     0.046    -0.233    -0.053    -3.120    17.920     0.006     2.433     0.737 
## count_birth_order2/2         -0.006     0.028    -0.061     0.049    -0.211    37.049     0.834     0.972     0.518 
## count_birth_order1/3         -0.007     0.035    -0.075     0.061    -0.194    39.741     0.847     0.908     0.500 
## count_birth_order2/3         -0.003     0.030    -0.062     0.057    -0.090    55.293     0.929     0.676     0.424 
## count_birth_order3/3         -0.020     0.033    -0.084     0.044    -0.611    50.421     0.544     0.732     0.444 
## count_birth_order1/4         -0.031     0.042    -0.114     0.051    -0.744    76.027     0.459     0.525     0.361 
## count_birth_order2/4         -0.019     0.038    -0.093     0.055    -0.506    79.528     0.614     0.507     0.352 
## count_birth_order3/4         -0.004     0.043    -0.088     0.079    -0.104    42.075     0.918     0.860     0.486 
## count_birth_order4/4          0.009     0.042    -0.074     0.091     0.206    52.794     0.838     0.703     0.434 
## count_birth_order1/5          0.025     0.058    -0.088     0.137     0.427    74.878     0.670     0.531     0.363 
## count_birth_order2/5          0.014     0.059    -0.102     0.131     0.238    38.805     0.813     0.929     0.506 
## count_birth_order3/5          0.016     0.052    -0.085     0.118     0.314    63.060     0.754     0.607     0.397 
## count_birth_order4/5         -0.005     0.052    -0.106     0.097    -0.088    59.172     0.930     0.639     0.410 
## count_birth_order5/5          0.059     0.057    -0.053     0.172     1.035    46.340     0.306     0.788     0.463 
## count_birth_order1/5+        -0.014     0.054    -0.120     0.091    -0.267    73.127     0.790     0.540     0.368 
## count_birth_order2/5+        -0.016     0.057    -0.127     0.095    -0.283    32.511     0.779     1.110     0.553 
## count_birth_order3/5+        -0.005     0.044    -0.091     0.081    -0.107   107.526     0.915     0.407     0.302 
## count_birth_order4/5+         0.010     0.047    -0.082     0.101     0.209    63.183     0.835     0.606     0.396 
## count_birth_order5/5+        -0.008     0.047    -0.101     0.084    -0.175    51.479     0.862     0.719     0.439 
## count_birth_order5+/5+       -0.003     0.033    -0.067     0.061    -0.091    87.225     0.927     0.473     0.336 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.009     0.012     0.322    18.050     0.751     2.403     0.734 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.953    25.661     0.062     1.452     0.621 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.665    31.987     0.012     1.130     0.557 
## male                          0.019     0.015    -0.011     0.050     1.247    37.533     0.220     0.960     0.515 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.081 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-151" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-37" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.435      10  91.064   0.926 158.518 
##  2 vs 3:   0.465       4  36.141   0.761 428.955 
##  3 vs 4:   0.378       1  18.596   0.546   1.098</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-18" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
</div>
</div>
<div id="openness" class="section level3 tabset">
<h3>Openness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_open)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-19" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-38" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-152" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.086     0.034     0.019     0.154     2.522    20.859     0.020     1.914     0.686 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.015     0.003    -1.305    22.103     0.205     1.763     0.667 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.848    24.558     0.405     1.534     0.634 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.043    27.971     0.306     1.311     0.595 
## male                          0.038     0.013     0.013     0.064     2.931    77.935     0.004     0.515     0.356 
## sibling_count3               -0.010     0.020    -0.050     0.030    -0.507   138.343     0.613     0.342     0.266 
## sibling_count4               -0.018     0.025    -0.068     0.032    -0.707    59.981     0.482     0.632     0.407 
## sibling_count5               -0.012     0.036    -0.082     0.057    -0.350    24.258     0.730     1.558     0.638 
## sibling_count5+              -0.059     0.022    -0.102    -0.016    -2.685    60.004     0.009     0.632     0.407 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-152" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-395-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-38" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-153" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.103     0.034     0.037     0.170     3.035    23.000     0.006     1.671     0.654 
## birth_order                  -0.008     0.003    -0.014    -0.002    -2.559   102.976     0.012     0.420     0.309 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.015     0.003    -1.319    22.122     0.201     1.761     0.667 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.775    24.646     0.446     1.527     0.633 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.973    28.118     0.339     1.303     0.594 
## male                          0.039     0.013     0.013     0.064     2.941    77.923     0.004     0.515     0.356 
## sibling_count3               -0.005     0.021    -0.046     0.035    -0.258   122.928     0.797     0.371     0.282 
## sibling_count4               -0.007     0.025    -0.057     0.042    -0.292    65.634     0.771     0.588     0.389 
## sibling_count5                0.003     0.035    -0.066     0.073     0.096    26.487     0.924     1.398     0.611 
## sibling_count5+              -0.023     0.026    -0.073     0.027    -0.903    77.000     0.369     0.519     0.358 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-153" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-397-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-38" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-154" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.105     0.038     0.030     0.180     2.744    22.146     0.012     1.759     0.666 
## birth_order_nonlinear2       -0.017     0.017    -0.050     0.017    -0.968   144.571     0.335     0.332     0.260 
## birth_order_nonlinear3       -0.036     0.023    -0.081     0.010    -1.541    62.801     0.128     0.609     0.397 
## birth_order_nonlinear4       -0.042     0.027    -0.095     0.010    -1.588    92.970     0.116     0.452     0.325 
## birth_order_nonlinear5       -0.035     0.032    -0.098     0.028    -1.089    78.037     0.279     0.514     0.356 
## birth_order_nonlinear5+      -0.060     0.025    -0.109    -0.011    -2.410   278.257     0.017     0.219     0.186 
## poly(age, 3, raw = TRUE)1    -0.007     0.005    -0.017     0.002    -1.473    21.456     0.155     1.838     0.676 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.949    23.760     0.352     1.600     0.644 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.129    26.992     0.269     1.367     0.606 
## male                          0.039     0.013     0.013     0.064     2.950    79.954     0.004     0.505     0.352 
## sibling_count3                0.001     0.023    -0.044     0.045     0.031    83.172     0.975     0.490     0.345 
## sibling_count4                0.001     0.026    -0.050     0.052     0.041    94.689     0.967     0.446     0.322 
## sibling_count5                0.010     0.038    -0.065     0.084     0.255    27.246     0.801     1.351     0.603 
## sibling_count5+              -0.020     0.028    -0.075     0.034    -0.730    75.360     0.468     0.528     0.362 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-154" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-399-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-38" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-155" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.110     0.036     0.038     0.181     3.010    36.796     0.005     0.978     0.520 
## count_birth_order2/2         -0.030     0.030    -0.089     0.030    -0.978    45.671     0.333     0.798     0.467 
## count_birth_order1/3         -0.017     0.039    -0.092     0.059    -0.430    35.131     0.670     1.025     0.532 
## count_birth_order2/3         -0.022     0.031    -0.083     0.040    -0.696   149.145     0.488     0.326     0.256 
## count_birth_order3/3         -0.033     0.033    -0.098     0.031    -1.009    70.315     0.317     0.557     0.375 
## count_birth_order1/4         -0.032     0.048    -0.125     0.062    -0.662    38.159     0.512     0.944     0.511 
## count_birth_order2/4          0.009     0.040    -0.070     0.087     0.217   129.010     0.829     0.359     0.275 
## count_birth_order3/4         -0.073     0.051    -0.173     0.028    -1.415    26.346     0.169     1.407     0.613 
## count_birth_order4/4         -0.025     0.044    -0.110     0.061    -0.564    41.633     0.576     0.869     0.489 
## count_birth_order1/5          0.028     0.054    -0.077     0.134     0.526    68.159     0.601     0.571     0.381 
## count_birth_order2/5         -0.030     0.052    -0.132     0.073    -0.565    96.025     0.574     0.441     0.320 
## count_birth_order3/5         -0.038     0.067    -0.169     0.093    -0.570    23.601     0.574     1.615     0.646 
## count_birth_order4/5         -0.025     0.062    -0.147     0.098    -0.394    27.653     0.697     1.328     0.599 
## count_birth_order5/5         -0.048     0.051    -0.147     0.051    -0.945    45.348     0.350     0.803     0.468 
## count_birth_order1/5+        -0.022     0.041    -0.103     0.059    -0.526    76.362     0.600     0.523     0.360 
## count_birth_order2/5+        -0.044     0.037    -0.116     0.028    -1.199   374.309     0.231     0.184     0.160 
## count_birth_order3/5+        -0.047     0.043    -0.132     0.038    -1.085    48.804     0.283     0.753     0.451 
## count_birth_order4/5+        -0.101     0.041    -0.181    -0.020    -2.439    55.864     0.018     0.671     0.422 
## count_birth_order5/5+        -0.052     0.039    -0.130     0.025    -1.331    66.578     0.188     0.581     0.386 
## count_birth_order5+/5+       -0.088     0.029    -0.145    -0.030    -2.984    50.071     0.004     0.736     0.446 
## poly(age, 3, raw = TRUE)1    -0.007     0.005    -0.016     0.002    -1.450    24.525     0.160     1.537     0.634 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.949    28.945     0.351     1.260     0.585 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.155    33.811     0.256     1.066     0.542 
## male                          0.039     0.013     0.013     0.064     2.950    79.459     0.004     0.507     0.353 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-155" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-401-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-38" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.435      10 208.401   0.928   1.805 
##  2 vs 3:   0.280       4  67.747   0.890   2.296 
##  3 vs 4:   6.685       1  48.319   0.013   0.393</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-19" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-39" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-156" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.084     0.038     0.011     0.158     2.241    17.088     0.039     2.646     0.753 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.657    25.193     0.110     1.486     0.626 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.332    24.802     0.195     1.515     0.631 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.817    25.165     0.081     1.488     0.627 
## male                          0.040     0.013     0.013     0.066     2.953    72.226     0.004     0.546     0.370 
## sibling_count3               -0.012     0.022    -0.055     0.031    -0.556    36.604     0.582     0.984     0.521 
## sibling_count4               -0.009     0.031    -0.069     0.051    -0.286    22.496     0.778     1.721     0.661 
## sibling_count5               -0.052     0.025    -0.100    -0.004    -2.109   242.619     0.036     0.239     0.199 
## sibling_count5+              -0.073     0.027    -0.127    -0.020    -2.701    32.386     0.011     1.115     0.554 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-156" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-404-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-39" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-157" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.097     0.037     0.024     0.170     2.591    19.676     0.018     2.089     0.705 
## birth_order                  -0.006     0.005    -0.017     0.004    -1.190    49.962     0.240     0.737     0.446 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.677    25.260     0.106     1.481     0.625 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.288    24.881     0.209     1.509     0.630 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.763    25.307     0.090     1.477     0.625 
## male                          0.040     0.013     0.013     0.066     2.953    72.465     0.004     0.544     0.370 
## sibling_count3               -0.008     0.023    -0.053     0.037    -0.363    32.509     0.719     1.110     0.553 
## sibling_count4               -0.001     0.031    -0.062     0.061    -0.028    23.000     0.978     1.671     0.654 
## sibling_count5               -0.040     0.027    -0.093     0.013    -1.488   147.564     0.139     0.328     0.257 
## sibling_count5+              -0.052     0.036    -0.123     0.018    -1.449    26.100     0.159     1.423     0.616 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-157" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-406-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-39" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-158" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.098     0.036     0.029     0.168     2.759    24.643     0.011     1.527     0.633 
## birth_order_nonlinear2       -0.015     0.018    -0.050     0.020    -0.828    60.188     0.411     0.631     0.406 
## birth_order_nonlinear3       -0.024     0.026    -0.074     0.026    -0.936    33.418     0.356     1.079     0.545 
## birth_order_nonlinear4       -0.011     0.028    -0.065     0.044    -0.380   103.079     0.704     0.419     0.309 
## birth_order_nonlinear5       -0.032     0.040    -0.110     0.047    -0.790    45.176     0.434     0.806     0.469 
## birth_order_nonlinear5+      -0.059     0.038    -0.134     0.017    -1.525    50.354     0.134     0.732     0.444 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.016     0.001    -1.735    25.926     0.095     1.434     0.618 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.356    25.590     0.187     1.457     0.622 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.800    25.629     0.084     1.455     0.621 
## male                          0.038     0.014     0.011     0.064     2.783    76.146     0.007     0.524     0.360 
## sibling_count3               -0.006     0.025    -0.055     0.043    -0.251    28.345     0.804     1.291     0.591 
## sibling_count4               -0.001     0.032    -0.064     0.063    -0.028    24.818     0.978     1.514     0.631 
## sibling_count5               -0.039     0.029    -0.096     0.017    -1.357   129.970     0.177     0.357     0.274 
## sibling_count5+              -0.048     0.038    -0.122     0.025    -1.288    26.004     0.209     1.429     0.617 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-158" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-408-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-39" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-159" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.100     0.038     0.025     0.175     2.606    26.976     0.015     1.367     0.606 
## count_birth_order2/2         -0.022     0.028    -0.077     0.034    -0.759    36.165     0.453     0.995     0.524 
## count_birth_order1/3         -0.012     0.043    -0.096     0.072    -0.276    20.900     0.785     1.909     0.685 
## count_birth_order2/3         -0.031     0.031    -0.092     0.031    -0.985    47.545     0.330     0.770     0.457 
## count_birth_order3/3         -0.024     0.030    -0.082     0.034    -0.819   106.458     0.415     0.410     0.304 
## count_birth_order1/4         -0.011     0.047    -0.104     0.081    -0.244    40.773     0.808     0.886     0.494 
## count_birth_order2/4         -0.015     0.042    -0.098     0.067    -0.365    42.165     0.717     0.859     0.486 
## count_birth_order3/4         -0.042     0.052    -0.144     0.061    -0.797    21.766     0.434     1.801     0.672 
## count_birth_order4/4         -0.006     0.043    -0.090     0.079    -0.133    46.910     0.895     0.779     0.461 
## count_birth_order1/5         -0.080     0.055    -0.189     0.028    -1.458   112.091     0.148     0.395     0.296 
## count_birth_order2/5         -0.041     0.057    -0.152     0.070    -0.720    49.578     0.475     0.742     0.448 
## count_birth_order3/5         -0.078     0.050    -0.176     0.020    -1.561    82.817     0.122     0.492     0.345 
## count_birth_order4/5         -0.049     0.055    -0.157     0.059    -0.893    44.210     0.377     0.822     0.474 
## count_birth_order5/5         -0.047     0.057    -0.160     0.065    -0.820    47.534     0.416     0.770     0.457 
## count_birth_order1/5+        -0.032     0.064    -0.157     0.093    -0.508    31.342     0.615     1.155     0.563 
## count_birth_order2/5+        -0.043     0.047    -0.135     0.050    -0.905    91.381     0.368     0.457     0.328 
## count_birth_order3/5+        -0.083     0.055    -0.191     0.025    -1.502    30.118     0.143     1.206     0.574 
## count_birth_order4/5+        -0.075     0.053    -0.178     0.028    -1.424    35.372     0.163     1.018     0.530 
## count_birth_order5/5+        -0.106     0.044    -0.192    -0.020    -2.414    86.580     0.018     0.476     0.338 
## count_birth_order5+/5+       -0.111     0.039    -0.187    -0.035    -2.874    33.968     0.007     1.061     0.541 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.016     0.001    -1.642    26.571     0.112     1.392     0.610 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.318    25.455     0.199     1.467     0.623 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.786    25.149     0.086     1.489     0.627 
## male                          0.037     0.013     0.011     0.063     2.802    99.625     0.006     0.430     0.314 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-159" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-410-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-39" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.430      10  91.063   0.929 158.652 
##  2 vs 3:   0.468       4  36.141   0.759 428.924 
##  3 vs 4:   1.440       1  25.792   0.241   0.715</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-19" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-412-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="riskpreference" class="section level2 tabset">
<h2>Riskpreference</h2>
<div id="risk-a" class="section level3 tabset">
<h3>Risk A</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskA)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-20" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-40" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-160" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.030     0.100     0.217     5.304    29.032     0.000     1.256     0.584 
## poly(age, 3, raw = TRUE)1    -0.002     0.003    -0.009     0.005    -0.641    80.312     0.523     0.503     0.351 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.730    91.712     0.467     0.456     0.328 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.228   116.845     0.222     0.384     0.290 
## male                         -0.202     0.020    -0.242    -0.163   -10.012    17.251     0.000     2.601     0.750 
## sibling_count3               -0.000     0.020    -0.040     0.039    -0.016   140.847     0.987     0.338     0.263 
## sibling_count4                0.005     0.027    -0.049     0.058     0.165    37.175     0.870     0.969     0.517 
## sibling_count5               -0.008     0.027    -0.062     0.046    -0.304    67.376     0.762     0.576     0.384 
## sibling_count5+               0.023     0.025    -0.025     0.072     0.943    31.550     0.353     1.146     0.561 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-160" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-414-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-40" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-161" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.030     0.098     0.215     5.258    33.367     0.000     1.081     0.546 
## birth_order                   0.001     0.005    -0.008     0.010     0.226    20.261     0.823     1.998     0.695 
## poly(age, 3, raw = TRUE)1    -0.002     0.003    -0.009     0.005    -0.638    80.281     0.525     0.503     0.351 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.721    94.166     0.473     0.447     0.323 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.223   122.484     0.224     0.372     0.283 
## male                         -0.202     0.020    -0.242    -0.163   -10.005    17.228     0.000     2.607     0.750 
## sibling_count3               -0.001     0.020    -0.040     0.038    -0.049   183.947     0.961     0.284     0.230 
## sibling_count4                0.003     0.028    -0.052     0.058     0.114    35.782     0.910     1.006     0.527 
## sibling_count5               -0.010     0.031    -0.072     0.051    -0.331    38.506     0.742     0.936     0.508 
## sibling_count5+               0.019     0.033    -0.045     0.082     0.575    24.556     0.571     1.534     0.634 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-161" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-416-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-40" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-162" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.155     0.029     0.097     0.212     5.309    60.864     0.000     0.625     0.404 
## birth_order_nonlinear2        0.008     0.019    -0.030     0.046     0.422    52.973     0.674     0.701     0.433 
## birth_order_nonlinear3       -0.012     0.027    -0.065     0.041    -0.442    30.027     0.662     1.210     0.575 
## birth_order_nonlinear4       -0.005     0.030    -0.064     0.054    -0.159    43.426     0.874     0.836     0.479 
## birth_order_nonlinear5        0.031     0.037    -0.042     0.104     0.833    35.395     0.410     1.017     0.530 
## birth_order_nonlinear5+      -0.003     0.037    -0.075     0.070    -0.068    22.965     0.946     1.674     0.655 
## poly(age, 3, raw = TRUE)1    -0.002     0.003    -0.009     0.005    -0.634    98.922     0.527     0.432     0.315 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.716    90.088     0.476     0.462     0.331 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.194   102.919     0.235     0.420     0.309 
## male                         -0.202     0.020    -0.242    -0.163   -10.000    17.198     0.000     2.615     0.751 
## sibling_count3                0.006     0.021    -0.036     0.047     0.272   163.885     0.786     0.306     0.244 
## sibling_count4                0.011     0.030    -0.047     0.070     0.380    37.751     0.706     0.954     0.513 
## sibling_count5               -0.010     0.035    -0.077     0.058    -0.285    36.546     0.777     0.985     0.522 
## sibling_count5+               0.026     0.034    -0.041     0.093     0.758    27.227     0.455     1.353     0.603 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-162" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-418-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-40" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-163" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.156     0.033     0.093     0.220     4.807    64.811     0.000     0.594     0.391 
## count_birth_order2/2          0.001     0.035    -0.068     0.070     0.036    26.015     0.971     1.428     0.617 
## count_birth_order1/3         -0.013     0.035    -0.081     0.055    -0.366    57.605     0.715     0.654     0.415 
## count_birth_order2/3          0.006     0.032    -0.057     0.068     0.178   110.832     0.859     0.399     0.298 
## count_birth_order3/3          0.006     0.037    -0.066     0.078     0.174    38.199     0.863     0.943     0.510 
## count_birth_order1/4          0.039     0.047    -0.053     0.131     0.825    40.894     0.414     0.884     0.493 
## count_birth_order2/4         -0.003     0.045    -0.092     0.086    -0.060    48.788     0.952     0.753     0.452 
## count_birth_order3/4         -0.021     0.045    -0.110     0.068    -0.457    40.182     0.650     0.899     0.498 
## count_birth_order4/4          0.007     0.044    -0.080     0.093     0.154    38.859     0.878     0.928     0.506 
## count_birth_order1/5         -0.010     0.050    -0.108     0.087    -0.202   130.943     0.840     0.355     0.273 
## count_birth_order2/5          0.020     0.051    -0.080     0.121     0.397   111.375     0.692     0.397     0.297 
## count_birth_order3/5         -0.009     0.051    -0.109     0.091    -0.173    75.607     0.863     0.527     0.362 
## count_birth_order4/5         -0.056     0.050    -0.155     0.042    -1.116    76.699     0.268     0.521     0.359 
## count_birth_order5/5          0.013     0.048    -0.081     0.106     0.271    63.374     0.788     0.605     0.396 
## count_birth_order1/5+         0.004     0.041    -0.076     0.084     0.096    81.920     0.924     0.496     0.347 
## count_birth_order2/5+         0.053     0.045    -0.035     0.142     1.182    45.882     0.243     0.795     0.466 
## count_birth_order3/5+        -0.014     0.047    -0.106     0.077    -0.309    34.539     0.759     1.043     0.537 
## count_birth_order4/5+         0.033     0.045    -0.056     0.122     0.730    34.646     0.470     1.039     0.536 
## count_birth_order5/5+         0.055     0.040    -0.023     0.133     1.383    60.193     0.172     0.630     0.406 
## count_birth_order5+/5+        0.019     0.033    -0.045     0.084     0.585    29.329     0.563     1.242     0.582 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.005    -0.503    82.982     0.616     0.491     0.345 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.777    76.185     0.440     0.524     0.360 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.237    88.211     0.219     0.469     0.334 
## male                         -0.202     0.020    -0.242    -0.163   -10.019    17.254     0.000     2.600     0.750 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-163" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-420-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-40" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.442      10 233.032   0.925   1.547 
##  2 vs 3:   0.493       4  68.318   0.741   2.261 
##  3 vs 4:   0.053       1  13.682   0.821   1.987</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-20" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-41" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-164" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.161     0.029     0.105     0.218     5.566    30.330     0.000     1.197     0.572 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.004    -0.781    36.722     0.440     0.980     0.520 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.553    38.239     0.583     0.942     0.510 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.172    36.090     0.249     0.998     0.525 
## male                         -0.202     0.021    -0.244    -0.160    -9.491    16.403     0.000     2.857     0.767 
## sibling_count3               -0.006     0.023    -0.052     0.039    -0.262    28.536     0.795     1.281     0.589 
## sibling_count4                0.006     0.029    -0.052     0.064     0.207    23.686     0.838     1.607     0.645 
## sibling_count5                0.011     0.029    -0.046     0.068     0.373    46.761     0.711     0.782     0.461 
## sibling_count5+               0.041     0.031    -0.020     0.102     1.318    21.177     0.202     1.873     0.681 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-164" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-423-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-41" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-165" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.170     0.030     0.110     0.229     5.613    34.183     0.000     1.054     0.539 
## birth_order                  -0.004     0.006    -0.016     0.008    -0.699    27.965     0.490     1.311     0.595 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.004    -0.793    36.363     0.433     0.990     0.523 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.590    39.742     0.558     0.908     0.500 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.228    38.309     0.227     0.941     0.510 
## male                         -0.202     0.021    -0.244    -0.160    -9.493    16.404     0.000     2.857     0.767 
## sibling_count3               -0.003     0.024    -0.050     0.043    -0.147    28.149     0.884     1.301     0.593 
## sibling_count4                0.011     0.031    -0.050     0.073     0.363    22.248     0.720     1.747     0.665 
## sibling_count5                0.019     0.032    -0.043     0.081     0.594    40.887     0.556     0.884     0.493 
## sibling_count5+               0.055     0.039    -0.021     0.132     1.424    20.882     0.169     1.911     0.685 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.928 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-165" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-425-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-41" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-166" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.031     0.104     0.226     5.282    37.467     0.000     0.961     0.515 
## birth_order_nonlinear2       -0.002     0.019    -0.039     0.035    -0.121    45.219     0.904     0.805     0.469 
## birth_order_nonlinear3       -0.009     0.021    -0.050     0.032    -0.421   114.692     0.674     0.389     0.292 
## birth_order_nonlinear4       -0.018     0.034    -0.084     0.048    -0.534    32.325     0.597     1.117     0.554 
## birth_order_nonlinear5       -0.016     0.042    -0.098     0.066    -0.376    36.558     0.709     0.985     0.522 
## birth_order_nonlinear5+      -0.017     0.047    -0.108     0.075    -0.357    24.416     0.724     1.545     0.636 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.011     0.004    -0.855    37.411     0.398     0.963     0.516 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.535    41.542     0.596     0.871     0.489 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.195    40.407     0.239     0.894     0.496 
## male                         -0.202     0.021    -0.243    -0.161    -9.681    17.083     0.000     2.648     0.753 
## sibling_count3               -0.002     0.024    -0.050     0.045    -0.091    30.235     0.928     1.201     0.573 
## sibling_count4                0.016     0.031    -0.045     0.077     0.513    26.261     0.613     1.412     0.614 
## sibling_count5                0.022     0.033    -0.043     0.086     0.666    45.197     0.509     0.806     0.469 
## sibling_count5+               0.056     0.040    -0.022     0.135     1.417    21.900     0.171     1.786     0.670 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-166" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-427-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-41" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-167" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.176     0.033     0.112     0.240     5.409    50.649     0.000     0.729     0.443 
## count_birth_order2/2         -0.015     0.029    -0.073     0.042    -0.523    32.027     0.604     1.128     0.557 
## count_birth_order1/3         -0.015     0.040    -0.094     0.064    -0.363    23.944     0.720     1.585     0.642 
## count_birth_order2/3         -0.003     0.041    -0.083     0.077    -0.080    19.976     0.937     2.042     0.700 
## count_birth_order3/3         -0.016     0.034    -0.083     0.050    -0.472    42.309     0.639     0.856     0.485 
## count_birth_order1/4          0.020     0.042    -0.062     0.101     0.469    83.343     0.640     0.489     0.344 
## count_birth_order2/4          0.023     0.042    -0.059     0.106     0.549    42.217     0.586     0.858     0.486 
## count_birth_order3/4         -0.014     0.049    -0.111     0.082    -0.292    25.050     0.773     1.496     0.628 
## count_birth_order4/4         -0.017     0.058    -0.131     0.097    -0.290    18.838     0.775     2.238     0.719 
## count_birth_order1/5         -0.002     0.069    -0.136     0.133    -0.024    30.894     0.981     1.173     0.567 
## count_birth_order2/5         -0.006     0.058    -0.119     0.107    -0.100    44.951     0.921     0.810     0.471 
## count_birth_order3/5          0.022     0.070    -0.115     0.159     0.310    20.824     0.760     1.919     0.686 
## count_birth_order4/5          0.024     0.049    -0.073     0.121     0.489    88.166     0.626     0.470     0.334 
## count_birth_order5/5         -0.005     0.056    -0.114     0.104    -0.084    55.747     0.933     0.672     0.422 
## count_birth_order1/5+         0.051     0.069    -0.084     0.186     0.739    24.666     0.467     1.526     0.633 
## count_birth_order2/5+         0.066     0.050    -0.031     0.164     1.329    59.476     0.189     0.637     0.409 
## count_birth_order3/5+         0.042     0.058    -0.072     0.157     0.723    25.194     0.476     1.486     0.626 
## count_birth_order4/5+         0.025     0.054    -0.081     0.131     0.463    31.923     0.646     1.132     0.558 
## count_birth_order5/5+         0.034     0.055    -0.074     0.142     0.615    27.720     0.544     1.325     0.598 
## count_birth_order5+/5+        0.035     0.046    -0.055     0.126     0.770    20.302     0.450     1.992     0.694 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.012     0.003    -1.116    45.782     0.270     0.797     0.466 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.295    42.965     0.770     0.844     0.481 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.970    38.915     0.338     0.926     0.506 
## male                         -0.203     0.020    -0.242    -0.163   -10.121    18.686     0.000     2.268     0.722 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-167" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-429-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-41" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.430      10  91.065   0.928 158.472 
##  2 vs 3:   0.455       4  36.141   0.768 428.980 
##  3 vs 4:   0.486       1  16.663   0.495   1.315</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-20" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-431-1.png" width="672" /></p>
</div>
</div>
<div id="risk-b" class="section level3 tabset">
<h3>Risk B</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskB)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-21" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-42" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-168" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.001     0.036    -0.070     0.071     0.018    19.055     0.986     2.197     0.716 
## poly(age, 3, raw = TRUE)1     0.000     0.005    -0.009     0.009     0.049    23.628     0.962     1.612     0.646 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.558    34.112     0.581     1.056     0.540 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.700    42.857     0.488     0.846     0.482 
## male                         -0.074     0.018    -0.110    -0.038    -4.050    21.007     0.001     1.895     0.683 
## sibling_count3                0.001     0.028    -0.054     0.057     0.049    23.773     0.961     1.599     0.644 
## sibling_count4               -0.005     0.027    -0.058     0.048    -0.201    40.481     0.842     0.892     0.496 
## sibling_count5               -0.007     0.033    -0.071     0.058    -0.208    29.473     0.836     1.235     0.580 
## sibling_count5+               0.013     0.028    -0.042     0.067     0.454    22.894     0.654     1.681     0.656 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.939 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-168" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-433-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-42" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-169" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.005     0.035    -0.064     0.073     0.130    21.495     0.898     1.833     0.676 
## birth_order                  -0.002     0.003    -0.008     0.004    -0.604   110.407     0.547     0.400     0.298 
## poly(age, 3, raw = TRUE)1     0.000     0.005    -0.009     0.009     0.045    23.710     0.964     1.605     0.645 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.537    33.346     0.595     1.081     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.679    41.835     0.501     0.865     0.488 
## male                         -0.074     0.018    -0.110    -0.038    -4.049    21.011     0.001     1.894     0.683 
## sibling_count3                0.003     0.028    -0.052     0.057     0.091    24.430     0.928     1.544     0.636 
## sibling_count4               -0.003     0.027    -0.056     0.050    -0.110    43.123     0.913     0.841     0.480 
## sibling_count5               -0.003     0.035    -0.071     0.065    -0.092    27.628     0.928     1.330     0.599 
## sibling_count5+               0.021     0.032    -0.042     0.084     0.651    25.763     0.521     1.445     0.619 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.939 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-169" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-435-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-42" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-170" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.003     0.035    -0.073     0.066    -0.095    26.746     0.925     1.381     0.608 
## birth_order_nonlinear2        0.008     0.016    -0.024     0.040     0.511   317.527     0.610     0.202     0.174 
## birth_order_nonlinear3       -0.008     0.020    -0.048     0.031    -0.417   300.634     0.677     0.209     0.178 
## birth_order_nonlinear4       -0.013     0.025    -0.062     0.037    -0.500   209.729     0.618     0.261     0.215 
## birth_order_nonlinear5        0.022     0.031    -0.039     0.084     0.715    98.816     0.476     0.432     0.316 
## birth_order_nonlinear5+      -0.020     0.025    -0.069     0.030    -0.788   249.452     0.431     0.234     0.196 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.008     0.009     0.085    26.789     0.933     1.379     0.608 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.501    38.781     0.619     0.930     0.507 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.644    48.708     0.522     0.754     0.452 
## male                         -0.074     0.018    -0.110    -0.038    -4.051    20.929     0.001     1.905     0.685 
## sibling_count3                0.006     0.029    -0.051     0.064     0.213    25.296     0.833     1.478     0.625 
## sibling_count4                0.003     0.030    -0.056     0.062     0.103    39.502     0.919     0.913     0.502 
## sibling_count5               -0.005     0.036    -0.075     0.065    -0.136    32.223     0.892     1.121     0.555 
## sibling_count5+               0.025     0.034    -0.042     0.092     0.742    27.477     0.464     1.338     0.600 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.060 
## Residual~~Residual                     0.939 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-170" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-437-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-42" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-171" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.004     0.041    -0.085     0.077    -0.098    24.554     0.923     1.534     0.634 
## count_birth_order2/2          0.009     0.026    -0.042     0.060     0.361   159.808     0.719     0.311     0.247 
## count_birth_order1/3         -0.004     0.040    -0.081     0.074    -0.094    32.276     0.926     1.119     0.555 
## count_birth_order2/3          0.014     0.038    -0.061     0.088     0.356    38.709     0.723     0.931     0.507 
## count_birth_order3/3          0.008     0.038    -0.066     0.083     0.225    34.961     0.824     1.030     0.533 
## count_birth_order1/4          0.019     0.044    -0.067     0.106     0.438    58.907     0.663     0.642     0.411 
## count_birth_order2/4          0.004     0.048    -0.090     0.098     0.074    38.491     0.941     0.936     0.508 
## count_birth_order3/4         -0.006     0.041    -0.086     0.074    -0.143    79.953     0.886     0.505     0.352 
## count_birth_order4/4         -0.014     0.041    -0.094     0.066    -0.347    60.392     0.730     0.629     0.405 
## count_birth_order1/5         -0.008     0.053    -0.112     0.097    -0.144    75.830     0.886     0.526     0.361 
## count_birth_order2/5         -0.003     0.053    -0.107     0.100    -0.065    91.785     0.948     0.456     0.328 
## count_birth_order3/5          0.031     0.057    -0.081     0.143     0.543    39.853     0.590     0.906     0.500 
## count_birth_order4/5         -0.009     0.055    -0.116     0.099    -0.155    45.797     0.877     0.796     0.466 
## count_birth_order5/5         -0.017     0.051    -0.116     0.083    -0.325    45.453     0.747     0.802     0.468 
## count_birth_order1/5+         0.032     0.049    -0.064     0.128     0.657    32.355     0.516     1.116     0.554 
## count_birth_order2/5+         0.047     0.048    -0.047     0.140     0.972    36.234     0.338     0.994     0.524 
## count_birth_order3/5+        -0.024     0.045    -0.111     0.064    -0.532    42.355     0.597     0.855     0.485 
## count_birth_order4/5+         0.014     0.041    -0.066     0.095     0.347    57.143     0.730     0.658     0.417 
## count_birth_order5/5+         0.069     0.042    -0.012     0.151     1.663    47.805     0.103     0.766     0.456 
## count_birth_order5+/5+        0.006     0.032    -0.057     0.069     0.185    33.599     0.855     1.073     0.544 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.008     0.009     0.100    30.126     0.921     1.205     0.574 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.482    44.461     0.632     0.818     0.473 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.621    54.778     0.537     0.682     0.426 
## male                         -0.074     0.018    -0.110    -0.038    -4.043    20.816     0.001     1.920     0.686 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.061 
## Residual~~Residual                     0.939 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-171" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-439-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-42" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.363      10 231.780   0.961   1.558 
##  2 vs 3:   0.613       4  71.691   0.655   2.078 
##  3 vs 4:   0.370       1  48.554   0.546   0.392</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-21" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-43" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-172" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.002     0.036    -0.068     0.072     0.055    18.580     0.957     2.289     0.724 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.411    26.128     0.685     1.421     0.615 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.056    32.584     0.956     1.108     0.552 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.052    34.609     0.959     1.041     0.536 
## male                         -0.075     0.018    -0.110    -0.039    -4.133    22.050     0.000     1.769     0.668 
## sibling_count3               -0.017     0.019    -0.055     0.020    -0.906    73.508     0.368     0.538     0.367 
## sibling_count4               -0.017     0.026    -0.068     0.034    -0.641    35.103     0.526     1.026     0.532 
## sibling_count5                0.001     0.036    -0.068     0.071     0.039    23.370     0.969     1.636     0.649 
## sibling_count5+               0.024     0.034    -0.041     0.090     0.730    18.413     0.475     2.324     0.727 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.061 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-172" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-442-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-43" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-173" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.034    -0.049     0.083     0.507    24.397     0.617     1.547     0.636 
## birth_order                  -0.008     0.005    -0.018     0.003    -1.431    47.340     0.159     0.773     0.458 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.389    26.420     0.700     1.402     0.612 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.001    31.585     0.999     1.145     0.561 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.017    33.411     0.986     1.079     0.545 
## male                         -0.075     0.018    -0.110    -0.039    -4.136    22.074     0.000     1.766     0.667 
## sibling_count3               -0.013     0.020    -0.052     0.026    -0.639    62.209     0.525     0.614     0.399 
## sibling_count4               -0.007     0.028    -0.061     0.047    -0.263    32.382     0.795     1.115     0.554 
## sibling_count5                0.016     0.040    -0.062     0.094     0.394    20.576     0.698     1.953     0.690 
## sibling_count5+               0.050     0.044    -0.037     0.137     1.136    16.699     0.272     2.761     0.761 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.061 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-173" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-444-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-43" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-174" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.013     0.035    -0.057     0.082     0.361    24.984     0.721     1.501     0.629 
## birth_order_nonlinear2       -0.011     0.020    -0.050     0.028    -0.561    37.442     0.578     0.962     0.515 
## birth_order_nonlinear3       -0.017     0.021    -0.057     0.024    -0.806   153.066     0.422     0.320     0.252 
## birth_order_nonlinear4       -0.037     0.030    -0.096     0.022    -1.233    57.500     0.222     0.655     0.416 
## birth_order_nonlinear5       -0.030     0.052    -0.131     0.072    -0.574    20.350     0.572     1.985     0.694 
## birth_order_nonlinear5+      -0.033     0.038    -0.107     0.042    -0.863    54.491     0.392     0.685     0.427 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.009     0.308    28.694     0.760     1.273     0.588 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.096    33.598     0.924     1.073     0.544 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.072    36.014     0.943     1.000     0.526 
## male                         -0.075     0.018    -0.111    -0.039    -4.111    22.344     0.000     1.737     0.663 
## sibling_count3               -0.013     0.021    -0.054     0.028    -0.613    60.286     0.542     0.630     0.406 
## sibling_count4               -0.004     0.031    -0.064     0.056    -0.127    28.585     0.900     1.278     0.589 
## sibling_count5                0.018     0.042    -0.063     0.100     0.436    21.285     0.667     1.859     0.679 
## sibling_count5+               0.045     0.044    -0.042     0.132     1.010    17.936     0.326     2.429     0.736 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.061 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-174" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-446-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-43" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-175" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.013     0.038    -0.062     0.088     0.339    27.192     0.737     1.355     0.603 
## count_birth_order2/2         -0.010     0.025    -0.058     0.039    -0.387    82.641     0.699     0.493     0.346 
## count_birth_order1/3         -0.012     0.038    -0.086     0.062    -0.321    29.855     0.750     1.218     0.576 
## count_birth_order2/3         -0.026     0.030    -0.085     0.034    -0.850    59.065     0.399     0.640     0.410 
## count_birth_order3/3         -0.024     0.030    -0.083     0.035    -0.790    93.737     0.432     0.449     0.324 
## count_birth_order1/4          0.013     0.043    -0.071     0.097     0.301    70.146     0.764     0.558     0.376 
## count_birth_order2/4          0.001     0.048    -0.093     0.096     0.028    26.045     0.978     1.426     0.616 
## count_birth_order3/4         -0.035     0.045    -0.124     0.054    -0.779    33.182     0.442     1.087     0.547 
## count_birth_order4/4         -0.053     0.043    -0.137     0.032    -1.219    47.701     0.229     0.768     0.457 
## count_birth_order1/5          0.010     0.081    -0.149     0.169     0.120    20.293     0.906     1.994     0.695 
## count_birth_order2/5         -0.004     0.059    -0.119     0.111    -0.063    42.400     0.950     0.854     0.484 
## count_birth_order3/5          0.013     0.055    -0.095     0.121     0.241    45.743     0.811     0.797     0.466 
## count_birth_order4/5         -0.002     0.060    -0.119     0.116    -0.028    31.613     0.978     1.144     0.561 
## count_birth_order5/5         -0.027     0.054    -0.133     0.080    -0.493    66.935     0.624     0.579     0.385 
## count_birth_order1/5+         0.046     0.080    -0.109     0.202     0.584    18.398     0.566     2.327     0.728 
## count_birth_order2/5+         0.035     0.072    -0.107     0.176     0.480    18.045     0.637     2.404     0.734 
## count_birth_order3/5+         0.033     0.067    -0.099     0.165     0.488    18.695     0.631     2.266     0.722 
## count_birth_order4/5+         0.010     0.047    -0.082     0.101     0.206    66.828     0.837     0.580     0.385 
## count_birth_order5/5+         0.027     0.056    -0.084     0.138     0.479    26.214     0.636     1.415     0.614 
## count_birth_order5+/5+        0.012     0.043    -0.073     0.096     0.268    23.831     0.791     1.594     0.643 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.010     0.286    27.048     0.777     1.363     0.605 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.060    29.466     0.952     1.235     0.580 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.015    30.734     0.988     1.179     0.568 
## male                         -0.076     0.018    -0.111    -0.040    -4.208    23.614     0.000     1.613     0.646 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.061 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.061 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-175" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-448-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-43" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.439      10  91.063   0.923 158.758 
##  2 vs 3:   0.420       4  36.141   0.793 429.280 
##  3 vs 4:   2.034       1  23.863   0.167   0.783</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-21" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-450-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="educational-attainment" class="section level2 tabset">
<h2>Educational Attainment</h2>
<div id="years-of-education---z-standardized" class="section level3 tabset">
<h3>Years of Education - z-standardized</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = years_of_education_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-22" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-44" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-176" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.233     0.032     0.170     0.297     7.202    23.025     0.000     1.668     0.654 
## poly(age, 3, raw = TRUE)1    -0.017     0.004    -0.025    -0.009    -4.004    24.625     0.001     1.529     0.633 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.687    43.365     0.000     0.837     0.479 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -7.183    71.516     0.000     0.550     0.372 
## male                         -0.023     0.011    -0.044    -0.002    -2.125   125.300     0.036     0.366     0.279 
## sibling_count3                0.019     0.022    -0.025     0.063     0.858   219.447     0.392     0.254     0.210 
## sibling_count4                0.011     0.031    -0.050     0.072     0.364    43.394     0.718     0.836     0.479 
## sibling_count5                0.022     0.029    -0.036     0.079     0.738   228.620     0.461     0.248     0.205 
## sibling_count5+              -0.142     0.024    -0.189    -0.094    -5.891    89.204     0.000     0.465     0.332 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.376 
## Residual~~Residual                     0.568 
## ICC|mother_pidlink                     0.398 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-176" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-452-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-44" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-177" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.212     0.031     0.151     0.274     6.788    28.669     0.000     1.274     0.588 
## birth_order                   0.008     0.003     0.002     0.015     2.499    40.866     0.017     0.884     0.493 
## poly(age, 3, raw = TRUE)1    -0.017     0.004    -0.025    -0.009    -4.014    24.530     0.000     1.536     0.634 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.881    42.376     0.000     0.855     0.485 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -7.405    72.142     0.000     0.546     0.370 
## male                         -0.023     0.011    -0.044    -0.002    -2.135   125.778     0.035     0.365     0.279 
## sibling_count3                0.013     0.022    -0.029     0.056     0.615   327.210     0.539     0.199     0.171 
## sibling_count4               -0.001     0.031    -0.062     0.060    -0.036    46.814     0.972     0.781     0.461 
## sibling_count5                0.003     0.029    -0.054     0.059     0.100   578.376     0.921     0.143     0.128 
## sibling_count5+              -0.181     0.026    -0.232    -0.131    -6.986   196.045     0.000     0.273     0.222 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.377 
## Residual~~Residual                     0.567 
## ICC|mother_pidlink                     0.399 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-177" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-454-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-44" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-178" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.238     0.033     0.173     0.303     7.202    31.510     0.000     1.148     0.561 
## birth_order_nonlinear2       -0.009     0.016    -0.040     0.022    -0.585    53.397     0.561     0.696     0.431 
## birth_order_nonlinear3       -0.003     0.021    -0.045     0.039    -0.151    34.894     0.880     1.032     0.534 
## birth_order_nonlinear4       -0.006     0.028    -0.061     0.049    -0.226    27.691     0.823     1.326     0.598 
## birth_order_nonlinear5        0.020     0.031    -0.040     0.080     0.644    36.337     0.523     0.991     0.523 
## birth_order_nonlinear5+       0.051     0.027    -0.002     0.104     1.881    42.210     0.067     0.858     0.486 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.026    -0.009    -4.184    25.950     0.000     1.433     0.617 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.963    42.674     0.000     0.849     0.483 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -7.400    68.783     0.000     0.567     0.380 
## male                         -0.023     0.011    -0.044    -0.002    -2.117   122.968     0.036     0.371     0.282 
## sibling_count3                0.018     0.022    -0.025     0.062     0.824   516.241     0.410     0.152     0.135 
## sibling_count4                0.010     0.031    -0.052     0.071     0.312    56.333     0.756     0.666     0.420 
## sibling_count5                0.013     0.031    -0.048     0.074     0.425   294.791     0.671     0.212     0.180 
## sibling_count5+              -0.173     0.028    -0.229    -0.118    -6.120   119.156     0.000     0.379     0.287 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.377 
## Residual~~Residual                     0.568 
## ICC|mother_pidlink                     0.399 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-178" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-456-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-44" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-179" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.215     0.035     0.145     0.284     6.077    36.630     0.000     0.983     0.521 
## count_birth_order2/2          0.011     0.022    -0.031     0.054     0.532   119.153     0.595     0.379     0.287 
## count_birth_order1/3          0.030     0.031    -0.030     0.090     0.978   120.486     0.330     0.376     0.285 
## count_birth_order2/3          0.002     0.032    -0.061     0.066     0.074    70.953     0.941     0.553     0.374 
## count_birth_order3/3          0.036     0.031    -0.025     0.096     1.162    90.536     0.248     0.460     0.330 
## count_birth_order1/4          0.013     0.041    -0.068     0.093     0.307    65.278     0.760     0.591     0.390 
## count_birth_order2/4          0.002     0.046    -0.089     0.092     0.036    35.474     0.971     1.015     0.529 
## count_birth_order3/4          0.005     0.047    -0.086     0.096     0.105    30.445     0.917     1.192     0.571 
## count_birth_order4/4          0.030     0.043    -0.055     0.114     0.693    36.518     0.493     0.986     0.522 
## count_birth_order1/5          0.024     0.045    -0.065     0.112     0.519   188.304     0.604     0.280     0.227 
## count_birth_order2/5          0.007     0.047    -0.085     0.098     0.145   146.556     0.885     0.329     0.258 
## count_birth_order3/5         -0.009     0.044    -0.094     0.077    -0.202   210.419     0.840     0.261     0.214 
## count_birth_order4/5          0.001     0.043    -0.084     0.086     0.031   189.217     0.975     0.279     0.226 
## count_birth_order5/5          0.072     0.054    -0.033     0.178     1.340    28.927     0.191     1.261     0.585 
## count_birth_order1/5+        -0.145     0.033    -0.210    -0.080    -4.385   796.290     0.000     0.119     0.109 
## count_birth_order2/5+        -0.171     0.039    -0.247    -0.094    -4.375    72.668     0.000     0.543     0.369 
## count_birth_order3/5+        -0.165     0.039    -0.241    -0.088    -4.213    57.796     0.000     0.652     0.415 
## count_birth_order4/5+        -0.182     0.037    -0.254    -0.109    -4.918    72.020     0.000     0.547     0.371 
## count_birth_order5/5+        -0.165     0.033    -0.230    -0.101    -5.025   197.486     0.000     0.271     0.221 
## count_birth_order5+/5+       -0.116     0.030    -0.174    -0.058    -3.912    55.576     0.000     0.673     0.423 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.024    -0.007    -3.742    31.526     0.001     1.147     0.561 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.505    50.725     0.000     0.728     0.443 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.967    79.131     0.000     0.509     0.353 
## male                         -0.023     0.011    -0.044    -0.002    -2.132   123.172     0.035     0.370     0.282 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.377 
## Residual~~Residual                     0.567 
## ICC|mother_pidlink                     0.399 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-179" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-458-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-44" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.399      10 217.788   0.946   1.696 
##  2 vs 3:   0.263       4  65.386   0.901   2.453 
##  3 vs 4:   6.289       1  21.988   0.020   0.867</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-22" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-45" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-180" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.207     0.036     0.137     0.276     5.824    18.337     0.000     2.340     0.729 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.020    -0.003    -2.576    19.198     0.018     2.171     0.713 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.738    24.220     0.011     1.561     0.638 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.297    28.056     0.000     1.306     0.594 
## male                         -0.019     0.011    -0.041     0.003    -1.715   116.947     0.089     0.384     0.289 
## sibling_count3                0.025     0.026    -0.025     0.076     0.981    25.884     0.336     1.437     0.618 
## sibling_count4                0.002     0.027    -0.050     0.054     0.069    52.355     0.945     0.708     0.436 
## sibling_count5               -0.068     0.028    -0.123    -0.013    -2.435   149.024     0.016     0.326     0.256 
## sibling_count5+              -0.186     0.031    -0.246    -0.126    -6.051    42.101     0.000     0.860     0.486 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.388 
## Residual~~Residual                     0.571 
## ICC|mother_pidlink                     0.404 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-180" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-461-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-45" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-181" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.034     0.093     0.225     4.737    24.918     0.000     1.506     0.630 
## birth_order                   0.020     0.005     0.010     0.030     3.977    35.112     0.000     1.025     0.532 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.020    -0.002    -2.512    19.183     0.021     2.174     0.713 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     3.001    23.476     0.006     1.626     0.648 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.615    27.361     0.000     1.345     0.602 
## male                         -0.019     0.011    -0.041     0.003    -1.707   113.660     0.090     0.392     0.294 
## sibling_count3                0.011     0.026    -0.039     0.062     0.436    26.594     0.667     1.391     0.610 
## sibling_count4               -0.027     0.027    -0.079     0.025    -1.011    63.713     0.316     0.602     0.395 
## sibling_count5               -0.112     0.027    -0.165    -0.059    -4.129   701.174     0.000     0.128     0.116 
## sibling_count5+              -0.255     0.032    -0.318    -0.193    -8.005    72.000     0.000     0.547     0.371 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.388 
## Residual~~Residual                     0.570 
## ICC|mother_pidlink                     0.405 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-181" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-463-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-45" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-182" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.205     0.035     0.136     0.274     5.793    24.595     0.000     1.531     0.634 
## birth_order_nonlinear2       -0.007     0.015    -0.036     0.023    -0.435    58.001     0.665     0.650     0.414 
## birth_order_nonlinear3        0.020     0.023    -0.024     0.065     0.892    28.763     0.380     1.270     0.587 
## birth_order_nonlinear4        0.047     0.025    -0.002     0.097     1.876    55.276     0.066     0.676     0.424 
## birth_order_nonlinear5        0.065     0.040    -0.013     0.143     1.632    24.323     0.116     1.553     0.637 
## birth_order_nonlinear5+       0.100     0.034     0.033     0.168     2.909    40.799     0.006     0.886     0.494 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.022    -0.004    -2.955    21.283     0.007     1.859     0.679 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     3.468    25.768     0.002     1.445     0.619 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.068    30.113     0.000     1.206     0.574 
## male                         -0.021     0.011    -0.042     0.001    -1.868   142.261     0.064     0.336     0.262 
## sibling_count3                0.014     0.027    -0.038     0.066     0.535    26.979     0.597     1.367     0.606 
## sibling_count4               -0.026     0.028    -0.081     0.029    -0.928    57.399     0.357     0.656     0.416 
## sibling_count5               -0.109     0.028    -0.164    -0.054    -3.881   722.789     0.000     0.126     0.114 
## sibling_count5+              -0.252     0.031    -0.313    -0.192    -8.173   117.479     0.000     0.383     0.289 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.385 
## Residual~~Residual                     0.569 
## ICC|mother_pidlink                     0.404 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-182" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-465-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-45" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-183" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.041     0.101     0.260     4.428    22.384     0.000     1.733     0.663 
## count_birth_order2/2          0.021     0.026    -0.029     0.071     0.824    29.529     0.417     1.233     0.580 
## count_birth_order1/3          0.042     0.040    -0.035     0.120     1.072    21.630     0.296     1.817     0.674 
## count_birth_order2/3          0.002     0.032    -0.062     0.065     0.051    32.637     0.959     1.106     0.552 
## count_birth_order3/3          0.061     0.037    -0.011     0.133     1.668    26.106     0.107     1.422     0.616 
## count_birth_order1/4          0.009     0.043    -0.075     0.093     0.210    44.848     0.835     0.811     0.471 
## count_birth_order2/4         -0.026     0.043    -0.111     0.059    -0.603    29.852     0.551     1.218     0.577 
## count_birth_order3/4          0.001     0.034    -0.065     0.067     0.036   157.049     0.972     0.315     0.249 
## count_birth_order4/4          0.036     0.042    -0.047     0.119     0.847    36.273     0.402     0.993     0.524 
## count_birth_order1/5         -0.086     0.055    -0.194     0.022    -1.552    52.789     0.127     0.703     0.434 
## count_birth_order2/5         -0.106     0.047    -0.197    -0.014    -2.264   104.236     0.026     0.416     0.307 
## count_birth_order3/5         -0.075     0.048    -0.169     0.018    -1.579    63.984     0.119     0.600     0.394 
## count_birth_order4/5         -0.058     0.057    -0.170     0.053    -1.026    27.997     0.314     1.309     0.595 
## count_birth_order5/5         -0.018     0.058    -0.132     0.096    -0.310    30.043     0.759     1.209     0.575 
## count_birth_order1/5+        -0.254     0.049    -0.349    -0.158    -5.212    78.820     0.000     0.510     0.354 
## count_birth_order2/5+        -0.241     0.051    -0.342    -0.141    -4.700    35.798     0.000     1.006     0.527 
## count_birth_order3/5+        -0.243     0.042    -0.325    -0.161    -5.811    93.807     0.000     0.449     0.324 
## count_birth_order4/5+        -0.184     0.052    -0.285    -0.082    -3.548    29.544     0.001     1.232     0.579 
## count_birth_order5/5+        -0.178     0.050    -0.275    -0.080    -3.567    31.501     0.001     1.148     0.561 
## count_birth_order5+/5+       -0.137     0.038    -0.212    -0.062    -3.593    40.557     0.001     0.891     0.495 
## poly(age, 3, raw = TRUE)1    -0.011     0.005    -0.020    -0.002    -2.452    21.411     0.023     1.844     0.677 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.987    25.108     0.006     1.492     0.627 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.578    29.378     0.000     1.240     0.581 
## male                         -0.022     0.011    -0.044     0.000    -1.929   131.437     0.056     0.354     0.273 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.386 
## Residual~~Residual                     0.568 
## ICC|mother_pidlink                     0.404 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-183" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-467-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-45" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.321      10  91.064   0.974 158.568 
##  2 vs 3:   0.385       4  36.141   0.818 428.982 
##  3 vs 4:  15.584       1  19.092   0.001   1.055</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-22" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-469-1.png" width="672" /></p>
</div>
</div>
<div id="elementary_missed" class="section level3">
<h3>elementary_missed</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_missed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-23" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-46" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-184" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.008     0.001     0.034     2.093    14.074     0.055     3.992     0.823 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.501    26.296     0.621     1.410     0.613 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.027    31.095     0.979     1.164     0.565 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.064    31.055     0.950     1.166     0.565 
## male                          0.002     0.003    -0.003     0.007     0.874    48.989     0.387     0.750     0.451 
## sibling_count3               -0.000     0.005    -0.009     0.009    -0.045    38.597     0.964     0.934     0.508 
## sibling_count4                0.002     0.006    -0.009     0.014     0.412    29.979     0.683     1.212     0.575 
## sibling_count5                0.005     0.006    -0.006     0.017     0.924    48.531     0.360     0.756     0.453 
## sibling_count5+               0.018     0.005     0.009     0.028     3.732    31.172     0.001     1.161     0.564 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.164 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-184" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-471-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-46" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-185" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.009    -0.001     0.034     1.898    13.903     0.079     4.117     0.828 
## birth_order                   0.000     0.001    -0.002     0.002     0.346    14.407     0.735     3.771     0.814 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.502    26.324     0.620     1.408     0.613 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.000    30.968     1.000     1.170     0.566 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.038    30.857     0.970     1.174     0.567 
## male                          0.002     0.003    -0.003     0.007     0.871    48.927     0.388     0.751     0.451 
## sibling_count3               -0.000     0.005    -0.010     0.009    -0.096    41.216     0.924     0.877     0.491 
## sibling_count4                0.002     0.005    -0.009     0.013     0.340    36.613     0.736     0.983     0.521 
## sibling_count5                0.005     0.006    -0.007     0.016     0.766    45.755     0.447     0.797     0.466 
## sibling_count5+               0.017     0.006     0.005     0.028     2.796    29.573     0.009     1.230     0.579 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.163 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-185" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-473-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-46" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-186" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.009     0.001     0.037     2.029    14.551     0.061     3.683     0.811 
## birth_order_nonlinear2       -0.001     0.003    -0.008     0.006    -0.281    49.478     0.780     0.744     0.448 
## birth_order_nonlinear3       -0.002     0.005    -0.012     0.008    -0.338    23.692     0.738     1.607     0.645 
## birth_order_nonlinear4       -0.003     0.005    -0.013     0.006    -0.686    69.252     0.495     0.564     0.378 
## birth_order_nonlinear5       -0.004     0.008    -0.020     0.011    -0.560    21.545     0.581     1.827     0.675 
## birth_order_nonlinear5+       0.001     0.008    -0.016     0.017     0.061    15.167     0.952     3.354     0.796 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.340    27.406     0.737     1.342     0.601 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.108    31.465     0.915     1.150     0.562 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.055    31.149     0.957     1.162     0.565 
## male                          0.002     0.003    -0.003     0.007     0.875    49.474     0.386     0.744     0.448 
## sibling_count3                0.000     0.005    -0.009     0.009     0.070    55.872     0.944     0.670     0.422 
## sibling_count4                0.004     0.005    -0.007     0.014     0.684    58.399     0.496     0.646     0.412 
## sibling_count5                0.007     0.006    -0.005     0.019     1.201    62.306     0.234     0.613     0.399 
## sibling_count5+               0.019     0.007     0.006     0.032     2.768    23.713     0.011     1.605     0.645 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.164 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-186" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-475-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-46" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-187" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.010    -0.001     0.039     1.826    14.620     0.088     3.642     0.809 
## count_birth_order2/2         -0.001     0.006    -0.012     0.010    -0.170    35.021     0.866     1.028     0.533 
## count_birth_order1/3          0.001     0.006    -0.011     0.013     0.163    97.007     0.871     0.438     0.318 
## count_birth_order2/3         -0.001     0.007    -0.014     0.012    -0.133    41.386     0.895     0.874     0.490 
## count_birth_order3/3         -0.002     0.008    -0.017     0.014    -0.210    22.643     0.836     1.706     0.659 
## count_birth_order1/4          0.004     0.007    -0.010     0.018     0.595   158.409     0.553     0.313     0.248 
## count_birth_order2/4          0.006     0.009    -0.012     0.023     0.614    33.690     0.543     1.070     0.543 
## count_birth_order3/4         -0.001     0.010    -0.022     0.019    -0.143    20.927     0.888     1.905     0.685 
## count_birth_order4/4          0.001     0.008    -0.015     0.017     0.092    37.861     0.928     0.951     0.513 
## count_birth_order1/5          0.003     0.009    -0.015     0.020     0.323   173.723     0.747     0.295     0.236 
## count_birth_order2/5          0.007     0.009    -0.010     0.025     0.817   155.616     0.415     0.317     0.250 
## count_birth_order3/5          0.005     0.012    -0.019     0.029     0.405    22.776     0.689     1.693     0.657 
## count_birth_order4/5          0.009     0.009    -0.009     0.027     0.961    80.668     0.339     0.502     0.350 
## count_birth_order5/5          0.002     0.012    -0.021     0.025     0.173    21.552     0.865     1.827     0.675 
## count_birth_order1/5+         0.020     0.008     0.003     0.037     2.364    39.258     0.023     0.919     0.503 
## count_birth_order2/5+         0.015     0.009    -0.001     0.032     1.792    37.999     0.081     0.948     0.512 
## count_birth_order3/5+         0.021     0.008     0.006     0.037     2.701    48.636     0.009     0.755     0.452 
## count_birth_order4/5+         0.013     0.008    -0.003     0.028     1.575    38.840     0.123     0.928     0.506 
## count_birth_order5/5+         0.015     0.008     0.001     0.030     2.027    47.555     0.048     0.770     0.457 
## count_birth_order5+/5+        0.020     0.006     0.007     0.032     3.060    27.224     0.005     1.353     0.603 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.302    28.116     0.765     1.303     0.594 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.130    32.195     0.898     1.122     0.555 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.073    31.707     0.942     1.140     0.560 
## male                          0.002     0.003    -0.003     0.007     0.869    49.206     0.389     0.747     0.450 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.164 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-187" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-477-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-46" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.218      10 211.159   1.000   1.771 
##  2 vs 3:  -0.461       4  63.122   1.000   2.629 
##  3 vs 4:   0.119       1  11.286   0.736   3.755</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-23" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-47" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-188" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.008     0.001     0.033     2.036    13.914     0.061     4.109     0.827 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.896    33.066     0.377     1.091     0.548 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.377    40.017     0.708     0.902     0.499 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.372    35.536     0.712     1.013     0.529 
## male                          0.002     0.003    -0.003     0.007     0.739    52.406     0.463     0.708     0.436 
## sibling_count3                0.001     0.004    -0.007     0.009     0.251    31.752     0.804     1.139     0.559 
## sibling_count4                0.005     0.005    -0.006     0.016     0.926    26.951     0.363     1.369     0.606 
## sibling_count5                0.008     0.006    -0.003     0.020     1.460    41.684     0.152     0.868     0.489 
## sibling_count5+               0.026     0.005     0.015     0.036     4.670    29.493     0.000     1.234     0.580 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-188" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-480-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-47" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-189" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.018     0.009     0.001     0.035     2.103    14.551     0.053     3.683     0.811 
## birth_order                  -0.001     0.001    -0.003     0.002    -0.383    15.591     0.707     3.163     0.786 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.887    33.187     0.381     1.087     0.547 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.404    38.067     0.689     0.946     0.511 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.402    33.208     0.690     1.086     0.547 
## male                          0.002     0.003    -0.003     0.007     0.738    52.465     0.464     0.707     0.435 
## sibling_count3                0.001     0.004    -0.007     0.010     0.330    31.456     0.744     1.150     0.562 
## sibling_count4                0.006     0.006    -0.005     0.017     1.006    25.552     0.324     1.460     0.622 
## sibling_count5                0.010     0.006    -0.002     0.022     1.558    40.843     0.127     0.885     0.494 
## sibling_count5+               0.028     0.007     0.015     0.040     4.198    30.115     0.000     1.206     0.574 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-189" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-482-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-47" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-190" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.009    -0.000     0.035     1.955    14.672     0.070     3.613     0.808 
## birth_order_nonlinear2       -0.001     0.004    -0.008     0.007    -0.161    31.254     0.873     1.158     0.564 
## birth_order_nonlinear3       -0.001     0.005    -0.011     0.010    -0.151    22.170     0.881     1.756     0.666 
## birth_order_nonlinear4       -0.006     0.006    -0.019     0.006    -0.980    27.083     0.336     1.361     0.605 
## birth_order_nonlinear5       -0.001     0.010    -0.020     0.019    -0.059    17.882     0.953     2.442     0.737 
## birth_order_nonlinear5+      -0.001     0.010    -0.022     0.019    -0.122    15.980     0.904     3.007     0.777 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.830    31.658     0.413     1.142     0.560 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.388    39.526     0.700     0.913     0.502 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.383    33.681     0.704     1.070     0.543 
## male                          0.002     0.003    -0.003     0.007     0.777    53.163     0.441     0.699     0.432 
## sibling_count3                0.001     0.005    -0.008     0.011     0.275    27.138     0.785     1.358     0.604 
## sibling_count4                0.007     0.006    -0.005     0.018     1.107    28.139     0.278     1.302     0.593 
## sibling_count5                0.010     0.007    -0.004     0.023     1.428    31.614     0.163     1.144     0.561 
## sibling_count5+               0.027     0.007     0.013     0.042     3.746    24.770     0.001     1.518     0.631 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-190" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-484-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-47" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-191" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.010    -0.001     0.038     1.905    14.767     0.076     3.560     0.805 
## count_birth_order2/2         -0.003     0.005    -0.012     0.007    -0.544    41.183     0.589     0.878     0.492 
## count_birth_order1/3         -0.002     0.007    -0.015     0.011    -0.253    32.244     0.802     1.120     0.555 
## count_birth_order2/3          0.001     0.007    -0.013     0.015     0.083    22.138     0.935     1.759     0.666 
## count_birth_order3/3          0.001     0.007    -0.013     0.015     0.158    25.100     0.876     1.493     0.627 
## count_birth_order1/4          0.006     0.009    -0.012     0.024     0.622    30.818     0.538     1.176     0.568 
## count_birth_order2/4          0.008     0.009    -0.009     0.026     0.929    25.558     0.362     1.460     0.622 
## count_birth_order3/4          0.002     0.008    -0.013     0.017     0.216    44.423     0.830     0.819     0.473 
## count_birth_order4/4         -0.000     0.008    -0.017     0.016    -0.035    34.516     0.973     1.043     0.537 
## count_birth_order1/5          0.013     0.012    -0.010     0.036     1.087    39.508     0.284     0.913     0.502 
## count_birth_order2/5          0.010     0.011    -0.012     0.032     0.930    34.141     0.359     1.055     0.540 
## count_birth_order3/5          0.006     0.010    -0.014     0.027     0.611    39.318     0.545     0.917     0.503 
## count_birth_order4/5          0.005     0.013    -0.021     0.031     0.360    19.204     0.723     2.170     0.713 
## count_birth_order5/5          0.004     0.010    -0.016     0.024     0.415    57.012     0.680     0.659     0.417 
## count_birth_order1/5+         0.025     0.011     0.003     0.047     2.237    36.304     0.031     0.992     0.523 
## count_birth_order2/5+         0.024     0.009     0.006     0.041     2.610    63.105     0.011     0.607     0.396 
## count_birth_order3/5+         0.026     0.009     0.008     0.044     2.841    43.998     0.007     0.826     0.476 
## count_birth_order4/5+         0.019     0.010    -0.001     0.039     1.846    27.759     0.076     1.322     0.597 
## count_birth_order5/5+         0.029     0.009     0.012     0.047     3.249    42.935     0.002     0.844     0.481 
## count_birth_order5+/5+        0.026     0.009     0.008     0.043     2.898    19.853     0.009     2.061     0.702 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.736    30.044     0.468     1.209     0.575 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.347    42.304     0.730     0.856     0.485 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.358    35.945     0.723     1.002     0.526 
## male                          0.002     0.003    -0.003     0.007     0.699    43.043     0.489     0.843     0.481 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-191" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-486-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-47" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -1.107      10  91.064   1.000 158.526 
##  2 vs 3:  -1.101       4  36.141   1.000 429.255 
##  3 vs 4:   0.147       1  11.761   0.708   3.163</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-23" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-488-1.png" width="672" /></p>
</div>
</div>
<div id="elementary_worked" class="section level3">
<h3>elementary_worked</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_worked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-24" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-48" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-192" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.020     0.009     0.002     0.038     2.167    17.254     0.045     2.600     0.750 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.120    18.226     0.905     2.364     0.731 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.813    17.808     0.427     2.459     0.739 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.527    17.078     0.605     2.649     0.753 
## male                          0.007     0.003     0.002     0.013     2.687   206.206     0.008     0.264     0.216 
## sibling_count3                0.001     0.005    -0.010     0.012     0.157    75.201     0.876     0.529     0.363 
## sibling_count4                0.007     0.007    -0.007     0.020     0.985    44.372     0.330     0.819     0.474 
## sibling_count5                0.010     0.008    -0.005     0.025     1.268    45.771     0.211     0.797     0.466 
## sibling_count5+               0.032     0.005     0.022     0.042     6.226   123.938     0.000     0.369     0.281 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.188 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-192" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-490-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-48" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-193" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.023     0.009     0.006     0.041     2.647    19.445     0.016     2.128     0.709 
## birth_order                  -0.002     0.001    -0.004     0.000    -1.685    25.321     0.104     1.476     0.625 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.119    18.228     0.907     2.363     0.731 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.733    17.976     0.473     2.420     0.735 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.455    17.294     0.655     2.589     0.749 
## male                          0.007     0.003     0.002     0.013     2.699   210.324     0.008     0.261     0.214 
## sibling_count3                0.002     0.005    -0.009     0.013     0.348    72.568     0.728     0.544     0.369 
## sibling_count4                0.009     0.007    -0.004     0.022     1.325    49.267     0.191     0.746     0.449 
## sibling_count5                0.013     0.008    -0.003     0.029     1.591    36.561     0.120     0.985     0.522 
## sibling_count5+               0.039     0.007     0.026     0.052     5.783    52.719     0.000     0.704     0.434 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.189 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-193" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-492-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-48" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-194" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.021     0.009     0.003     0.039     2.317    22.580     0.030     1.712     0.660 
## birth_order_nonlinear2        0.000     0.004    -0.008     0.009     0.057    46.290     0.955     0.789     0.464 
## birth_order_nonlinear3       -0.003     0.006    -0.016     0.010    -0.449    25.470     0.657     1.466     0.623 
## birth_order_nonlinear4       -0.007     0.008    -0.022     0.008    -0.966    27.838     0.342     1.318     0.597 
## birth_order_nonlinear5       -0.007     0.008    -0.022     0.008    -0.935    51.244     0.354     0.721     0.440 
## birth_order_nonlinear5+      -0.013     0.008    -0.028     0.003    -1.564    26.541     0.130     1.394     0.611 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.095    17.826     0.926     2.455     0.738 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.694    16.777     0.497     2.737     0.759 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.426    16.064     0.676     2.976     0.775 
## male                          0.007     0.003     0.002     0.013     2.679   194.245     0.008     0.274     0.223 
## sibling_count3                0.002     0.006    -0.010     0.014     0.350    49.017     0.728     0.750     0.450 
## sibling_count4                0.010     0.008    -0.005     0.025     1.323    37.550     0.194     0.959     0.515 
## sibling_count5                0.014     0.009    -0.004     0.032     1.559    31.010     0.129     1.168     0.566 
## sibling_count5+               0.040     0.008     0.025     0.056     5.267    38.421     0.000     0.938     0.509 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.188 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-194" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-494-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-48" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-195" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.023     0.009     0.005     0.042     2.486    27.600     0.019     1.331     0.599 
## count_birth_order2/2         -0.003     0.006    -0.015     0.010    -0.400    66.843     0.690     0.580     0.385 
## count_birth_order1/3          0.003     0.008    -0.013     0.019     0.382    63.746     0.704     0.602     0.394 
## count_birth_order2/3          0.002     0.007    -0.013     0.016     0.215   143.815     0.830     0.334     0.260 
## count_birth_order3/3         -0.004     0.008    -0.020     0.011    -0.579    74.199     0.565     0.534     0.365 
## count_birth_order1/4          0.004     0.011    -0.017     0.025     0.405    49.880     0.687     0.738     0.447 
## count_birth_order2/4          0.011     0.010    -0.009     0.031     1.075    69.187     0.286     0.564     0.378 
## count_birth_order3/4          0.009     0.012    -0.014     0.033     0.766    26.184     0.451     1.417     0.615 
## count_birth_order4/4          0.001     0.009    -0.017     0.018     0.079   113.237     0.938     0.393     0.294 
## count_birth_order1/5          0.016     0.015    -0.013     0.046     1.092    28.796     0.284     1.268     0.587 
## count_birth_order2/5          0.012     0.015    -0.017     0.041     0.805    32.076     0.427     1.126     0.557 
## count_birth_order3/5          0.005     0.012    -0.018     0.028     0.408    79.915     0.684     0.505     0.352 
## count_birth_order4/5          0.007     0.010    -0.013     0.027     0.664   387.943     0.507     0.180     0.157 
## count_birth_order5/5          0.008     0.014    -0.019     0.034     0.560    26.972     0.580     1.368     0.606 
## count_birth_order1/5+         0.034     0.011     0.013     0.055     3.215    44.438     0.002     0.818     0.473 
## count_birth_order2/5+         0.042     0.011     0.020     0.064     3.779    36.477     0.001     0.987     0.522 
## count_birth_order3/5+         0.040     0.010     0.020     0.061     3.863    41.739     0.000     0.867     0.488 
## count_birth_order4/5+         0.032     0.009     0.014     0.049     3.584   102.873     0.001     0.420     0.309 
## count_birth_order5/5+         0.031     0.009     0.014     0.048     3.555   105.644     0.001     0.412     0.305 
## count_birth_order5+/5+        0.027     0.007     0.014     0.040     3.971    70.366     0.000     0.557     0.375 
## poly(age, 3, raw = TRUE)1    -0.000     0.001    -0.003     0.002    -0.052    20.138     0.959     2.017     0.697 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.844    18.485     0.410     2.309     0.726 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.548    17.440     0.590     2.551     0.746 
## male                          0.007     0.003     0.002     0.013     2.704   195.550     0.007     0.273     0.222 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.188 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-195" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-496-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-48" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.169      10 220.346   1.000   1.668 
##  2 vs 3:  -0.340       4  62.082   1.000   2.720 
##  3 vs 4:   2.904       1  15.927   0.108   1.429</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-24" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-49" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-196" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.022     0.011     0.001     0.043     2.034    13.930     0.061     4.097     0.827 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.261    16.807     0.797     2.728     0.759 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.821    19.183     0.422     2.174     0.713 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.635    21.616     0.532     1.819     0.674 
## male                          0.008     0.003     0.002     0.013     2.718   228.911     0.007     0.247     0.205 
## sibling_count3                0.000     0.004    -0.008     0.008     0.020   215.107     0.984     0.257     0.212 
## sibling_count4                0.010     0.006    -0.002     0.022     1.686    52.195     0.098     0.710     0.436 
## sibling_count5                0.019     0.008     0.004     0.034     2.487    40.240     0.017     0.897     0.497 
## sibling_count5+               0.042     0.006     0.030     0.054     6.712    54.399     0.000     0.686     0.427 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.186 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-196" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-499-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-49" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-197" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.030     0.010     0.009     0.050     2.867    15.767     0.011     3.090     0.782 
## birth_order                  -0.004     0.001    -0.006    -0.001    -2.685    28.506     0.012     1.283     0.590 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.223    16.883     0.826     2.705     0.757 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.688    19.256     0.500     2.161     0.712 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.464    21.957     0.647     1.780     0.669 
## male                          0.008     0.003     0.002     0.013     2.712   223.474     0.007     0.251     0.208 
## sibling_count3                0.003     0.004    -0.006     0.011     0.562   146.014     0.575     0.330     0.258 
## sibling_count4                0.015     0.006     0.003     0.027     2.464    58.424     0.017     0.646     0.412 
## sibling_count5                0.026     0.008     0.010     0.043     3.121    32.616     0.004     1.107     0.552 
## sibling_count5+               0.055     0.007     0.040     0.069     7.464    61.119     0.000     0.623     0.403 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-197" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-501-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-49" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-198" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.024     0.010     0.004     0.044     2.393    17.256     0.028     2.600     0.750 
## birth_order_nonlinear2       -0.002     0.004    -0.010     0.006    -0.490    77.452     0.625     0.517     0.357 
## birth_order_nonlinear3       -0.005     0.006    -0.017     0.007    -0.818    27.446     0.420     1.340     0.601 
## birth_order_nonlinear4       -0.009     0.007    -0.022     0.004    -1.340    57.236     0.186     0.657     0.417 
## birth_order_nonlinear5       -0.017     0.009    -0.035     0.001    -1.844    42.005     0.072     0.862     0.487 
## birth_order_nonlinear5+      -0.021     0.010    -0.041    -0.001    -2.032    27.843     0.052     1.318     0.597 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.268    17.977     0.792     2.420     0.735 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.632    20.451     0.534     1.971     0.692 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.377    22.672     0.710     1.703     0.659 
## male                          0.008     0.003     0.002     0.013     2.714   221.649     0.007     0.252     0.209 
## sibling_count3                0.002     0.004    -0.007     0.011     0.418   311.775     0.676     0.205     0.175 
## sibling_count4                0.015     0.007     0.002     0.028     2.240    52.736     0.029     0.704     0.434 
## sibling_count5                0.026     0.009     0.009     0.044     2.919    31.542     0.006     1.147     0.561 
## sibling_count5+               0.054     0.008     0.039     0.070     6.791    46.598     0.000     0.784     0.462 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-198" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-503-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-49" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-199" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.025     0.011     0.004     0.046     2.342    18.652     0.030     2.275     0.723 
## count_birth_order2/2         -0.003     0.006    -0.015     0.009    -0.517    48.453     0.608     0.757     0.453 
## count_birth_order1/3          0.001     0.009    -0.016     0.017     0.060    33.663     0.952     1.071     0.543 
## count_birth_order2/3          0.001     0.007    -0.012     0.014     0.162   103.906     0.872     0.417     0.308 
## count_birth_order3/3         -0.005     0.006    -0.017     0.008    -0.720   316.667     0.472     0.203     0.174 
## count_birth_order1/4          0.014     0.010    -0.006     0.035     1.371    52.926     0.176     0.702     0.433 
## count_birth_order2/4          0.014     0.011    -0.008     0.035     1.212    27.474     0.236     1.338     0.600 
## count_birth_order3/4          0.009     0.010    -0.011     0.029     0.915    40.119     0.366     0.900     0.498 
## count_birth_order4/4          0.004     0.010    -0.015     0.024     0.417    50.697     0.678     0.728     0.443 
## count_birth_order1/5          0.026     0.016    -0.004     0.057     1.679    33.378     0.103     1.080     0.546 
## count_birth_order2/5          0.024     0.014    -0.003     0.051     1.750    42.196     0.087     0.858     0.486 
## count_birth_order3/5          0.018     0.013    -0.008     0.044     1.390    40.623     0.172     0.889     0.495 
## count_birth_order4/5          0.015     0.015    -0.015     0.046     1.004    23.601     0.326     1.615     0.646 
## count_birth_order5/5          0.012     0.015    -0.017     0.041     0.823    30.743     0.417     1.179     0.568 
## count_birth_order1/5+         0.057     0.014     0.030     0.084     4.118    42.928     0.000     0.845     0.481 
## count_birth_order2/5+         0.051     0.012     0.028     0.074     4.350    59.863     0.000     0.633     0.407 
## count_birth_order3/5+         0.052     0.012     0.029     0.075     4.423    45.058     0.000     0.808     0.470 
## count_birth_order4/5+         0.046     0.011     0.025     0.068     4.297    71.792     0.000     0.548     0.371 
## count_birth_order5/5+         0.035     0.014     0.007     0.063     2.423    21.352     0.024     1.851     0.678 
## count_birth_order5+/5+        0.033     0.009     0.015     0.050     3.687    41.972     0.001     0.862     0.487 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.195    17.765     0.848     2.469     0.740 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.660    20.767     0.517     1.927     0.687 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.406    23.483     0.689     1.625     0.648 
## male                          0.008     0.003     0.003     0.013     2.948   551.022     0.003     0.147     0.131 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.186 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-199" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-505-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-49" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.862      10  91.063   1.000 158.767 
##  2 vs 3:  -0.842       4  36.141   1.000 428.483 
##  3 vs 4:   7.265       1  17.030   0.015   1.266</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-24" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-507-1.png" width="672" /></p>
</div>
</div>
<div id="attended_school" class="section level3">
<h3>attended_school</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = attended_school)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-25" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-50" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-200" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.491     0.020     0.451     0.530    24.210    13.870     0.000     4.142     0.829 
## poly(age, 3, raw = TRUE)1     0.018     0.002     0.014     0.022     8.817    23.197     0.000     1.652     0.652 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.686    33.144     0.001     1.088     0.548 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.451    45.805     0.654     0.796     0.466 
## male                         -0.019     0.005    -0.029    -0.009    -3.753   249.940     0.000     0.234     0.196 
## sibling_count3                0.005     0.011    -0.017     0.026     0.438    43.362     0.664     0.837     0.479 
## sibling_count4                0.017     0.011    -0.005     0.039     1.521    74.187     0.133     0.534     0.365 
## sibling_count5                0.033     0.014     0.006     0.061     2.386    42.867     0.022     0.846     0.482 
## sibling_count5+               0.047     0.008     0.031     0.063     5.685  1029.610     0.000     0.103     0.095 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.167 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-200" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-509-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-50" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-201" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.481     0.022     0.438     0.523    22.354    13.595     0.000     4.366     0.836 
## birth_order                   0.005     0.001     0.002     0.008     3.156    67.782     0.002     0.573     0.382 
## poly(age, 3, raw = TRUE)1     0.018     0.002     0.014     0.022     8.821    23.170     0.000     1.654     0.652 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.593    34.887     0.001     1.032     0.534 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.316    48.578     0.753     0.756     0.453 
## male                         -0.019     0.005    -0.030    -0.009    -3.767   248.706     0.000     0.235     0.197 
## sibling_count3                0.002     0.011    -0.020     0.023     0.168    42.998     0.868     0.843     0.481 
## sibling_count4                0.011     0.011    -0.012     0.033     0.958    73.323     0.341     0.539     0.367 
## sibling_count5                0.024     0.013    -0.002     0.050     1.794    63.133     0.078     0.607     0.396 
## sibling_count5+               0.026     0.010     0.007     0.046     2.604   562.545     0.009     0.145     0.130 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.166 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-201" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-511-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-50" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-202" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.494     0.020     0.454     0.534    24.443    16.233     0.000     2.915     0.771 
## birth_order_nonlinear2       -0.004     0.007    -0.018     0.010    -0.534   195.156     0.594     0.273     0.223 
## birth_order_nonlinear3       -0.010     0.011    -0.032     0.012    -0.881    32.344     0.385     1.116     0.554 
## birth_order_nonlinear4       -0.000     0.014    -0.027     0.026    -0.026    35.611     0.980     1.011     0.528 
## birth_order_nonlinear5        0.003     0.015    -0.026     0.032     0.201    48.986     0.841     0.750     0.451 
## birth_order_nonlinear5+       0.029     0.013     0.004     0.054     2.308    55.821     0.025     0.671     0.422 
## poly(age, 3, raw = TRUE)1     0.017     0.002     0.013     0.021     8.534    25.245     0.000     1.482     0.626 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.348    40.300     0.002     0.896     0.497 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.036    58.228     0.971     0.648     0.413 
## male                         -0.019     0.005    -0.029    -0.009    -3.761   258.277     0.000     0.230     0.193 
## sibling_count3                0.008     0.013    -0.017     0.032     0.611    30.216     0.546     1.201     0.573 
## sibling_count4                0.018     0.012    -0.004     0.041     1.577   115.852     0.118     0.386     0.291 
## sibling_count5                0.033     0.015     0.004     0.061     2.252    58.241     0.028     0.648     0.413 
## sibling_count5+               0.032     0.012     0.009     0.055     2.711   125.098     0.008     0.367     0.280 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.166 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-202" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-513-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-50" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-203" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.474     0.022     0.431     0.517    21.626    17.096     0.000     2.644     0.753 
## count_birth_order2/2          0.022     0.013    -0.002     0.047     1.778    53.488     0.081     0.695     0.431 
## count_birth_order1/3          0.026     0.017    -0.008     0.060     1.523    33.084     0.137     1.090     0.548 
## count_birth_order2/3         -0.003     0.015    -0.032     0.026    -0.201    68.220     0.841     0.570     0.381 
## count_birth_order3/3          0.022     0.015    -0.008     0.052     1.452    54.567     0.152     0.684     0.427 
## count_birth_order1/4          0.040     0.017     0.007     0.072     2.399   288.717     0.017     0.214     0.182 
## count_birth_order2/4          0.025     0.020    -0.014     0.065     1.267    47.456     0.211     0.771     0.458 
## count_birth_order3/4          0.002     0.021    -0.041     0.044     0.071    30.855     0.944     1.174     0.567 
## count_birth_order4/4          0.041     0.018     0.005     0.076     2.236    55.397     0.029     0.675     0.424 
## count_birth_order1/5          0.064     0.022     0.021     0.107     2.936   132.243     0.004     0.353     0.272 
## count_birth_order2/5          0.053     0.020     0.013     0.093     2.617   710.758     0.009     0.127     0.115 
## count_birth_order3/5          0.031     0.023    -0.013     0.075     1.380    73.121     0.172     0.540     0.368 
## count_birth_order4/5          0.027     0.020    -0.013     0.067     1.330   180.369     0.185     0.288     0.232 
## count_birth_order5/5          0.042     0.028    -0.012     0.096     1.511    22.056     0.145     1.768     0.668 
## count_birth_order1/5+         0.051     0.019     0.013     0.089     2.641    50.594     0.011     0.729     0.443 
## count_birth_order2/5+         0.028     0.017    -0.006     0.061     1.617   152.985     0.108     0.320     0.252 
## count_birth_order3/5+         0.034     0.017    -0.000     0.068     1.939    84.830     0.056     0.483     0.341 
## count_birth_order4/5+         0.043     0.020     0.005     0.082     2.216    38.167     0.033     0.944     0.511 
## count_birth_order5/5+         0.051     0.016     0.020     0.083     3.184   126.069     0.002     0.365     0.279 
## count_birth_order5+/5+        0.073     0.011     0.052     0.094     6.760   399.015     0.000     0.177     0.154 
## poly(age, 3, raw = TRUE)1     0.019     0.002     0.014     0.023     8.397    22.522     0.000     1.718     0.661 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.692    34.307     0.001     1.050     0.538 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.558    50.094     0.579     0.736     0.446 
## male                         -0.019     0.005    -0.029    -0.009    -3.782   273.836     0.000     0.221     0.187 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.166 
## ICC|mother_pidlink                     0.140 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-203" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-515-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-50" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.820      10 225.498   0.610   1.617 
##  2 vs 3:   0.055       4  62.900   0.994   2.648 
##  3 vs 4:  10.164       1  33.600   0.003   0.543</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-25" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-51" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-204" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.482     0.020     0.443     0.522    23.892    13.595     0.000     4.366     0.836 
## poly(age, 3, raw = TRUE)1     0.021     0.002     0.017     0.024    11.155    24.675     0.000     1.525     0.633 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -5.982    29.263     0.000     1.245     0.582 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.732    30.911     0.010     1.172     0.567 
## male                         -0.017     0.006    -0.029    -0.006    -3.011    76.926     0.004     0.520     0.359 
## sibling_count3                0.012     0.008    -0.004     0.027     1.457   180.092     0.147     0.288     0.232 
## sibling_count4                0.023     0.012    -0.001     0.047     1.913    33.624     0.064     1.072     0.544 
## sibling_count5                0.027     0.012     0.004     0.049     2.302   161.052     0.023     0.310     0.246 
## sibling_count5+               0.037     0.012     0.013     0.060     3.091    40.544     0.004     0.891     0.495 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.026 
## Residual~~Residual                     0.165 
## ICC|mother_pidlink                     0.138 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-204" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-518-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-51" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-205" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.461     0.022     0.418     0.504    21.039    13.537     0.000     4.417     0.838 
## birth_order                   0.010     0.002     0.006     0.014     4.617    64.388     0.000     0.597     0.392 
## poly(age, 3, raw = TRUE)1     0.021     0.002     0.017     0.024    11.126    24.120     0.000     1.570     0.640 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -5.835    30.346     0.000     1.196     0.572 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.506    32.507     0.017     1.111     0.553 
## male                         -0.017     0.006    -0.029    -0.006    -3.015    78.183     0.003     0.514     0.356 
## sibling_count3                0.005     0.008    -0.010     0.021     0.650   221.289     0.516     0.253     0.209 
## sibling_count4                0.010     0.012    -0.013     0.034     0.844    39.924     0.404     0.904     0.499 
## sibling_count5                0.007     0.012    -0.017     0.030     0.564   172.682     0.574     0.296     0.237 
## sibling_count5+               0.002     0.012    -0.022     0.026     0.175   133.216     0.861     0.351     0.271 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.165 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-205" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-520-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-51" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-206" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.478     0.021     0.436     0.520    22.418    14.683     0.000     3.607     0.807 
## birth_order_nonlinear2        0.002     0.008    -0.014     0.019     0.278    37.795     0.783     0.953     0.513 
## birth_order_nonlinear3        0.011     0.012    -0.013     0.034     0.889    26.369     0.382     1.405     0.613 
## birth_order_nonlinear4        0.018     0.012    -0.007     0.042     1.424    68.882     0.159     0.566     0.379 
## birth_order_nonlinear5        0.036     0.016     0.005     0.067     2.266    72.924     0.026     0.542     0.368 
## birth_order_nonlinear5+       0.062     0.015     0.032     0.093     4.032    80.725     0.000     0.501     0.350 
## poly(age, 3, raw = TRUE)1     0.020     0.002     0.017     0.024    10.688    24.789     0.000     1.516     0.631 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -5.474    31.244     0.000     1.158     0.564 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.180    32.537     0.037     1.109     0.553 
## male                         -0.017     0.006    -0.028    -0.005    -2.910    93.150     0.005     0.451     0.325 
## sibling_count3                0.007     0.008    -0.009     0.023     0.846   224.183     0.399     0.251     0.207 
## sibling_count4                0.014     0.011    -0.009     0.037     1.218    69.238     0.227     0.564     0.378 
## sibling_count5                0.010     0.013    -0.016     0.036     0.747   120.298     0.457     0.377     0.285 
## sibling_count5+               0.004     0.013    -0.021     0.028     0.280   147.728     0.780     0.328     0.257 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.164 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-206" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-522-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-51" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-207" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.459     0.023     0.414     0.505    19.761    14.942     0.000     3.466     0.801 
## count_birth_order2/2          0.027     0.015    -0.002     0.056     1.833    21.231     0.081     1.866     0.680 
## count_birth_order1/3          0.027     0.016    -0.004     0.058     1.694    33.328     0.100     1.082     0.546 
## count_birth_order2/3          0.005     0.013    -0.020     0.029     0.367    78.597     0.715     0.511     0.355 
## count_birth_order3/3          0.039     0.017     0.005     0.073     2.267    24.863     0.032     1.510     0.630 
## count_birth_order1/4          0.042     0.019     0.004     0.080     2.190    56.321     0.033     0.666     0.420 
## count_birth_order2/4          0.022     0.015    -0.008     0.052     1.459   225.217     0.146     0.250     0.207 
## count_birth_order3/4          0.028     0.015    -0.003     0.058     1.796   184.730     0.074     0.283     0.229 
## count_birth_order4/4          0.038     0.018     0.003     0.074     2.110    56.334     0.039     0.666     0.420 
## count_birth_order1/5          0.031     0.024    -0.015     0.078     1.336   141.079     0.184     0.338     0.263 
## count_birth_order2/5          0.014     0.028    -0.041     0.070     0.505    27.985     0.617     1.310     0.595 
## count_birth_order3/5          0.028     0.024    -0.018     0.075     1.191    48.070     0.240     0.763     0.455 
## count_birth_order4/5          0.038     0.026    -0.013     0.089     1.470    32.449     0.151     1.113     0.553 
## count_birth_order5/5          0.053     0.026     0.002     0.104     2.035    39.571     0.049     0.912     0.501 
## count_birth_order1/5+         0.018     0.024    -0.028     0.065     0.763    68.000     0.448     0.572     0.382 
## count_birth_order2/5+         0.008     0.021    -0.034     0.049     0.357    69.797     0.722     0.560     0.377 
## count_birth_order3/5+         0.015     0.022    -0.027     0.058     0.707    46.259     0.483     0.789     0.464 
## count_birth_order4/5+         0.039     0.023    -0.007     0.084     1.677    34.034     0.103     1.059     0.540 
## count_birth_order5/5+         0.052     0.020     0.013     0.091     2.602    66.236     0.011     0.584     0.387 
## count_birth_order5+/5+        0.075     0.015     0.046     0.105     4.997    68.736     0.000     0.567     0.380 
## poly(age, 3, raw = TRUE)1     0.021     0.002     0.017     0.026    10.086    21.033     0.000     1.891     0.683 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -5.519    27.215     0.000     1.353     0.603 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.426    30.216     0.021     1.201     0.573 
## male                         -0.016     0.006    -0.028    -0.005    -2.747    71.555     0.008     0.550     0.372 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.026 
## Residual~~Residual                     0.164 
## ICC|mother_pidlink                     0.138 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-207" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-524-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-51" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.293      10  91.062   1.000 158.835 
##  2 vs 3:  -0.279       4  36.141   1.000 428.933 
##  3 vs 4:  21.071       1  29.668   0.000   0.614</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-25" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-526-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="work" class="section level2 tabset">
<h2>Work</h2>
<div id="income-last-month-log---z-standardized" class="section level3 tabset">
<h3>Income Last Month (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_month_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-26" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-52" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-208" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.162     0.044    -0.248    -0.076    -3.702    14.435     0.002     3.753     0.814 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.009     0.447    42.270     0.657     0.857     0.485 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.897    84.083     0.061     0.486     0.343 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.200    79.268     0.031     0.508     0.353 
## male                          0.074     0.024     0.027     0.120     3.122    14.078     0.007     3.989     0.823 
## sibling_count3                0.018     0.025    -0.032     0.068     0.708    34.017     0.484     1.059     0.541 
## sibling_count4                0.019     0.027    -0.034     0.071     0.700    46.266     0.487     0.789     0.464 
## sibling_count5                0.011     0.029    -0.047     0.068     0.362    54.426     0.719     0.685     0.427 
## sibling_count5+              -0.000     0.029    -0.057     0.057    -0.001    21.232     0.999     1.866     0.680 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.096 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-208" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-528-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-52" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-209" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.170     0.045    -0.259    -0.081    -3.749    14.460     0.002     3.738     0.813 
## birth_order                   0.004     0.003    -0.003     0.010     1.119    61.178     0.268     0.622     0.403 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.009     0.453    41.912     0.653     0.864     0.487 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     1.964    91.736     0.053     0.456     0.328 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.256    83.267     0.027     0.490     0.344 
## male                          0.074     0.024     0.027     0.120     3.116    14.064     0.008     3.999     0.823 
## sibling_count3                0.016     0.025    -0.034     0.066     0.614    34.214     0.543     1.053     0.539 
## sibling_count4                0.014     0.027    -0.039     0.066     0.517    50.830     0.607     0.726     0.442 
## sibling_count5                0.003     0.029    -0.054     0.061     0.106    62.309     0.916     0.613     0.399 
## sibling_count5+              -0.017     0.028    -0.072     0.038    -0.597    45.653     0.553     0.799     0.467 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-209" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-530-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-52" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-210" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.175     0.048    -0.268    -0.081    -3.658    15.244     0.002     3.317     0.794 
## birth_order_nonlinear2        0.012     0.018    -0.024     0.047     0.661    75.519     0.511     0.527     0.362 
## birth_order_nonlinear3        0.017     0.034    -0.050     0.084     0.500    17.444     0.624     2.550     0.746 
## birth_order_nonlinear4        0.031     0.035    -0.037     0.099     0.887    24.795     0.384     1.516     0.631 
## birth_order_nonlinear5        0.029     0.032    -0.034     0.092     0.902    71.885     0.370     0.548     0.371 
## birth_order_nonlinear5+       0.020     0.030    -0.039     0.079     0.674    46.396     0.504     0.787     0.463 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.006     0.011     0.609    32.570     0.547     1.108     0.552 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.557    50.071     0.126     0.736     0.446 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.853    47.332     0.070     0.773     0.458 
## male                          0.074     0.024     0.027     0.120     3.116    14.073     0.008     3.992     0.823 
## sibling_count3                0.013     0.027    -0.039     0.066     0.499    33.820     0.621     1.066     0.542 
## sibling_count4                0.008     0.026    -0.043     0.059     0.294   108.293     0.769     0.405     0.301 
## sibling_count5               -0.004     0.030    -0.063     0.055    -0.132    94.132     0.895     0.448     0.323 
## sibling_count5+              -0.016     0.029    -0.072     0.040    -0.556    61.667     0.580     0.618     0.401 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.096 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-210" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-532-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-52" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-211" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.170     0.045    -0.258    -0.082    -3.802    20.289     0.001     1.994     0.695 
## count_birth_order2/2          0.007     0.028    -0.049     0.062     0.243    62.438     0.809     0.612     0.399 
## count_birth_order1/3          0.010     0.035    -0.058     0.078     0.292    59.086     0.771     0.640     0.410 
## count_birth_order2/3          0.027     0.032    -0.036     0.091     0.844    99.954     0.401     0.429     0.314 
## count_birth_order3/3          0.025     0.040    -0.054     0.104     0.622    27.581     0.539     1.332     0.599 
## count_birth_order1/4          0.014     0.047    -0.079     0.107     0.298    39.032     0.768     0.924     0.505 
## count_birth_order2/4          0.020     0.040    -0.059     0.099     0.488   114.510     0.627     0.390     0.293 
## count_birth_order3/4          0.019     0.048    -0.075     0.113     0.396    31.941     0.695     1.131     0.558 
## count_birth_order4/4          0.030     0.049    -0.066     0.126     0.617    27.184     0.542     1.355     0.604 
## count_birth_order1/5         -0.029     0.050    -0.126     0.068    -0.583   133.636     0.561     0.350     0.270 
## count_birth_order2/5          0.028     0.058    -0.085     0.141     0.485    48.292     0.630     0.760     0.454 
## count_birth_order3/5         -0.003     0.067    -0.134     0.128    -0.045    23.646     0.964     1.611     0.646 
## count_birth_order4/5          0.030     0.069    -0.106     0.166     0.431    21.017     0.671     1.893     0.683 
## count_birth_order5/5          0.030     0.053    -0.074     0.135     0.567    35.621     0.574     1.011     0.528 
## count_birth_order1/5+        -0.019     0.041    -0.100     0.062    -0.464    76.140     0.644     0.524     0.360 
## count_birth_order2/5+        -0.019     0.046    -0.110     0.071    -0.419    40.367     0.678     0.895     0.497 
## count_birth_order3/5+         0.014     0.051    -0.085     0.114     0.280    25.820     0.782     1.441     0.619 
## count_birth_order4/5+         0.016     0.051    -0.084     0.116     0.307    24.029     0.762     1.577     0.641 
## count_birth_order5/5+         0.006     0.040    -0.072     0.085     0.160    58.062     0.874     0.649     0.414 
## count_birth_order5+/5+        0.002     0.037    -0.070     0.074     0.058    22.470     0.954     1.724     0.662 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.558    43.472     0.580     0.835     0.478 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.583    50.578     0.120     0.730     0.443 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.866    46.591     0.068     0.784     0.462 
## male                          0.074     0.024     0.027     0.120     3.102    14.022     0.008     4.029     0.825 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.892 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-211" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-534-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-52" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.195      10 206.192   0.997   1.833 
##  2 vs 3:   0.194       4  58.539   0.940   3.091 
##  3 vs 4:   1.272       1  30.031   0.268   0.607</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-26" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-53" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-212" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.166     0.039    -0.242    -0.089    -4.246    16.203     0.001     2.926     0.772 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.004     0.010     0.920    41.852     0.363     0.865     0.488 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.774   182.121     0.078     0.286     0.231 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.536   347.998     0.012     0.192     0.166 
## male                          0.075     0.023     0.029     0.120     3.238    14.740     0.006     3.575     0.806 
## sibling_count3                0.014     0.020    -0.025     0.053     0.699    59.376     0.487     0.638     0.409 
## sibling_count4               -0.002     0.030    -0.060     0.057    -0.052    24.764     0.959     1.518     0.631 
## sibling_count5               -0.002     0.035    -0.071     0.066    -0.067    26.065     0.947     1.425     0.616 
## sibling_count5+              -0.006     0.034    -0.072     0.060    -0.166    19.237     0.870     2.165     0.712 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-212" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-537-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-53" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-213" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.180     0.041    -0.260    -0.100    -4.407    17.002     0.000     2.671     0.755 
## birth_order                   0.007     0.005    -0.003     0.017     1.389    70.037     0.169     0.559     0.376 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.004     0.011     0.940    41.238     0.353     0.877     0.491 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.860   205.501     0.064     0.265     0.217 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.641   398.436     0.009     0.177     0.155 
## male                          0.075     0.023     0.029     0.120     3.239    14.739     0.006     3.575     0.806 
## sibling_count3                0.010     0.020    -0.030     0.050     0.476    57.371     0.636     0.656     0.416 
## sibling_count4               -0.010     0.030    -0.069     0.049    -0.339    26.029     0.738     1.427     0.616 
## sibling_count5               -0.015     0.035    -0.084     0.053    -0.440    29.803     0.663     1.220     0.577 
## sibling_count5+              -0.029     0.035    -0.098     0.040    -0.828    28.711     0.415     1.272     0.588 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-213" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-539-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-53" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-214" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.171     0.042    -0.253    -0.089    -4.077    17.777     0.001     2.467     0.739 
## birth_order_nonlinear2        0.007     0.019    -0.030     0.044     0.356    43.612     0.724     0.832     0.478 
## birth_order_nonlinear3        0.020     0.021    -0.021     0.061     0.934   112.379     0.353     0.395     0.295 
## birth_order_nonlinear4        0.006     0.027    -0.047     0.058     0.207   131.814     0.837     0.354     0.272 
## birth_order_nonlinear5        0.018     0.038    -0.057     0.093     0.466    53.334     0.643     0.697     0.432 
## birth_order_nonlinear5+       0.030     0.039    -0.047     0.107     0.766    43.896     0.448     0.827     0.476 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.004     0.011     0.915    42.410     0.365     0.854     0.484 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.763   140.440     0.080     0.339     0.264 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.514   237.780     0.013     0.242     0.201 
## male                          0.074     0.023     0.028     0.120     3.170    14.739     0.006     3.575     0.806 
## sibling_count3                0.008     0.020    -0.032     0.048     0.390    78.107     0.697     0.514     0.356 
## sibling_count4               -0.010     0.030    -0.068     0.049    -0.321    32.424     0.751     1.114     0.554 
## sibling_count5               -0.013     0.037    -0.086     0.059    -0.358    30.604     0.723     1.185     0.570 
## sibling_count5+              -0.022     0.036    -0.092     0.048    -0.619    30.987     0.541     1.169     0.566 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.096 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-214" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-541-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-53" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-215" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.171     0.044    -0.257    -0.085    -3.914    19.735     0.001     2.080     0.704 
## count_birth_order2/2          0.010     0.027    -0.043     0.063     0.372    45.777     0.711     0.797     0.466 
## count_birth_order1/3          0.012     0.031    -0.048     0.072     0.397    82.228     0.692     0.494     0.347 
## count_birth_order2/3          0.013     0.029    -0.044     0.069     0.439    80.355     0.662     0.503     0.351 
## count_birth_order3/3          0.025     0.034    -0.041     0.092     0.751    42.833     0.457     0.846     0.482 
## count_birth_order1/4         -0.025     0.056    -0.135     0.085    -0.442    22.783     0.663     1.692     0.657 
## count_birth_order2/4         -0.003     0.044    -0.089     0.083    -0.066    34.902     0.948     1.032     0.534 
## count_birth_order3/4          0.023     0.046    -0.068     0.114     0.495    30.287     0.624     1.198     0.572 
## count_birth_order4/4         -0.005     0.052    -0.107     0.098    -0.086    23.318     0.932     1.640     0.650 
## count_birth_order1/5         -0.000     0.063    -0.124     0.124    -0.002    42.400     0.999     0.854     0.484 
## count_birth_order2/5          0.003     0.067    -0.129     0.134     0.038    25.469     0.970     1.466     0.623 
## count_birth_order3/5          0.004     0.066    -0.125     0.133     0.058    23.829     0.954     1.595     0.643 
## count_birth_order4/5         -0.029     0.054    -0.134     0.076    -0.537    49.590     0.594     0.742     0.448 
## count_birth_order5/5         -0.004     0.059    -0.120     0.111    -0.074    41.209     0.941     0.877     0.491 
## count_birth_order1/5+        -0.036     0.066    -0.166     0.093    -0.548    27.518     0.588     1.336     0.600 
## count_birth_order2/5+        -0.046     0.066    -0.175     0.082    -0.705    21.380     0.488     1.847     0.678 
## count_birth_order3/5+         0.003     0.049    -0.093     0.099     0.058    50.043     0.954     0.736     0.446 
## count_birth_order4/5+         0.005     0.055    -0.102     0.112     0.088    30.581     0.931     1.186     0.570 
## count_birth_order5/5+         0.005     0.072    -0.135     0.145     0.068    16.223     0.947     2.919     0.771 
## count_birth_order5+/5+        0.005     0.048    -0.088     0.098     0.107    19.568     0.916     2.107     0.707 
## poly(age, 3, raw = TRUE)1     0.003     0.004    -0.004     0.011     0.929    55.716     0.357     0.672     0.422 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.736   136.965     0.085     0.345     0.267 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.470   206.547     0.014     0.264     0.216 
## male                          0.075     0.023     0.030     0.119     3.250    15.223     0.005     3.327     0.794 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-215" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-543-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-53" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.411      10  91.062   0.938 158.909 
##  2 vs 3:   0.449       4  36.141   0.772 428.777 
##  3 vs 4:   1.859       1  30.120   0.183   0.605</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-26" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-545-1.png" width="672" /></p>
</div>
</div>
<div id="income-last-year-log---z-standardized" class="section level3 tabset">
<h3>Income last year (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_year_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-27" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-54" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-216" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.394     0.042    -0.476    -0.311    -9.351    14.719     0.000     3.586     0.807 
## poly(age, 3, raw = TRUE)1     0.013     0.003     0.006     0.020     3.778    68.445     0.000     0.569     0.380 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.275   268.241     0.024     0.224     0.189 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.848   160.321     0.005     0.311     0.246 
## male                          0.078     0.018     0.044     0.113     4.469    21.093     0.000     1.884     0.682 
## sibling_count3                0.007     0.025    -0.042     0.056     0.285    33.592     0.777     1.073     0.544 
## sibling_count4                0.020     0.029    -0.037     0.077     0.699    31.199     0.490     1.160     0.564 
## sibling_count5                0.016     0.033    -0.049     0.081     0.481    29.631     0.634     1.228     0.579 
## sibling_count5+              -0.005     0.030    -0.064     0.054    -0.181    19.625     0.858     2.098     0.706 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.836 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-216" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-547-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-54" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-217" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.402     0.044    -0.488    -0.315    -9.109    14.576     0.000     3.668     0.810 
## birth_order                   0.004     0.004    -0.003     0.011     1.081    45.501     0.285     0.801     0.468 
## poly(age, 3, raw = TRUE)1     0.013     0.003     0.006     0.020     3.780    67.947     0.000     0.572     0.382 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.349   308.081     0.019     0.206     0.176 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.919   176.326     0.004     0.292     0.235 
## male                          0.078     0.018     0.044     0.113     4.462    21.062     0.000     1.888     0.682 
## sibling_count3                0.005     0.025    -0.045     0.054     0.191    33.944     0.849     1.062     0.541 
## sibling_count4                0.015     0.029    -0.041     0.072     0.535    34.569     0.596     1.042     0.536 
## sibling_count5                0.009     0.032    -0.054     0.071     0.266    37.884     0.792     0.951     0.512 
## sibling_count5+              -0.022     0.027    -0.076     0.031    -0.808    48.004     0.423     0.764     0.455 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.836 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-217" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-549-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-54" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-218" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.405     0.046    -0.496    -0.314    -8.708    15.351     0.000     3.268     0.791 
## birth_order_nonlinear2        0.012     0.018    -0.024     0.048     0.655    56.583     0.515     0.663     0.419 
## birth_order_nonlinear3        0.005     0.031    -0.055     0.066     0.178    19.596     0.861     2.103     0.706 
## birth_order_nonlinear4        0.022     0.038    -0.053     0.097     0.574    18.944     0.572     2.218     0.718 
## birth_order_nonlinear5        0.033     0.034    -0.034     0.099     0.962    43.304     0.341     0.838     0.479 
## birth_order_nonlinear5+       0.021     0.030    -0.039     0.080     0.683    39.570     0.499     0.912     0.501 
## poly(age, 3, raw = TRUE)1     0.014     0.004     0.006     0.021     3.481    40.767     0.001     0.886     0.494 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.926    84.190     0.057     0.486     0.342 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.502    73.763     0.015     0.537     0.366 
## male                          0.078     0.018     0.044     0.112     4.461    21.092     0.000     1.884     0.682 
## sibling_count3                0.007     0.028    -0.048     0.063     0.248    27.328     0.806     1.347     0.602 
## sibling_count4                0.015     0.030    -0.044     0.074     0.494    38.091     0.624     0.946     0.511 
## sibling_count5                0.005     0.035    -0.065     0.074     0.138    34.128     0.891     1.056     0.540 
## sibling_count5+              -0.019     0.030    -0.079     0.040    -0.636    42.046     0.528     0.861     0.487 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-218" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-551-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-54" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-219" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.404     0.041    -0.484    -0.323    -9.828    23.408     0.000     1.632     0.649 
## count_birth_order2/2          0.010     0.029    -0.046     0.067     0.354    46.640     0.725     0.783     0.462 
## count_birth_order1/3          0.004     0.036    -0.067     0.076     0.112    39.821     0.912     0.906     0.500 
## count_birth_order2/3          0.015     0.034    -0.052     0.082     0.446    55.475     0.658     0.674     0.423 
## count_birth_order3/3          0.016     0.039    -0.060     0.092     0.410    28.427     0.685     1.287     0.591 
## count_birth_order1/4          0.034     0.050    -0.064     0.131     0.673    29.449     0.506     1.236     0.580 
## count_birth_order2/4          0.024     0.039    -0.053     0.101     0.611   115.341     0.543     0.388     0.292 
## count_birth_order3/4          0.008     0.043    -0.077     0.093     0.191    44.850     0.850     0.811     0.471 
## count_birth_order4/4          0.032     0.044    -0.055     0.118     0.716    35.301     0.479     1.020     0.531 
## count_birth_order1/5         -0.006     0.058    -0.120     0.108    -0.103    37.966     0.918     0.949     0.512 
## count_birth_order2/5          0.039     0.059    -0.078     0.155     0.650    37.221     0.520     0.967     0.517 
## count_birth_order3/5          0.000     0.069    -0.135     0.136     0.001    20.562     0.999     1.955     0.690 
## count_birth_order4/5          0.016     0.064    -0.111     0.142     0.244    23.361     0.809     1.636     0.649 
## count_birth_order5/5          0.044     0.053    -0.060     0.147     0.827    33.763     0.414     1.067     0.543 
## count_birth_order1/5+        -0.031     0.040    -0.110     0.047    -0.784    78.995     0.435     0.510     0.354 
## count_birth_order2/5+        -0.009     0.043    -0.094     0.076    -0.210    49.873     0.835     0.739     0.447 
## count_birth_order3/5+        -0.007     0.044    -0.094     0.080    -0.163    38.175     0.872     0.944     0.511 
## count_birth_order4/5+         0.011     0.051    -0.089     0.111     0.219    22.510     0.829     1.720     0.661 
## count_birth_order5/5+         0.008     0.044    -0.079     0.095     0.188    32.335     0.852     1.117     0.554 
## count_birth_order5+/5+        0.001     0.036    -0.070     0.071     0.015    22.854     0.988     1.685     0.656 
## poly(age, 3, raw = TRUE)1     0.014     0.004     0.006     0.021     3.712    71.861     0.000     0.548     0.371 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.899    99.174     0.060     0.431     0.315 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.464    78.357     0.016     0.513     0.355 
## male                          0.078     0.018     0.044     0.113     4.438    20.865     0.000     1.914     0.686 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-219" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-553-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-54" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.237      10 198.846   0.992   1.935 
##  2 vs 3:   0.203       4  58.827   0.936   3.057 
##  3 vs 4:   1.151       1  22.962   0.295   0.821</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-27" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-55" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-220" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.401     0.040    -0.480    -0.322    -9.941    15.116     0.000     3.379     0.797 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.009     0.023     4.404    39.809     0.000     0.907     0.500 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.492   144.662     0.138     0.332     0.260 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.424   139.978     0.017     0.340     0.264 
## male                          0.080     0.019     0.043     0.117     4.280    19.162     0.000     2.178     0.714 
## sibling_count3                0.002     0.021    -0.039     0.044     0.115    40.485     0.909     0.892     0.496 
## sibling_count4               -0.002     0.024    -0.048     0.044    -0.088    58.237     0.930     0.648     0.413 
## sibling_count5               -0.017     0.031    -0.077     0.043    -0.557    38.208     0.581     0.943     0.510 
## sibling_count5+              -0.020     0.036    -0.091     0.050    -0.567    16.989     0.578     2.674     0.755 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-220" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-556-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-55" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-221" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.416     0.041    -0.496    -0.336   -10.148    16.345     0.000     2.877     0.769 
## birth_order                   0.007     0.005    -0.002     0.017     1.479    52.274     0.145     0.709     0.436 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.009     0.023     4.428    39.750     0.000     0.908     0.500 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.576   148.030     0.117     0.327     0.257 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.533   147.639     0.012     0.328     0.257 
## male                          0.080     0.019     0.043     0.117     4.279    19.146     0.000     2.181     0.714 
## sibling_count3               -0.002     0.021    -0.044     0.039    -0.106    43.237     0.916     0.839     0.480 
## sibling_count4               -0.012     0.025    -0.060     0.037    -0.472    56.928     0.639     0.660     0.418 
## sibling_count5               -0.031     0.030    -0.091     0.028    -1.033    51.683     0.306     0.716     0.439 
## sibling_count5+              -0.046     0.038    -0.120     0.028    -1.218    22.779     0.236     1.692     0.657 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.834 
## ICC|mother_pidlink                     0.114 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-221" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-558-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-55" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-222" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.405     0.044    -0.491    -0.319    -9.183    15.945     0.000     3.021     0.778 
## birth_order_nonlinear2        0.007     0.020    -0.032     0.045     0.339    32.739     0.737     1.102     0.551 
## birth_order_nonlinear3        0.018     0.026    -0.033     0.069     0.696    28.047     0.492     1.307     0.594 
## birth_order_nonlinear4        0.013     0.034    -0.054     0.079     0.370    28.393     0.714     1.288     0.591 
## birth_order_nonlinear5        0.018     0.045    -0.070     0.106     0.397    25.596     0.695     1.457     0.621 
## birth_order_nonlinear5+       0.039     0.035    -0.029     0.108     1.126    74.700     0.264     0.532     0.364 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.008     0.023     4.134    34.911     0.000     1.031     0.534 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.463    79.392     0.147     0.508     0.353 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.367    91.933     0.020     0.455     0.327 
## male                          0.079     0.019     0.042     0.116     4.201    19.434     0.000     2.130     0.709 
## sibling_count3               -0.004     0.020    -0.044     0.036    -0.204    69.367     0.839     0.563     0.378 
## sibling_count4               -0.011     0.024    -0.059     0.036    -0.478   104.324     0.634     0.416     0.307 
## sibling_count5               -0.029     0.032    -0.091     0.033    -0.915    55.230     0.364     0.677     0.424 
## sibling_count5+              -0.041     0.039    -0.117     0.035    -1.062    23.494     0.299     1.624     0.648 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-222" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-560-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-55" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-223" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.407     0.044    -0.494    -0.320    -9.151    18.395     0.000     2.327     0.728 
## count_birth_order2/2          0.010     0.027    -0.044     0.063     0.359    37.598     0.722     0.958     0.514 
## count_birth_order1/3         -0.006     0.030    -0.064     0.052    -0.190    91.533     0.849     0.457     0.328 
## count_birth_order2/3          0.004     0.028    -0.051     0.059     0.153    82.164     0.879     0.495     0.347 
## count_birth_order3/3          0.013     0.042    -0.070     0.095     0.300    20.308     0.768     1.992     0.694 
## count_birth_order1/4         -0.013     0.045    -0.102     0.076    -0.282    42.439     0.779     0.854     0.484 
## count_birth_order2/4         -0.015     0.044    -0.100     0.071    -0.335    33.399     0.740     1.079     0.546 
## count_birth_order3/4          0.013     0.042    -0.068     0.095     0.322    42.166     0.749     0.859     0.486 
## count_birth_order4/4          0.005     0.045    -0.084     0.093     0.105    34.034     0.917     1.059     0.540 
## count_birth_order1/5         -0.008     0.067    -0.139     0.123    -0.123    30.996     0.903     1.169     0.566 
## count_birth_order2/5         -0.017     0.064    -0.142     0.108    -0.268    27.568     0.790     1.333     0.599 
## count_birth_order3/5         -0.012     0.061    -0.132     0.109    -0.188    27.211     0.852     1.354     0.603 
## count_birth_order4/5         -0.042     0.060    -0.160     0.076    -0.697    28.013     0.491     1.308     0.595 
## count_birth_order5/5         -0.019     0.056    -0.130     0.091    -0.344    44.540     0.733     0.817     0.473 
## count_birth_order1/5+        -0.059     0.056    -0.169     0.051    -1.057    47.579     0.296     0.770     0.457 
## count_birth_order2/5+        -0.054     0.065    -0.182     0.074    -0.833    20.582     0.414     1.952     0.690 
## count_birth_order3/5+        -0.016     0.051    -0.116     0.084    -0.310    35.911     0.758     1.002     0.526 
## count_birth_order4/5+        -0.011     0.050    -0.109     0.088    -0.211    38.484     0.834     0.936     0.508 
## count_birth_order5/5+        -0.019     0.070    -0.156     0.119    -0.266    16.161     0.793     2.941     0.773 
## count_birth_order5+/5+       -0.004     0.041    -0.085     0.077    -0.102    25.830     0.919     1.441     0.619 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.008     0.023     4.102    38.286     0.000     0.941     0.510 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.389    66.277     0.170     0.584     0.387 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.279    75.633     0.026     0.527     0.362 
## male                          0.080     0.019     0.043     0.118     4.201    19.229     0.000     2.166     0.713 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.107 
## Residual~~Residual                     0.835 
## ICC|mother_pidlink                     0.113 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-223" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-562-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-55" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.403      10  91.062   0.942 158.858 
##  2 vs 3:   0.397       4  36.141   0.809 429.345 
##  3 vs 4:   2.157       1  25.254   0.154   0.733</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-27" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-564-1.png" width="672" /></p>
</div>
</div>
<div id="self-employment---non-standardized" class="section level3 tabset">
<h3>Self-Employment - non standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = Self_employed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-28" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-56" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-224" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.164     0.060     0.047     0.281     2.749    11.029     0.019     9.345     0.917 
## poly(age, 3, raw = TRUE)1    -0.003     0.005    -0.013     0.007    -0.592    17.089     0.561     2.646     0.753 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.504    21.546     0.147     1.827     0.675 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.225    25.486     0.232     1.465     0.623 
## male                          0.063     0.015     0.033     0.092     4.147    27.041     0.000     1.364     0.605 
## sibling_count3               -0.005     0.024    -0.052     0.042    -0.195    30.626     0.847     1.184     0.569 
## sibling_count4               -0.010     0.032    -0.073     0.053    -0.312    19.929     0.758     2.049     0.701 
## sibling_count5               -0.013     0.030    -0.071     0.045    -0.429    34.309     0.671     1.050     0.538 
## sibling_count5+               0.010     0.025    -0.040     0.060     0.386    24.034     0.703     1.577     0.641 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.068 
## Residual~~Residual                     0.782 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-224" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-566-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-56" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-225" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.064     0.039     0.291     2.570    10.869     0.026    10.106     0.923 
## birth_order                  -0.000     0.004    -0.007     0.007    -0.101    34.062     0.920     1.058     0.540 
## poly(age, 3, raw = TRUE)1    -0.003     0.005    -0.013     0.007    -0.591    17.008     0.562     2.669     0.755 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.524    22.344     0.142     1.737     0.663 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.237    26.457     0.227     1.400     0.612 
## male                          0.063     0.015     0.033     0.092     4.150    27.090     0.000     1.361     0.605 
## sibling_count3               -0.004     0.024    -0.051     0.043    -0.186    31.395     0.853     1.152     0.562 
## sibling_count4               -0.010     0.031    -0.070     0.051    -0.311    22.435     0.759     1.728     0.662 
## sibling_count5               -0.012     0.030    -0.071     0.047    -0.396    34.749     0.694     1.036     0.535 
## sibling_count5+               0.011     0.027    -0.041     0.064     0.423    37.266     0.675     0.966     0.517 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.068 
## Residual~~Residual                     0.782 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-225" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-568-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-56" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-226" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.068     0.026     0.291     2.349    11.088     0.038     9.094     0.915 
## birth_order_nonlinear2        0.008     0.020    -0.032     0.047     0.389    30.706     0.700     1.180     0.569 
## birth_order_nonlinear3        0.004     0.030    -0.055     0.063     0.126    19.167     0.901     2.177     0.714 
## birth_order_nonlinear4        0.005     0.031    -0.056     0.067     0.165    27.146     0.870     1.357     0.604 
## birth_order_nonlinear5       -0.003     0.032    -0.066     0.060    -0.095    46.690     0.924     0.783     0.462 
## birth_order_nonlinear5+      -0.004     0.027    -0.057     0.049    -0.147    54.690     0.884     0.683     0.426 
## poly(age, 3, raw = TRUE)1    -0.003     0.005    -0.013     0.008    -0.495    16.334     0.628     2.880     0.769 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.408    22.081     0.173     1.766     0.667 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.153    27.425     0.259     1.341     0.601 
## male                          0.063     0.015     0.033     0.092     4.143    27.009     0.000     1.366     0.605 
## sibling_count3               -0.005     0.023    -0.049     0.040    -0.199    48.430     0.843     0.758     0.453 
## sibling_count4               -0.010     0.027    -0.063     0.043    -0.384    45.555     0.703     0.800     0.467 
## sibling_count5               -0.011     0.031    -0.071     0.049    -0.365    47.495     0.717     0.771     0.458 
## sibling_count5+               0.014     0.026    -0.037     0.065     0.543    67.680     0.589     0.574     0.383 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.068 
## Residual~~Residual                     0.781 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-226" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-570-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-56" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-227" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.167     0.070     0.030     0.304     2.386    11.549     0.035     7.531     0.899 
## count_birth_order2/2         -0.005     0.031    -0.066     0.055    -0.179    30.510     0.859     1.189     0.570 
## count_birth_order1/3         -0.024     0.030    -0.084     0.036    -0.789    88.820     0.432     0.467     0.333 
## count_birth_order2/3          0.005     0.044    -0.080     0.091     0.124    20.211     0.903     2.006     0.696 
## count_birth_order3/3         -0.004     0.046    -0.094     0.087    -0.078    17.415     0.938     2.557     0.746 
## count_birth_order1/4         -0.012     0.041    -0.093     0.069    -0.281    53.447     0.780     0.696     0.431 
## count_birth_order2/4          0.001     0.043    -0.083     0.084     0.014    45.307     0.989     0.804     0.469 
## count_birth_order3/4         -0.016     0.056    -0.125     0.094    -0.281    18.429     0.782     2.320     0.727 
## count_birth_order4/4         -0.021     0.051    -0.122     0.079    -0.414    20.062     0.683     2.028     0.698 
## count_birth_order1/5         -0.032     0.048    -0.126     0.062    -0.660    87.805     0.511     0.471     0.335 
## count_birth_order2/5         -0.017     0.068    -0.151     0.117    -0.254    21.213     0.802     1.868     0.680 
## count_birth_order3/5         -0.010     0.045    -0.097     0.078    -0.218   126.540     0.828     0.364     0.278 
## count_birth_order4/5          0.003     0.062    -0.118     0.125     0.054    22.713     0.957     1.699     0.658 
## count_birth_order5/5         -0.021     0.050    -0.119     0.077    -0.419    34.666     0.678     1.039     0.536 
## count_birth_order1/5+         0.013     0.042    -0.070     0.096     0.314    42.136     0.755     0.859     0.486 
## count_birth_order2/5+         0.018     0.041    -0.062     0.097     0.434    55.027     0.666     0.679     0.425 
## count_birth_order3/5+         0.004     0.045    -0.084     0.092     0.092    29.756     0.927     1.222     0.577 
## count_birth_order4/5+         0.014     0.039    -0.063     0.090     0.353    48.265     0.725     0.760     0.454 
## count_birth_order5/5+         0.005     0.039    -0.073     0.082     0.119    42.586     0.906     0.851     0.483 
## count_birth_order5+/5+        0.004     0.027    -0.050     0.058     0.141    48.062     0.888     0.763     0.455 
## poly(age, 3, raw = TRUE)1    -0.003     0.006    -0.014     0.008    -0.529    16.252     0.604     2.909     0.771 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.427    21.984     0.168     1.776     0.669 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.185    27.323     0.246     1.347     0.602 
## male                          0.063     0.015     0.033     0.092     4.157    27.502     0.000     1.337     0.600 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.068 
## Residual~~Residual                     0.781 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-227" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-572-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-56" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.254      10 192.535   0.990   2.034 
##  2 vs 3:   0.219       4  60.477   0.927   2.875 
##  3 vs 4:   0.010       1  19.142   0.920   1.051</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-28" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-57" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-228" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.056     0.049     0.269     2.834    11.191     0.016     8.687     0.911 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.007    -0.521    16.748     0.610     2.746     0.760 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.632    22.875     0.116     1.683     0.656 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.398    31.308     0.172     1.156     0.563 
## male                          0.064     0.015     0.034     0.094     4.203    27.590     0.000     1.332     0.599 
## sibling_count3               -0.004     0.023    -0.048     0.041    -0.159    24.717     0.875     1.522     0.632 
## sibling_count4               -0.008     0.027    -0.062     0.045    -0.302    23.774     0.765     1.599     0.644 
## sibling_count5                0.012     0.026    -0.039     0.062     0.444    59.194     0.659     0.639     0.410 
## sibling_count5+               0.013     0.026    -0.038     0.063     0.492    29.590     0.627     1.230     0.579 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-228" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-575-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-57" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-229" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.160     0.059     0.044     0.276     2.698    11.307     0.020     8.273     0.907 
## birth_order                  -0.000     0.004    -0.009     0.008    -0.113   130.195     0.910     0.357     0.274 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.007    -0.521    16.724     0.609     2.753     0.761 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.630    22.997     0.117     1.671     0.654 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.391    31.324     0.174     1.155     0.563 
## male                          0.064     0.015     0.034     0.094     4.202    27.582     0.000     1.332     0.599 
## sibling_count3               -0.003     0.022    -0.047     0.040    -0.150    27.491     0.882     1.337     0.600 
## sibling_count4               -0.008     0.028    -0.062     0.047    -0.276    24.782     0.785     1.517     0.631 
## sibling_count5                0.012     0.027    -0.040     0.065     0.465    71.301     0.643     0.551     0.373 
## sibling_count5+               0.014     0.030    -0.045     0.073     0.471    34.843     0.641     1.033     0.534 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-229" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-577-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-57" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-230" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.160     0.061     0.039     0.280     2.597    11.433     0.024     7.868     0.903 
## birth_order_nonlinear2       -0.000     0.017    -0.034     0.034    -0.010    44.366     0.992     0.820     0.474 
## birth_order_nonlinear3        0.003     0.022    -0.040     0.046     0.123    46.329     0.903     0.788     0.463 
## birth_order_nonlinear4       -0.008     0.029    -0.065     0.050    -0.258    40.567     0.797     0.890     0.495 
## birth_order_nonlinear5        0.004     0.041    -0.076     0.084     0.095    29.402     0.925     1.238     0.581 
## birth_order_nonlinear5+      -0.001     0.031    -0.061     0.060    -0.019   147.637     0.985     0.328     0.257 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.007    -0.523    17.130     0.608     2.634     0.752 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.636    24.502     0.115     1.539     0.635 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.420    36.782     0.164     0.979     0.520 
## male                          0.064     0.016     0.032     0.095     3.997    24.905     0.001     1.507     0.630 
## sibling_count3               -0.004     0.022    -0.047     0.039    -0.179    32.045     0.859     1.127     0.557 
## sibling_count4               -0.007     0.028    -0.063     0.048    -0.263    28.400     0.794     1.288     0.591 
## sibling_count5                0.012     0.028    -0.043     0.066     0.417    88.805     0.678     0.467     0.333 
## sibling_count5+               0.013     0.027    -0.041     0.066     0.472    79.998     0.638     0.505     0.351 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.772 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-230" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-579-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-57" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-231" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.168     0.058     0.053     0.282     2.867    12.542     0.014     5.541     0.867 
## count_birth_order2/2         -0.012     0.025    -0.062     0.038    -0.469    41.280     0.642     0.876     0.491 
## count_birth_order1/3         -0.013     0.027    -0.066     0.039    -0.502   139.418     0.617     0.341     0.265 
## count_birth_order2/3         -0.004     0.035    -0.073     0.065    -0.115    22.986     0.910     1.672     0.655 
## count_birth_order3/3         -0.008     0.036    -0.079     0.063    -0.222    25.394     0.826     1.471     0.624 
## count_birth_order1/4         -0.033     0.045    -0.121     0.055    -0.727    34.721     0.472     1.037     0.535 
## count_birth_order2/4         -0.016     0.045    -0.105     0.072    -0.358    24.909     0.723     1.507     0.630 
## count_birth_order3/4          0.003     0.040    -0.075     0.081     0.085    39.259     0.933     0.919     0.503 
## count_birth_order4/4         -0.018     0.036    -0.089     0.053    -0.500    83.029     0.619     0.491     0.345 
## count_birth_order1/5          0.009     0.047    -0.083     0.101     0.197   332.371     0.844     0.197     0.170 
## count_birth_order2/5          0.027     0.053    -0.077     0.130     0.504    47.017     0.617     0.778     0.460 
## count_birth_order3/5          0.000     0.043    -0.083     0.084     0.003   193.781     0.998     0.275     0.223 
## count_birth_order4/5         -0.004     0.053    -0.107     0.100    -0.067    36.956     0.947     0.974     0.519 
## count_birth_order5/5         -0.013     0.065    -0.141     0.114    -0.202    22.826     0.841     1.688     0.657 
## count_birth_order1/5+         0.003     0.062    -0.117     0.124     0.055    26.741     0.956     1.382     0.608 
## count_birth_order2/5+         0.004     0.046    -0.086     0.094     0.096    59.618     0.924     0.635     0.408 
## count_birth_order3/5+         0.001     0.038    -0.075     0.076     0.016   199.266     0.987     0.270     0.220 
## count_birth_order4/5+         0.008     0.045    -0.081     0.097     0.184    46.659     0.855     0.783     0.462 
## count_birth_order5/5+         0.023     0.050    -0.074     0.121     0.468    29.423     0.643     1.237     0.581 
## count_birth_order5+/5+        0.003     0.031    -0.057     0.064     0.113    69.209     0.911     0.564     0.378 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.012     0.006    -0.617    20.232     0.544     2.003     0.696 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.792    31.792     0.083     1.137     0.559 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.506    46.354     0.139     0.788     0.463 
## male                          0.064     0.017     0.032     0.097     3.872    23.283     0.001     1.644     0.651 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.067 
## Residual~~Residual                     0.772 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-231" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-581-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-57" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.353      10  91.064   0.963 158.583 
##  2 vs 3:   0.301       4  36.141   0.875 428.802 
##  3 vs 4:   0.013       1  56.194   0.909   0.349</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-28" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-583-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="smoking-behaviour" class="section level2 tabset">
<h2>Smoking Behaviour</h2>
<div id="ever_smoked" class="section level3 tabset">
<h3>ever_smoked</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = ever_smoked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-29" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-58" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-232" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.169     0.014    -0.196    -0.142   -12.433    16.034     0.000     2.987     0.776 
## poly(age, 3, raw = TRUE)1     0.004     0.001     0.001     0.006     3.156   103.601     0.002     0.418     0.308 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     3.580   130.888     0.000     0.355     0.273 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.659   104.031     0.000     0.417     0.307 
## male                          0.660     0.005     0.650     0.670   131.492    35.844     0.000     1.004     0.527 
## sibling_count3               -0.000     0.009    -0.018     0.017    -0.021    31.725     0.984     1.140     0.560 
## sibling_count4                0.006     0.008    -0.011     0.023     0.698    81.013     0.487     0.500     0.349 
## sibling_count5                0.015     0.009    -0.003     0.033     1.662   112.270     0.099     0.395     0.296 
## sibling_count5+               0.036     0.008     0.021     0.050     4.764    67.289     0.000     0.577     0.384 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.135 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-232" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-585-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-58" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-233" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.170     0.014    -0.197    -0.143   -12.316    16.572     0.000     2.802     0.764 
## birth_order                   0.000     0.001    -0.002     0.003     0.317    54.867     0.752     0.681     0.426 
## poly(age, 3, raw = TRUE)1     0.004     0.001     0.001     0.006     3.158   104.075     0.002     0.417     0.307 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     3.585   127.575     0.000     0.362     0.277 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.663   102.618     0.000     0.421     0.309 
## male                          0.660     0.005     0.650     0.670   131.456    35.806     0.000     1.005     0.527 
## sibling_count3               -0.000     0.009    -0.018     0.017    -0.047    33.461     0.963     1.077     0.545 
## sibling_count4                0.005     0.008    -0.011     0.022     0.652   109.021     0.516     0.403     0.300 
## sibling_count5                0.015     0.009    -0.003     0.032     1.615   198.313     0.108     0.271     0.221 
## sibling_count5+               0.034     0.008     0.018     0.050     4.148   157.818     0.000     0.314     0.248 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.135 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-233" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-587-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-58" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-234" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.171     0.013    -0.197    -0.145   -12.932    20.972     0.000     1.899     0.684 
## birth_order_nonlinear2        0.003     0.006    -0.008     0.014     0.581   147.944     0.562     0.327     0.257 
## birth_order_nonlinear3        0.001     0.007    -0.013     0.015     0.129   111.523     0.898     0.397     0.297 
## birth_order_nonlinear4        0.004     0.009    -0.013     0.021     0.495   107.414     0.622     0.407     0.302 
## birth_order_nonlinear5        0.000     0.010    -0.019     0.020     0.035   160.332     0.972     0.310     0.246 
## birth_order_nonlinear5+      -0.000     0.010    -0.019     0.019    -0.046    57.410     0.964     0.655     0.416 
## poly(age, 3, raw = TRUE)1     0.004     0.001     0.001     0.006     3.252   127.971     0.001     0.361     0.276 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     3.391   140.768     0.001     0.338     0.263 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.498   114.880     0.000     0.389     0.292 
## male                          0.660     0.005     0.650     0.670   131.350    35.695     0.000     1.009     0.528 
## sibling_count3                0.000     0.009    -0.017     0.017     0.002    45.665     0.998     0.798     0.467 
## sibling_count4                0.005     0.008    -0.011     0.022     0.627   247.340     0.531     0.236     0.197 
## sibling_count5                0.015     0.010    -0.004     0.034     1.566   213.421     0.119     0.258     0.213 
## sibling_count5+               0.036     0.008     0.020     0.053     4.296   296.575     0.000     0.211     0.180 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.135 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-234" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-589-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-58" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-235" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.177     0.015    -0.205    -0.148   -12.074    21.828     0.000     1.794     0.671 
## count_birth_order2/2          0.008     0.009    -0.009     0.024     0.890   135.722     0.375     0.347     0.268 
## count_birth_order1/3         -0.005     0.013    -0.030     0.020    -0.402    37.295     0.690     0.966     0.516 
## count_birth_order2/3          0.007     0.011    -0.015     0.029     0.608    77.830     0.545     0.515     0.356 
## count_birth_order3/3          0.007     0.014    -0.021     0.035     0.524    23.930     0.605     1.586     0.642 
## count_birth_order1/4          0.006     0.015    -0.023     0.035     0.393    57.209     0.696     0.657     0.417 
## count_birth_order2/4          0.004     0.013    -0.021     0.029     0.306   326.879     0.760     0.199     0.171 
## count_birth_order3/4          0.009     0.013    -0.016     0.034     0.690   135.499     0.491     0.347     0.268 
## count_birth_order4/4          0.016     0.015    -0.013     0.045     1.079    39.228     0.287     0.919     0.504 
## count_birth_order1/5          0.028     0.016    -0.003     0.059     1.755   284.808     0.080     0.216     0.183 
## count_birth_order2/5          0.007     0.018    -0.028     0.041     0.387    92.967     0.699     0.452     0.325 
## count_birth_order3/5          0.005     0.019    -0.032     0.042     0.255    42.998     0.800     0.843     0.481 
## count_birth_order4/5          0.033     0.017    -0.001     0.068     1.900    59.745     0.062     0.634     0.408 
## count_birth_order5/5          0.018     0.016    -0.012     0.048     1.166    80.949     0.247     0.500     0.349 
## count_birth_order1/5+         0.049     0.013     0.023     0.075     3.742   131.424     0.000     0.354     0.273 
## count_birth_order2/5+         0.044     0.013     0.018     0.070     3.273   112.933     0.001     0.393     0.295 
## count_birth_order3/5+         0.037     0.012     0.013     0.061     2.993   219.096     0.003     0.254     0.210 
## count_birth_order4/5+         0.031     0.012     0.007     0.056     2.545   143.817     0.012     0.334     0.260 
## count_birth_order5/5+         0.038     0.013     0.012     0.064     2.851    63.793     0.006     0.602     0.394 
## count_birth_order5+/5+        0.037     0.011     0.016     0.058     3.503    37.397     0.001     0.963     0.516 
## poly(age, 3, raw = TRUE)1     0.004     0.001     0.002     0.007     3.491   103.125     0.001     0.419     0.309 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.819    90.975     0.006     0.459     0.329 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.973    81.182     0.000     0.499     0.349 
## male                          0.660     0.005     0.650     0.670   131.834    36.245     0.000     0.993     0.524 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.135 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-235" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-591-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-58" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:   0.166      10 224.218   0.998   1.629 
##  2 vs 3:  -0.162       4  71.413   1.000   2.092 
##  3 vs 4:   0.101       1  27.017   0.753   0.679</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-29" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-59" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-236" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.177     0.014    -0.205    -0.149   -12.340    14.647     0.000     3.627     0.808 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.637    34.628     0.000     1.040     0.536 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.228    41.330     0.226     0.875     0.491 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.503    39.877     0.016     0.905     0.500 
## male                          0.661     0.005     0.652     0.671   138.562    48.540     0.000     0.756     0.453 
## sibling_count3               -0.001     0.007    -0.016     0.013    -0.195    42.326     0.846     0.856     0.485 
## sibling_count4                0.008     0.008    -0.007     0.024     1.061    80.950     0.292     0.500     0.349 
## sibling_count5                0.023     0.011     0.002     0.044     2.143    38.178     0.039     0.944     0.511 
## sibling_count5+               0.036     0.009     0.019     0.053     4.205    50.350     0.000     0.732     0.444 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.134 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-236" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-594-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-59" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-237" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.177     0.014    -0.206    -0.149   -12.247    15.900     0.000     3.038     0.779 
## birth_order                   0.000     0.002    -0.004     0.004     0.110    26.164     0.913     1.418     0.615 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.650    34.984     0.000     1.029     0.533 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.226    40.122     0.227     0.900     0.498 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.490    38.680     0.017     0.932     0.507 
## male                          0.661     0.005     0.652     0.671   138.595    48.598     0.000     0.755     0.452 
## sibling_count3               -0.002     0.007    -0.016     0.013    -0.210    39.806     0.835     0.907     0.500 
## sibling_count4                0.008     0.009    -0.009     0.025     0.912    47.959     0.366     0.764     0.455 
## sibling_count5                0.023     0.011     0.001     0.044     2.043    42.805     0.047     0.847     0.482 
## sibling_count5+               0.036     0.011     0.014     0.058     3.190    37.773     0.003     0.954     0.513 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.134 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-237" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-596-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-59" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-238" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.180     0.015    -0.209    -0.150   -11.947    16.279     0.000     2.899     0.770 
## birth_order_nonlinear2        0.004     0.006    -0.008     0.017     0.694    43.977     0.492     0.826     0.476 
## birth_order_nonlinear3        0.006     0.008    -0.008     0.021     0.845    61.598     0.402     0.619     0.401 
## birth_order_nonlinear4        0.006     0.011    -0.016     0.028     0.498    31.352     0.622     1.154     0.563 
## birth_order_nonlinear5       -0.003     0.014    -0.030     0.025    -0.189    36.008     0.851     1.000     0.526 
## birth_order_nonlinear5+       0.006     0.013    -0.020     0.032     0.459    39.595     0.649     0.911     0.501 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.009     4.537    34.377     0.000     1.048     0.538 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.109    37.650     0.274     0.957     0.514 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.318    37.513     0.026     0.960     0.515 
## male                          0.660     0.005     0.651     0.670   139.871    55.461     0.000     0.675     0.423 
## sibling_count3               -0.003     0.008    -0.018     0.012    -0.384    43.863     0.703     0.828     0.476 
## sibling_count4                0.006     0.009    -0.012     0.024     0.677    51.534     0.501     0.718     0.439 
## sibling_count5                0.022     0.012    -0.001     0.046     1.861    36.716     0.071     0.981     0.521 
## sibling_count5+               0.035     0.012     0.011     0.058     2.918    34.939     0.006     1.031     0.533 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.133 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-238" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-598-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-59" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-239" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.183     0.014    -0.211    -0.155   -12.723    20.900     0.000     1.909     0.685 
## count_birth_order2/2          0.008     0.008    -0.008     0.023     1.003   109.799     0.318     0.401     0.299 
## count_birth_order1/3         -0.001     0.010    -0.021     0.019    -0.063    95.471     0.950     0.443     0.321 
## count_birth_order2/3          0.001     0.010    -0.019     0.022     0.115    51.452     0.909     0.719     0.440 
## count_birth_order3/3          0.006     0.011    -0.016     0.029     0.528    41.505     0.601     0.871     0.490 
## count_birth_order1/4          0.003     0.013    -0.022     0.028     0.243   283.397     0.808     0.217     0.184 
## count_birth_order2/4          0.012     0.016    -0.020     0.044     0.719    25.424     0.479     1.469     0.623 
## count_birth_order3/4          0.016     0.012    -0.008     0.040     1.339   132.023     0.183     0.353     0.272 
## count_birth_order4/4          0.015     0.015    -0.014     0.044     1.015    43.016     0.316     0.843     0.481 
## count_birth_order1/5          0.026     0.018    -0.009     0.061     1.432   161.145     0.154     0.309     0.246 
## count_birth_order2/5          0.023     0.020    -0.017     0.062     1.136    37.224     0.263     0.967     0.517 
## count_birth_order3/5          0.029     0.020    -0.011     0.070     1.442    30.128     0.160     1.205     0.574 
## count_birth_order4/5          0.027     0.017    -0.007     0.060     1.546    66.978     0.127     0.579     0.385 
## count_birth_order5/5          0.034     0.018    -0.002     0.070     1.866    61.084     0.067     0.623     0.403 
## count_birth_order1/5+         0.057     0.019     0.019     0.095     2.943    48.285     0.005     0.760     0.454 
## count_birth_order2/5+         0.046     0.017     0.013     0.080     2.691    50.714     0.010     0.728     0.443 
## count_birth_order3/5+         0.038     0.015     0.008     0.068     2.486    79.691     0.015     0.506     0.352 
## count_birth_order4/5+         0.040     0.015     0.010     0.069     2.643    87.380     0.010     0.473     0.336 
## count_birth_order5/5+         0.023     0.015    -0.006     0.053     1.534    69.395     0.130     0.563     0.378 
## count_birth_order5+/5+        0.043     0.012     0.019     0.066     3.591    57.807     0.001     0.652     0.414 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.004     0.009     4.898    47.826     0.000     0.766     0.456 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.929    47.175     0.358     0.776     0.459 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.130    41.927     0.039     0.863     0.487 
## male                          0.660     0.005     0.651     0.670   140.954    62.235     0.000     0.614     0.399 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.134 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-239" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-600-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-59" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.527      10  91.064   1.000 158.513 
##  2 vs 3:  -0.585       4  36.141   1.000 428.771 
##  3 vs 4:   0.012       1  16.015   0.914   1.414</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-29" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-602-1.png" width="672" /></p>
</div>
</div>
<div id="still_smoking" class="section level3 tabset">
<h3>still_smoking</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = still_smoking)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-30" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-60" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-240" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.035     0.690     0.830    21.417     9.500     0.000    36.504     0.978 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.681    52.124     0.099     0.711     0.437 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.075   118.169     0.940     0.381     0.288 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.007   128.891     0.995     0.359     0.275 
## male                          0.206     0.022     0.163     0.250     9.342     9.334     0.000    54.369     0.985 
## sibling_count3                0.006     0.007    -0.008     0.021     0.897    41.516     0.375     0.871     0.490 
## sibling_count4                0.007     0.009    -0.010     0.024     0.791    30.871     0.435     1.174     0.567 
## sibling_count5                0.010     0.012    -0.014     0.034     0.822    18.880     0.421     2.230     0.719 
## sibling_count5+               0.014     0.011    -0.008     0.035     1.237    14.909     0.235     3.483     0.802 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-240" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-604-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-60" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-241" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.759     0.036     0.689     0.829    21.255     9.535     0.000    34.143     0.976 
## birth_order                   0.000     0.001    -0.002     0.002     0.362    73.691     0.719     0.537     0.366 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.680    52.034     0.099     0.712     0.437 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.054   119.755     0.957     0.378     0.286 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.013   128.935     0.989     0.359     0.275 
## male                          0.206     0.022     0.163     0.249     9.341     9.334     0.000    54.368     0.985 
## sibling_count3                0.006     0.007    -0.008     0.021     0.852    39.168     0.399     0.921     0.504 
## sibling_count4                0.007     0.009    -0.011     0.024     0.737    31.946     0.467     1.131     0.558 
## sibling_count5                0.009     0.013    -0.015     0.034     0.752    19.093     0.461     2.190     0.715 
## sibling_count5+               0.012     0.011    -0.010     0.035     1.059    18.078     0.304     2.396     0.734 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-241" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-606-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-60" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-242" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.036     0.690     0.831    21.150     9.642     0.000    28.510     0.971 
## birth_order_nonlinear2        0.001     0.005    -0.009     0.010     0.116   147.063     0.908     0.329     0.257 
## birth_order_nonlinear3       -0.004     0.006    -0.015     0.008    -0.647   151.988     0.519     0.322     0.253 
## birth_order_nonlinear4        0.000     0.008    -0.015     0.015     0.012    57.384     0.991     0.656     0.416 
## birth_order_nonlinear5       -0.002     0.010    -0.022     0.017    -0.222    37.870     0.825     0.951     0.513 
## birth_order_nonlinear5+       0.001     0.008    -0.015     0.016     0.077    65.362     0.939     0.590     0.389 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.644    42.616     0.108     0.850     0.483 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.005   104.048     0.996     0.417     0.307 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.061   124.061     0.951     0.369     0.281 
## male                          0.206     0.022     0.163     0.250     9.340     9.334     0.000    54.390     0.985 
## sibling_count3                0.008     0.008    -0.007     0.023     1.037    39.135     0.306     0.921     0.504 
## sibling_count4                0.008     0.009    -0.009     0.026     0.910    39.903     0.368     0.904     0.499 
## sibling_count5                0.012     0.012    -0.012     0.036     0.955    23.187     0.349     1.653     0.652 
## sibling_count5+               0.014     0.012    -0.009     0.037     1.232    19.539     0.233     2.112     0.707 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-242" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-608-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-60" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-243" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.756     0.035     0.687     0.826    21.309     9.844     0.000    21.819     0.963 
## count_birth_order2/2          0.006     0.007    -0.008     0.020     0.825    93.678     0.411     0.449     0.324 
## count_birth_order1/3          0.011     0.011    -0.009     0.032     1.076    40.929     0.288     0.883     0.493 
## count_birth_order2/3          0.011     0.010    -0.008     0.030     1.092    65.951     0.279     0.586     0.388 
## count_birth_order3/3          0.007     0.009    -0.010     0.024     0.788   149.502     0.432     0.325     0.255 
## count_birth_order1/4          0.010     0.013    -0.015     0.035     0.810    50.138     0.422     0.735     0.445 
## count_birth_order2/4          0.009     0.012    -0.015     0.033     0.762    71.161     0.449     0.552     0.373 
## count_birth_order3/4          0.009     0.015    -0.022     0.039     0.560    22.778     0.581     1.692     0.657 
## count_birth_order4/4          0.011     0.012    -0.012     0.034     0.967    55.627     0.338     0.673     0.423 
## count_birth_order1/5          0.021     0.017    -0.012     0.054     1.249    38.267     0.219     0.942     0.510 
## count_birth_order2/5          0.006     0.018    -0.028     0.041     0.361    34.654     0.720     1.039     0.536 
## count_birth_order3/5          0.007     0.021    -0.034     0.047     0.320    19.612     0.752     2.100     0.706 
## count_birth_order4/5          0.013     0.019    -0.024     0.050     0.693    22.824     0.495     1.688     0.657 
## count_birth_order5/5          0.017     0.014    -0.011     0.044     1.182    51.381     0.243     0.720     0.440 
## count_birth_order1/5+         0.020     0.014    -0.008     0.048     1.401    29.152     0.172     1.250     0.583 
## count_birth_order2/5+         0.015     0.015    -0.013     0.044     1.057    27.771     0.300     1.322     0.597 
## count_birth_order3/5+         0.015     0.013    -0.010     0.039     1.142    40.278     0.260     0.896     0.497 
## count_birth_order4/5+         0.017     0.018    -0.018     0.052     0.968    16.262     0.347     2.905     0.771 
## count_birth_order5/5+         0.012     0.018    -0.024     0.048     0.654    15.207     0.523     3.335     0.795 
## count_birth_order5+/5+        0.017     0.012    -0.006     0.041     1.430    17.520     0.170     2.530     0.744 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.420    48.320     0.162     0.759     0.454 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.181    81.229     0.857     0.499     0.349 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.099    94.840     0.921     0.445     0.322 
## male                          0.206     0.022     0.163     0.249     9.351     9.335     0.000    54.244     0.985 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-243" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-610-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-60" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.032      10 208.503   1.000   1.804 
##  2 vs 3:  -0.306       4  64.328   1.000   2.532 
##  3 vs 4:   0.127       1  33.850   0.723   0.539</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-30" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-61" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-244" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.763     0.036     0.693     0.833    21.301     9.471     0.000    38.732     0.979 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.514    35.737     0.139     1.007     0.528 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.231    49.596     0.818     0.742     0.448 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.115    35.108     0.909     1.026     0.532 
## male                          0.206     0.021     0.164     0.248     9.648     9.371     0.000    48.978     0.983 
## sibling_count3                0.001     0.007    -0.011     0.014     0.228    35.452     0.821     1.016     0.530 
## sibling_count4                0.004     0.011    -0.018     0.026     0.337    15.985     0.741     3.005     0.777 
## sibling_count5                0.007     0.012    -0.017     0.032     0.575    17.707     0.572     2.483     0.741 
## sibling_count5+               0.013     0.012    -0.011     0.037     1.073    15.043     0.300     3.415     0.799 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-244" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-613-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-61" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-245" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.765     0.036     0.693     0.836    21.032     9.539     0.000    33.897     0.976 
## birth_order                  -0.001     0.002    -0.004     0.002    -0.460    44.383     0.648     0.819     0.474 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.519    35.547     0.138     1.013     0.529 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.259    50.165     0.797     0.735     0.445 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.146    35.310     0.885     1.020     0.531 
## male                          0.206     0.021     0.164     0.248     9.649     9.371     0.000    48.965     0.983 
## sibling_count3                0.002     0.007    -0.011     0.015     0.292    35.334     0.772     1.019     0.531 
## sibling_count4                0.005     0.011    -0.017     0.026     0.419    16.827     0.680     2.722     0.758 
## sibling_count5                0.009     0.012    -0.015     0.032     0.702    20.312     0.491     1.991     0.694 
## sibling_count5+               0.015     0.012    -0.008     0.039     1.285    20.309     0.213     1.991     0.694 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-245" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-615-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-61" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-246" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.764     0.036     0.693     0.835    21.096     9.608     0.000    30.082     0.973 
## birth_order_nonlinear2        0.000     0.005    -0.010     0.010     0.035    43.148     0.972     0.841     0.480 
## birth_order_nonlinear3       -0.002     0.007    -0.015     0.012    -0.229    34.824     0.821     1.034     0.534 
## birth_order_nonlinear4       -0.006     0.009    -0.023     0.012    -0.612    35.487     0.544     1.015     0.529 
## birth_order_nonlinear5       -0.001     0.010    -0.021     0.019    -0.101    72.732     0.920     0.543     0.369 
## birth_order_nonlinear5+      -0.003     0.010    -0.023     0.017    -0.280    61.132     0.780     0.623     0.403 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.462    31.889     0.154     1.133     0.558 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.236    46.604     0.814     0.784     0.462 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.151    34.568     0.881     1.042     0.536 
## male                          0.206     0.021     0.164     0.248     9.612     9.378     0.000    48.133     0.983 
## sibling_count3                0.002     0.006    -0.010     0.015     0.360    54.559     0.720     0.684     0.427 
## sibling_count4                0.006     0.011    -0.016     0.027     0.532    18.627     0.601     2.280     0.723 
## sibling_count5                0.009     0.012    -0.015     0.033     0.744    22.113     0.465     1.762     0.667 
## sibling_count5+               0.015     0.012    -0.009     0.040     1.241    20.550     0.229     1.957     0.691 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-246" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-617-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-61" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-247" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.762     0.036     0.691     0.832    21.121     9.762     0.000    24.123     0.966 
## count_birth_order2/2          0.003     0.007    -0.012     0.018     0.390    45.413     0.699     0.802     0.468 
## count_birth_order1/3          0.004     0.009    -0.013     0.021     0.417    82.569     0.677     0.493     0.346 
## count_birth_order2/3          0.004     0.009    -0.013     0.022     0.451    46.944     0.654     0.779     0.460 
## count_birth_order3/3          0.003     0.013    -0.022     0.028     0.232    18.391     0.819     2.328     0.728 
## count_birth_order1/4          0.016     0.014    -0.011     0.042     1.134    36.082     0.264     0.998     0.525 
## count_birth_order2/4          0.007     0.014    -0.020     0.034     0.475    25.678     0.639     1.451     0.620 
## count_birth_order3/4          0.002     0.018    -0.034     0.038     0.112    15.487     0.912     3.207     0.788 
## count_birth_order4/4          0.001     0.014    -0.026     0.028     0.077    28.386     0.939     1.289     0.591 
## count_birth_order1/5          0.010     0.020    -0.029     0.049     0.511    27.893     0.613     1.315     0.596 
## count_birth_order2/5          0.015     0.018    -0.021     0.051     0.796    27.916     0.433     1.314     0.596 
## count_birth_order3/5          0.010     0.020    -0.030     0.049     0.486    20.204     0.632     2.007     0.696 
## count_birth_order4/5          0.008     0.017    -0.025     0.040     0.452    32.843     0.654     1.099     0.550 
## count_birth_order5/5          0.007     0.022    -0.036     0.050     0.337    18.849     0.740     2.236     0.719 
## count_birth_order1/5+         0.023     0.021    -0.019     0.064     1.064    20.055     0.300     2.029     0.699 
## count_birth_order2/5+         0.014     0.017    -0.020     0.048     0.799    25.356     0.432     1.474     0.624 
## count_birth_order3/5+         0.017     0.019    -0.020     0.054     0.893    19.181     0.383     2.174     0.713 
## count_birth_order4/5+         0.010     0.019    -0.027     0.047     0.515    18.704     0.612     2.264     0.722 
## count_birth_order5/5+         0.017     0.016    -0.014     0.048     1.086    26.656     0.287     1.387     0.609 
## count_birth_order5+/5+        0.015     0.015    -0.014     0.043     1.022    18.043     0.320     2.404     0.734 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.479    50.738     0.145     0.728     0.443 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.373    72.057     0.710     0.547     0.371 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.289    44.500     0.774     0.817     0.473 
## male                          0.206     0.022     0.163     0.248     9.495     9.378     0.000    48.106     0.983 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-247" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-619-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-61" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  -0.714      10  91.063   1.000 158.724 
##  2 vs 3:  -0.698       4  36.141   1.000 428.146 
##  3 vs 4:   0.210       1  22.693   0.651   0.833</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-30" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-621-1.png" width="672" /></p>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCm91dHB1dDogaHRtbF9kb2N1bWVudAplZGl0b3Jfb3B0aW9uczogCiAgY2h1bmtfb3V0cHV0X3R5cGU6IGNvbnNvbGUKLS0tCiMgPHNwYW4gc3R5bGU9ImNvbG9yOiNBNkQ4NTQiPkJpcnRoIE9yZGVyIEVmZmVjdHM8L3NwYW4+IHsudGFic2V0fQoKIyMgSGVscGVyCmBgYHtyIGhlbHBlcn0Kc291cmNlKCIwX2hlbHBlcnMuUiIpCm9wdHNfY2h1bmskc2V0KHdhcm5pbmcgPSBGQUxTRSkKZGV0YWNoKCJwYWNrYWdlOmxtZXJUZXN0IiwgdW5sb2FkPVRSVUUpCmBgYAoKCiMjIEZ1bmN0aW9ucwoKYGBge3J9CgpuX2ltcHV0YXRpb25zLm1pdG1sID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkaXRlciRtCn0Kbl9pbXB1dGF0aW9ucy5taWRzID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkbQp9Cm5faW1wdXRhdGlvbnMuYW1lbGlhID0gZnVuY3Rpb24oaW1wcykgewogIGxlbmd0aChpbXBzJGltcHV0YXRpb25zKQp9Cm5faW1wdXRhdGlvbnMgPSBmdW5jdGlvbihpbXBzKSB7IFVzZU1ldGhvZCgibl9pbXB1dGF0aW9ucyIpIH0KCmNvbXBsZXRlLm1pdG1sID0gbWl0bWw6Om1pdG1sQ29tcGxldGUKY29tcGxldGUubWlkcyA9IG1pY2U6OmNvbXBsZXRlCmNvbXBsZXRlID0gZnVuY3Rpb24oLi4uKSB7IFVzZU1ldGhvZCgiY29tcGxldGUiKSB9CgpsaWJyYXJ5KG1pY2UpCmxpYnJhcnkobWljZWFkZHMpCmxpYnJhcnkobWl0bWwpCmBgYAoKCiMjIExvYWQgZGF0YQpgYGB7ciBMb2FkIERhdGF9CmJpcnRob3JkZXIgPSByZWFkUkRTKCJkYXRhL2FsbGRhdGFfYmlydGhvcmRlcl9pX21sLnJkcyIpCmBgYAoKIyMgRGF0YSBwcmVwYXJhdGlvbnMKYGBge3IgZGF0YSBwcmVwYXJhdGlvbnN9CmJpcnRob3JkZXIgPC0gbWlkczJtaXRtbC5saXN0KGJpcnRob3JkZXIpCgojIyBDYWxjdWxhdGUgZ19mYWN0b3JzIChmb3Igbm93IHdpdGggcm93TWVhbnM6IGJldHRlciB0byBydW4gZmFjdG9yIGFuYWx5c2lzIGhlcmUgYXMgd2VsbD8pCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDE1X29sZCA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDE1X29sZCwgbWF0aF8yMDE1X29sZCwgY291bnRfYmFja3dhcmRzLCAgd29yZHNfZGVsYXllZCwgYWRhcHRpdmVfbnVtYmVyaW5nKSkpCn0pCgpiaXJ0aG9yZGVyIDwtIHdpdGhpbihiaXJ0aG9yZGVyLCB7CiAgZ19mYWN0b3JfMjAxNV95b3VuZyA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDE1X3lvdW5nLCBtYXRoXzIwMTVfeW91bmcpKSkKfSkKCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDA3X29sZCA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDA3X29sZCwgbWF0aF8yMDA3X29sZCkpKQp9KQoKYmlydGhvcmRlciA8LSB3aXRoaW4oYmlydGhvcmRlciwgewogIGdfZmFjdG9yXzIwMDdfeW91bmcgPC0gcm93TWVhbnMoc2NhbGUoY2JpbmQocmF2ZW5fMjAwN195b3VuZywgbWF0aF8yMDA3X3lvdW5nKSkpCn0pCgoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lIHRibF9kZi5taXRtbC5saXN0CgojIyMgQmlydGhvcmRlciBhbmQgU2libGluZyBDb3VudAojIGZvciBmYWN0b3IgdmFyaWFibGVzIHdlIGhhdmUgdG8gcm91bmQgYmlydGggb3JkZXIgcG9zaXRpb24gYW5kIGVsaW1pbmF0ZSBhbGwgdW5saWtlbHkgbnVtYmVycyAobmVnYXRpdmUgb25lcykKYmlydGhvcmRlcl9kYXRhID0gYmlydGhvcmRlcltbMV1dCgpiaXJ0aG9yZGVyID0gYmlydGhvcmRlciAlPiUKICBtdXRhdGUoYmlydGhvcmRlcl9nZW5lcyA9IGlmZWxzZShiaXJ0aG9yZGVyX2dlbmVzIDwgMCwgMCwgYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSBpZmVsc2UoYmlydGhvcmRlcl9uYWl2ZSA8IDAsIDAsIGJpcnRob3JkZXJfbmFpdmUpLAogICAgICAgICBiaXJ0aG9yZGVyX2dlbmVzID0gcm91bmQoYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSByb3VuZChiaXJ0aG9yZGVyX25haXZlKSwKICAgICAgICAgc2libGluZ19jb3VudF9nZW5lcyA9IGlmZWxzZShzaWJsaW5nX2NvdW50X2dlbmVzIDwgMCwgMCwgc2libGluZ19jb3VudF9nZW5lcyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmUgPSBpZmVsc2Uoc2libGluZ19jb3VudF9uYWl2ZSA8IDAsIDAsIHNpYmxpbmdfY291bnRfbmFpdmUpLAogICAgICAgICBzaWJsaW5nX2NvdW50X2dlbmVzID0gcm91bmQoc2libGluZ19jb3VudF9nZW5lcyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmUgPSByb3VuZChzaWJsaW5nX2NvdW50X25haXZlKQogICAgICAgICApCgoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lIAogIG11dGF0ZSgKIyBiaXJ0aG9yZGVyIGFzIGZhY3RvcnMgd2l0aCBsZXZlbHMgb2YgMSwgMiwgMywgNCwgNSwgNSsKICAgIGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yID0gYXMuY2hhcmFjdGVyKGJpcnRob3JkZXJfbmFpdmUpLAogICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IgPSBpZmVsc2UoYmlydGhvcmRlcl9uYWl2ZSA+IDUsICI1KyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IpLAogICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IgPSBmYWN0b3IoYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjEiLCIyIiwiMyIsIjQiLCI1IiwiNSsiKSksCiAgICBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihzaWJsaW5nX2NvdW50X25haXZlKSwKICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yID0gaWZlbHNlKHNpYmxpbmdfY291bnRfbmFpdmUgPiA1LCAiNSsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yKSwKICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yID0gZmFjdG9yKHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIyIiwiMyIsIjQiLCI1IiwiNSsiKSksCiAgICBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihiaXJ0aG9yZGVyX2dlbmVzKSwKICAgIGJpcnRob3JkZXJfZ2VuZXNfZmFjdG9yID0gaWZlbHNlKGJpcnRob3JkZXJfZ2VuZXMgPjUgLCAiNSsiLCBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciksCiAgICBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciA9IGZhY3RvcihiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIxIiwiMiIsIjMiLCI0IiwiNSIsIjUrIikpLAogICAgc2libGluZ19jb3VudF9nZW5lc19mYWN0b3IgPSBhcy5jaGFyYWN0ZXIoc2libGluZ19jb3VudF9nZW5lcyksCiAgICBzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciA9IGlmZWxzZShzaWJsaW5nX2NvdW50X2dlbmVzID41ICwgIjUrIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yKSwKICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yID0gZmFjdG9yKHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjIiLCIzIiwiNCIsIjUiLCI1KyIpKSwKICAgICMgaW50ZXJhY3Rpb24gYmlydGhvcmRlciAqIHNpYmxpbmdjb3V0IGZvciBlYWNoIGJpcnRob3JkZXIKICAgIGNvdW50X2JpcnRob3JkZXJfbmFpdmUgPQogICAgICBmYWN0b3Ioc3RyX3JlcGxhY2UoYXMuY2hhcmFjdGVyKGludGVyYWN0aW9uKGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IpKSwKICAgICAgICAgICAgICAgICAgICAgICAgIlxcLiIsICIvIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSAgIGMoIjEvMiIsIjIvMiIsICIxLzMiLCAgIjIvMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjMvMyIsICIxLzQiLCAiMi80IiwgIjMvNCIsICI0LzQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIxLzUiLCAiMi81IiwgIjMvNSIsICI0LzUiLCAiNS81IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81KyIsICIyLzUrIiwgIjMvNSsiLCAiNC81KyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjUvNSsiLCAiNSsvNSsiKSksCiAgICBjb3VudF9iaXJ0aG9yZGVyX2dlbmVzID0KICAgICAgZmFjdG9yKHN0cl9yZXBsYWNlKGFzLmNoYXJhY3RlcihpbnRlcmFjdGlvbihiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yKSksICJcXC4iLCAiLyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gICBjKCIxLzIiLCIyLzIiLCAiMS8zIiwgICIyLzMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIzLzMiLCAiMS80IiwgIjIvNCIsICIzLzQiLCAiNC80IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81IiwgIjIvNSIsICIzLzUiLCAiNC81IiwgIjUvNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjEvNSsiLCAiMi81KyIsICIzLzUrIiwgIjQvNSsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI1LzUrIiwgIjUrLzUrIikpKQoKCgojIyMgVmFyaWFibGVzCmJpcnRob3JkZXIgPSBiaXJ0aG9yZGVyICU+JQogIG11dGF0ZSgKICAgIGdfZmFjdG9yXzIwMTVfb2xkID0gKGdfZmFjdG9yXzIwMTVfb2xkIC0gbWVhbihnX2ZhY3Rvcl8yMDE1X29sZCwgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAxNV9vbGQsIG5hLnJtPVQpLAogICAgZ19mYWN0b3JfMjAxNV95b3VuZyA9IChnX2ZhY3Rvcl8yMDE1X3lvdW5nIC0gbWVhbihnX2ZhY3Rvcl8yMDE1X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChnX2ZhY3Rvcl8yMDE1X3lvdW5nLCBuYS5ybT1UKSwKICAgIGdfZmFjdG9yXzIwMDdfb2xkID0gKGdfZmFjdG9yXzIwMDdfb2xkIC0gbWVhbihnX2ZhY3Rvcl8yMDA3X29sZCwgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAwN19vbGQsIG5hLnJtPVQpLApnX2ZhY3Rvcl8yMDA3X3lvdW5nID0gKGdfZmFjdG9yXzIwMDdfeW91bmcgLSBtZWFuKGdfZmFjdG9yXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvIHNkKGdfZmFjdG9yXzIwMDdfeW91bmcsIG5hLnJtPVQpLAogICAgcmF2ZW5fMjAxNV9vbGQgPSAocmF2ZW5fMjAxNV9vbGQgLSBtZWFuKHJhdmVuXzIwMTVfb2xkLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDE1X29sZCksCiAgICBtYXRoXzIwMTVfb2xkID0gKG1hdGhfMjAxNV9vbGQgLSBtZWFuKG1hdGhfMjAxNV9vbGQsIG5hLnJtPVQpKSAvIHNkKG1hdGhfMjAxNV9vbGQsIG5hLnJtPVQpLAogICAgcmF2ZW5fMjAxNV95b3VuZyA9IChyYXZlbl8yMDE1X3lvdW5nIC0gbWVhbihyYXZlbl8yMDE1X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDE1X3lvdW5nKSwKICAgIG1hdGhfMjAxNV95b3VuZyA9IChtYXRoXzIwMTVfeW91bmcgLSBtZWFuKG1hdGhfMjAxNV95b3VuZywgbmEucm09VCkpIC8KICAgICAgc2QobWF0aF8yMDE1X3lvdW5nLCBuYS5ybT1UKSwKICAgIHJhdmVuXzIwMDdfb2xkID0gKHJhdmVuXzIwMDdfb2xkIC0gbWVhbihyYXZlbl8yMDA3X29sZCwgbmEucm09VCkpIC8gc2QocmF2ZW5fMjAwN19vbGQpLAptYXRoXzIwMDdfb2xkID0gKG1hdGhfMjAwN19vbGQgLSBtZWFuKG1hdGhfMjAwN19vbGQsIG5hLnJtPVQpKSAvIHNkKG1hdGhfMjAwN19vbGQsIG5hLnJtPVQpLApyYXZlbl8yMDA3X3lvdW5nID0gKHJhdmVuXzIwMDdfeW91bmcgLSBtZWFuKHJhdmVuXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvIHNkKHJhdmVuXzIwMDdfeW91bmcpLAptYXRoXzIwMDdfeW91bmcgPSAobWF0aF8yMDA3X3lvdW5nIC0gbWVhbihtYXRoXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvCiAgc2QobWF0aF8yMDA3X3lvdW5nLCBuYS5ybT1UKSwKICAgIGNvdW50X2JhY2t3YXJkcyA9IChjb3VudF9iYWNrd2FyZHMgLSBtZWFuKGNvdW50X2JhY2t3YXJkcywgbmEucm09VCkpIC8KICAgICAgc2QoY291bnRfYmFja3dhcmRzLCBuYS5ybT1UKSwKICAgIHdvcmRzX2RlbGF5ZWQgPSAod29yZHNfZGVsYXllZCAtIG1lYW4od29yZHNfZGVsYXllZCwgbmEucm09VCkpIC8KICAgICAgc2Qod29yZHNfZGVsYXllZCwgbmEucm09VCksCiAgICBhZGFwdGl2ZV9udW1iZXJpbmcgPSAoYWRhcHRpdmVfbnVtYmVyaW5nIC0gbWVhbihhZGFwdGl2ZV9udW1iZXJpbmcsIG5hLnJtPVQpKSAvCiAgICAgIHNkKGFkYXB0aXZlX251bWJlcmluZywgbmEucm09VCksCiAgICBiaWc1X2V4dCA9IChiaWc1X2V4dCAtIG1lYW4oYmlnNV9leHQsIG5hLnJtPVQpKSAvIHNkKGJpZzVfZXh0LCBuYS5ybT1UKSwKICAgIGJpZzVfY29uID0gKGJpZzVfY29uIC0gbWVhbihiaWc1X2NvbiwgbmEucm09VCkpIC8gc2QoYmlnNV9jb24sIG5hLnJtPVQpLAogICAgYmlnNV9hZ3JlZSA9IChiaWc1X2FncmVlIC0gbWVhbihiaWc1X2FncmVlLCBuYS5ybT1UKSkgLyBzZChiaWc1X2FncmVlLCBuYS5ybT1UKSwKICAgIGJpZzVfb3BlbiA9IChiaWc1X29wZW4gLSBtZWFuKGJpZzVfb3BlbiwgbmEucm09VCkpIC8gc2QoYmlnNV9vcGVuLCBuYS5ybT1UKSwKICAgIGJpZzVfbmV1ID0gKGJpZzVfbmV1IC0gbWVhbihiaWc1X25ldSwgbmEucm09VCkpIC8gc2QoYmlnNV9uZXUsIG5hLnJtPVQpLAogICAgcmlza0EgPSAocmlza0EgLSBtZWFuKHJpc2tBLCBuYS5ybT1UKSkgLyBzZChyaXNrQSwgbmEucm09VCksCiAgICByaXNrQiA9IChyaXNrQiAtIG1lYW4ocmlza0IsIG5hLnJtPVQpKSAvIHNkKHJpc2tCLCBuYS5ybT1UKSwKICAgIHllYXJzX29mX2VkdWNhdGlvbl96ID0gKHllYXJzX29mX2VkdWNhdGlvbiAtIG1lYW4oeWVhcnNfb2ZfZWR1Y2F0aW9uLCBuYS5ybT1UKSkgLwogICAgICBzZCh5ZWFyc19vZl9lZHVjYXRpb24sIG5hLnJtPVQpLAogICAgd2FnZV9sYXN0X21vbnRoX3ogPSAod2FnZV9sYXN0X21vbnRoX2xvZyAtIG1lYW4od2FnZV9sYXN0X21vbnRoX2xvZywgbmEucm09VCkpIC8KICAgICAgc2Qod2FnZV9sYXN0X21vbnRoX2xvZywgbmEucm09VCksCiAgICB3YWdlX2xhc3RfeWVhcl96ID0gKHdhZ2VfbGFzdF95ZWFyX2xvZyAtIG1lYW4od2FnZV9sYXN0X3llYXJfbG9nLCBuYS5ybT1UKSkgLwogICAgICBzZCh3YWdlX2xhc3RfeWVhcl9sb2csIG5hLnJtPVQpLAogICAgYXR0ZW5kZWRfc2Nob29sID0gYXMuaW50ZWdlcihhdHRlbmRlZF9zY2hvb2wpLAogICAgYXR0ZW5kZWRfc2Nob29sID0gaWZlbHNlKGF0dGVuZGVkX3NjaG9vbCA9PSAxLCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoYXR0ZW5kZWRfc2Nob29sID09IDIsIDEsIE5BKSkpCiAgICAgICAgCmRhdGFfdXNlZCA8LSBiaXJ0aG9yZGVyICU+JQogIG11dGF0ZShzaWJsaW5nX2NvdW50ID0gc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IsCiAgICAgICAgIGJpcnRoX29yZGVyX25vbmxpbmVhciA9IGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yLAogICAgICAgICBiaXJ0aF9vcmRlciA9IGJpcnRob3JkZXJfbmFpdmUsCiAgICAgICAgIGNvdW50X2JpcnRoX29yZGVyID0gY291bnRfYmlydGhvcmRlcl9uYWl2ZSkKCmBgYAoKIyMgSW50ZWxsaWdlbmNlIHsuYWN0aXZlIC50YWJzZXR9CiMjIyBnLWZhY3RvciAyMDE1IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBnX2ZhY3Rvcl8yMDE1X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgoKIyMjIFJhdmVuIDIwMTUgb2xkIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJhdmVuXzIwMTVfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIE51bWVyYWN5IDIwMTUgb2xkIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IG1hdGhfMjAxNV9vbGQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgQ291bnRpbmcgQmFja3dhcmRzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGNvdW50X2JhY2t3YXJkcykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBEZWxheWVkIFdvcmQgUmVjYWxsIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHdvcmRzX2RlbGF5ZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIEFkYXB0aXZlIE51bWJlcmluZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBhZGFwdGl2ZV9udW1iZXJpbmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQpgYGAKCiMjIyBnLWZhY3RvciAyMDE1IHlvdW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGdfZmFjdG9yXzIwMTVfeW91bmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIFJhdmVuIDIwMTUgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gcmF2ZW5fMjAxNV95b3VuZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBOdW1lcmFjeSAyMDE1IHlvdW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IG1hdGhfMjAxNV95b3VuZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBnLWZhY3RvciAyMDA3IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBnX2ZhY3Rvcl8yMDA3X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgUmF2ZW4gMjAwNyBvbGQgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gcmF2ZW5fMjAwN19vbGQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgTnVtZXJhY3kgMjAwNyBvbGQgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gbWF0aF8yMDA3X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBnLWZhY3RvciAyMDA3IHlvdW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGdfZmFjdG9yXzIwMDdfeW91bmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIFJhdmVuIDIwMDcgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gcmF2ZW5fMjAwN195b3VuZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBOdW1lcmFjeSAyMDA3IHlvdW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IG1hdGhfMjAwN195b3VuZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIFBlcnNvbmFsaXR5IHsudGFic2V0fQoKIyMjIEV4dHJhdmVyc2lvbiB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBiaWc1X2V4dCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgTmV1cm90aWNpc20gey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9uZXUpCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBDb25zY2llbnRpb3VzbmVzcyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBiaWc1X25ldSkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgQWdyZWVhYmxlbmVzcyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBiaWc1X2FncmVlKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBPcGVubmVzcyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBiaWc1X29wZW4pCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyBSaXNrcHJlZmVyZW5jZSB7LnRhYnNldH0KIyMjIFJpc2sgQSB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByaXNrQSkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBSaXNrIEIgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gcmlza0IpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyBFZHVjYXRpb25hbCBBdHRhaW5tZW50IHsudGFic2V0fQojIyMgWWVhcnMgb2YgRWR1Y2F0aW9uIC0gei1zdGFuZGFyZGl6ZWR7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSB5ZWFyc19vZl9lZHVjYXRpb25feikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBlbGVtZW50YXJ5X21pc3NlZAoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IEVsZW1lbnRhcnlfbWlzc2VkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBlbGVtZW50YXJ5X3dvcmtlZAoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IEVsZW1lbnRhcnlfd29ya2VkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIGF0dGVuZGVkX3NjaG9vbAoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGF0dGVuZGVkX3NjaG9vbCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgoKIyMgV29yayB7LnRhYnNldH0KCiMjIyBJbmNvbWUgTGFzdCBNb250aCAobG9nKSAtIHotc3RhbmRhcmRpemVkIHsudGFic2V0fQoKYGBge3J9CmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSB3YWdlX2xhc3RfbW9udGhfeikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBJbmNvbWUgbGFzdCB5ZWFyIChsb2cpIC0gei1zdGFuZGFyZGl6ZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHdhZ2VfbGFzdF95ZWFyX3opCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQpgYGAKCiMjIyBTZWxmLUVtcGxveW1lbnQgLSBub24gc3RhbmRhcmRpemVkIHsudGFic2V0fQoKYGBge3J9CmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBTZWxmX2VtcGxveWVkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgojIyBTbW9raW5nIEJlaGF2aW91ciB7LnRhYnNldH0KIyMjIGV2ZXJfc21va2VkIHsudGFic2V0fQoKYGBge3J9CmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBldmVyX3Ntb2tlZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoKIyMjIHN0aWxsX3Ntb2tpbmcgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHN0aWxsX3Ntb2tpbmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQpgYGAKCg==</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
