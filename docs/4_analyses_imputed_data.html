<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Laura Botzet &amp; Ruben Arslan" />


<title>4_analyses_imputed_data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">



<head>
<style>
.dropdown-menu li:hover .sub-menu {
  visibility: visible;
}

.dropdown:hover .dropdown-menu {
  display: block;
}
</style>
</head>


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
<div class="navbar-header">
  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
  </button>
  <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
</div>
<div id="navbar" class="navbar-collapse collapse">
  <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>

<li class="dropdown" style="background-color: #E5C494">
        <a class="dropdown-toggle" aria-expanded="false">
          Birth Order Effects <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" style="background-color: #E5C494">
          <li class=""><a href="4_analyses.html" aria-expanded="false" aria-controls="first-tab"> Main Analyses</a></li>
          <li class=""><a href="4_analyses_robust.html" aria-expanded="false" aria-controls="first-tab"> Robustness Analyses</a></li>
        </ul>
     </li>


<li class="dropdown" style="background-color: #FFD92F">
        <a class="dropdown-toggle" aria-expanded="false">
          Birth Order Effects Imputed Data <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" style="background-color: #FFD92F">
          <li class=""><a href="3_imputation.html" aria-expanded="false" aria-controls="first-tab">Multiple Imputation</a></li>
          <li class=""><a href="3_imputation_check.html" aria-expanded="false" aria-controls="first-tab">Imputation Checks</a></li>
          <li class=""><a href="4_analyses_imputed_data.html" aria-expanded="false" aria-controls="second-tab">Birth Order Effects Imputed Data</a></li>
        </ul>
     </li>


  </ul>
  <ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
<span class="fa fa-github"></span>


  </a>
</li>
  </ul>
</div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">4_analyses_imputed_data</h1>
<h4 class="author">Laura Botzet &amp; Ruben Arslan</h4>

</div>


<div id="birth-order-effects-imputed-data" class="section level1 tabset">
<h1><span style="color:#FFD92F">Birth Order Effects Imputed Data</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## Loading required package: usethis</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.6-5</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Matrix&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;codebook&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     bfi</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     aggregate_and_document_scale, asis_knit_child, expired, paste.knit_asis, rescue_attributes,
##     reverse_labelled_values</code></pre>
<pre><code>## 
## Attaching package: &#39;effsize&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cohen.d</code></pre>
<pre class="r"><code>opts_chunk$set(warning = FALSE,error=T)
detach(&quot;package:lmerTest&quot;, unload=TRUE)</code></pre>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<pre class="r"><code>options(mc.cores=4)
n_imputations.mitml = function(imps) {
  imps$iter$m
}
n_imputations.mids = function(imps) {
  imps$m
}
n_imputations.amelia = function(imps) {
  length(imps$imputations)
}
n_imputations = function(imps) { UseMethod(&quot;n_imputations&quot;) }

complete.mitml = mitml::mitmlComplete
complete.mids = mice::complete
complete = function(...) { UseMethod(&quot;complete&quot;) }

library(mice)</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     complete</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     complete</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     cbind, rbind</code></pre>
<pre class="r"><code>library(miceadds)</code></pre>
<pre><code>## * miceadds 3.7-6 (2019-12-15 13:38:43)</code></pre>
<pre class="r"><code>library(mitml)</code></pre>
<pre><code>## *** This is beta software. Please report any bugs!
## *** See the NEWS file for recent changes.</code></pre>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code>birthorder = readRDS(&quot;data/alldata_birthorder_i_ml.rds&quot;)</code></pre>
</div>
<div id="data-preparations" class="section level2">
<h2>Data preparations</h2>
<pre class="r"><code>birthorder &lt;- mids2mitml.list(birthorder)

## Calculate g_factors (for now with rowMeans: better to run factor analysis here as well?)
birthorder &lt;- within(birthorder, {
  g_factor_2015_old &lt;- rowMeans(scale(cbind(raven_2015_old, math_2015_old, count_backwards,  words_delayed, adaptive_numbering)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2015_young &lt;- rowMeans(scale(cbind(raven_2015_young, math_2015_young)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_old &lt;- rowMeans(scale(cbind(raven_2007_old, math_2007_old)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_young &lt;- rowMeans(scale(cbind(raven_2007_young, math_2007_young)))
})


birthorder = birthorder %&gt;% tbl_df.mitml.list

### Birthorder and Sibling Count
# for factor variables we have to round birth order position and eliminate all unlikely numbers (negative ones)
birthorder_data = birthorder[[1]]

birthorder = birthorder %&gt;%
  mutate(birthorder_genes = ifelse(birthorder_genes &lt; 0, 0, birthorder_genes),
         birthorder_naive = ifelse(birthorder_naive &lt; 0, 0, birthorder_naive),
         birthorder_genes = round(birthorder_genes),
         birthorder_naive = round(birthorder_naive),
         sibling_count_genes = ifelse(sibling_count_genes &lt; 0, 0, sibling_count_genes),
         sibling_count_naive = ifelse(sibling_count_naive &lt; 0, 0, sibling_count_naive),
         sibling_count_genes = round(sibling_count_genes),
         sibling_count_naive = round(sibling_count_naive)
         )


birthorder = birthorder %&gt;% 
  mutate(
# birthorder as factors with levels of 1, 2, 3, 4, 5, 5+
    birthorder_naive_factor = as.character(birthorder_naive),
    birthorder_naive_factor = ifelse(birthorder_naive &gt; 5, &quot;5+&quot;,
                                            birthorder_naive_factor),
    birthorder_naive_factor = factor(birthorder_naive_factor, 
                                            levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    sibling_count_naive_factor = as.character(sibling_count_naive),
    sibling_count_naive_factor = ifelse(sibling_count_naive &gt; 5, &quot;5+&quot;,
                                               sibling_count_naive_factor),
    sibling_count_naive_factor = factor(sibling_count_naive_factor, 
                                               levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    birthorder_genes_factor = as.character(birthorder_genes),
    birthorder_genes_factor = ifelse(birthorder_genes &gt;5 , &quot;5+&quot;, birthorder_genes_factor),
    birthorder_genes_factor = factor(birthorder_genes_factor, 
                                     levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    sibling_count_genes_factor = as.character(sibling_count_genes),
    sibling_count_genes_factor = ifelse(sibling_count_genes &gt;5 , &quot;5+&quot;,
                                        sibling_count_genes_factor),
    sibling_count_genes_factor = factor(sibling_count_genes_factor, 
                                        levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;5+&quot;)),
    # interaction birthorder * siblingcout for each birthorder
    count_birthorder_naive =
      factor(str_replace(as.character(interaction(birthorder_naive_factor,                                                              sibling_count_naive_factor)),
                        &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;,
                                                        &quot;1/5+&quot;, &quot;2/5+&quot;, &quot;3/5+&quot;, &quot;4/5+&quot;,
                                                        &quot;5/5+&quot;, &quot;5+/5+&quot;)),
    count_birthorder_genes =
      factor(str_replace(as.character(interaction(birthorder_genes_factor,                                                              sibling_count_genes_factor)), &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;,
                                                        &quot;1/5+&quot;, &quot;2/5+&quot;, &quot;3/5+&quot;, &quot;4/5+&quot;,
                                                        &quot;5/5+&quot;, &quot;5+/5+&quot;)))



### Variables
birthorder = birthorder %&gt;%
  mutate(
    g_factor_2015_old = (g_factor_2015_old - mean(g_factor_2015_old, na.rm=T)) / sd(g_factor_2015_old, na.rm=T),
    g_factor_2015_young = (g_factor_2015_young - mean(g_factor_2015_young, na.rm=T)) / sd(g_factor_2015_young, na.rm=T),
    g_factor_2007_old = (g_factor_2007_old - mean(g_factor_2007_old, na.rm=T)) / sd(g_factor_2007_old, na.rm=T),
g_factor_2007_young = (g_factor_2007_young - mean(g_factor_2007_young, na.rm=T)) / sd(g_factor_2007_young, na.rm=T),
    raven_2015_old = (raven_2015_old - mean(raven_2015_old, na.rm=T)) / sd(raven_2015_old),
    math_2015_old = (math_2015_old - mean(math_2015_old, na.rm=T)) / sd(math_2015_old, na.rm=T),
    raven_2015_young = (raven_2015_young - mean(raven_2015_young, na.rm=T)) / sd(raven_2015_young),
    math_2015_young = (math_2015_young - mean(math_2015_young, na.rm=T)) /
      sd(math_2015_young, na.rm=T),
    raven_2007_old = (raven_2007_old - mean(raven_2007_old, na.rm=T)) / sd(raven_2007_old),
math_2007_old = (math_2007_old - mean(math_2007_old, na.rm=T)) / sd(math_2007_old, na.rm=T),
raven_2007_young = (raven_2007_young - mean(raven_2007_young, na.rm=T)) / sd(raven_2007_young),
math_2007_young = (math_2007_young - mean(math_2007_young, na.rm=T)) /
  sd(math_2007_young, na.rm=T),
    count_backwards = (count_backwards - mean(count_backwards, na.rm=T)) /
      sd(count_backwards, na.rm=T),
    words_delayed = (words_delayed - mean(words_delayed, na.rm=T)) /
      sd(words_delayed, na.rm=T),
    adaptive_numbering = (adaptive_numbering - mean(adaptive_numbering, na.rm=T)) /
      sd(adaptive_numbering, na.rm=T),
    big5_ext = (big5_ext - mean(big5_ext, na.rm=T)) / sd(big5_ext, na.rm=T),
    big5_con = (big5_con - mean(big5_con, na.rm=T)) / sd(big5_con, na.rm=T),
    big5_agree = (big5_agree - mean(big5_agree, na.rm=T)) / sd(big5_agree, na.rm=T),
    big5_open = (big5_open - mean(big5_open, na.rm=T)) / sd(big5_open, na.rm=T),
    big5_neu = (big5_neu - mean(big5_neu, na.rm=T)) / sd(big5_neu, na.rm=T),
    riskA = (riskA - mean(riskA, na.rm=T)) / sd(riskA, na.rm=T),
    riskB = (riskB - mean(riskB, na.rm=T)) / sd(riskB, na.rm=T),
    years_of_education_z = (years_of_education - mean(years_of_education, na.rm=T)) /
      sd(years_of_education, na.rm=T),
    wage_last_month_z = (wage_last_month_log - mean(wage_last_month_log, na.rm=T)) /
      sd(wage_last_month_log, na.rm=T),
    wage_last_year_z = (wage_last_year_log - mean(wage_last_year_log, na.rm=T)) /
      sd(wage_last_year_log, na.rm=T),
    attended_school = as.integer(attended_school),
    attended_school = ifelse(attended_school == 1, 0,
                           ifelse(attended_school == 2, 1, NA)))
        
data_used &lt;- birthorder %&gt;%
  mutate(sibling_count = sibling_count_naive_factor,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)</code></pre>
</div>
<div id="intelligence" class="section level2 active tabset">
<h2>Intelligence</h2>
<div id="g-factor-2015-old" class="section level3 tabset">
<h3>g-factor 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.098     0.125    -0.343     0.146    -0.788     9.440     0.450    41.440     0.980 
## poly(age, 3, raw = TRUE)1     0.047     0.016     0.016     0.078     2.949     9.476     0.015    38.283     0.979 
## poly(age, 3, raw = TRUE)2    -0.002     0.000    -0.003    -0.001    -3.745     9.871     0.004    21.155     0.962 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.532    10.346     0.029    13.858     0.943 
## male                          0.029     0.018    -0.006     0.065     1.613    19.318     0.123     2.150     0.711 
## sibling_count3                0.009     0.020    -0.030     0.047     0.435    89.534     0.664     0.464     0.332 
## sibling_count4               -0.023     0.026    -0.074     0.028    -0.892    40.576     0.378     0.890     0.495 
## sibling_count5               -0.055     0.031    -0.115     0.005    -1.804    46.310     0.078     0.788     0.464 
## sibling_count5+              -0.061     0.027    -0.113    -0.009    -2.294   100.824     0.024     0.426     0.312 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.224 
## Residual~~Residual                     0.693 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-1" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.086     0.122    -0.325     0.153    -0.708     9.560     0.496    32.625     0.975 
## birth_order                  -0.005     0.005    -0.015     0.004    -1.082    56.371     0.284     0.665     0.420 
## poly(age, 3, raw = TRUE)1     0.046     0.016     0.015     0.077     2.946     9.487     0.015    37.422     0.978 
## poly(age, 3, raw = TRUE)2    -0.002     0.000    -0.003    -0.001    -3.746     9.882     0.004    20.897     0.961 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.530    10.358     0.029    13.739     0.942 
## male                          0.029     0.018    -0.006     0.065     1.611    19.262     0.123     2.160     0.712 
## sibling_count3                0.011     0.020    -0.028     0.050     0.560    84.345     0.577     0.485     0.342 
## sibling_count4               -0.019     0.026    -0.069     0.032    -0.715    43.158     0.478     0.840     0.480 
## sibling_count5               -0.049     0.032    -0.112     0.015    -1.506    38.592     0.140     0.934     0.508 
## sibling_count5+              -0.049     0.028    -0.105     0.007    -1.724   105.426     0.088     0.413     0.305 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.224 
## Residual~~Residual                     0.693 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-1" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-2" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.067     0.122    -0.305     0.172    -0.548     9.651     0.596    28.142     0.971 
## birth_order_nonlinear2       -0.025     0.021    -0.067     0.017    -1.185    25.025     0.247     1.498     0.628 
## birth_order_nonlinear3       -0.046     0.028    -0.102     0.009    -1.634    19.453     0.118     2.127     0.709 
## birth_order_nonlinear4       -0.061     0.027    -0.114    -0.008    -2.242    37.787     0.031     0.953     0.513 
## birth_order_nonlinear5       -0.056     0.034    -0.122     0.010    -1.661    54.744     0.102     0.682     0.426 
## birth_order_nonlinear5+      -0.051     0.040    -0.130     0.027    -1.281    52.414     0.206     0.708     0.436 
## poly(age, 3, raw = TRUE)1     0.045     0.016     0.014     0.076     2.844     9.542     0.018    33.688     0.976 
## poly(age, 3, raw = TRUE)2    -0.002     0.000    -0.003    -0.001    -3.522     9.969     0.006    19.070     0.958 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.235    10.456     0.048    12.847     0.939 
## male                          0.027     0.017    -0.006     0.060     1.626    24.370     0.117     1.549     0.636 
## sibling_count3                0.020     0.022    -0.024     0.063     0.884    53.796     0.381     0.692     0.430 
## sibling_count4               -0.009     0.026    -0.060     0.042    -0.338    57.608     0.736     0.654     0.415 
## sibling_count5               -0.038     0.037    -0.109     0.034    -1.025    29.379     0.314     1.240     0.581 
## sibling_count5+              -0.040     0.029    -0.096     0.016    -1.411   157.399     0.160     0.314     0.249 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.221 
## Residual~~Residual                     0.692 
## ICC|mother_pidlink                     0.242 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-2" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-3" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.064     0.125    -0.310     0.182    -0.513     9.792     0.619    23.211     0.965 
## count_birth_order2/2         -0.034     0.026    -0.084     0.016    -1.331    60.470     0.188     0.628     0.405 
## count_birth_order1/3         -0.014     0.032    -0.077     0.049    -0.428    78.631     0.670     0.511     0.355 
## count_birth_order2/3         -0.016     0.033    -0.080     0.049    -0.473    48.774     0.638     0.753     0.452 
## count_birth_order3/3         -0.031     0.034    -0.098     0.036    -0.910    40.123     0.368     0.900     0.498 
## count_birth_order1/4         -0.075     0.041    -0.155     0.005    -1.843    69.841     0.070     0.560     0.377 
## count_birth_order2/4         -0.060     0.040    -0.139     0.018    -1.506    53.811     0.138     0.692     0.430 
## count_birth_order3/4         -0.078     0.050    -0.175     0.020    -1.557    23.380     0.133     1.635     0.649 
## count_birth_order4/4         -0.052     0.050    -0.151     0.047    -1.035    24.062     0.311     1.575     0.640 
## count_birth_order1/5         -0.063     0.058    -0.177     0.051    -1.090    39.408     0.282     0.915     0.503 
## count_birth_order2/5         -0.117     0.059    -0.233    -0.000    -1.963    29.395     0.059     1.239     0.581 
## count_birth_order3/5         -0.099     0.053    -0.203     0.006    -1.854    43.476     0.071     0.835     0.478 
## count_birth_order4/5         -0.129     0.049    -0.225    -0.034    -2.658   116.342     0.009     0.385     0.290 
## count_birth_order5/5         -0.091     0.054    -0.197     0.016    -1.671    76.502     0.099     0.522     0.360 
## count_birth_order1/5+        -0.081     0.071    -0.221     0.058    -1.148    24.894     0.262     1.508     0.630 
## count_birth_order2/5+        -0.136     0.044    -0.222    -0.049    -3.072   311.501     0.002     0.205     0.175 
## count_birth_order3/5+        -0.106     0.045    -0.195    -0.017    -2.336   105.090     0.021     0.414     0.306 
## count_birth_order4/5+        -0.127     0.045    -0.214    -0.040    -2.848   183.841     0.005     0.284     0.230 
## count_birth_order5/5+        -0.109     0.052    -0.210    -0.008    -2.114    67.714     0.038     0.574     0.383 
## count_birth_order5+/5+       -0.106     0.043    -0.190    -0.023    -2.491    73.578     0.015     0.538     0.367 
## poly(age, 3, raw = TRUE)1     0.046     0.016     0.015     0.077     2.889     9.609     0.017    30.048     0.973 
## poly(age, 3, raw = TRUE)2    -0.002     0.000    -0.003    -0.001    -3.423    10.061     0.006    17.443     0.954 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.092    10.584     0.061    11.845     0.934 
## male                          0.024     0.016    -0.008     0.055     1.476    31.347     0.150     1.154     0.563 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.219 
## Residual~~Residual                     0.690 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-3" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.404       10   90.336    0.942  500.572 
##   2 vs 3:    0.388        4   36.053    0.815 1139.239 
##   3 vs 4:    1.241        1   30.237    0.274    0.603</code></pre>
</div>
</div>
</div>
<div id="g-factor-2015-young" class="section level3 tabset">
<h3>g-factor 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-1" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-1" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-4" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.330     0.048    -1.424    -1.237   -27.794     9.588     0.000    31.108     0.974 
## poly(age, 3, raw = TRUE)1     0.206     0.009     0.189     0.223    23.750     9.302     0.000    60.036     0.986 
## poly(age, 3, raw = TRUE)2    -0.009     0.000    -0.009    -0.008   -32.532     9.466     0.000    39.108     0.979 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000    63.746    10.338     0.000    13.938     0.943 
## male                         -0.006     0.008    -0.023     0.010    -0.732    17.239     0.474     2.604     0.750 
## sibling_count3                0.002     0.009    -0.016     0.019     0.202    68.769     0.840     0.567     0.380 
## sibling_count4               -0.013     0.011    -0.034     0.008    -1.179    57.859     0.243     0.651     0.414 
## sibling_count5               -0.025     0.012    -0.048    -0.001    -2.060   112.493     0.042     0.394     0.295 
## sibling_count5+              -0.028     0.013    -0.053    -0.003    -2.185    58.649     0.033     0.644     0.411 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.046 
## Residual~~Residual                     0.132 
## ICC|mother_pidlink                     0.259 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-4" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-1" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-5" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.323     0.047    -1.416    -1.230   -27.924     9.731     0.000    25.130     0.968 
## birth_order                  -0.003     0.002    -0.008     0.001    -1.454    39.798     0.154     0.907     0.500 
## poly(age, 3, raw = TRUE)1     0.205     0.009     0.189     0.222    23.804     9.307     0.000    59.040     0.986 
## poly(age, 3, raw = TRUE)2    -0.009     0.000    -0.009    -0.008   -32.610     9.470     0.000    38.773     0.979 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000    63.952    10.349     0.000    13.822     0.943 
## male                         -0.006     0.008    -0.023     0.010    -0.731    17.241     0.474     2.604     0.750 
## sibling_count3                0.003     0.009    -0.014     0.021     0.378    62.610     0.707     0.611     0.398 
## sibling_count4               -0.010     0.011    -0.031     0.011    -0.907    62.071     0.368     0.615     0.400 
## sibling_count5               -0.021     0.013    -0.045     0.004    -1.626    78.881     0.108     0.510     0.354 
## sibling_count5+              -0.020     0.014    -0.048     0.007    -1.437    49.417     0.157     0.744     0.449 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.046 
## Residual~~Residual                     0.132 
## ICC|mother_pidlink                     0.259 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-5" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-1" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-6" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.316     0.047    -1.407    -1.224   -28.219     9.874     0.000    21.094     0.962 
## birth_order_nonlinear2       -0.011     0.009    -0.029     0.007    -1.227    28.359     0.230     1.290     0.591 
## birth_order_nonlinear3       -0.020     0.011    -0.041     0.001    -1.842    27.356     0.076     1.345     0.602 
## birth_order_nonlinear4       -0.022     0.012    -0.046     0.002    -1.832    35.244     0.075     1.022     0.531 
## birth_order_nonlinear5       -0.029     0.015    -0.059     0.001    -1.892    44.548     0.065     0.816     0.473 
## birth_order_nonlinear5+      -0.029     0.017    -0.063     0.005    -1.644    54.398     0.106     0.686     0.427 
## poly(age, 3, raw = TRUE)1     0.205     0.009     0.188     0.222    23.713     9.342     0.000    53.196     0.985 
## poly(age, 3, raw = TRUE)2    -0.009     0.000    -0.009    -0.008   -32.395     9.528     0.000    34.612     0.976 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000    64.376    10.594     0.000    11.772     0.933 
## male                         -0.007     0.008    -0.023     0.009    -0.906    19.565     0.376     2.108     0.707 
## sibling_count3                0.006     0.008    -0.011     0.023     0.710   219.257     0.479     0.254     0.210 
## sibling_count4               -0.006     0.010    -0.027     0.014    -0.599   132.638     0.550     0.352     0.271 
## sibling_count5               -0.016     0.014    -0.043     0.010    -1.204    64.933     0.233     0.593     0.391 
## sibling_count5+              -0.018     0.013    -0.045     0.008    -1.365    86.596     0.176     0.476     0.338 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.046 
## Residual~~Residual                     0.131 
## ICC|mother_pidlink                     0.259 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-6" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-1" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-7" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.315     0.046    -1.406    -1.224   -28.311    10.152     0.000    16.106     0.950 
## count_birth_order2/2         -0.014     0.012    -0.036     0.009    -1.180    48.482     0.244     0.757     0.453 
## count_birth_order1/3         -0.006     0.013    -0.032     0.021    -0.418   135.515     0.676     0.347     0.268 
## count_birth_order2/3         -0.010     0.013    -0.035     0.015    -0.780   125.346     0.437     0.366     0.279 
## count_birth_order3/3         -0.015     0.014    -0.043     0.013    -1.031    51.070     0.308     0.724     0.441 
## count_birth_order1/4         -0.030     0.016    -0.062     0.002    -1.837   158.666     0.068     0.313     0.248 
## count_birth_order2/4         -0.030     0.017    -0.063     0.004    -1.741    62.680     0.087     0.610     0.398 
## count_birth_order3/4         -0.036     0.017    -0.069    -0.002    -2.098    65.869     0.040     0.586     0.388 
## count_birth_order4/4         -0.020     0.018    -0.056     0.015    -1.119    48.996     0.268     0.750     0.451 
## count_birth_order1/5         -0.023     0.024    -0.070     0.025    -0.933    49.170     0.356     0.748     0.450 
## count_birth_order2/5         -0.051     0.022    -0.095    -0.007    -2.288    58.154     0.026     0.649     0.413 
## count_birth_order3/5         -0.036     0.022    -0.080     0.007    -1.625    56.053     0.110     0.669     0.421 
## count_birth_order4/5         -0.052     0.020    -0.091    -0.014    -2.653   433.912     0.008     0.168     0.148 
## count_birth_order5/5         -0.051     0.024    -0.097    -0.004    -2.151    84.586     0.034     0.484     0.342 
## count_birth_order1/5+        -0.041     0.028    -0.096     0.014    -1.471    35.827     0.150     1.005     0.527 
## count_birth_order2/5+        -0.045     0.021    -0.087    -0.004    -2.128    91.054     0.036     0.459     0.329 
## count_birth_order3/5+        -0.046     0.021    -0.088    -0.005    -2.191    66.085     0.032     0.585     0.387 
## count_birth_order4/5+        -0.048     0.022    -0.092    -0.004    -2.154    55.447     0.036     0.675     0.423 
## count_birth_order5/5+        -0.054     0.021    -0.096    -0.012    -2.542   113.394     0.012     0.392     0.294 
## count_birth_order5+/5+       -0.054     0.018    -0.089    -0.018    -2.943    96.376     0.004     0.440     0.320 
## poly(age, 3, raw = TRUE)1     0.205     0.009     0.189     0.222    23.899     9.399     0.000    45.561     0.982 
## poly(age, 3, raw = TRUE)2    -0.009     0.000    -0.009    -0.008   -32.647     9.623     0.000    29.407     0.972 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000    64.291    10.902     0.000     9.939     0.922 
## male                         -0.008     0.008    -0.024     0.007    -1.072    22.694     0.295     1.701     0.659 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.046 
## Residual~~Residual                     0.131 
## ICC|mother_pidlink                     0.258 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-7" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-1" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.333       10   90.339    1.000  495.951 
##   2 vs 3:   -0.339        4   36.053    1.000 1130.429 
##   3 vs 4:    2.086        1   21.137    0.163    0.914</code></pre>
</div>
</div>
</div>
</div>
<div id="personality" class="section level2 tabset">
<h2>Personality</h2>
<div id="extraversion" class="section level3 tabset">
<h3>Extraversion</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_ext)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-2" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-2" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-8" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.013     0.110    -0.230     0.203    -0.122     9.585     0.906    31.273     0.974 
## poly(age, 3, raw = TRUE)1     0.018     0.013    -0.008     0.043     1.343     9.769     0.210    23.894     0.966 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.245    10.503     0.240    12.458     0.937 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.930    11.629     0.371     7.316     0.896 
## male                         -0.229     0.018    -0.264    -0.193   -12.608    22.655     0.000     1.705     0.659 
## sibling_count3               -0.003     0.023    -0.048     0.041    -0.147    31.426     0.884     1.151     0.562 
## sibling_count4               -0.009     0.033    -0.074     0.056    -0.279    17.688     0.783     2.488     0.741 
## sibling_count5               -0.012     0.027    -0.064     0.040    -0.467    69.778     0.642     0.560     0.377 
## sibling_count5+              -0.021     0.023    -0.067     0.025    -0.904   114.089     0.368     0.391     0.293 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.059 
## Residual~~Residual                     0.923 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-8" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-2" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-9" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.017     0.111    -0.235     0.200    -0.156     9.692     0.880    26.503     0.969 
## birth_order                   0.002     0.004    -0.006     0.010     0.426   502.747     0.671     0.154     0.137 
## poly(age, 3, raw = TRUE)1     0.018     0.013    -0.008     0.043     1.349     9.772     0.208    23.798     0.966 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.249    10.503     0.239    12.456     0.937 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.933    11.626     0.370     7.324     0.896 
## male                         -0.229     0.018    -0.264    -0.193   -12.603    22.629     0.000     1.707     0.659 
## sibling_count3               -0.004     0.023    -0.048     0.040    -0.185    33.091     0.854     1.090     0.548 
## sibling_count4               -0.011     0.033    -0.076     0.054    -0.324    18.222     0.750     2.365     0.731 
## sibling_count5               -0.014     0.026    -0.066     0.037    -0.551    90.392     0.583     0.461     0.330 
## sibling_count5+              -0.025     0.025    -0.074     0.023    -1.031   204.226     0.304     0.266     0.218 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.059 
## Residual~~Residual                     0.923 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-9" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-2" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-10" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.018     0.106    -0.226     0.190    -0.168     9.901     0.870    20.470     0.961 
## birth_order_nonlinear2        0.004     0.018    -0.031     0.039     0.234   111.838     0.815     0.396     0.296 
## birth_order_nonlinear3        0.002     0.022    -0.040     0.045     0.105    70.568     0.917     0.556     0.375 
## birth_order_nonlinear4        0.022     0.027    -0.030     0.075     0.835    61.383     0.407     0.621     0.402 
## birth_order_nonlinear5        0.030     0.037    -0.043     0.103     0.804    50.454     0.425     0.731     0.444 
## birth_order_nonlinear5+      -0.020     0.039    -0.096     0.057    -0.507   107.909     0.613     0.406     0.302 
## poly(age, 3, raw = TRUE)1     0.018     0.013    -0.007     0.043     1.409     9.893     0.190    20.655     0.961 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.304    10.754     0.219    10.741     0.927 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.976    12.060     0.348     6.347     0.882 
## male                         -0.232     0.019    -0.269    -0.194   -12.207    22.063     0.000     1.768     0.668 
## sibling_count3               -0.003     0.024    -0.050     0.045    -0.112    31.091     0.911     1.165     0.565 
## sibling_count4               -0.017     0.036    -0.089     0.054    -0.480    17.319     0.637     2.583     0.748 
## sibling_count5               -0.021     0.028    -0.075     0.033    -0.754    97.303     0.453     0.437     0.318 
## sibling_count5+              -0.024     0.027    -0.077     0.029    -0.895   116.202     0.373     0.386     0.290 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.059 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-10" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-2" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-11" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.009     0.103    -0.211     0.193    -0.089    10.279     0.931    14.551     0.945 
## count_birth_order2/2         -0.009     0.029    -0.066     0.049    -0.294    53.188     0.770     0.699     0.432 
## count_birth_order1/3         -0.027     0.033    -0.093     0.038    -0.824    86.265     0.412     0.477     0.338 
## count_birth_order2/3         -0.003     0.032    -0.065     0.059    -0.099    89.014     0.922     0.466     0.333 
## count_birth_order3/3         -0.010     0.038    -0.084     0.064    -0.264    31.594     0.793     1.145     0.561 
## count_birth_order1/4         -0.042     0.051    -0.143     0.058    -0.828    29.051     0.414     1.255     0.584 
## count_birth_order2/4         -0.034     0.048    -0.128     0.060    -0.702    29.521     0.488     1.233     0.580 
## count_birth_order3/4         -0.030     0.040    -0.108     0.048    -0.759    76.290     0.450     0.523     0.360 
## count_birth_order4/4         -0.005     0.043    -0.089     0.080    -0.114    51.617     0.910     0.717     0.439 
## count_birth_order1/5         -0.048     0.053    -0.152     0.056    -0.905    92.042     0.368     0.455     0.327 
## count_birth_order2/5         -0.045     0.046    -0.136     0.046    -0.975   231.618     0.330     0.246     0.204 
## count_birth_order3/5         -0.025     0.055    -0.132     0.082    -0.460    48.675     0.648     0.754     0.452 
## count_birth_order4/5         -0.001     0.049    -0.097     0.095    -0.020   219.807     0.984     0.254     0.210 
## count_birth_order5/5         -0.018     0.068    -0.151     0.115    -0.265    32.455     0.792     1.112     0.553 
## count_birth_order1/5+        -0.092     0.058    -0.207     0.022    -1.586    75.081     0.117     0.530     0.363 
## count_birth_order2/5+        -0.065     0.054    -0.171     0.040    -1.221    59.620     0.227     0.635     0.408 
## count_birth_order3/5+        -0.046     0.059    -0.161     0.070    -0.778    29.878     0.443     1.217     0.576 
## count_birth_order4/5+        -0.002     0.049    -0.099     0.094    -0.046    95.053     0.964     0.444     0.322 
## count_birth_order5/5+         0.032     0.055    -0.075     0.140     0.586    60.779     0.560     0.626     0.404 
## count_birth_order5+/5+       -0.059     0.044    -0.144     0.027    -1.345    62.871     0.184     0.609     0.397 
## poly(age, 3, raw = TRUE)1     0.018     0.013    -0.007     0.043     1.438    10.058     0.181    17.505     0.954 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.264    11.065     0.232     9.190     0.916 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.885    12.492     0.393     5.614     0.868 
## male                         -0.232     0.020    -0.272    -0.193   -11.471    20.848     0.000     1.916     0.686 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.058 
## Residual~~Residual                     0.923 
## ICC|mother_pidlink                     0.060 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-11" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-2" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.429       10   90.336    0.929  500.485 
##   2 vs 3:    0.437        4   36.053    0.781 1138.305 
##   3 vs 4:    0.171        1  165.182    0.680    0.166</code></pre>
</div>
</div>
</div>
<div id="neuroticism" class="section level3 tabset">
<h3>Neuroticism</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-3" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-3" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-12" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.522     0.080     0.365     0.679     6.523    10.115     0.000    16.625     0.952 
## poly(age, 3, raw = TRUE)1    -0.026     0.010    -0.047    -0.006    -2.523    10.172     0.030    15.838     0.950 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.814    11.049     0.433     9.258     0.916 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.208    12.068     0.839     6.330     0.882 
## male                         -0.253     0.020    -0.292    -0.214   -12.751    17.898     0.000     2.438     0.737 
## sibling_count3                0.006     0.024    -0.040     0.052     0.259    27.145     0.798     1.357     0.604 
## sibling_count4               -0.006     0.024    -0.053     0.041    -0.258    43.406     0.797     0.836     0.479 
## sibling_count5                0.002     0.027    -0.051     0.055     0.087    61.004     0.931     0.624     0.403 
## sibling_count5+               0.023     0.024    -0.023     0.070     0.986   108.819     0.326     0.404     0.300 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.848 
## ICC|mother_pidlink                     0.092 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-12" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-3" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-13" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.520     0.081     0.361     0.678     6.421    10.317     0.000    14.154     0.944 
## birth_order                   0.001     0.005    -0.009     0.011     0.219    55.786     0.827     0.671     0.422 
## poly(age, 3, raw = TRUE)1    -0.026     0.011    -0.047    -0.006    -2.515    10.177     0.030    15.772     0.949 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.810    11.050     0.435     9.256     0.916 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.205    12.064     0.841     6.338     0.882 
## male                         -0.253     0.020    -0.292    -0.214   -12.754    17.905     0.000     2.436     0.737 
## sibling_count3                0.006     0.024    -0.042     0.053     0.233    25.974     0.818     1.431     0.617 
## sibling_count4               -0.007     0.025    -0.056     0.042    -0.285    39.117     0.777     0.922     0.504 
## sibling_count5                0.001     0.028    -0.054     0.057     0.039    52.609     0.969     0.705     0.435 
## sibling_count5+               0.021     0.027    -0.032     0.074     0.767    76.077     0.445     0.524     0.361 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.848 
## ICC|mother_pidlink                     0.092 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-13" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-3" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-14" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.517     0.079     0.362     0.672     6.534    10.647     0.000    11.407     0.931 
## birth_order_nonlinear2        0.002     0.019    -0.035     0.040     0.127    50.801     0.899     0.727     0.442 
## birth_order_nonlinear3        0.018     0.021    -0.022     0.059     0.885    87.269     0.379     0.473     0.336 
## birth_order_nonlinear4       -0.001     0.027    -0.054     0.053    -0.020    47.137     0.984     0.776     0.459 
## birth_order_nonlinear5       -0.000     0.043    -0.085     0.085    -0.003    24.904     0.997     1.507     0.630 
## birth_order_nonlinear5+       0.010     0.044    -0.077     0.096     0.218    40.982     0.829     0.882     0.493 
## poly(age, 3, raw = TRUE)1    -0.026     0.011    -0.047    -0.006    -2.487    10.307     0.031    14.255     0.944 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.766    11.276     0.459     8.382     0.908 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.163    12.354     0.873     5.827     0.873 
## male                         -0.254     0.019    -0.291    -0.217   -13.479    21.076     0.000     1.886     0.682 
## sibling_count3                0.003     0.023    -0.042     0.048     0.126    36.273     0.900     0.993     0.524 
## sibling_count4               -0.005     0.024    -0.053     0.042    -0.223    65.637     0.824     0.588     0.389 
## sibling_count5                0.005     0.030    -0.054     0.064     0.167    51.917     0.868     0.713     0.438 
## sibling_count5+               0.021     0.028    -0.033     0.075     0.750    96.219     0.455     0.441     0.320 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.085 
## Residual~~Residual                     0.850 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-14" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-3" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-15" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.518     0.082     0.358     0.679     6.336    11.058     0.000     9.220     0.916 
## count_birth_order2/2          0.002     0.029    -0.056     0.059     0.064    43.125     0.949     0.841     0.480 
## count_birth_order1/3         -0.005     0.039    -0.082     0.071    -0.137    31.879     0.892     1.134     0.558 
## count_birth_order2/3          0.021     0.040    -0.057     0.099     0.522    25.784     0.606     1.444     0.619 
## count_birth_order3/3          0.020     0.035    -0.049     0.089     0.573    38.553     0.570     0.935     0.508 
## count_birth_order1/4          0.023     0.041    -0.057     0.104     0.567    77.640     0.573     0.516     0.357 
## count_birth_order2/4          0.013     0.040    -0.066     0.092     0.326    56.546     0.746     0.664     0.419 
## count_birth_order3/4          0.013     0.040    -0.064     0.091     0.338    63.933     0.736     0.601     0.394 
## count_birth_order4/4         -0.026     0.046    -0.116     0.065    -0.557    33.416     0.581     1.079     0.545 
## count_birth_order1/5          0.044     0.062    -0.077     0.165     0.717    34.139     0.478     1.055     0.540 
## count_birth_order2/5         -0.005     0.053    -0.110     0.100    -0.094    50.477     0.925     0.731     0.444 
## count_birth_order3/5          0.035     0.048    -0.058     0.128     0.736   110.249     0.464     0.400     0.298 
## count_birth_order4/5          0.006     0.050    -0.093     0.105     0.119   108.276     0.905     0.405     0.301 
## count_birth_order5/5          0.001     0.064    -0.124     0.127     0.020    36.332     0.984     0.991     0.523 
## count_birth_order1/5+         0.034     0.065    -0.094     0.162     0.521    35.508     0.606     1.014     0.529 
## count_birth_order2/5+         0.017     0.063    -0.106     0.141     0.278    27.264     0.783     1.350     0.603 
## count_birth_order3/5+         0.059     0.049    -0.038     0.156     1.190    60.739     0.239     0.626     0.404 
## count_birth_order4/5+         0.024     0.052    -0.079     0.127     0.458    52.658     0.649     0.705     0.434 
## count_birth_order5/5+         0.031     0.056    -0.078     0.140     0.556    49.118     0.580     0.748     0.450 
## count_birth_order5+/5+        0.036     0.043    -0.049     0.120     0.833    63.305     0.408     0.605     0.396 
## poly(age, 3, raw = TRUE)1    -0.027     0.011    -0.048    -0.005    -2.449    10.420     0.033    13.158     0.940 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.731    11.469     0.479     7.760     0.902 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.115    12.508     0.910     5.589     0.868 
## male                         -0.254     0.020    -0.294    -0.214   -12.536    19.665     0.000     2.091     0.705 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.850 
## ICC|mother_pidlink                     0.090 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-15" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-3" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.412       10   90.336    0.938  500.740 
##   2 vs 3:    0.399        4   36.053    0.808 1139.066 
##   3 vs 4:    0.050        1   27.495    0.824    0.666</code></pre>
</div>
</div>
</div>
<div id="conscientiousness" class="section level3 tabset">
<h3>Conscientiousness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-4" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-4" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-16" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.522     0.080     0.365     0.679     6.523    10.115     0.000    16.625     0.952 
## poly(age, 3, raw = TRUE)1    -0.026     0.010    -0.047    -0.006    -2.523    10.172     0.030    15.838     0.950 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.814    11.049     0.433     9.258     0.916 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.208    12.068     0.839     6.330     0.882 
## male                         -0.253     0.020    -0.292    -0.214   -12.751    17.898     0.000     2.438     0.737 
## sibling_count3                0.006     0.024    -0.040     0.052     0.259    27.145     0.798     1.357     0.604 
## sibling_count4               -0.006     0.024    -0.053     0.041    -0.258    43.406     0.797     0.836     0.479 
## sibling_count5                0.002     0.027    -0.051     0.055     0.087    61.004     0.931     0.624     0.403 
## sibling_count5+               0.023     0.024    -0.023     0.070     0.986   108.819     0.326     0.404     0.300 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.848 
## ICC|mother_pidlink                     0.092 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-16" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-4" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-17" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.520     0.081     0.361     0.678     6.421    10.317     0.000    14.154     0.944 
## birth_order                   0.001     0.005    -0.009     0.011     0.219    55.786     0.827     0.671     0.422 
## poly(age, 3, raw = TRUE)1    -0.026     0.011    -0.047    -0.006    -2.515    10.177     0.030    15.772     0.949 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.810    11.050     0.435     9.256     0.916 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.205    12.064     0.841     6.338     0.882 
## male                         -0.253     0.020    -0.292    -0.214   -12.754    17.905     0.000     2.436     0.737 
## sibling_count3                0.006     0.024    -0.042     0.053     0.233    25.974     0.818     1.431     0.617 
## sibling_count4               -0.007     0.025    -0.056     0.042    -0.285    39.117     0.777     0.922     0.504 
## sibling_count5                0.001     0.028    -0.054     0.057     0.039    52.609     0.969     0.705     0.435 
## sibling_count5+               0.021     0.027    -0.032     0.074     0.767    76.077     0.445     0.524     0.361 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.848 
## ICC|mother_pidlink                     0.092 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-17" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-4" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-18" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.517     0.079     0.362     0.672     6.534    10.647     0.000    11.407     0.931 
## birth_order_nonlinear2        0.002     0.019    -0.035     0.040     0.127    50.801     0.899     0.727     0.442 
## birth_order_nonlinear3        0.018     0.021    -0.022     0.059     0.885    87.269     0.379     0.473     0.336 
## birth_order_nonlinear4       -0.001     0.027    -0.054     0.053    -0.020    47.137     0.984     0.776     0.459 
## birth_order_nonlinear5       -0.000     0.043    -0.085     0.085    -0.003    24.904     0.997     1.507     0.630 
## birth_order_nonlinear5+       0.010     0.044    -0.077     0.096     0.218    40.982     0.829     0.882     0.493 
## poly(age, 3, raw = TRUE)1    -0.026     0.011    -0.047    -0.006    -2.487    10.307     0.031    14.255     0.944 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.766    11.276     0.459     8.382     0.908 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.163    12.354     0.873     5.827     0.873 
## male                         -0.254     0.019    -0.291    -0.217   -13.479    21.076     0.000     1.886     0.682 
## sibling_count3                0.003     0.023    -0.042     0.048     0.126    36.273     0.900     0.993     0.524 
## sibling_count4               -0.005     0.024    -0.053     0.042    -0.223    65.637     0.824     0.588     0.389 
## sibling_count5                0.005     0.030    -0.054     0.064     0.167    51.917     0.868     0.713     0.438 
## sibling_count5+               0.021     0.028    -0.033     0.075     0.750    96.219     0.455     0.441     0.320 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.085 
## Residual~~Residual                     0.850 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-18" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-4" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-19" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.518     0.082     0.358     0.679     6.336    11.058     0.000     9.220     0.916 
## count_birth_order2/2          0.002     0.029    -0.056     0.059     0.064    43.125     0.949     0.841     0.480 
## count_birth_order1/3         -0.005     0.039    -0.082     0.071    -0.137    31.879     0.892     1.134     0.558 
## count_birth_order2/3          0.021     0.040    -0.057     0.099     0.522    25.784     0.606     1.444     0.619 
## count_birth_order3/3          0.020     0.035    -0.049     0.089     0.573    38.553     0.570     0.935     0.508 
## count_birth_order1/4          0.023     0.041    -0.057     0.104     0.567    77.640     0.573     0.516     0.357 
## count_birth_order2/4          0.013     0.040    -0.066     0.092     0.326    56.546     0.746     0.664     0.419 
## count_birth_order3/4          0.013     0.040    -0.064     0.091     0.338    63.933     0.736     0.601     0.394 
## count_birth_order4/4         -0.026     0.046    -0.116     0.065    -0.557    33.416     0.581     1.079     0.545 
## count_birth_order1/5          0.044     0.062    -0.077     0.165     0.717    34.139     0.478     1.055     0.540 
## count_birth_order2/5         -0.005     0.053    -0.110     0.100    -0.094    50.477     0.925     0.731     0.444 
## count_birth_order3/5          0.035     0.048    -0.058     0.128     0.736   110.249     0.464     0.400     0.298 
## count_birth_order4/5          0.006     0.050    -0.093     0.105     0.119   108.276     0.905     0.405     0.301 
## count_birth_order5/5          0.001     0.064    -0.124     0.127     0.020    36.332     0.984     0.991     0.523 
## count_birth_order1/5+         0.034     0.065    -0.094     0.162     0.521    35.508     0.606     1.014     0.529 
## count_birth_order2/5+         0.017     0.063    -0.106     0.141     0.278    27.264     0.783     1.350     0.603 
## count_birth_order3/5+         0.059     0.049    -0.038     0.156     1.190    60.739     0.239     0.626     0.404 
## count_birth_order4/5+         0.024     0.052    -0.079     0.127     0.458    52.658     0.649     0.705     0.434 
## count_birth_order5/5+         0.031     0.056    -0.078     0.140     0.556    49.118     0.580     0.748     0.450 
## count_birth_order5+/5+        0.036     0.043    -0.049     0.120     0.833    63.305     0.408     0.605     0.396 
## poly(age, 3, raw = TRUE)1    -0.027     0.011    -0.048    -0.005    -2.449    10.420     0.033    13.158     0.940 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.731    11.469     0.479     7.760     0.902 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.115    12.508     0.910     5.589     0.868 
## male                         -0.254     0.020    -0.294    -0.214   -12.536    19.665     0.000     2.091     0.705 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.850 
## ICC|mother_pidlink                     0.090 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-19" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-4" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.412       10   90.336    0.938  500.740 
##   2 vs 3:    0.399        4   36.053    0.808 1139.066 
##   3 vs 4:    0.050        1   27.495    0.824    0.666</code></pre>
</div>
</div>
</div>
<div id="agreeableness" class="section level3 tabset">
<h3>Agreeableness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_agree)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-5" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-5" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-20" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.260     0.121    -0.497    -0.024    -2.160     9.487     0.058    37.491     0.978 
## poly(age, 3, raw = TRUE)1     0.010     0.014    -0.018     0.037     0.685     9.664     0.510    27.581     0.971 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.710    10.458     0.493    12.830     0.938 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.797    11.867     0.098     6.745     0.888 
## male                          0.048     0.019     0.011     0.085     2.539    20.569     0.019     1.954     0.690 
## sibling_count3               -0.010     0.019    -0.047     0.027    -0.519    95.770     0.605     0.442     0.321 
## sibling_count4               -0.010     0.026    -0.061     0.042    -0.367    31.526     0.716     1.147     0.561 
## sibling_count5                0.016     0.027    -0.038     0.069     0.572    62.987     0.569     0.608     0.397 
## sibling_count5+              -0.018     0.026    -0.069     0.033    -0.683    57.320     0.498     0.656     0.416 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-20" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-5" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-21" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.258     0.123    -0.498    -0.017    -2.102     9.562     0.063    32.526     0.975 
## birth_order                  -0.001     0.005    -0.010     0.008    -0.250   100.443     0.803     0.427     0.313 
## poly(age, 3, raw = TRUE)1     0.009     0.014    -0.018     0.037     0.678     9.664     0.514    27.596     0.971 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.713    10.454     0.492    12.864     0.939 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.797    11.858     0.098     6.763     0.889 
## male                          0.048     0.019     0.011     0.085     2.537    20.530     0.019     1.959     0.691 
## sibling_count3               -0.009     0.019    -0.046     0.028    -0.485    91.858     0.629     0.456     0.327 
## sibling_count4               -0.009     0.028    -0.063     0.046    -0.313    27.981     0.757     1.310     0.595 
## sibling_count5                0.017     0.028    -0.038     0.072     0.600    57.584     0.551     0.654     0.415 
## sibling_count5+              -0.015     0.031    -0.076     0.046    -0.480    36.871     0.634     0.977     0.519 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.894 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-21" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-5" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-22" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.257     0.120    -0.492    -0.022    -2.142     9.693     0.059    26.469     0.969 
## birth_order_nonlinear2       -0.005     0.018    -0.041     0.030    -0.291    80.553     0.772     0.502     0.350 
## birth_order_nonlinear3       -0.008     0.022    -0.052     0.035    -0.377    59.132     0.708     0.640     0.410 
## birth_order_nonlinear4       -0.001     0.025    -0.051     0.049    -0.041    87.743     0.967     0.471     0.335 
## birth_order_nonlinear5       -0.001     0.033    -0.066     0.063    -0.040   112.689     0.968     0.394     0.295 
## birth_order_nonlinear5+      -0.013     0.040    -0.092     0.065    -0.336    81.281     0.738     0.499     0.349 
## poly(age, 3, raw = TRUE)1     0.010     0.014    -0.018     0.038     0.674     9.705     0.516    26.012     0.969 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.001     0.001     0.662    10.476     0.522    12.680     0.938 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.627    11.737     0.130     7.042     0.893 
## male                          0.049     0.021     0.008     0.089     2.371    18.585     0.029     2.288     0.724 
## sibling_count3               -0.010     0.021    -0.051     0.031    -0.471    67.074     0.639     0.578     0.384 
## sibling_count4               -0.013     0.031    -0.073     0.047    -0.420    25.217     0.678     1.484     0.626 
## sibling_count5                0.017     0.031    -0.044     0.078     0.552    47.712     0.584     0.768     0.457 
## sibling_count5+              -0.016     0.032    -0.078     0.046    -0.515    43.428     0.609     0.836     0.479 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.080 
## Residual~~Residual                     0.893 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-22" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-5" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-23" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.252     0.127    -0.501    -0.003    -1.986     9.811     0.076    22.675     0.964 
## count_birth_order2/2         -0.015     0.033    -0.080     0.051    -0.441    28.315     0.663     1.292     0.592 
## count_birth_order1/3         -0.020     0.034    -0.086     0.046    -0.591    76.215     0.556     0.524     0.360 
## count_birth_order2/3         -0.006     0.031    -0.068     0.055    -0.206    93.706     0.838     0.449     0.324 
## count_birth_order3/3         -0.029     0.033    -0.094     0.037    -0.858    57.613     0.394     0.654     0.415 
## count_birth_order1/4         -0.019     0.050    -0.117     0.080    -0.369    30.399     0.715     1.194     0.571 
## count_birth_order2/4         -0.035     0.041    -0.115     0.045    -0.860    59.981     0.393     0.632     0.407 
## count_birth_order3/4         -0.014     0.045    -0.103     0.075    -0.302    35.276     0.764     1.021     0.531 
## count_birth_order4/4         -0.016     0.045    -0.105     0.072    -0.359    39.917     0.722     0.904     0.499 
## count_birth_order1/5          0.010     0.071    -0.130     0.149     0.137    23.322     0.892     1.640     0.650 
## count_birth_order2/5          0.004     0.055    -0.104     0.111     0.068    49.162     0.946     0.748     0.450 
## count_birth_order3/5          0.006     0.047    -0.087     0.098     0.122   145.624     0.903     0.331     0.259 
## count_birth_order4/5         -0.001     0.053    -0.105     0.103    -0.017    82.473     0.986     0.493     0.346 
## count_birth_order5/5          0.035     0.054    -0.071     0.141     0.643   127.636     0.521     0.362     0.277 
## count_birth_order1/5+        -0.013     0.057    -0.125     0.099    -0.231    84.904     0.818     0.483     0.341 
## count_birth_order2/5+        -0.006     0.059    -0.121     0.110    -0.094    36.377     0.925     0.990     0.523 
## count_birth_order3/5+        -0.037     0.051    -0.136     0.063    -0.724    57.991     0.472     0.650     0.414 
## count_birth_order4/5+        -0.012     0.053    -0.116     0.093    -0.217    53.471     0.829     0.696     0.431 
## count_birth_order5/5+        -0.050     0.051    -0.150     0.050    -0.986   106.231     0.326     0.411     0.304 
## count_birth_order5+/5+       -0.034     0.047    -0.125     0.057    -0.727    44.665     0.471     0.815     0.472 
## poly(age, 3, raw = TRUE)1     0.009     0.015    -0.020     0.039     0.636     9.751     0.539    24.450     0.967 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.001     0.001     0.642    10.504     0.535    12.445     0.937 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.526    11.719     0.154     7.088     0.893 
## male                          0.048     0.022     0.004     0.092     2.150    17.053     0.046     2.656     0.754 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.081 
## Residual~~Residual                     0.891 
## ICC|mother_pidlink                     0.083 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-23" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-5" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.432       10   90.336    0.927  500.643 
##   2 vs 3:    0.434        4   36.053    0.783 1138.788 
##   3 vs 4:    0.058        1   43.054    0.811    0.433</code></pre>
</div>
</div>
</div>
<div id="openness" class="section level3 tabset">
<h3>Openness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_open)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-6" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-6" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-24" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.228     0.050    -0.326    -0.131    -4.592    12.588     0.001     5.475     0.865 
## poly(age, 3, raw = TRUE)1     0.020     0.006     0.008     0.031     3.402    14.062     0.004     4.000     0.823 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.506    19.570     0.021     2.107     0.707 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.841    26.609     0.408     1.390     0.610 
## male                          0.156     0.017     0.123     0.189     9.193    26.843     0.000     1.375     0.607 
## sibling_count3               -0.012     0.020    -0.051     0.026    -0.628    67.818     0.532     0.573     0.382 
## sibling_count4               -0.004     0.025    -0.052     0.044    -0.169    42.907     0.867     0.845     0.482 
## sibling_count5               -0.011     0.036    -0.082     0.059    -0.316    22.056     0.755     1.768     0.668 
## sibling_count5+              -0.029     0.026    -0.080     0.022    -1.099    60.712     0.276     0.626     0.404 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.900 
## ICC|mother_pidlink                     0.086 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-24" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-6" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-25" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.225     0.051    -0.325    -0.124    -4.379    13.144     0.001     4.796     0.849 
## birth_order                  -0.002     0.005    -0.012     0.009    -0.318    39.689     0.752     0.909     0.501 
## poly(age, 3, raw = TRUE)1     0.020     0.006     0.008     0.031     3.385    14.097     0.004     3.976     0.823 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.495    19.603     0.022     2.102     0.706 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.832    26.635     0.413     1.388     0.610 
## male                          0.156     0.017     0.123     0.189     9.188    26.787     0.000     1.379     0.608 
## sibling_count3               -0.012     0.020    -0.051     0.028    -0.579    64.707     0.565     0.595     0.391 
## sibling_count4               -0.003     0.025    -0.051     0.046    -0.110    45.713     0.913     0.798     0.467 
## sibling_count5               -0.009     0.036    -0.080     0.061    -0.261    23.369     0.797     1.636     0.649 
## sibling_count5+              -0.025     0.026    -0.076     0.027    -0.931   116.763     0.354     0.384     0.290 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.900 
## ICC|mother_pidlink                     0.086 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-25" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-6" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-26" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.219     0.054    -0.324    -0.113    -4.065    13.480     0.001     4.467     0.839 
## birth_order_nonlinear2       -0.012     0.021    -0.054     0.030    -0.571    34.377     0.572     1.048     0.538 
## birth_order_nonlinear3       -0.021     0.030    -0.080     0.038    -0.701    20.223     0.491     2.004     0.696 
## birth_order_nonlinear4       -0.022     0.032    -0.085     0.041    -0.695    27.913     0.493     1.314     0.596 
## birth_order_nonlinear5       -0.011     0.043    -0.095     0.073    -0.254    27.746     0.801     1.323     0.598 
## birth_order_nonlinear5+      -0.042     0.039    -0.119     0.035    -1.064    99.165     0.290     0.431     0.315 
## poly(age, 3, raw = TRUE)1     0.020     0.006     0.007     0.032     3.118    13.641     0.008     4.327     0.835 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.228    18.033     0.039     2.407     0.734 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.725    24.847     0.475     1.512     0.630 
## male                          0.156     0.017     0.123     0.189     9.296    30.864     0.000     1.174     0.567 
## sibling_count3               -0.008     0.023    -0.053     0.036    -0.358    43.029     0.722     0.843     0.481 
## sibling_count4                0.002     0.027    -0.050     0.054     0.062    42.250     0.951     0.857     0.485 
## sibling_count5               -0.004     0.035    -0.073     0.064    -0.126    29.404     0.900     1.238     0.581 
## sibling_count5+              -0.017     0.027    -0.071     0.037    -0.616   123.985     0.539     0.369     0.281 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.898 
## ICC|mother_pidlink                     0.085 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-26" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-6" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-27" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.217     0.056    -0.327    -0.108    -3.897    14.803     0.001     3.540     0.804 
## count_birth_order2/2         -0.022     0.038    -0.096     0.052    -0.578    20.720     0.570     1.933     0.688 
## count_birth_order1/3         -0.037     0.034    -0.105     0.030    -1.086    64.996     0.281     0.593     0.391 
## count_birth_order2/3         -0.033     0.032    -0.096     0.030    -1.014    74.441     0.314     0.533     0.365 
## count_birth_order3/3         -0.027     0.040    -0.106     0.052    -0.669    26.333     0.510     1.407     0.613 
## count_birth_order1/4         -0.029     0.043    -0.113     0.055    -0.674    64.501     0.503     0.596     0.392 
## count_birth_order2/4         -0.033     0.038    -0.108     0.041    -0.872   105.362     0.385     0.413     0.305 
## count_birth_order3/4         -0.039     0.044    -0.126     0.047    -0.889    39.581     0.380     0.911     0.501 
## count_birth_order4/4         -0.021     0.044    -0.108     0.066    -0.463    43.794     0.646     0.829     0.477 
## count_birth_order1/5         -0.045     0.054    -0.151     0.061    -0.832    80.294     0.408     0.503     0.351 
## count_birth_order2/5         -0.030     0.055    -0.138     0.078    -0.549    49.039     0.586     0.749     0.450 
## count_birth_order3/5         -0.056     0.056    -0.167     0.055    -0.990    40.735     0.328     0.887     0.494 
## count_birth_order4/5         -0.022     0.066    -0.151     0.108    -0.327    28.089     0.746     1.304     0.594 
## count_birth_order5/5         -0.029     0.088    -0.203     0.144    -0.333    17.163     0.743     2.625     0.752 
## count_birth_order1/5+        -0.038     0.060    -0.154     0.079    -0.633    64.345     0.529     0.597     0.393 
## count_birth_order2/5+        -0.063     0.059    -0.179     0.053    -1.072    36.356     0.291     0.990     0.523 
## count_birth_order3/5+        -0.059     0.055    -0.168     0.049    -1.069    37.433     0.292     0.962     0.516 
## count_birth_order4/5+        -0.058     0.048    -0.153     0.037    -1.193   112.372     0.235     0.395     0.295 
## count_birth_order5/5+        -0.036     0.058    -0.149     0.077    -0.623    45.046     0.536     0.808     0.470 
## count_birth_order5+/5+       -0.073     0.046    -0.164     0.017    -1.584    47.099     0.120     0.777     0.460 
## poly(age, 3, raw = TRUE)1     0.021     0.006     0.008     0.034     3.246    14.296     0.006     3.841     0.817 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.290    19.494     0.033     2.120     0.708 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.797    27.664     0.432     1.328     0.598 
## male                          0.157     0.018     0.120     0.193     8.496    25.832     0.000     1.441     0.619 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.083 
## Residual~~Residual                     0.895 
## ICC|mother_pidlink                     0.085 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-27" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-6" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.450       10   90.336    0.917  500.826 
##   2 vs 3:    0.452        4   36.053    0.770 1139.585 
##   3 vs 4:    0.104        1   21.231    0.751    0.908</code></pre>
</div>
</div>
</div>
</div>
<div id="riskpreference" class="section level2 tabset">
<h2>Riskpreference</h2>
<div id="risk-a" class="section level3 tabset">
<h3>Risk A</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskA)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-7" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-7" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-28" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.735     0.101     0.537     0.932     7.287     9.664     0.000    27.620     0.971 
## poly(age, 3, raw = TRUE)1    -0.066     0.011    -0.088    -0.044    -5.794     9.958     0.000    19.272     0.958 
## poly(age, 3, raw = TRUE)2     0.002     0.000     0.001     0.002     4.989    11.041     0.000     9.292     0.917 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.927    12.521     0.002     5.571     0.867 
## male                         -0.222     0.017    -0.255    -0.188   -12.979    24.136     0.000     1.568     0.639 
## sibling_count3               -0.011     0.022    -0.054     0.032    -0.497    32.876     0.623     1.097     0.550 
## sibling_count4                0.001     0.021    -0.040     0.043     0.068    86.798     0.946     0.475     0.337 
## sibling_count5                0.005     0.028    -0.049     0.059     0.176    47.814     0.861     0.766     0.456 
## sibling_count5+               0.022     0.024    -0.025     0.070     0.919    67.387     0.361     0.576     0.383 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.069 
## Residual~~Residual                     0.849 
## ICC|mother_pidlink                     0.076 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-28" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-7" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-29" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.729     0.102     0.530     0.929     7.161     9.779     0.000    23.586     0.966 
## birth_order                   0.003     0.005    -0.007     0.012     0.498    44.755     0.621     0.813     0.472 
## poly(age, 3, raw = TRUE)1    -0.066     0.011    -0.088    -0.044    -5.778     9.962     0.000    19.204     0.958 
## poly(age, 3, raw = TRUE)2     0.002     0.000     0.001     0.002     4.979    11.043     0.000     9.283     0.917 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.921    12.525     0.002     5.566     0.867 
## male                         -0.222     0.017    -0.255    -0.188   -12.972    24.101     0.000     1.571     0.640 
## sibling_count3               -0.012     0.022    -0.054     0.030    -0.556    35.295     0.582     1.020     0.531 
## sibling_count4               -0.001     0.022    -0.043     0.042    -0.033    81.021     0.974     0.500     0.349 
## sibling_count5                0.002     0.028    -0.053     0.057     0.068    48.379     0.946     0.758     0.453 
## sibling_count5+               0.016     0.024    -0.031     0.064     0.675   175.629     0.500     0.293     0.235 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.069 
## Residual~~Residual                     0.849 
## ICC|mother_pidlink                     0.075 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-29" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-7" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-30" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.724     0.093     0.541     0.906     7.778    10.115     0.000    16.626     0.952 
## birth_order_nonlinear2        0.010     0.023    -0.035     0.055     0.432    25.053     0.669     1.496     0.628 
## birth_order_nonlinear3        0.019     0.021    -0.022     0.060     0.915    71.002     0.363     0.553     0.373 
## birth_order_nonlinear4        0.015     0.027    -0.038     0.067     0.548    50.760     0.586     0.727     0.443 
## birth_order_nonlinear5        0.025     0.037    -0.047     0.097     0.676    42.721     0.502     0.848     0.483 
## birth_order_nonlinear5+       0.044     0.052    -0.058     0.146     0.841    22.768     0.409     1.693     0.658 
## poly(age, 3, raw = TRUE)1    -0.066     0.011    -0.087    -0.044    -5.898    10.133     0.000    16.376     0.951 
## poly(age, 3, raw = TRUE)2     0.002     0.000     0.001     0.002     5.059    11.521     0.000     7.610     0.900 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.952    13.644     0.002     4.324     0.835 
## male                         -0.222     0.019    -0.259    -0.184   -11.656    20.307     0.000     1.992     0.694 
## sibling_count3               -0.015     0.023    -0.060     0.029    -0.678    36.779     0.502     0.979     0.520 
## sibling_count4               -0.003     0.021    -0.044     0.038    -0.153   255.386     0.879     0.231     0.194 
## sibling_count5                0.000     0.031    -0.060     0.061     0.010    41.107     0.992     0.879     0.492 
## sibling_count5+               0.010     0.027    -0.042     0.063     0.388   108.475     0.699     0.405     0.301 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.069 
## Residual~~Residual                     0.847 
## ICC|mother_pidlink                     0.075 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-30" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-7" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-31" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.734     0.096     0.545     0.922     7.629    10.383     0.000    13.501     0.941 
## count_birth_order2/2         -0.003     0.030    -0.061     0.056    -0.085    37.637     0.932     0.957     0.514 
## count_birth_order1/3         -0.031     0.037    -0.105     0.042    -0.836    35.683     0.409     1.009     0.528 
## count_birth_order2/3          0.001     0.034    -0.066     0.069     0.037    41.766     0.971     0.866     0.488 
## count_birth_order3/3          0.002     0.036    -0.069     0.073     0.062    33.080     0.951     1.090     0.548 
## count_birth_order1/4          0.023     0.041    -0.057     0.102     0.556    78.539     0.580     0.512     0.355 
## count_birth_order2/4          0.026     0.042    -0.056     0.109     0.626    43.407     0.534     0.836     0.479 
## count_birth_order3/4          0.002     0.047    -0.091     0.094     0.037    27.888     0.970     1.315     0.596 
## count_birth_order4/4         -0.011     0.045    -0.099     0.077    -0.246    35.418     0.807     1.016     0.530 
## count_birth_order1/5          0.017     0.056    -0.093     0.127     0.298    49.240     0.767     0.747     0.449 
## count_birth_order2/5          0.012     0.059    -0.104     0.127     0.198    31.249     0.844     1.158     0.564 
## count_birth_order3/5          0.013     0.060    -0.105     0.130     0.208    28.495     0.837     1.283     0.590 
## count_birth_order4/5          0.049     0.059    -0.067     0.164     0.827    37.349     0.413     0.964     0.516 
## count_birth_order5/5         -0.020     0.068    -0.153     0.113    -0.298    28.508     0.768     1.282     0.590 
## count_birth_order1/5+         0.008     0.053    -0.096     0.113     0.155   119.187     0.877     0.379     0.287 
## count_birth_order2/5+         0.024     0.059    -0.092     0.140     0.406    31.519     0.687     1.148     0.561 
## count_birth_order3/5+         0.049     0.053    -0.055     0.152     0.916    39.203     0.365     0.920     0.504 
## count_birth_order4/5+         0.002     0.049    -0.095     0.099     0.032    69.490     0.974     0.562     0.378 
## count_birth_order5/5+         0.061     0.053    -0.043     0.165     1.155    60.775     0.253     0.626     0.404 
## count_birth_order5+/5+        0.051     0.048    -0.043     0.145     1.072    33.944     0.291     1.062     0.541 
## poly(age, 3, raw = TRUE)1    -0.066     0.011    -0.088    -0.044    -5.897    10.278     0.000    14.564     0.945 
## poly(age, 3, raw = TRUE)2     0.002     0.000     0.001     0.002     5.059    11.951     0.000     6.565     0.885 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.908    14.654     0.001     3.623     0.808 
## male                         -0.223     0.019    -0.261    -0.185   -11.490    21.002     0.000     1.895     0.683 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.067 
## Residual~~Residual                     0.846 
## ICC|mother_pidlink                     0.074 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-31" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-7" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.410       10   90.336    0.938  500.891 
##   2 vs 3:    0.420        4   36.053    0.793 1138.753 
##   3 vs 4:    0.229        1   22.493    0.637    0.843</code></pre>
</div>
</div>
</div>
<div id="risk-b" class="section level3 tabset">
<h3>Risk B</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskB)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-8" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-8" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-32" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.008     0.098    -0.183     0.199     0.083     9.760     0.935    24.159     0.966 
## poly(age, 3, raw = TRUE)1     0.013     0.012    -0.011     0.037     1.069     9.889     0.311    20.739     0.961 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.080    10.599     0.304    11.739     0.933 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.936    11.524     0.368     7.601     0.900 
## male                         -0.182     0.017    -0.215    -0.149   -10.903    28.486     0.000     1.284     0.590 
## sibling_count3               -0.006     0.023    -0.051     0.040    -0.236    28.835     0.815     1.266     0.586 
## sibling_count4               -0.009     0.026    -0.060     0.042    -0.361    31.324     0.721     1.155     0.563 
## sibling_count5               -0.012     0.029    -0.069     0.045    -0.424    41.193     0.674     0.878     0.492 
## sibling_count5+              -0.012     0.023    -0.056     0.033    -0.511   145.462     0.610     0.331     0.259 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.058 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-32" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-8" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-33" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.011     0.098    -0.181     0.203     0.110     9.904     0.915    20.393     0.960 
## birth_order                  -0.001     0.004    -0.010     0.007    -0.282   220.918     0.778     0.253     0.209 
## poly(age, 3, raw = TRUE)1     0.013     0.012    -0.011     0.037     1.064     9.895     0.312    20.605     0.961 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.078    10.605     0.305    11.698     0.933 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.934    11.532     0.369     7.578     0.899 
## male                         -0.182     0.017    -0.215    -0.149   -10.904    28.499     0.000     1.283     0.590 
## sibling_count3               -0.005     0.023    -0.051     0.041    -0.211    29.232     0.835     1.247     0.582 
## sibling_count4               -0.008     0.026    -0.060     0.043    -0.319    32.611     0.752     1.107     0.552 
## sibling_count5               -0.011     0.030    -0.069     0.047    -0.367    41.565     0.716     0.870     0.489 
## sibling_count5+              -0.009     0.025    -0.057     0.039    -0.356   214.746     0.722     0.257     0.212 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.927 
## ICC|mother_pidlink                     0.058 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-33" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-8" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-34" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.010     0.102    -0.189     0.210     0.101     9.981     0.922    18.835     0.957 
## birth_order_nonlinear2       -0.001     0.020    -0.039     0.038    -0.029    54.598     0.977     0.684     0.427 
## birth_order_nonlinear3       -0.009     0.023    -0.054     0.036    -0.385    49.179     0.702     0.748     0.450 
## birth_order_nonlinear4       -0.011     0.024    -0.058     0.037    -0.440   169.105     0.661     0.300     0.240 
## birth_order_nonlinear5       -0.015     0.036    -0.086     0.055    -0.429    59.126     0.670     0.640     0.410 
## birth_order_nonlinear5+       0.005     0.042    -0.076     0.087     0.128    65.280     0.899     0.591     0.390 
## poly(age, 3, raw = TRUE)1     0.013     0.013    -0.012     0.038     1.033     9.932     0.326    19.809     0.959 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.024    10.666     0.328    11.286     0.931 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.884    11.699     0.394     7.137     0.894 
## male                         -0.182     0.017    -0.216    -0.148   -10.548    28.300     0.000     1.293     0.592 
## sibling_count3               -0.005     0.024    -0.052     0.042    -0.194    32.796     0.847     1.100     0.550 
## sibling_count4               -0.007     0.029    -0.064     0.050    -0.248    27.847     0.806     1.318     0.596 
## sibling_count5               -0.010     0.035    -0.079     0.059    -0.295    27.267     0.771     1.350     0.603 
## sibling_count5+              -0.009     0.029    -0.065     0.047    -0.319    70.930     0.751     0.553     0.374 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.926 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-34" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-8" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-35" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.018     0.103    -0.184     0.220     0.177    10.272     0.863    14.631     0.946 
## count_birth_order2/2         -0.014     0.025    -0.064     0.035    -0.567   198.904     0.572     0.270     0.221 
## count_birth_order1/3         -0.043     0.033    -0.108     0.022    -1.283    86.145     0.203     0.478     0.338 
## count_birth_order2/3         -0.003     0.031    -0.064     0.059    -0.081    93.905     0.936     0.448     0.324 
## count_birth_order3/3         -0.011     0.038    -0.085     0.063    -0.290    31.725     0.774     1.140     0.560 
## count_birth_order1/4         -0.018     0.050    -0.115     0.079    -0.362    32.059     0.720     1.127     0.557 
## count_birth_order2/4         -0.026     0.042    -0.108     0.056    -0.629    52.556     0.532     0.706     0.435 
## count_birth_order3/4         -0.036     0.047    -0.128     0.055    -0.781    32.140     0.441     1.124     0.556 
## count_birth_order4/4         -0.018     0.040    -0.095     0.060    -0.453    92.245     0.651     0.454     0.327 
## count_birth_order1/5          0.001     0.068    -0.131     0.134     0.021    26.948     0.983     1.369     0.606 
## count_birth_order2/5         -0.052     0.052    -0.154     0.051    -0.991    65.254     0.325     0.591     0.390 
## count_birth_order3/5         -0.017     0.050    -0.115     0.081    -0.340    85.760     0.735     0.479     0.339 
## count_birth_order4/5         -0.033     0.059    -0.148     0.082    -0.563    44.392     0.576     0.819     0.473 
## count_birth_order5/5         -0.055     0.068    -0.188     0.078    -0.809    31.956     0.425     1.131     0.558 
## count_birth_order1/5+        -0.040     0.060    -0.157     0.077    -0.675    62.287     0.502     0.613     0.399 
## count_birth_order2/5+        -0.017     0.053    -0.120     0.087    -0.318    64.460     0.751     0.597     0.392 
## count_birth_order3/5+        -0.055     0.059    -0.171     0.060    -0.938    29.511     0.356     1.233     0.580 
## count_birth_order4/5+        -0.030     0.048    -0.123     0.064    -0.625   125.993     0.533     0.365     0.279 
## count_birth_order5/5+        -0.013     0.049    -0.108     0.083    -0.262   175.051     0.794     0.293     0.235 
## count_birth_order5+/5+       -0.014     0.040    -0.093     0.065    -0.352   120.580     0.726     0.376     0.285 
## poly(age, 3, raw = TRUE)1     0.013     0.013    -0.012     0.038     1.046    10.066     0.320    17.365     0.954 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.031    11.021     0.325     9.380     0.917 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.891    12.532     0.390     5.556     0.867 
## male                         -0.183     0.019    -0.221    -0.145    -9.466    23.000     0.000     1.671     0.654 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-35" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-8" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.458       10   90.336    0.913  500.882 
##   2 vs 3:    0.448        4   36.053    0.773 1138.341 
##   3 vs 4:    0.076        1   84.712    0.784    0.258</code></pre>
</div>
</div>
</div>
</div>
<div id="educational-attainment" class="section level2 tabset">
<h2>Educational Attainment</h2>
<div id="years-of-education---z-standardized" class="section level3 tabset">
<h3>Years of Education - z-standardized</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = years_of_education_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-9" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-9" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-36" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.557     0.041    -1.637    -1.477   -38.233    12.236     0.000     6.024     0.876 
## poly(age, 3, raw = TRUE)1     0.186     0.005     0.176     0.196    37.348    12.510     0.000     5.587     0.868 
## poly(age, 3, raw = TRUE)2    -0.005     0.000    -0.005    -0.004   -28.728    14.409     0.000     3.769     0.814 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000    19.599    16.192     0.000     2.930     0.772 
## male                         -0.025     0.011    -0.046    -0.004    -2.305    32.979     0.028     1.094     0.549 
## sibling_count3                0.008     0.021    -0.034     0.050     0.360    25.523     0.722     1.462     0.622 
## sibling_count4               -0.006     0.018    -0.040     0.029    -0.329   345.077     0.742     0.193     0.166 
## sibling_count5               -0.033     0.029    -0.090     0.023    -1.161    31.410     0.254     1.152     0.562 
## sibling_count5+              -0.068     0.025    -0.118    -0.019    -2.696    61.587     0.009     0.619     0.401 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.269 
## Residual~~Residual                     0.334 
## ICC|mother_pidlink                     0.446 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-36" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-9" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-37" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.547     0.042    -1.630    -1.464   -36.704    12.794     0.000     5.201     0.859 
## birth_order                  -0.004     0.005    -0.013     0.006    -0.773    19.359     0.449     2.143     0.710 
## poly(age, 3, raw = TRUE)1     0.186     0.005     0.176     0.195    37.386    12.604     0.000     5.453     0.865 
## poly(age, 3, raw = TRUE)2    -0.005     0.000    -0.005    -0.004   -28.732    14.456     0.000     3.740     0.813 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000    19.610    16.237     0.000     2.914     0.771 
## male                         -0.025     0.011    -0.046    -0.004    -2.307    33.070     0.027     1.091     0.548 
## sibling_count3                0.010     0.021    -0.031     0.050     0.471    28.991     0.641     1.258     0.585 
## sibling_count4               -0.002     0.018    -0.038     0.034    -0.124   234.756     0.902     0.243     0.203 
## sibling_count5               -0.028     0.028    -0.083     0.026    -1.025    38.158     0.312     0.944     0.511 
## sibling_count5+              -0.060     0.026    -0.112    -0.008    -2.250    64.554     0.028     0.596     0.392 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.269 
## Residual~~Residual                     0.334 
## ICC|mother_pidlink                     0.446 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-37" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-9" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-38" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.515     0.041    -1.594    -1.435   -37.190    13.902     0.000     4.118     0.828 
## birth_order_nonlinear2       -0.038     0.013    -0.063    -0.013    -2.987    50.804     0.004     0.727     0.442 
## birth_order_nonlinear3       -0.039     0.015    -0.069    -0.009    -2.535    49.497     0.014     0.743     0.448 
## birth_order_nonlinear4       -0.046     0.022    -0.090    -0.002    -2.065    25.323     0.049     1.476     0.625 
## birth_order_nonlinear5       -0.034     0.029    -0.091     0.023    -1.164    27.147     0.255     1.357     0.604 
## birth_order_nonlinear5+      -0.048     0.032    -0.111     0.016    -1.465    32.343     0.152     1.116     0.554 
## poly(age, 3, raw = TRUE)1     0.183     0.005     0.174     0.193    36.899    13.165     0.000     4.775     0.848 
## poly(age, 3, raw = TRUE)2    -0.005     0.000    -0.005    -0.004   -27.209    14.888     0.000     3.495     0.802 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000    17.359    15.723     0.000     3.108     0.783 
## male                         -0.027     0.011    -0.049    -0.004    -2.350    30.744     0.025     1.179     0.568 
## sibling_count3                0.015     0.023    -0.031     0.061     0.653    23.045     0.520     1.666     0.654 
## sibling_count4                0.004     0.019    -0.033     0.041     0.221   291.557     0.826     0.213     0.181 
## sibling_count5               -0.025     0.030    -0.084     0.035    -0.811    31.526     0.424     1.147     0.561 
## sibling_count5+              -0.056     0.027    -0.109    -0.003    -2.064    70.964     0.043     0.553     0.374 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.265 
## Residual~~Residual                     0.333 
## ICC|mother_pidlink                     0.443 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-38" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-9" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-39" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.524     0.041    -1.605    -1.443   -36.988    15.661     0.000     3.133     0.784 
## count_birth_order2/2         -0.028     0.018    -0.063     0.007    -1.584    73.696     0.117     0.537     0.366 
## count_birth_order1/3          0.011     0.032    -0.052     0.074     0.352    25.311     0.727     1.477     0.625 
## count_birth_order2/3         -0.035     0.029    -0.093     0.023    -1.196    28.833     0.242     1.266     0.586 
## count_birth_order3/3         -0.020     0.031    -0.081     0.040    -0.662    25.434     0.514     1.468     0.623 
## count_birth_order1/4         -0.013     0.034    -0.081     0.054    -0.385    42.691     0.702     0.849     0.483 
## count_birth_order2/4         -0.058     0.027    -0.111    -0.004    -2.109   173.677     0.036     0.295     0.236 
## count_birth_order3/4         -0.048     0.028    -0.103     0.007    -1.701   120.287     0.091     0.377     0.285 
## count_birth_order4/4         -0.028     0.033    -0.092     0.037    -0.835    43.762     0.408     0.830     0.477 
## count_birth_order1/5         -0.059     0.045    -0.147     0.029    -1.318    38.973     0.195     0.925     0.505 
## count_birth_order2/5         -0.092     0.042    -0.173    -0.011    -2.216    43.627     0.032     0.832     0.478 
## count_birth_order3/5         -0.064     0.042    -0.147     0.019    -1.518    38.329     0.137     0.940     0.510 
## count_birth_order4/5         -0.093     0.048    -0.187     0.002    -1.918    28.099     0.065     1.304     0.594 
## count_birth_order5/5         -0.039     0.049    -0.134     0.056    -0.803    32.805     0.428     1.100     0.550 
## count_birth_order1/5+        -0.098     0.046    -0.188    -0.008    -2.140    47.601     0.037     0.769     0.457 
## count_birth_order2/5+        -0.119     0.037    -0.191    -0.046    -3.202   109.242     0.002     0.403     0.300 
## count_birth_order3/5+        -0.112     0.042    -0.195    -0.030    -2.682    36.797     0.011     0.978     0.520 
## count_birth_order4/5+        -0.110     0.038    -0.184    -0.036    -2.919    78.261     0.005     0.513     0.355 
## count_birth_order5/5+        -0.096     0.041    -0.177    -0.016    -2.349    55.612     0.022     0.673     0.423 
## count_birth_order5+/5+       -0.108     0.035    -0.176    -0.039    -3.088    63.431     0.003     0.604     0.395 
## poly(age, 3, raw = TRUE)1     0.184     0.005     0.175     0.194    37.551    14.292     0.000     3.844     0.817 
## poly(age, 3, raw = TRUE)2    -0.005     0.000    -0.005    -0.004   -26.589    15.868     0.000     3.050     0.779 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000    16.607    16.660     0.000     2.774     0.762 
## male                         -0.029     0.013    -0.054    -0.004    -2.265    24.594     0.033     1.531     0.634 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.259 
## Residual~~Residual                     0.331 
## ICC|mother_pidlink                     0.439 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-39" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-9" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.167       10   90.336    0.998  500.350 
##   2 vs 3:    0.150        4   36.053    0.962 1138.796 
##   3 vs 4:    0.596        1   13.220    0.454    2.173</code></pre>
</div>
</div>
</div>
<div id="elementary_missed" class="section level3">
<h3>elementary_missed</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_missed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-10" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-10" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-40" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.058     0.032    -0.121     0.004    -1.825     9.238     0.100    76.170     0.989 
## poly(age, 3, raw = TRUE)1     0.006     0.003     0.000     0.012     1.982     9.441     0.077    41.336     0.980 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.957     9.672     0.362    27.290     0.970 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.063     9.694     0.951    26.420     0.969 
## male                          0.006     0.003     0.000     0.012     2.024    26.973     0.053     1.368     0.606 
## sibling_count3               -0.000     0.004    -0.009     0.008    -0.060    29.840     0.952     1.218     0.577 
## sibling_count4               -0.001     0.006    -0.012     0.010    -0.225    24.303     0.824     1.555     0.637 
## sibling_count5                0.002     0.007    -0.012     0.016     0.320    20.979     0.752     1.898     0.684 
## sibling_count5+               0.008     0.006    -0.004     0.019     1.347    32.536     0.187     1.109     0.553 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.158 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-40" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-10" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-41" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.060     0.032    -0.122     0.002    -1.899     9.291     0.089    62.414     0.987 
## birth_order                   0.001     0.001    -0.001     0.003     0.692    23.245     0.496     1.647     0.651 
## poly(age, 3, raw = TRUE)1     0.006     0.003     0.000     0.012     2.003     9.447     0.075    40.779     0.980 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.970     9.676     0.356    27.104     0.970 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.071     9.696     0.945    26.345     0.969 
## male                          0.006     0.003     0.000     0.012     2.023    27.006     0.053     1.366     0.605 
## sibling_count3               -0.001     0.005    -0.010     0.008    -0.144    28.636     0.886     1.276     0.588 
## sibling_count4               -0.002     0.006    -0.013     0.009    -0.340    23.542     0.737     1.620     0.647 
## sibling_count5                0.001     0.008    -0.014     0.016     0.169    18.502     0.868     2.305     0.726 
## sibling_count5+               0.006     0.007    -0.008     0.020     0.849    23.899     0.404     1.588     0.642 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.158 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-41" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-10" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-42" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.060     0.033    -0.124     0.004    -1.834     9.314     0.099    57.810     0.986 
## birth_order_nonlinear2        0.002     0.004    -0.005     0.009     0.504    37.351     0.617     0.964     0.516 
## birth_order_nonlinear3        0.003     0.004    -0.005     0.011     0.818    52.058     0.417     0.712     0.437 
## birth_order_nonlinear4        0.003     0.005    -0.006     0.012     0.610    67.014     0.544     0.578     0.385 
## birth_order_nonlinear5        0.004     0.008    -0.012     0.021     0.510    22.697     0.615     1.701     0.659 
## birth_order_nonlinear5+       0.008     0.008    -0.009     0.024     0.916    39.429     0.365     0.915     0.502 
## poly(age, 3, raw = TRUE)1     0.006     0.003     0.000     0.013     1.974     9.477     0.078    38.225     0.979 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.973     9.731     0.354    25.113     0.968 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.102     9.767     0.921    23.951     0.966 
## male                          0.006     0.003    -0.000     0.013     1.866    23.576     0.075     1.617     0.647 
## sibling_count3               -0.001     0.004    -0.010     0.007    -0.265    39.873     0.792     0.905     0.500 
## sibling_count4               -0.002     0.005    -0.013     0.008    -0.405    33.683     0.688     1.070     0.543 
## sibling_count5                0.001     0.008    -0.014     0.016     0.110    20.676     0.914     1.939     0.688 
## sibling_count5+               0.005     0.007    -0.009     0.020     0.763    24.890     0.453     1.508     0.630 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.156 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-42" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-10" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-43" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.059     0.033    -0.123     0.006    -1.774     9.400     0.108    45.491     0.982 
## count_birth_order2/2         -0.000     0.006    -0.011     0.011    -0.035    33.513     0.972     1.076     0.545 
## count_birth_order1/3         -0.004     0.007    -0.017     0.009    -0.584    46.378     0.562     0.787     0.463 
## count_birth_order2/3          0.001     0.007    -0.012     0.014     0.199    38.508     0.844     0.936     0.508 
## count_birth_order3/3          0.002     0.007    -0.011     0.015     0.308    34.370     0.760     1.048     0.538 
## count_birth_order1/4         -0.003     0.009    -0.020     0.014    -0.373    38.881     0.711     0.927     0.506 
## count_birth_order2/4          0.001     0.009    -0.017     0.018     0.063    27.207     0.950     1.354     0.603 
## count_birth_order3/4         -0.000     0.008    -0.016     0.015    -0.052    43.629     0.959     0.832     0.478 
## count_birth_order4/4         -0.000     0.007    -0.015     0.014    -0.041    90.403     0.968     0.461     0.330 
## count_birth_order1/5          0.002     0.012    -0.021     0.025     0.197    33.477     0.845     1.077     0.545 
## count_birth_order2/5          0.004     0.010    -0.016     0.023     0.397    53.871     0.693     0.691     0.430 
## count_birth_order3/5          0.002     0.013    -0.025     0.028     0.117    19.431     0.908     2.131     0.709 
## count_birth_order4/5          0.004     0.010    -0.015     0.024     0.453    75.135     0.652     0.529     0.363 
## count_birth_order5/5          0.001     0.012    -0.022     0.024     0.112    40.785     0.912     0.886     0.494 
## count_birth_order1/5+         0.007     0.011    -0.015     0.029     0.606    49.579     0.547     0.742     0.448 
## count_birth_order2/5+         0.006     0.013    -0.019     0.032     0.496    21.511     0.625     1.832     0.676 
## count_birth_order3/5+         0.008     0.014    -0.020     0.035     0.535    16.718     0.599     2.755     0.761 
## count_birth_order4/5+         0.004     0.012    -0.019     0.027     0.343    27.201     0.734     1.354     0.603 
## count_birth_order5/5+         0.012     0.009    -0.007     0.030     1.239   115.255     0.218     0.388     0.292 
## count_birth_order5+/5+        0.014     0.008    -0.003     0.030     1.599    53.641     0.116     0.694     0.430 
## poly(age, 3, raw = TRUE)1     0.006     0.003    -0.000     0.013     1.932     9.532     0.084    34.305     0.976 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.952     9.821     0.364    22.424     0.964 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.100     9.879     0.923    20.975     0.962 
## male                          0.006     0.004    -0.001     0.013     1.578    20.644     0.130     1.943     0.689 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.028 
## ICC|mother_pidlink                     0.155 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-43" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-10" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -1.079       10   90.337    1.000  499.715 
##   2 vs 3:   -1.060        4   36.053    1.000 1136.518 
##   3 vs 4:    0.457        1   14.780    0.509    1.661</code></pre>
</div>
</div>
</div>
<div id="elementary_worked" class="section level3">
<h3>elementary_worked</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_worked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-11" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-11" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-44" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.002     0.032    -0.061     0.065     0.058     9.393     0.955    46.249     0.982 
## poly(age, 3, raw = TRUE)1    -0.001     0.003    -0.007     0.005    -0.339     9.769     0.742    23.894     0.966 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.663    10.100     0.127    16.853     0.953 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.612     9.978     0.138    18.891     0.957 
## male                          0.031     0.006     0.019     0.042     5.124    13.438     0.000     4.505     0.840 
## sibling_count3                0.001     0.005    -0.009     0.010     0.150    80.458     0.881     0.503     0.350 
## sibling_count4                0.004     0.005    -0.005     0.014     0.846   384.239     0.398     0.181     0.157 
## sibling_count5                0.008     0.009    -0.009     0.025     0.912    25.379     0.370     1.472     0.624 
## sibling_count5+               0.012     0.009    -0.006     0.029     1.300    20.880     0.208     1.911     0.685 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.190 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-44" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-11" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-45" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.000     0.031    -0.060     0.060    -0.002     9.527     0.998    34.645     0.976 
## birth_order                   0.001     0.002    -0.002     0.004     0.520    19.590     0.609     2.104     0.706 
## poly(age, 3, raw = TRUE)1    -0.001     0.003    -0.007     0.005    -0.327     9.802     0.750    22.930     0.965 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.667    10.124     0.126    16.500     0.952 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.612     9.989     0.138    18.696     0.957 
## male                          0.031     0.006     0.019     0.042     5.123    13.435     0.000     4.509     0.841 
## sibling_count3                0.000     0.005    -0.010     0.010     0.059    58.670     0.953     0.644     0.411 
## sibling_count4                0.003     0.005    -0.006     0.013     0.684   349.952     0.495     0.191     0.165 
## sibling_count5                0.007     0.009    -0.011     0.025     0.750    23.231     0.461     1.648     0.651 
## sibling_count5+               0.010     0.009    -0.008     0.028     1.057    23.674     0.301     1.608     0.645 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.045 
## ICC|mother_pidlink                     0.191 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-45" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-11" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-46" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.002     0.032    -0.065     0.061    -0.053     9.554     0.959    33.006     0.975 
## birth_order_nonlinear2        0.003     0.005    -0.006     0.013     0.674    33.927     0.505     1.062     0.541 
## birth_order_nonlinear3        0.006     0.006    -0.006     0.017     0.981    35.594     0.333     1.011     0.529 
## birth_order_nonlinear4        0.004     0.006    -0.009     0.016     0.560    56.088     0.578     0.668     0.421 
## birth_order_nonlinear5        0.005     0.009    -0.013     0.023     0.552    37.584     0.584     0.958     0.515 
## birth_order_nonlinear5+       0.011     0.013    -0.013     0.036     0.899    21.912     0.378     1.785     0.670 
## poly(age, 3, raw = TRUE)1    -0.001     0.003    -0.007     0.005    -0.269     9.819     0.793    22.469     0.964 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.512    10.129     0.161    16.433     0.951 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.471    10.015     0.172    18.218     0.956 
## male                          0.031     0.006     0.018     0.043     4.907    13.290     0.000     4.647     0.845 
## sibling_count3               -0.001     0.005    -0.011     0.010    -0.114    49.716     0.910     0.741     0.447 
## sibling_count4                0.003     0.006    -0.008     0.014     0.586   177.195     0.559     0.291     0.234 
## sibling_count5                0.007     0.010    -0.012     0.026     0.741    22.186     0.467     1.754     0.666 
## sibling_count5+               0.009     0.010    -0.011     0.029     0.867    21.027     0.396     1.892     0.683 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.189 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-46" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-11" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-47" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.003     0.034    -0.069     0.063    -0.087     9.640     0.932    28.623     0.972 
## count_birth_order2/2          0.004     0.007    -0.009     0.017     0.600    43.360     0.552     0.837     0.479 
## count_birth_order1/3          0.000     0.010    -0.020     0.020     0.006    26.059     0.995     1.425     0.616 
## count_birth_order2/3          0.005     0.008    -0.010     0.020     0.705    66.827     0.483     0.580     0.385 
## count_birth_order3/3          0.006     0.008    -0.009     0.021     0.806    69.005     0.423     0.565     0.379 
## count_birth_order1/4          0.010     0.010    -0.009     0.030     1.053    76.769     0.296     0.521     0.359 
## count_birth_order2/4          0.007     0.010    -0.014     0.027     0.635    40.164     0.529     0.899     0.498 
## count_birth_order3/4          0.007     0.010    -0.012     0.027     0.745    51.489     0.460     0.718     0.439 
## count_birth_order4/4          0.009     0.011    -0.013     0.030     0.772    33.606     0.445     1.073     0.544 
## count_birth_order1/5          0.006     0.016    -0.025     0.037     0.351    27.313     0.728     1.348     0.602 
## count_birth_order2/5          0.019     0.015    -0.009     0.048     1.318    28.482     0.198     1.284     0.590 
## count_birth_order3/5          0.016     0.015    -0.013     0.045     1.095    27.294     0.283     1.349     0.602 
## count_birth_order4/5          0.009     0.018    -0.027     0.044     0.491    19.231     0.629     2.166     0.713 
## count_birth_order5/5          0.013     0.015    -0.017     0.042     0.823    36.725     0.416     0.980     0.520 
## count_birth_order1/5+         0.021     0.017    -0.013     0.054     1.196    25.913     0.243     1.435     0.618 
## count_birth_order2/5+         0.013     0.018    -0.022     0.048     0.723    18.475     0.479     2.311     0.726 
## count_birth_order3/5+         0.018     0.015    -0.011     0.047     1.206    24.985     0.239     1.501     0.629 
## count_birth_order4/5+         0.013     0.015    -0.017     0.042     0.821    25.027     0.419     1.498     0.628 
## count_birth_order5/5+         0.012     0.012    -0.012     0.036     0.969    78.341     0.336     0.513     0.355 
## count_birth_order5+/5+        0.022     0.015    -0.008     0.051     1.441    18.956     0.166     2.216     0.717 
## poly(age, 3, raw = TRUE)1    -0.001     0.003    -0.007     0.006    -0.236     9.846     0.818    21.771     0.963 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.370    10.145     0.200    16.200     0.951 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.322    10.031     0.216    17.952     0.955 
## male                          0.031     0.007     0.018     0.044     4.608    12.946     0.000     5.016     0.855 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.187 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-47" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-11" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.823       10   90.336    1.000  500.641 
##   2 vs 3:   -0.839        4   36.053    1.000 1137.404 
##   3 vs 4:    0.278        1   13.431    0.607    2.083</code></pre>
</div>
</div>
</div>
<div id="attended_school" class="section level3">
<h3>attended_school</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = attended_school)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-12" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-12" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-48" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.203     0.039     0.125     0.280     5.141     9.926     0.000    19.934     0.960 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.037     0.051    12.419    11.206     0.000     8.632     0.911 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.001    -9.274    13.493     0.000     4.455     0.839 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     6.355    16.943     0.000     2.688     0.756 
## male                         -0.002     0.007    -0.015     0.011    -0.318    37.987     0.752     0.948     0.512 
## sibling_count3                0.009     0.009    -0.009     0.027     0.962    55.063     0.340     0.679     0.425 
## sibling_count4                0.006     0.010    -0.014     0.026     0.612    62.352     0.543     0.613     0.399 
## sibling_count5               -0.001     0.014    -0.030     0.027    -0.099    31.143     0.922     1.163     0.565 
## sibling_count5+               0.014     0.012    -0.010     0.038     1.121    46.537     0.268     0.785     0.462 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.024 
## Residual~~Residual                     0.164 
## ICC|mother_pidlink                     0.127 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-48" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-12" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-49" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.198     0.041     0.118     0.278     4.860    10.044     0.001    17.730     0.955 
## birth_order                   0.002     0.002    -0.002     0.007     0.921    42.304     0.363     0.856     0.485 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.037     0.052    12.357    11.183     0.000     8.717     0.912 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.001    -9.262    13.457     0.000     4.489     0.840 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     6.362    16.901     0.000     2.700     0.757 
## male                         -0.002     0.007    -0.015     0.011    -0.320    37.935     0.750     0.950     0.512 
## sibling_count3                0.008     0.009    -0.010     0.026     0.844    55.165     0.402     0.678     0.424 
## sibling_count4                0.004     0.011    -0.016     0.025     0.422    58.663     0.674     0.644     0.411 
## sibling_count5               -0.004     0.015    -0.033     0.025    -0.267    29.314     0.792     1.243     0.582 
## sibling_count5+               0.009     0.014    -0.019     0.037     0.622    36.894     0.538     0.976     0.519 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.024 
## Residual~~Residual                     0.164 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-49" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-12" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-50" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.202     0.043     0.118     0.286     4.738    10.110     0.001    16.704     0.952 
## birth_order_nonlinear2        0.002     0.009    -0.016     0.020     0.211    36.081     0.834     0.998     0.525 
## birth_order_nonlinear3       -0.004     0.010    -0.024     0.015    -0.431    45.359     0.668     0.803     0.468 
## birth_order_nonlinear4       -0.011     0.011    -0.032     0.011    -0.972   103.110     0.333     0.419     0.309 
## birth_order_nonlinear5        0.000     0.019    -0.036     0.037     0.003    27.656     0.998     1.328     0.598 
## birth_order_nonlinear5+       0.014     0.020    -0.025     0.053     0.693    39.265     0.493     0.919     0.503 
## poly(age, 3, raw = TRUE)1     0.044     0.004     0.037     0.051    12.131    11.380     0.000     8.033     0.905 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.001    -8.827    13.788     0.000     4.206     0.831 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     5.777    17.103     0.000     2.642     0.753 
## male                         -0.002     0.007    -0.016     0.011    -0.333    41.231     0.741     0.877     0.491 
## sibling_count3                0.011     0.010    -0.007     0.030     1.186    60.841     0.240     0.625     0.404 
## sibling_count4                0.009     0.011    -0.012     0.031     0.842    62.272     0.403     0.613     0.399 
## sibling_count5                0.002     0.015    -0.028     0.032     0.118    31.838     0.907     1.135     0.559 
## sibling_count5+               0.012     0.015    -0.017     0.041     0.804    36.121     0.427     0.997     0.525 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.024 
## Residual~~Residual                     0.165 
## ICC|mother_pidlink                     0.125 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-50" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-12" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-51" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.183     0.039     0.107     0.259     4.709    10.815     0.001    10.394     0.925 
## count_birth_order2/2          0.026     0.012     0.002     0.050     2.166    62.461     0.034     0.612     0.399 
## count_birth_order1/3          0.028     0.017    -0.004     0.061     1.694    37.204     0.099     0.968     0.517 
## count_birth_order2/3          0.008     0.016    -0.024     0.040     0.499    33.800     0.621     1.066     0.542 
## count_birth_order3/3          0.028     0.014     0.001     0.054     2.004    90.419     0.048     0.461     0.330 
## count_birth_order1/4          0.025     0.019    -0.012     0.062     1.312    61.031     0.194     0.623     0.403 
## count_birth_order2/4          0.011     0.018    -0.024     0.046     0.605    63.623     0.547     0.603     0.395 
## count_birth_order3/4          0.005     0.018    -0.032     0.041     0.244    50.452     0.809     0.731     0.444 
## count_birth_order4/4          0.015     0.017    -0.018     0.048     0.915   123.226     0.362     0.370     0.282 
## count_birth_order1/5          0.016     0.027    -0.038     0.069     0.570    36.025     0.572     0.999     0.525 
## count_birth_order2/5         -0.007     0.023    -0.051     0.038    -0.294    68.185     0.770     0.571     0.381 
## count_birth_order3/5          0.006     0.026    -0.045     0.057     0.220    33.128     0.827     1.089     0.548 
## count_birth_order4/5          0.001     0.024    -0.047     0.049     0.043    58.628     0.966     0.644     0.412 
## count_birth_order5/5          0.011     0.027    -0.042     0.064     0.420    47.113     0.677     0.776     0.460 
## count_birth_order1/5+         0.009     0.028    -0.045     0.063     0.327    46.491     0.745     0.786     0.463 
## count_birth_order2/5+         0.011     0.029    -0.047     0.068     0.364    24.301     0.719     1.555     0.637 
## count_birth_order3/5+         0.002     0.028    -0.052     0.057     0.087    24.182     0.931     1.565     0.639 
## count_birth_order4/5+         0.007     0.021    -0.034     0.048     0.327   136.801     0.744     0.345     0.267 
## count_birth_order5/5+         0.034     0.026    -0.017     0.085     1.314    40.829     0.196     0.885     0.494 
## count_birth_order5+/5+        0.039     0.019     0.001     0.076     2.030    74.186     0.046     0.534     0.365 
## poly(age, 3, raw = TRUE)1     0.045     0.004     0.038     0.052    12.502    11.868     0.000     6.741     0.888 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.001    -8.758    14.519     0.000     3.702     0.812 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     5.371    17.553     0.000     2.522     0.744 
## male                         -0.002     0.007    -0.016     0.013    -0.233    32.239     0.817     1.120     0.555 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.023 
## Residual~~Residual                     0.165 
## ICC|mother_pidlink                     0.123 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-51" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-12" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.296       10   90.336    1.000  500.890 
##   2 vs 3:   -0.307        4   36.053    1.000 1138.932 
##   3 vs 4:    0.836        1   21.870    0.371    0.873</code></pre>
</div>
</div>
</div>
</div>
<div id="work" class="section level2 tabset">
<h2>Work</h2>
<div id="income-last-month-log---z-standardized" class="section level3 tabset">
<h3>Income Last Month (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_month_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-13" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-13" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-52" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.815     0.121    -1.051    -0.578    -6.750     9.439     0.000    41.522     0.980 
## poly(age, 3, raw = TRUE)1     0.066     0.014     0.038     0.094     4.630     9.569     0.001    32.142     0.975 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.002    -0.000    -2.481     9.896     0.033    20.576     0.961 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.735    10.065     0.479    17.395     0.954 
## male                          0.148     0.025     0.100     0.197     6.028    13.297     0.000     4.640     0.844 
## sibling_count3                0.004     0.022    -0.039     0.047     0.187    31.250     0.853     1.158     0.564 
## sibling_count4               -0.011     0.020    -0.050     0.029    -0.537   120.997     0.593     0.375     0.284 
## sibling_count5               -0.023     0.029    -0.080     0.035    -0.777    35.852     0.442     1.004     0.527 
## sibling_count5+              -0.013     0.028    -0.068     0.042    -0.480    34.300     0.635     1.050     0.538 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.091 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.104 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-52" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-13" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-53" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.817     0.121    -1.054    -0.580    -6.744     9.522     0.000    34.987     0.977 
## birth_order                   0.001     0.004    -0.007     0.010     0.247   116.960     0.805     0.384     0.289 
## poly(age, 3, raw = TRUE)1     0.066     0.014     0.038     0.094     4.637     9.573     0.001    31.908     0.974 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.002    -0.000    -2.487     9.901     0.032    20.476     0.961 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.739    10.069     0.477    17.326     0.954 
## male                          0.148     0.025     0.100     0.197     6.028    13.298     0.000     4.639     0.844 
## sibling_count3                0.004     0.022    -0.040     0.047     0.162    30.669     0.873     1.182     0.569 
## sibling_count4               -0.012     0.021    -0.052     0.029    -0.572   116.132     0.569     0.386     0.290 
## sibling_count5               -0.024     0.030    -0.082     0.034    -0.815    38.080     0.420     0.946     0.511 
## sibling_count5+              -0.016     0.029    -0.073     0.041    -0.546    42.312     0.588     0.856     0.485 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.091 
## Residual~~Residual                     0.785 
## ICC|mother_pidlink                     0.104 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-53" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-13" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-54" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.812     0.119    -1.046    -0.578    -6.797     9.630     0.000    29.085     0.972 
## birth_order_nonlinear2       -0.004     0.020    -0.044     0.035    -0.218    32.966     0.829     1.094     0.549 
## birth_order_nonlinear3        0.002     0.021    -0.040     0.044     0.102    51.739     0.919     0.715     0.438 
## birth_order_nonlinear4       -0.002     0.027    -0.055     0.051    -0.078    42.992     0.938     0.843     0.481 
## birth_order_nonlinear5       -0.006     0.035    -0.075     0.063    -0.175    48.265     0.862     0.760     0.454 
## birth_order_nonlinear5+      -0.004     0.038    -0.079     0.070    -0.113    82.941     0.911     0.491     0.345 
## poly(age, 3, raw = TRUE)1     0.066     0.014     0.039     0.093     4.706     9.660     0.001    27.746     0.971 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.002    -0.000    -2.523    10.078     0.030    17.185     0.953 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.727    10.319     0.483    14.124     0.944 
## male                          0.148     0.027     0.096     0.201     5.517    12.702     0.000     5.319     0.862 
## sibling_count3                0.003     0.022    -0.040     0.046     0.144    39.624     0.886     0.911     0.501 
## sibling_count4               -0.012     0.022    -0.055     0.030    -0.559   128.615     0.577     0.360     0.276 
## sibling_count5               -0.027     0.031    -0.089     0.034    -0.867    36.851     0.391     0.977     0.520 
## sibling_count5+              -0.015     0.030    -0.073     0.043    -0.515    50.850     0.609     0.726     0.442 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.090 
## Residual~~Residual                     0.786 
## ICC|mother_pidlink                     0.103 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-54" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-13" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-55" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.804     0.121    -1.041    -0.568    -6.666     9.812     0.000    22.663     0.964 
## count_birth_order2/2         -0.015     0.030    -0.073     0.043    -0.514    35.418     0.611     1.016     0.530 
## count_birth_order1/3         -0.015     0.032    -0.078     0.048    -0.463    70.892     0.645     0.554     0.374 
## count_birth_order2/3         -0.008     0.036    -0.079     0.062    -0.227    31.837     0.822     1.135     0.559 
## count_birth_order3/3         -0.003     0.035    -0.073     0.066    -0.090    32.996     0.929     1.093     0.549 
## count_birth_order1/4         -0.046     0.040    -0.125     0.033    -1.140    68.281     0.258     0.570     0.381 
## count_birth_order2/4         -0.028     0.037    -0.101     0.045    -0.752    77.968     0.454     0.515     0.356 
## count_birth_order3/4         -0.013     0.043    -0.097     0.070    -0.312    36.421     0.757     0.988     0.523 
## count_birth_order4/4         -0.018     0.045    -0.107     0.071    -0.404    31.895     0.689     1.133     0.558 
## count_birth_order1/5         -0.041     0.052    -0.144     0.062    -0.783    66.191     0.436     0.584     0.387 
## count_birth_order2/5         -0.039     0.059    -0.154     0.077    -0.656    29.531     0.517     1.232     0.580 
## count_birth_order3/5         -0.048     0.062    -0.168     0.073    -0.777    25.013     0.444     1.499     0.628 
## count_birth_order4/5         -0.035     0.048    -0.129     0.058    -0.740   131.171     0.461     0.355     0.273 
## count_birth_order5/5         -0.046     0.076    -0.196     0.104    -0.603    20.113     0.553     2.021     0.698 
## count_birth_order1/5+        -0.043     0.061    -0.163     0.077    -0.699    40.159     0.488     0.899     0.498 
## count_birth_order2/5+        -0.058     0.058    -0.170     0.055    -1.002    32.874     0.324     1.097     0.550 
## count_birth_order3/5+        -0.025     0.051    -0.125     0.074    -0.500    43.788     0.619     0.829     0.477 
## count_birth_order4/5+        -0.022     0.051    -0.122     0.078    -0.426    50.127     0.672     0.735     0.445 
## count_birth_order5/5+        -0.027     0.045    -0.116     0.062    -0.600   234.173     0.549     0.244     0.203 
## count_birth_order5+/5+       -0.025     0.048    -0.118     0.069    -0.518    33.297     0.608     1.083     0.546 
## poly(age, 3, raw = TRUE)1     0.066     0.014     0.038     0.094     4.625     9.735     0.001    24.964     0.968 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.002    -0.000    -2.406    10.178     0.037    15.762     0.949 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.642    10.450     0.535    12.896     0.939 
## male                          0.147     0.028     0.092     0.203     5.175    12.528     0.000     5.560     0.867 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.089 
## Residual~~Residual                     0.786 
## ICC|mother_pidlink                     0.101 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-55" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-13" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.388       10   90.337    0.949  500.243 
##   2 vs 3:    0.382        4   36.053    0.820 1138.191 
##   3 vs 4:    0.051        1   45.777    0.822    0.411</code></pre>
</div>
</div>
</div>
<div id="income-last-year-log---z-standardized" class="section level3 tabset">
<h3>Income last year (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_year_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-14" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-14" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-56" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.166     0.105    -1.372    -0.959   -11.067     9.474     0.000    38.437     0.979 
## poly(age, 3, raw = TRUE)1     0.090     0.013     0.065     0.116     6.904     9.553     0.000    33.021     0.975 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.002    -0.001    -3.290     9.870     0.008    21.173     0.962 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.900    10.117     0.389    16.600     0.952 
## male                          0.136     0.025     0.086     0.186     5.351    12.035     0.000     6.394     0.883 
## sibling_count3                0.002     0.022    -0.041     0.046     0.101    22.994     0.921     1.671     0.654 
## sibling_count4               -0.001     0.027    -0.054     0.051    -0.055    21.297     0.957     1.858     0.679 
## sibling_count5               -0.035     0.026    -0.086     0.016    -1.347    40.371     0.186     0.895     0.496 
## sibling_count5+              -0.018     0.027    -0.071     0.035    -0.670    29.357     0.508     1.241     0.581 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.085 
## Residual~~Residual                     0.632 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-56" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-14" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-57" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.163     0.102    -1.363    -0.962   -11.363     9.605     0.000    30.220     0.973 
## birth_order                  -0.001     0.005    -0.010     0.008    -0.300    39.435     0.766     0.915     0.502 
## poly(age, 3, raw = TRUE)1     0.090     0.013     0.065     0.116     6.945     9.565     0.000    32.362     0.975 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.002    -0.001    -3.302     9.881     0.008    20.922     0.961 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.901    10.126     0.389    16.467     0.951 
## male                          0.136     0.025     0.086     0.186     5.352    12.036     0.000     6.392     0.883 
## sibling_count3                0.003     0.022    -0.041     0.047     0.130    23.396     0.898     1.633     0.649 
## sibling_count4               -0.000     0.026    -0.052     0.051    -0.012    22.799     0.990     1.690     0.657 
## sibling_count5               -0.033     0.026    -0.084     0.017    -1.289    45.618     0.204     0.799     0.467 
## sibling_count5+              -0.015     0.028    -0.069     0.040    -0.530    36.202     0.599     0.994     0.524 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.085 
## Residual~~Residual                     0.632 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-57" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-14" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-58" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.157     0.101    -1.356    -0.958   -11.410     9.724     0.000    25.362     0.968 
## birth_order_nonlinear2       -0.010     0.020    -0.049     0.030    -0.472    24.349     0.641     1.551     0.637 
## birth_order_nonlinear3       -0.007     0.023    -0.052     0.039    -0.290    25.451     0.774     1.467     0.623 
## birth_order_nonlinear4       -0.010     0.025    -0.060     0.040    -0.401    35.192     0.691     1.023     0.532 
## birth_order_nonlinear5       -0.024     0.032    -0.087     0.040    -0.731    43.861     0.468     0.828     0.476 
## birth_order_nonlinear5+      -0.017     0.043    -0.100     0.067    -0.397    28.009     0.695     1.309     0.595 
## poly(age, 3, raw = TRUE)1     0.090     0.013     0.065     0.115     6.952     9.636     0.000    28.794     0.972 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.002    -0.001    -3.288    10.024     0.008    18.068     0.956 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.860    10.371     0.409    13.616     0.942 
## male                          0.136     0.027     0.082     0.189     4.933    11.720     0.000     7.084     0.893 
## sibling_count3                0.004     0.022    -0.040     0.048     0.171    26.789     0.866     1.379     0.608 
## sibling_count4               -0.001     0.026    -0.052     0.051    -0.019    26.632     0.985     1.388     0.610 
## sibling_count5               -0.034     0.027    -0.087     0.018    -1.278    50.109     0.207     0.736     0.446 
## sibling_count5+              -0.013     0.030    -0.071     0.045    -0.433    33.461     0.668     1.077     0.545 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.633 
## ICC|mother_pidlink                     0.117 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-58" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-160-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-14" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-59" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -1.157     0.104    -1.361    -0.954   -11.135     9.908     0.000    20.316     0.960 
## count_birth_order2/2         -0.010     0.028    -0.065     0.045    -0.344    29.511     0.733     1.233     0.580 
## count_birth_order1/3         -0.007     0.030    -0.066     0.052    -0.249    57.370     0.805     0.656     0.416 
## count_birth_order2/3         -0.010     0.033    -0.074     0.055    -0.296    31.056     0.769     1.166     0.565 
## count_birth_order3/3         -0.009     0.039    -0.087     0.068    -0.233    19.300     0.818     2.153     0.711 
## count_birth_order1/4         -0.025     0.042    -0.107     0.057    -0.598    34.412     0.554     1.047     0.538 
## count_birth_order2/4         -0.026     0.041    -0.107     0.054    -0.639    29.156     0.528     1.250     0.583 
## count_birth_order3/4         -0.008     0.047    -0.101     0.084    -0.170    20.599     0.866     1.950     0.690 
## count_birth_order4/4         -0.006     0.049    -0.101     0.090    -0.120    20.292     0.905     1.994     0.695 
## count_birth_order1/5         -0.037     0.047    -0.129     0.056    -0.777    67.425     0.440     0.576     0.383 
## count_birth_order2/5         -0.059     0.051    -0.159     0.041    -1.162    34.651     0.253     1.039     0.536 
## count_birth_order3/5         -0.054     0.053    -0.158     0.049    -1.026    29.236     0.313     1.246     0.582 
## count_birth_order4/5         -0.054     0.055    -0.161     0.054    -0.982    31.151     0.334     1.162     0.565 
## count_birth_order5/5         -0.058     0.069    -0.193     0.077    -0.845    20.358     0.408     1.984     0.694 
## count_birth_order1/5+        -0.035     0.055    -0.142     0.073    -0.629    42.132     0.533     0.859     0.486 
## count_birth_order2/5+        -0.053     0.048    -0.146     0.041    -1.107    48.371     0.274     0.759     0.453 
## count_birth_order3/5+        -0.018     0.052    -0.120     0.085    -0.343    27.003     0.734     1.366     0.605 
## count_birth_order4/5+        -0.029     0.051    -0.128     0.070    -0.572    33.469     0.571     1.077     0.545 
## count_birth_order5/5+        -0.050     0.050    -0.148     0.048    -1.000    43.634     0.323     0.832     0.478 
## count_birth_order5+/5+       -0.032     0.049    -0.129     0.064    -0.663    23.041     0.514     1.667     0.654 
## poly(age, 3, raw = TRUE)1     0.090     0.013     0.065     0.116     6.856     9.708     0.000    25.911     0.969 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.002    -0.001    -3.191    10.136     0.009    16.324     0.951 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.793    10.568     0.445    11.960     0.934 
## male                          0.134     0.028     0.078     0.190     4.698    11.749     0.001     7.015     0.892 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.082 
## Residual~~Residual                     0.636 
## ICC|mother_pidlink                     0.115 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-59" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-14" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:    0.277       10   90.337    0.985  500.220 
##   2 vs 3:    0.281        4   36.053    0.889 1139.214 
##   3 vs 4:    0.091        1   20.725    0.766    0.938</code></pre>
</div>
</div>
</div>
<div id="self-employment---non-standardized" class="section level3 tabset">
<h3>Self-Employment - non standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = Self_employed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-15" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-15" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-60" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.340     0.080    -0.498    -0.183    -4.236     9.218     0.002    82.907     0.990 
## poly(age, 3, raw = TRUE)1     0.032     0.007     0.017     0.046     4.229     9.456     0.002    39.939     0.979 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.890     9.772     0.089    23.808     0.966 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.203    10.098     0.256    16.880     0.953 
## male                         -0.004     0.008    -0.019     0.011    -0.536    24.345     0.597     1.551     0.637 
## sibling_count3                0.004     0.010    -0.015     0.023     0.386    41.458     0.701     0.872     0.490 
## sibling_count4               -0.003     0.012    -0.026     0.020    -0.257    34.466     0.799     1.045     0.537 
## sibling_count5                0.005     0.014    -0.022     0.031     0.341    43.285     0.735     0.838     0.479 
## sibling_count5+               0.005     0.013    -0.020     0.030     0.411    46.560     0.683     0.785     0.462 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.168 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-60" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-15" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-61" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.341     0.079    -0.496    -0.186    -4.312     9.270     0.002    67.169     0.988 
## birth_order                   0.000     0.003    -0.005     0.005     0.136    28.457     0.893     1.285     0.590 
## poly(age, 3, raw = TRUE)1     0.032     0.007     0.017     0.046     4.252     9.464     0.002    39.288     0.979 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.898     9.778     0.088    23.617     0.966 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.207    10.103     0.255    16.803     0.952 
## male                         -0.004     0.008    -0.019     0.011    -0.536    24.382     0.597     1.548     0.636 
## sibling_count3                0.004     0.009    -0.015     0.022     0.382    51.163     0.704     0.722     0.441 
## sibling_count4               -0.003     0.012    -0.026     0.020    -0.285    38.321     0.778     0.940     0.510 
## sibling_count5                0.004     0.014    -0.024     0.032     0.294    37.268     0.771     0.966     0.517 
## sibling_count5+               0.004     0.013    -0.021     0.030     0.341    73.214     0.734     0.540     0.368 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.168 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-61" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-15" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-62" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.344     0.079    -0.500    -0.189    -4.344     9.312     0.002    58.118     0.986 
## birth_order_nonlinear2        0.004     0.009    -0.015     0.022     0.406    32.584     0.687     1.108     0.552 
## birth_order_nonlinear3        0.006     0.010    -0.013     0.024     0.605    69.702     0.547     0.561     0.377 
## birth_order_nonlinear4        0.007     0.012    -0.017     0.030     0.543    55.527     0.589     0.674     0.423 
## birth_order_nonlinear5        0.005     0.015    -0.024     0.034     0.360    95.225     0.720     0.444     0.322 
## birth_order_nonlinear5+       0.001     0.022    -0.042     0.044     0.039    28.596     0.969     1.278     0.589 
## poly(age, 3, raw = TRUE)1     0.032     0.008     0.017     0.047     4.229     9.497     0.002    36.682     0.978 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.932     9.833     0.083    22.094     0.963 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.261    10.164     0.236    15.951     0.950 
## male                         -0.005     0.008    -0.020     0.010    -0.639    25.549     0.528     1.460     0.622 
## sibling_count3                0.004     0.011    -0.017     0.024     0.331    38.044     0.742     0.947     0.511 
## sibling_count4               -0.006     0.012    -0.029     0.017    -0.510    55.681     0.612     0.672     0.422 
## sibling_count5                0.005     0.014    -0.023     0.032     0.336    56.047     0.738     0.669     0.421 
## sibling_count5+               0.005     0.013    -0.021     0.031     0.397    78.446     0.693     0.512     0.355 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.167 
## ICC|mother_pidlink                     0.140 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-62" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-15" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-63" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.344     0.078    -0.497    -0.192    -4.427     9.423     0.001    42.999     0.981 
## count_birth_order2/2          0.005     0.014    -0.023     0.033     0.337    30.978     0.738     1.169     0.566 
## count_birth_order1/3          0.005     0.014    -0.023     0.033     0.361   113.574     0.718     0.392     0.294 
## count_birth_order2/3          0.008     0.015    -0.021     0.037     0.553    62.194     0.582     0.614     0.399 
## count_birth_order3/3          0.008     0.017    -0.026     0.042     0.454    29.367     0.653     1.240     0.581 
## count_birth_order1/4         -0.006     0.019    -0.043     0.031    -0.302    70.547     0.763     0.556     0.375 
## count_birth_order2/4         -0.003     0.020    -0.042     0.035    -0.176    40.435     0.861     0.893     0.496 
## count_birth_order3/4          0.003     0.020    -0.035     0.041     0.149    41.352     0.883     0.874     0.491 
## count_birth_order4/4          0.002     0.021    -0.039     0.042     0.079    36.073     0.937     0.998     0.525 
## count_birth_order1/5          0.009     0.029    -0.048     0.065     0.298    31.863     0.768     1.134     0.558 
## count_birth_order2/5          0.018     0.028    -0.037     0.074     0.651    27.664     0.521     1.328     0.598 
## count_birth_order3/5          0.009     0.021    -0.033     0.050     0.410   144.539     0.682     0.333     0.260 
## count_birth_order4/5          0.013     0.028    -0.041     0.067     0.474    34.773     0.639     1.036     0.535 
## count_birth_order5/5          0.003     0.025    -0.047     0.053     0.131    76.543     0.896     0.522     0.359 
## count_birth_order1/5+         0.011     0.027    -0.042     0.064     0.419    55.535     0.677     0.674     0.423 
## count_birth_order2/5+         0.006     0.028    -0.049     0.061     0.215    29.362     0.832     1.240     0.581 
## count_birth_order3/5+         0.019     0.022    -0.024     0.061     0.867    80.080     0.389     0.504     0.351 
## count_birth_order4/5+         0.012     0.025    -0.037     0.062     0.487    38.811     0.629     0.929     0.506 
## count_birth_order5/5+         0.015     0.026    -0.037     0.066     0.557    42.390     0.580     0.855     0.485 
## count_birth_order5+/5+        0.004     0.021    -0.037     0.044     0.185    51.024     0.854     0.724     0.441 
## poly(age, 3, raw = TRUE)1     0.032     0.007     0.017     0.047     4.307     9.596     0.002    30.702     0.973 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -1.972     9.998     0.077    18.528     0.957 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.292    10.406     0.224    13.281     0.940 
## male                         -0.006     0.007    -0.020     0.009    -0.769    33.625     0.447     1.072     0.544 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.167 
## ICC|mother_pidlink                     0.138 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-63" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-15" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.279       10   90.336    1.000  500.932 
##   2 vs 3:   -0.278        4   36.053    1.000 1139.049 
##   3 vs 4:    0.018        1   16.870    0.894    1.287</code></pre>
</div>
</div>
</div>
</div>
<div id="smoking-behaviour" class="section level2 tabset">
<h2>Smoking Behaviour</h2>
<div id="ever_smoked" class="section level3 tabset">
<h3>ever_smoked</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = ever_smoked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-16" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-16" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-64" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.391     0.021    -0.432    -0.350   -18.832    11.166     0.000     8.782     0.912 
## poly(age, 3, raw = TRUE)1     0.024     0.002     0.020     0.028    12.461    14.544     0.000     3.687     0.811 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -6.204    21.375     0.000     1.848     0.678 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.764    30.327     0.010     1.197     0.572 
## male                          0.661     0.005     0.651     0.671   128.108    37.297     0.000     0.966     0.516 
## sibling_count3               -0.004     0.007    -0.019     0.010    -0.612    47.957     0.543     0.764     0.455 
## sibling_count4               -0.004     0.010    -0.023     0.015    -0.389    26.406     0.700     1.403     0.612 
## sibling_count5                0.008     0.009    -0.009     0.025     0.959   151.125     0.339     0.323     0.254 
## sibling_count5+               0.009     0.010    -0.010     0.029     0.951    39.087     0.347     0.923     0.505 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.133 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-64" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-16" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-65" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.394     0.021    -0.436    -0.352   -18.327    11.464     0.000     7.774     0.902 
## birth_order                   0.001     0.002    -0.002     0.004     0.774   116.148     0.441     0.386     0.290 
## poly(age, 3, raw = TRUE)1     0.024     0.002     0.020     0.028    12.417    14.497     0.000     3.715     0.812 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -6.203    21.228     0.000     1.866     0.680 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.775    30.073     0.009     1.208     0.574 
## male                          0.661     0.005     0.651     0.671   128.134    37.327     0.000     0.965     0.516 
## sibling_count3               -0.005     0.007    -0.019     0.009    -0.691    49.262     0.493     0.747     0.449 
## sibling_count4               -0.005     0.010    -0.024     0.014    -0.495    27.818     0.624     1.319     0.597 
## sibling_count5                0.007     0.009    -0.011     0.025     0.766   126.710     0.445     0.363     0.278 
## sibling_count5+               0.007     0.010    -0.014     0.027     0.634    46.231     0.529     0.790     0.464 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.133 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-65" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-16" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-66" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.395     0.020    -0.434    -0.356   -19.811    12.591     0.000     5.470     0.865 
## birth_order_nonlinear2        0.007     0.006    -0.005     0.020     1.122    53.362     0.267     0.697     0.432 
## birth_order_nonlinear3        0.007     0.008    -0.009     0.023     0.898    39.634     0.375     0.910     0.501 
## birth_order_nonlinear4        0.005     0.011    -0.016     0.026     0.448    26.782     0.658     1.379     0.608 
## birth_order_nonlinear5        0.009     0.013    -0.017     0.035     0.677    37.966     0.503     0.949     0.512 
## birth_order_nonlinear5+       0.011     0.016    -0.021     0.043     0.662    30.235     0.513     1.201     0.573 
## poly(age, 3, raw = TRUE)1     0.024     0.002     0.020     0.028    12.619    15.870     0.000     3.050     0.779 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -6.017    23.947     0.000     1.584     0.642 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.469    31.820     0.019     1.136     0.559 
## male                          0.659     0.005     0.648     0.670   120.889    34.472     0.000     1.045     0.537 
## sibling_count3               -0.006     0.008    -0.020     0.009    -0.733    52.520     0.467     0.706     0.435 
## sibling_count4               -0.005     0.011    -0.027     0.016    -0.494    23.465     0.626     1.627     0.648 
## sibling_count5                0.007     0.010    -0.011     0.026     0.767   121.571     0.445     0.374     0.284 
## sibling_count5+               0.007     0.012    -0.016     0.031     0.608    30.348     0.548     1.196     0.572 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.134 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-66" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-16" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-67" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.397     0.019    -0.434    -0.360   -21.094    14.992     0.000     3.440     0.800 
## count_birth_order2/2          0.013     0.011    -0.008     0.034     1.233    32.180     0.227     1.122     0.556 
## count_birth_order1/3          0.002     0.012    -0.022     0.025     0.153    53.664     0.879     0.694     0.430 
## count_birth_order2/3          0.001     0.012    -0.023     0.026     0.093    36.316     0.926     0.991     0.523 
## count_birth_order3/3          0.007     0.014    -0.020     0.034     0.498    25.183     0.623     1.486     0.626 
## count_birth_order1/4         -0.004     0.019    -0.040     0.033    -0.201    23.601     0.842     1.615     0.646 
## count_birth_order2/4          0.010     0.015    -0.019     0.039     0.672    42.668     0.505     0.849     0.483 
## count_birth_order3/4          0.005     0.013    -0.020     0.031     0.417    88.706     0.677     0.467     0.333 
## count_birth_order4/4          0.002     0.016    -0.029     0.033     0.123    34.534     0.903     1.043     0.537 
## count_birth_order1/5          0.014     0.018    -0.021     0.050     0.792    86.300     0.430     0.477     0.338 
## count_birth_order2/5          0.018     0.020    -0.020     0.057     0.945    39.353     0.350     0.917     0.503 
## count_birth_order3/5          0.021     0.017    -0.013     0.054     1.203    78.852     0.233     0.510     0.354 
## count_birth_order4/5          0.010     0.020    -0.030     0.051     0.512    38.665     0.611     0.932     0.507 
## count_birth_order5/5          0.024     0.020    -0.015     0.063     1.211    66.341     0.230     0.583     0.387 
## count_birth_order1/5+         0.035     0.022    -0.007     0.078     1.629    42.296     0.111     0.856     0.485 
## count_birth_order2/5+         0.019     0.018    -0.016     0.054     1.070    72.092     0.288     0.546     0.371 
## count_birth_order3/5+         0.015     0.018    -0.021     0.051     0.818    42.881     0.418     0.845     0.482 
## count_birth_order4/5+         0.017     0.018    -0.018     0.053     0.959    53.438     0.342     0.696     0.431 
## count_birth_order5/5+         0.010     0.021    -0.031     0.052     0.491    32.356     0.627     1.116     0.554 
## count_birth_order5+/5+        0.020     0.019    -0.018     0.059     1.050    23.119     0.305     1.659     0.653 
## poly(age, 3, raw = TRUE)1     0.024     0.002     0.020     0.027    12.657    17.763     0.000     2.470     0.740 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -5.755    26.186     0.000     1.417     0.615 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.207    29.500     0.035     1.234     0.580 
## male                          0.656     0.006     0.644     0.668   107.281    26.772     0.000     1.380     0.608 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.135 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-67" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-16" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.547       10   90.336    1.000  500.881 
##   2 vs 3:   -0.569        4   36.053    1.000 1139.909 
##   3 vs 4:    0.584        1   47.581    0.448    0.398</code></pre>
</div>
</div>
</div>
<div id="still_smoking" class="section level3 tabset">
<h3>still_smoking</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = still_smoking)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="parental-full-sibling-order-17" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-17" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-68" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.702     0.044     0.617     0.787    16.132     9.315     0.000    57.721     0.986 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.005     0.010     0.538     9.739     0.603    24.844     0.967 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.651    10.553     0.529    12.068     0.935 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.322    11.932     0.753     6.603     0.886 
## male                          0.211     0.019     0.173     0.248    11.030     9.496     0.000    36.763     0.978 
## sibling_count3               -0.002     0.006    -0.013     0.010    -0.282    72.099     0.779     0.546     0.371 
## sibling_count4                0.001     0.007    -0.013     0.014     0.084    56.296     0.933     0.666     0.420 
## sibling_count5                0.003     0.011    -0.018     0.024     0.272    22.435     0.788     1.728     0.662 
## sibling_count5+               0.001     0.008    -0.015     0.017     0.106    49.950     0.916     0.738     0.446 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.014 
## Residual~~Residual                     0.068 
## ICC|mother_pidlink                     0.167 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-68" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-17" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-69" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.700     0.043     0.616     0.785    16.205     9.384     0.000    47.401     0.983 
## birth_order                   0.001     0.002    -0.003     0.004     0.452    25.416     0.655     1.470     0.624 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.005     0.010     0.553     9.753     0.593    24.398     0.967 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.663    10.571     0.521    11.941     0.934 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.332    11.959     0.746     6.548     0.885 
## male                          0.211     0.019     0.173     0.248    11.030     9.496     0.000    36.763     0.978 
## sibling_count3               -0.002     0.006    -0.014     0.010    -0.330    54.223     0.743     0.687     0.428 
## sibling_count4               -0.000     0.007    -0.014     0.014    -0.014    54.709     0.989     0.682     0.426 
## sibling_count5                0.002     0.011    -0.020     0.024     0.174    20.702     0.864     1.936     0.688 
## sibling_count5+              -0.001     0.009    -0.019     0.017    -0.106    41.419     0.916     0.873     0.490 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.014 
## Residual~~Residual                     0.068 
## ICC|mother_pidlink                     0.167 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-69" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-17" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-70" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.702     0.045     0.613     0.790    15.518     9.407     0.000    44.759     0.982 
## birth_order_nonlinear2        0.000     0.006    -0.012     0.012     0.027    29.587     0.979     1.230     0.579 
## birth_order_nonlinear3        0.002     0.008    -0.014     0.017     0.204    22.712     0.840     1.699     0.658 
## birth_order_nonlinear4        0.000     0.008    -0.015     0.016     0.060    52.639     0.952     0.705     0.435 
## birth_order_nonlinear5        0.009     0.010    -0.010     0.029     0.949    69.363     0.346     0.563     0.378 
## birth_order_nonlinear5+       0.007     0.014    -0.021     0.035     0.499    27.270     0.622     1.350     0.603 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.005     0.010     0.542     9.817     0.600    22.529     0.964 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.681    10.737     0.511    10.842     0.928 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.385    12.316     0.707     5.890     0.874 
## male                          0.211     0.019     0.174     0.248    11.097     9.538     0.000    33.966     0.976 
## sibling_count3               -0.002     0.007    -0.015     0.011    -0.282    44.837     0.779     0.812     0.471 
## sibling_count4                0.000     0.008    -0.016     0.016     0.010    38.298     0.992     0.941     0.510 
## sibling_count5                0.001     0.011    -0.021     0.024     0.103    23.274     0.919     1.644     0.651 
## sibling_count5+              -0.002     0.009    -0.019     0.016    -0.169    69.940     0.866     0.559     0.376 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.014 
## Residual~~Residual                     0.068 
## ICC|mother_pidlink                     0.167 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-70" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-187-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-17" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-71" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink), REML = FALSE))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.700     0.046     0.611     0.789    15.378     9.524     0.000    34.831     0.977 
## count_birth_order2/2          0.002     0.009    -0.015     0.020     0.258    33.663     0.798     1.071     0.543 
## count_birth_order1/3         -0.003     0.011    -0.025     0.020    -0.220    31.929     0.827     1.132     0.558 
## count_birth_order2/3         -0.000     0.009    -0.017     0.017    -0.005   125.932     0.996     0.365     0.279 
## count_birth_order3/3          0.003     0.009    -0.015     0.021     0.301    68.946     0.764     0.566     0.379 
## count_birth_order1/4          0.009     0.012    -0.014     0.033     0.777    84.872     0.439     0.483     0.341 
## count_birth_order2/4         -0.000     0.014    -0.028     0.027    -0.033    27.076     0.974     1.362     0.605 
## count_birth_order3/4          0.001     0.016    -0.029     0.032     0.086    21.025     0.932     1.892     0.683 
## count_birth_order4/4         -0.000     0.012    -0.023     0.023    -0.021    69.511     0.984     0.562     0.377 
## count_birth_order1/5          0.005     0.020    -0.034     0.044     0.274    25.316     0.786     1.477     0.625 
## count_birth_order2/5          0.008     0.018    -0.028     0.043     0.423    28.576     0.675     1.279     0.589 
## count_birth_order3/5          0.001     0.018    -0.034     0.036     0.063    28.077     0.951     1.305     0.594 
## count_birth_order4/5          0.004     0.017    -0.030     0.038     0.240    39.504     0.811     0.913     0.502 
## count_birth_order5/5          0.007     0.020    -0.033     0.047     0.343    26.980     0.734     1.367     0.606 
## count_birth_order1/5+         0.003     0.019    -0.035     0.041     0.154    35.477     0.879     1.015     0.529 
## count_birth_order2/5+        -0.002     0.017    -0.035     0.032    -0.100    37.115     0.921     0.970     0.518 
## count_birth_order3/5+         0.004     0.017    -0.029     0.038     0.259    29.096     0.797     1.253     0.584 
## count_birth_order4/5+        -0.001     0.015    -0.030     0.028    -0.068    71.958     0.946     0.547     0.371 
## count_birth_order5/5+         0.010     0.021    -0.031     0.051     0.458    21.354     0.651     1.851     0.678 
## count_birth_order5+/5+        0.008     0.015    -0.021     0.036     0.522    34.112     0.605     1.056     0.540 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.005     0.010     0.566     9.989     0.584    18.685     0.957 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.731    11.187     0.480     8.702     0.911 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.439    13.248     0.668     4.690     0.846 
## male                          0.211     0.019     0.173     0.249    10.949     9.568     0.000    32.174     0.975 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.014 
## Residual~~Residual                     0.068 
## ICC|mother_pidlink                     0.167 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-71" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots, REML = FALSE)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_files/figure-html/unnamed-chunk-189-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-17" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D3 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2:   -0.689       10   90.336    1.000  500.711 
##   2 vs 3:   -0.691        4   36.053    1.000 1137.806 
##   3 vs 4:    0.194        1   15.694    0.665    1.469</code></pre>
</div>
</div>
</div>
</div>
<div id="multiplot-linear-birth-order-effect" class="section level2 tabset">
<h2>Multiplot Linear Birth Order Effect</h2>
<div id="models" class="section level3 tabset">
<h3>Models</h3>
<pre class="r"><code>Intelligence = lmer(g_factor_2015_old ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                        sibling_count_genes +
               (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
<pre class="r"><code>`Educational Attainment` = lmer(years_of_education_z ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                                  sibling_count_genes + (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
<pre class="r"><code>Extraversion = lmer(big5_ext ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                                  sibling_count_genes + (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
<pre class="r"><code>Neuroticism = lmer(big5_neu ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                                  sibling_count_genes + (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
<pre class="r"><code>Conscientiousness = lmer(big5_con ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                                  sibling_count_genes + (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
<pre class="r"><code>Agreeableness = lmer(big5_agree ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                                  sibling_count_genes + (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
<pre class="r"><code>Openness = lmer(big5_open ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                                  sibling_count_genes + (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
<pre class="r"><code>RiskA = lmer(riskA ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                                  sibling_count_genes + (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
<pre class="r"><code>RiskB = lmer(riskB ~ birthorder_genes + poly(age, 3, raw = TRUE) + male +
                                  sibling_count_genes + (1 | mother_pidlink),
                   data = birthorder)</code></pre>
<pre><code>## Error in list2env(data): names(x) must be a character vector of the same length as x</code></pre>
</div>
<div id="plot" class="section level3 active">
<h3>Plot</h3>
<pre class="r"><code>x = multiplot(Intelligence, `Educational Attainment`, Agreeableness, Conscientiousness, Extraversion, Neuroticism, Openness, RiskA, RiskB, intercept = FALSE, coefficients = c(&quot;birthorder_genes&quot;, &quot;sibling_count_genes&quot;), plot = F)</code></pre>
<pre><code>## Error in multiplot(Intelligence, `Educational Attainment`, Agreeableness, : object &#39;Intelligence&#39; not found</code></pre>
<pre class="r"><code>x = data.frame(x)</code></pre>
<pre><code>## Error in data.frame(x): object &#39;x&#39; not found</code></pre>
<pre class="r"><code>x$Model = ifelse(x$Model == &quot;`Educational Attainment`&quot;, &quot;Educational Attainment&quot;, x$Model)</code></pre>
<pre><code>## Error in ifelse(x$Model == &quot;`Educational Attainment`&quot;, &quot;Educational Attainment&quot;, : object &#39;x&#39; not found</code></pre>
<pre class="r"><code>x$Model = as.factor(x$Model)</code></pre>
<pre><code>## Error in is.factor(x): object &#39;x&#39; not found</code></pre>
<pre class="r"><code>levels(x$Model)</code></pre>
<pre><code>## Error in levels(x$Model): object &#39;x&#39; not found</code></pre>
<pre class="r"><code>x$Coefficient = ifelse(x$Coefficient == &quot;birthorder_genes&quot;, &quot;Birth order&quot;, &quot;Sibship size&quot;)</code></pre>
<pre><code>## Error in ifelse(x$Coefficient == &quot;birthorder_genes&quot;, &quot;Birth order&quot;, &quot;Sibship size&quot;): object &#39;x&#39; not found</code></pre>
<pre class="r"><code>ggplot(x, aes(Model, Value)) +
  geom_pointrange(data=x, mapping=aes(x=Model, y=Value, ymin=HighOuter, ymax=LowOuter, color = Coefficient),
                  position = position_dodge(width=0.3), size = 1) +
  scale_colour_brewer(palette = &quot;Set2&quot;) +
  geom_hline(yintercept = 0, size = 1.5)  +
  geom_hline(yintercept = -.1, linetype = &quot;dotted&quot;, size = 1.5) + 
  scale_x_discrete(limits=c(&quot;RiskB&quot;, &quot;RiskA&quot;, &quot;Openness&quot;, &quot;Neuroticism&quot;, &quot;Extraversion&quot;,
                            &quot;Conscientiousness&quot;, &quot;Agreeableness&quot;, &quot;Educational Attainment&quot;,
                            &quot;Intelligence&quot;)) +
  scale_y_continuous(limits = c(-0.1, 0.05), breaks = c(-0.1, -0.05, 0, 0.05)) +
  coord_flip() +
  theme(text = element_text(size=25), axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20)) +
  labs(y = &quot;Linear effect size&quot;, x = &quot;Outcome&quot;)</code></pre>
<pre><code>## Error in ggplot(x, aes(Model, Value)): object &#39;x&#39; not found</code></pre>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiNF9hbmFseXNlc19pbXB1dGVkX2RhdGEiCmF1dGhvcjogIkxhdXJhIEJvdHpldCAmIFJ1YmVuIEFyc2xhbiIKb3V0cHV0OiBodG1sX2RvY3VtZW50CmVkaXRvcl9vcHRpb25zOiAKICBjaHVua19vdXRwdXRfdHlwZTogY29uc29sZQotLS0KIyA8c3BhbiBzdHlsZT0iY29sb3I6I0ZGRDkyRiI+QmlydGggT3JkZXIgRWZmZWN0cyBJbXB1dGVkIERhdGE8L3NwYW4+IHsudGFic2V0fQoKIyMgSGVscGVyCmBgYHtyIGhlbHBlcn0Kc291cmNlKCIwX2hlbHBlcnMuUiIpCm9wdHNfY2h1bmskc2V0KHdhcm5pbmcgPSBGQUxTRSxlcnJvcj1UKQpkZXRhY2goInBhY2thZ2U6bG1lclRlc3QiLCB1bmxvYWQ9VFJVRSkKYGBgCgoKIyMgRnVuY3Rpb25zCgpgYGB7cn0Kb3B0aW9ucyhtYy5jb3Jlcz00KQpuX2ltcHV0YXRpb25zLm1pdG1sID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkaXRlciRtCn0Kbl9pbXB1dGF0aW9ucy5taWRzID0gZnVuY3Rpb24oaW1wcykgewogIGltcHMkbQp9Cm5faW1wdXRhdGlvbnMuYW1lbGlhID0gZnVuY3Rpb24oaW1wcykgewogIGxlbmd0aChpbXBzJGltcHV0YXRpb25zKQp9Cm5faW1wdXRhdGlvbnMgPSBmdW5jdGlvbihpbXBzKSB7IFVzZU1ldGhvZCgibl9pbXB1dGF0aW9ucyIpIH0KCmNvbXBsZXRlLm1pdG1sID0gbWl0bWw6Om1pdG1sQ29tcGxldGUKY29tcGxldGUubWlkcyA9IG1pY2U6OmNvbXBsZXRlCmNvbXBsZXRlID0gZnVuY3Rpb24oLi4uKSB7IFVzZU1ldGhvZCgiY29tcGxldGUiKSB9CgpsaWJyYXJ5KG1pY2UpCmxpYnJhcnkobWljZWFkZHMpCmxpYnJhcnkobWl0bWwpCmBgYAoKCiMjIExvYWQgZGF0YQpgYGB7ciBMb2FkIERhdGF9CmJpcnRob3JkZXIgPSByZWFkUkRTKCJkYXRhL2FsbGRhdGFfYmlydGhvcmRlcl9pX21sLnJkcyIpCmBgYAoKIyMgRGF0YSBwcmVwYXJhdGlvbnMKYGBge3IgZGF0YSBwcmVwYXJhdGlvbnN9CmJpcnRob3JkZXIgPC0gbWlkczJtaXRtbC5saXN0KGJpcnRob3JkZXIpCgojIyBDYWxjdWxhdGUgZ19mYWN0b3JzIChmb3Igbm93IHdpdGggcm93TWVhbnM6IGJldHRlciB0byBydW4gZmFjdG9yIGFuYWx5c2lzIGhlcmUgYXMgd2VsbD8pCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDE1X29sZCA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDE1X29sZCwgbWF0aF8yMDE1X29sZCwgY291bnRfYmFja3dhcmRzLCAgd29yZHNfZGVsYXllZCwgYWRhcHRpdmVfbnVtYmVyaW5nKSkpCn0pCgpiaXJ0aG9yZGVyIDwtIHdpdGhpbihiaXJ0aG9yZGVyLCB7CiAgZ19mYWN0b3JfMjAxNV95b3VuZyA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDE1X3lvdW5nLCBtYXRoXzIwMTVfeW91bmcpKSkKfSkKCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDA3X29sZCA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDA3X29sZCwgbWF0aF8yMDA3X29sZCkpKQp9KQoKYmlydGhvcmRlciA8LSB3aXRoaW4oYmlydGhvcmRlciwgewogIGdfZmFjdG9yXzIwMDdfeW91bmcgPC0gcm93TWVhbnMoc2NhbGUoY2JpbmQocmF2ZW5fMjAwN195b3VuZywgbWF0aF8yMDA3X3lvdW5nKSkpCn0pCgoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lIHRibF9kZi5taXRtbC5saXN0CgojIyMgQmlydGhvcmRlciBhbmQgU2libGluZyBDb3VudAojIGZvciBmYWN0b3IgdmFyaWFibGVzIHdlIGhhdmUgdG8gcm91bmQgYmlydGggb3JkZXIgcG9zaXRpb24gYW5kIGVsaW1pbmF0ZSBhbGwgdW5saWtlbHkgbnVtYmVycyAobmVnYXRpdmUgb25lcykKYmlydGhvcmRlcl9kYXRhID0gYmlydGhvcmRlcltbMV1dCgpiaXJ0aG9yZGVyID0gYmlydGhvcmRlciAlPiUKICBtdXRhdGUoYmlydGhvcmRlcl9nZW5lcyA9IGlmZWxzZShiaXJ0aG9yZGVyX2dlbmVzIDwgMCwgMCwgYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSBpZmVsc2UoYmlydGhvcmRlcl9uYWl2ZSA8IDAsIDAsIGJpcnRob3JkZXJfbmFpdmUpLAogICAgICAgICBiaXJ0aG9yZGVyX2dlbmVzID0gcm91bmQoYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSByb3VuZChiaXJ0aG9yZGVyX25haXZlKSwKICAgICAgICAgc2libGluZ19jb3VudF9nZW5lcyA9IGlmZWxzZShzaWJsaW5nX2NvdW50X2dlbmVzIDwgMCwgMCwgc2libGluZ19jb3VudF9nZW5lcyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmUgPSBpZmVsc2Uoc2libGluZ19jb3VudF9uYWl2ZSA8IDAsIDAsIHNpYmxpbmdfY291bnRfbmFpdmUpLAogICAgICAgICBzaWJsaW5nX2NvdW50X2dlbmVzID0gcm91bmQoc2libGluZ19jb3VudF9nZW5lcyksCiAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmUgPSByb3VuZChzaWJsaW5nX2NvdW50X25haXZlKQogICAgICAgICApCgoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lIAogIG11dGF0ZSgKIyBiaXJ0aG9yZGVyIGFzIGZhY3RvcnMgd2l0aCBsZXZlbHMgb2YgMSwgMiwgMywgNCwgNSwgNSsKICAgIGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yID0gYXMuY2hhcmFjdGVyKGJpcnRob3JkZXJfbmFpdmUpLAogICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IgPSBpZmVsc2UoYmlydGhvcmRlcl9uYWl2ZSA+IDUsICI1KyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IpLAogICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IgPSBmYWN0b3IoYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjEiLCIyIiwiMyIsIjQiLCI1IiwiNSsiKSksCiAgICBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihzaWJsaW5nX2NvdW50X25haXZlKSwKICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yID0gaWZlbHNlKHNpYmxpbmdfY291bnRfbmFpdmUgPiA1LCAiNSsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yKSwKICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yID0gZmFjdG9yKHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIyIiwiMyIsIjQiLCI1IiwiNSsiKSksCiAgICBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihiaXJ0aG9yZGVyX2dlbmVzKSwKICAgIGJpcnRob3JkZXJfZ2VuZXNfZmFjdG9yID0gaWZlbHNlKGJpcnRob3JkZXJfZ2VuZXMgPjUgLCAiNSsiLCBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciksCiAgICBiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciA9IGZhY3RvcihiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCIxIiwiMiIsIjMiLCI0IiwiNSIsIjUrIikpLAogICAgc2libGluZ19jb3VudF9nZW5lc19mYWN0b3IgPSBhcy5jaGFyYWN0ZXIoc2libGluZ19jb3VudF9nZW5lcyksCiAgICBzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciA9IGlmZWxzZShzaWJsaW5nX2NvdW50X2dlbmVzID41ICwgIjUrIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yKSwKICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yID0gZmFjdG9yKHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjIiLCIzIiwiNCIsIjUiLCI1KyIpKSwKICAgICMgaW50ZXJhY3Rpb24gYmlydGhvcmRlciAqIHNpYmxpbmdjb3V0IGZvciBlYWNoIGJpcnRob3JkZXIKICAgIGNvdW50X2JpcnRob3JkZXJfbmFpdmUgPQogICAgICBmYWN0b3Ioc3RyX3JlcGxhY2UoYXMuY2hhcmFjdGVyKGludGVyYWN0aW9uKGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IpKSwKICAgICAgICAgICAgICAgICAgICAgICAgIlxcLiIsICIvIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSAgIGMoIjEvMiIsIjIvMiIsICIxLzMiLCAgIjIvMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjMvMyIsICIxLzQiLCAiMi80IiwgIjMvNCIsICI0LzQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIxLzUiLCAiMi81IiwgIjMvNSIsICI0LzUiLCAiNS81IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81KyIsICIyLzUrIiwgIjMvNSsiLCAiNC81KyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjUvNSsiLCAiNSsvNSsiKSksCiAgICBjb3VudF9iaXJ0aG9yZGVyX2dlbmVzID0KICAgICAgZmFjdG9yKHN0cl9yZXBsYWNlKGFzLmNoYXJhY3RlcihpbnRlcmFjdGlvbihiaXJ0aG9yZGVyX2dlbmVzX2ZhY3RvciwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yKSksICJcXC4iLCAiLyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gICBjKCIxLzIiLCIyLzIiLCAiMS8zIiwgICIyLzMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIzLzMiLCAiMS80IiwgIjIvNCIsICIzLzQiLCAiNC80IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81IiwgIjIvNSIsICIzLzUiLCAiNC81IiwgIjUvNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjEvNSsiLCAiMi81KyIsICIzLzUrIiwgIjQvNSsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI1LzUrIiwgIjUrLzUrIikpKQoKCgojIyMgVmFyaWFibGVzCmJpcnRob3JkZXIgPSBiaXJ0aG9yZGVyICU+JQogIG11dGF0ZSgKICAgIGdfZmFjdG9yXzIwMTVfb2xkID0gKGdfZmFjdG9yXzIwMTVfb2xkIC0gbWVhbihnX2ZhY3Rvcl8yMDE1X29sZCwgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAxNV9vbGQsIG5hLnJtPVQpLAogICAgZ19mYWN0b3JfMjAxNV95b3VuZyA9IChnX2ZhY3Rvcl8yMDE1X3lvdW5nIC0gbWVhbihnX2ZhY3Rvcl8yMDE1X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChnX2ZhY3Rvcl8yMDE1X3lvdW5nLCBuYS5ybT1UKSwKICAgIGdfZmFjdG9yXzIwMDdfb2xkID0gKGdfZmFjdG9yXzIwMDdfb2xkIC0gbWVhbihnX2ZhY3Rvcl8yMDA3X29sZCwgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAwN19vbGQsIG5hLnJtPVQpLApnX2ZhY3Rvcl8yMDA3X3lvdW5nID0gKGdfZmFjdG9yXzIwMDdfeW91bmcgLSBtZWFuKGdfZmFjdG9yXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvIHNkKGdfZmFjdG9yXzIwMDdfeW91bmcsIG5hLnJtPVQpLAogICAgcmF2ZW5fMjAxNV9vbGQgPSAocmF2ZW5fMjAxNV9vbGQgLSBtZWFuKHJhdmVuXzIwMTVfb2xkLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDE1X29sZCksCiAgICBtYXRoXzIwMTVfb2xkID0gKG1hdGhfMjAxNV9vbGQgLSBtZWFuKG1hdGhfMjAxNV9vbGQsIG5hLnJtPVQpKSAvIHNkKG1hdGhfMjAxNV9vbGQsIG5hLnJtPVQpLAogICAgcmF2ZW5fMjAxNV95b3VuZyA9IChyYXZlbl8yMDE1X3lvdW5nIC0gbWVhbihyYXZlbl8yMDE1X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDE1X3lvdW5nKSwKICAgIG1hdGhfMjAxNV95b3VuZyA9IChtYXRoXzIwMTVfeW91bmcgLSBtZWFuKG1hdGhfMjAxNV95b3VuZywgbmEucm09VCkpIC8KICAgICAgc2QobWF0aF8yMDE1X3lvdW5nLCBuYS5ybT1UKSwKICAgIHJhdmVuXzIwMDdfb2xkID0gKHJhdmVuXzIwMDdfb2xkIC0gbWVhbihyYXZlbl8yMDA3X29sZCwgbmEucm09VCkpIC8gc2QocmF2ZW5fMjAwN19vbGQpLAptYXRoXzIwMDdfb2xkID0gKG1hdGhfMjAwN19vbGQgLSBtZWFuKG1hdGhfMjAwN19vbGQsIG5hLnJtPVQpKSAvIHNkKG1hdGhfMjAwN19vbGQsIG5hLnJtPVQpLApyYXZlbl8yMDA3X3lvdW5nID0gKHJhdmVuXzIwMDdfeW91bmcgLSBtZWFuKHJhdmVuXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvIHNkKHJhdmVuXzIwMDdfeW91bmcpLAptYXRoXzIwMDdfeW91bmcgPSAobWF0aF8yMDA3X3lvdW5nIC0gbWVhbihtYXRoXzIwMDdfeW91bmcsIG5hLnJtPVQpKSAvCiAgc2QobWF0aF8yMDA3X3lvdW5nLCBuYS5ybT1UKSwKICAgIGNvdW50X2JhY2t3YXJkcyA9IChjb3VudF9iYWNrd2FyZHMgLSBtZWFuKGNvdW50X2JhY2t3YXJkcywgbmEucm09VCkpIC8KICAgICAgc2QoY291bnRfYmFja3dhcmRzLCBuYS5ybT1UKSwKICAgIHdvcmRzX2RlbGF5ZWQgPSAod29yZHNfZGVsYXllZCAtIG1lYW4od29yZHNfZGVsYXllZCwgbmEucm09VCkpIC8KICAgICAgc2Qod29yZHNfZGVsYXllZCwgbmEucm09VCksCiAgICBhZGFwdGl2ZV9udW1iZXJpbmcgPSAoYWRhcHRpdmVfbnVtYmVyaW5nIC0gbWVhbihhZGFwdGl2ZV9udW1iZXJpbmcsIG5hLnJtPVQpKSAvCiAgICAgIHNkKGFkYXB0aXZlX251bWJlcmluZywgbmEucm09VCksCiAgICBiaWc1X2V4dCA9IChiaWc1X2V4dCAtIG1lYW4oYmlnNV9leHQsIG5hLnJtPVQpKSAvIHNkKGJpZzVfZXh0LCBuYS5ybT1UKSwKICAgIGJpZzVfY29uID0gKGJpZzVfY29uIC0gbWVhbihiaWc1X2NvbiwgbmEucm09VCkpIC8gc2QoYmlnNV9jb24sIG5hLnJtPVQpLAogICAgYmlnNV9hZ3JlZSA9IChiaWc1X2FncmVlIC0gbWVhbihiaWc1X2FncmVlLCBuYS5ybT1UKSkgLyBzZChiaWc1X2FncmVlLCBuYS5ybT1UKSwKICAgIGJpZzVfb3BlbiA9IChiaWc1X29wZW4gLSBtZWFuKGJpZzVfb3BlbiwgbmEucm09VCkpIC8gc2QoYmlnNV9vcGVuLCBuYS5ybT1UKSwKICAgIGJpZzVfbmV1ID0gKGJpZzVfbmV1IC0gbWVhbihiaWc1X25ldSwgbmEucm09VCkpIC8gc2QoYmlnNV9uZXUsIG5hLnJtPVQpLAogICAgcmlza0EgPSAocmlza0EgLSBtZWFuKHJpc2tBLCBuYS5ybT1UKSkgLyBzZChyaXNrQSwgbmEucm09VCksCiAgICByaXNrQiA9IChyaXNrQiAtIG1lYW4ocmlza0IsIG5hLnJtPVQpKSAvIHNkKHJpc2tCLCBuYS5ybT1UKSwKICAgIHllYXJzX29mX2VkdWNhdGlvbl96ID0gKHllYXJzX29mX2VkdWNhdGlvbiAtIG1lYW4oeWVhcnNfb2ZfZWR1Y2F0aW9uLCBuYS5ybT1UKSkgLwogICAgICBzZCh5ZWFyc19vZl9lZHVjYXRpb24sIG5hLnJtPVQpLAogICAgd2FnZV9sYXN0X21vbnRoX3ogPSAod2FnZV9sYXN0X21vbnRoX2xvZyAtIG1lYW4od2FnZV9sYXN0X21vbnRoX2xvZywgbmEucm09VCkpIC8KICAgICAgc2Qod2FnZV9sYXN0X21vbnRoX2xvZywgbmEucm09VCksCiAgICB3YWdlX2xhc3RfeWVhcl96ID0gKHdhZ2VfbGFzdF95ZWFyX2xvZyAtIG1lYW4od2FnZV9sYXN0X3llYXJfbG9nLCBuYS5ybT1UKSkgLwogICAgICBzZCh3YWdlX2xhc3RfeWVhcl9sb2csIG5hLnJtPVQpLAogICAgYXR0ZW5kZWRfc2Nob29sID0gYXMuaW50ZWdlcihhdHRlbmRlZF9zY2hvb2wpLAogICAgYXR0ZW5kZWRfc2Nob29sID0gaWZlbHNlKGF0dGVuZGVkX3NjaG9vbCA9PSAxLCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoYXR0ZW5kZWRfc2Nob29sID09IDIsIDEsIE5BKSkpCiAgICAgICAgCmRhdGFfdXNlZCA8LSBiaXJ0aG9yZGVyICU+JQogIG11dGF0ZShzaWJsaW5nX2NvdW50ID0gc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IsCiAgICAgICAgIGJpcnRoX29yZGVyX25vbmxpbmVhciA9IGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yLAogICAgICAgICBiaXJ0aF9vcmRlciA9IGJpcnRob3JkZXJfbmFpdmUsCiAgICAgICAgIGNvdW50X2JpcnRoX29yZGVyID0gY291bnRfYmlydGhvcmRlcl9uYWl2ZSkKCmBgYAoKIyMgSW50ZWxsaWdlbmNlIHsuYWN0aXZlIC50YWJzZXR9CiMjIyBnLWZhY3RvciAyMDE1IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBnX2ZhY3Rvcl8yMDE1X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBnLWZhY3RvciAyMDE1IHlvdW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGdfZmFjdG9yXzIwMTVfeW91bmcpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyBQZXJzb25hbGl0eSB7LnRhYnNldH0KCiMjIyBFeHRyYXZlcnNpb24gey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9leHQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIE5ldXJvdGljaXNtIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfbmV1KQpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgQ29uc2NpZW50aW91c25lc3Mgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9uZXUpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIEFncmVlYWJsZW5lc3Mgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9hZ3JlZSkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgT3Blbm5lc3Mgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYmlnNV9vcGVuKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMgUmlza3ByZWZlcmVuY2Ugey50YWJzZXR9CiMjIyBSaXNrIEEgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gcmlza0EpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgUmlzayBCIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJpc2tCKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMgRWR1Y2F0aW9uYWwgQXR0YWlubWVudCB7LnRhYnNldH0KIyMjIFllYXJzIG9mIEVkdWNhdGlvbiAtIHotc3RhbmRhcmRpemVkey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0geWVhcnNfb2ZfZWR1Y2F0aW9uX3opCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgZWxlbWVudGFyeV9taXNzZWQKCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBFbGVtZW50YXJ5X21pc3NlZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgZWxlbWVudGFyeV93b3JrZWQKCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBFbGVtZW50YXJ5X3dvcmtlZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBhdHRlbmRlZF9zY2hvb2wKCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBhdHRlbmRlZF9zY2hvb2wpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKCiMjIFdvcmsgey50YWJzZXR9CgojIyMgSW5jb21lIExhc3QgTW9udGggKGxvZykgLSB6LXN0YW5kYXJkaXplZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gd2FnZV9sYXN0X21vbnRoX3opCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgSW5jb21lIGxhc3QgeWVhciAobG9nKSAtIHotc3RhbmRhcmRpemVkIHsudGFic2V0fQoKYGBge3J9CmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSB3YWdlX2xhc3RfeWVhcl96KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgojIyMgU2VsZi1FbXBsb3ltZW50IC0gbm9uIHN0YW5kYXJkaXplZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gU2VsZl9lbXBsb3llZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoKIyMgU21va2luZyBCZWhhdmlvdXIgey50YWJzZXR9CiMjIyBldmVyX3Ntb2tlZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gZXZlcl9zbW9rZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQpgYGAKCiMjIyBzdGlsbF9zbW9raW5nIHsudGFic2V0fQoKYGBge3J9CmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBzdGlsbF9zbW9raW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgoKIyMgTXVsdGlwbG90IExpbmVhciBCaXJ0aCBPcmRlciBFZmZlY3Qgey50YWJzZXR9CgojIyMgTW9kZWxzIHsudGFic2V0fQoKYGBge3IgZy1mYWN0b3IgMjAxNSBvbGR9CkludGVsbGlnZW5jZSA9IGxtZXIoZ19mYWN0b3JfMjAxNV9vbGQgfiBiaXJ0aG9yZGVyX2dlbmVzICsgcG9seShhZ2UsIDMsIHJhdyA9IFRSVUUpICsgbWFsZSArCiAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgKwogICAgICAgICAgICAgICAoMSB8IG1vdGhlcl9waWRsaW5rKSwKICAgICAgICAgICAgICAgICAgIGRhdGEgPSBiaXJ0aG9yZGVyKQoKYGBgCgpgYGB7ciBnLWZhY3RvciAyMDE1IG9sZH0KYEVkdWNhdGlvbmFsIEF0dGFpbm1lbnRgID0gbG1lcih5ZWFyc19vZl9lZHVjYXRpb25feiB+IGJpcnRob3JkZXJfZ2VuZXMgKyBwb2x5KGFnZSwgMywgcmF3ID0gVFJVRSkgKyBtYWxlICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgKyAoMSB8IG1vdGhlcl9waWRsaW5rKSwKICAgICAgICAgICAgICAgICAgIGRhdGEgPSBiaXJ0aG9yZGVyKQoKCmBgYAoKCgpgYGB7ciBnLWZhY3RvciAyMDE1IG9sZH0KRXh0cmF2ZXJzaW9uID0gbG1lcihiaWc1X2V4dCB+IGJpcnRob3JkZXJfZ2VuZXMgKyBwb2x5KGFnZSwgMywgcmF3ID0gVFJVRSkgKyBtYWxlICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgKyAoMSB8IG1vdGhlcl9waWRsaW5rKSwKICAgICAgICAgICAgICAgICAgIGRhdGEgPSBiaXJ0aG9yZGVyKQoKCmBgYAoKCgpgYGB7ciBnLWZhY3RvciAyMDE1IG9sZH0KTmV1cm90aWNpc20gPSBsbWVyKGJpZzVfbmV1IH4gYmlydGhvcmRlcl9nZW5lcyArIHBvbHkoYWdlLCAzLCByYXcgPSBUUlVFKSArIG1hbGUgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2libGluZ19jb3VudF9nZW5lcyArICgxIHwgbW90aGVyX3BpZGxpbmspLAogICAgICAgICAgICAgICAgICAgZGF0YSA9IGJpcnRob3JkZXIpCgoKYGBgCgoKYGBge3IgZy1mYWN0b3IgMjAxNSBvbGR9CkNvbnNjaWVudGlvdXNuZXNzID0gbG1lcihiaWc1X2NvbiB+IGJpcnRob3JkZXJfZ2VuZXMgKyBwb2x5KGFnZSwgMywgcmF3ID0gVFJVRSkgKyBtYWxlICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgKyAoMSB8IG1vdGhlcl9waWRsaW5rKSwKICAgICAgICAgICAgICAgICAgIGRhdGEgPSBiaXJ0aG9yZGVyKQoKCmBgYAoKCgpgYGB7ciBnLWZhY3RvciAyMDE1IG9sZH0KQWdyZWVhYmxlbmVzcyA9IGxtZXIoYmlnNV9hZ3JlZSB+IGJpcnRob3JkZXJfZ2VuZXMgKyBwb2x5KGFnZSwgMywgcmF3ID0gVFJVRSkgKyBtYWxlICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgKyAoMSB8IG1vdGhlcl9waWRsaW5rKSwKICAgICAgICAgICAgICAgICAgIGRhdGEgPSBiaXJ0aG9yZGVyKQoKCmBgYAoKCmBgYHtyIGctZmFjdG9yIDIwMTUgb2xkfQpPcGVubmVzcyA9IGxtZXIoYmlnNV9vcGVuIH4gYmlydGhvcmRlcl9nZW5lcyArIHBvbHkoYWdlLCAzLCByYXcgPSBUUlVFKSArIG1hbGUgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2libGluZ19jb3VudF9nZW5lcyArICgxIHwgbW90aGVyX3BpZGxpbmspLAogICAgICAgICAgICAgICAgICAgZGF0YSA9IGJpcnRob3JkZXIpCgoKYGBgCgoKYGBge3IgZy1mYWN0b3IgMjAxNSBvbGR9ClJpc2tBID0gbG1lcihyaXNrQSB+IGJpcnRob3JkZXJfZ2VuZXMgKyBwb2x5KGFnZSwgMywgcmF3ID0gVFJVRSkgKyBtYWxlICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgKyAoMSB8IG1vdGhlcl9waWRsaW5rKSwKICAgICAgICAgICAgICAgICAgIGRhdGEgPSBiaXJ0aG9yZGVyKQoKCmBgYAoKYGBge3IgZy1mYWN0b3IgMjAxNSBvbGR9ClJpc2tCID0gbG1lcihyaXNrQiB+IGJpcnRob3JkZXJfZ2VuZXMgKyBwb2x5KGFnZSwgMywgcmF3ID0gVFJVRSkgKyBtYWxlICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgKyAoMSB8IG1vdGhlcl9waWRsaW5rKSwKICAgICAgICAgICAgICAgICAgIGRhdGEgPSBiaXJ0aG9yZGVyKQoKCmBgYAoKIyMjIFBsb3Qgey5hY3RpdmV9CmBgYHtyfQp4ID0gbXVsdGlwbG90KEludGVsbGlnZW5jZSwgYEVkdWNhdGlvbmFsIEF0dGFpbm1lbnRgLCBBZ3JlZWFibGVuZXNzLCBDb25zY2llbnRpb3VzbmVzcywgRXh0cmF2ZXJzaW9uLCBOZXVyb3RpY2lzbSwgT3Blbm5lc3MsIFJpc2tBLCBSaXNrQiwgaW50ZXJjZXB0ID0gRkFMU0UsIGNvZWZmaWNpZW50cyA9IGMoImJpcnRob3JkZXJfZ2VuZXMiLCAic2libGluZ19jb3VudF9nZW5lcyIpLCBwbG90ID0gRikKICAgICAgICAKeCA9IGRhdGEuZnJhbWUoeCkKCngkTW9kZWwgPSBpZmVsc2UoeCRNb2RlbCA9PSAiYEVkdWNhdGlvbmFsIEF0dGFpbm1lbnRgIiwgIkVkdWNhdGlvbmFsIEF0dGFpbm1lbnQiLCB4JE1vZGVsKQp4JE1vZGVsID0gYXMuZmFjdG9yKHgkTW9kZWwpCmxldmVscyh4JE1vZGVsKQoKeCRDb2VmZmljaWVudCA9IGlmZWxzZSh4JENvZWZmaWNpZW50ID09ICJiaXJ0aG9yZGVyX2dlbmVzIiwgIkJpcnRoIG9yZGVyIiwgIlNpYnNoaXAgc2l6ZSIpCgpnZ3Bsb3QoeCwgYWVzKE1vZGVsLCBWYWx1ZSkpICsKICBnZW9tX3BvaW50cmFuZ2UoZGF0YT14LCBtYXBwaW5nPWFlcyh4PU1vZGVsLCB5PVZhbHVlLCB5bWluPUhpZ2hPdXRlciwgeW1heD1Mb3dPdXRlciwgY29sb3IgPSBDb2VmZmljaWVudCksCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gcG9zaXRpb25fZG9kZ2Uod2lkdGg9MC4zKSwgc2l6ZSA9IDEpICsKICBzY2FsZV9jb2xvdXJfYnJld2VyKHBhbGV0dGUgPSAiU2V0MiIpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSAwLCBzaXplID0gMS41KSAgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IC0uMSwgbGluZXR5cGUgPSAiZG90dGVkIiwgc2l6ZSA9IDEuNSkgKyAKICBzY2FsZV94X2Rpc2NyZXRlKGxpbWl0cz1jKCJSaXNrQiIsICJSaXNrQSIsICJPcGVubmVzcyIsICJOZXVyb3RpY2lzbSIsICJFeHRyYXZlcnNpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNvbnNjaWVudGlvdXNuZXNzIiwgIkFncmVlYWJsZW5lc3MiLCAiRWR1Y2F0aW9uYWwgQXR0YWlubWVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSW50ZWxsaWdlbmNlIikpICsKICBzY2FsZV95X2NvbnRpbnVvdXMobGltaXRzID0gYygtMC4xLCAwLjA1KSwgYnJlYWtzID0gYygtMC4xLCAtMC4wNSwgMCwgMC4wNSkpICsKICBjb29yZF9mbGlwKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoc2l6ZT0yNSksIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAyMCksCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDIwKSkgKwogIGxhYnMoeSA9ICJMaW5lYXIgZWZmZWN0IHNpemUiLCB4ID0gIk91dGNvbWUiKQogIApgYGAK</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("4_analyses_imputed_data.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
