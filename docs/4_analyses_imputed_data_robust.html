<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("4_analyses_imputed_data_robust.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Birth Order IFLS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">

<li style="background-color: #66C2A5">
  <a href="index.html">Overview</a>
</li>
<li style="background-color: #FC8D62">
  <a href="1_data_import.html">Data Wrangling</a>
</li>
<li style="background-color: #8DA0CB">
  <a href="2_Inclusion.html">Data Sampling</a>
</li>
<li style="background-color: #E78AC3">
  <a href="3_sample_analyses.html">Sample Analyses</a>
</li>
<li style="background-color: #A6D854">
  <a href="4_analyses.html">Birth Order Effects</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/laurabotzet/birth_order_ifls">
    <span class="fa fa-github"></span>


  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>




</div>


<div id="birth-order-effects" class="section level1 tabset">
<h1><span style="color:#A6D854">Birth Order Effects</span></h1>
<div id="helper" class="section level2">
<h2>Helper</h2>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;formr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rmarkdown&#39;:
## 
##     word_document</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## lattice theme set by effectsTheme()
## See ?effectsTheme for details.</code></pre>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     ggsave</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## This is lavaan 0.5-23.1097</code></pre>
<pre><code>## lavaan is BETA software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     describe</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:formr&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## 
## Attaching package: &#39;sjPlot&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:cowplot&#39;:
## 
##     plot_grid, save_plot</code></pre>
<pre class="r"><code>opts_chunk$set(warning = FALSE)</code></pre>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<pre class="r"><code>n_imputations.mitml = function(imps) {
  imps$iter$m
}
n_imputations.mids = function(imps) {
  imps$m
}
n_imputations.amelia = function(imps) {
  length(imps$imputations)
}
n_imputations = function(imps) { UseMethod(&quot;n_imputations&quot;) }

complete.mitml = mitml::mitmlComplete
complete.mids = mice::complete
complete = function(...) { UseMethod(&quot;complete&quot;) }

library(mice)</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     complete</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     complete</code></pre>
<pre class="r"><code>library(miceadds)</code></pre>
<pre><code>## * miceadds 2.7-19 (2017-08-24 17:34:44)</code></pre>
<pre class="r"><code>library(mitml)</code></pre>
<pre><code>## *** This is beta software. Please report any bugs!
## *** See the NEWS file for recent changes.</code></pre>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code>birthorder = readRDS(&quot;data/alldata_birthorder_i_ml.rds&quot;)</code></pre>
</div>
<div id="data-preparations" class="section level2">
<h2>Data preparations</h2>
<pre class="r"><code>birthorder &lt;- mids2mitml.list(birthorder)

## Calculate g_factors (for now with rowMeans: better to run factor analysis here as well?)
birthorder &lt;- within(birthorder, {
  g_factor_2015_old &lt;- rowMeans(scale(cbind(raven_2015_old, math_2015_old, count_backwards,  words_delayed, adaptive_numbering)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2015_young &lt;- rowMeans(scale(cbind(raven_2015_young, math_2015_young)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_old &lt;- rowMeans(scale(cbind(raven_2007_old, math_2007_old)))
})

birthorder &lt;- within(birthorder, {
  g_factor_2007_young &lt;- rowMeans(scale(cbind(raven_2007_young, math_2007_young)))
})


birthorder = birthorder %&gt;% tbl_df.mitml.list

### Birthorder and Sibling Count
# for factor variables we have to round birth order position and eliminate all unlikely numbers (negative ones)
birthorder_data = birthorder[[1]]

birthorder = birthorder %&gt;%
  mutate(birthorder_genes = ifelse(birthorder_genes &lt; 0, 0, birthorder_genes),
         birthorder_naive = ifelse(birthorder_naive &lt; 0, 0, birthorder_naive),
         birthorder_genes = round(birthorder_genes),
         birthorder_naive = round(birthorder_naive),
         sibling_count_genes = ifelse(sibling_count_genes &lt; 0, 0, sibling_count_genes),
         sibling_count_naive = ifelse(sibling_count_naive &lt; 0, 0, sibling_count_naive),
         sibling_count_genes = round(sibling_count_genes),
         sibling_count_naive = round(sibling_count_naive),
         birthorder_genes = ifelse(birthorder_genes &gt; 5, NA, birthorder_genes),
         birthorder_naive = ifelse(birthorder_naive &gt; 5, NA, birthorder_naive),
         sibling_count_genes = ifelse(sibling_count_genes &gt; 5, NA, sibling_count_genes),
         sibling_count_naive = ifelse(sibling_count_naive &gt; 5, NA, sibling_count_naive))


birthorder = birthorder %&gt;% 
  mutate(
# birthorder as factors with levels of 1, 2, 3, 4, 5, 5+
    birthorder_naive_factor = as.character(birthorder_naive),
    birthorder_naive_factor = factor(birthorder_naive_factor, 
                                            levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
    sibling_count_naive_factor = as.character(sibling_count_naive),
    sibling_count_naive_factor = factor(sibling_count_naive_factor, 
                                               levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
    birthorder_genes_factor = as.character(birthorder_genes),
    birthorder_genes_factor = factor(birthorder_genes_factor, 
                                     levels = c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
    sibling_count_genes_factor = as.character(sibling_count_genes),
    sibling_count_genes_factor = factor(sibling_count_genes_factor, 
                                        levels = c(&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)),
    # interaction birthorder * siblingcout for each birthorder
    count_birthorder_naive =
      factor(str_replace(as.character(interaction(birthorder_naive_factor,                                                              sibling_count_naive_factor)),
                        &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;)),
    count_birthorder_genes =
      factor(str_replace(as.character(interaction(birthorder_genes_factor,                                                              sibling_count_genes_factor)), &quot;\\.&quot;, &quot;/&quot;),
                                           levels =   c(&quot;1/2&quot;,&quot;2/2&quot;, &quot;1/3&quot;,  &quot;2/3&quot;,
                                                        &quot;3/3&quot;, &quot;1/4&quot;, &quot;2/4&quot;, &quot;3/4&quot;, &quot;4/4&quot;,
                                                        &quot;1/5&quot;, &quot;2/5&quot;, &quot;3/5&quot;, &quot;4/5&quot;, &quot;5/5&quot;)))



### Variables

birthorder = birthorder %&gt;%
  mutate(
    g_factor_2015_old = (g_factor_2015_old - mean(g_factor_2015_old, na.rm=T)) / sd(g_factor_2015_old, na.rm=T),
    g_factor_2015_young = (g_factor_2015_young - mean(g_factor_2015_young, na.rm=T)) / sd(g_factor_2015_young, na.rm=T),
    g_factor_2007_old = (g_factor_2007_old - mean(g_factor_2007_old, na.rm=T)) / sd(g_factor_2007_old, na.rm=T),
g_factor_2007_young = (g_factor_2007_young - mean(g_factor_2007_young, na.rm=T)) / sd(g_factor_2007_young, na.rm=T),
    raven_2015_old = (raven_2015_old - mean(raven_2015_old, na.rm=T)) / sd(raven_2015_old),
    math_2015_old = (math_2015_old - mean(math_2015_old, na.rm=T)) / sd(math_2015_old, na.rm=T),
    raven_2015_young = (raven_2015_young - mean(raven_2015_young, na.rm=T)) / sd(raven_2015_young),
    math_2015_young = (math_2015_young - mean(math_2015_young, na.rm=T)) /
      sd(math_2015_young, na.rm=T),
    raven_2007_old = (raven_2007_old - mean(raven_2007_old, na.rm=T)) / sd(raven_2007_old),
math_2007_old = (math_2007_old - mean(math_2007_old, na.rm=T)) / sd(math_2007_old, na.rm=T),
raven_2007_young = (raven_2007_young - mean(raven_2007_young, na.rm=T)) / sd(raven_2007_young),
math_2007_young = (math_2007_young - mean(math_2007_young, na.rm=T)) /
  sd(math_2007_young, na.rm=T),
    count_backwards = (count_backwards - mean(count_backwards, na.rm=T)) /
      sd(count_backwards, na.rm=T),
    words_delayed = (words_delayed - mean(words_delayed, na.rm=T)) /
      sd(words_delayed, na.rm=T),
    adaptive_numbering = (adaptive_numbering - mean(adaptive_numbering, na.rm=T)) /
      sd(adaptive_numbering, na.rm=T),
    big5_ext = (big5_ext - mean(big5_ext, na.rm=T)) / sd(big5_ext, na.rm=T),
    big5_con = (big5_con - mean(big5_con, na.rm=T)) / sd(big5_con, na.rm=T),
    big5_agree = (big5_agree - mean(big5_agree, na.rm=T)) / sd(big5_agree, na.rm=T),
    big5_open = (big5_open - mean(big5_open, na.rm=T)) / sd(big5_open, na.rm=T),
    big5_neu = (big5_neu - mean(big5_neu, na.rm=T)) / sd(big5_neu, na.rm=T),
    riskA = (riskA - mean(riskA, na.rm=T)) / sd(riskA, na.rm=T),
    riskB = (riskB - mean(riskB, na.rm=T)) / sd(riskB, na.rm=T),
    years_of_education_z = (years_of_education - mean(years_of_education, na.rm=T)) /
      sd(years_of_education, na.rm=T),
    wage_last_month_z = (wage_last_month_log - mean(wage_last_month_log, na.rm=T)) /
      sd(wage_last_month_log, na.rm=T),
    wage_last_year_z = (wage_last_year_log - mean(wage_last_year_log, na.rm=T)) /
      sd(wage_last_year_log, na.rm=T),
    attended_school = as.integer(attended_school),
    attended_school = ifelse(attended_school == 1, 0,
                           ifelse(attended_school == 2, 1, NA)))
data_used &lt;- birthorder %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)</code></pre>
</div>
<div id="intelligence" class="section level2 active tabset">
<h2>Intelligence</h2>
<div id="g-factor-2015-old" class="section level3 tabset">
<h3>g-factor 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.465     0.026     0.413     0.516    17.538    32.757     0.000     1.102     0.551 
## poly(age, 3, raw = TRUE)1    -0.016     0.003    -0.022    -0.010    -5.224    60.673     0.000     0.626     0.404 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.013   110.522     0.313     0.399     0.298 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.385   159.170     0.168     0.312     0.247 
## male                         -0.016     0.015    -0.044     0.013    -1.077    46.416     0.287     0.787     0.463 
## sibling_count                 0.007     0.006    -0.006     0.019     1.052   108.229     0.295     0.405     0.301 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.222 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-1" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.473     0.025     0.424     0.523    18.622    48.764     0.000     0.753     0.452 
## birth_order                  -0.009     0.009    -0.027     0.008    -1.083    40.172     0.285     0.899     0.498 
## poly(age, 3, raw = TRUE)1    -0.017     0.003    -0.023    -0.011    -5.366    61.465     0.000     0.620     0.402 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.820    99.415     0.414     0.430     0.315 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.489   140.947     0.139     0.338     0.263 
## male                         -0.015     0.015    -0.044     0.013    -1.064    46.404     0.293     0.787     0.463 
## sibling_count                 0.012     0.009    -0.005     0.030     1.366    39.637     0.180     0.910     0.501 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.193 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.222 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-1" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-2" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.461     0.028     0.407     0.515    16.651    30.051     0.000     1.209     0.575 
## birth_order_nonlinear2       -0.001     0.019    -0.038     0.036    -0.044    33.824     0.965     1.065     0.542 
## birth_order_nonlinear3       -0.014     0.021    -0.055     0.027    -0.658    98.505     0.512     0.433     0.316 
## birth_order_nonlinear4       -0.043     0.034    -0.110     0.024    -1.271    35.794     0.212     1.006     0.527 
## birth_order_nonlinear5       -0.023     0.045    -0.112     0.065    -0.515    52.380     0.608     0.708     0.436 
## poly(age, 3, raw = TRUE)1    -0.016     0.003    -0.022    -0.010    -5.326    62.172     0.000     0.614     0.399 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.865   103.483     0.389     0.418     0.308 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.447   147.828     0.150     0.328     0.257 
## male                         -0.016     0.015    -0.044     0.013    -1.077    46.543     0.287     0.785     0.462 
## sibling_count                 0.012     0.009    -0.005     0.030     1.362    40.971     0.181     0.882     0.493 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.192 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.222 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-2" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-3" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.470     0.035     0.402     0.538    13.481    44.547     0.000     0.816     0.473 
## count_birth_order2/2          0.004     0.026    -0.048     0.055     0.134    47.436     0.894     0.772     0.458 
## count_birth_order1/3          0.014     0.029    -0.042     0.070     0.493   172.602     0.623     0.296     0.237 
## count_birth_order2/3         -0.008     0.031    -0.070     0.054    -0.249    70.296     0.804     0.557     0.375 
## count_birth_order3/3          0.014     0.028    -0.041     0.069     0.490   184.026     0.625     0.284     0.229 
## count_birth_order1/4         -0.001     0.034    -0.068     0.065    -0.042   673.115     0.966     0.131     0.118 
## count_birth_order2/4          0.010     0.036    -0.060     0.080     0.286   214.290     0.775     0.258     0.212 
## count_birth_order3/4         -0.036     0.037    -0.109     0.038    -0.951    83.387     0.344     0.489     0.344 
## count_birth_order4/4         -0.015     0.037    -0.088     0.058    -0.403    64.596     0.688     0.596     0.392 
## count_birth_order1/5         -0.021     0.045    -0.109     0.067    -0.468   189.327     0.640     0.279     0.226 
## count_birth_order2/5          0.026     0.045    -0.062     0.114     0.588   229.964     0.557     0.247     0.205 
## count_birth_order3/5          0.008     0.041    -0.072     0.087     0.188   635.675     0.851     0.135     0.122 
## count_birth_order4/5         -0.043     0.045    -0.133     0.046    -0.956    91.872     0.341     0.456     0.327 
## count_birth_order5/5          0.004     0.043    -0.079     0.088     0.103    85.588     0.918     0.480     0.340 
## poly(age, 3, raw = TRUE)1    -0.016     0.004    -0.024    -0.008    -3.840    53.143     0.000     0.699     0.432 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.099   149.785     0.921     0.325     0.255 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.102   276.001     0.036     0.220     0.186 
## male                         -0.029     0.014    -0.057    -0.000    -1.992    86.542     0.050     0.476     0.338 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.190 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.220 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-3" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1647.265        8 2383.206    0.000    0.047 
##   2 vs 3:    4.199        3   37.922    0.012    0.704 
##   3 vs 4:    3.456        1   56.347    0.068    0.666 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-1" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-4" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.491     0.026     0.440     0.542    18.860    27.582     0.000     1.332     0.599 
## poly(age, 3, raw = TRUE)1    -0.018     0.003    -0.024    -0.011    -5.515    34.251     0.000     1.052     0.539 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.193    54.514     0.847     0.684     0.427 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.120    73.754     0.037     0.537     0.366 
## male                         -0.018     0.014    -0.046     0.009    -1.316    36.886     0.196     0.976     0.519 
## sibling_count                -0.007     0.006    -0.019     0.005    -1.089    82.951     0.279     0.491     0.345 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-4" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-1" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-5" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.488     0.026     0.438     0.539    18.855    32.533     0.000     1.110     0.553 
## birth_order                   0.002     0.009    -0.015     0.019     0.215    27.700     0.831     1.326     0.598 
## poly(age, 3, raw = TRUE)1    -0.018     0.003    -0.024    -0.011    -5.473    35.193     0.000     1.023     0.532 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.221    54.021     0.826     0.690     0.429 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.091    72.498     0.040     0.544     0.369 
## male                         -0.018     0.014    -0.046     0.010    -1.284    34.549     0.208     1.042     0.536 
## sibling_count                -0.007     0.007    -0.022     0.007    -0.982    72.210     0.329     0.546     0.370 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-5" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-1" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-6" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.494     0.027     0.441     0.548    17.995    26.680     0.000     1.386     0.609 
## birth_order_nonlinear2       -0.002     0.018    -0.036     0.033    -0.105    29.268     0.917     1.245     0.582 
## birth_order_nonlinear3       -0.004     0.022    -0.047     0.039    -0.202    43.699     0.841     0.831     0.477 
## birth_order_nonlinear4       -0.020     0.034    -0.086     0.047    -0.578    32.605     0.567     1.107     0.552 
## birth_order_nonlinear5       -0.036     0.052    -0.139     0.067    -0.689    35.408     0.495     1.017     0.530 
## poly(age, 3, raw = TRUE)1    -0.018     0.003    -0.025    -0.012    -5.434    33.324     0.000     1.082     0.546 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.043    53.807     0.966     0.692     0.430 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.348    76.859     0.021     0.520     0.359 
## male                         -0.021     0.014    -0.048     0.007    -1.487    38.835     0.145     0.928     0.506 
## sibling_count                -0.005     0.008    -0.020     0.010    -0.712    72.801     0.479     0.542     0.369 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.200 
## Residual~~Residual                     0.669 
## ICC|mother_pidlink                     0.231 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-6" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-1" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-7" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.450     0.030     0.391     0.508    15.048    79.834     0.000     0.505     0.352 
## count_birth_order2/2          0.011     0.027    -0.041     0.063     0.421    30.329     0.677     1.197     0.572 
## count_birth_order1/3          0.023     0.034    -0.044     0.090     0.676    31.675     0.504     1.142     0.560 
## count_birth_order2/3          0.004     0.033    -0.060     0.068     0.124    29.769     0.902     1.221     0.577 
## count_birth_order3/3          0.032     0.031    -0.030     0.093     1.017    43.791     0.315     0.829     0.477 
## count_birth_order1/4         -0.022     0.044    -0.108     0.064    -0.504    38.850     0.617     0.928     0.506 
## count_birth_order2/4         -0.023     0.037    -0.095     0.049    -0.636    61.007     0.527     0.624     0.403 
## count_birth_order3/4         -0.046     0.033    -0.112     0.020    -1.376   145.258     0.171     0.331     0.259 
## count_birth_order4/4         -0.014     0.039    -0.091     0.063    -0.358    49.298     0.722     0.746     0.449 
## count_birth_order1/5         -0.064     0.048    -0.159     0.030    -1.343   217.658     0.181     0.255     0.211 
## count_birth_order2/5         -0.098     0.053    -0.201     0.006    -1.846    46.522     0.071     0.785     0.462 
## count_birth_order3/5         -0.083     0.045    -0.171     0.006    -1.837   107.995     0.069     0.406     0.301 
## count_birth_order4/5         -0.094     0.056    -0.205     0.016    -1.672    29.560     0.105     1.231     0.579 
## count_birth_order5/5         -0.072     0.051    -0.172     0.027    -1.424    60.092     0.160     0.631     0.406 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.023    -0.006    -3.358    27.645     0.002     1.329     0.599 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.445    33.932     0.659     1.062     0.541 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.499    39.554     0.142     0.912     0.502 
## male                         -0.027     0.015    -0.056     0.002    -1.811    48.297     0.076     0.760     0.454 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.201 
## Residual~~Residual                     0.668 
## ICC|mother_pidlink                     0.231 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-7" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-1" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1021.543        8   17.839    0.000    1.083 
##   2 vs 3:  322.896        3   14.115    0.000    2.098 
##   3 vs 4:  113.829        1   56.920    0.000    0.660 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2015-old" class="section level3 tabset">
<h3>Raven 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-1" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-2" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-8" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.321     0.028     0.266     0.375    11.529    29.291     0.000     1.244     0.582 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.016    -0.004    -3.151    54.878     0.003     0.681     0.426 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.270   107.424     0.025     0.407     0.302 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.170   166.362     0.865     0.303     0.242 
## male                          0.035     0.014     0.007     0.064     2.446    51.905     0.018     0.714     0.438 
## sibling_count                 0.014     0.006     0.001     0.026     2.126    92.231     0.036     0.454     0.327 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.230 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-8" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-2" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-9" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.328     0.030     0.268     0.387    10.808    26.289     0.000     1.410     0.613 
## birth_order                  -0.007     0.008    -0.022     0.008    -0.943   106.611     0.348     0.410     0.303 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.017    -0.004    -3.216    50.404     0.002     0.732     0.444 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.093    96.038     0.039     0.441     0.320 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.075   148.159     0.940     0.327     0.256 
## male                          0.035     0.014     0.007     0.064     2.452    51.462     0.018     0.719     0.440 
## sibling_count                 0.018     0.007     0.004     0.032     2.550   560.366     0.011     0.145     0.130 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.230 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-9" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-2" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-10" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.319     0.028     0.265     0.373    11.593    32.387     0.000     1.115     0.554 
## birth_order_nonlinear2       -0.006     0.016    -0.038     0.026    -0.362    76.450     0.719     0.522     0.360 
## birth_order_nonlinear3       -0.004     0.021    -0.044     0.036    -0.207   140.672     0.837     0.339     0.263 
## birth_order_nonlinear4       -0.042     0.030    -0.100     0.017    -1.386    77.827     0.170     0.515     0.356 
## birth_order_nonlinear5       -0.014     0.046    -0.103     0.076    -0.295    52.357     0.769     0.708     0.436 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.017    -0.004    -3.212    52.934     0.002     0.702     0.433 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.135   103.475     0.035     0.418     0.308 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.102   163.090     0.919     0.307     0.244 
## male                          0.035     0.014     0.007     0.064     2.454    52.395     0.017     0.708     0.436 
## sibling_count                 0.018     0.007     0.004     0.032     2.528   529.471     0.012     0.150     0.134 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.230 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-10" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-2" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-11" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.348     0.035     0.279     0.418     9.817    43.595     0.000     0.833     0.478 
## count_birth_order2/2         -0.015     0.024    -0.062     0.032    -0.614    89.635     0.541     0.464     0.332 
## count_birth_order1/3         -0.006     0.033    -0.071     0.058    -0.196    57.190     0.845     0.658     0.417 
## count_birth_order2/3         -0.014     0.035    -0.083     0.054    -0.410    40.709     0.684     0.887     0.494 
## count_birth_order3/3          0.018     0.026    -0.034     0.070     0.677   862.888     0.498     0.114     0.104 
## count_birth_order1/4         -0.000     0.037    -0.073     0.073    -0.005   146.775     0.996     0.329     0.258 
## count_birth_order2/4          0.024     0.036    -0.047     0.095     0.654   204.368     0.514     0.266     0.217 
## count_birth_order3/4         -0.030     0.039    -0.106     0.045    -0.784    72.980     0.435     0.541     0.368 
## count_birth_order4/4         -0.007     0.036    -0.078     0.065    -0.188    87.944     0.851     0.470     0.335 
## count_birth_order1/5          0.007     0.045    -0.081     0.095     0.163   214.900     0.871     0.257     0.212 
## count_birth_order2/5          0.032     0.045    -0.057     0.121     0.694   233.859     0.488     0.244     0.203 
## count_birth_order3/5          0.041     0.045    -0.048     0.130     0.909   123.154     0.365     0.370     0.282 
## count_birth_order4/5         -0.038     0.043    -0.122     0.047    -0.874   203.522     0.383     0.266     0.218 
## count_birth_order5/5          0.025     0.053    -0.078     0.128     0.473    30.179     0.640     1.203     0.573 
## poly(age, 3, raw = TRUE)1    -0.010     0.004    -0.018    -0.003    -2.639    89.308     0.010     0.465     0.332 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.696   239.472     0.487     0.240     0.201 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.329   239.049     0.185     0.241     0.201 
## male                          0.029     0.015    -0.001     0.058     1.892    68.212     0.063     0.570     0.381 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.202 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.227 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-11" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-2" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1690.153        8 3300.519    0.000    0.040 
##   2 vs 3:    4.941        3   71.326    0.004    0.431 
##   3 vs 4:    1.766        1   42.508    0.191    0.852 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-1" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-3" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-12" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.344     0.031     0.283     0.406    11.020    18.816     0.000     2.243     0.720 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.016    -0.004    -3.231    39.362     0.002     0.916     0.503 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.805    62.557     0.076     0.611     0.398 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.432    85.202     0.666     0.482     0.340 
## male                          0.036     0.014     0.008     0.064     2.489    35.157     0.018     1.024     0.532 
## sibling_count                 0.001     0.008    -0.015     0.016     0.079    28.737     0.938     1.271     0.587 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.692 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-12" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-3" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-13" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.345     0.033     0.280     0.410    10.372    18.263     0.000     2.356     0.730 
## birth_order                  -0.001     0.008    -0.017     0.014    -0.147    42.222     0.884     0.858     0.485 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.016    -0.004    -3.202    38.568     0.003     0.934     0.508 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.803    61.098     0.076     0.623     0.403 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.417    83.798     0.678     0.487     0.343 
## male                          0.036     0.014     0.008     0.064     2.497    35.901     0.017     1.003     0.526 
## sibling_count                 0.002     0.007    -0.013     0.016     0.220    90.895     0.827     0.459     0.329 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.692 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-13" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-3" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-14" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.345     0.032     0.283     0.407    10.901    19.884     0.000     2.056     0.701 
## birth_order_nonlinear2        0.000     0.017    -0.032     0.033     0.027    38.512     0.978     0.936     0.508 
## birth_order_nonlinear3       -0.002     0.022    -0.044     0.040    -0.096    51.545     0.924     0.718     0.439 
## birth_order_nonlinear4       -0.021     0.029    -0.078     0.035    -0.734    82.636     0.465     0.493     0.346 
## birth_order_nonlinear5       -0.059     0.054    -0.165     0.047    -1.093    33.576     0.282     1.074     0.544 
## poly(age, 3, raw = TRUE)1    -0.011     0.003    -0.017    -0.004    -3.211    36.794     0.003     0.979     0.520 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.550    61.049     0.126     0.623     0.403 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.673    93.411     0.503     0.450     0.325 
## male                          0.034     0.014     0.007     0.062     2.426    40.168     0.020     0.899     0.498 
## sibling_count                 0.003     0.007    -0.012     0.017     0.375   111.981     0.708     0.396     0.296 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-14" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-3" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-15" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.313     0.038     0.239     0.388     8.228    26.989     0.000     1.367     0.606 
## count_birth_order2/2          0.014     0.027    -0.039     0.066     0.506    30.295     0.617     1.198     0.572 
## count_birth_order1/3          0.014     0.034    -0.052     0.080     0.415    35.758     0.681     1.007     0.527 
## count_birth_order2/3          0.001     0.034    -0.065     0.067     0.029    28.237     0.977     1.297     0.592 
## count_birth_order3/3          0.031     0.029    -0.026     0.088     1.050    74.532     0.297     0.533     0.364 
## count_birth_order1/4         -0.011     0.035    -0.079     0.057    -0.317   405.530     0.751     0.175     0.153 
## count_birth_order2/4          0.000     0.040    -0.079     0.079     0.006    39.500     0.995     0.913     0.502 
## count_birth_order3/4         -0.027     0.042    -0.109     0.055    -0.640    34.792     0.526     1.035     0.535 
## count_birth_order4/4          0.001     0.039    -0.076     0.078     0.024    55.263     0.981     0.677     0.424 
## count_birth_order1/5         -0.033     0.055    -0.141     0.076    -0.594    61.936     0.555     0.616     0.400 
## count_birth_order2/5         -0.044     0.054    -0.149     0.062    -0.814    46.580     0.420     0.784     0.462 
## count_birth_order3/5         -0.033     0.047    -0.125     0.059    -0.701    83.418     0.485     0.489     0.344 
## count_birth_order4/5         -0.071     0.064    -0.195     0.054    -1.113    22.205     0.278     1.752     0.665 
## count_birth_order5/5         -0.077     0.055    -0.185     0.031    -1.402    42.097     0.168     0.860     0.486 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.002    -1.584    32.869     0.123     1.098     0.550 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.812    44.746     0.077     0.813     0.472 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.203    52.693     0.840     0.704     0.434 
## male                          0.034     0.015     0.003     0.064     2.185    43.261     0.034     0.839     0.480 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.208 
## Residual~~Residual                     0.688 
## ICC|mother_pidlink                     0.232 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-15" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-3" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1178.980        8   23.195    0.000    0.838 
##   2 vs 3:  412.415        3   18.017    0.000    1.496 
##   3 vs 4:  110.411        1   42.418    0.000    0.854 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-1" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2015-old" class="section level3 tabset">
<h3>Numeracy 2015 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2015_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-2" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-4" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-16" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.307     0.027     0.254     0.360    11.411    37.060     0.000     0.972     0.518 
## poly(age, 3, raw = TRUE)1    -0.008     0.003    -0.014    -0.002    -2.436    52.913     0.018     0.702     0.433 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.804    48.517     0.425     0.757     0.453 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.344    48.344     0.732     0.759     0.454 
## male                         -0.069     0.016    -0.100    -0.038    -4.395    43.495     0.000     0.834     0.478 
## sibling_count                 0.002     0.008    -0.014     0.018     0.289    29.198     0.775     1.248     0.583 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.170 
## Residual~~Residual                     0.795 
## ICC|mother_pidlink                     0.176 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-16" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-4" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-17" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.310     0.028     0.255     0.365    11.092    39.003     0.000     0.924     0.505 
## birth_order                  -0.003     0.010    -0.023     0.017    -0.296    29.096     0.769     1.253     0.584 
## poly(age, 3, raw = TRUE)1    -0.008     0.003    -0.015    -0.002    -2.531    63.954     0.014     0.600     0.394 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.770    56.379     0.445     0.665     0.420 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.383    53.317     0.704     0.697     0.432 
## male                         -0.069     0.016    -0.099    -0.038    -4.409    44.337     0.000     0.820     0.474 
## sibling_count                 0.004     0.011    -0.017     0.025     0.389    25.204     0.701     1.485     0.626 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.170 
## Residual~~Residual                     0.795 
## ICC|mother_pidlink                     0.176 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-17" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-4" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-18" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.307     0.028     0.253     0.362    11.093    35.852     0.000     1.004     0.527 
## birth_order_nonlinear2       -0.006     0.022    -0.049     0.037    -0.258    25.873     0.798     1.438     0.618 
## birth_order_nonlinear3       -0.003     0.024    -0.049     0.043    -0.124    67.147     0.902     0.578     0.384 
## birth_order_nonlinear4       -0.026     0.037    -0.098     0.046    -0.704    36.006     0.486     1.000     0.526 
## birth_order_nonlinear5        0.010     0.055    -0.097     0.117     0.182    31.188     0.856     1.161     0.564 
## poly(age, 3, raw = TRUE)1    -0.008     0.003    -0.014    -0.002    -2.551    68.072     0.013     0.571     0.382 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.772    58.591     0.443     0.645     0.412 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.390    55.616     0.698     0.673     0.423 
## male                         -0.069     0.016    -0.100    -0.038    -4.403    43.885     0.000     0.828     0.476 
## sibling_count                 0.004     0.011    -0.017     0.025     0.400    26.134     0.692     1.420     0.615 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.170 
## Residual~~Residual                     0.795 
## ICC|mother_pidlink                     0.176 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-18" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-4" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-19" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.294     0.039     0.218     0.370     7.587    36.064     0.000     0.998     0.525 
## count_birth_order2/2          0.010     0.027    -0.043     0.063     0.354    64.458     0.725     0.597     0.392 
## count_birth_order1/3          0.026     0.038    -0.048     0.101     0.701    36.644     0.487     0.983     0.521 
## count_birth_order2/3         -0.015     0.038    -0.089     0.059    -0.395    36.710     0.695     0.981     0.521 
## count_birth_order3/3          0.012     0.032    -0.051     0.074     0.364    84.410     0.717     0.485     0.342 
## count_birth_order1/4         -0.025     0.036    -0.095     0.046    -0.693   723.091     0.489     0.126     0.114 
## count_birth_order2/4         -0.035     0.040    -0.113     0.043    -0.885   124.248     0.378     0.368     0.281 
## count_birth_order3/4         -0.034     0.044    -0.120     0.051    -0.789    46.490     0.434     0.786     0.463 
## count_birth_order4/4         -0.024     0.040    -0.102     0.054    -0.602    62.323     0.550     0.613     0.399 
## count_birth_order1/5         -0.044     0.052    -0.145     0.057    -0.853    83.518     0.396     0.489     0.344 
## count_birth_order2/5         -0.037     0.051    -0.138     0.064    -0.714    97.533     0.477     0.436     0.318 
## count_birth_order3/5          0.007     0.047    -0.084     0.098     0.144   164.780     0.886     0.305     0.243 
## count_birth_order4/5         -0.033     0.052    -0.136     0.069    -0.642    54.815     0.524     0.681     0.426 
## count_birth_order5/5          0.014     0.049    -0.081     0.110     0.291    51.762     0.772     0.715     0.438 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.002    -1.374   228.827     0.171     0.247     0.205 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.834   442.797     0.405     0.166     0.146 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.344   233.848     0.731     0.244     0.203 
## male                         -0.082     0.019    -0.119    -0.046    -4.419    32.345     0.000     1.116     0.554 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.172 
## Residual~~Residual                     0.800 
## ICC|mother_pidlink                     0.177 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-19" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-4" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1514.554        8  252.103    0.000    0.161 
##   2 vs 3:    2.949        3   23.623    0.053    1.098 
##   3 vs 4:    2.217        1   42.195    0.144    0.858 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-2" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-5" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-20" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.331     0.023     0.286     0.376    14.284    54.495     0.000     0.685     0.427 
## poly(age, 3, raw = TRUE)1    -0.010     0.003    -0.015    -0.004    -3.333    89.598     0.001     0.464     0.332 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.322    66.708     0.749     0.581     0.385 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.882    59.494     0.381     0.637     0.408 
## male                         -0.073     0.014    -0.101    -0.045    -5.075    41.531     0.000     0.871     0.490 
## sibling_count                -0.010     0.006    -0.021     0.002    -1.677   283.476     0.095     0.217     0.184 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.173 
## Residual~~Residual                     0.790 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-20" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-5" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-21" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.326     0.024     0.278     0.373    13.448    54.566     0.000     0.684     0.427 
## birth_order                   0.005     0.010    -0.015     0.024     0.467    22.954     0.645     1.675     0.655 
## poly(age, 3, raw = TRUE)1    -0.009     0.003    -0.015    -0.004    -3.209    89.183     0.002     0.466     0.332 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.381    66.341     0.704     0.583     0.387 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.835    57.964     0.407     0.650     0.414 
## male                         -0.073     0.015    -0.102    -0.045    -5.004    39.300     0.000     0.918     0.503 
## sibling_count                -0.012     0.009    -0.029     0.005    -1.354    38.021     0.184     0.948     0.512 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.173 
## Residual~~Residual                     0.790 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-21" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-5" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-22" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.333     0.026     0.283     0.384    12.868    39.150     0.000     0.921     0.504 
## birth_order_nonlinear2        0.001     0.024    -0.047     0.049     0.049    16.729     0.961     2.752     0.760 
## birth_order_nonlinear3        0.011     0.026    -0.040     0.061     0.414    31.271     0.681     1.157     0.564 
## birth_order_nonlinear4       -0.011     0.042    -0.094     0.072    -0.265    21.166     0.794     1.874     0.681 
## birth_order_nonlinear5       -0.028     0.055    -0.137     0.080    -0.510    37.898     0.613     0.951     0.512 
## poly(age, 3, raw = TRUE)1    -0.009     0.003    -0.015    -0.004    -3.188    88.472     0.002     0.468     0.334 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.253    83.992     0.801     0.487     0.343 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.002    75.159     0.320     0.529     0.363 
## male                         -0.074     0.015    -0.102    -0.045    -5.013    41.994     0.000     0.862     0.487 
## sibling_count                -0.011     0.009    -0.029     0.007    -1.221    37.795     0.230     0.953     0.513 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.173 
## Residual~~Residual                     0.793 
## ICC|mother_pidlink                     0.179 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-22" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-5" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-23" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.287     0.035     0.219     0.355     8.292    44.096     0.000     0.824     0.475 
## count_birth_order2/2          0.015     0.029    -0.041     0.072     0.538    29.790     0.594     1.220     0.577 
## count_birth_order1/3          0.016     0.032    -0.046     0.078     0.520    59.776     0.605     0.634     0.408 
## count_birth_order2/3         -0.009     0.035    -0.078     0.061    -0.241    27.324     0.811     1.347     0.602 
## count_birth_order3/3          0.025     0.034    -0.042     0.092     0.725    37.602     0.473     0.958     0.514 
## count_birth_order1/4         -0.032     0.046    -0.121     0.058    -0.693    43.746     0.492     0.830     0.477 
## count_birth_order2/4         -0.043     0.040    -0.121     0.036    -1.066    52.073     0.292     0.712     0.437 
## count_birth_order3/4         -0.031     0.034    -0.098     0.036    -0.904   232.648     0.367     0.245     0.204 
## count_birth_order4/4         -0.011     0.047    -0.103     0.081    -0.243    30.395     0.810     1.194     0.571 
## count_birth_order1/5         -0.073     0.050    -0.170     0.024    -1.481   405.249     0.139     0.175     0.153 
## count_birth_order2/5         -0.111     0.050    -0.208    -0.014    -2.234   115.885     0.027     0.386     0.291 
## count_birth_order3/5         -0.078     0.052    -0.180     0.023    -1.514    58.637     0.136     0.644     0.412 
## count_birth_order4/5         -0.105     0.054    -0.210     0.000    -1.954    46.270     0.057     0.789     0.464 
## count_birth_order5/5         -0.074     0.055    -0.181     0.034    -1.343    54.814     0.185     0.681     0.426 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.013     0.001    -1.643    68.177     0.105     0.571     0.381 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.685    63.801     0.496     0.601     0.394 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.588    65.436     0.558     0.589     0.389 
## male                         -0.081     0.018    -0.116    -0.045    -4.451    28.376     0.000     1.289     0.591 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.174 
## Residual~~Residual                     0.794 
## ICC|mother_pidlink                     0.180 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-23" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-5" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1073.018        8   18.286    0.000    1.056 
##   2 vs 3:  298.680        3   13.014    0.000    2.393 
##   3 vs 4:  108.719        1   45.373    0.000    0.803 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-2" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
</div>
<div id="counting-backwards" class="section level3 tabset">
<h3>Counting Backwards</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = count_backwards)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-3" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-6" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-24" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.115     0.026     0.065     0.166     4.475    46.484     0.000     0.786     0.463 
## poly(age, 3, raw = TRUE)1     0.001     0.003    -0.004     0.007     0.519   482.459     0.604     0.158     0.140 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.385  8579.208     0.017     0.033     0.033 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.758  4553.205     0.079     0.047     0.045 
## male                          0.000     0.014    -0.027     0.027     0.001   127.010     0.999     0.363     0.277 
## sibling_count                -0.002     0.007    -0.016     0.011    -0.358    72.805     0.721     0.542     0.369 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.158 
## Residual~~Residual                     0.824 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-24" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-6" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-25" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.130     0.026     0.078     0.181     4.962    56.820     0.000     0.661     0.418 
## birth_order                  -0.016     0.009    -0.033     0.001    -1.814    64.977     0.074     0.593     0.391 
## poly(age, 3, raw = TRUE)1     0.000     0.003    -0.005     0.006     0.060   481.665     0.952     0.158     0.140 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.028  2407.327     0.043     0.065     0.062 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.519  2042.055     0.129     0.071     0.067 
## male                          0.000     0.014    -0.026     0.027     0.024   126.854     0.981     0.363     0.278 
## sibling_count                 0.007     0.008    -0.009     0.024     0.861    83.651     0.392     0.488     0.344 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.824 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-25" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-6" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-26" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.113     0.026     0.062     0.164     4.365    50.274     0.000     0.733     0.445 
## birth_order_nonlinear2       -0.013     0.020    -0.052     0.026    -0.657    39.834     0.515     0.906     0.500 
## birth_order_nonlinear3       -0.039     0.026    -0.090     0.012    -1.498    42.969     0.141     0.844     0.481 
## birth_order_nonlinear4       -0.043     0.035    -0.112     0.026    -1.231    46.412     0.224     0.787     0.463 
## birth_order_nonlinear5       -0.058     0.048    -0.153     0.037    -1.202    60.093     0.234     0.631     0.406 
## poly(age, 3, raw = TRUE)1     0.000     0.003    -0.005     0.006     0.070   516.016     0.944     0.152     0.135 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.029  2063.301     0.043     0.071     0.067 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.514  1460.991     0.130     0.085     0.080 
## male                          0.000     0.014    -0.027     0.027     0.023   124.692     0.982     0.367     0.280 
## sibling_count                 0.007     0.008    -0.009     0.024     0.870    88.255     0.386     0.469     0.334 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.159 
## Residual~~Residual                     0.824 
## ICC|mother_pidlink                     0.161 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-26" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-6" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-27" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.107     0.034     0.042     0.173     3.203    82.263     0.002     0.494     0.346 
## count_birth_order2/2          0.001     0.030    -0.058     0.060     0.044    38.741     0.965     0.930     0.507 
## count_birth_order1/3          0.010     0.031    -0.051     0.072     0.325   126.245     0.745     0.364     0.278 
## count_birth_order2/3         -0.011     0.031    -0.072     0.049    -0.369   150.816     0.713     0.323     0.254 
## count_birth_order3/3         -0.020     0.036    -0.090     0.051    -0.549    41.929     0.586     0.863     0.487 
## count_birth_order1/4          0.042     0.042    -0.041     0.125     0.991    70.020     0.325     0.559     0.376 
## count_birth_order2/4          0.000     0.043    -0.084     0.085     0.009    64.505     0.993     0.596     0.392 
## count_birth_order3/4         -0.030     0.040    -0.109     0.049    -0.741    78.713     0.461     0.511     0.354 
## count_birth_order4/4         -0.009     0.041    -0.088     0.071    -0.211    57.947     0.834     0.650     0.414 
## count_birth_order1/5          0.002     0.048    -0.092     0.095     0.033   194.734     0.974     0.274     0.223 
## count_birth_order2/5          0.043     0.056    -0.068     0.153     0.758    52.223     0.452     0.710     0.436 
## count_birth_order3/5         -0.000     0.047    -0.092     0.092    -0.006   150.895     0.995     0.323     0.254 
## count_birth_order4/5         -0.034     0.051    -0.133     0.066    -0.660    65.634     0.512     0.588     0.389 
## count_birth_order5/5         -0.028     0.043    -0.113     0.058    -0.634   130.434     0.527     0.356     0.274 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.477    85.269     0.635     0.481     0.340 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.464   137.438     0.145     0.344     0.266 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.878   134.872     0.381     0.348     0.269 
## male                         -0.008     0.015    -0.038     0.022    -0.504   104.271     0.615     0.416     0.307 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.156 
## Residual~~Residual                     0.820 
## ICC|mother_pidlink                     0.160 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-27" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-6" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1529.893        8  206.051    0.000    0.181 
##   2 vs 3:    2.983        3   23.086    0.052    1.125 
##   3 vs 4:    4.970        1   58.833    0.030    0.642 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-3" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-7" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-28" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.124     0.025     0.074     0.174     4.877    35.914     0.000     1.002     0.526 
## poly(age, 3, raw = TRUE)1     0.001     0.003    -0.005     0.006     0.207    72.799     0.837     0.542     0.369 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.003   319.947     0.046     0.202     0.173 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.483   773.161     0.138     0.121     0.110 
## male                          0.001     0.014    -0.026     0.027     0.045    62.862     0.965     0.609     0.397 
## sibling_count                -0.009     0.007    -0.023     0.005    -1.222    37.248     0.229     0.967     0.517 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.162 
## Residual~~Residual                     0.820 
## ICC|mother_pidlink                     0.165 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-28" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-7" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-29" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.134     0.026     0.083     0.185     5.147    39.453     0.000     0.914     0.502 
## birth_order                  -0.011     0.008    -0.027     0.005    -1.381    52.554     0.173     0.706     0.435 
## poly(age, 3, raw = TRUE)1     0.000     0.003    -0.006     0.006     0.032    70.928     0.974     0.553     0.374 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.897   277.032     0.059     0.220     0.186 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.428   658.298     0.154     0.132     0.120 
## male                          0.001     0.014    -0.026     0.027     0.049    60.861     0.961     0.625     0.404 
## sibling_count                -0.003     0.008    -0.018     0.013    -0.339    63.771     0.736     0.602     0.394 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.162 
## Residual~~Residual                     0.820 
## ICC|mother_pidlink                     0.165 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-29" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-7" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-30" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.127     0.025     0.077     0.176     5.029    46.462     0.000     0.786     0.463 
## birth_order_nonlinear2       -0.019     0.017    -0.052     0.014    -1.142    48.664     0.259     0.755     0.452 
## birth_order_nonlinear3       -0.040     0.020    -0.080    -0.000    -1.980   150.739     0.049     0.323     0.254 
## birth_order_nonlinear4       -0.034     0.032    -0.097     0.028    -1.073    67.348     0.287     0.576     0.384 
## birth_order_nonlinear5       -0.056     0.057    -0.168     0.056    -0.978    35.093     0.335     1.026     0.532 
## poly(age, 3, raw = TRUE)1    -0.000     0.003    -0.006     0.006    -0.106    74.260     0.916     0.534     0.365 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.650   227.350     0.100     0.248     0.206 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.188   406.106     0.235     0.175     0.153 
## male                         -0.000     0.014    -0.027     0.026    -0.035    68.446     0.972     0.569     0.380 
## sibling_count                -0.001     0.008    -0.016     0.015    -0.086    68.770     0.932     0.567     0.380 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.161 
## Residual~~Residual                     0.820 
## ICC|mother_pidlink                     0.164 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-30" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-7" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-31" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.096     0.035     0.026     0.165     2.708    40.268     0.010     0.897     0.497 
## count_birth_order2/2         -0.002     0.030    -0.061     0.057    -0.064    26.569     0.949     1.392     0.610 
## count_birth_order1/3          0.025     0.031    -0.035     0.086     0.819    71.813     0.416     0.548     0.371 
## count_birth_order2/3         -0.014     0.028    -0.069     0.041    -0.495    89.538     0.622     0.464     0.332 
## count_birth_order3/3         -0.008     0.034    -0.075     0.058    -0.246    40.115     0.807     0.900     0.498 
## count_birth_order1/4          0.011     0.052    -0.091     0.113     0.210    26.905     0.835     1.372     0.607 
## count_birth_order2/4         -0.014     0.038    -0.087     0.060    -0.362    81.586     0.719     0.497     0.348 
## count_birth_order3/4         -0.046     0.040    -0.124     0.032    -1.152    58.051     0.254     0.649     0.414 
## count_birth_order4/4         -0.029     0.035    -0.097     0.039    -0.832   390.887     0.406     0.179     0.156 
## count_birth_order1/5         -0.007     0.066    -0.135     0.122    -0.103    34.856     0.918     1.033     0.534 
## count_birth_order2/5         -0.064     0.053    -0.167     0.039    -1.225    74.315     0.224     0.534     0.365 
## count_birth_order3/5         -0.088     0.046    -0.178     0.002    -1.923   193.282     0.056     0.275     0.224 
## count_birth_order4/5         -0.046     0.057    -0.157     0.065    -0.808    36.936     0.424     0.975     0.519 
## count_birth_order5/5         -0.063     0.059    -0.179     0.053    -1.061    39.018     0.295     0.924     0.505 
## poly(age, 3, raw = TRUE)1     0.002     0.004    -0.006     0.010     0.588    40.961     0.560     0.882     0.493 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.710    59.466     0.092     0.637     0.409 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.272    80.635     0.207     0.502     0.350 
## male                         -0.003     0.014    -0.031     0.026    -0.191   103.552     0.849     0.418     0.308 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.161 
## Residual~~Residual                     0.817 
## ICC|mother_pidlink                     0.165 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-31" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-7" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1292.535        8   26.991    0.000    0.732 
##   2 vs 3:  319.330        3   13.326    0.000    2.300 
##   3 vs 4:  105.155        1   35.382    0.000    1.018 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-3" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
</div>
</div>
<div id="delayed-word-recall" class="section level3 tabset">
<h3>Delayed Word Recall</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = words_delayed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-4" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-8" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-32" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.507     0.034     0.440     0.573    14.883    17.458     0.000     2.546     0.746 
## poly(age, 3, raw = TRUE)1    -0.022     0.003    -0.028    -0.016    -6.773    42.029     0.000     0.861     0.487 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.321    66.580     0.750     0.581     0.386 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.745    74.206     0.085     0.534     0.365 
## male                         -0.032     0.013    -0.058    -0.006    -2.432   102.971     0.017     0.420     0.309 
## sibling_count                 0.003     0.006    -0.009     0.015     0.469    89.965     0.640     0.463     0.331 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-32" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-8" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-33" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.508     0.033     0.444     0.572    15.560    20.571     0.000     1.954     0.690 
## birth_order                  -0.001     0.010    -0.021     0.018    -0.148    30.206     0.883     1.202     0.573 
## poly(age, 3, raw = TRUE)1    -0.022     0.003    -0.029    -0.015    -6.542    38.799     0.000     0.929     0.506 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.335    57.761     0.739     0.652     0.415 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.731    67.187     0.088     0.577     0.384 
## male                         -0.032     0.013    -0.058    -0.006    -2.426   101.065     0.017     0.425     0.312 
## sibling_count                 0.004     0.010    -0.016     0.023     0.377    27.283     0.709     1.349     0.602 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-33" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-8" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-34" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.504     0.034     0.438     0.570    15.014    18.595     0.000     2.286     0.724 
## birth_order_nonlinear2        0.008     0.019    -0.030     0.046     0.392    35.336     0.697     1.019     0.531 
## birth_order_nonlinear3       -0.003     0.027    -0.055     0.050    -0.102    31.643     0.919     1.143     0.560 
## birth_order_nonlinear4       -0.010     0.037    -0.083     0.062    -0.278    31.327     0.783     1.155     0.563 
## birth_order_nonlinear5        0.002     0.045    -0.087     0.091     0.045    66.925     0.964     0.579     0.385 
## poly(age, 3, raw = TRUE)1    -0.022     0.003    -0.029    -0.015    -6.553    39.853     0.000     0.906     0.500 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.313    59.613     0.755     0.635     0.408 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.708    69.163     0.092     0.564     0.378 
## male                         -0.032     0.013    -0.058    -0.006    -2.434   100.028     0.017     0.428     0.314 
## sibling_count                 0.004     0.010    -0.016     0.023     0.375    27.114     0.711     1.359     0.604 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.759 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-34" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-8" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-35" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.515     0.035     0.447     0.584    14.661    42.751     0.000     0.848     0.482 
## count_birth_order2/2          0.005     0.031    -0.055     0.065     0.159    30.883     0.874     1.173     0.567 
## count_birth_order1/3          0.015     0.035    -0.053     0.083     0.430    41.964     0.669     0.863     0.487 
## count_birth_order2/3          0.007     0.028    -0.048     0.062     0.238   278.178     0.812     0.219     0.186 
## count_birth_order3/3          0.010     0.030    -0.048     0.068     0.346   103.973     0.730     0.417     0.307 
## count_birth_order1/4          0.011     0.042    -0.072     0.095     0.271    49.695     0.787     0.741     0.447 
## count_birth_order2/4          0.044     0.039    -0.032     0.119     1.135    98.122     0.259     0.434     0.317 
## count_birth_order3/4         -0.003     0.035    -0.071     0.064    -0.101   237.616     0.920     0.242     0.201 
## count_birth_order4/4          0.004     0.037    -0.068     0.075     0.096    82.159     0.924     0.495     0.347 
## count_birth_order1/5         -0.026     0.047    -0.118     0.066    -0.550   125.503     0.583     0.366     0.279 
## count_birth_order2/5          0.011     0.048    -0.084     0.106     0.231   105.910     0.818     0.411     0.305 
## count_birth_order3/5          0.001     0.048    -0.092     0.095     0.022    77.001     0.983     0.519     0.358 
## count_birth_order4/5         -0.007     0.039    -0.084     0.070    -0.176  2461.694     0.860     0.064     0.061 
## count_birth_order5/5          0.012     0.041    -0.068     0.092     0.292   132.573     0.771     0.352     0.271 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.033    -0.016    -5.648    39.715     0.000     0.909     0.501 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.235    55.965     0.222     0.669     0.421 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.272    78.879     0.026     0.510     0.354 
## male                         -0.037     0.014    -0.065    -0.009    -2.581   122.253     0.011     0.372     0.283 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.760 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-35" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-8" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1609.618        8 1419.519    0.000    0.062 
##   2 vs 3:    4.106        3   43.296    0.012    0.630 
##   3 vs 4:    1.409        1   27.285    0.246    1.349 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-4" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-9" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-36" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.522     0.035     0.454     0.591    14.880    15.192     0.000     3.342     0.795 
## poly(age, 3, raw = TRUE)1    -0.024     0.003    -0.030    -0.018    -7.566    36.055     0.000     0.998     0.525 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.119    52.578     0.268     0.706     0.435 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.522    58.745     0.014     0.643     0.411 
## male                         -0.039     0.011    -0.061    -0.017    -3.501   268.251     0.001     0.224     0.189 
## sibling_count                -0.001     0.007    -0.016     0.013    -0.187    27.508     0.853     1.336     0.600 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.113 
## Residual~~Residual                     0.756 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-36" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-9" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-37" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.517     0.035     0.449     0.586    14.758    16.102     0.000     2.962     0.774 
## birth_order                   0.005     0.008    -0.011     0.022     0.625    35.403     0.536     1.017     0.530 
## poly(age, 3, raw = TRUE)1    -0.024     0.003    -0.030    -0.017    -7.430    35.736     0.000     1.007     0.528 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.082    52.416     0.284     0.708     0.436 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.498    58.121     0.015     0.649     0.413 
## male                         -0.039     0.011    -0.061    -0.017    -3.470   240.836     0.001     0.240     0.200 
## sibling_count                -0.004     0.009    -0.023     0.015    -0.416    23.085     0.682     1.662     0.653 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.113 
## Residual~~Residual                     0.756 
## ICC|mother_pidlink                     0.130 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-37" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-9" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-38" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.524     0.034     0.457     0.591    15.296    16.694     0.000     2.763     0.761 
## birth_order_nonlinear2        0.005     0.019    -0.031     0.042     0.274    27.082     0.786     1.361     0.605 
## birth_order_nonlinear3        0.010     0.023    -0.035     0.055     0.421    42.129     0.676     0.859     0.486 
## birth_order_nonlinear4       -0.008     0.031    -0.069     0.054    -0.239    54.210     0.812     0.688     0.428 
## birth_order_nonlinear5        0.009     0.048    -0.085     0.102     0.184    69.911     0.854     0.560     0.376 
## poly(age, 3, raw = TRUE)1    -0.024     0.003    -0.031    -0.017    -7.161    31.677     0.000     1.141     0.560 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.209    46.874     0.233     0.780     0.461 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.605    55.150     0.012     0.678     0.424 
## male                         -0.041     0.012    -0.064    -0.018    -3.538   181.799     0.001     0.286     0.231 
## sibling_count                -0.003     0.009    -0.021     0.015    -0.307    26.254     0.761     1.412     0.614 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.756 
## ICC|mother_pidlink                     0.129 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-38" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-9" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-39" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.520     0.034     0.454     0.587    15.343    36.663     0.000     0.982     0.521 
## count_birth_order2/2          0.000     0.031    -0.061     0.061     0.001    22.026     0.999     1.772     0.668 
## count_birth_order1/3          0.018     0.035    -0.050     0.086     0.529    30.721     0.600     1.180     0.568 
## count_birth_order2/3          0.024     0.026    -0.027     0.075     0.911   108.201     0.364     0.405     0.301 
## count_birth_order3/3          0.029     0.030    -0.031     0.088     0.946    55.978     0.348     0.669     0.421 
## count_birth_order1/4          0.001     0.048    -0.093     0.096     0.030    28.450     0.976     1.285     0.590 
## count_birth_order2/4          0.005     0.035    -0.063     0.072     0.133   103.449     0.894     0.418     0.308 
## count_birth_order3/4         -0.011     0.038    -0.085     0.063    -0.292    55.204     0.771     0.677     0.424 
## count_birth_order4/4         -0.008     0.035    -0.076     0.059    -0.245   151.473     0.807     0.322     0.254 
## count_birth_order1/5         -0.056     0.049    -0.153     0.041    -1.136   187.235     0.257     0.281     0.227 
## count_birth_order2/5         -0.026     0.047    -0.117     0.066    -0.551   131.617     0.582     0.354     0.272 
## count_birth_order3/5         -0.016     0.047    -0.108     0.077    -0.329    78.850     0.743     0.510     0.354 
## count_birth_order4/5         -0.036     0.054    -0.142     0.070    -0.666    35.166     0.510     1.024     0.532 
## count_birth_order5/5          0.008     0.052    -0.094     0.111     0.159    53.476     0.874     0.696     0.431 
## poly(age, 3, raw = TRUE)1    -0.025     0.004    -0.033    -0.016    -5.762    26.240     0.000     1.413     0.614 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.153    26.882     0.259     1.373     0.607 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.084    26.486     0.047     1.398     0.611 
## male                         -0.048     0.014    -0.075    -0.022    -3.551   113.486     0.001     0.392     0.294 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.111 
## Residual~~Residual                     0.756 
## ICC|mother_pidlink                     0.128 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-39" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-9" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1046.460        8   18.470    0.000    1.045 
##   2 vs 3:  407.963        3   18.236    0.000    1.474 
##   3 vs 4:   91.022        1   28.077    0.000    1.305 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-4" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
</div>
</div>
<div id="adaptive-numbering" class="section level3 tabset">
<h3>Adaptive Numbering</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = adaptive_numbering)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-5" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-10" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-40" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.281     0.031     0.221     0.342     9.133    23.015     0.000     1.669     0.654 
## poly(age, 3, raw = TRUE)1    -0.013     0.003    -0.019    -0.006    -3.709    40.659     0.001     0.889     0.495 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.355    76.998     0.179     0.519     0.358 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.539    81.830     0.001     0.496     0.347 
## male                          0.014     0.016    -0.017     0.045     0.900    45.440     0.373     0.802     0.468 
## sibling_count                 0.004     0.007    -0.010     0.017     0.554    53.057     0.582     0.700     0.433 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.860 
## ICC|mother_pidlink                     0.099 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-40" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-10" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-41" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.284     0.031     0.223     0.345     9.070    25.034     0.000     1.497     0.628 
## birth_order                  -0.003     0.009    -0.020     0.014    -0.350    78.158     0.727     0.514     0.356 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.020    -0.006    -3.635    37.818     0.001     0.952     0.513 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.372    69.373     0.175     0.563     0.378 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.534    77.693     0.001     0.516     0.357 
## male                          0.014     0.016    -0.017     0.045     0.902    45.078     0.372     0.808     0.470 
## sibling_count                 0.006     0.009    -0.012     0.023     0.623    47.371     0.536     0.773     0.458 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.860 
## ICC|mother_pidlink                     0.100 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-41" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-10" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-42" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.274     0.032     0.210     0.337     8.483    21.907     0.000     1.785     0.670 
## birth_order_nonlinear2        0.017     0.021    -0.023     0.058     0.839    33.749     0.407     1.068     0.543 
## birth_order_nonlinear3        0.005     0.023    -0.040     0.050     0.229   110.192     0.819     0.400     0.298 
## birth_order_nonlinear4       -0.023     0.037    -0.096     0.049    -0.631    39.060     0.532     0.923     0.505 
## birth_order_nonlinear5       -0.012     0.051    -0.111     0.088    -0.232    47.948     0.817     0.764     0.455 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.020    -0.006    -3.598    38.882     0.001     0.927     0.506 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.307    70.222     0.195     0.558     0.376 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.438    75.000     0.001     0.530     0.363 
## male                          0.014     0.016    -0.017     0.045     0.880    44.075     0.384     0.824     0.475 
## sibling_count                 0.005     0.009    -0.012     0.023     0.615    50.311     0.541     0.733     0.445 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.095 
## Residual~~Residual                     0.860 
## ICC|mother_pidlink                     0.099 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-42" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-10" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-43" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.275     0.045     0.187     0.364     6.083    21.276     0.000     1.860     0.679 
## count_birth_order2/2          0.016     0.030    -0.044     0.075     0.524    38.592     0.603     0.934     0.508 
## count_birth_order1/3          0.002     0.032    -0.061     0.064     0.047    92.283     0.962     0.454     0.327 
## count_birth_order2/3          0.009     0.037    -0.064     0.082     0.248    35.944     0.805     1.002     0.526 
## count_birth_order3/3          0.029     0.031    -0.032     0.090     0.921    91.416     0.360     0.457     0.328 
## count_birth_order1/4         -0.029     0.036    -0.099     0.041    -0.816   599.007     0.415     0.140     0.125 
## count_birth_order2/4          0.000     0.043    -0.083     0.084     0.008    61.347     0.994     0.621     0.402 
## count_birth_order3/4         -0.022     0.045    -0.110     0.066    -0.494    38.425     0.624     0.938     0.509 
## count_birth_order4/4         -0.010     0.046    -0.101     0.081    -0.216    29.238     0.831     1.246     0.582 
## count_birth_order1/5         -0.005     0.044    -0.090     0.081    -0.110  1252.483     0.912     0.093     0.086 
## count_birth_order2/5          0.041     0.048    -0.052     0.134     0.864   217.692     0.388     0.255     0.211 
## count_birth_order3/5         -0.025     0.044    -0.112     0.062    -0.564   288.743     0.573     0.214     0.182 
## count_birth_order4/5         -0.041     0.052    -0.143     0.061    -0.782    51.429     0.438     0.719     0.440 
## count_birth_order5/5         -0.003     0.047    -0.096     0.089    -0.072    57.247     0.943     0.657     0.417 
## poly(age, 3, raw = TRUE)1    -0.012     0.005    -0.022    -0.002    -2.351    25.934     0.027     1.434     0.617 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.214    39.542     0.232     0.912     0.502 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.587    44.835     0.013     0.812     0.471 
## male                          0.002     0.015    -0.028     0.031     0.101   109.409     0.920     0.402     0.300 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.091 
## Residual~~Residual                     0.847 
## ICC|mother_pidlink                     0.097 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-43" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-10" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1627.789        8  427.821    0.000    0.119 
##   2 vs 3:    3.988        3   27.478    0.018    0.943 
##   3 vs 4:    1.312        1   34.346    0.260    1.049 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-5" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-11" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-44" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.302     0.028     0.248     0.356    10.919    25.301     0.000     1.478     0.625 
## poly(age, 3, raw = TRUE)1    -0.015     0.003    -0.022    -0.008    -4.355    30.051     0.000     1.209     0.575 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.099    48.456     0.041     0.757     0.453 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.127    54.468     0.000     0.685     0.427 
## male                          0.014     0.014    -0.013     0.041     1.003    51.550     0.320     0.718     0.439 
## sibling_count                -0.005     0.006    -0.017     0.008    -0.719    60.793     0.475     0.625     0.404 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.100 
## Residual~~Residual                     0.850 
## ICC|mother_pidlink                     0.106 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-44" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-11" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-45" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.290     0.027     0.237     0.344    10.612    29.738     0.000     1.223     0.578 
## birth_order                   0.012     0.008    -0.003     0.027     1.581    74.419     0.118     0.533     0.365 
## poly(age, 3, raw = TRUE)1    -0.015     0.003    -0.021    -0.008    -4.175    30.204     0.000     1.202     0.573 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     1.997    47.380     0.052     0.773     0.458 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.059    53.584     0.000     0.694     0.431 
## male                          0.014     0.014    -0.013     0.042     1.024    52.075     0.311     0.712     0.437 
## sibling_count                -0.011     0.007    -0.025     0.004    -1.481    89.324     0.142     0.465     0.332 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.100 
## Residual~~Residual                     0.851 
## ICC|mother_pidlink                     0.105 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-45" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-11" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-46" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.304     0.029     0.247     0.362    10.411    24.687     0.000     1.524     0.632 
## birth_order_nonlinear2        0.009     0.017    -0.024     0.042     0.538    52.562     0.593     0.706     0.435 
## birth_order_nonlinear3        0.014     0.028    -0.040     0.068     0.517    26.108     0.609     1.422     0.616 
## birth_order_nonlinear4        0.011     0.039    -0.065     0.088     0.288    27.419     0.775     1.341     0.601 
## birth_order_nonlinear5        0.001     0.052    -0.101     0.103     0.016    55.114     0.987     0.678     0.425 
## poly(age, 3, raw = TRUE)1    -0.015     0.003    -0.022    -0.008    -4.217    31.886     0.000     1.133     0.558 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.086    46.980     0.042     0.778     0.460 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -4.079    50.514     0.000     0.730     0.444 
## male                          0.011     0.014    -0.017     0.038     0.757    55.823     0.452     0.671     0.422 
## sibling_count                -0.008     0.008    -0.023     0.007    -1.085    78.808     0.281     0.510     0.354 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.097 
## Residual~~Residual                     0.850 
## ICC|mother_pidlink                     0.103 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-46" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-11" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-47" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.262     0.037     0.189     0.336     6.998    29.342     0.000     1.241     0.581 
## count_birth_order2/2          0.014     0.028    -0.041     0.069     0.487    33.800     0.629     1.066     0.542 
## count_birth_order1/3          0.001     0.038    -0.073     0.075     0.026    26.948     0.979     1.369     0.606 
## count_birth_order2/3          0.008     0.033    -0.057     0.073     0.231    33.202     0.819     1.086     0.547 
## count_birth_order3/3          0.035     0.040    -0.042     0.113     0.892    23.023     0.381     1.668     0.654 
## count_birth_order1/4         -0.040     0.042    -0.123     0.042    -0.961    67.380     0.340     0.576     0.384 
## count_birth_order2/4         -0.027     0.039    -0.104     0.051    -0.680    52.584     0.499     0.706     0.435 
## count_birth_order3/4         -0.033     0.043    -0.118     0.052    -0.766    35.082     0.449     1.026     0.532 
## count_birth_order4/4          0.015     0.049    -0.081     0.110     0.307    26.557     0.762     1.393     0.610 
## count_birth_order1/5         -0.053     0.052    -0.154     0.048    -1.023   182.411     0.308     0.286     0.231 
## count_birth_order2/5         -0.091     0.061    -0.211     0.029    -1.481    31.519     0.149     1.148     0.561 
## count_birth_order3/5         -0.065     0.048    -0.159     0.029    -1.351    97.190     0.180     0.437     0.318 
## count_birth_order4/5         -0.058     0.055    -0.166     0.049    -1.061    39.579     0.295     0.912     0.501 
## count_birth_order5/5         -0.035     0.059    -0.150     0.080    -0.592    37.657     0.557     0.956     0.514 
## poly(age, 3, raw = TRUE)1    -0.011     0.004    -0.020    -0.003    -2.594    28.614     0.015     1.277     0.589 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.204    41.942     0.235     0.863     0.487 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.078    48.033     0.003     0.763     0.455 
## male                          0.007     0.014    -0.021     0.035     0.482    98.175     0.631     0.434     0.317 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.096 
## Residual~~Residual                     0.847 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-47" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-11" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1200.955        8   22.862    0.000    0.849 
##   2 vs 3:  431.210        3   18.009    0.000    1.497 
##   3 vs 4:  103.472        1   38.609    0.000    0.934 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-5" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2015-young" class="section level3 tabset">
<h3>g-factor 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-6" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-12" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-48" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.531     0.032    -0.594    -0.468   -16.572    20.178     0.000     2.011     0.697 
## poly(age, 3, raw = TRUE)1     0.039     0.003     0.033     0.045    13.245    75.762     0.000     0.526     0.361 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.964    86.604     0.000     0.476     0.337 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.141    86.185     0.035     0.477     0.338 
## male                         -0.068     0.015    -0.098    -0.038    -4.414    36.903     0.000     0.976     0.519 
## sibling_count                 0.004     0.007    -0.010     0.017     0.559    59.916     0.578     0.633     0.407 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.238 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-48" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-12" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-49" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.523     0.034    -0.591    -0.456   -15.189    19.315     0.000     2.151     0.711 
## birth_order                  -0.008     0.008    -0.023     0.007    -1.084    90.466     0.281     0.461     0.330 
## poly(age, 3, raw = TRUE)1     0.038     0.003     0.033     0.044    13.011    92.640     0.000     0.453     0.326 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.873   108.877     0.000     0.404     0.300 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.049    93.938     0.043     0.448     0.324 
## male                         -0.068     0.015    -0.098    -0.038    -4.405    37.015     0.000     0.973     0.518 
## sibling_count                 0.009     0.008    -0.006     0.024     1.180   162.131     0.240     0.308     0.245 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.238 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-49" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-12" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-50" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.534     0.034    -0.600    -0.468   -15.906    19.109     0.000     2.188     0.715 
## birth_order_nonlinear2       -0.001     0.021    -0.042     0.041    -0.041    23.907     0.968     1.588     0.642 
## birth_order_nonlinear3       -0.009     0.026    -0.060     0.042    -0.346    30.974     0.732     1.169     0.566 
## birth_order_nonlinear4       -0.046     0.028    -0.100     0.008    -1.658   167.706     0.099     0.302     0.241 
## birth_order_nonlinear5       -0.014     0.039    -0.091     0.062    -0.369   208.597     0.713     0.262     0.215 
## poly(age, 3, raw = TRUE)1     0.038     0.003     0.033     0.044    12.899    84.828     0.000     0.483     0.341 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.901   107.517     0.000     0.407     0.302 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.075    90.046     0.041     0.462     0.331 
## male                         -0.068     0.015    -0.098    -0.037    -4.379    35.828     0.000     1.005     0.527 
## sibling_count                 0.009     0.008    -0.006     0.024     1.166   161.536     0.245     0.309     0.245 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.210 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-50" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-12" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-51" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.549     0.045    -0.636    -0.461   -12.324    20.962     0.000     1.901     0.684 
## count_birth_order2/2          0.010     0.027    -0.043     0.062     0.366    43.111     0.716     0.841     0.480 
## count_birth_order1/3          0.005     0.030    -0.054     0.063     0.154   117.668     0.878     0.382     0.289 
## count_birth_order2/3         -0.007     0.036    -0.077     0.064    -0.186    36.967     0.854     0.974     0.519 
## count_birth_order3/3          0.014     0.033    -0.050     0.078     0.420    51.531     0.676     0.718     0.439 
## count_birth_order1/4         -0.010     0.043    -0.095     0.074    -0.237    45.590     0.814     0.800     0.467 
## count_birth_order2/4         -0.002     0.035    -0.071     0.067    -0.054   314.918     0.957     0.203     0.174 
## count_birth_order3/4         -0.043     0.038    -0.118     0.032    -1.125    75.270     0.264     0.529     0.363 
## count_birth_order4/4         -0.024     0.033    -0.090     0.041    -0.733   238.153     0.464     0.241     0.201 
## count_birth_order1/5          0.004     0.054    -0.101     0.109     0.083    45.741     0.934     0.797     0.466 
## count_birth_order2/5          0.006     0.045    -0.082     0.094     0.133   272.331     0.894     0.222     0.188 
## count_birth_order3/5          0.030     0.048    -0.063     0.124     0.635    74.415     0.528     0.533     0.365 
## count_birth_order4/5         -0.051     0.047    -0.143     0.041    -1.088    78.627     0.280     0.511     0.355 
## count_birth_order5/5          0.009     0.042    -0.074     0.092     0.219    98.774     0.827     0.432     0.316 
## poly(age, 3, raw = TRUE)1     0.043     0.004     0.035     0.051    10.541    62.056     0.000     0.615     0.400 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.000    -3.502   185.145     0.001     0.283     0.229 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.694   277.014     0.091     0.220     0.186 
## male                         -0.075     0.019    -0.112    -0.037    -3.942    25.228     0.001     1.483     0.626 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.209 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.237 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-51" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-12" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1454.924        8  192.789    0.000    0.188 
##   2 vs 3:    3.934        3   32.331    0.017    0.810 
##   3 vs 4:    2.116        1   40.586    0.153    0.890 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-6" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-13" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-52" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.508     0.034    -0.575    -0.441   -14.899    16.234     0.000     2.915     0.771 
## poly(age, 3, raw = TRUE)1     0.038     0.003     0.033     0.044    13.208    59.128     0.000     0.640     0.410 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.650    59.094     0.001     0.640     0.410 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.887    67.048     0.064     0.578     0.384 
## male                         -0.068     0.014    -0.096    -0.041    -4.840    35.654     0.000     1.010     0.528 
## sibling_count                -0.009     0.007    -0.024     0.006    -1.193    31.541     0.242     1.147     0.561 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.214 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-52" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-13" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-53" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.506     0.035    -0.575    -0.437   -14.339    16.514     0.000     2.820     0.765 
## birth_order                  -0.004     0.007    -0.018     0.011    -0.488    56.445     0.628     0.665     0.420 
## poly(age, 3, raw = TRUE)1     0.038     0.003     0.032     0.044    13.201    63.636     0.000     0.603     0.395 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.614    57.960     0.001     0.650     0.414 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.870    64.362     0.066     0.597     0.393 
## male                         -0.068     0.014    -0.096    -0.040    -4.789    34.394     0.000     1.047     0.538 
## sibling_count                -0.007     0.008    -0.022     0.008    -0.860    61.953     0.393     0.616     0.400 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.214 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.240 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-53" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-13" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-54" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.508     0.037    -0.581    -0.436   -13.720    15.415     0.000     3.239     0.790 
## birth_order_nonlinear2       -0.001     0.017    -0.035     0.033    -0.062    30.610     0.951     1.185     0.569 
## birth_order_nonlinear3       -0.010     0.022    -0.054     0.034    -0.432    40.570     0.668     0.890     0.495 
## birth_order_nonlinear4       -0.024     0.028    -0.079     0.030    -0.869   103.408     0.387     0.418     0.308 
## birth_order_nonlinear5       -0.068     0.045    -0.157     0.021    -1.505    83.666     0.136     0.488     0.343 
## poly(age, 3, raw = TRUE)1     0.038     0.003     0.032     0.044    12.834    60.070     0.000     0.632     0.407 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.493    63.671     0.001     0.602     0.395 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.733    75.077     0.087     0.530     0.363 
## male                         -0.070     0.015    -0.098    -0.041    -4.759    33.617     0.000     1.072     0.544 
## sibling_count                -0.006     0.008    -0.023     0.010    -0.715    43.800     0.479     0.829     0.477 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.214 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.241 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-54" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-13" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-55" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.561     0.039    -0.638    -0.485   -14.403    24.910     0.000     1.507     0.630 
## count_birth_order2/2          0.016     0.024    -0.031     0.062     0.666    49.769     0.509     0.740     0.447 
## count_birth_order1/3          0.013     0.030    -0.046     0.072     0.430    57.736     0.669     0.652     0.415 
## count_birth_order2/3         -0.005     0.031    -0.066     0.056    -0.173    35.996     0.863     1.000     0.526 
## count_birth_order3/3          0.015     0.028    -0.040     0.069     0.526   103.797     0.600     0.417     0.308 
## count_birth_order1/4         -0.024     0.042    -0.107     0.059    -0.574    48.026     0.568     0.763     0.455 
## count_birth_order2/4         -0.038     0.037    -0.110     0.034    -1.026    61.523     0.309     0.619     0.402 
## count_birth_order3/4         -0.050     0.038    -0.125     0.025    -1.313    51.423     0.195     0.719     0.440 
## count_birth_order4/4         -0.004     0.035    -0.072     0.064    -0.119   142.172     0.906     0.336     0.262 
## count_birth_order1/5         -0.054     0.050    -0.151     0.044    -1.072   140.765     0.285     0.338     0.263 
## count_birth_order2/5         -0.076     0.055    -0.185     0.032    -1.380    39.053     0.176     0.923     0.505 
## count_birth_order3/5         -0.080     0.062    -0.201     0.041    -1.294    23.884     0.208     1.590     0.643 
## count_birth_order4/5         -0.132     0.069    -0.267     0.003    -1.923    18.640     0.070     2.277     0.723 
## count_birth_order5/5         -0.120     0.047    -0.211    -0.029    -2.572   133.126     0.011     0.351     0.271 
## poly(age, 3, raw = TRUE)1     0.043     0.004     0.036     0.051    11.102    40.059     0.000     0.901     0.498 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.000    -3.698    43.740     0.001     0.830     0.477 
## poly(age, 3, raw = TRUE)3     0.000     0.000     0.000     0.000     2.003    45.037     0.051     0.808     0.470 
## male                         -0.072     0.017    -0.105    -0.040    -4.328    30.458     0.000     1.191     0.571 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.215 
## Residual~~Residual                     0.670 
## ICC|mother_pidlink                     0.243 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-55" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-13" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1167.828        8   22.978    0.000    0.846 
##   2 vs 3:  369.577        3   16.072    0.000    1.737 
##   3 vs 4:  114.718        1   57.666    0.000    0.653 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-6" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2015-young" class="section level3 tabset">
<h3>Raven 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-7" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-14" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-56" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.654     0.033    -0.720    -0.589   -19.598    17.942     0.000     2.428     0.736 
## poly(age, 3, raw = TRUE)1     0.042     0.003     0.036     0.048    13.004    38.913     0.000     0.926     0.506 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.468    39.550     0.001     0.912     0.502 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.806    34.130     0.080     1.056     0.540 
## male                          0.014     0.013    -0.011     0.040     1.125    90.161     0.264     0.462     0.331 
## sibling_count                 0.006     0.008    -0.009     0.021     0.774    32.095     0.445     1.126     0.556 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.637 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-56" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-14" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-57" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.646     0.034    -0.713    -0.578   -18.782    18.552     0.000     2.295     0.725 
## birth_order                  -0.009     0.007    -0.023     0.005    -1.208   120.884     0.229     0.375     0.285 
## poly(age, 3, raw = TRUE)1     0.041     0.003     0.035     0.048    12.751    43.088     0.000     0.842     0.481 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.331    41.525     0.002     0.871     0.490 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.712    34.805     0.096     1.035     0.535 
## male                          0.015     0.013    -0.011     0.040     1.138    89.004     0.258     0.466     0.333 
## sibling_count                 0.011     0.008    -0.004     0.027     1.443    89.179     0.152     0.466     0.332 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.637 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-57" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-14" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-58" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.656     0.034    -0.723    -0.589   -19.136    17.695     0.000     2.487     0.741 
## birth_order_nonlinear2       -0.005     0.018    -0.040     0.030    -0.275    37.140     0.785     0.970     0.518 
## birth_order_nonlinear3       -0.013     0.022    -0.057     0.031    -0.564    49.933     0.575     0.738     0.446 
## birth_order_nonlinear4       -0.041     0.027    -0.094     0.013    -1.477   125.600     0.142     0.366     0.279 
## birth_order_nonlinear5       -0.021     0.039    -0.097     0.055    -0.544   151.587     0.587     0.322     0.253 
## poly(age, 3, raw = TRUE)1     0.041     0.003     0.035     0.048    12.726    42.589     0.000     0.851     0.483 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.342    41.186     0.002     0.878     0.492 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.721    34.049     0.094     1.058     0.540 
## male                          0.015     0.013    -0.011     0.040     1.131    87.220     0.261     0.473     0.336 
## sibling_count                 0.011     0.008    -0.004     0.026     1.439    91.792     0.154     0.456     0.328 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.205 
## Residual~~Residual                     0.637 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-58" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-14" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-59" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.656     0.044    -0.741    -0.570   -14.987    20.615     0.000     1.948     0.689 
## count_birth_order2/2         -0.003     0.026    -0.054     0.048    -0.126    43.373     0.900     0.837     0.479 
## count_birth_order1/3         -0.013     0.031    -0.073     0.047    -0.420    78.772     0.676     0.511     0.354 
## count_birth_order2/3         -0.021     0.034    -0.088     0.046    -0.616    39.481     0.541     0.914     0.502 
## count_birth_order3/3          0.013     0.028    -0.042     0.068     0.471   154.856     0.638     0.318     0.251 
## count_birth_order1/4          0.006     0.038    -0.069     0.081     0.156    82.077     0.876     0.495     0.347 
## count_birth_order2/4          0.017     0.036    -0.053     0.086     0.468   175.879     0.641     0.292     0.235 
## count_birth_order3/4         -0.060     0.041    -0.141     0.021    -1.454    40.891     0.154     0.884     0.493 
## count_birth_order4/4         -0.019     0.034    -0.085     0.048    -0.544   123.388     0.588     0.370     0.282 
## count_birth_order1/5          0.009     0.046    -0.080     0.098     0.194   124.062     0.846     0.369     0.281 
## count_birth_order2/5          0.010     0.048    -0.083     0.103     0.207    92.539     0.836     0.453     0.326 
## count_birth_order3/5          0.022     0.049    -0.073     0.117     0.459    55.713     0.648     0.672     0.422 
## count_birth_order4/5         -0.043     0.045    -0.131     0.044    -0.972    94.412     0.334     0.447     0.323 
## count_birth_order5/5          0.003     0.040    -0.075     0.081     0.077   145.050     0.938     0.332     0.259 
## poly(age, 3, raw = TRUE)1     0.045     0.004     0.036     0.053    10.444    41.277     0.000     0.876     0.491 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.821    59.671     0.007     0.635     0.408 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.170    62.949     0.246     0.608     0.397 
## male                          0.013     0.015    -0.017     0.042     0.851    60.302     0.398     0.630     0.406 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.204 
## Residual~~Residual                     0.635 
## ICC|mother_pidlink                     0.243 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-59" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-14" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1349.376        8  111.598    0.000    0.262 
##   2 vs 3:    3.317        3   29.985    0.033    0.868 
##   3 vs 4:    2.103        1   35.658    0.156    1.010 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-7" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-15" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-60" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.630     0.033    -0.695    -0.564   -18.851    16.197     0.000     2.928     0.772 
## poly(age, 3, raw = TRUE)1     0.042     0.003     0.035     0.048    12.522    29.005     0.000     1.258     0.585 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -3.004    25.609     0.006     1.456     0.621 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.465    24.142     0.156     1.568     0.639 
## male                          0.016     0.012    -0.009     0.040     1.272    60.409     0.208     0.629     0.405 
## sibling_count                -0.008     0.006    -0.020     0.005    -1.207    55.935     0.232     0.670     0.421 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.642 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-60" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-15" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-61" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.626     0.033    -0.692    -0.561   -18.798    17.358     0.000     2.572     0.748 
## birth_order                  -0.003     0.007    -0.017     0.010    -0.512    82.202     0.610     0.495     0.347 
## poly(age, 3, raw = TRUE)1     0.041     0.003     0.035     0.048    12.487    29.933     0.000     1.214     0.576 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.976    25.677     0.006     1.451     0.620 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.451    24.190     0.160     1.564     0.639 
## male                          0.016     0.012    -0.009     0.040     1.268    59.969     0.210     0.632     0.407 
## sibling_count                -0.006     0.007    -0.019     0.008    -0.822   113.037     0.413     0.393     0.295 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.642 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-61" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-15" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-62" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.628     0.036    -0.699    -0.557   -17.307    15.360     0.000     3.264     0.791 
## birth_order_nonlinear2       -0.005     0.016    -0.036     0.026    -0.311    40.767     0.758     0.886     0.494 
## birth_order_nonlinear3       -0.004     0.022    -0.047     0.039    -0.195    39.806     0.846     0.907     0.500 
## birth_order_nonlinear4       -0.025     0.027    -0.078     0.028    -0.926   115.864     0.356     0.386     0.291 
## birth_order_nonlinear5       -0.055     0.045    -0.143     0.033    -1.233    74.154     0.221     0.535     0.365 
## poly(age, 3, raw = TRUE)1     0.041     0.003     0.035     0.048    12.261    29.853     0.000     1.218     0.577 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.935    27.397     0.007     1.343     0.601 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.417    27.250     0.168     1.351     0.603 
## male                          0.015     0.012    -0.009     0.039     1.211    68.699     0.230     0.567     0.380 
## sibling_count                -0.006     0.008    -0.021     0.010    -0.717    62.335     0.476     0.613     0.399 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.207 
## Residual~~Residual                     0.641 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-62" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-15" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-63" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.672     0.038    -0.747    -0.597   -17.565    24.521     0.000     1.537     0.634 
## count_birth_order2/2          0.008     0.022    -0.036     0.051     0.350    64.307     0.727     0.598     0.393 
## count_birth_order1/3         -0.003     0.029    -0.059     0.053    -0.118    69.853     0.907     0.560     0.377 
## count_birth_order2/3         -0.020     0.028    -0.076     0.035    -0.719    50.126     0.475     0.735     0.445 
## count_birth_order3/3          0.017     0.028    -0.038     0.073     0.610    70.172     0.544     0.558     0.376 
## count_birth_order1/4         -0.016     0.040    -0.094     0.062    -0.410    60.251     0.683     0.630     0.406 
## count_birth_order2/4         -0.034     0.034    -0.101     0.033    -1.005    93.214     0.318     0.451     0.325 
## count_birth_order3/4         -0.060     0.038    -0.136     0.015    -1.572    44.576     0.123     0.816     0.472 
## count_birth_order4/4         -0.011     0.034    -0.077     0.055    -0.333   149.264     0.740     0.325     0.255 
## count_birth_order1/5         -0.059     0.052    -0.162     0.044    -1.128    70.566     0.263     0.556     0.375 
## count_birth_order2/5         -0.077     0.055    -0.185     0.031    -1.396    35.766     0.171     1.007     0.527 
## count_birth_order3/5         -0.060     0.060    -0.178     0.058    -0.996    23.777     0.329     1.599     0.644 
## count_birth_order4/5         -0.139     0.058    -0.254    -0.025    -2.382    25.270     0.025     1.480     0.625 
## count_birth_order5/5         -0.112     0.044    -0.197    -0.026    -2.562   237.804     0.011     0.242     0.201 
## poly(age, 3, raw = TRUE)1     0.046     0.004     0.038     0.054    10.851    27.625     0.000     1.330     0.599 
## poly(age, 3, raw = TRUE)2    -0.001     0.000    -0.001    -0.000    -3.107    26.820     0.004     1.377     0.608 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.590    25.642     0.124     1.454     0.621 
## male                          0.016     0.014    -0.012     0.043     1.127    59.685     0.264     0.635     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.206 
## Residual~~Residual                     0.637 
## ICC|mother_pidlink                     0.244 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-63" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-15" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1131.737        8   22.113    0.000    0.876 
##   2 vs 3:  448.614        3   21.369    0.000    1.224 
##   3 vs 4:  123.508        1   70.627    0.000    0.555 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-7" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2015-young" class="section level3 tabset">
<h3>Numeracy 2015 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2015_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-8" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-16" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-64" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.240     0.030    -0.300    -0.181    -7.944    25.257     0.000     1.481     0.625 
## poly(age, 3, raw = TRUE)1     0.024     0.003     0.018     0.029     8.539   216.432     0.000     0.256     0.211 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.928   173.309     0.004     0.295     0.237 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.573   144.513     0.118     0.333     0.260 
## male                         -0.129     0.021    -0.170    -0.088    -6.154    18.466     0.000     2.313     0.726 
## sibling_count                 0.000     0.006    -0.012     0.013     0.072   162.377     0.943     0.308     0.245 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.195 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-64" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-16" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-65" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.236     0.034    -0.302    -0.170    -6.992    21.888     0.000     1.787     0.670 
## birth_order                  -0.005     0.009    -0.024     0.013    -0.539    36.997     0.593     0.973     0.519 
## poly(age, 3, raw = TRUE)1     0.023     0.003     0.018     0.029     8.231   232.297     0.000     0.245     0.204 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.869   237.749     0.004     0.242     0.201 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.517   162.099     0.131     0.308     0.245 
## male                         -0.129     0.021    -0.170    -0.088    -6.152    18.486     0.000     2.308     0.726 
## sibling_count                 0.004     0.008    -0.012     0.019     0.451   150.556     0.652     0.324     0.254 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.195 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-65" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-16" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-66" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.244     0.032    -0.306    -0.181    -7.653    23.271     0.000     1.645     0.651 
## birth_order_nonlinear2        0.004     0.023    -0.041     0.048     0.158    23.275     0.876     1.644     0.651 
## birth_order_nonlinear3       -0.002     0.030    -0.061     0.057    -0.066    23.515     0.948     1.622     0.647 
## birth_order_nonlinear4       -0.037     0.033    -0.101     0.028    -1.105    56.482     0.274     0.664     0.419 
## birth_order_nonlinear5       -0.002     0.043    -0.086     0.083    -0.036   129.971     0.971     0.357     0.274 
## poly(age, 3, raw = TRUE)1     0.024     0.003     0.018     0.029     8.217   214.489     0.000     0.258     0.212 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.928   276.518     0.004     0.220     0.186 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.573   189.405     0.118     0.279     0.226 
## male                         -0.129     0.021    -0.170    -0.088    -6.137    18.364     0.000     2.334     0.728 
## sibling_count                 0.003     0.008    -0.012     0.019     0.439   138.356     0.661     0.342     0.266 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.195 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-66" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-16" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-67" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.270     0.041    -0.350    -0.189    -6.550    28.786     0.000     1.268     0.587 
## count_birth_order2/2          0.020     0.028    -0.034     0.074     0.733    52.297     0.467     0.709     0.436 
## count_birth_order1/3          0.021     0.029    -0.037     0.078     0.705   287.461     0.481     0.215     0.183 
## count_birth_order2/3          0.010     0.034    -0.056     0.076     0.298    65.110     0.767     0.592     0.390 
## count_birth_order3/3          0.011     0.039    -0.065     0.086     0.274    30.758     0.786     1.178     0.568 
## count_birth_order1/4         -0.023     0.044    -0.109     0.062    -0.535    55.691     0.595     0.672     0.422 
## count_birth_order2/4         -0.020     0.037    -0.094     0.053    -0.534   243.412     0.594     0.238     0.199 
## count_birth_order3/4         -0.013     0.041    -0.093     0.068    -0.306    62.965     0.760     0.608     0.397 
## count_birth_order4/4         -0.022     0.040    -0.100     0.056    -0.553    64.399     0.582     0.597     0.392 
## count_birth_order1/5         -0.001     0.058    -0.115     0.114    -0.010    38.423     0.992     0.938     0.509 
## count_birth_order2/5         -0.000     0.049    -0.096     0.096    -0.000   156.387     1.000     0.316     0.249 
## count_birth_order3/5          0.029     0.048    -0.064     0.122     0.607   117.469     0.545     0.383     0.289 
## count_birth_order4/5         -0.043     0.048    -0.138     0.051    -0.898    88.884     0.372     0.467     0.333 
## count_birth_order5/5          0.014     0.044    -0.072     0.100     0.312   109.580     0.756     0.402     0.299 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.036     6.920    95.061     0.000     0.444     0.322 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.679   142.861     0.008     0.335     0.261 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.433   115.976     0.155     0.386     0.291 
## male                         -0.139     0.023    -0.184    -0.094    -6.035    18.596     0.000     2.286     0.724 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.195 
## Residual~~Residual                     0.771 
## ICC|mother_pidlink                     0.202 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-67" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-16" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1413.023        8  116.357    0.000    0.256 
##   2 vs 3:    3.536        3   25.975    0.029    0.997 
##   3 vs 4:    1.589        1   32.756    0.216    1.102 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-8" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-17" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-68" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.226     0.031    -0.287    -0.165    -7.254    20.110     0.000     2.021     0.698 
## poly(age, 3, raw = TRUE)1     0.023     0.003     0.018     0.028     8.478   162.941     0.000     0.307     0.244 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.858   273.844     0.005     0.221     0.187 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.498   290.557     0.135     0.214     0.182 
## male                         -0.131     0.019    -0.169    -0.094    -6.872    18.455     0.000     2.315     0.726 
## sibling_count                -0.007     0.008    -0.023     0.008    -0.936    29.138     0.357     1.251     0.583 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.198 
## Residual~~Residual                     0.769 
## ICC|mother_pidlink                     0.205 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-68" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-17" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-69" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.225     0.033    -0.289    -0.161    -6.873    19.920     0.000     2.050     0.701 
## birth_order                  -0.002     0.008    -0.019     0.014    -0.263    38.944     0.794     0.926     0.505 
## poly(age, 3, raw = TRUE)1     0.023     0.003     0.018     0.028     8.496   191.149     0.000     0.277     0.225 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.856   268.492     0.005     0.224     0.189 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.501   264.692     0.134     0.226     0.190 
## male                         -0.131     0.019    -0.169    -0.094    -6.871    18.493     0.000     2.307     0.726 
## sibling_count                -0.006     0.009    -0.023     0.011    -0.651    36.920     0.519     0.975     0.519 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.198 
## Residual~~Residual                     0.770 
## ICC|mother_pidlink                     0.204 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-69" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-17" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-70" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.228     0.033    -0.293    -0.163    -6.856    19.363     0.000     2.142     0.710 
## birth_order_nonlinear2        0.003     0.021    -0.037     0.044     0.153    22.209     0.880     1.752     0.665 
## birth_order_nonlinear3       -0.011     0.026    -0.062     0.039    -0.437    29.684     0.665     1.225     0.578 
## birth_order_nonlinear4       -0.015     0.030    -0.074     0.044    -0.514    87.053     0.608     0.474     0.337 
## birth_order_nonlinear5       -0.061     0.049    -0.156     0.035    -1.248    76.469     0.216     0.522     0.360 
## poly(age, 3, raw = TRUE)1     0.023     0.003     0.017     0.028     8.385   217.753     0.000     0.255     0.211 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -2.698   313.428     0.007     0.204     0.175 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.314   282.967     0.190     0.217     0.184 
## male                         -0.133     0.019    -0.170    -0.095    -6.903    18.915     0.000     2.224     0.718 
## sibling_count                -0.005     0.009    -0.023     0.013    -0.521    35.350     0.606     1.018     0.530 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.197 
## Residual~~Residual                     0.769 
## ICC|mother_pidlink                     0.204 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-70" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-17" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-71" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.274     0.038    -0.349    -0.199    -7.162    29.850     0.000     1.218     0.577 
## count_birth_order2/2          0.019     0.025    -0.030     0.068     0.758    51.722     0.452     0.716     0.438 
## count_birth_order1/3          0.026     0.031    -0.035     0.086     0.834    69.295     0.407     0.563     0.378 
## count_birth_order2/3          0.011     0.032    -0.051     0.073     0.354    41.128     0.725     0.879     0.492 
## count_birth_order3/3          0.008     0.032    -0.055     0.071     0.261    51.215     0.795     0.722     0.441 
## count_birth_order1/4         -0.024     0.042    -0.107     0.059    -0.569    63.327     0.571     0.605     0.396 
## count_birth_order2/4         -0.029     0.040    -0.108     0.049    -0.740    51.887     0.463     0.714     0.438 
## count_birth_order3/4         -0.024     0.037    -0.097     0.049    -0.640    83.449     0.524     0.489     0.344 
## count_birth_order4/4          0.006     0.035    -0.062     0.075     0.177   254.843     0.859     0.231     0.194 
## count_birth_order1/5         -0.032     0.056    -0.142     0.079    -0.564    72.357     0.574     0.545     0.370 
## count_birth_order2/5         -0.054     0.059    -0.169     0.061    -0.917    37.735     0.365     0.955     0.513 
## count_birth_order3/5         -0.075     0.056    -0.186     0.035    -1.333    37.360     0.191     0.964     0.516 
## count_birth_order4/5         -0.084     0.074    -0.229     0.061    -1.141    17.921     0.269     2.432     0.737 
## count_birth_order5/5         -0.090     0.052    -0.193     0.012    -1.725    72.390     0.089     0.545     0.370 
## poly(age, 3, raw = TRUE)1     0.027     0.004     0.020     0.035     7.403    69.718     0.000     0.561     0.377 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001    -0.000    -2.906    69.998     0.005     0.559     0.376 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.611    61.327     0.112     0.621     0.402 
## male                         -0.138     0.019    -0.175    -0.101    -7.278    24.515     0.000     1.537     0.635 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.199 
## Residual~~Residual                     0.767 
## ICC|mother_pidlink                     0.206 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-71" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-17" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1342.273        8   31.016    0.000    0.651 
##   2 vs 3:  324.351        3   13.630    0.000    2.217 
##   3 vs 4:  100.701        1   35.982    0.000    1.001 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-8" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2007-old" class="section level3 tabset">
<h3>g-factor 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-9" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-18" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-72" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.229     0.060     0.111     0.347     3.813    11.186     0.003     8.708     0.912 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.015     0.003    -1.310    18.080     0.207     2.396     0.733 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.128    27.010     0.899     1.365     0.605 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.306    23.337     0.204     1.639     0.650 
## male                          0.005     0.013    -0.019     0.030     0.425   199.367     0.671     0.270     0.220 
## sibling_count                -0.007     0.008    -0.022     0.008    -0.934    42.399     0.356     0.854     0.484 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.271 
## Residual~~Residual                     0.689 
## ICC|mother_pidlink                     0.282 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-72" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-18" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-73" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.228     0.062     0.107     0.348     3.700    11.329     0.003     8.201     0.906 
## birth_order                   0.002     0.012    -0.022     0.025     0.140    17.525     0.890     2.529     0.744 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.015     0.004    -1.204    17.156     0.245     2.627     0.752 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.098    23.856     0.923     1.592     0.643 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.242    21.600     0.227     1.821     0.674 
## male                          0.005     0.013    -0.020     0.030     0.420   189.976     0.675     0.278     0.226 
## sibling_count                -0.008     0.011    -0.029     0.013    -0.762    25.856     0.453     1.439     0.618 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.271 
## Residual~~Residual                     0.689 
## ICC|mother_pidlink                     0.282 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-73" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-18" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-74" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.226     0.061     0.107     0.345     3.711    11.210     0.003     8.616     0.911 
## birth_order_nonlinear2        0.014     0.020    -0.025     0.053     0.717    30.315     0.479     1.197     0.572 
## birth_order_nonlinear3        0.002     0.032    -0.061     0.065     0.055    18.872     0.957     2.232     0.719 
## birth_order_nonlinear4       -0.004     0.040    -0.083     0.075    -0.106    22.603     0.917     1.710     0.660 
## birth_order_nonlinear5        0.023     0.056    -0.086     0.132     0.409    25.318     0.686     1.477     0.625 
## poly(age, 3, raw = TRUE)1    -0.006     0.005    -0.015     0.004    -1.183    17.210     0.253     2.612     0.751 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.072    24.072     0.943     1.574     0.640 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.220    21.902     0.236     1.786     0.670 
## male                          0.005     0.013    -0.020     0.030     0.409   200.296     0.683     0.269     0.220 
## sibling_count                -0.008     0.011    -0.029     0.013    -0.782    26.880     0.441     1.373     0.607 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.271 
## Residual~~Residual                     0.689 
## ICC|mother_pidlink                     0.282 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-74" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-18" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-75" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.184     0.063     0.060     0.308     2.912    13.526     0.012     4.427     0.838 
## count_birth_order2/2          0.027     0.025    -0.021     0.076     1.106    73.697     0.272     0.537     0.366 
## count_birth_order1/3          0.020     0.040    -0.059     0.098     0.492    28.248     0.627     1.296     0.592 
## count_birth_order2/3          0.014     0.044    -0.073     0.100     0.309    21.641     0.760     1.816     0.674 
## count_birth_order3/3          0.032     0.037    -0.041     0.104     0.851    34.357     0.401     1.048     0.538 
## count_birth_order1/4         -0.045     0.046    -0.135     0.045    -0.975    39.533     0.336     0.913     0.502 
## count_birth_order2/4         -0.014     0.050    -0.112     0.084    -0.284    28.548     0.779     1.280     0.589 
## count_birth_order3/4         -0.073     0.041    -0.154     0.007    -1.780    58.651     0.080     0.644     0.411 
## count_birth_order4/4         -0.019     0.052    -0.120     0.083    -0.360    21.980     0.722     1.777     0.669 
## count_birth_order1/5         -0.043     0.057    -0.155     0.069    -0.756    39.030     0.454     0.924     0.505 
## count_birth_order2/5         -0.040     0.052    -0.142     0.062    -0.775    72.882     0.441     0.542     0.369 
## count_birth_order3/5         -0.017     0.050    -0.116     0.081    -0.347    63.879     0.730     0.601     0.394 
## count_birth_order4/5         -0.046     0.051    -0.146     0.055    -0.886    52.156     0.380     0.711     0.437 
## count_birth_order5/5          0.001     0.045    -0.087     0.089     0.017    77.731     0.987     0.516     0.357 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.016     0.006    -0.929    23.127     0.363     1.658     0.653 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.565    49.533     0.574     0.743     0.448 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.863    74.014     0.066     0.535     0.366 
## male                         -0.007     0.014    -0.034     0.021    -0.494   166.030     0.622     0.303     0.242 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.266 
## Residual~~Residual                     0.686 
## ICC|mother_pidlink                     0.279 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-75" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-18" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1597.111        8  394.371    0.000    0.124 
##   2 vs 3:    3.486        3   27.394    0.029    0.946 
##   3 vs 4:    2.302        1   46.965    0.136    0.779 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-9" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-19" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-76" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.246     0.058     0.132     0.361     4.221    10.999     0.001     9.479     0.918 
## poly(age, 3, raw = TRUE)1    -0.008     0.005    -0.017     0.001    -1.662    16.451     0.115     2.841     0.766 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.573    23.959     0.572     1.583     0.642 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.663    21.501     0.111     1.833     0.676 
## male                          0.001     0.012    -0.023     0.025     0.078    86.297     0.938     0.477     0.338 
## sibling_count                -0.017     0.008    -0.033    -0.002    -2.277    35.570     0.029     1.012     0.529 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.279 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.289 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-76" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-19" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-77" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.235     0.060     0.118     0.352     3.936    11.109     0.002     9.011     0.914 
## birth_order                   0.011     0.012    -0.012     0.034     0.961    15.951     0.351     3.019     0.777 
## poly(age, 3, raw = TRUE)1    -0.007     0.005    -0.016     0.002    -1.507    16.225     0.151     2.918     0.771 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.503    23.579     0.620     1.617     0.647 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.633    21.514     0.117     1.831     0.676 
## male                          0.001     0.013    -0.024     0.026     0.080    79.459     0.936     0.507     0.353 
## sibling_count                -0.023     0.009    -0.041    -0.005    -2.550    32.823     0.016     1.099     0.550 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.279 
## Residual~~Residual                     0.687 
## ICC|mother_pidlink                     0.289 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-77" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-216-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-19" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-78" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.251     0.058     0.137     0.366     4.300    11.193     0.001     8.680     0.911 
## birth_order_nonlinear2        0.007     0.018    -0.027     0.042     0.426    31.840     0.673     1.135     0.559 
## birth_order_nonlinear3        0.017     0.026    -0.035     0.068     0.636    25.214     0.530     1.484     0.626 
## birth_order_nonlinear4        0.013     0.049    -0.082     0.109     0.277    15.550     0.785     3.180     0.787 
## birth_order_nonlinear5        0.001     0.063    -0.123     0.125     0.015    21.813     0.988     1.796     0.671 
## poly(age, 3, raw = TRUE)1    -0.008     0.005    -0.017     0.002    -1.609    16.648     0.126     2.777     0.762 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.742    25.304     0.465     1.478     0.625 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.928    23.768     0.066     1.600     0.644 
## male                         -0.001     0.013    -0.026     0.024    -0.090    74.988     0.929     0.530     0.363 
## sibling_count                -0.023     0.010    -0.041    -0.004    -2.336    30.640     0.026     1.183     0.569 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.279 
## Residual~~Residual                     0.685 
## ICC|mother_pidlink                     0.290 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-78" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-19" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-79" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.177     0.060     0.059     0.295     2.932    13.424     0.011     4.519     0.841 
## count_birth_order2/2          0.022     0.031    -0.039     0.083     0.704    21.241     0.489     1.865     0.680 
## count_birth_order1/3         -0.001     0.035    -0.070     0.068    -0.029    32.486     0.977     1.111     0.553 
## count_birth_order2/3         -0.005     0.033    -0.070     0.060    -0.142    32.051     0.888     1.127     0.557 
## count_birth_order3/3          0.022     0.035    -0.047     0.091     0.626    32.530     0.536     1.110     0.553 
## count_birth_order1/4         -0.048     0.053    -0.151     0.056    -0.904    24.249     0.375     1.559     0.638 
## count_birth_order2/4         -0.050     0.048    -0.144     0.044    -1.037    24.234     0.310     1.560     0.638 
## count_birth_order3/4         -0.056     0.041    -0.137     0.025    -1.354    41.423     0.183     0.873     0.490 
## count_birth_order4/4         -0.014     0.051    -0.115     0.087    -0.280    22.238     0.782     1.748     0.665 
## count_birth_order1/5         -0.111     0.063    -0.235     0.013    -1.755    34.786     0.088     1.035     0.535 
## count_birth_order2/5         -0.150     0.051    -0.251    -0.050    -2.944    73.009     0.004     0.541     0.368 
## count_birth_order3/5         -0.082     0.058    -0.197     0.032    -1.406    30.668     0.170     1.182     0.569 
## count_birth_order4/5         -0.106     0.061    -0.226     0.014    -1.733    26.239     0.095     1.414     0.614 
## count_birth_order5/5         -0.084     0.059    -0.199     0.031    -1.432    35.625     0.161     1.011     0.528 
## poly(age, 3, raw = TRUE)1    -0.004     0.005    -0.015     0.006    -0.842    19.202     0.410     2.171     0.713 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.261    28.274     0.796     1.295     0.592 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.494    27.884     0.146     1.315     0.596 
## male                         -0.005     0.013    -0.031     0.021    -0.398   146.528     0.691     0.329     0.258 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.279 
## Residual~~Residual                     0.683 
## ICC|mother_pidlink                     0.290 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-79" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-19" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1036.839        8   17.105    0.000    1.132 
##   2 vs 3:  401.133        3   17.070    0.000    1.603 
##   3 vs 4:   71.060        1   21.810    0.000    1.796 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-9" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2007-old" class="section level3 tabset">
<h3>Raven 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-10" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-20" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-80" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.004     0.058    -0.116     0.109    -0.065    11.490     0.950     7.698     0.901 
## poly(age, 3, raw = TRUE)1     0.004     0.005    -0.006     0.013     0.739    17.157     0.470     2.627     0.752 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.000    26.987     1.000     1.367     0.606 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.026    24.219     0.315     1.561     0.638 
## male                          0.035     0.013     0.010     0.060     2.704   170.154     0.008     0.299     0.239 
## sibling_count                -0.003     0.009    -0.020     0.014    -0.369    29.076     0.715     1.254     0.584 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.270 
## Residual~~Residual                     0.711 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-80" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-20" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-81" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.001     0.057    -0.113     0.111    -0.017    11.867     0.986     6.744     0.888 
## birth_order                  -0.003     0.010    -0.022     0.017    -0.280    27.798     0.781     1.320     0.597 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.013     0.684    17.669     0.503     2.493     0.741 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.038    27.025     0.970     1.365     0.605 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.047    24.231     0.305     1.560     0.638 
## male                          0.035     0.013     0.010     0.061     2.701   165.530     0.008     0.304     0.242 
## sibling_count                -0.001     0.011    -0.023     0.020    -0.132    26.338     0.896     1.407     0.613 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.270 
## Residual~~Residual                     0.711 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-81" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-226-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-20" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-82" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.006     0.057    -0.118     0.107    -0.098    11.605     0.924     7.377     0.897 
## birth_order_nonlinear2        0.005     0.019    -0.032     0.042     0.266    38.020     0.792     0.948     0.512 
## birth_order_nonlinear3       -0.011     0.031    -0.072     0.050    -0.354    20.690     0.727     1.937     0.688 
## birth_order_nonlinear4       -0.014     0.031    -0.076     0.048    -0.442    64.559     0.660     0.596     0.392 
## birth_order_nonlinear5        0.006     0.052    -0.097     0.108     0.107    31.635     0.916     1.143     0.560 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.013     0.698    17.934     0.494     2.429     0.736 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.029    28.041     0.977     1.307     0.594 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.049    25.150     0.304     1.489     0.627 
## male                          0.035     0.013     0.009     0.061     2.685   160.849     0.008     0.310     0.246 
## sibling_count                -0.001     0.011    -0.022     0.020    -0.131    27.066     0.897     1.362     0.605 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.270 
## Residual~~Residual                     0.710 
## ICC|mother_pidlink                     0.276 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-82" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-20" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-83" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.029     0.060    -0.147     0.089    -0.487    14.307     0.634     3.834     0.817 
## count_birth_order2/2          0.014     0.027    -0.039     0.068     0.520    44.063     0.606     0.825     0.475 
## count_birth_order1/3          0.011     0.038    -0.063     0.085     0.284    35.696     0.778     1.009     0.528 
## count_birth_order2/3          0.000     0.048    -0.094     0.094     0.002    18.707     0.998     2.264     0.722 
## count_birth_order3/3          0.018     0.037    -0.055     0.090     0.477    35.543     0.636     1.013     0.529 
## count_birth_order1/4         -0.015     0.054    -0.122     0.091    -0.281    23.416     0.781     1.631     0.649 
## count_birth_order2/4          0.003     0.054    -0.102     0.108     0.056    24.214     0.956     1.562     0.638 
## count_birth_order3/4         -0.068     0.043    -0.152     0.017    -1.574    47.622     0.122     0.769     0.457 
## count_birth_order4/4         -0.014     0.058    -0.128     0.100    -0.245    17.810     0.809     2.459     0.739 
## count_birth_order1/5         -0.025     0.056    -0.136     0.085    -0.451    43.453     0.654     0.835     0.479 
## count_birth_order2/5         -0.033     0.059    -0.149     0.083    -0.561    37.545     0.578     0.959     0.515 
## count_birth_order3/5         -0.020     0.052    -0.121     0.082    -0.380    56.359     0.706     0.666     0.420 
## count_birth_order4/5         -0.038     0.053    -0.142     0.067    -0.711    45.149     0.481     0.807     0.469 
## count_birth_order5/5         -0.002     0.046    -0.092     0.088    -0.044    69.554     0.965     0.562     0.377 
## poly(age, 3, raw = TRUE)1     0.004     0.006    -0.007     0.016     0.719    20.288     0.480     1.994     0.695 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.380    32.872     0.707     1.098     0.550 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.396    37.879     0.171     0.951     0.513 
## male                          0.028     0.015    -0.002     0.058     1.810    72.267     0.075     0.545     0.370 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.264 
## Residual~~Residual                     0.706 
## ICC|mother_pidlink                     0.272 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-83" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-20" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1508.926        8  166.913    0.000    0.205 
##   2 vs 3:    2.953        3   21.086    0.056    1.242 
##   3 vs 4:    1.036        1   26.913    0.318    1.371 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-10" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-21" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-84" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.011     0.056    -0.098     0.121     0.201    11.282     0.844     8.360     0.908 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.007     0.012     0.539    16.520     0.597     2.818     0.765 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.307    24.633     0.762     1.528     0.633 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.324    23.587     0.198     1.616     0.646 
## male                          0.035     0.013     0.010     0.060     2.746    78.956     0.007     0.510     0.354 
## sibling_count                -0.014     0.008    -0.030     0.002    -1.656    29.431     0.108     1.237     0.581 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.275 
## Residual~~Residual                     0.714 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-84" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-233-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-21" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-85" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.006     0.058    -0.107     0.119     0.108    11.347     0.916     8.139     0.906 
## birth_order                   0.005     0.012    -0.018     0.028     0.415    16.249     0.683     2.910     0.771 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.583    16.578     0.568     2.800     0.764 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.288    25.435     0.776     1.468     0.623 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.328    24.177     0.196     1.565     0.639 
## male                          0.035     0.013     0.010     0.060     2.731    74.744     0.008     0.531     0.364 
## sibling_count                -0.016     0.011    -0.037     0.006    -1.457    20.820     0.160     1.920     0.686 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.275 
## Residual~~Residual                     0.714 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-85" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-21" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-86" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.014     0.056    -0.097     0.125     0.247    11.442     0.809     7.842     0.903 
## birth_order_nonlinear2        0.001     0.018    -0.034     0.036     0.058    33.305     0.954     1.083     0.546 
## birth_order_nonlinear3        0.009     0.025    -0.041     0.059     0.353    29.395     0.726     1.239     0.581 
## birth_order_nonlinear4       -0.009     0.049    -0.105     0.087    -0.186    15.740     0.855     3.101     0.782 
## birth_order_nonlinear5       -0.016     0.068    -0.150     0.118    -0.229    19.361     0.821     2.143     0.710 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.007     0.012     0.483    16.250     0.635     2.910     0.771 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.462    23.814     0.648     1.596     0.643 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.493    23.339     0.149     1.638     0.650 
## male                          0.034     0.014     0.007     0.060     2.489    60.154     0.016     0.631     0.406 
## sibling_count                -0.015     0.012    -0.038     0.008    -1.257    19.082     0.224     2.192     0.715 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.274 
## Residual~~Residual                     0.712 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-86" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-21" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-87" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.045     0.058    -0.159     0.070    -0.763    13.941     0.458     4.088     0.827 
## count_birth_order2/2          0.015     0.029    -0.042     0.073     0.521    25.214     0.607     1.484     0.626 
## count_birth_order1/3          0.001     0.030    -0.058     0.059     0.020    84.234     0.984     0.486     0.342 
## count_birth_order2/3         -0.008     0.031    -0.069     0.053    -0.254    43.095     0.801     0.842     0.481 
## count_birth_order3/3          0.018     0.032    -0.045     0.081     0.545    50.695     0.588     0.728     0.443 
## count_birth_order1/4         -0.033     0.062    -0.154     0.088    -0.540    17.965     0.596     2.422     0.736 
## count_birth_order2/4         -0.041     0.043    -0.124     0.043    -0.951    36.966     0.348     0.974     0.519 
## count_birth_order3/4         -0.053     0.047    -0.146     0.040    -1.119    26.343     0.273     1.407     0.613 
## count_birth_order4/4         -0.020     0.047    -0.113     0.072    -0.427    29.210     0.673     1.248     0.583 
## count_birth_order1/5         -0.079     0.066    -0.208     0.050    -1.199    31.866     0.240     1.134     0.558 
## count_birth_order2/5         -0.124     0.062    -0.245    -0.003    -2.010    30.526     0.053     1.188     0.570 
## count_birth_order3/5         -0.047     0.061    -0.167     0.074    -0.759    27.422     0.454     1.341     0.601 
## count_birth_order4/5         -0.110     0.055    -0.219    -0.002    -2.000    39.038     0.053     0.924     0.505 
## count_birth_order5/5         -0.072     0.061    -0.191     0.047    -1.186    33.031     0.244     1.092     0.549 
## poly(age, 3, raw = TRUE)1     0.005     0.005    -0.005     0.016     1.015    18.497     0.323     2.306     0.726 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.017    26.702     0.987     1.384     0.609 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.027    25.224     0.314     1.483     0.626 
## male                          0.035     0.014     0.007     0.062     2.432    89.636     0.017     0.464     0.332 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.272 
## Residual~~Residual                     0.709 
## ICC|mother_pidlink                     0.277 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-87" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-21" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1096.698        8   18.528    0.000    1.042 
##   2 vs 3:  428.517        3   18.201    0.000    1.477 
##   3 vs 4:   80.270        1   23.848    0.000    1.593 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-10" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2007-old" class="section level3 tabset">
<h3>Numeracy 2007 old</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2007_old)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-11" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-22" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-88" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.381     0.058     0.267     0.495     6.531    11.274     0.000     8.389     0.908 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.006    -3.509    27.442     0.002     1.340     0.601 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.180    30.167     0.858     1.204     0.574 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.101    22.465     0.282     1.724     0.662 
## male                         -0.026     0.013    -0.051    -0.001    -2.033   162.671     0.044     0.308     0.244 
## sibling_count                -0.009     0.007    -0.022     0.004    -1.308    76.819     0.195     0.520     0.359 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.241 
## Residual~~Residual                     0.696 
## ICC|mother_pidlink                     0.258 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-88" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-243-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-22" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-89" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.375     0.062     0.254     0.497     6.039    11.198     0.000     8.660     0.911 
## birth_order                   0.006     0.012    -0.018     0.029     0.477    17.773     0.639     2.467     0.739 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.004    -2.994    21.504     0.007     1.832     0.676 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.088    24.757     0.931     1.518     0.632 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.997    20.353     0.330     1.985     0.694 
## male                         -0.026     0.013    -0.051    -0.001    -2.040   160.186     0.043     0.311     0.246 
## sibling_count                -0.012     0.009    -0.031     0.006    -1.314    38.432     0.197     0.938     0.509 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.241 
## Residual~~Residual                     0.696 
## ICC|mother_pidlink                     0.258 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-89" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-245-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-22" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-90" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.377     0.060     0.260     0.494     6.320    11.245     0.000     8.491     0.909 
## birth_order_nonlinear2        0.019     0.020    -0.021     0.059     0.919    27.697     0.366     1.326     0.598 
## birth_order_nonlinear3        0.014     0.027    -0.039     0.068     0.522    27.131     0.606     1.358     0.604 
## birth_order_nonlinear4        0.007     0.045    -0.081     0.094     0.152    18.495     0.881     2.307     0.726 
## birth_order_nonlinear5        0.033     0.052    -0.070     0.136     0.629    30.143     0.534     1.205     0.574 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.021    -0.004    -2.954    21.433     0.007     1.841     0.677 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.055    24.822     0.957     1.513     0.631 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.963    20.422     0.347     1.975     0.693 
## male                         -0.026     0.013    -0.051    -0.001    -2.057   167.384     0.041     0.302     0.241 
## sibling_count                -0.013     0.009    -0.031     0.006    -1.353    41.087     0.184     0.880     0.492 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.241 
## Residual~~Residual                     0.696 
## ICC|mother_pidlink                     0.258 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-90" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-22" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-91" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.331     0.062     0.210     0.451     5.368    13.741     0.000     4.244     0.832 
## count_birth_order2/2          0.032     0.025    -0.017     0.080     1.275    75.055     0.206     0.530     0.363 
## count_birth_order1/3          0.022     0.036    -0.050     0.093     0.593    39.028     0.556     0.924     0.505 
## count_birth_order2/3          0.022     0.037    -0.050     0.095     0.609    36.547     0.546     0.985     0.522 
## count_birth_order3/3          0.035     0.034    -0.031     0.101     1.031    51.045     0.307     0.724     0.441 
## count_birth_order1/4         -0.059     0.040    -0.136     0.019    -1.479    95.666     0.142     0.442     0.321 
## count_birth_order2/4         -0.027     0.045    -0.114     0.061    -0.596    43.106     0.554     0.841     0.480 
## count_birth_order3/4         -0.053     0.040    -0.131     0.024    -1.353    71.980     0.180     0.547     0.371 
## count_birth_order4/4         -0.016     0.046    -0.106     0.075    -0.339    29.199     0.737     1.248     0.583 
## count_birth_order1/5         -0.045     0.057    -0.157     0.067    -0.788    38.380     0.435     0.939     0.509 
## count_birth_order2/5         -0.034     0.048    -0.127     0.060    -0.708   156.746     0.480     0.315     0.249 
## count_birth_order3/5         -0.009     0.045    -0.097     0.078    -0.211   188.124     0.833     0.280     0.227 
## count_birth_order4/5         -0.038     0.046    -0.128     0.052    -0.834   118.208     0.406     0.381     0.288 
## count_birth_order5/5          0.004     0.043    -0.081     0.089     0.086   100.332     0.932     0.428     0.313 
## poly(age, 3, raw = TRUE)1    -0.012     0.005    -0.021    -0.003    -2.649    38.856     0.012     0.928     0.506 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.478    67.631     0.634     0.574     0.383 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.410    62.349     0.163     0.613     0.399 
## male                         -0.039     0.014    -0.068    -0.011    -2.728   116.248     0.007     0.386     0.290 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.240 
## Residual~~Residual                     0.695 
## ICC|mother_pidlink                     0.257 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-91" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-249-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-22" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1291.012        8   67.096    0.000    0.366 
##   2 vs 3:    3.587        3   34.426    0.023    0.766 
##   3 vs 4:    3.252        1   64.939    0.076    0.593 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-11" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-23" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-92" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.395     0.056     0.284     0.505     7.008    11.093     0.000     9.075     0.915 
## poly(age, 3, raw = TRUE)1    -0.015     0.004    -0.022    -0.007    -3.904    22.452     0.001     1.726     0.662 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.670    29.738     0.508     1.223     0.578 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.455    21.328     0.160     1.854     0.678 
## male                         -0.034     0.012    -0.057    -0.010    -2.850   139.432     0.005     0.341     0.265 
## sibling_count                -0.016     0.007    -0.030    -0.001    -2.138    38.425     0.039     0.938     0.509 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.692 
## ICC|mother_pidlink                     0.263 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-92" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-252-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-23" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-93" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.381     0.058     0.267     0.494     6.553    11.163     0.000     8.794     0.912 
## birth_order                   0.014     0.010    -0.006     0.034     1.373    19.624     0.185     2.098     0.706 
## poly(age, 3, raw = TRUE)1    -0.014     0.004    -0.022    -0.006    -3.576    21.079     0.002     1.885     0.682 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.562    27.942     0.579     1.312     0.595 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.402    21.022     0.175     1.893     0.683 
## male                         -0.034     0.012    -0.057    -0.010    -2.843   135.680     0.005     0.347     0.268 
## sibling_count                -0.023     0.007    -0.037    -0.010    -3.344   221.537     0.001     0.252     0.209 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.692 
## ICC|mother_pidlink                     0.263 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-93" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-23" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-94" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.400     0.056     0.289     0.510     7.087    11.303     0.000     8.287     0.907 
## birth_order_nonlinear2        0.012     0.016    -0.021     0.044     0.704    41.443     0.486     0.873     0.490 
## birth_order_nonlinear3        0.019     0.024    -0.027     0.066     0.817    35.224     0.420     1.022     0.531 
## birth_order_nonlinear4        0.031     0.039    -0.046     0.109     0.796    22.240     0.434     1.748     0.665 
## birth_order_nonlinear5        0.016     0.052    -0.086     0.119     0.314    39.177     0.755     0.920     0.504 
## poly(age, 3, raw = TRUE)1    -0.015     0.004    -0.022    -0.007    -3.829    24.321     0.001     1.553     0.637 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.801    35.291     0.428     1.020     0.531 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.692    24.957     0.103     1.503     0.629 
## male                         -0.036     0.012    -0.059    -0.012    -2.982   147.618     0.003     0.328     0.257 
## sibling_count                -0.023     0.007    -0.037    -0.009    -3.144   193.168     0.002     0.275     0.224 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.247 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-94" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-256-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-23" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-95" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.334     0.055     0.227     0.442     6.099    14.570     0.000     3.672     0.810 
## count_birth_order2/2          0.021     0.029    -0.035     0.078     0.744    25.659     0.464     1.452     0.621 
## count_birth_order1/3         -0.002     0.040    -0.081     0.076    -0.058    22.109     0.954     1.763     0.667 
## count_birth_order2/3         -0.000     0.034    -0.068     0.067    -0.005    27.988     0.996     1.310     0.595 
## count_birth_order3/3          0.019     0.033    -0.046     0.085     0.585    38.914     0.562     0.926     0.506 
## count_birth_order1/4         -0.045     0.044    -0.132     0.042    -1.015    43.726     0.315     0.830     0.477 
## count_birth_order2/4         -0.042     0.051    -0.143     0.058    -0.829    20.541     0.417     1.958     0.691 
## count_birth_order3/4         -0.039     0.041    -0.119     0.042    -0.947    41.058     0.349     0.880     0.492 
## count_birth_order4/4         -0.003     0.051    -0.102     0.097    -0.056    22.566     0.956     1.714     0.660 
## count_birth_order1/5         -0.107     0.057    -0.218     0.004    -1.886    59.297     0.064     0.638     0.409 
## count_birth_order2/5         -0.126     0.051    -0.227    -0.025    -2.452    66.129     0.017     0.585     0.387 
## count_birth_order3/5         -0.091     0.056    -0.200     0.018    -1.633    35.534     0.111     1.013     0.529 
## count_birth_order4/5         -0.065     0.062    -0.186     0.055    -1.061    25.030     0.299     1.498     0.628 
## count_birth_order5/5         -0.067     0.055    -0.174     0.040    -1.230    48.200     0.225     0.761     0.454 
## poly(age, 3, raw = TRUE)1    -0.012     0.004    -0.021    -0.004    -2.807    27.737     0.009     1.324     0.598 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.421    33.315     0.676     1.082     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.371    28.158     0.181     1.301     0.593 
## male                         -0.044     0.014    -0.071    -0.016    -3.064    76.567     0.003     0.522     0.359 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.248 
## Residual~~Residual                     0.691 
## ICC|mother_pidlink                     0.264 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-95" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-258-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-23" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 927.144       8  14.587   0.000   1.353 
##  2 vs 3: 414.300       3  18.481   0.000   1.450 
##  3 vs 4:  71.214       1  22.062   0.000   1.768 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-11" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
</div>
</div>
<div id="g-factor-2007-young" class="section level3 tabset">
<h3>g-factor 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = g_factor_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-12" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-24" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-96" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.483     0.037    -0.555    -0.411   -13.131    16.014     0.000     2.995     0.776 
## poly(age, 3, raw = TRUE)1     0.027     0.004     0.019     0.035     6.943    22.405     0.000     1.731     0.663 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.519    34.311     0.607     1.050     0.538 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.757    29.392     0.089     1.239     0.581 
## male                          0.007     0.012    -0.017     0.031     0.592   156.741     0.555     0.315     0.249 
## sibling_count                -0.007     0.007    -0.020     0.007    -0.989    60.293     0.326     0.630     0.406 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.251 
## Residual~~Residual                     0.620 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-96" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-24" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-97" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.495     0.037    -0.567    -0.423   -13.439    17.166     0.000     2.624     0.751 
## birth_order                   0.012     0.011    -0.009     0.033     1.124    19.601     0.275     2.102     0.706 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.021     0.036     7.391    25.341     0.000     1.475     0.624 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.334    39.117     0.740     0.922     0.504 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.656    31.325     0.108     1.155     0.563 
## male                          0.007     0.012    -0.017     0.031     0.573   164.816     0.567     0.305     0.243 
## sibling_count                -0.014     0.010    -0.033     0.005    -1.461    29.928     0.154     1.214     0.576 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.251 
## Residual~~Residual                     0.620 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-97" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-264-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-24" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-98" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.485     0.038    -0.559    -0.411   -12.869    15.834     0.000     3.064     0.780 
## birth_order_nonlinear2        0.023     0.021    -0.017     0.064     1.118    23.154     0.275     1.656     0.652 
## birth_order_nonlinear3        0.021     0.023    -0.025     0.067     0.888    39.579     0.380     0.912     0.501 
## birth_order_nonlinear4        0.028     0.036    -0.041     0.098     0.797    27.639     0.432     1.329     0.599 
## birth_order_nonlinear5        0.066     0.060    -0.053     0.184     1.087    18.861     0.291     2.234     0.719 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.021     0.036     7.424    25.525     0.000     1.462     0.622 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.309    40.760     0.759     0.886     0.494 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.649    33.051     0.109     1.091     0.548 
## male                          0.007     0.012    -0.017     0.031     0.561   176.479     0.576     0.292     0.234 
## sibling_count                -0.014     0.010    -0.033     0.004    -1.498    32.151     0.144     1.124     0.556 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.251 
## Residual~~Residual                     0.620 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-98" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-266-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-24" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-99" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.537     0.052    -0.638    -0.436   -10.430    16.038     0.000     2.986     0.775 
## count_birth_order2/2          0.038     0.027    -0.015     0.091     1.388    34.799     0.174     1.035     0.535 
## count_birth_order1/3          0.008     0.035    -0.059     0.076     0.238    40.356     0.813     0.895     0.497 
## count_birth_order2/3          0.011     0.037    -0.063     0.084     0.283    29.965     0.779     1.213     0.575 
## count_birth_order3/3          0.040     0.033    -0.025     0.105     1.216    45.491     0.230     0.801     0.468 
## count_birth_order1/4         -0.051     0.043    -0.135     0.033    -1.197    43.167     0.238     0.840     0.480 
## count_birth_order2/4         -0.017     0.046    -0.108     0.074    -0.370    31.182     0.714     1.161     0.564 
## count_birth_order3/4         -0.064     0.038    -0.139     0.011    -1.675    67.264     0.099     0.577     0.384 
## count_birth_order4/4         -0.003     0.056    -0.113     0.108    -0.045    17.088     0.964     2.646     0.753 
## count_birth_order1/5         -0.050     0.050    -0.147     0.048    -0.996    61.560     0.323     0.619     0.401 
## count_birth_order2/5         -0.039     0.052    -0.140     0.063    -0.747    53.209     0.458     0.699     0.432 
## count_birth_order3/5         -0.011     0.048    -0.104     0.083    -0.220    64.227     0.827     0.598     0.393 
## count_birth_order4/5         -0.020     0.044    -0.107     0.067    -0.444   104.080     0.658     0.417     0.307 
## count_birth_order5/5          0.028     0.049    -0.068     0.124     0.579    36.521     0.566     0.986     0.522 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.019     0.038     5.935    27.141     0.000     1.358     0.604 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.733    49.372     0.467     0.745     0.449 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.110    77.415     0.038     0.517     0.357 
## male                         -0.003     0.014    -0.030     0.024    -0.217   118.507     0.828     0.380     0.288 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.245 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-99" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-24" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1344.167        8   92.882    0.000    0.295 
##   2 vs 3:    2.333        3   18.363    0.108    1.461 
##   3 vs 4:    1.859        1   19.689    0.188    2.087 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-12" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-25" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-100" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.470     0.036    -0.540    -0.400   -13.162    15.247     0.000     3.316     0.794 
## poly(age, 3, raw = TRUE)1     0.026     0.004     0.018     0.034     6.561    19.442     0.000     2.129     0.709 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.765    31.669     0.450     1.142     0.560 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.908    27.868     0.067     1.316     0.596 
## male                          0.004     0.012    -0.020     0.028     0.327    74.136     0.745     0.535     0.365 
## sibling_count                -0.015     0.007    -0.030    -0.001    -2.036    33.925     0.050     1.062     0.541 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.259 
## Residual~~Residual                     0.621 
## ICC|mother_pidlink                     0.295 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-100" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-271-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-25" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-101" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.488     0.034    -0.556    -0.421   -14.173    17.048     0.000     2.657     0.754 
## birth_order                   0.018     0.008     0.003     0.034     2.317    35.352     0.026     1.018     0.530 
## poly(age, 3, raw = TRUE)1     0.027     0.004     0.019     0.034     7.029    21.217     0.000     1.868     0.680 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.679    34.141     0.502     1.055     0.540 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.893    28.667     0.068     1.274     0.588 
## male                          0.004     0.012    -0.020     0.028     0.323    70.498     0.748     0.556     0.375 
## sibling_count                -0.025     0.008    -0.041    -0.009    -3.131    48.410     0.003     0.758     0.453 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.259 
## Residual~~Residual                     0.621 
## ICC|mother_pidlink                     0.295 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-101" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-273-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-25" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-102" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.468     0.040    -0.546    -0.391   -11.817    14.204     0.000     3.902     0.820 
## birth_order_nonlinear2        0.015     0.014    -0.013     0.043     1.054    71.863     0.295     0.548     0.371 
## birth_order_nonlinear3        0.031     0.020    -0.008     0.070     1.575    65.054     0.120     0.592     0.390 
## birth_order_nonlinear4        0.033     0.025    -0.016     0.082     1.309   247.293     0.192     0.236     0.197 
## birth_order_nonlinear5        0.037     0.063    -0.086     0.160     0.587    20.097     0.563     2.023     0.698 
## poly(age, 3, raw = TRUE)1     0.027     0.004     0.019     0.035     6.559    19.497     0.000     2.119     0.708 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.805    30.214     0.427     1.202     0.573 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -1.987    26.639     0.057     1.388     0.610 
## male                          0.002     0.012    -0.022     0.026     0.189    77.599     0.851     0.516     0.357 
## sibling_count                -0.024     0.008    -0.039    -0.008    -2.971    60.766     0.004     0.626     0.404 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.259 
## Residual~~Residual                     0.618 
## ICC|mother_pidlink                     0.296 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-102" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-275-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-25" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-103" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.545     0.045    -0.633    -0.457   -12.139    18.235     0.000     2.362     0.731 
## count_birth_order2/2          0.035     0.025    -0.014     0.085     1.396    32.373     0.172     1.115     0.554 
## count_birth_order1/3          0.011     0.031    -0.050     0.072     0.358    45.790     0.722     0.796     0.466 
## count_birth_order2/3          0.004     0.027    -0.048     0.057     0.153    76.890     0.879     0.520     0.359 
## count_birth_order3/3          0.040     0.032    -0.023     0.104     1.247    36.807     0.220     0.978     0.520 
## count_birth_order1/4         -0.056     0.038    -0.131     0.019    -1.475    83.979     0.144     0.487     0.343 
## count_birth_order2/4         -0.041     0.042    -0.123     0.041    -0.973    31.254     0.338     1.158     0.564 
## count_birth_order3/4         -0.035     0.035    -0.104     0.034    -0.993    78.704     0.324     0.511     0.354 
## count_birth_order4/4          0.013     0.038    -0.061     0.087     0.349    61.796     0.729     0.617     0.401 
## count_birth_order1/5         -0.096     0.054    -0.202     0.011    -1.762    57.614     0.083     0.654     0.415 
## count_birth_order2/5         -0.135     0.047    -0.228    -0.042    -2.850    90.839     0.005     0.459     0.329 
## count_birth_order3/5         -0.070     0.053    -0.174     0.034    -1.322    36.443     0.195     0.988     0.522 
## count_birth_order4/5         -0.098     0.046    -0.187    -0.009    -2.153    85.131     0.034     0.482     0.340 
## count_birth_order5/5         -0.046     0.059    -0.163     0.070    -0.779    28.628     0.442     1.276     0.588 
## poly(age, 3, raw = TRUE)1     0.029     0.005     0.020     0.039     6.001    19.916     0.000     2.051     0.701 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.263    25.841     0.794     1.440     0.619 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.370    23.434     0.184     1.630     0.649 
## male                         -0.000     0.014    -0.028     0.027    -0.013    59.746     0.990     0.634     0.408 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.259 
## Residual~~Residual                     0.615 
## ICC|mother_pidlink                     0.296 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-103" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-25" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 918.580       8  14.826   0.000   1.328 
##  2 vs 3: 374.228       3  16.133   0.000   1.728 
##  3 vs 4:  76.191       1  23.936   0.000   1.585 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-12" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-279-1.png" width="672" /></p>
</div>
</div>
<div id="raven-2007-young" class="section level3 tabset">
<h3>Raven 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = raven_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-13" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-26" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-104" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.526     0.041    -0.606    -0.446   -12.902    14.029     0.000     4.024     0.824 
## poly(age, 3, raw = TRUE)1     0.029     0.004     0.021     0.037     7.179    20.685     0.000     1.938     0.688 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.301    24.216     0.766     1.562     0.638 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.369    24.961     0.183     1.503     0.629 
## male                          0.029     0.013     0.005     0.054     2.322   102.954     0.022     0.420     0.309 
## sibling_count                -0.007     0.007    -0.021     0.007    -0.958    39.838     0.344     0.906     0.500 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.240 
## Residual~~Residual                     0.613 
## ICC|mother_pidlink                     0.282 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-104" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-26" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-105" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.534     0.039    -0.610    -0.457   -13.685    15.600     0.000     3.159     0.785 
## birth_order                   0.008     0.010    -0.012     0.028     0.760    21.819     0.455     1.795     0.671 
## poly(age, 3, raw = TRUE)1     0.029     0.004     0.022     0.037     7.676    24.248     0.000     1.559     0.638 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.194    26.209     0.847     1.415     0.614 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.311    26.198     0.201     1.416     0.614 
## male                          0.029     0.013     0.004     0.054     2.312   104.592     0.023     0.415     0.306 
## sibling_count                -0.012     0.010    -0.031     0.007    -1.236    31.325     0.226     1.155     0.563 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.240 
## Residual~~Residual                     0.613 
## ICC|mother_pidlink                     0.282 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-105" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-26" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-106" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.528     0.041    -0.608    -0.448   -12.935    14.275     0.000     3.855     0.818 
## birth_order_nonlinear2        0.015     0.020    -0.024     0.055     0.761    23.754     0.454     1.601     0.644 
## birth_order_nonlinear3        0.007     0.023    -0.038     0.052     0.314    42.306     0.755     0.856     0.485 
## birth_order_nonlinear4        0.020     0.035    -0.049     0.089     0.560    27.726     0.580     1.324     0.598 
## birth_order_nonlinear5        0.049     0.056    -0.060     0.158     0.880    21.794     0.388     1.798     0.671 
## poly(age, 3, raw = TRUE)1     0.029     0.004     0.022     0.037     7.730    24.751     0.000     1.519     0.632 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.191    27.024     0.850     1.365     0.605 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.320    27.322     0.198     1.347     0.602 
## male                          0.029     0.013     0.004     0.054     2.310   109.124     0.023     0.403     0.300 
## sibling_count                -0.012     0.010    -0.030     0.007    -1.234    32.046     0.226     1.127     0.557 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.240 
## Residual~~Residual                     0.613 
## ICC|mother_pidlink                     0.282 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-106" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-26" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-107" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.572     0.044    -0.658    -0.486   -13.052    20.590     0.000     1.951     0.690 
## count_birth_order2/2          0.025     0.023    -0.020     0.071     1.083    77.332     0.282     0.518     0.358 
## count_birth_order1/3          0.003     0.032    -0.059     0.065     0.102    60.268     0.919     0.630     0.406 
## count_birth_order2/3          0.000     0.036    -0.070     0.071     0.011    32.546     0.991     1.109     0.553 
## count_birth_order3/3          0.024     0.033    -0.040     0.088     0.748    45.646     0.458     0.799     0.467 
## count_birth_order1/4         -0.041     0.043    -0.126     0.043    -0.959    39.544     0.343     0.912     0.502 
## count_birth_order2/4         -0.014     0.047    -0.106     0.078    -0.297    28.887     0.769     1.263     0.586 
## count_birth_order3/4         -0.059     0.038    -0.133     0.015    -1.559    65.767     0.124     0.587     0.388 
## count_birth_order4/4         -0.000     0.053    -0.104     0.103    -0.003    18.636     0.997     2.278     0.723 
## count_birth_order1/5         -0.050     0.045    -0.140     0.039    -1.111   121.402     0.269     0.374     0.284 
## count_birth_order2/5         -0.040     0.049    -0.136     0.055    -0.833    76.047     0.407     0.524     0.361 
## count_birth_order3/5         -0.045     0.043    -0.129     0.039    -1.046   158.433     0.297     0.313     0.248 
## count_birth_order4/5         -0.037     0.049    -0.133     0.059    -0.748    48.082     0.458     0.763     0.455 
## count_birth_order5/5          0.010     0.048    -0.084     0.105     0.212    37.334     0.833     0.965     0.516 
## poly(age, 3, raw = TRUE)1     0.031     0.005     0.021     0.040     6.256    25.769     0.000     1.445     0.619 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.390    29.914     0.699     1.215     0.576 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.454    38.402     0.154     0.938     0.509 
## male                          0.022     0.014    -0.005     0.050     1.593    88.860     0.115     0.467     0.333 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.234 
## Residual~~Residual                     0.608 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-107" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-26" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1547.830        8  420.054    0.000    0.120 
##   2 vs 3:    2.289        3   17.908    0.113    1.508 
##   3 vs 4:    1.283        1   22.120    0.269    1.761 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-13" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-27" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-108" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.515     0.038    -0.589    -0.441   -13.634    14.165     0.000     3.929     0.821 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.036     6.779    18.192     0.000     2.371     0.731 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.547    22.795     0.590     1.691     0.657 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.564    24.740     0.130     1.520     0.632 
## male                          0.029     0.013     0.004     0.055     2.259    44.461     0.029     0.818     0.473 
## sibling_count                -0.015     0.006    -0.027    -0.004    -2.546   109.578     0.012     0.402     0.299 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-108" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-27" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-109" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.527     0.036    -0.597    -0.457   -14.694    15.871     0.000     3.049     0.779 
## birth_order                   0.012     0.009    -0.005     0.029     1.385    24.146     0.179     1.567     0.639 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.036     7.147    19.577     0.000     2.106     0.707 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.501    23.938     0.621     1.585     0.642 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.565    25.593     0.130     1.457     0.621 
## male                          0.029     0.013     0.004     0.055     2.243    43.377     0.030     0.837     0.479 
## sibling_count                -0.022     0.008    -0.037    -0.007    -2.859    56.286     0.006     0.666     0.420 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.616 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-109" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-27" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-110" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.514     0.041    -0.595    -0.433   -12.479    13.551     0.000     4.404     0.837 
## birth_order_nonlinear2        0.010     0.015    -0.019     0.040     0.675    49.326     0.503     0.746     0.449 
## birth_order_nonlinear3        0.023     0.021    -0.019     0.065     1.059    42.034     0.296     0.861     0.487 
## birth_order_nonlinear4        0.018     0.027    -0.036     0.072     0.652    83.878     0.516     0.487     0.343 
## birth_order_nonlinear5        0.007     0.064    -0.119     0.133     0.110    18.854     0.914     2.235     0.719 
## poly(age, 3, raw = TRUE)1     0.028     0.004     0.020     0.036     6.895    19.385     0.000     2.138     0.710 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.676    24.043     0.505     1.576     0.641 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.724    24.824     0.097     1.513     0.631 
## male                          0.028     0.013     0.002     0.054     2.135    46.806     0.038     0.781     0.461 
## sibling_count                -0.021     0.008    -0.036    -0.005    -2.658    67.060     0.010     0.578     0.384 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.246 
## Residual~~Residual                     0.613 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-110" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-27" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-111" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.579     0.043    -0.663    -0.496   -13.599    19.631     0.000     2.097     0.706 
## count_birth_order2/2          0.024     0.024    -0.024     0.072     0.984    36.197     0.332     0.995     0.524 
## count_birth_order1/3          0.001     0.030    -0.059     0.060     0.020    48.636     0.984     0.755     0.452 
## count_birth_order2/3         -0.003     0.027    -0.056     0.050    -0.111    63.592     0.912     0.603     0.395 
## count_birth_order3/3          0.028     0.029    -0.029     0.085     0.973    62.267     0.335     0.613     0.399 
## count_birth_order1/4         -0.048     0.045    -0.135     0.039    -1.080    34.013     0.288     1.059     0.541 
## count_birth_order2/4         -0.045     0.041    -0.126     0.035    -1.108    32.562     0.276     1.109     0.552 
## count_birth_order3/4         -0.045     0.034    -0.111     0.021    -1.324   107.994     0.188     0.406     0.302 
## count_birth_order4/4         -0.005     0.037    -0.076     0.067    -0.126    69.106     0.900     0.565     0.379 
## count_birth_order1/5         -0.102     0.051    -0.203    -0.001    -1.981    80.463     0.051     0.503     0.350 
## count_birth_order2/5         -0.123     0.042    -0.206    -0.040    -2.904   338.645     0.004     0.195     0.168 
## count_birth_order3/5         -0.063     0.051    -0.164     0.037    -1.242    41.299     0.221     0.876     0.491 
## count_birth_order4/5         -0.101     0.057    -0.213     0.011    -1.771    27.015     0.088     1.365     0.605 
## count_birth_order5/5         -0.066     0.055    -0.175     0.042    -1.198    35.595     0.239     1.011     0.529 
## poly(age, 3, raw = TRUE)1     0.030     0.005     0.021     0.040     6.551    21.802     0.000     1.797     0.671 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.213    25.025     0.833     1.498     0.628 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.212    24.529     0.237     1.536     0.634 
## male                          0.029     0.014     0.002     0.056     2.099    64.304     0.040     0.598     0.393 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.244 
## Residual~~Residual                     0.611 
## ICC|mother_pidlink                     0.285 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-111" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-296-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-27" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1049.073        8   18.772    0.000    1.028 
##   2 vs 3:  416.370        3   18.358    0.000    1.462 
##   3 vs 4:   77.121        1   24.423    0.000    1.545 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-13" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
</div>
</div>
<div id="numeracy-2007-young" class="section level3 tabset">
<h3>Numeracy 2007 young</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = math_2007_young)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-14" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-28" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-112" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.310     0.041    -0.390    -0.229    -7.525    14.606     0.000     3.651     0.809 
## poly(age, 3, raw = TRUE)1     0.018     0.004     0.010     0.026     4.450    21.885     0.000     1.788     0.670 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.564    52.154     0.575     0.711     0.437 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.621    36.529     0.114     0.986     0.522 
## male                         -0.017     0.013    -0.042     0.008    -1.305   157.817     0.194     0.314     0.248 
## sibling_count                -0.005     0.007    -0.019     0.009    -0.680    60.300     0.499     0.630     0.406 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.262 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.279 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-112" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-300-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-28" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-113" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.322     0.044    -0.408    -0.237    -7.376    14.432     0.000     3.755     0.814 
## birth_order                   0.013     0.011    -0.007     0.034     1.270    22.713     0.217     1.699     0.658 
## poly(age, 3, raw = TRUE)1     0.019     0.004     0.011     0.028     4.600    21.698     0.000     1.809     0.673 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.341    54.737     0.734     0.682     0.426 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.477    36.890     0.148     0.976     0.519 
## male                         -0.017     0.013    -0.042     0.008    -1.332   165.923     0.185     0.304     0.242 
## sibling_count                -0.013     0.010    -0.033     0.007    -1.279    29.252     0.211     1.246     0.582 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.262 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.279 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-113" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-28" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-114" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.313     0.042    -0.395    -0.230    -7.396    14.453     0.000     3.742     0.813 
## birth_order_nonlinear2        0.025     0.019    -0.013     0.063     1.275    31.550     0.212     1.146     0.561 
## birth_order_nonlinear3        0.029     0.023    -0.017     0.075     1.238    48.558     0.221     0.756     0.453 
## birth_order_nonlinear4        0.029     0.034    -0.038     0.096     0.857    36.930     0.397     0.975     0.519 
## birth_order_nonlinear5        0.065     0.063    -0.058     0.188     1.037    18.940     0.313     2.219     0.718 
## poly(age, 3, raw = TRUE)1     0.019     0.004     0.011     0.028     4.634    21.771     0.000     1.801     0.672 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.301    57.554     0.765     0.654     0.415 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.453    39.141     0.154     0.921     0.504 
## male                         -0.017     0.013    -0.042     0.008    -1.346   167.613     0.180     0.302     0.241 
## sibling_count                -0.013     0.010    -0.033     0.006    -1.322    31.182     0.196     1.161     0.564 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.262 
## Residual~~Residual                     0.676 
## ICC|mother_pidlink                     0.279 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-114" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-304-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-28" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-115" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.358     0.057    -0.470    -0.246    -6.270    14.831     0.000     3.525     0.804 
## count_birth_order2/2          0.040     0.030    -0.019     0.099     1.333    27.860     0.193     1.317     0.596 
## count_birth_order1/3          0.011     0.035    -0.058     0.080     0.311    45.094     0.757     0.807     0.470 
## count_birth_order2/3          0.018     0.035    -0.051     0.087     0.517    45.828     0.608     0.796     0.466 
## count_birth_order3/3          0.045     0.033    -0.019     0.109     1.384    59.957     0.171     0.632     0.407 
## count_birth_order1/4         -0.047     0.043    -0.132     0.037    -1.096    51.435     0.278     0.719     0.440 
## count_birth_order2/4         -0.016     0.045    -0.104     0.073    -0.349    40.547     0.729     0.891     0.495 
## count_birth_order3/4         -0.052     0.040    -0.130     0.026    -1.301    68.209     0.198     0.570     0.381 
## count_birth_order4/4         -0.004     0.053    -0.108     0.100    -0.073    20.239     0.942     2.002     0.696 
## count_birth_order1/5         -0.035     0.052    -0.138     0.068    -0.665    57.954     0.509     0.650     0.414 
## count_birth_order2/5         -0.027     0.055    -0.134     0.081    -0.486    48.298     0.629     0.760     0.454 
## count_birth_order3/5          0.027     0.055    -0.081     0.134     0.485    38.431     0.630     0.938     0.509 
## count_birth_order4/5          0.002     0.045    -0.086     0.090     0.047   144.768     0.963     0.332     0.259 
## count_birth_order5/5          0.039     0.053    -0.065     0.143     0.739    31.855     0.465     1.135     0.558 
## poly(age, 3, raw = TRUE)1     0.019     0.005     0.009     0.030     3.763    25.638     0.001     1.454     0.621 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.796    62.085     0.429     0.615     0.400 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.908    75.467     0.060     0.528     0.362 
## male                         -0.027     0.015    -0.057     0.002    -1.827    77.933     0.071     0.515     0.356 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.260 
## Residual~~Residual                     0.674 
## ICC|mother_pidlink                     0.278 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-115" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-306-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-28" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1486.691        8  187.919    0.000    0.191 
##   2 vs 3:    2.562        3   20.472    0.083    1.285 
##   3 vs 4:    2.580        1   24.001    0.121    1.580 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-14" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-29" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-116" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.299     0.039    -0.375    -0.222    -7.651    14.365     0.000     3.797     0.816 
## poly(age, 3, raw = TRUE)1     0.017     0.004     0.009     0.025     4.226    19.323     0.000     2.149     0.711 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.695    36.546     0.492     0.985     0.522 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.614    28.081     0.118     1.305     0.594 
## male                         -0.023     0.012    -0.046     0.001    -1.900   115.346     0.060     0.388     0.292 
## sibling_count                -0.011     0.008    -0.027     0.006    -1.301    25.275     0.205     1.480     0.625 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.270 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-116" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-29" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-117" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.318     0.041    -0.397    -0.238    -7.841    14.494     0.000     3.717     0.812 
## birth_order                   0.019     0.008     0.004     0.035     2.503    44.105     0.016     0.824     0.475 
## poly(age, 3, raw = TRUE)1     0.018     0.004     0.010     0.026     4.445    19.492     0.000     2.120     0.708 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.582    36.058     0.564     0.998     0.525 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.571    27.738     0.128     1.324     0.598 
## male                         -0.023     0.012    -0.046     0.001    -1.900   115.823     0.060     0.386     0.291 
## sibling_count                -0.022     0.009    -0.039    -0.004    -2.468    37.681     0.018     0.956     0.514 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.270 
## Residual~~Residual                     0.675 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-117" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-311-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-29" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-118" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.297     0.041    -0.377    -0.216    -7.223    14.219     0.000     3.892     0.819 
## birth_order_nonlinear2        0.016     0.014    -0.011     0.043     1.140   120.086     0.256     0.377     0.286 
## birth_order_nonlinear3        0.032     0.019    -0.006     0.070     1.648   119.702     0.102     0.378     0.286 
## birth_order_nonlinear4        0.039     0.030    -0.019     0.097     1.321    67.949     0.191     0.572     0.382 
## birth_order_nonlinear5        0.056     0.059    -0.059     0.171     0.958    25.796     0.347     1.443     0.619 
## poly(age, 3, raw = TRUE)1     0.018     0.004     0.010     0.027     4.148    17.903     0.001     2.437     0.737 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.616    29.654     0.543     1.227     0.578 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.563    24.647     0.131     1.527     0.633 
## male                         -0.024     0.012    -0.048    -0.000    -1.982   116.743     0.050     0.384     0.290 
## sibling_count                -0.020     0.009    -0.037    -0.004    -2.384    47.943     0.021     0.765     0.456 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.270 
## Residual~~Residual                     0.673 
## ICC|mother_pidlink                     0.286 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-118" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-313-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-29" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-119" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.364     0.046    -0.454    -0.275    -7.994    18.986     0.000     2.210     0.717 
## count_birth_order2/2          0.038     0.024    -0.010     0.085     1.556    48.517     0.126     0.757     0.453 
## count_birth_order1/3          0.019     0.031    -0.043     0.080     0.598    54.944     0.552     0.680     0.425 
## count_birth_order2/3          0.010     0.029    -0.046     0.066     0.346    63.614     0.731     0.603     0.395 
## count_birth_order3/3          0.042     0.035    -0.027     0.110     1.201    32.124     0.239     1.125     0.556 
## count_birth_order1/4         -0.049     0.042    -0.132     0.033    -1.172    55.566     0.246     0.674     0.423 
## count_birth_order2/4         -0.025     0.040    -0.105     0.054    -0.626    42.246     0.535     0.857     0.485 
## count_birth_order3/4         -0.016     0.040    -0.095     0.062    -0.403    45.645     0.689     0.799     0.467 
## count_birth_order4/4          0.028     0.044    -0.059     0.114     0.628    34.252     0.534     1.052     0.539 
## count_birth_order1/5         -0.065     0.057    -0.176     0.047    -1.130    54.692     0.263     0.683     0.426 
## count_birth_order2/5         -0.111     0.057    -0.223     0.001    -1.936    36.927     0.061     0.975     0.519 
## count_birth_order3/5         -0.059     0.058    -0.172     0.055    -1.015    30.890     0.318     1.173     0.567 
## count_birth_order4/5         -0.069     0.046    -0.159     0.021    -1.497   109.617     0.137     0.402     0.299 
## count_birth_order5/5         -0.014     0.061    -0.133     0.105    -0.228    30.189     0.821     1.203     0.573 
## poly(age, 3, raw = TRUE)1     0.021     0.005     0.011     0.030     4.170    21.207     0.000     1.869     0.680 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.214    29.008     0.832     1.257     0.585 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.129    23.560     0.270     1.618     0.647 
## male                         -0.029     0.015    -0.059     0.001    -1.910    45.912     0.062     0.795     0.466 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.272 
## Residual~~Residual                     0.672 
## ICC|mother_pidlink                     0.288 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-119" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-315-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-29" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1053.036        8   17.922    0.000    1.078 
##   2 vs 3:  377.604        3   16.176    0.000    1.722 
##   3 vs 4:   85.105        1   25.942    0.000    1.433 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-14" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-317-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="personality" class="section level2 tabset">
<h2>Personality</h2>
<div id="extraversion" class="section level3 tabset">
<h3>Extraversion</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_ext)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-15" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-30" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-120" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.185     0.033     0.121     0.248     5.682    20.753     0.000     1.929     0.687 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.006    -0.414    30.036     0.682     1.209     0.575 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.036    42.485     0.971     0.853     0.484 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.379    61.536     0.706     0.619     0.402 
## male                         -0.251     0.017    -0.284    -0.218   -14.967    35.937     0.000     1.002     0.526 
## sibling_count                -0.005     0.006    -0.017     0.008    -0.730    74.180     0.467     0.534     0.365 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.067 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-120" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-30" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-121" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.185     0.035     0.116     0.254     5.273    19.695     0.000     2.086     0.705 
## birth_order                  -0.000     0.009    -0.018     0.017    -0.029    67.990     0.977     0.572     0.382 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.006    -0.415    30.808     0.681     1.176     0.568 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.041    46.201     0.967     0.790     0.464 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.386    68.535     0.701     0.568     0.380 
## male                         -0.251     0.017    -0.284    -0.218   -14.944    35.747     0.000     1.007     0.527 
## sibling_count                -0.005     0.008    -0.020     0.011    -0.565   110.143     0.573     0.400     0.298 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.067 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-121" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-30" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-122" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.180     0.033     0.115     0.246     5.398    20.737     0.000     1.931     0.688 
## birth_order_nonlinear2        0.014     0.020    -0.025     0.053     0.690    45.884     0.494     0.795     0.466 
## birth_order_nonlinear3       -0.002     0.027    -0.055     0.051    -0.078    42.732     0.938     0.848     0.483 
## birth_order_nonlinear4       -0.007     0.033    -0.072     0.058    -0.214    91.415     0.831     0.457     0.328 
## birth_order_nonlinear5        0.009     0.046    -0.081     0.100     0.205   113.470     0.838     0.392     0.294 
## poly(age, 3, raw = TRUE)1    -0.001     0.004    -0.009     0.006    -0.389    30.935     0.700     1.171     0.567 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.010    47.023     0.992     0.778     0.460 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.348    70.550     0.729     0.556     0.375 
## male                         -0.251     0.017    -0.284    -0.218   -14.973    36.006     0.000     1.000     0.526 
## sibling_count                -0.004     0.008    -0.020     0.011    -0.552   101.785     0.582     0.423     0.311 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.915 
## ICC|mother_pidlink                     0.067 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-122" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-323-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-30" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-123" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.046     0.089     0.269     3.905    21.620     0.001     1.818     0.674 
## count_birth_order2/2          0.006     0.029    -0.051     0.063     0.213    59.022     0.832     0.641     0.410 
## count_birth_order1/3         -0.004     0.030    -0.063     0.055    -0.131   244.409     0.896     0.237     0.198 
## count_birth_order2/3          0.004     0.040    -0.073     0.082     0.114    31.858     0.910     1.135     0.558 
## count_birth_order3/3         -0.004     0.033    -0.068     0.060    -0.125    75.224     0.901     0.529     0.363 
## count_birth_order1/4         -0.022     0.044    -0.108     0.064    -0.501    57.449     0.618     0.655     0.416 
## count_birth_order2/4          0.036     0.040    -0.043     0.115     0.889   115.791     0.376     0.387     0.291 
## count_birth_order3/4         -0.029     0.041    -0.109     0.052    -0.695    69.486     0.490     0.562     0.378 
## count_birth_order4/4         -0.032     0.041    -0.111     0.047    -0.788    60.678     0.434     0.626     0.404 
## count_birth_order1/5         -0.020     0.049    -0.115     0.075    -0.411   181.847     0.681     0.286     0.231 
## count_birth_order2/5         -0.037     0.049    -0.132     0.059    -0.753   236.999     0.452     0.242     0.202 
## count_birth_order3/5         -0.020     0.051    -0.119     0.079    -0.393    81.140     0.695     0.499     0.349 
## count_birth_order4/5         -0.004     0.057    -0.115     0.107    -0.069    38.071     0.946     0.946     0.511 
## count_birth_order5/5         -0.009     0.049    -0.105     0.087    -0.190    52.874     0.850     0.702     0.434 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.008    -0.395    28.966     0.696     1.259     0.585 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.261    41.793     0.795     0.866     0.488 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.639    58.905     0.525     0.642     0.411 
## male                         -0.258     0.020    -0.297    -0.218   -12.717    26.814     0.000     1.377     0.608 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.068 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-123" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-325-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-30" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1669.964        8 1262.406    0.000    0.066 
##   2 vs 3:    3.689        3   33.700    0.021    0.780 
##   3 vs 4:    1.122        1   32.624    0.297    1.106 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-15" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-31" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-124" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.185     0.035     0.116     0.253     5.279    16.308     0.000     2.889     0.770 
## poly(age, 3, raw = TRUE)1    -0.001     0.003    -0.008     0.005    -0.410    31.007     0.685     1.168     0.566 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.097    41.952     0.923     0.863     0.487 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.485    55.223     0.630     0.677     0.424 
## male                         -0.249     0.016    -0.280    -0.218   -15.813    32.607     0.000     1.107     0.552 
## sibling_count                -0.006     0.007    -0.019     0.007    -0.870    39.430     0.390     0.915     0.502 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.921 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-124" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-328-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-31" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-125" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.177     0.039     0.100     0.254     4.500    14.841     0.000     3.519     0.804 
## birth_order                   0.009     0.011    -0.013     0.030     0.812    20.526     0.426     1.960     0.691 
## poly(age, 3, raw = TRUE)1    -0.001     0.004    -0.008     0.006    -0.287    29.127     0.776     1.252     0.584 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.030    40.358     0.977     0.895     0.497 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.436    52.719     0.665     0.704     0.434 
## male                         -0.250     0.016    -0.280    -0.219   -15.959    33.703     0.000     1.069     0.543 
## sibling_count                -0.011     0.008    -0.027     0.005    -1.362    50.054     0.179     0.736     0.446 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.921 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-125" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-31" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-126" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.186     0.032     0.123     0.248     5.781    20.510     0.000     1.962     0.691 
## birth_order_nonlinear2        0.006     0.017    -0.028     0.039     0.330    55.491     0.743     0.674     0.423 
## birth_order_nonlinear3        0.012     0.030    -0.047     0.071     0.404    22.590     0.690     1.711     0.660 
## birth_order_nonlinear4        0.029     0.038    -0.047     0.104     0.750    31.511     0.459     1.148     0.561 
## birth_order_nonlinear5        0.031     0.073    -0.112     0.174     0.425    19.607     0.676     2.101     0.706 
## poly(age, 3, raw = TRUE)1    -0.001     0.004    -0.008     0.006    -0.256    30.433     0.800     1.192     0.571 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.035    41.314     0.972     0.875     0.491 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.453    47.321     0.653     0.773     0.459 
## male                         -0.248     0.015    -0.278    -0.218   -16.132    38.873     0.000     0.927     0.506 
## sibling_count                -0.011     0.009    -0.028     0.007    -1.190    33.820     0.242     1.066     0.542 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.062 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.063 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-126" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-332-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-31" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-127" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.163     0.037     0.090     0.236     4.352    30.920     0.000     1.172     0.567 
## count_birth_order2/2          0.004     0.023    -0.041     0.048     0.157   216.216     0.875     0.256     0.211 
## count_birth_order1/3         -0.023     0.034    -0.090     0.044    -0.680    42.595     0.500     0.851     0.483 
## count_birth_order2/3         -0.011     0.030    -0.069     0.048    -0.355    62.214     0.724     0.614     0.399 
## count_birth_order3/3          0.001     0.034    -0.066     0.069     0.042    40.393     0.966     0.894     0.496 
## count_birth_order1/4         -0.012     0.045    -0.101     0.077    -0.263    49.065     0.793     0.749     0.450 
## count_birth_order2/4         -0.040     0.045    -0.128     0.047    -0.904    33.402     0.373     1.079     0.546 
## count_birth_order3/4         -0.017     0.039    -0.094     0.059    -0.441    66.963     0.660     0.579     0.385 
## count_birth_order4/4          0.006     0.046    -0.084     0.096     0.130    35.496     0.897     1.014     0.529 
## count_birth_order1/5         -0.056     0.065    -0.183     0.072    -0.853    37.652     0.399     0.957     0.514 
## count_birth_order2/5         -0.052     0.046    -0.142     0.039    -1.122   467.221     0.263     0.161     0.142 
## count_birth_order3/5         -0.033     0.055    -0.142     0.075    -0.599    44.066     0.552     0.825     0.475 
## count_birth_order4/5         -0.017     0.069    -0.152     0.118    -0.245    21.289     0.809     1.859     0.679 
## count_birth_order5/5         -0.021     0.063    -0.145     0.103    -0.327    31.240     0.746     1.159     0.564 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.008     0.009     0.124    32.448     0.902     1.113     0.553 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.224    40.303     0.824     0.896     0.497 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.219    41.880     0.828     0.864     0.487 
## male                         -0.253     0.019    -0.290    -0.216   -13.351    27.274     0.000     1.350     0.603 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.922 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-127" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-334-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-31" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1201.704        8   22.582    0.000    0.859 
##   2 vs 3:  426.101        3   18.134    0.000    1.484 
##   3 vs 4:  115.708        1   41.026    0.000    0.881 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-15" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
</div>
</div>
<div id="neuroticism" class="section level3 tabset">
<h3>Neuroticism</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-16" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-32" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-128" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.206     0.028     0.151     0.260     7.417    31.140     0.000     1.163     0.565 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.000    -1.887    34.954     0.068     1.030     0.533 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.350    51.035     0.183     0.724     0.441 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.894    56.331     0.063     0.666     0.420 
## male                          0.027     0.014    -0.001     0.055     1.882    91.350     0.063     0.457     0.328 
## sibling_count                -0.005     0.006    -0.016     0.006    -0.926   325.960     0.355     0.199     0.171 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.058 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-128" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-338-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-32" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-129" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.201     0.029     0.144     0.259     6.883    30.859     0.000     1.174     0.567 
## birth_order                   0.005     0.008    -0.010     0.021     0.672   196.121     0.503     0.273     0.222 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.014     0.001    -1.718    33.156     0.095     1.088     0.548 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.402    48.844     0.167     0.752     0.451 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.933    54.986     0.058     0.679     0.425 
## male                          0.027     0.014    -0.001     0.055     1.870    89.974     0.065     0.463     0.331 
## sibling_count                -0.008     0.008    -0.024     0.007    -1.108   163.941     0.269     0.306     0.243 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.058 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-129" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-340-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-32" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-130" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.209     0.027     0.155     0.262     7.631    36.599     0.000     0.984     0.521 
## birth_order_nonlinear2       -0.000     0.020    -0.039     0.038    -0.014    49.129     0.989     0.748     0.450 
## birth_order_nonlinear3        0.010     0.021    -0.031     0.050     0.480  1308.594     0.631     0.090     0.084 
## birth_order_nonlinear4        0.014     0.034    -0.053     0.081     0.410    69.141     0.683     0.564     0.379 
## birth_order_nonlinear5        0.026     0.053    -0.077     0.130     0.499    43.714     0.620     0.831     0.477 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.014     0.001    -1.737    34.061     0.091     1.058     0.540 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.401    50.561     0.167     0.730     0.443 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.926    56.405     0.059     0.665     0.420 
## male                          0.027     0.014    -0.001     0.055     1.865    86.417     0.066     0.476     0.338 
## sibling_count                -0.008     0.008    -0.023     0.007    -1.102   179.182     0.272     0.289     0.233 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.058 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-130" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-342-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-32" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-131" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.166     0.036     0.096     0.237     4.641    48.616     0.000     0.755     0.452 
## count_birth_order2/2          0.017     0.029    -0.041     0.074     0.567    55.821     0.573     0.671     0.422 
## count_birth_order1/3          0.036     0.039    -0.040     0.113     0.930    32.274     0.359     1.119     0.555 
## count_birth_order2/3          0.014     0.040    -0.065     0.094     0.355    28.845     0.725     1.265     0.586 
## count_birth_order3/3          0.024     0.033    -0.040     0.088     0.731    70.267     0.467     0.557     0.375 
## count_birth_order1/4         -0.014     0.045    -0.102     0.073    -0.317    50.440     0.753     0.731     0.444 
## count_birth_order2/4          0.020     0.043    -0.064     0.104     0.467    66.857     0.642     0.580     0.385 
## count_birth_order3/4          0.016     0.046    -0.075     0.106     0.335    35.913     0.739     1.002     0.526 
## count_birth_order4/4          0.010     0.042    -0.073     0.094     0.242    44.565     0.810     0.816     0.473 
## count_birth_order1/5         -0.016     0.048    -0.111     0.079    -0.321   166.152     0.749     0.303     0.242 
## count_birth_order2/5         -0.010     0.049    -0.105     0.086    -0.199   199.925     0.843     0.269     0.220 
## count_birth_order3/5          0.009     0.051    -0.090     0.109     0.187    75.814     0.852     0.526     0.361 
## count_birth_order4/5          0.028     0.050    -0.069     0.126     0.565    77.147     0.574     0.519     0.358 
## count_birth_order5/5          0.024     0.055    -0.083     0.132     0.440    31.089     0.663     1.165     0.565 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.003    -1.151    59.028     0.254     0.641     0.410 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.521    72.087     0.133     0.546     0.371 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.886    73.964     0.063     0.536     0.366 
## male                          0.022     0.016    -0.009     0.053     1.397    85.591     0.166     0.480     0.340 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-131" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-32" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1564.073        8  297.598    0.000    0.146 
##   2 vs 3:    3.456        3   24.566    0.032    1.055 
##   3 vs 4:    1.140        1   22.584    0.297    1.712 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-16" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-33" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-132" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.204     0.023     0.158     0.250     8.673    47.026     0.000     0.778     0.460 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.000    -2.072    26.213     0.048     1.415     0.614 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.194    40.870     0.239     0.884     0.493 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.895    53.711     0.063     0.693     0.430 
## male                          0.033     0.014     0.005     0.060     2.352    55.263     0.022     0.677     0.424 
## sibling_count                -0.005     0.007    -0.019     0.008    -0.754    34.715     0.456     1.037     0.535 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.918 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-132" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-347-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-33" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-133" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.205     0.025     0.156     0.254     8.181    42.857     0.000     0.846     0.482 
## birth_order                  -0.001     0.008    -0.017     0.015    -0.098    54.295     0.923     0.687     0.428 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.000    -2.070    25.940     0.049     1.433     0.617 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.173    40.491     0.247     0.892     0.496 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.876    53.056     0.066     0.700     0.433 
## male                          0.033     0.014     0.005     0.061     2.350    53.915     0.022     0.691     0.429 
## sibling_count                -0.005     0.009    -0.022     0.012    -0.557    31.067     0.582     1.166     0.565 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-133" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-349-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-33" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-134" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.204     0.024     0.157     0.250     8.624    60.905     0.000     0.624     0.404 
## birth_order_nonlinear2       -0.004     0.015    -0.034     0.026    -0.265   131.739     0.791     0.354     0.272 
## birth_order_nonlinear3        0.003     0.023    -0.043     0.049     0.126    58.775     0.900     0.643     0.411 
## birth_order_nonlinear4       -0.020     0.035    -0.089     0.049    -0.579    44.828     0.565     0.812     0.471 
## birth_order_nonlinear5        0.008     0.061    -0.112     0.129     0.136    29.873     0.893     1.217     0.576 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.000    -1.920    24.992     0.066     1.501     0.629 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.204    34.453     0.237     1.045     0.537 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.845    42.138     0.072     0.859     0.486 
## male                          0.032     0.014     0.004     0.061     2.271    54.255     0.027     0.687     0.428 
## sibling_count                -0.005     0.009    -0.022     0.013    -0.517    32.891     0.608     1.097     0.550 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-134" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-351-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-33" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-135" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.186     0.033     0.121     0.251     5.637    51.789     0.000     0.715     0.438 
## count_birth_order2/2          0.003     0.028    -0.052     0.058     0.104    39.039     0.918     0.924     0.505 
## count_birth_order1/3          0.028     0.034    -0.037     0.094     0.846    44.469     0.402     0.818     0.473 
## count_birth_order2/3          0.000     0.032    -0.061     0.062     0.015    43.322     0.988     0.838     0.479 
## count_birth_order3/3          0.005     0.034    -0.062     0.073     0.150    38.650     0.882     0.933     0.507 
## count_birth_order1/4         -0.018     0.051    -0.117     0.082    -0.347    29.468     0.731     1.235     0.580 
## count_birth_order2/4          0.006     0.035    -0.063     0.075     0.168   163.258     0.866     0.307     0.244 
## count_birth_order3/4         -0.003     0.036    -0.074     0.068    -0.077   127.734     0.939     0.361     0.277 
## count_birth_order4/4         -0.023     0.041    -0.103     0.056    -0.577    62.604     0.566     0.611     0.398 
## count_birth_order1/5         -0.031     0.074    -0.176     0.114    -0.420    24.463     0.678     1.542     0.635 
## count_birth_order2/5         -0.028     0.055    -0.135     0.080    -0.503    56.143     0.617     0.668     0.421 
## count_birth_order3/5          0.003     0.060    -0.115     0.120     0.043    30.847     0.966     1.175     0.567 
## count_birth_order4/5         -0.032     0.049    -0.128     0.064    -0.657    91.415     0.513     0.457     0.328 
## count_birth_order5/5         -0.000     0.063    -0.125     0.124    -0.006    30.271     0.995     1.199     0.573 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.800    47.528     0.078     0.770     0.458 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.230    49.260     0.224     0.747     0.449 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.784    49.673     0.080     0.741     0.447 
## male                          0.033     0.015     0.003     0.063     2.152    72.917     0.035     0.542     0.368 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.918 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-135" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-353-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-33" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1306.458        8   28.141    0.000    0.706 
##   2 vs 3:  305.353        3   12.828    0.000    2.453 
##   3 vs 4:   95.935        1   29.836    0.000    1.218 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-16" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-355-1.png" width="672" /></p>
</div>
</div>
<div id="conscientiousness" class="section level3 tabset">
<h3>Conscientiousness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_neu)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-17" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-34" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-136" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.206     0.028     0.151     0.260     7.417    31.140     0.000     1.163     0.565 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.014     0.000    -1.887    34.954     0.068     1.030     0.533 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.350    51.035     0.183     0.724     0.441 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.894    56.331     0.063     0.666     0.420 
## male                          0.027     0.014    -0.001     0.055     1.882    91.350     0.063     0.457     0.328 
## sibling_count                -0.005     0.006    -0.016     0.006    -0.926   325.960     0.355     0.199     0.171 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.058 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-136" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-357-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-34" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-137" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.201     0.029     0.144     0.259     6.883    30.859     0.000     1.174     0.567 
## birth_order                   0.005     0.008    -0.010     0.021     0.672   196.121     0.503     0.273     0.222 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.014     0.001    -1.718    33.156     0.095     1.088     0.548 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.402    48.844     0.167     0.752     0.451 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.933    54.986     0.058     0.679     0.425 
## male                          0.027     0.014    -0.001     0.055     1.870    89.974     0.065     0.463     0.331 
## sibling_count                -0.008     0.008    -0.024     0.007    -1.108   163.941     0.269     0.306     0.243 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.058 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-137" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-359-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-34" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-138" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.209     0.027     0.155     0.262     7.631    36.599     0.000     0.984     0.521 
## birth_order_nonlinear2       -0.000     0.020    -0.039     0.038    -0.014    49.129     0.989     0.748     0.450 
## birth_order_nonlinear3        0.010     0.021    -0.031     0.050     0.480  1308.594     0.631     0.090     0.084 
## birth_order_nonlinear4        0.014     0.034    -0.053     0.081     0.410    69.141     0.683     0.564     0.379 
## birth_order_nonlinear5        0.026     0.053    -0.077     0.130     0.499    43.714     0.620     0.831     0.477 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.014     0.001    -1.737    34.061     0.091     1.058     0.540 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.401    50.561     0.167     0.730     0.443 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.926    56.405     0.059     0.665     0.420 
## male                          0.027     0.014    -0.001     0.055     1.865    86.417     0.066     0.476     0.338 
## sibling_count                -0.008     0.008    -0.023     0.007    -1.102   179.182     0.272     0.289     0.233 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.058 
## Residual~~Residual                     0.914 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-138" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-361-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-34" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-139" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.166     0.036     0.096     0.237     4.641    48.616     0.000     0.755     0.452 
## count_birth_order2/2          0.017     0.029    -0.041     0.074     0.567    55.821     0.573     0.671     0.422 
## count_birth_order1/3          0.036     0.039    -0.040     0.113     0.930    32.274     0.359     1.119     0.555 
## count_birth_order2/3          0.014     0.040    -0.065     0.094     0.355    28.845     0.725     1.265     0.586 
## count_birth_order3/3          0.024     0.033    -0.040     0.088     0.731    70.267     0.467     0.557     0.375 
## count_birth_order1/4         -0.014     0.045    -0.102     0.073    -0.317    50.440     0.753     0.731     0.444 
## count_birth_order2/4          0.020     0.043    -0.064     0.104     0.467    66.857     0.642     0.580     0.385 
## count_birth_order3/4          0.016     0.046    -0.075     0.106     0.335    35.913     0.739     1.002     0.526 
## count_birth_order4/4          0.010     0.042    -0.073     0.094     0.242    44.565     0.810     0.816     0.473 
## count_birth_order1/5         -0.016     0.048    -0.111     0.079    -0.321   166.152     0.749     0.303     0.242 
## count_birth_order2/5         -0.010     0.049    -0.105     0.086    -0.199   199.925     0.843     0.269     0.220 
## count_birth_order3/5          0.009     0.051    -0.090     0.109     0.187    75.814     0.852     0.526     0.361 
## count_birth_order4/5          0.028     0.050    -0.069     0.126     0.565    77.147     0.574     0.519     0.358 
## count_birth_order5/5          0.024     0.055    -0.083     0.132     0.440    31.089     0.663     1.165     0.565 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.003    -1.151    59.028     0.254     0.641     0.410 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.001     0.000    -1.521    72.087     0.133     0.546     0.371 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.886    73.964     0.063     0.536     0.366 
## male                          0.022     0.016    -0.009     0.053     1.397    85.591     0.166     0.480     0.340 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.057 
## Residual~~Residual                     0.911 
## ICC|mother_pidlink                     0.059 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-139" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-363-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-34" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1564.073        8  297.598    0.000    0.146 
##   2 vs 3:    3.456        3   24.566    0.032    1.055 
##   3 vs 4:    1.140        1   22.584    0.297    1.712 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-17" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-35" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-140" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.204     0.023     0.158     0.250     8.673    47.026     0.000     0.778     0.460 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.000    -2.072    26.213     0.048     1.415     0.614 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.194    40.870     0.239     0.884     0.493 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.895    53.711     0.063     0.693     0.430 
## male                          0.033     0.014     0.005     0.060     2.352    55.263     0.022     0.677     0.424 
## sibling_count                -0.005     0.007    -0.019     0.008    -0.754    34.715     0.456     1.037     0.535 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.918 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-140" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-366-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-35" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-141" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.205     0.025     0.156     0.254     8.181    42.857     0.000     0.846     0.482 
## birth_order                  -0.001     0.008    -0.017     0.015    -0.098    54.295     0.923     0.687     0.428 
## poly(age, 3, raw = TRUE)1    -0.008     0.004    -0.015    -0.000    -2.070    25.940     0.049     1.433     0.617 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.173    40.491     0.247     0.892     0.496 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.876    53.056     0.066     0.700     0.433 
## male                          0.033     0.014     0.005     0.061     2.350    53.915     0.022     0.691     0.429 
## sibling_count                -0.005     0.009    -0.022     0.012    -0.557    31.067     0.582     1.166     0.565 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-141" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-368-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-35" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-142" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.204     0.024     0.157     0.250     8.624    60.905     0.000     0.624     0.404 
## birth_order_nonlinear2       -0.004     0.015    -0.034     0.026    -0.265   131.739     0.791     0.354     0.272 
## birth_order_nonlinear3        0.003     0.023    -0.043     0.049     0.126    58.775     0.900     0.643     0.411 
## birth_order_nonlinear4       -0.020     0.035    -0.089     0.049    -0.579    44.828     0.565     0.812     0.471 
## birth_order_nonlinear5        0.008     0.061    -0.112     0.129     0.136    29.873     0.893     1.217     0.576 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.000    -1.920    24.992     0.066     1.501     0.629 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.204    34.453     0.237     1.045     0.537 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.845    42.138     0.072     0.859     0.486 
## male                          0.032     0.014     0.004     0.061     2.271    54.255     0.027     0.687     0.428 
## sibling_count                -0.005     0.009    -0.022     0.013    -0.517    32.891     0.608     1.097     0.550 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.056 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-142" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-370-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-35" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-143" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.186     0.033     0.121     0.251     5.637    51.789     0.000     0.715     0.438 
## count_birth_order2/2          0.003     0.028    -0.052     0.058     0.104    39.039     0.918     0.924     0.505 
## count_birth_order1/3          0.028     0.034    -0.037     0.094     0.846    44.469     0.402     0.818     0.473 
## count_birth_order2/3          0.000     0.032    -0.061     0.062     0.015    43.322     0.988     0.838     0.479 
## count_birth_order3/3          0.005     0.034    -0.062     0.073     0.150    38.650     0.882     0.933     0.507 
## count_birth_order1/4         -0.018     0.051    -0.117     0.082    -0.347    29.468     0.731     1.235     0.580 
## count_birth_order2/4          0.006     0.035    -0.063     0.075     0.168   163.258     0.866     0.307     0.244 
## count_birth_order3/4         -0.003     0.036    -0.074     0.068    -0.077   127.734     0.939     0.361     0.277 
## count_birth_order4/4         -0.023     0.041    -0.103     0.056    -0.577    62.604     0.566     0.611     0.398 
## count_birth_order1/5         -0.031     0.074    -0.176     0.114    -0.420    24.463     0.678     1.542     0.635 
## count_birth_order2/5         -0.028     0.055    -0.135     0.080    -0.503    56.143     0.617     0.668     0.421 
## count_birth_order3/5          0.003     0.060    -0.115     0.120     0.043    30.847     0.966     1.175     0.567 
## count_birth_order4/5         -0.032     0.049    -0.128     0.064    -0.657    91.415     0.513     0.457     0.328 
## count_birth_order5/5         -0.000     0.063    -0.125     0.124    -0.006    30.271     0.995     1.199     0.573 
## poly(age, 3, raw = TRUE)1    -0.007     0.004    -0.015     0.001    -1.800    47.528     0.078     0.770     0.458 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.230    49.260     0.224     0.747     0.449 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.784    49.673     0.080     0.741     0.447 
## male                          0.033     0.015     0.003     0.063     2.152    72.917     0.035     0.542     0.368 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.055 
## Residual~~Residual                     0.918 
## ICC|mother_pidlink                     0.057 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-143" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-372-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-35" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1306.458        8   28.141    0.000    0.706 
##   2 vs 3:  305.353        3   12.828    0.000    2.453 
##   3 vs 4:   95.935        1   29.836    0.000    1.218 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-17" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-374-1.png" width="672" /></p>
</div>
</div>
<div id="agreeableness" class="section level3 tabset">
<h3>Agreeableness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_agree)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-18" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-36" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-144" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.153     0.043    -0.237    -0.069    -3.563    14.036     0.003     4.019     0.824 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.007     0.011     0.434    17.287     0.670     2.591     0.749 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     1.974    24.882     0.060     1.509     0.630 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.756    31.590     0.010     1.145     0.561 
## male                          0.016     0.016    -0.016     0.048     0.961    41.431     0.342     0.873     0.490 
## sibling_count                 0.001     0.006    -0.010     0.013     0.215   248.118     0.830     0.235     0.197 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-144" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-36" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-145" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.157     0.045    -0.245    -0.068    -3.458    13.986     0.004     4.055     0.825 
## birth_order                   0.004     0.009    -0.013     0.022     0.461    70.877     0.646     0.554     0.374 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.007     0.012     0.488    17.419     0.632     2.556     0.746 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.925    25.481     0.066     1.465     0.623 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.731    32.618     0.010     1.107     0.552 
## male                          0.016     0.016    -0.016     0.047     0.959    41.846     0.343     0.865     0.488 
## sibling_count                -0.001     0.008    -0.016     0.014    -0.156   204.688     0.876     0.265     0.217 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-145" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-378-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-36" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-146" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.151     0.044    -0.236    -0.065    -3.456    14.177     0.004     3.921     0.820 
## birth_order_nonlinear2        0.002     0.025    -0.047     0.051     0.080    21.014     0.937     1.894     0.683 
## birth_order_nonlinear3       -0.007     0.027    -0.061     0.047    -0.248    38.809     0.805     0.929     0.506 
## birth_order_nonlinear4        0.031     0.034    -0.036     0.097     0.909    71.270     0.366     0.551     0.373 
## birth_order_nonlinear5        0.014     0.052    -0.088     0.115     0.262    49.145     0.794     0.748     0.450 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.007     0.012     0.477    17.546     0.639     2.523     0.744 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.957    26.120     0.061     1.421     0.615 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.783    34.187     0.009     1.054     0.539 
## male                          0.016     0.016    -0.016     0.048     0.969    42.282     0.338     0.857     0.485 
## sibling_count                -0.001     0.008    -0.016     0.014    -0.144   191.734     0.886     0.277     0.225 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-146" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-380-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-36" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-147" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.139     0.050    -0.236    -0.042    -2.800    18.820     0.012     2.242     0.720 
## count_birth_order2/2         -0.011     0.035    -0.081     0.058    -0.316    25.555     0.754     1.460     0.622 
## count_birth_order1/3         -0.012     0.032    -0.075     0.050    -0.387   116.944     0.700     0.384     0.289 
## count_birth_order2/3          0.007     0.039    -0.069     0.083     0.182    34.941     0.857     1.031     0.533 
## count_birth_order3/3         -0.018     0.031    -0.078     0.043    -0.577   128.760     0.565     0.359     0.276 
## count_birth_order1/4          0.001     0.040    -0.077     0.079     0.024   136.206     0.981     0.346     0.268 
## count_birth_order2/4          0.022     0.038    -0.053     0.097     0.571   234.793     0.569     0.243     0.203 
## count_birth_order3/4          0.011     0.050    -0.087     0.108     0.215    29.243     0.831     1.246     0.582 
## count_birth_order4/4          0.039     0.043    -0.045     0.123     0.912    45.612     0.367     0.799     0.467 
## count_birth_order1/5          0.007     0.057    -0.104     0.119     0.126    49.000     0.900     0.750     0.451 
## count_birth_order2/5         -0.015     0.053    -0.118     0.088    -0.281    94.545     0.780     0.446     0.323 
## count_birth_order3/5         -0.026     0.049    -0.122     0.070    -0.533   110.402     0.595     0.400     0.298 
## count_birth_order4/5          0.004     0.064    -0.122     0.130     0.065    25.440     0.949     1.468     0.623 
## count_birth_order5/5          0.005     0.046    -0.085     0.096     0.118    81.377     0.906     0.498     0.348 
## poly(age, 3, raw = TRUE)1     0.000     0.006    -0.012     0.013     0.071    17.267     0.944     2.597     0.749 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.547    22.658     0.136     1.705     0.659 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.860    27.068     0.074     1.362     0.605 
## male                          0.020     0.017    -0.014     0.053     1.153    55.072     0.254     0.679     0.425 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.086 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-147" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-382-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-36" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1646.077        8  803.314    0.000    0.084 
##   2 vs 3:    4.710        3   56.688    0.005    0.510 
##   3 vs 4:    1.103        1   21.835    0.305    1.793 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-18" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-37" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-148" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.152     0.038    -0.228    -0.077    -3.958    14.615     0.001     3.645     0.809 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.007     0.011     0.519    16.878     0.610     2.707     0.757 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.093    27.511     0.046     1.336     0.600 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.971    37.855     0.005     0.952     0.513 
## male                          0.012     0.015    -0.017     0.042     0.830    39.159     0.412     0.921     0.504 
## sibling_count                 0.002     0.006    -0.011     0.014     0.286    62.901     0.776     0.608     0.397 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.081 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-148" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-385-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-37" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-149" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.155     0.042    -0.237    -0.073    -3.708    14.022     0.002     4.029     0.825 
## birth_order                   0.004     0.009    -0.014     0.023     0.451    30.237     0.655     1.201     0.573 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.007     0.012     0.533    16.534     0.601     2.814     0.765 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.086    27.485     0.046     1.338     0.600 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.991    38.713     0.005     0.931     0.507 
## male                          0.012     0.015    -0.018     0.042     0.798    36.994     0.430     0.973     0.519 
## sibling_count                -0.001     0.008    -0.017     0.016    -0.088    43.078     0.930     0.842     0.481 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.081 
## Residual~~Residual                     0.908 
## ICC|mother_pidlink                     0.082 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-149" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-37" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-150" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.150     0.038    -0.224    -0.076    -3.969    15.842     0.001     3.061     0.780 
## birth_order_nonlinear2       -0.001     0.023    -0.047     0.045    -0.057    19.121     0.955     2.185     0.714 
## birth_order_nonlinear3       -0.008     0.021    -0.050     0.034    -0.361   121.704     0.719     0.374     0.284 
## birth_order_nonlinear4        0.006     0.040    -0.073     0.084     0.146    27.442     0.885     1.340     0.601 
## birth_order_nonlinear5        0.065     0.058    -0.048     0.178     1.121    37.761     0.269     0.954     0.513 
## poly(age, 3, raw = TRUE)1     0.002     0.005    -0.007     0.011     0.468    17.809     0.645     2.459     0.739 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.288    33.901     0.029     1.063     0.542 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.226    51.508     0.002     0.718     0.439 
## male                          0.012     0.016    -0.019     0.044     0.784    33.696     0.438     1.070     0.543 
## sibling_count                 0.001     0.008    -0.016     0.017     0.093    45.541     0.926     0.800     0.467 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.082 
## Residual~~Residual                     0.906 
## ICC|mother_pidlink                     0.083 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-150" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-389-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-37" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-151" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.138     0.048    -0.232    -0.044    -2.880    17.535     0.010     2.526     0.744 
## count_birth_order2/2         -0.006     0.028    -0.062     0.049    -0.226    36.550     0.823     0.985     0.522 
## count_birth_order1/3         -0.007     0.035    -0.075     0.061    -0.199    39.688     0.843     0.909     0.501 
## count_birth_order2/3         -0.003     0.031    -0.063     0.057    -0.091    53.052     0.927     0.700     0.433 
## count_birth_order3/3         -0.020     0.033    -0.085     0.044    -0.616    49.241     0.541     0.747     0.449 
## count_birth_order1/4         -0.032     0.043    -0.116     0.052    -0.755    69.919     0.453     0.560     0.376 
## count_birth_order2/4         -0.020     0.038    -0.094     0.054    -0.522    81.344     0.603     0.498     0.348 
## count_birth_order3/4         -0.005     0.043    -0.089     0.080    -0.111    39.725     0.912     0.908     0.501 
## count_birth_order4/4          0.008     0.042    -0.074     0.091     0.198    51.992     0.844     0.713     0.437 
## count_birth_order1/5          0.024     0.058    -0.090     0.138     0.413    72.348     0.681     0.545     0.370 
## count_birth_order2/5          0.013     0.060    -0.105     0.132     0.219    36.693     0.828     0.981     0.521 
## count_birth_order3/5          0.016     0.052    -0.085     0.118     0.315    63.892     0.754     0.601     0.394 
## count_birth_order4/5         -0.005     0.052    -0.107     0.098    -0.087    58.211     0.931     0.648     0.413 
## count_birth_order5/5          0.061     0.058    -0.052     0.174     1.053    46.079     0.298     0.792     0.465 
## poly(age, 3, raw = TRUE)1     0.001     0.005    -0.009     0.011     0.194    20.386     0.848     1.980     0.693 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.245    36.230     0.031     0.994     0.524 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.003    48.801     0.004     0.753     0.451 
## male                          0.014     0.018    -0.021     0.048     0.789    34.639     0.435     1.040     0.536 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.083 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.084 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-151" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-391-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-37" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1383.379        8   32.815    0.000    0.622 
##   2 vs 3:  409.741        3   17.044    0.000    1.606 
##   3 vs 4:   96.648        1   30.003    0.000    1.211 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-18" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
</div>
</div>
<div id="openness" class="section level3 tabset">
<h3>Openness</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = big5_open)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-19" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-38" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-152" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.087     0.034     0.020     0.154     2.531    18.787     0.020     2.248     0.720 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.003    -1.271    24.055     0.216     1.575     0.640 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.805    25.304     0.428     1.478     0.625 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.482    26.574     0.150     1.392     0.610 
## male                          0.015     0.018    -0.021     0.050     0.817    28.249     0.421     1.296     0.592 
## sibling_count                 0.001     0.008    -0.014     0.016     0.113    31.721     0.911     1.140     0.560 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-152" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-395-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-38" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-153" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.099     0.035     0.029     0.168     2.785    19.371     0.012     2.141     0.710 
## birth_order                  -0.014     0.009    -0.031     0.003    -1.602    88.207     0.113     0.469     0.334 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.014     0.002    -1.474    23.400     0.154     1.633     0.649 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.953    24.616     0.350     1.530     0.633 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.583    26.046     0.125     1.426     0.616 
## male                          0.015     0.018    -0.020     0.050     0.834    28.290     0.411     1.294     0.592 
## sibling_count                 0.009     0.009    -0.009     0.028     0.979    37.979     0.334     0.949     0.512 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-153" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-397-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-38" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-154" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.084     0.035     0.016     0.153     2.426    19.220     0.025     2.168     0.713 
## birth_order_nonlinear2       -0.010     0.018    -0.044     0.025    -0.547   100.558     0.586     0.427     0.313 
## birth_order_nonlinear3       -0.041     0.025    -0.090     0.009    -1.598    57.799     0.115     0.652     0.415 
## birth_order_nonlinear4       -0.027     0.038    -0.101     0.047    -0.719    39.789     0.476     0.907     0.500 
## birth_order_nonlinear5       -0.057     0.051    -0.158     0.043    -1.115    49.766     0.270     0.740     0.447 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.014     0.002    -1.474    23.493     0.154     1.624     0.648 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.953    24.741     0.350     1.520     0.632 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.583    26.156     0.125     1.419     0.615 
## male                          0.015     0.018    -0.020     0.050     0.834    28.428     0.411     1.287     0.590 
## sibling_count                 0.009     0.009    -0.009     0.028     0.980    37.531     0.333     0.960     0.515 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.905 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-154" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-399-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-38" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-155" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.113     0.039     0.037     0.189     2.928    36.113     0.006     0.997     0.525 
## count_birth_order2/2         -0.028     0.031    -0.088     0.032    -0.901    42.261     0.373     0.857     0.485 
## count_birth_order1/3         -0.017     0.038    -0.092     0.058    -0.450    35.526     0.655     1.013     0.529 
## count_birth_order2/3         -0.022     0.031    -0.083     0.039    -0.708   140.741     0.480     0.338     0.263 
## count_birth_order3/3         -0.032     0.032    -0.095     0.031    -0.998    83.551     0.321     0.489     0.344 
## count_birth_order1/4         -0.031     0.048    -0.126     0.063    -0.649    36.021     0.521     0.999     0.525 
## count_birth_order2/4          0.008     0.040    -0.071     0.086     0.194   125.577     0.846     0.366     0.279 
## count_birth_order3/4         -0.074     0.051    -0.175     0.026    -1.444    25.929     0.161     1.434     0.618 
## count_birth_order4/4         -0.024     0.043    -0.109     0.060    -0.563    41.912     0.577     0.864     0.487 
## count_birth_order1/5          0.028     0.053    -0.076     0.133     0.528    69.666     0.599     0.561     0.377 
## count_birth_order2/5         -0.030     0.052    -0.133     0.072    -0.581    94.171     0.562     0.447     0.323 
## count_birth_order3/5         -0.040     0.067    -0.172     0.092    -0.595    23.015     0.558     1.669     0.654 
## count_birth_order4/5         -0.027     0.063    -0.149     0.096    -0.425    26.921     0.674     1.371     0.606 
## count_birth_order5/5         -0.048     0.051    -0.148     0.051    -0.954    43.639     0.345     0.832     0.478 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.016     0.005    -1.039    26.015     0.309     1.428     0.617 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.614    29.408     0.544     1.238     0.581 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.923    33.265     0.363     1.084     0.547 
## male                          0.017     0.018    -0.017     0.052     0.986    44.709     0.329     0.814     0.472 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.902 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-155" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-401-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-38" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1710.741        8 1973.355    0.000    0.052 
##   2 vs 3:    3.050        3   22.177    0.050    1.175 
##   3 vs 4:    2.622        1   25.332    0.118    1.476 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-19" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-39" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-156" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.093     0.033     0.028     0.158     2.789    17.699     0.012     2.485     0.741 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.013     0.002    -1.391    21.924     0.178     1.783     0.670 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.941    23.256     0.357     1.646     0.651 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.614    24.799     0.119     1.515     0.631 
## male                          0.021     0.017    -0.012     0.054     1.264    26.678     0.217     1.386     0.609 
## sibling_count                -0.004     0.006    -0.016     0.008    -0.632    87.671     0.529     0.471     0.335 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.907 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-156" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-404-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-39" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-157" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.093     0.034     0.027     0.160     2.748    18.328     0.013     2.342     0.729 
## birth_order                  -0.002     0.009    -0.020     0.016    -0.189    34.278     0.852     1.051     0.539 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.013     0.002    -1.395    21.954     0.177     1.780     0.669 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.945    23.418     0.355     1.631     0.649 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.619    25.043     0.118     1.497     0.628 
## male                          0.021     0.017    -0.012     0.054     1.257    27.082     0.219     1.361     0.605 
## sibling_count                -0.003     0.008    -0.018     0.013    -0.325    59.233     0.747     0.639     0.409 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.907 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-157" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-406-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-39" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-158" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.095     0.033     0.030     0.160     2.872    19.305     0.010     2.153     0.711 
## birth_order_nonlinear2       -0.007     0.018    -0.042     0.028    -0.371    42.401     0.713     0.854     0.484 
## birth_order_nonlinear3       -0.016     0.027    -0.069     0.037    -0.591    29.931     0.559     1.214     0.576 
## birth_order_nonlinear4       -0.003     0.032    -0.066     0.060    -0.093    76.353     0.926     0.523     0.360 
## birth_order_nonlinear5       -0.015     0.058    -0.129     0.099    -0.258    36.499     0.798     0.986     0.522 
## poly(age, 3, raw = TRUE)1    -0.006     0.004    -0.014     0.002    -1.394    21.900     0.177     1.786     0.670 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.941    22.185     0.357     1.754     0.666 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.546    22.521     0.136     1.719     0.661 
## male                          0.020     0.016    -0.013     0.052     1.187    29.625     0.245     1.228     0.579 
## sibling_count                -0.002     0.008    -0.018     0.014    -0.242    50.135     0.810     0.735     0.445 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.906 
## ICC|mother_pidlink                     0.079 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-158" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-408-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-39" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-159" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.099     0.039     0.022     0.175     2.513    26.836     0.018     1.376     0.607 
## count_birth_order2/2         -0.019     0.028    -0.074     0.036    -0.678    37.080     0.502     0.971     0.518 
## count_birth_order1/3         -0.012     0.043    -0.096     0.072    -0.275    20.721     0.786     1.933     0.688 
## count_birth_order2/3         -0.030     0.031    -0.092     0.031    -0.962    45.544     0.341     0.800     0.467 
## count_birth_order3/3         -0.023     0.030    -0.081     0.035    -0.776   101.674     0.440     0.424     0.311 
## count_birth_order1/4         -0.011     0.047    -0.103     0.082    -0.224    39.570     0.824     0.912     0.501 
## count_birth_order2/4         -0.015     0.042    -0.098     0.068    -0.350    41.265     0.728     0.876     0.491 
## count_birth_order3/4         -0.042     0.052    -0.145     0.060    -0.806    21.472     0.429     1.836     0.676 
## count_birth_order4/4         -0.006     0.043    -0.091     0.078    -0.142    45.886     0.888     0.795     0.466 
## count_birth_order1/5         -0.078     0.055    -0.185     0.030    -1.419   115.748     0.158     0.387     0.291 
## count_birth_order2/5         -0.039     0.057    -0.151     0.073    -0.685    46.962     0.496     0.779     0.460 
## count_birth_order3/5         -0.079     0.051    -0.179     0.020    -1.563    73.392     0.122     0.539     0.367 
## count_birth_order4/5         -0.051     0.055    -0.158     0.057    -0.921    43.828     0.362     0.829     0.477 
## count_birth_order5/5         -0.047     0.057    -0.160     0.065    -0.819    46.591     0.417     0.784     0.462 
## poly(age, 3, raw = TRUE)1    -0.005     0.005    -0.014     0.004    -1.185    26.423     0.247     1.402     0.612 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.883    24.068     0.386     1.574     0.640 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.417    23.336     0.170     1.639     0.650 
## male                          0.021     0.016    -0.010     0.053     1.331    52.228     0.189     0.710     0.436 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.904 
## ICC|mother_pidlink                     0.080 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-159" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-410-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-39" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1154.581        8   20.467    0.000    0.943 
##   2 vs 3:  342.055        3   13.906    0.000    2.147 
##   3 vs 4:  110.658        1   37.692    0.000    0.956 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-19" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-412-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="riskpreference" class="section level2 tabset">
<h2>Riskpreference</h2>
<div id="risk-a" class="section level3 tabset">
<h3>Risk A</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskA)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-20" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-40" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-160" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.037     0.092     0.238     4.437    16.495     0.000     2.826     0.765 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.920    25.582     0.366     1.458     0.622 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.110    29.745     0.913     1.223     0.578 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.727    36.433     0.472     0.988     0.523 
## male                         -0.199     0.022    -0.243    -0.156    -8.981    17.677     0.000     2.491     0.741 
## sibling_count                -0.003     0.008    -0.018     0.012    -0.395    28.560     0.696     1.280     0.589 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-160" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-414-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-40" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-161" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.035     0.096     0.234     4.687    19.579     0.000     2.106     0.707 
## birth_order                  -0.000     0.010    -0.021     0.020    -0.003    32.529     0.998     1.110     0.553 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.937    28.836     0.356     1.266     0.586 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.113    31.865     0.911     1.134     0.558 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.733    38.193     0.468     0.943     0.510 
## male                         -0.199     0.022    -0.243    -0.156    -8.959    17.611     0.000     2.507     0.743 
## sibling_count                -0.003     0.010    -0.023     0.017    -0.298    27.308     0.768     1.348     0.602 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-161" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-416-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-40" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-162" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.037     0.092     0.237     4.460    17.347     0.000     2.575     0.748 
## birth_order_nonlinear2        0.002     0.019    -0.036     0.040     0.094    54.356     0.926     0.686     0.428 
## birth_order_nonlinear3       -0.003     0.028    -0.057     0.052    -0.093    37.065     0.927     0.971     0.518 
## birth_order_nonlinear4       -0.012     0.035    -0.080     0.056    -0.339    62.808     0.736     0.609     0.397 
## birth_order_nonlinear5        0.020     0.051    -0.080     0.121     0.397    50.979     0.693     0.725     0.442 
## poly(age, 3, raw = TRUE)1    -0.004     0.004    -0.011     0.004    -0.940    28.941     0.355     1.261     0.585 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.111    31.945     0.912     1.131     0.558 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.732    38.304     0.469     0.941     0.510 
## male                         -0.199     0.022    -0.243    -0.156    -8.938    17.546     0.000     2.523     0.744 
## sibling_count                -0.003     0.010    -0.023     0.017    -0.280    27.290     0.781     1.349     0.602 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-162" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-418-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-40" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-163" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.159     0.036     0.088     0.231     4.369    46.199     0.000     0.790     0.464 
## count_birth_order2/2         -0.000     0.035    -0.069     0.069    -0.004    26.137     0.996     1.420     0.615 
## count_birth_order1/3         -0.013     0.035    -0.081     0.055    -0.376    59.038     0.709     0.641     0.410 
## count_birth_order2/3          0.005     0.032    -0.057     0.068     0.170   113.895     0.865     0.391     0.293 
## count_birth_order3/3          0.005     0.037    -0.067     0.077     0.145    38.111     0.886     0.945     0.511 
## count_birth_order1/4          0.037     0.047    -0.055     0.129     0.786    40.532     0.436     0.891     0.496 
## count_birth_order2/4         -0.004     0.045    -0.091     0.084    -0.085    52.288     0.932     0.709     0.436 
## count_birth_order3/4         -0.021     0.045    -0.109     0.067    -0.465    40.977     0.644     0.882     0.493 
## count_birth_order4/4          0.006     0.044    -0.080     0.092     0.136    40.327     0.892     0.895     0.497 
## count_birth_order1/5         -0.012     0.049    -0.109     0.084    -0.253   145.161     0.800     0.332     0.259 
## count_birth_order2/5          0.018     0.051    -0.081     0.117     0.357   130.071     0.722     0.357     0.274 
## count_birth_order3/5         -0.010     0.051    -0.110     0.091    -0.190    71.868     0.850     0.548     0.371 
## count_birth_order4/5         -0.056     0.051    -0.156     0.043    -1.113    71.248     0.270     0.551     0.373 
## count_birth_order5/5          0.012     0.047    -0.081     0.105     0.261    64.508     0.795     0.596     0.392 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.012     0.005    -0.762    57.385     0.449     0.656     0.416 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.278    64.646     0.782     0.595     0.392 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.713    79.249     0.478     0.508     0.353 
## male                         -0.198     0.023    -0.244    -0.153    -8.572    19.572     0.000     2.107     0.707 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.064 
## Residual~~Residual                     0.917 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-163" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-420-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-40" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1646.737        8  676.932    0.000    0.092 
##   2 vs 3:    3.731        3   37.423    0.019    0.712 
##   3 vs 4:    0.790        1   19.803    0.385    2.069 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-20" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-41" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-164" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.160     0.029     0.103     0.218     5.448    22.165     0.000     1.756     0.666 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.010     0.005    -0.677    22.724     0.506     1.698     0.658 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.526    25.534     0.604     1.461     0.622 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.211    31.267     0.235     1.158     0.564 
## male                         -0.202     0.021    -0.243    -0.160    -9.585    16.718     0.000     2.755     0.761 
## sibling_count                -0.001     0.007    -0.015     0.013    -0.115    34.369     0.909     1.048     0.538 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.065 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-164" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-423-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-41" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-165" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.031     0.105     0.225     5.393    22.445     0.000     1.727     0.662 
## birth_order                  -0.005     0.009    -0.022     0.012    -0.606    44.682     0.548     0.814     0.472 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.011     0.005    -0.732    22.346     0.472     1.737     0.663 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.478    25.258     0.637     1.481     0.625 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.171    30.984     0.251     1.169     0.566 
## male                         -0.202     0.021    -0.243    -0.161    -9.683    16.986     0.000     2.675     0.755 
## sibling_count                 0.002     0.008    -0.014     0.018     0.245    50.908     0.808     0.726     0.442 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.920 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-165" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-425-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-41" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-166" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.162     0.029     0.106     0.218     5.652    27.089     0.000     1.361     0.605 
## birth_order_nonlinear2       -0.006     0.019    -0.043     0.032    -0.307    32.453     0.761     1.112     0.553 
## birth_order_nonlinear3       -0.009     0.023    -0.055     0.037    -0.365    57.477     0.716     0.655     0.416 
## birth_order_nonlinear4       -0.005     0.039    -0.081     0.071    -0.132    30.491     0.896     1.190     0.571 
## birth_order_nonlinear5        0.001     0.054    -0.105     0.107     0.022    51.436     0.982     0.719     0.440 
## poly(age, 3, raw = TRUE)1    -0.003     0.004    -0.011     0.005    -0.743    22.779     0.465     1.692     0.657 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.461    24.744     0.649     1.520     0.632 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.135    29.302     0.266     1.243     0.582 
## male                         -0.202     0.020    -0.242    -0.162    -9.973    18.226     0.000     2.364     0.731 
## sibling_count                 0.001     0.009    -0.017     0.018     0.072    36.689     0.943     0.981     0.521 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-166" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-427-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-41" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-167" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.179     0.033     0.115     0.243     5.455    55.366     0.000     0.676     0.424 
## count_birth_order2/2         -0.017     0.030    -0.075     0.042    -0.552    30.124     0.585     1.206     0.574 
## count_birth_order1/3         -0.014     0.040    -0.093     0.065    -0.353    24.130     0.727     1.569     0.639 
## count_birth_order2/3         -0.003     0.041    -0.083     0.077    -0.076    20.038     0.940     2.032     0.699 
## count_birth_order3/3         -0.017     0.034    -0.084     0.050    -0.483    40.469     0.632     0.892     0.496 
## count_birth_order1/4          0.020     0.042    -0.061     0.102     0.482    85.099     0.631     0.482     0.341 
## count_birth_order2/4          0.024     0.042    -0.058     0.105     0.567    44.576     0.574     0.816     0.472 
## count_birth_order3/4         -0.014     0.049    -0.110     0.083    -0.278    25.019     0.783     1.499     0.628 
## count_birth_order4/4         -0.017     0.058    -0.130     0.097    -0.285    18.761     0.779     2.253     0.721 
## count_birth_order1/5         -0.002     0.068    -0.136     0.132    -0.027    31.458     0.979     1.150     0.562 
## count_birth_order2/5         -0.006     0.057    -0.118     0.106    -0.103    46.144     0.918     0.791     0.464 
## count_birth_order3/5          0.022     0.070    -0.114     0.159     0.320    20.931     0.752     1.905     0.685 
## count_birth_order4/5          0.025     0.049    -0.072     0.121     0.500    89.747     0.618     0.463     0.331 
## count_birth_order5/5         -0.005     0.056    -0.114     0.104    -0.087    55.313     0.931     0.676     0.424 
## poly(age, 3, raw = TRUE)1    -0.005     0.004    -0.013     0.003    -1.238    47.251     0.222     0.774     0.459 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.154    45.144     0.878     0.807     0.469 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.860    40.791     0.395     0.886     0.494 
## male                         -0.201     0.022    -0.244    -0.157    -9.080    19.015     0.000     2.205     0.716 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.919 
## ICC|mother_pidlink                     0.064 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-167" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-429-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-41" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1520.040        8   46.606    0.000    0.474 
##   2 vs 3:  413.405        3   17.304    0.000    1.575 
##   3 vs 4:   99.072        1   31.651    0.000    1.142 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-20" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-431-1.png" width="672" /></p>
</div>
</div>
<div id="risk-b" class="section level3 tabset">
<h3>Risk B</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = riskB)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-21" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-42" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-168" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.010     0.032    -0.073     0.053    -0.302    21.623     0.765     1.818     0.674 
## poly(age, 3, raw = TRUE)1     0.003     0.003    -0.003     0.010     0.925    50.108     0.359     0.736     0.446 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.352   174.911     0.725     0.293     0.236 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.320   318.014     0.749     0.202     0.173 
## male                         -0.067     0.017    -0.101    -0.033    -3.841    32.381     0.001     1.115     0.554 
## sibling_count                -0.003     0.007    -0.016     0.010    -0.428    53.219     0.671     0.698     0.432 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.930 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-168" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-433-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-42" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-169" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.009     0.031    -0.071     0.052    -0.303    26.233     0.764     1.414     0.614 
## birth_order                  -0.000     0.009    -0.017     0.017    -0.028    96.258     0.977     0.440     0.320 
## poly(age, 3, raw = TRUE)1     0.003     0.003    -0.003     0.009     0.939    64.425     0.351     0.597     0.392 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.348   208.084     0.728     0.263     0.215 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.316   350.757     0.752     0.191     0.165 
## male                         -0.067     0.017    -0.101    -0.033    -3.844    32.497     0.001     1.111     0.553 
## sibling_count                -0.003     0.008    -0.019     0.014    -0.332    79.093     0.741     0.509     0.353 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.930 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-169" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-435-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-42" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-170" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.014     0.032    -0.077     0.049    -0.421    22.966     0.677     1.674     0.655 
## birth_order_nonlinear2        0.009     0.018    -0.027     0.045     0.482    77.710     0.631     0.516     0.357 
## birth_order_nonlinear3        0.011     0.024    -0.037     0.058     0.436    83.415     0.664     0.489     0.344 
## birth_order_nonlinear4       -0.008     0.033    -0.073     0.057    -0.235    92.591     0.815     0.453     0.326 
## birth_order_nonlinear5       -0.011     0.047    -0.104     0.081    -0.241   101.972     0.810     0.423     0.310 
## poly(age, 3, raw = TRUE)1     0.003     0.003    -0.003     0.009     0.976    69.032     0.332     0.565     0.379 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.386   246.634     0.700     0.236     0.198 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.362   448.542     0.717     0.165     0.145 
## male                         -0.067     0.017    -0.101    -0.033    -3.851    32.428     0.001     1.113     0.554 
## sibling_count                -0.003     0.008    -0.019     0.014    -0.333    75.172     0.740     0.529     0.363 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.930 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-170" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-437-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-42" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-171" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.008     0.040    -0.086     0.070    -0.192    33.078     0.849     1.090     0.548 
## count_birth_order2/2          0.009     0.026    -0.043     0.061     0.340   142.938     0.734     0.335     0.261 
## count_birth_order1/3         -0.004     0.039    -0.081     0.073    -0.102    33.643     0.920     1.071     0.544 
## count_birth_order2/3          0.013     0.038    -0.061     0.086     0.336    39.990     0.739     0.903     0.499 
## count_birth_order3/3          0.008     0.039    -0.068     0.083     0.199    32.377     0.844     1.115     0.554 
## count_birth_order1/4          0.019     0.043    -0.066     0.104     0.435    66.837     0.665     0.580     0.385 
## count_birth_order2/4          0.003     0.047    -0.090     0.095     0.054    41.862     0.957     0.865     0.488 
## count_birth_order3/4         -0.007     0.041    -0.087     0.073    -0.172    81.548     0.864     0.497     0.348 
## count_birth_order4/4         -0.015     0.041    -0.095     0.064    -0.373    62.968     0.710     0.608     0.397 
## count_birth_order1/5         -0.008     0.053    -0.111     0.095    -0.147    83.150     0.883     0.490     0.345 
## count_birth_order2/5         -0.004     0.053    -0.108     0.099    -0.082    93.437     0.935     0.450     0.325 
## count_birth_order3/5          0.030     0.057    -0.082     0.142     0.523    40.988     0.604     0.882     0.493 
## count_birth_order4/5         -0.010     0.055    -0.117     0.097    -0.182    46.454     0.856     0.786     0.463 
## count_birth_order5/5         -0.018     0.051    -0.117     0.081    -0.358    46.386     0.722     0.787     0.463 
## poly(age, 3, raw = TRUE)1     0.000     0.004    -0.008     0.009     0.111    49.547     0.912     0.743     0.448 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.491    59.547     0.625     0.636     0.408 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.668    59.848     0.507     0.633     0.407 
## male                         -0.067     0.020    -0.106    -0.028    -3.372    29.076     0.002     1.254     0.584 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.066 
## Residual~~Residual                     0.933 
## ICC|mother_pidlink                     0.066 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-171" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-439-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-42" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1474.138        8  155.269    0.000    0.214 
##   2 vs 3:    2.517        3   19.245    0.089    1.381 
##   3 vs 4:    0.610        1   24.783    0.442    1.516 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-21" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-43" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-172" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.008     0.034    -0.075     0.059    -0.224    17.072     0.826     2.651     0.753 
## poly(age, 3, raw = TRUE)1     0.003     0.003    -0.004     0.009     0.855    37.166     0.398     0.969     0.517 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.330   119.140     0.742     0.379     0.287 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.340   200.565     0.734     0.269     0.220 
## male                         -0.071     0.017    -0.105    -0.037    -4.143    25.593     0.000     1.457     0.621 
## sibling_count                -0.003     0.008    -0.019     0.014    -0.304    21.458     0.764     1.838     0.676 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.062 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.062 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-172" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-442-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-43" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-173" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.000     0.032    -0.063     0.063     0.002    20.634     0.999     1.945     0.689 
## birth_order                  -0.008     0.008    -0.024     0.008    -1.018    61.160     0.313     0.622     0.403 
## poly(age, 3, raw = TRUE)1     0.003     0.003    -0.004     0.009     0.770    39.566     0.446     0.912     0.502 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.288   113.210     0.774     0.393     0.294 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.324   183.086     0.747     0.285     0.230 
## male                         -0.071     0.017    -0.105    -0.038    -4.138    25.398     0.000     1.471     0.624 
## sibling_count                 0.002     0.010    -0.018     0.022     0.165    21.446     0.871     1.839     0.677 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.062 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.062 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-173" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-444-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-43" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-174" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.008     0.034    -0.074     0.058    -0.233    19.061     0.818     2.196     0.716 
## birth_order_nonlinear2       -0.010     0.017    -0.043     0.023    -0.572    62.349     0.570     0.613     0.399 
## birth_order_nonlinear3       -0.019     0.025    -0.067     0.030    -0.752    45.247     0.456     0.805     0.469 
## birth_order_nonlinear4       -0.033     0.036    -0.104     0.037    -0.931    43.865     0.357     0.828     0.476 
## birth_order_nonlinear5       -0.028     0.060    -0.146     0.090    -0.471    33.230     0.641     1.085     0.547 
## poly(age, 3, raw = TRUE)1     0.002     0.003    -0.004     0.009     0.720    36.801     0.476     0.978     0.520 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.242    86.658     0.810     0.476     0.337 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.284   131.038     0.777     0.355     0.273 
## male                         -0.070     0.018    -0.105    -0.036    -3.986    25.003     0.001     1.500     0.629 
## sibling_count                 0.002     0.010    -0.017     0.021     0.200    25.421     0.843     1.469     0.624 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.062 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.062 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-174" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-446-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-43" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-175" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.012     0.038    -0.062     0.086     0.319    31.118     0.752     1.164     0.565 
## count_birth_order2/2         -0.010     0.025    -0.059     0.039    -0.391    79.117     0.697     0.509     0.353 
## count_birth_order1/3         -0.012     0.038    -0.086     0.062    -0.319    29.718     0.752     1.224     0.578 
## count_birth_order2/3         -0.026     0.030    -0.085     0.033    -0.856    61.000     0.396     0.624     0.403 
## count_birth_order3/3         -0.024     0.030    -0.083     0.035    -0.792    89.860     0.430     0.463     0.331 
## count_birth_order1/4          0.013     0.043    -0.071     0.097     0.308    74.183     0.759     0.534     0.365 
## count_birth_order2/4          0.001     0.049    -0.094     0.097     0.030    25.863     0.976     1.438     0.618 
## count_birth_order3/4         -0.035     0.045    -0.124     0.054    -0.776    33.023     0.443     1.092     0.549 
## count_birth_order4/4         -0.053     0.043    -0.137     0.032    -1.224    48.698     0.227     0.754     0.452 
## count_birth_order1/5          0.010     0.082    -0.149     0.170     0.128    20.154     0.899     2.014     0.697 
## count_birth_order2/5         -0.003     0.059    -0.118     0.112    -0.051    42.856     0.959     0.846     0.482 
## count_birth_order3/5          0.014     0.055    -0.094     0.121     0.249    48.170     0.804     0.761     0.454 
## count_birth_order4/5         -0.002     0.060    -0.119     0.115    -0.034    32.250     0.973     1.120     0.555 
## count_birth_order5/5         -0.026     0.054    -0.133     0.081    -0.479    67.166     0.634     0.577     0.384 
## poly(age, 3, raw = TRUE)1     0.001     0.004    -0.007     0.010     0.296    32.420     0.769     1.114     0.554 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.044    33.750     0.966     1.068     0.543 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.003    32.906     0.998     1.096     0.550 
## male                         -0.073     0.018    -0.109    -0.037    -3.961    30.310     0.000     1.197     0.572 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.063 
## Residual~~Residual                     0.937 
## ICC|mother_pidlink                     0.063 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-175" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-448-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-43" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1323.092        8   28.490    0.000    0.699 
##   2 vs 3:  379.160        3   15.682    0.000    1.797 
##   3 vs 4:   88.434        1   26.628    0.000    1.389 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-21" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-450-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="educational-attainment" class="section level2 tabset">
<h2>Educational Attainment</h2>
<div id="years-of-education---z-standardized" class="section level3 tabset">
<h3>Years of Education - z-standardized</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = years_of_education_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-22" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-44" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-176" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.194     0.031     0.133     0.254     6.282    24.602     0.000     1.531     0.633 
## poly(age, 3, raw = TRUE)1    -0.012     0.004    -0.020    -0.005    -3.298    26.546     0.003     1.394     0.611 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.726    33.258     0.010     1.084     0.547 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.239    35.215     0.000     1.022     0.531 
## male                         -0.005     0.013    -0.031     0.021    -0.393    83.906     0.695     0.487     0.343 
## sibling_count                 0.016     0.008     0.001     0.031     2.075    46.076     0.044     0.792     0.465 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.367 
## Residual~~Residual                     0.591 
## ICC|mother_pidlink                     0.383 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-176" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-452-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-44" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-177" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.194     0.031     0.134     0.255     6.287    28.140     0.000     1.302     0.593 
## birth_order                  -0.001     0.009    -0.018     0.017    -0.068    31.624     0.946     1.143     0.560 
## poly(age, 3, raw = TRUE)1    -0.012     0.004    -0.020    -0.005    -3.363    30.227     0.002     1.201     0.573 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.714    33.413     0.010     1.079     0.545 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.186    34.248     0.000     1.052     0.539 
## male                         -0.005     0.013    -0.031     0.021    -0.391    83.614     0.696     0.488     0.344 
## sibling_count                 0.017     0.008     0.001     0.032     2.036   127.042     0.044     0.363     0.277 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.367 
## Residual~~Residual                     0.591 
## ICC|mother_pidlink                     0.383 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-177" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-454-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-44" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-178" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.196     0.031     0.135     0.257     6.308    25.098     0.000     1.493     0.627 
## birth_order_nonlinear2       -0.007     0.018    -0.042     0.029    -0.377    34.237     0.709     1.052     0.539 
## birth_order_nonlinear3       -0.008     0.022    -0.051     0.035    -0.360    54.412     0.720     0.685     0.427 
## birth_order_nonlinear4       -0.014     0.030    -0.072     0.044    -0.474    59.465     0.637     0.637     0.409 
## birth_order_nonlinear5        0.030     0.053    -0.073     0.134     0.572    24.553     0.572     1.534     0.634 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.020    -0.005    -3.378    30.034     0.002     1.210     0.575 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.735    33.132     0.010     1.089     0.548 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.193    33.782     0.000     1.067     0.542 
## male                         -0.005     0.013    -0.031     0.021    -0.397    83.280     0.692     0.490     0.344 
## sibling_count                 0.017     0.008     0.001     0.033     2.069   122.752     0.041     0.371     0.282 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.367 
## Residual~~Residual                     0.591 
## ICC|mother_pidlink                     0.383 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-178" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-456-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-44" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-179" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.218     0.034     0.151     0.285     6.398    60.163     0.000     0.631     0.406 
## count_birth_order2/2          0.010     0.022    -0.034     0.053     0.440   105.224     0.661     0.413     0.306 
## count_birth_order1/3          0.029     0.030    -0.031     0.088     0.949   128.580     0.345     0.360     0.276 
## count_birth_order2/3          0.001     0.032    -0.062     0.065     0.045    70.132     0.964     0.558     0.376 
## count_birth_order3/3          0.034     0.031    -0.027     0.095     1.102    82.940     0.274     0.491     0.345 
## count_birth_order1/4          0.009     0.041    -0.072     0.090     0.215    62.460     0.831     0.612     0.399 
## count_birth_order2/4         -0.001     0.047    -0.093     0.090    -0.032    33.979     0.975     1.060     0.541 
## count_birth_order3/4          0.002     0.047    -0.089     0.094     0.053    29.605     0.958     1.229     0.579 
## count_birth_order4/4          0.028     0.043    -0.057     0.113     0.654    35.165     0.517     1.024     0.532 
## count_birth_order1/5          0.019     0.045    -0.070     0.107     0.410   208.626     0.682     0.262     0.215 
## count_birth_order2/5          0.001     0.046    -0.089     0.092     0.027   182.445     0.979     0.286     0.230 
## count_birth_order3/5         -0.012     0.044    -0.099     0.074    -0.281   174.734     0.779     0.294     0.236 
## count_birth_order4/5         -0.002     0.043    -0.087     0.083    -0.046   194.423     0.964     0.274     0.223 
## count_birth_order5/5          0.071     0.054    -0.035     0.177     1.306    28.562     0.202     1.280     0.589 
## poly(age, 3, raw = TRUE)1    -0.018     0.004    -0.026    -0.009    -3.975    41.017     0.000     0.881     0.493 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     4.537    48.387     0.000     0.758     0.453 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.631    60.831     0.000     0.625     0.404 
## male                         -0.020     0.015    -0.050     0.010    -1.320    52.226     0.193     0.710     0.436 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.350 
## Residual~~Residual                     0.584 
## ICC|mother_pidlink                     0.375 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-179" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-458-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-44" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1617.223        8  351.648    0.000    0.133 
##   2 vs 3:    4.725        3   50.644    0.006    0.556 
##   3 vs 4:    1.623        1   42.706    0.210    0.849 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-22" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-45" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-180" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.232     0.030     0.173     0.292     7.686    21.407     0.000     1.844     0.677 
## poly(age, 3, raw = TRUE)1    -0.013     0.004    -0.020    -0.006    -3.531    24.309     0.002     1.554     0.637 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     3.267    30.833     0.003     1.175     0.567 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.026    33.767     0.000     1.067     0.543 
## male                         -0.016     0.012    -0.038     0.007    -1.367   106.042     0.174     0.411     0.304 
## sibling_count                -0.002     0.007    -0.016     0.011    -0.353    74.180     0.725     0.534     0.365 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.376 
## Residual~~Residual                     0.579 
## ICC|mother_pidlink                     0.394 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-180" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-461-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-45" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-181" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.218     0.030     0.159     0.276     7.280    24.621     0.000     1.529     0.633 
## birth_order                   0.013     0.008    -0.003     0.030     1.594    26.575     0.123     1.392     0.610 
## poly(age, 3, raw = TRUE)1    -0.012     0.004    -0.019    -0.005    -3.361    26.139     0.002     1.420     0.615 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     3.184    31.435     0.003     1.151     0.562 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.004    34.211     0.000     1.053     0.539 
## male                         -0.016     0.012    -0.039     0.007    -1.336    96.598     0.185     0.439     0.319 
## sibling_count                -0.010     0.008    -0.025     0.005    -1.280    94.723     0.204     0.446     0.322 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.376 
## Residual~~Residual                     0.580 
## ICC|mother_pidlink                     0.393 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-181" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-463-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-45" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-182" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.245     0.030     0.186     0.304     8.155    23.626     0.000     1.612     0.646 
## birth_order_nonlinear2       -0.009     0.015    -0.038     0.019    -0.631    57.952     0.531     0.650     0.414 
## birth_order_nonlinear3        0.020     0.024    -0.026     0.066     0.844    28.023     0.406     1.308     0.595 
## birth_order_nonlinear4        0.024     0.028    -0.030     0.078     0.864    74.247     0.390     0.534     0.365 
## birth_order_nonlinear5        0.024     0.056    -0.086     0.134     0.430    25.298     0.671     1.478     0.625 
## poly(age, 3, raw = TRUE)1    -0.014     0.003    -0.020    -0.007    -3.921    30.918     0.000     1.172     0.567 
## poly(age, 3, raw = TRUE)2     0.001     0.000     0.000     0.001     3.902    39.104     0.000     0.922     0.504 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -6.763    42.087     0.000     0.860     0.486 
## male                         -0.018     0.012    -0.042     0.005    -1.569   106.405     0.120     0.410     0.304 
## sibling_count                -0.009     0.008    -0.024     0.007    -1.091    92.184     0.278     0.454     0.327 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.372 
## Residual~~Residual                     0.578 
## ICC|mother_pidlink                     0.392 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-182" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-465-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-45" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-183" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.178     0.038     0.103     0.253     4.656    28.697     0.000     1.273     0.588 
## count_birth_order2/2          0.023     0.026    -0.027     0.073     0.900    30.413     0.375     1.193     0.571 
## count_birth_order1/3          0.041     0.040    -0.037     0.119     1.038    21.446     0.311     1.839     0.677 
## count_birth_order2/3          0.001     0.032    -0.062     0.064     0.036    32.456     0.972     1.112     0.553 
## count_birth_order3/3          0.062     0.037    -0.010     0.134     1.684    25.603     0.104     1.456     0.621 
## count_birth_order1/4          0.008     0.043    -0.076     0.093     0.194    43.351     0.847     0.837     0.479 
## count_birth_order2/4         -0.027     0.045    -0.114     0.060    -0.607    27.435     0.549     1.341     0.601 
## count_birth_order3/4          0.001     0.034    -0.066     0.067     0.018   137.507     0.985     0.344     0.266 
## count_birth_order4/4          0.037     0.043    -0.047     0.121     0.869    35.066     0.391     1.027     0.533 
## count_birth_order1/5         -0.081     0.057    -0.192     0.030    -1.430    48.615     0.159     0.755     0.452 
## count_birth_order2/5         -0.101     0.048    -0.194    -0.007    -2.107    95.005     0.038     0.445     0.322 
## count_birth_order3/5         -0.070     0.047    -0.162     0.023    -1.478    76.457     0.143     0.522     0.360 
## count_birth_order4/5         -0.053     0.056    -0.162     0.056    -0.948    31.709     0.350     1.140     0.560 
## count_birth_order5/5         -0.012     0.056    -0.122     0.098    -0.213    37.776     0.832     0.954     0.513 
## poly(age, 3, raw = TRUE)1    -0.011     0.005    -0.019    -0.002    -2.331    25.134     0.028     1.490     0.627 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.001     2.792    25.394     0.010     1.471     0.624 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -5.203    26.467     0.000     1.399     0.611 
## male                         -0.029     0.014    -0.056    -0.001    -2.067    62.767     0.043     0.609     0.398 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.371 
## Residual~~Residual                     0.576 
## ICC|mother_pidlink                     0.391 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-183" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-467-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-45" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 821.280       8  12.405   0.000   1.656 
##  2 vs 3: 368.866       3  15.514   0.000   1.824 
##  3 vs 4:  72.416       1  25.317   0.000   1.477 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-22" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-469-1.png" width="672" /></p>
</div>
</div>
<div id="elementary_missed" class="section level3">
<h3>elementary_missed</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_missed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-23" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-46" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-184" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.014     0.009    -0.004     0.032     1.505    12.322     0.158     5.879     0.874 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.527    28.724     0.602     1.271     0.588 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.154    35.762     0.878     1.007     0.527 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.314    27.532     0.756     1.335     0.600 
## male                          0.001     0.003    -0.005     0.008     0.447    29.029     0.658     1.256     0.584 
## sibling_count                 0.002     0.002    -0.001     0.005     1.244    24.116     0.226     1.570     0.640 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-184" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-471-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-46" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-185" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.015     0.010    -0.005     0.035     1.475    11.984     0.166     6.497     0.884 
## birth_order                  -0.001     0.002    -0.006     0.003    -0.491    17.753     0.630     2.472     0.740 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.398    31.722     0.693     1.140     0.560 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.066    40.417     0.948     0.894     0.496 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.261    29.838     0.796     1.218     0.577 
## male                          0.001     0.003    -0.005     0.008     0.455    29.436     0.652     1.237     0.581 
## sibling_count                 0.003     0.001    -0.000     0.006     1.808   111.497     0.073     0.397     0.297 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.163 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-185" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-473-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-46" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-186" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.014     0.009    -0.005     0.032     1.467    12.418     0.167     5.725     0.871 
## birth_order_nonlinear2       -0.000     0.003    -0.007     0.006    -0.134    44.957     0.894     0.810     0.470 
## birth_order_nonlinear3       -0.004     0.006    -0.016     0.009    -0.562    17.836     0.581     2.452     0.738 
## birth_order_nonlinear4       -0.002     0.007    -0.015     0.011    -0.259    37.297     0.797     0.966     0.516 
## birth_order_nonlinear5       -0.005     0.013    -0.030     0.019    -0.428    18.216     0.674     2.366     0.731 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.398    32.817     0.693     1.099     0.550 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.066    42.485     0.948     0.853     0.484 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.266    30.942     0.792     1.171     0.566 
## male                          0.001     0.003    -0.005     0.008     0.448    29.494     0.658     1.234     0.580 
## sibling_count                 0.003     0.001    -0.000     0.006     1.830   119.553     0.070     0.378     0.286 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.163 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-186" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-475-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-46" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-187" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.020     0.011    -0.002     0.041     1.820    14.586     0.089     3.662     0.810 
## count_birth_order2/2         -0.001     0.006    -0.012     0.010    -0.199    34.888     0.843     1.032     0.534 
## count_birth_order1/3          0.001     0.006    -0.010     0.013     0.221   102.838     0.825     0.420     0.309 
## count_birth_order2/3         -0.001     0.007    -0.014     0.012    -0.111    41.009     0.912     0.881     0.493 
## count_birth_order3/3         -0.002     0.008    -0.017     0.014    -0.227    22.150     0.822     1.758     0.666 
## count_birth_order1/4          0.005     0.007    -0.009     0.019     0.726   157.489     0.469     0.314     0.249 
## count_birth_order2/4          0.006     0.009    -0.012     0.024     0.686    31.438     0.498     1.151     0.562 
## count_birth_order3/4         -0.001     0.010    -0.021     0.019    -0.112    20.524     0.912     1.960     0.691 
## count_birth_order4/4          0.001     0.008    -0.015     0.017     0.093    35.091     0.927     1.026     0.532 
## count_birth_order1/5          0.004     0.009    -0.013     0.021     0.458   166.995     0.648     0.302     0.241 
## count_birth_order2/5          0.008     0.009    -0.009     0.026     0.943   146.496     0.347     0.330     0.258 
## count_birth_order3/5          0.006     0.012    -0.019     0.030     0.461    21.477     0.649     1.836     0.676 
## count_birth_order4/5          0.009     0.009    -0.009     0.027     1.012    73.963     0.315     0.536     0.366 
## count_birth_order5/5          0.002     0.012    -0.021     0.025     0.181    20.939     0.858     1.904     0.684 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.402    26.911     0.691     1.371     0.607 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.182    24.974     0.857     1.502     0.629 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.267    22.746     0.792     1.696     0.658 
## male                          0.002     0.003    -0.005     0.008     0.537    34.644     0.595     1.040     0.536 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.162 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-187" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-477-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-46" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:      NA       8      NA      NA      NA 
##  2 vs 3:      NA       3      NA      NA      NA 
##  3 vs 4:      NA       1      NA      NA      NA 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-23" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-47" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-188" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.013     0.009    -0.004     0.031     1.520    12.028     0.154     6.408     0.883 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.742    26.620     0.465     1.389     0.610 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.243    38.755     0.810     0.930     0.507 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.305    31.315     0.763     1.156     0.563 
## male                          0.002     0.003    -0.003     0.007     0.754    35.182     0.456     1.023     0.532 
## sibling_count                 0.002     0.002    -0.001     0.005     1.395    23.305     0.176     1.642     0.650 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.160 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-188" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-480-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-47" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-189" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.015     0.009    -0.004     0.033     1.577    11.942     0.141     6.583     0.886 
## birth_order                  -0.002     0.002    -0.005     0.002    -0.864    23.438     0.396     1.629     0.648 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.650    27.337     0.521     1.346     0.602 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.210    42.627     0.835     0.850     0.483 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.298    33.117     0.768     1.089     0.548 
## male                          0.002     0.003    -0.003     0.008     0.745    34.497     0.461     1.044     0.537 
## sibling_count                 0.003     0.002    -0.000     0.006     1.794    29.513     0.083     1.233     0.580 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.160 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-189" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-482-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-47" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-190" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.013     0.009    -0.005     0.032     1.431    12.014     0.178     6.437     0.883 
## birth_order_nonlinear2       -0.001     0.004    -0.008     0.006    -0.175    27.698     0.862     1.326     0.598 
## birth_order_nonlinear3       -0.002     0.006    -0.013     0.010    -0.260    18.814     0.798     2.243     0.720 
## birth_order_nonlinear4       -0.005     0.007    -0.019     0.008    -0.765    27.392     0.451     1.343     0.601 
## birth_order_nonlinear5       -0.005     0.011    -0.027     0.017    -0.423    26.819     0.675     1.377     0.608 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.001     0.002     0.675    25.805     0.506     1.442     0.619 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.253    39.717     0.801     0.908     0.501 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.329    32.657     0.744     1.105     0.552 
## male                          0.002     0.003    -0.003     0.007     0.841    45.017     0.405     0.809     0.470 
## sibling_count                 0.003     0.002    -0.001     0.006     1.553    30.177     0.131     1.203     0.573 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.159 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-190" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-484-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-47" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-191" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.010    -0.000     0.039     1.947    14.894     0.071     3.491     0.802 
## count_birth_order2/2         -0.003     0.005    -0.012     0.007    -0.582    40.751     0.564     0.887     0.494 
## count_birth_order1/3         -0.001     0.007    -0.015     0.012    -0.222    30.885     0.826     1.173     0.567 
## count_birth_order2/3          0.001     0.007    -0.013     0.015     0.105    21.552     0.917     1.827     0.675 
## count_birth_order3/3          0.001     0.007    -0.013     0.015     0.148    24.716     0.883     1.522     0.632 
## count_birth_order1/4          0.006     0.009    -0.012     0.024     0.676    30.294     0.504     1.198     0.572 
## count_birth_order2/4          0.009     0.009    -0.009     0.026     0.973    24.901     0.340     1.507     0.630 
## count_birth_order3/4          0.002     0.008    -0.013     0.017     0.250    43.622     0.804     0.832     0.478 
## count_birth_order4/4         -0.000     0.008    -0.017     0.016    -0.030    33.522     0.976     1.075     0.545 
## count_birth_order1/5          0.013     0.012    -0.010     0.036     1.104    36.191     0.277     0.995     0.524 
## count_birth_order2/5          0.011     0.011    -0.010     0.032     1.006    40.293     0.320     0.896     0.497 
## count_birth_order3/5          0.006     0.010    -0.014     0.027     0.616    36.939     0.542     0.975     0.519 
## count_birth_order4/5          0.005     0.013    -0.021     0.031     0.348    18.500     0.731     2.306     0.726 
## count_birth_order5/5          0.004     0.010    -0.016     0.023     0.357    56.327     0.723     0.666     0.420 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.002     0.735    34.499     0.467     1.044     0.537 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.426    43.327     0.672     0.837     0.479 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.467    32.544     0.643     1.109     0.553 
## male                          0.002     0.003    -0.004     0.008     0.700    46.796     0.487     0.781     0.461 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.005 
## Residual~~Residual                     0.027 
## ICC|mother_pidlink                     0.157 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-191" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-486-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-47" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:      NA       8      NA      NA      NA 
##  2 vs 3:      NA       3      NA      NA      NA 
##  3 vs 4:      NA       1      NA      NA      NA 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-23" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-488-1.png" width="672" /></p>
</div>
</div>
<div id="elementary_worked" class="section level3">
<h3>elementary_worked</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = Elementary_worked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-24" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-48" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-192" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.009    -0.001     0.035     1.860    15.571     0.082     3.171     0.786 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.001     0.003     0.613    19.014     0.547     2.205     0.716 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.399    20.892     0.694     1.910     0.685 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.116    22.372     0.909     1.734     0.663 
## male                          0.005     0.003    -0.002     0.012     1.456    65.182     0.150     0.591     0.390 
## sibling_count                 0.002     0.002    -0.001     0.005     1.377    76.659     0.173     0.521     0.359 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.185 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-192" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-490-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-48" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-193" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.019     0.008     0.003     0.036     2.272    19.103     0.035     2.189     0.715 
## birth_order                  -0.002     0.002    -0.006     0.002    -1.070    46.831     0.290     0.781     0.461 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.457    21.577     0.653     1.824     0.675 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.525    22.185     0.605     1.754     0.666 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.202    23.070     0.842     1.664     0.653 
## male                          0.005     0.003    -0.002     0.012     1.472    65.796     0.146     0.587     0.388 
## sibling_count                 0.004     0.002    -0.001     0.008     1.608    40.324     0.116     0.895     0.497 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.185 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-193" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-492-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-48" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-194" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.017     0.009    -0.002     0.036     1.801    15.429     0.091     3.233     0.789 
## birth_order_nonlinear2       -0.002     0.004    -0.011     0.006    -0.520    56.694     0.605     0.662     0.419 
## birth_order_nonlinear3       -0.006     0.006    -0.019     0.006    -0.962    33.997     0.343     1.060     0.541 
## birth_order_nonlinear4       -0.008     0.008    -0.023     0.007    -0.995    62.633     0.323     0.610     0.398 
## birth_order_nonlinear5       -0.005     0.013    -0.031     0.020    -0.407    30.003     0.687     1.211     0.575 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.002     0.444    20.975     0.661     1.899     0.684 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.522    21.436     0.607     1.841     0.677 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.205    22.116     0.840     1.762     0.667 
## male                          0.005     0.003    -0.002     0.012     1.459    62.346     0.150     0.613     0.399 
## sibling_count                 0.004     0.002    -0.001     0.008     1.626    41.166     0.112     0.878     0.492 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.185 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-194" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-494-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-48" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-195" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.026     0.010     0.007     0.046     2.633    25.347     0.014     1.475     0.624 
## count_birth_order2/2         -0.003     0.006    -0.016     0.010    -0.470    56.307     0.640     0.666     0.420 
## count_birth_order1/3          0.004     0.008    -0.012     0.019     0.485    61.393     0.629     0.620     0.402 
## count_birth_order2/3          0.002     0.007    -0.012     0.016     0.266   136.906     0.791     0.345     0.267 
## count_birth_order3/3         -0.005     0.008    -0.020     0.010    -0.642    68.024     0.523     0.572     0.382 
## count_birth_order1/4          0.006     0.010    -0.014     0.027     0.614    51.660     0.542     0.716     0.439 
## count_birth_order2/4          0.012     0.010    -0.007     0.032     1.259    69.501     0.212     0.562     0.378 
## count_birth_order3/4          0.010     0.012    -0.013     0.033     0.838    25.617     0.410     1.455     0.621 
## count_birth_order4/4          0.001     0.009    -0.016     0.018     0.067   108.746     0.946     0.404     0.300 
## count_birth_order1/5          0.019     0.015    -0.010     0.048     1.278    27.789     0.212     1.321     0.597 
## count_birth_order2/5          0.014     0.015    -0.015     0.044     0.968    29.634     0.341     1.228     0.579 
## count_birth_order3/5          0.007     0.012    -0.016     0.029     0.568    84.804     0.571     0.483     0.341 
## count_birth_order4/5          0.008     0.010    -0.012     0.028     0.765   352.490     0.445     0.190     0.165 
## count_birth_order5/5          0.008     0.013    -0.018     0.034     0.580    26.525     0.567     1.395     0.611 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.114    20.705     0.910     1.935     0.688 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.376    19.066     0.711     2.195     0.715 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.062    17.857     0.951     2.447     0.738 
## male                          0.005     0.004    -0.002     0.012     1.450    94.689     0.150     0.446     0.322 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.043 
## ICC|mother_pidlink                     0.182 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-195" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-496-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-48" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:      NA       8      NA      NA      NA 
##  2 vs 3:      NA       3      NA      NA      NA 
##  3 vs 4:      NA       1      NA      NA      NA 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-24" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-49" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-196" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.013     0.009    -0.005     0.031     1.439    14.492     0.171     3.718     0.812 
## poly(age, 3, raw = TRUE)1     0.001     0.001    -0.002     0.003     0.528    16.926     0.605     2.693     0.756 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.584    20.495     0.566     1.964     0.691 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.348    23.384     0.731     1.634     0.649 
## male                          0.005     0.003    -0.001     0.012     1.719    60.900     0.091     0.624     0.404 
## sibling_count                 0.005     0.002     0.001     0.008     2.681    39.705     0.011     0.909     0.501 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.184 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-196" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-499-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-49" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-197" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.016     0.009    -0.001     0.033     1.815    16.099     0.088     2.963     0.774 
## birth_order                  -0.003     0.002    -0.007     0.001    -1.397    28.347     0.173     1.291     0.591 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.407    17.452     0.689     2.548     0.746 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.636    20.713     0.532     1.934     0.688 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.361    23.298     0.721     1.642     0.650 
## male                          0.006     0.003    -0.001     0.012     1.761    64.251     0.083     0.598     0.393 
## sibling_count                 0.006     0.002     0.002     0.011     2.682    25.071     0.013     1.495     0.628 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.184 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-197" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-501-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-49" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-198" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.014     0.010    -0.005     0.033     1.397    14.342     0.184     3.812     0.816 
## birth_order_nonlinear2       -0.003     0.004    -0.010     0.004    -0.769   105.282     0.444     0.413     0.305 
## birth_order_nonlinear3       -0.007     0.006    -0.019     0.005    -1.089    28.501     0.285     1.283     0.590 
## birth_order_nonlinear4       -0.008     0.008    -0.023     0.007    -1.020    49.287     0.313     0.746     0.449 
## birth_order_nonlinear5       -0.010     0.013    -0.035     0.015    -0.788    43.385     0.435     0.836     0.479 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.002     0.003     0.368    17.253     0.717     2.600     0.750 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.594    19.705     0.559     2.085     0.704 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.287    21.175     0.777     1.873     0.681 
## male                          0.006     0.003    -0.001     0.012     1.672    54.488     0.100     0.685     0.427 
## sibling_count                 0.006     0.002     0.002     0.011     2.661    27.989     0.013     1.310     0.595 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.184 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-198" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-503-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-49" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-199" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.028     0.011     0.006     0.050     2.532    17.998     0.021     2.415     0.735 
## count_birth_order2/2         -0.004     0.006    -0.016     0.008    -0.602    46.249     0.550     0.789     0.464 
## count_birth_order1/3          0.001     0.008    -0.015     0.018     0.133    32.383     0.895     1.115     0.554 
## count_birth_order2/3          0.001     0.007    -0.011     0.014     0.217    96.318     0.829     0.440     0.320 
## count_birth_order3/3         -0.005     0.006    -0.017     0.008    -0.766   293.231     0.444     0.212     0.181 
## count_birth_order1/4          0.015     0.010    -0.005     0.036     1.476    50.336     0.146     0.733     0.444 
## count_birth_order2/4          0.014     0.011    -0.007     0.036     1.304    26.775     0.203     1.380     0.608 
## count_birth_order3/4          0.010     0.010    -0.010     0.030     0.980    38.209     0.333     0.943     0.510 
## count_birth_order4/4          0.004     0.010    -0.015     0.023     0.420    50.300     0.677     0.733     0.445 
## count_birth_order1/5          0.027     0.016    -0.004     0.058     1.725    31.443     0.094     1.151     0.562 
## count_birth_order2/5          0.024     0.014    -0.002     0.051     1.787    39.395     0.082     0.916     0.503 
## count_birth_order3/5          0.018     0.013    -0.007     0.044     1.414    40.327     0.165     0.895     0.497 
## count_birth_order4/5          0.015     0.015    -0.015     0.046     0.998    22.816     0.329     1.689     0.657 
## count_birth_order5/5          0.011     0.015    -0.017     0.040     0.782    31.482     0.440     1.149     0.562 
## poly(age, 3, raw = TRUE)1     0.000     0.001    -0.003     0.003     0.067    16.762     0.947     2.742     0.760 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.620    19.667     0.543     2.091     0.705 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.307    22.538     0.762     1.717     0.661 
## male                          0.006     0.003    -0.000     0.013     1.894   101.134     0.061     0.425     0.312 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.010 
## Residual~~Residual                     0.044 
## ICC|mother_pidlink                     0.181 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-199" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-505-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-49" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:      NA       8      NA      NA      NA 
##  2 vs 3:      NA       3      NA      NA      NA 
##  3 vs 4:      NA       1      NA      NA      NA 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-24" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-507-1.png" width="672" /></p>
</div>
</div>
<div id="attended_school" class="section level3">
<h3>attended_school</h3>
<pre class="r"><code># Specify your outcome
data_used = data_used %&gt;% mutate(outcome = attended_school)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-25" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-50" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-200" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.516     0.022     0.473     0.558    23.627    12.960     0.000     5.000     0.854 
## poly(age, 3, raw = TRUE)1     0.013     0.002     0.009     0.016     7.599    36.223     0.000     0.994     0.524 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -1.988    59.558     0.051     0.636     0.408 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.762    63.520     0.449     0.604     0.395 
## male                         -0.013     0.007    -0.027     0.000    -1.923    67.951     0.059     0.572     0.382 
## sibling_count                 0.005     0.004    -0.002     0.012     1.358    28.714     0.185     1.272     0.588 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.030 
## Residual~~Residual                     0.181 
## ICC|mother_pidlink                     0.140 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-200" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-509-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-50" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-201" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.519     0.023     0.474     0.564    22.663    12.973     0.000     4.985     0.854 
## birth_order                  -0.004     0.005    -0.013     0.005    -0.811    30.884     0.423     1.173     0.567 
## poly(age, 3, raw = TRUE)1     0.012     0.002     0.009     0.016     7.103    33.366     0.000     1.081     0.546 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.810    53.272     0.076     0.698     0.432 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.836    58.191     0.406     0.648     0.413 
## male                         -0.013     0.007    -0.026     0.000    -1.910    67.092     0.060     0.578     0.384 
## sibling_count                 0.007     0.004    -0.001     0.015     1.819    56.516     0.074     0.664     0.419 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.030 
## Residual~~Residual                     0.181 
## ICC|mother_pidlink                     0.140 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-201" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-511-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-50" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-202" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.519     0.021     0.477     0.560    24.631    13.625     0.000     4.340     0.835 
## birth_order_nonlinear2       -0.013     0.008    -0.029     0.003    -1.534    82.641     0.129     0.493     0.346 
## birth_order_nonlinear3       -0.018     0.012    -0.041     0.005    -1.544    49.204     0.129     0.747     0.450 
## birth_order_nonlinear4       -0.005     0.016    -0.037     0.026    -0.331    54.526     0.742     0.684     0.427 
## birth_order_nonlinear5       -0.007     0.028    -0.061     0.048    -0.242    25.186     0.811     1.486     0.626 
## poly(age, 3, raw = TRUE)1     0.012     0.002     0.009     0.015     7.113    34.690     0.000     1.038     0.535 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.762    57.878     0.083     0.651     0.414 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.935    64.288     0.353     0.598     0.393 
## male                         -0.013     0.007    -0.027     0.000    -1.913    66.698     0.060     0.581     0.385 
## sibling_count                 0.008     0.004    -0.000     0.016     1.852    57.159     0.069     0.658     0.417 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.030 
## Residual~~Residual                     0.181 
## ICC|mother_pidlink                     0.140 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-202" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-513-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-50" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-203" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.502     0.025     0.453     0.550    20.249    16.535     0.000     2.813     0.765 
## count_birth_order2/2          0.015     0.013    -0.011     0.040     1.133    57.751     0.262     0.652     0.415 
## count_birth_order1/3          0.029     0.018    -0.006     0.064     1.639    34.826     0.110     1.034     0.534 
## count_birth_order2/3         -0.002     0.015    -0.032     0.028    -0.133    75.099     0.894     0.529     0.363 
## count_birth_order3/3          0.016     0.016    -0.015     0.047     1.028    58.363     0.308     0.647     0.412 
## count_birth_order1/4          0.043     0.017     0.009     0.077     2.455   269.384     0.015     0.224     0.189 
## count_birth_order2/4          0.029     0.021    -0.012     0.070     1.377    47.870     0.175     0.766     0.456 
## count_birth_order3/4          0.004     0.022    -0.039     0.047     0.190    32.533     0.851     1.110     0.553 
## count_birth_order4/4          0.037     0.019     0.001     0.074     2.006    60.190     0.049     0.630     0.406 
## count_birth_order1/5          0.066     0.022     0.022     0.110     2.954   164.885     0.004     0.305     0.243 
## count_birth_order2/5          0.056     0.021     0.014     0.098     2.639   620.622     0.009     0.137     0.123 
## count_birth_order3/5          0.035     0.023    -0.010     0.080     1.528    87.982     0.130     0.470     0.335 
## count_birth_order4/5          0.030     0.021    -0.011     0.072     1.442   198.549     0.151     0.270     0.221 
## count_birth_order5/5          0.041     0.028    -0.015     0.096     1.445    23.178     0.162     1.653     0.652 
## poly(age, 3, raw = TRUE)1     0.014     0.003     0.009     0.019     5.239    21.241     0.000     1.865     0.680 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -1.359    33.359     0.183     1.081     0.546 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.941    48.731     0.351     0.754     0.452 
## male                         -0.018     0.007    -0.032    -0.004    -2.552   121.008     0.012     0.375     0.284 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.029 
## Residual~~Residual                     0.180 
## ICC|mother_pidlink                     0.139 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-203" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-515-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-50" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 705.844       8 219.401   0.000   0.174 
##  2 vs 3:   2.562       3  27.811   0.075   0.932 
##  3 vs 4:   1.195       1  29.038   0.283   1.256 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-25" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-51" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-204" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.503     0.019     0.466     0.540    26.477    13.546     0.000     4.409     0.837 
## poly(age, 3, raw = TRUE)1     0.015     0.002     0.012     0.018     9.464    31.372     0.000     1.153     0.563 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.498    44.080     0.001     0.824     0.475 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.334    48.312     0.740     0.759     0.454 
## male                         -0.015     0.006    -0.027    -0.003    -2.470    72.722     0.016     0.543     0.369 
## sibling_count                 0.007     0.003     0.002     0.013     2.463    58.866     0.017     0.642     0.411 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.029 
## Residual~~Residual                     0.175 
## ICC|mother_pidlink                     0.140 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-204" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-518-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-51" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-205" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.499     0.021     0.459     0.540    24.309    13.158     0.000     4.781     0.848 
## birth_order                   0.005     0.004    -0.003     0.013     1.223    36.324     0.229     0.991     0.523 
## poly(age, 3, raw = TRUE)1     0.015     0.002     0.012     0.019     9.121    27.494     0.000     1.337     0.600 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.430    39.010     0.001     0.924     0.505 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.332    44.377     0.742     0.819     0.474 
## male                         -0.015     0.006    -0.027    -0.003    -2.448    68.650     0.017     0.568     0.380 
## sibling_count                 0.005     0.003    -0.002     0.011     1.328    93.832     0.187     0.449     0.324 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.029 
## Residual~~Residual                     0.175 
## ICC|mother_pidlink                     0.140 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-205" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-520-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-51" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-206" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.509     0.018     0.473     0.545    27.763    14.735     0.000     3.577     0.806 
## birth_order_nonlinear2       -0.008     0.008    -0.023     0.007    -1.009    49.550     0.318     0.743     0.448 
## birth_order_nonlinear3        0.004     0.012    -0.019     0.027     0.330    31.928     0.744     1.132     0.558 
## birth_order_nonlinear4        0.007     0.015    -0.022     0.035     0.470    69.129     0.640     0.565     0.379 
## birth_order_nonlinear5        0.021     0.025    -0.028     0.071     0.835    41.081     0.409     0.880     0.492 
## poly(age, 3, raw = TRUE)1     0.015     0.002     0.012     0.018     8.894    28.386     0.000     1.289     0.591 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -3.220    45.503     0.002     0.801     0.468 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.044    54.890     0.965     0.680     0.425 
## male                         -0.015     0.006    -0.027    -0.002    -2.291    58.612     0.026     0.644     0.412 
## sibling_count                 0.005     0.004    -0.002     0.012     1.533    91.156     0.129     0.458     0.329 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.029 
## Residual~~Residual                     0.175 
## ICC|mother_pidlink                     0.141 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-206" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-522-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-51" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-207" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.469     0.025     0.421     0.517    18.987    14.739     0.000     3.575     0.806 
## count_birth_order2/2          0.024     0.015    -0.004     0.053     1.668    22.655     0.109     1.705     0.659 
## count_birth_order1/3          0.028     0.016    -0.004     0.060     1.705    32.731     0.098     1.103     0.551 
## count_birth_order2/3          0.005     0.013    -0.020     0.030     0.384    78.603     0.702     0.511     0.355 
## count_birth_order3/3          0.038     0.018     0.003     0.072     2.140    25.107     0.042     1.492     0.627 
## count_birth_order1/4          0.043     0.019     0.005     0.081     2.219    61.644     0.030     0.618     0.401 
## count_birth_order2/4          0.023     0.015    -0.007     0.053     1.494   247.718     0.137     0.235     0.197 
## count_birth_order3/4          0.029     0.016    -0.002     0.060     1.835   208.090     0.068     0.263     0.215 
## count_birth_order4/4          0.038     0.018     0.002     0.074     2.068    59.059     0.043     0.640     0.410 
## count_birth_order1/5          0.032     0.024    -0.015     0.079     1.345   143.933     0.181     0.333     0.260 
## count_birth_order2/5          0.014     0.029    -0.043     0.072     0.489    27.836     0.629     1.318     0.597 
## count_birth_order3/5          0.030     0.024    -0.018     0.078     1.225    48.137     0.227     0.762     0.455 
## count_birth_order4/5          0.039     0.026    -0.012     0.090     1.491    35.060     0.145     1.027     0.533 
## count_birth_order5/5          0.053     0.026     0.003     0.103     2.058    46.898     0.045     0.780     0.461 
## poly(age, 3, raw = TRUE)1     0.020     0.002     0.015     0.024     8.689    20.885     0.000     1.911     0.685 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000    -0.000    -4.578    29.734     0.000     1.223     0.578 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     1.775    33.565     0.085     1.074     0.544 
## male                         -0.016     0.008    -0.031    -0.001    -2.078    40.483     0.044     0.892     0.496 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.027 
## Residual~~Residual                     0.172 
## ICC|mother_pidlink                     0.136 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-207" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-524-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-51" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 753.442       8  57.925   0.000   0.406 
##  2 vs 3: 275.407       3  37.692   0.000   0.708 
##  3 vs 4:  58.947       1 198.924   0.000   0.270 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-25" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-526-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="work" class="section level2 tabset">
<h2>Work</h2>
<div id="income-last-month-log---z-standardized" class="section level3 tabset">
<h3>Income Last Month (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_month_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-26" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-52" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-208" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.178     0.053    -0.282    -0.075    -3.389    11.986     0.005     6.492     0.884 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.004     0.012     1.028    22.898     0.315     1.680     0.656 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.981    28.771     0.335     1.269     0.587 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.417    26.084     0.168     1.424     0.616 
## male                          0.065     0.027     0.013     0.117     2.443    14.091     0.028     3.980     0.823 
## sibling_count                 0.007     0.008    -0.008     0.022     0.940    33.474     0.354     1.077     0.545 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.892 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-208" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-528-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-52" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-209" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.185     0.053    -0.290    -0.081    -3.486    12.294     0.004     5.926     0.875 
## birth_order                   0.008     0.011    -0.013     0.029     0.747    28.502     0.461     1.283     0.590 
## poly(age, 3, raw = TRUE)1     0.005     0.004    -0.003     0.013     1.189    25.124     0.245     1.491     0.627 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.893    31.069     0.379     1.166     0.565 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.364    27.320     0.184     1.347     0.602 
## male                          0.065     0.027     0.012     0.117     2.429    14.035     0.029     4.020     0.824 
## sibling_count                 0.002     0.009    -0.015     0.020     0.264    55.702     0.793     0.672     0.422 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.891 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-209" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-530-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-52" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-210" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.180     0.054    -0.286    -0.073    -3.311    11.938     0.006     6.590     0.886 
## birth_order_nonlinear2        0.016     0.017    -0.018     0.050     0.924   111.140     0.357     0.398     0.297 
## birth_order_nonlinear3        0.016     0.033    -0.049     0.081     0.490    21.516     0.629     1.831     0.676 
## birth_order_nonlinear4        0.027     0.043    -0.058     0.112     0.621    24.521     0.540     1.537     0.634 
## birth_order_nonlinear5        0.027     0.060    -0.090     0.145     0.458    27.070     0.651     1.362     0.605 
## poly(age, 3, raw = TRUE)1     0.005     0.004    -0.003     0.013     1.196    24.751     0.243     1.519     0.632 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.869    30.152     0.392     1.204     0.574 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.326    26.330     0.196     1.408     0.613 
## male                          0.065     0.027     0.013     0.117     2.434    14.077     0.029     3.990     0.823 
## sibling_count                 0.002     0.009    -0.015     0.019     0.258    59.423     0.797     0.637     0.409 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.891 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-210" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-532-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-52" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-211" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.168     0.048    -0.263    -0.073    -3.458    19.581     0.003     2.105     0.706 
## count_birth_order2/2          0.008     0.028    -0.047     0.062     0.274    71.772     0.785     0.548     0.371 
## count_birth_order1/3          0.010     0.034    -0.057     0.078     0.293    62.499     0.771     0.612     0.398 
## count_birth_order2/3          0.028     0.033    -0.036     0.091     0.850    97.192     0.397     0.437     0.318 
## count_birth_order3/3          0.026     0.041    -0.054     0.106     0.630    26.658     0.534     1.387     0.609 
## count_birth_order1/4          0.015     0.047    -0.078     0.107     0.308    40.885     0.760     0.884     0.493 
## count_birth_order2/4          0.020     0.040    -0.059     0.099     0.494   115.322     0.622     0.388     0.292 
## count_birth_order3/4          0.019     0.048    -0.074     0.113     0.405    32.960     0.688     1.094     0.549 
## count_birth_order4/4          0.031     0.049    -0.064     0.126     0.633    27.714     0.532     1.325     0.598 
## count_birth_order1/5         -0.029     0.050    -0.127     0.070    -0.575   121.000     0.566     0.375     0.284 
## count_birth_order2/5          0.028     0.058    -0.086     0.142     0.487    47.506     0.629     0.771     0.458 
## count_birth_order3/5         -0.003     0.067    -0.133     0.128    -0.044    23.842     0.965     1.593     0.643 
## count_birth_order4/5          0.030     0.069    -0.105     0.165     0.437    21.421     0.666     1.842     0.677 
## count_birth_order5/5          0.031     0.053    -0.073     0.134     0.584    37.536     0.563     0.959     0.515 
## poly(age, 3, raw = TRUE)1     0.003     0.005    -0.006     0.012     0.581    41.256     0.564     0.876     0.491 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.297    52.145     0.200     0.711     0.437 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.548    45.001     0.129     0.809     0.470 
## male                          0.065     0.027     0.012     0.117     2.421    15.691     0.028     3.121     0.783 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.101 
## Residual~~Residual                     0.890 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-211" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-534-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-52" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1465.181        8  138.153    0.000    0.230 
##   2 vs 3:    2.675        3   19.919    0.075    1.326 
##   3 vs 4:    1.983        1   26.464    0.171    1.399 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-26" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-53" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-212" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.169     0.051    -0.268    -0.070    -3.347    11.780     0.006     6.941     0.891 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.003     0.012     1.076    24.228     0.293     1.561     0.638 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.162    29.626     0.255     1.228     0.579 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.636    26.486     0.114     1.398     0.611 
## male                          0.069     0.025     0.020     0.117     2.790    13.911     0.015     4.111     0.827 
## sibling_count                 0.002     0.008    -0.013     0.018     0.308    26.564     0.761     1.393     0.610 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.892 
## ICC|mother_pidlink                     0.103 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-212" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-537-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-53" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-213" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.171     0.052    -0.273    -0.069    -3.298    11.915     0.006     6.639     0.887 
## birth_order                   0.003     0.007    -0.011     0.017     0.379   197.962     0.705     0.271     0.221 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.003     0.012     1.082    23.709     0.290     1.605     0.645 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.151    29.470     0.259     1.235     0.580 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.635    26.544     0.114     1.394     0.611 
## male                          0.068     0.024     0.021     0.116     2.811    14.047     0.014     4.011     0.824 
## sibling_count                 0.001     0.008    -0.015     0.017     0.082    47.640     0.935     0.769     0.457 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.892 
## ICC|mother_pidlink                     0.103 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-213" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-539-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-53" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-214" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.169     0.051    -0.270    -0.068    -3.286    12.008     0.006     6.448     0.884 
## birth_order_nonlinear2        0.007     0.017    -0.026     0.041     0.430    50.090     0.669     0.736     0.446 
## birth_order_nonlinear3        0.017     0.024    -0.031     0.064     0.691    46.537     0.493     0.785     0.462 
## birth_order_nonlinear4       -0.015     0.031    -0.076     0.046    -0.491   103.195     0.625     0.419     0.309 
## birth_order_nonlinear5       -0.011     0.051    -0.110     0.089    -0.209    78.496     0.835     0.512     0.355 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.004     0.012     1.056    24.335     0.301     1.552     0.637 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.181    31.325     0.246     1.155     0.563 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.667    28.343     0.107     1.291     0.591 
## male                          0.068     0.025     0.019     0.116     2.736    14.063     0.016     3.999     0.823 
## sibling_count                 0.001     0.008    -0.015     0.017     0.118    54.962     0.907     0.680     0.425 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.102 
## Residual~~Residual                     0.892 
## ICC|mother_pidlink                     0.102 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-214" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-541-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-53" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-215" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.170     0.045    -0.258    -0.082    -3.787    19.878     0.001     2.057     0.701 
## count_birth_order2/2          0.010     0.027    -0.042     0.063     0.390    47.612     0.698     0.769     0.457 
## count_birth_order1/3          0.012     0.031    -0.049     0.073     0.388    73.596     0.699     0.538     0.367 
## count_birth_order2/3          0.013     0.029    -0.044     0.070     0.444    78.485     0.658     0.512     0.355 
## count_birth_order3/3          0.026     0.034    -0.041     0.092     0.759    42.650     0.452     0.850     0.483 
## count_birth_order1/4         -0.025     0.056    -0.135     0.085    -0.445    22.960     0.661     1.674     0.655 
## count_birth_order2/4         -0.003     0.044    -0.089     0.083    -0.062    36.002     0.951     1.000     0.526 
## count_birth_order3/4          0.023     0.046    -0.068     0.114     0.494    30.569     0.624     1.186     0.570 
## count_birth_order4/4         -0.004     0.052    -0.107     0.098    -0.085    23.559     0.933     1.618     0.647 
## count_birth_order1/5         -0.000     0.064    -0.126     0.125    -0.006    41.095     0.996     0.880     0.492 
## count_birth_order2/5          0.003     0.067    -0.128     0.134     0.045    26.424     0.965     1.402     0.612 
## count_birth_order3/5          0.004     0.065    -0.124     0.132     0.060    24.924     0.952     1.506     0.630 
## count_birth_order4/5         -0.030     0.054    -0.137     0.076    -0.561    47.919     0.577     0.765     0.456 
## count_birth_order5/5         -0.005     0.059    -0.120     0.109    -0.093    43.253     0.926     0.839     0.480 
## poly(age, 3, raw = TRUE)1     0.004     0.004    -0.004     0.011     0.957    60.168     0.342     0.631     0.406 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.581   156.260     0.116     0.316     0.250 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.254   182.189     0.025     0.286     0.231 
## male                          0.070     0.024     0.024     0.117     2.951    16.942     0.009     2.688     0.756 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.103 
## Residual~~Residual                     0.891 
## ICC|mother_pidlink                     0.104 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-215" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-543-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-53" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1206.000        8   22.587    0.000    0.859 
##   2 vs 3:  610.544        3   35.416    0.000    0.747 
##   3 vs 4:   88.120        1   28.546    0.000    1.280 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-26" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-545-1.png" width="672" /></p>
</div>
</div>
<div id="income-last-year-log---z-standardized" class="section level3 tabset">
<h3>Income last year (log) - z-standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = wage_last_year_z)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-27" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-54" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-216" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.411     0.050    -0.508    -0.314    -8.310    12.264     0.000     5.976     0.875 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.009     0.023     4.338    28.943     0.000     1.261     0.585 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.950    40.860     0.348     0.884     0.494 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.511    29.660     0.141     1.226     0.578 
## male                          0.074     0.018     0.039     0.110     4.067    24.796     0.000     1.516     0.631 
## sibling_count                 0.006     0.009    -0.012     0.025     0.661    18.850     0.517     2.236     0.719 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.111 
## Residual~~Residual                     0.828 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-216" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-547-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-54" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-217" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.416     0.051    -0.516    -0.316    -8.144    12.419     0.000     5.725     0.871 
## birth_order                   0.005     0.011    -0.016     0.027     0.472    24.280     0.641     1.556     0.638 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.009     0.024     4.229    26.633     0.000     1.388     0.610 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.838    35.138     0.408     1.025     0.532 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.420    27.391     0.167     1.343     0.601 
## male                          0.074     0.018     0.038     0.110     4.040    24.424     0.000     1.545     0.636 
## sibling_count                 0.003     0.011    -0.018     0.024     0.278    23.243     0.784     1.647     0.651 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.111 
## Residual~~Residual                     0.828 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-217" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-549-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-54" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-218" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.412     0.050    -0.510    -0.313    -8.160    12.308     0.000     5.902     0.874 
## birth_order_nonlinear2        0.010     0.018    -0.025     0.046     0.579    61.799     0.565     0.617     0.401 
## birth_order_nonlinear3        0.003     0.029    -0.053     0.059     0.103    28.407     0.918     1.288     0.591 
## birth_order_nonlinear4        0.016     0.044    -0.071     0.102     0.351    21.323     0.729     1.854     0.678 
## birth_order_nonlinear5        0.033     0.056    -0.077     0.143     0.586    29.717     0.562     1.224     0.578 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.009     0.024     4.240    26.932     0.000     1.370     0.606 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     0.838    35.127     0.408     1.025     0.532 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.411    26.985     0.170     1.367     0.606 
## male                          0.074     0.018     0.038     0.110     4.056    24.769     0.000     1.518     0.631 
## sibling_count                 0.003     0.011    -0.018     0.024     0.287    23.872     0.777     1.591     0.643 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.111 
## Residual~~Residual                     0.828 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-218" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-551-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-54" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-219" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.403     0.044    -0.489    -0.317    -9.190    23.118     0.000     1.659     0.653 
## count_birth_order2/2          0.011     0.029    -0.045     0.067     0.391    50.375     0.698     0.732     0.444 
## count_birth_order1/3          0.004     0.036    -0.067     0.076     0.114    40.663     0.910     0.888     0.495 
## count_birth_order2/3          0.016     0.034    -0.052     0.083     0.452    53.899     0.653     0.691     0.429 
## count_birth_order3/3          0.017     0.039    -0.060     0.094     0.426    27.898     0.673     1.315     0.596 
## count_birth_order1/4          0.034     0.050    -0.063     0.132     0.694    30.207     0.493     1.202     0.573 
## count_birth_order2/4          0.025     0.039    -0.053     0.102     0.627   117.562     0.532     0.383     0.289 
## count_birth_order3/4          0.009     0.043    -0.076     0.094     0.199    45.424     0.843     0.802     0.468 
## count_birth_order4/4          0.032     0.044    -0.054     0.119     0.734    36.021     0.467     0.999     0.525 
## count_birth_order1/5         -0.005     0.059    -0.120     0.110    -0.087    37.582     0.931     0.958     0.515 
## count_birth_order2/5          0.040     0.059    -0.076     0.155     0.671    39.223     0.506     0.919     0.504 
## count_birth_order3/5          0.001     0.070    -0.136     0.137     0.009    20.337     0.993     1.987     0.694 
## count_birth_order4/5          0.016     0.064    -0.110     0.142     0.251    23.538     0.804     1.620     0.647 
## count_birth_order5/5          0.044     0.052    -0.059     0.147     0.844    34.972     0.405     1.030     0.533 
## poly(age, 3, raw = TRUE)1     0.014     0.004     0.006     0.022     3.480    69.928     0.001     0.559     0.376 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.436    93.936     0.154     0.448     0.324 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.911    62.462     0.061     0.612     0.399 
## male                          0.072     0.018     0.036     0.108     3.891    33.720     0.000     1.069     0.543 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.833 
## ICC|mother_pidlink                     0.119 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-219" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-553-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-54" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1430.067        8  152.181    0.000    0.217 
##   2 vs 3:    3.417        3   28.019    0.031    0.925 
##   3 vs 4:    1.382        1   20.410    0.253    1.977 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-27" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-55" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-220" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.396     0.047    -0.489    -0.304    -8.402    12.106     0.000     6.259     0.880 
## poly(age, 3, raw = TRUE)1     0.016     0.003     0.009     0.023     4.632    29.638     0.000     1.227     0.579 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.126    39.679     0.267     0.909     0.501 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.739    27.877     0.093     1.316     0.596 
## male                          0.076     0.018     0.040     0.112     4.144    20.046     0.001     2.031     0.699 
## sibling_count                -0.002     0.008    -0.017     0.014    -0.196    26.890     0.846     1.373     0.607 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.110 
## Residual~~Residual                     0.832 
## ICC|mother_pidlink                     0.117 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-220" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-556-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-55" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-221" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.399     0.047    -0.491    -0.308    -8.581    12.596     0.000     5.463     0.865 
## birth_order                   0.004     0.008    -0.012     0.020     0.509    47.623     0.613     0.769     0.457 
## poly(age, 3, raw = TRUE)1     0.016     0.003     0.009     0.023     4.684    30.551     0.000     1.187     0.570 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.115    40.073     0.272     0.901     0.498 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.741    28.092     0.093     1.304     0.594 
## male                          0.076     0.018     0.040     0.112     4.152    20.167     0.000     2.012     0.697 
## sibling_count                -0.004     0.008    -0.020     0.012    -0.501    44.437     0.619     0.818     0.473 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.110 
## Residual~~Residual                     0.832 
## ICC|mother_pidlink                     0.117 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-221" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-558-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-55" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-222" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.394     0.047    -0.487    -0.301    -8.320    12.486     0.000     5.623     0.869 
## birth_order_nonlinear2        0.006     0.017    -0.028     0.040     0.326    41.837     0.746     0.865     0.488 
## birth_order_nonlinear3        0.013     0.028    -0.042     0.068     0.472    24.457     0.641     1.542     0.635 
## birth_order_nonlinear4       -0.004     0.037    -0.077     0.069    -0.109    30.997     0.914     1.168     0.566 
## birth_order_nonlinear5       -0.004     0.047    -0.097     0.088    -0.085   114.483     0.932     0.390     0.293 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.009     0.023     4.466    28.937     0.000     1.261     0.585 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.147    38.275     0.258     0.941     0.510 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.792    29.549     0.083     1.232     0.579 
## male                          0.075     0.019     0.037     0.112     3.914    19.274     0.001     2.158     0.712 
## sibling_count                -0.004     0.008    -0.019     0.012    -0.443    58.351     0.660     0.647     0.413 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.110 
## Residual~~Residual                     0.834 
## ICC|mother_pidlink                     0.117 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-222" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-560-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-55" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-223" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.406     0.044    -0.492    -0.319    -9.181    19.706     0.000     2.085     0.704 
## count_birth_order2/2          0.010     0.027    -0.043     0.063     0.370    38.613     0.713     0.933     0.508 
## count_birth_order1/3         -0.005     0.030    -0.064     0.053    -0.180    87.652     0.857     0.472     0.335 
## count_birth_order2/3          0.005     0.028    -0.051     0.060     0.162    79.328     0.872     0.508     0.353 
## count_birth_order3/3          0.013     0.042    -0.070     0.095     0.306    20.462     0.763     1.969     0.692 
## count_birth_order1/4         -0.012     0.045    -0.100     0.076    -0.274    45.705     0.785     0.798     0.467 
## count_birth_order2/4         -0.014     0.044    -0.099     0.072    -0.319    33.806     0.752     1.066     0.542 
## count_birth_order3/4          0.014     0.042    -0.068     0.095     0.326    42.279     0.746     0.857     0.485 
## count_birth_order4/4          0.005     0.045    -0.083     0.093     0.107    34.771     0.916     1.036     0.535 
## count_birth_order1/5         -0.008     0.068    -0.141     0.125    -0.112    29.825     0.911     1.219     0.577 
## count_birth_order2/5         -0.016     0.063    -0.141     0.108    -0.257    28.540     0.799     1.281     0.589 
## count_birth_order3/5         -0.011     0.061    -0.131     0.110    -0.175    27.385     0.862     1.343     0.601 
## count_birth_order4/5         -0.043     0.061    -0.162     0.076    -0.708    27.919     0.485     1.314     0.596 
## count_birth_order5/5         -0.020     0.057    -0.132     0.092    -0.347    43.716     0.730     0.831     0.477 
## poly(age, 3, raw = TRUE)1     0.016     0.004     0.008     0.024     4.118    45.594     0.000     0.800     0.467 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.236    81.730     0.220     0.497     0.348 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.074    82.184     0.041     0.495     0.347 
## male                          0.076     0.021     0.036     0.117     3.676    20.348     0.001     1.986     0.694 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.112 
## Residual~~Residual                     0.837 
## ICC|mother_pidlink                     0.118 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-223" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-562-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-55" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##            F.value      df1      df2    P(&gt;F)      RIV 
##   1 vs 2: 1287.714        8   28.391    0.000    0.701 
##   2 vs 3:  444.768        3   20.540    0.000    1.280 
##   3 vs 4:   80.559        1   25.856    0.000    1.439 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-27" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-564-1.png" width="672" /></p>
</div>
</div>
<div id="self-employment---non-standardized" class="section level3 tabset">
<h3>Self-Employment - non standardized</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = Self_employed)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-28" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-56" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-224" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.051     0.065     0.266     3.220    11.912     0.007     6.646     0.887 
## poly(age, 3, raw = TRUE)1    -0.001     0.003    -0.007     0.006    -0.161    34.932     0.873     1.031     0.534 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.589    80.453     0.116     0.503     0.350 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.263    78.856     0.210     0.510     0.354 
## male                          0.068     0.016     0.036     0.100     4.175    36.479     0.000     0.987     0.522 
## sibling_count                -0.007     0.008    -0.023     0.009    -0.854    23.284     0.402     1.643     0.650 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.845 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-224" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-566-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-56" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-225" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.162     0.060     0.045     0.279     2.715    11.278     0.020     8.373     0.908 
## birth_order                   0.004     0.013    -0.023     0.030     0.273    16.815     0.789     2.726     0.759 
## poly(age, 3, raw = TRUE)1    -0.000     0.004    -0.008     0.008    -0.074    24.429     0.942     1.544     0.636 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.462    61.516     0.149     0.619     0.402 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.218    79.369     0.227     0.508     0.353 
## male                          0.068     0.016     0.036     0.100     4.170    36.489     0.000     0.987     0.522 
## sibling_count                -0.009     0.011    -0.030     0.011    -0.880    24.215     0.388     1.562     0.638 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.845 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-225" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-568-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-56" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-226" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.164     0.049     0.068     0.260     3.357    12.513     0.005     5.583     0.868 
## birth_order_nonlinear2        0.008     0.022    -0.034     0.051     0.378    28.390     0.708     1.289     0.591 
## birth_order_nonlinear3        0.010     0.037    -0.062     0.082     0.277    17.012     0.785     2.668     0.755 
## birth_order_nonlinear4        0.012     0.047    -0.080     0.104     0.251    19.135     0.805     2.183     0.714 
## birth_order_nonlinear5        0.009     0.054    -0.096     0.114     0.170    35.508     0.866     1.014     0.529 
## poly(age, 3, raw = TRUE)1    -0.000     0.004    -0.008     0.007    -0.062    25.220     0.951     1.484     0.626 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.459    65.856     0.149     0.586     0.388 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.204    83.023     0.232     0.491     0.345 
## male                          0.068     0.016     0.036     0.099     4.188    37.157     0.000     0.969     0.517 
## sibling_count                -0.009     0.011    -0.030     0.012    -0.880    23.743     0.388     1.602     0.644 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.085 
## Residual~~Residual                     0.845 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-226" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-570-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-56" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-227" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.157     0.069     0.022     0.291     2.276    12.440     0.041     5.692     0.870 
## count_birth_order2/2         -0.004     0.032    -0.065     0.058    -0.115    32.675     0.909     1.104     0.551 
## count_birth_order1/3         -0.024     0.031    -0.086     0.037    -0.776   102.350     0.439     0.422     0.310 
## count_birth_order2/3          0.005     0.044    -0.082     0.092     0.115    21.256     0.909     1.863     0.679 
## count_birth_order3/3         -0.002     0.047    -0.094     0.089    -0.051    18.398     0.960     2.327     0.728 
## count_birth_order1/4         -0.011     0.043    -0.095     0.074    -0.253    54.303     0.801     0.687     0.428 
## count_birth_order2/4          0.001     0.043    -0.084     0.086     0.016    53.539     0.987     0.695     0.431 
## count_birth_order3/4         -0.016     0.057    -0.127     0.095    -0.288    19.421     0.777     2.132     0.709 
## count_birth_order4/4         -0.021     0.052    -0.123     0.081    -0.395    21.354     0.697     1.851     0.678 
## count_birth_order1/5         -0.030     0.051    -0.129     0.069    -0.589    85.325     0.557     0.481     0.340 
## count_birth_order2/5         -0.016     0.071    -0.155     0.122    -0.227    21.788     0.822     1.799     0.672 
## count_birth_order3/5         -0.010     0.046    -0.100     0.081    -0.208   143.540     0.835     0.334     0.261 
## count_birth_order4/5          0.003     0.064    -0.122     0.127     0.045    23.838     0.964     1.594     0.643 
## count_birth_order5/5         -0.021     0.051    -0.121     0.079    -0.408    37.377     0.686     0.964     0.516 
## poly(age, 3, raw = TRUE)1    -0.001     0.006    -0.012     0.010    -0.203    20.118     0.841     2.020     0.698 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     0.973    29.993     0.338     1.211     0.575 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.761    36.956     0.452     0.974     0.519 
## male                          0.068     0.018     0.034     0.103     3.888    39.279     0.000     0.918     0.503 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.084 
## Residual~~Residual                     0.843 
## ICC|mother_pidlink                     0.091 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-227" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-572-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-56" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 929.715       8  21.653   0.000   0.894 
##  2 vs 3:   3.231       3  25.188   0.039   1.028 
##  3 vs 4:   2.305       1  31.508   0.139   1.148 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-28" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-57" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-228" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.160     0.050     0.062     0.259     3.195    11.482     0.008     7.722     0.901 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.005    -0.479    24.619     0.636     1.529     0.633 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.068    65.665     0.043     0.588     0.389 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.722    93.269     0.088     0.451     0.325 
## male                          0.064     0.015     0.034     0.094     4.233    31.850     0.000     1.135     0.558 
## sibling_count                -0.002     0.007    -0.016     0.011    -0.363    36.308     0.719     0.992     0.523 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.818 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-228" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-575-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-57" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-229" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.162     0.052     0.059     0.265     3.095    11.492     0.010     7.694     0.901 
## birth_order                  -0.001     0.008    -0.017     0.014    -0.184    49.215     0.855     0.747     0.450 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.005    -0.497    25.183     0.624     1.486     0.626 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.113    74.616     0.038     0.532     0.364 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.752   106.283     0.083     0.410     0.304 
## male                          0.064     0.015     0.034     0.094     4.212    31.498     0.000     1.148     0.562 
## sibling_count                -0.002     0.008    -0.017     0.013    -0.256    48.391     0.799     0.758     0.453 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.078 
## Residual~~Residual                     0.819 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-229" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-577-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-57" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-230" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.162     0.052     0.060     0.264     3.099    11.552     0.010     7.522     0.899 
## birth_order_nonlinear2       -0.002     0.019    -0.038     0.035    -0.087    29.599     0.931     1.229     0.579 
## birth_order_nonlinear3        0.002     0.025    -0.047     0.052     0.093    31.886     0.927     1.133     0.558 
## birth_order_nonlinear4       -0.011     0.034    -0.077     0.054    -0.342    45.388     0.734     0.803     0.468 
## birth_order_nonlinear5       -0.004     0.061    -0.125     0.116    -0.072    26.066     0.943     1.425     0.616 
## poly(age, 3, raw = TRUE)1    -0.002     0.004    -0.009     0.006    -0.500    23.086     0.622     1.662     0.653 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.058    68.341     0.043     0.570     0.381 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.746   126.294     0.083     0.364     0.278 
## male                          0.064     0.016     0.034     0.095     4.120    30.692     0.000     1.181     0.569 
## sibling_count                -0.002     0.008    -0.018     0.013    -0.276    52.701     0.784     0.704     0.434 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.079 
## Residual~~Residual                     0.822 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-230" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-579-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-57" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-231" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.165     0.059     0.049     0.281     2.788    12.934     0.015     5.031     0.855 
## count_birth_order2/2         -0.012     0.025    -0.061     0.038    -0.454    45.922     0.652     0.794     0.465 
## count_birth_order1/3         -0.013     0.027    -0.067     0.040    -0.488   146.003     0.626     0.330     0.258 
## count_birth_order2/3         -0.004     0.036    -0.074     0.066    -0.110    23.655     0.913     1.610     0.646 
## count_birth_order3/3         -0.008     0.036    -0.079     0.063    -0.216    26.707     0.831     1.384     0.609 
## count_birth_order1/4         -0.032     0.046    -0.121     0.057    -0.706    36.483     0.485     0.987     0.522 
## count_birth_order2/4         -0.016     0.046    -0.105     0.074    -0.342    25.719     0.735     1.448     0.620 
## count_birth_order3/4          0.004     0.040    -0.075     0.082     0.087    42.101     0.931     0.860     0.486 
## count_birth_order4/4         -0.018     0.037    -0.090     0.055    -0.486    85.797     0.628     0.479     0.339 
## count_birth_order1/5          0.010     0.048    -0.085     0.104     0.198   293.185     0.843     0.212     0.181 
## count_birth_order2/5          0.027     0.055    -0.081     0.134     0.487    43.370     0.629     0.837     0.479 
## count_birth_order3/5          0.000     0.044    -0.086     0.086     0.000   175.699     1.000     0.293     0.235 
## count_birth_order4/5         -0.005     0.053    -0.109     0.100    -0.085    38.874     0.933     0.927     0.506 
## count_birth_order5/5         -0.014     0.066    -0.143     0.115    -0.214    23.307     0.832     1.641     0.650 
## poly(age, 3, raw = TRUE)1    -0.002     0.005    -0.012     0.007    -0.478    20.740     0.638     1.930     0.687 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.001     1.571    36.938     0.125     0.975     0.519 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -1.297    58.784     0.200     0.643     0.411 
## male                          0.066     0.017     0.033     0.099     3.927    33.380     0.000     1.080     0.546 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.076 
## Residual~~Residual                     0.802 
## ICC|mother_pidlink                     0.087 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-231" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-581-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-57" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 633.031       8   9.346   0.000   2.551 
##  2 vs 3: 371.161       3  16.853   0.000   1.630 
##  3 vs 4: 100.880       1  44.343   0.000   0.820 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-28" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-583-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="smoking-behaviour" class="section level2 tabset">
<h2>Smoking Behaviour</h2>
<div id="ever_smoked" class="section level3 tabset">
<h3>ever_smoked</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = ever_smoked)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-29" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-58" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-232" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.172     0.014    -0.200    -0.144   -12.095    14.467     0.000     3.733     0.813 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.007     4.412    57.205     0.000     0.657     0.417 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.723    52.478     0.091     0.707     0.435 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.728    53.116     0.009     0.700     0.433 
## male                          0.651     0.005     0.640     0.661   121.381    45.074     0.000     0.808     0.470 
## sibling_count                 0.003     0.002    -0.001     0.008     1.410    60.561     0.164     0.627     0.405 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.143 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-232" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-585-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-58" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-233" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.175     0.015    -0.204    -0.146   -11.892    14.685     0.000     3.605     0.807 
## birth_order                   0.004     0.003    -0.003     0.010     1.127    40.940     0.266     0.883     0.493 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.007     4.527    54.333     0.000     0.686     0.428 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.529    49.172     0.133     0.748     0.450 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.573    49.994     0.013     0.737     0.446 
## male                          0.651     0.005     0.640     0.661   121.648    45.605     0.000     0.799     0.467 
## sibling_count                 0.001     0.003    -0.004     0.006     0.402   162.197     0.688     0.308     0.245 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.144 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-233" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-587-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-58" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-234" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.171     0.014    -0.199    -0.143   -11.986    14.738     0.000     3.576     0.806 
## birth_order_nonlinear2        0.004     0.006    -0.008     0.015     0.622    83.299     0.536     0.490     0.344 
## birth_order_nonlinear3        0.004     0.009    -0.014     0.021     0.436    41.956     0.665     0.863     0.487 
## birth_order_nonlinear4        0.017     0.013    -0.009     0.043     1.288    31.162     0.207     1.162     0.564 
## birth_order_nonlinear5        0.011     0.015    -0.019     0.040     0.706   123.278     0.481     0.370     0.282 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.007     4.503    53.490     0.000     0.695     0.431 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.526    48.063     0.134     0.763     0.455 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.566    48.986     0.013     0.750     0.451 
## male                          0.651     0.005     0.640     0.661   121.522    45.396     0.000     0.803     0.468 
## sibling_count                 0.001     0.003    -0.004     0.006     0.411   151.011     0.682     0.323     0.254 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.144 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-234" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-589-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-58" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-235" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.164     0.013    -0.190    -0.138   -12.283    35.222     0.000     1.022     0.531 
## count_birth_order2/2          0.007     0.009    -0.010     0.023     0.757   142.630     0.450     0.335     0.261 
## count_birth_order1/3         -0.004     0.013    -0.030     0.021    -0.319    36.019     0.751     0.999     0.526 
## count_birth_order2/3          0.008     0.011    -0.014     0.030     0.698    77.634     0.487     0.516     0.357 
## count_birth_order3/3          0.007     0.014    -0.021     0.035     0.497    25.635     0.624     1.454     0.621 
## count_birth_order1/4          0.008     0.015    -0.022     0.037     0.513    53.551     0.610     0.695     0.431 
## count_birth_order2/4          0.006     0.013    -0.019     0.031     0.460   315.661     0.646     0.203     0.174 
## count_birth_order3/4          0.010     0.013    -0.015     0.036     0.804   129.514     0.423     0.358     0.275 
## count_birth_order4/4          0.016     0.015    -0.013     0.046     1.096    40.167     0.280     0.899     0.498 
## count_birth_order1/5          0.029     0.016    -0.003     0.061     1.791   218.893     0.075     0.254     0.210 
## count_birth_order2/5          0.009     0.017    -0.025     0.043     0.514   121.158     0.609     0.375     0.284 
## count_birth_order3/5          0.007     0.019    -0.030     0.044     0.359    43.659     0.721     0.832     0.477 
## count_birth_order4/5          0.035     0.018     0.000     0.070     1.988    60.079     0.051     0.631     0.406 
## count_birth_order5/5          0.019     0.015    -0.011     0.049     1.225    89.050     0.224     0.466     0.333 
## poly(age, 3, raw = TRUE)1     0.004     0.001     0.001     0.006     2.499    85.119     0.014     0.482     0.340 
## poly(age, 3, raw = TRUE)2     0.000     0.000     0.000     0.000     2.410    44.337     0.020     0.820     0.474 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -3.124    42.538     0.003     0.852     0.484 
## male                          0.645     0.006     0.634     0.657   110.037    48.321     0.000     0.759     0.454 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.017 
## Residual~~Residual                     0.098 
## ICC|mother_pidlink                     0.145 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-235" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-591-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-58" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 290.479       8  72.908   0.000   0.346 
##  2 vs 3:   1.159       3  42.102   0.337   0.645 
##  3 vs 4:   2.834       1 132.574   0.095   0.352 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-29" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-59" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-236" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.176     0.012    -0.200    -0.153   -14.738    16.353     0.000     2.874     0.769 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.008     4.854    37.377     0.000     0.963     0.516 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.585    49.864     0.119     0.739     0.447 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.968    58.401     0.004     0.646     0.412 
## male                          0.655     0.005     0.645     0.665   128.472    37.380     0.000     0.963     0.516 
## sibling_count                 0.004     0.002     0.000     0.008     1.990   196.650     0.048     0.272     0.222 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-236" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-594-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-59" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-237" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.179     0.012    -0.203    -0.154   -14.426    16.590     0.000     2.796     0.763 
## birth_order                   0.003     0.003    -0.003     0.008     0.877    35.883     0.386     1.003     0.526 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.932    37.356     0.000     0.964     0.516 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.507    47.564     0.138     0.770     0.457 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.890    54.192     0.006     0.688     0.428 
## male                          0.655     0.005     0.645     0.665   129.503    38.863     0.000     0.928     0.506 
## sibling_count                 0.002     0.003    -0.003     0.007     0.970    91.965     0.334     0.455     0.327 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-237" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-596-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-59" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-238" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.174     0.012    -0.197    -0.151   -14.628    17.745     0.000     2.474     0.740 
## birth_order_nonlinear2        0.002     0.006    -0.010     0.015     0.393    32.649     0.697     1.105     0.552 
## birth_order_nonlinear3        0.006     0.008    -0.009     0.021     0.834    66.053     0.407     0.585     0.387 
## birth_order_nonlinear4        0.011     0.012    -0.012     0.033     0.905    45.092     0.370     0.808     0.470 
## birth_order_nonlinear5        0.022     0.020    -0.017     0.061     1.117    33.328     0.272     1.082     0.546 
## poly(age, 3, raw = TRUE)1     0.005     0.001     0.003     0.008     4.792    40.632     0.000     0.889     0.495 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.557    43.236     0.127     0.839     0.480 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.836    48.401     0.007     0.758     0.453 
## male                          0.653     0.005     0.644     0.663   133.225    49.385     0.000     0.745     0.449 
## sibling_count                 0.002     0.003    -0.003     0.007     0.730    95.465     0.467     0.443     0.321 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.141 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-238" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-598-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-59" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-239" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                  -0.175     0.014    -0.202    -0.148   -12.849    26.047     0.000     1.426     0.616 
## count_birth_order2/2          0.007     0.008    -0.008     0.023     0.908   107.734     0.366     0.407     0.302 
## count_birth_order1/3          0.000     0.010    -0.020     0.020     0.017    90.816     0.986     0.459     0.329 
## count_birth_order2/3          0.002     0.010    -0.018     0.022     0.169    54.048     0.866     0.689     0.429 
## count_birth_order3/3          0.006     0.011    -0.017     0.028     0.522    42.520     0.605     0.852     0.484 
## count_birth_order1/4          0.004     0.013    -0.021     0.029     0.316   296.682     0.753     0.211     0.180 
## count_birth_order2/4          0.013     0.016    -0.019     0.045     0.783    25.636     0.441     1.454     0.621 
## count_birth_order3/4          0.017     0.012    -0.007     0.041     1.402   127.467     0.163     0.362     0.277 
## count_birth_order4/4          0.015     0.015    -0.014     0.044     1.024    43.364     0.311     0.837     0.479 
## count_birth_order1/5          0.026     0.018    -0.009     0.062     1.455   158.161     0.148     0.313     0.248 
## count_birth_order2/5          0.024     0.020    -0.015     0.063     1.190    40.196     0.241     0.898     0.498 
## count_birth_order3/5          0.031     0.020    -0.009     0.070     1.517    32.251     0.139     1.120     0.555 
## count_birth_order4/5          0.028     0.017    -0.006     0.061     1.621    74.043     0.109     0.535     0.366 
## count_birth_order5/5          0.035     0.018    -0.001     0.071     1.915    63.631     0.060     0.603     0.395 
## poly(age, 3, raw = TRUE)1     0.006     0.001     0.003     0.008     4.493    65.813     0.000     0.587     0.388 
## poly(age, 3, raw = TRUE)2     0.000     0.000    -0.000     0.000     1.131    46.640     0.264     0.783     0.462 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000    -0.000    -2.108    38.963     0.042     0.925     0.505 
## male                          0.651     0.005     0.641     0.661   124.005    63.649     0.000     0.603     0.395 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.016 
## Residual~~Residual                     0.097 
## ICC|mother_pidlink                     0.142 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-239" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-600-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-59" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2: 243.363       8  18.036   0.000   1.071 
##  2 vs 3: 143.732       3  69.213   0.000   0.441 
##  3 vs 4:  26.080       1  48.566   0.000   0.756 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-29" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-602-1.png" width="672" /></p>
</div>
</div>
<div id="still_smoking" class="section level3 tabset">
<h3>still_smoking</h3>
<pre class="r"><code>data_used = data_used %&gt;% mutate(outcome = still_smoking)
data_used_plots &lt;- data_used[[1]]

compare_birthorder_imputed(data_used = data_used)</code></pre>
<div id="naive-birth-order-30" class="section level4 tabset">
<h4>Naive birth order</h4>
<div id="basic-model-60" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-240" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>### start with naive birthorder
data_used &lt;- data_used %&gt;%
  mutate(sibling_count = sibling_count_naive,
         birth_order_nonlinear = birthorder_naive_factor,
         birth_order = birthorder_naive,
         count_birth_order = count_birthorder_naive)

data_used_plots = data_used[[1]]

model_naive_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))

x = mitml::testEstimates(model_naive_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.759     0.038     0.684     0.833    19.983     9.404     0.000    45.018     0.982 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.741    34.468     0.091     1.045     0.537 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.060    54.476     0.953     0.685     0.427 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.020    50.978     0.984     0.725     0.442 
## male                          0.206     0.024     0.160     0.252     8.770     9.382     0.000    47.658     0.983 
## sibling_count                 0.002     0.003    -0.003     0.008     0.779    18.198     0.446     2.370     0.731 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.186 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-240" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_naive_m1_plot)) # fuer plots</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-604-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-60" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-241" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.759     0.038     0.685     0.833    20.172     9.457     0.000    39.912     0.979 
## birth_order                  -0.000     0.002    -0.005     0.004    -0.043   142.261     0.965     0.336     0.262 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.721    35.313     0.094     1.020     0.531 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.052    52.717     0.959     0.704     0.434 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.025    50.961     0.980     0.725     0.442 
## male                          0.206     0.024     0.160     0.252     8.767     9.381     0.000    47.688     0.983 
## sibling_count                 0.002     0.003    -0.004     0.009     0.701    22.001     0.490     1.775     0.668 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.186 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-241" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_naive_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-606-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-60" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-242" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male +
                                         sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.759     0.039     0.684     0.834    19.710     9.410     0.000    44.406     0.982 
## birth_order_nonlinear2        0.000     0.005    -0.010     0.010     0.020    73.121     0.984     0.540     0.368 
## birth_order_nonlinear3       -0.003     0.006    -0.014     0.008    -0.533  1917.726     0.594     0.074     0.069 
## birth_order_nonlinear4        0.000     0.010    -0.019     0.019     0.024    53.175     0.981     0.699     0.432 
## birth_order_nonlinear5        0.003     0.012    -0.021     0.027     0.255   188.537     0.799     0.280     0.227 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.000    -1.715    34.201     0.095     1.053     0.539 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.042    53.761     0.967     0.692     0.430 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.036    52.128     0.971     0.711     0.437 
## male                          0.206     0.024     0.160     0.252     8.776     9.382     0.000    47.574     0.983 
## sibling_count                 0.002     0.003    -0.004     0.009     0.715    22.033     0.482     1.771     0.668 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.186 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-242" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-608-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-60" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-243" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_naive_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_naive_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_naive_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.757     0.035     0.689     0.825    21.776    10.018     0.000    18.164     0.956 
## count_birth_order2/2          0.006     0.008    -0.009     0.021     0.758    77.957     0.451     0.515     0.356 
## count_birth_order1/3          0.012     0.011    -0.009     0.032     1.087    42.176     0.283     0.859     0.486 
## count_birth_order2/3          0.011     0.010    -0.009     0.030     1.089    66.800     0.280     0.580     0.385 
## count_birth_order3/3          0.007     0.009    -0.011     0.024     0.751   146.062     0.454     0.330     0.258 
## count_birth_order1/4          0.011     0.013    -0.015     0.036     0.815    50.086     0.419     0.736     0.446 
## count_birth_order2/4          0.009     0.012    -0.015     0.033     0.769    72.864     0.444     0.542     0.369 
## count_birth_order3/4          0.009     0.016    -0.022     0.039     0.561    22.770     0.580     1.693     0.658 
## count_birth_order4/4          0.011     0.012    -0.012     0.034     0.939    53.066     0.352     0.700     0.433 
## count_birth_order1/5          0.021     0.017    -0.012     0.054     1.254    39.087     0.217     0.923     0.505 
## count_birth_order2/5          0.007     0.018    -0.028     0.041     0.371    35.789     0.713     1.006     0.527 
## count_birth_order3/5          0.007     0.020    -0.033     0.047     0.331    20.095     0.744     2.023     0.698 
## count_birth_order4/5          0.013     0.019    -0.024     0.050     0.697    23.161     0.492     1.655     0.652 
## count_birth_order5/5          0.017     0.014    -0.011     0.044     1.174    52.245     0.246     0.710     0.436 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.457    62.024     0.150     0.615     0.400 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.034    70.744     0.973     0.554     0.374 
## poly(age, 3, raw = TRUE)3    -0.000     0.000    -0.000     0.000    -0.009    81.459     0.993     0.498     0.348 
## male                          0.207     0.024     0.160     0.253     8.742     9.459     0.000    39.722     0.979 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.185 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-243" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_naive_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_naive_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-610-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-60" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_naive_m1, model_naive_m2, model_naive_m3, model_naive_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_naive_m1, model_naive_m2, model_naive_m3, 
##     model_naive_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  60.827       8   8.925   0.000   2.775 
##  2 vs 3:      NA       3      NA      NA      NA 
##  3 vs 4:      NA       1      NA      NA      NA 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="parental-full-sibling-order-30" class="section level4 tabset active">
<h4>Parental full sibling order</h4>
<div id="basic-model-61" class="section level5 tabset">
<h5>Basic Model</h5>
<div id="model-summary-244" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>data_used = data_used %&gt;%
  mutate(sibling_count = sibling_count_genes,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes)

data_used_plots = data_used[[1]]

model_genes_m1 &lt;- with(data_used, lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m1, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m1, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.761     0.039     0.685     0.837    19.659     9.334     0.000    54.457     0.985 
## poly(age, 3, raw = TRUE)1    -0.001     0.001    -0.003     0.001    -1.419    31.050     0.166     1.166     0.565 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.411    57.120     0.683     0.658     0.417 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.200    49.115     0.842     0.748     0.450 
## male                          0.206     0.023     0.161     0.252     8.861     9.321     0.000    56.552     0.985 
## sibling_count                 0.001     0.004    -0.006     0.008     0.288    13.259     0.778     4.678     0.846 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.184 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-244" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m1_plot = lmer(outcome ~ poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot(allEffects(model_genes_m1_plot))</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-613-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-linear-61" class="section level5 tabset">
<h5>Add Birth Order Linear</h5>
<div id="model-summary-245" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m2 &lt;- with(data_used, lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m2, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m2, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.762     0.040     0.684     0.839    19.237     9.349     0.000    52.069     0.984 
## birth_order                  -0.001     0.003    -0.006     0.004    -0.418    32.374     0.678     1.115     0.554 
## poly(age, 3, raw = TRUE)1    -0.001     0.001    -0.004     0.001    -1.398    28.146     0.173     1.301     0.593 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.402    52.509     0.689     0.706     0.435 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.207    46.120     0.837     0.791     0.464 
## male                          0.206     0.023     0.161     0.252     8.879     9.323     0.000    56.217     0.985 
## sibling_count                 0.002     0.003    -0.005     0.008     0.518    19.123     0.610     2.185     0.714 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.184 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-245" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m2_plot = lmer(outcome ~ birth_order + poly(age, 3, raw = TRUE) + male + sibling_count + (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder2(model_genes_m2_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-615-1.png" width="672" /></p>
</div>
</div>
<div id="add-birth-order-factor-61" class="section level5 tabset">
<h5>Add Birth Order Factor</h5>
<div id="model-summary-246" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m3 &lt;- with(data_used, lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m3, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m3, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.760     0.039     0.684     0.836    19.517     9.361     0.000    50.303     0.984 
## birth_order_nonlinear2        0.000     0.006    -0.011     0.012     0.050    23.751     0.960     1.601     0.644 
## birth_order_nonlinear3       -0.002     0.008    -0.018     0.015    -0.193    22.976     0.849     1.673     0.655 
## birth_order_nonlinear4       -0.004     0.009    -0.022     0.014    -0.446    69.927     0.657     0.559     0.376 
## birth_order_nonlinear5       -0.001     0.016    -0.032     0.030    -0.042    40.431     0.967     0.893     0.496 
## poly(age, 3, raw = TRUE)1    -0.001     0.001    -0.004     0.001    -1.383    28.376     0.177     1.289     0.591 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.404    54.056     0.688     0.689     0.429 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.222    50.106     0.825     0.736     0.446 
## male                          0.206     0.023     0.160     0.252     8.826     9.331     0.000    54.911     0.985 
## sibling_count                 0.002     0.003    -0.004     0.008     0.554    21.459     0.585     1.838     0.676 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.067 
## ICC|mother_pidlink                     0.184 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-246" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m3_plot = lmer(outcome ~ birth_order_nonlinear + poly(age, 3, raw = TRUE) + male + sibling_count +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m3_plot, separate = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-617-1.png" width="672" /></p>
</div>
</div>
<div id="add-interaction-61" class="section level5 tabset active">
<h5>Add Interaction</h5>
<div id="model-summary-247" class="section level6">
<h6>Model Summary</h6>
<pre class="r"><code>model_genes_m4 &lt;- with(data_used, lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male  +
                                         (1 | mother_pidlink)))
x = mitml::testEstimates(model_genes_m4, var.comp = T)

y = as_tibble(x$estimates, rownames = &quot;id&quot;)

y = y %&gt;%
  mutate(CI_low = Estimate - 1.96 * Std.Error,
         CI_high = Estimate + 1.96 * Std.Error) %&gt;%
  select(CI_low, CI_high)
CI_low = y$CI_low
CI_high = y$CI_high


x$estimates = cbind(x$estimates[,1:2], CI_low, CI_high, x$estimates[,3:7])
x</code></pre>
<pre><code>## 
## Call:
## 
## mitml::testEstimates(model = model_genes_m4, var.comp = T)
## 
## Final parameter estimates and inferences obtained from 10 imputed data sets.
## 
##                            Estimate Std.Error    CI_low   CI_high   t.value        df   P(&gt;|t|)       RIV       FMI 
## (Intercept)                   0.762     0.036     0.691     0.834    20.928     9.798     0.000    23.033     0.965 
## count_birth_order2/2          0.003     0.007    -0.012     0.017     0.372    50.040     0.711     0.736     0.446 
## count_birth_order1/3          0.004     0.009    -0.013     0.021     0.438    78.104     0.663     0.514     0.356 
## count_birth_order2/3          0.004     0.009    -0.013     0.022     0.458    46.593     0.649     0.784     0.462 
## count_birth_order3/3          0.003     0.013    -0.022     0.028     0.223    18.879     0.826     2.231     0.719 
## count_birth_order1/4          0.016     0.014    -0.011     0.043     1.151    35.228     0.258     1.022     0.531 
## count_birth_order2/4          0.007     0.014    -0.021     0.034     0.489    25.178     0.629     1.487     0.626 
## count_birth_order3/4          0.002     0.018    -0.034     0.038     0.116    15.457     0.909     3.221     0.789 
## count_birth_order4/4          0.001     0.014    -0.026     0.028     0.068    28.917     0.946     1.262     0.586 
## count_birth_order1/5          0.010     0.020    -0.030     0.050     0.498    27.110     0.622     1.359     0.604 
## count_birth_order2/5          0.015     0.018    -0.021     0.051     0.805    29.430     0.427     1.237     0.581 
## count_birth_order3/5          0.010     0.020    -0.029     0.049     0.492    21.065     0.628     1.887     0.682 
## count_birth_order4/5          0.007     0.016    -0.025     0.039     0.417    36.174     0.679     0.995     0.524 
## count_birth_order5/5          0.007     0.021    -0.035     0.049     0.321    20.182     0.752     2.010     0.696 
## poly(age, 3, raw = TRUE)1    -0.002     0.001    -0.004     0.001    -1.477    70.069     0.144     0.559     0.376 
## poly(age, 3, raw = TRUE)2    -0.000     0.000    -0.000     0.000    -0.417    99.018     0.678     0.432     0.315 
## poly(age, 3, raw = TRUE)3     0.000     0.000    -0.000     0.000     0.339    54.293     0.736     0.687     0.428 
## male                          0.206     0.023     0.161     0.251     8.974     9.429     0.000    42.496     0.981 
## 
##                                     Estimate 
## Intercept~~Intercept|mother_pidlink    0.015 
## Residual~~Residual                     0.066 
## ICC|mother_pidlink                     0.183 
## 
## Unadjusted hypothesis test as appropriate in larger samples.</code></pre>
</div>
<div id="coefficient-plot-247" class="section level6 active">
<h6>Coefficient Plot</h6>
<pre class="r"><code>model_genes_m4_plot = lmer(outcome ~ count_birth_order + poly(age, 3, raw = TRUE) + male +
                             (1 | mother_pidlink),
                           data = data_used_plots)
plot_birthorder(model_genes_m4_plot)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-619-1.png" width="672" /></p>
</div>
</div>
<div id="model-comparison-61" class="section level5">
<h5>Model Comparison</h5>
<pre class="r"><code>anova(model_genes_m1, model_genes_m2, model_genes_m3, model_genes_m4)</code></pre>
<pre><code>## 
## Call:
## 
## anova.mitml.result(object = model_genes_m1, model_genes_m2, model_genes_m3, 
##     model_genes_m4)
## 
## Model comparison calculated from 10 imputed data sets.
## Combination method: D2 (likelihood) 
## 
## Model 1: outcome~count_birth_order+poly(age,3,raw=TRUE)+male+(1|mother_pidlink)
## Model 2: outcome~birth_order_nonlinear+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 3: outcome~birth_order+poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## Model 4: outcome~poly(age,3,raw=TRUE)+male+sibling_count+(1|mother_pidlink)
## 
##          F.value     df1     df2   P(&gt;F)     RIV 
##  1 vs 2:  31.450       8   6.291   0.000   7.036 
##  2 vs 3:  23.257       3  10.158   0.000   3.957 
##  3 vs 4:      NA       1      NA      NA      NA 
## 
## Models originally fit with REML were automatically refit using ML.</code></pre>
</div>
</div>
<div id="compare-birth-order-specifications-30" class="section level4">
<h4>Compare birth order specifications</h4>
<pre class="r"><code>library(coefplot)
multiplot(model_naive_m2_plot, model_genes_m2_plot, intercept = FALSE)</code></pre>
<p><img src="4_analyses_imputed_data_robust_files/figure-html/unnamed-chunk-621-1.png" width="672" /></p>
</div>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCm91dHB1dDogaHRtbF9kb2N1bWVudAplZGl0b3Jfb3B0aW9uczogCiAgY2h1bmtfb3V0cHV0X3R5cGU6IGNvbnNvbGUKLS0tCiMgPHNwYW4gc3R5bGU9ImNvbG9yOiNBNkQ4NTQiPkJpcnRoIE9yZGVyIEVmZmVjdHM8L3NwYW4+IHsudGFic2V0fQoKIyMgSGVscGVyCmBgYHtyIGhlbHBlcn0Kc291cmNlKCIwX2hlbHBlcnMuUiIpCm9wdHNfY2h1bmskc2V0KHdhcm5pbmcgPSBGQUxTRSkKYGBgCgoKIyMgRnVuY3Rpb25zCgpgYGB7cn0KCm5faW1wdXRhdGlvbnMubWl0bWwgPSBmdW5jdGlvbihpbXBzKSB7CiAgaW1wcyRpdGVyJG0KfQpuX2ltcHV0YXRpb25zLm1pZHMgPSBmdW5jdGlvbihpbXBzKSB7CiAgaW1wcyRtCn0Kbl9pbXB1dGF0aW9ucy5hbWVsaWEgPSBmdW5jdGlvbihpbXBzKSB7CiAgbGVuZ3RoKGltcHMkaW1wdXRhdGlvbnMpCn0Kbl9pbXB1dGF0aW9ucyA9IGZ1bmN0aW9uKGltcHMpIHsgVXNlTWV0aG9kKCJuX2ltcHV0YXRpb25zIikgfQoKY29tcGxldGUubWl0bWwgPSBtaXRtbDo6bWl0bWxDb21wbGV0ZQpjb21wbGV0ZS5taWRzID0gbWljZTo6Y29tcGxldGUKY29tcGxldGUgPSBmdW5jdGlvbiguLi4pIHsgVXNlTWV0aG9kKCJjb21wbGV0ZSIpIH0KCmxpYnJhcnkobWljZSkKbGlicmFyeShtaWNlYWRkcykKbGlicmFyeShtaXRtbCkKYGBgCgoKIyMgTG9hZCBkYXRhCmBgYHtyIExvYWQgRGF0YX0KYmlydGhvcmRlciA9IHJlYWRSRFMoImRhdGEvYWxsZGF0YV9iaXJ0aG9yZGVyX2lfbWwucmRzIikKYGBgCgojIyBEYXRhIHByZXBhcmF0aW9ucwpgYGB7ciBkYXRhIHByZXBhcmF0aW9uc30KYmlydGhvcmRlciA8LSBtaWRzMm1pdG1sLmxpc3QoYmlydGhvcmRlcikKCiMjIENhbGN1bGF0ZSBnX2ZhY3RvcnMgKGZvciBub3cgd2l0aCByb3dNZWFuczogYmV0dGVyIHRvIHJ1biBmYWN0b3IgYW5hbHlzaXMgaGVyZSBhcyB3ZWxsPykKYmlydGhvcmRlciA8LSB3aXRoaW4oYmlydGhvcmRlciwgewogIGdfZmFjdG9yXzIwMTVfb2xkIDwtIHJvd01lYW5zKHNjYWxlKGNiaW5kKHJhdmVuXzIwMTVfb2xkLCBtYXRoXzIwMTVfb2xkLCBjb3VudF9iYWNrd2FyZHMsICB3b3Jkc19kZWxheWVkLCBhZGFwdGl2ZV9udW1iZXJpbmcpKSkKfSkKCmJpcnRob3JkZXIgPC0gd2l0aGluKGJpcnRob3JkZXIsIHsKICBnX2ZhY3Rvcl8yMDE1X3lvdW5nIDwtIHJvd01lYW5zKHNjYWxlKGNiaW5kKHJhdmVuXzIwMTVfeW91bmcsIG1hdGhfMjAxNV95b3VuZykpKQp9KQoKYmlydGhvcmRlciA8LSB3aXRoaW4oYmlydGhvcmRlciwgewogIGdfZmFjdG9yXzIwMDdfb2xkIDwtIHJvd01lYW5zKHNjYWxlKGNiaW5kKHJhdmVuXzIwMDdfb2xkLCBtYXRoXzIwMDdfb2xkKSkpCn0pCgpiaXJ0aG9yZGVyIDwtIHdpdGhpbihiaXJ0aG9yZGVyLCB7CiAgZ19mYWN0b3JfMjAwN195b3VuZyA8LSByb3dNZWFucyhzY2FsZShjYmluZChyYXZlbl8yMDA3X3lvdW5nLCBtYXRoXzIwMDdfeW91bmcpKSkKfSkKCgpiaXJ0aG9yZGVyID0gYmlydGhvcmRlciAlPiUgdGJsX2RmLm1pdG1sLmxpc3QKCiMjIyBCaXJ0aG9yZGVyIGFuZCBTaWJsaW5nIENvdW50CiMgZm9yIGZhY3RvciB2YXJpYWJsZXMgd2UgaGF2ZSB0byByb3VuZCBiaXJ0aCBvcmRlciBwb3NpdGlvbiBhbmQgZWxpbWluYXRlIGFsbCB1bmxpa2VseSBudW1iZXJzIChuZWdhdGl2ZSBvbmVzKQpiaXJ0aG9yZGVyX2RhdGEgPSBiaXJ0aG9yZGVyW1sxXV0KCmJpcnRob3JkZXIgPSBiaXJ0aG9yZGVyICU+JQogIG11dGF0ZShiaXJ0aG9yZGVyX2dlbmVzID0gaWZlbHNlKGJpcnRob3JkZXJfZ2VuZXMgPCAwLCAwLCBiaXJ0aG9yZGVyX2dlbmVzKSwKICAgICAgICAgYmlydGhvcmRlcl9uYWl2ZSA9IGlmZWxzZShiaXJ0aG9yZGVyX25haXZlIDwgMCwgMCwgYmlydGhvcmRlcl9uYWl2ZSksCiAgICAgICAgIGJpcnRob3JkZXJfZ2VuZXMgPSByb3VuZChiaXJ0aG9yZGVyX2dlbmVzKSwKICAgICAgICAgYmlydGhvcmRlcl9uYWl2ZSA9IHJvdW5kKGJpcnRob3JkZXJfbmFpdmUpLAogICAgICAgICBzaWJsaW5nX2NvdW50X2dlbmVzID0gaWZlbHNlKHNpYmxpbmdfY291bnRfZ2VuZXMgPCAwLCAwLCBzaWJsaW5nX2NvdW50X2dlbmVzKSwKICAgICAgICAgc2libGluZ19jb3VudF9uYWl2ZSA9IGlmZWxzZShzaWJsaW5nX2NvdW50X25haXZlIDwgMCwgMCwgc2libGluZ19jb3VudF9uYWl2ZSksCiAgICAgICAgIHNpYmxpbmdfY291bnRfZ2VuZXMgPSByb3VuZChzaWJsaW5nX2NvdW50X2dlbmVzKSwKICAgICAgICAgc2libGluZ19jb3VudF9uYWl2ZSA9IHJvdW5kKHNpYmxpbmdfY291bnRfbmFpdmUpLAogICAgICAgICBiaXJ0aG9yZGVyX2dlbmVzID0gaWZlbHNlKGJpcnRob3JkZXJfZ2VuZXMgPiA1LCBOQSwgYmlydGhvcmRlcl9nZW5lcyksCiAgICAgICAgIGJpcnRob3JkZXJfbmFpdmUgPSBpZmVsc2UoYmlydGhvcmRlcl9uYWl2ZSA+IDUsIE5BLCBiaXJ0aG9yZGVyX25haXZlKSwKICAgICAgICAgc2libGluZ19jb3VudF9nZW5lcyA9IGlmZWxzZShzaWJsaW5nX2NvdW50X2dlbmVzID4gNSwgTkEsIHNpYmxpbmdfY291bnRfZ2VuZXMpLAogICAgICAgICBzaWJsaW5nX2NvdW50X25haXZlID0gaWZlbHNlKHNpYmxpbmdfY291bnRfbmFpdmUgPiA1LCBOQSwgc2libGluZ19jb3VudF9uYWl2ZSkpCgoKYmlydGhvcmRlciA9IGJpcnRob3JkZXIgJT4lIAogIG11dGF0ZSgKIyBiaXJ0aG9yZGVyIGFzIGZhY3RvcnMgd2l0aCBsZXZlbHMgb2YgMSwgMiwgMywgNCwgNSwgNSsKICAgIGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yID0gYXMuY2hhcmFjdGVyKGJpcnRob3JkZXJfbmFpdmUpLAogICAgYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IgPSBmYWN0b3IoYmlydGhvcmRlcl9uYWl2ZV9mYWN0b3IsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjEiLCIyIiwiMyIsIjQiLCI1IikpLAogICAgc2libGluZ19jb3VudF9uYWl2ZV9mYWN0b3IgPSBhcy5jaGFyYWN0ZXIoc2libGluZ19jb3VudF9uYWl2ZSksCiAgICBzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciA9IGZhY3RvcihzaWJsaW5nX2NvdW50X25haXZlX2ZhY3RvciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gYygiMiIsIjMiLCI0IiwiNSIpKSwKICAgIGJpcnRob3JkZXJfZ2VuZXNfZmFjdG9yID0gYXMuY2hhcmFjdGVyKGJpcnRob3JkZXJfZ2VuZXMpLAogICAgYmlydGhvcmRlcl9nZW5lc19mYWN0b3IgPSBmYWN0b3IoYmlydGhvcmRlcl9nZW5lc19mYWN0b3IsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gYygiMSIsIjIiLCIzIiwiNCIsIjUiKSksCiAgICBzaWJsaW5nX2NvdW50X2dlbmVzX2ZhY3RvciA9IGFzLmNoYXJhY3RlcihzaWJsaW5nX2NvdW50X2dlbmVzKSwKICAgIHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yID0gZmFjdG9yKHNpYmxpbmdfY291bnRfZ2VuZXNfZmFjdG9yLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoIjIiLCIzIiwiNCIsIjUiKSksCiAgICAjIGludGVyYWN0aW9uIGJpcnRob3JkZXIgKiBzaWJsaW5nY291dCBmb3IgZWFjaCBiaXJ0aG9yZGVyCiAgICBjb3VudF9iaXJ0aG9yZGVyX25haXZlID0KICAgICAgZmFjdG9yKHN0cl9yZXBsYWNlKGFzLmNoYXJhY3RlcihpbnRlcmFjdGlvbihiaXJ0aG9yZGVyX25haXZlX2ZhY3RvciwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpYmxpbmdfY291bnRfbmFpdmVfZmFjdG9yKSksCiAgICAgICAgICAgICAgICAgICAgICAgICJcXC4iLCAiLyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWxzID0gICBjKCIxLzIiLCIyLzIiLCAiMS8zIiwgICIyLzMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIzLzMiLCAiMS80IiwgIjIvNCIsICIzLzQiLCAiNC80IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMS81IiwgIjIvNSIsICIzLzUiLCAiNC81IiwgIjUvNSIpKSwKICAgIGNvdW50X2JpcnRob3JkZXJfZ2VuZXMgPQogICAgICBmYWN0b3Ioc3RyX3JlcGxhY2UoYXMuY2hhcmFjdGVyKGludGVyYWN0aW9uKGJpcnRob3JkZXJfZ2VuZXNfZmFjdG9yLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2libGluZ19jb3VudF9nZW5lc19mYWN0b3IpKSwgIlxcLiIsICIvIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSAgIGMoIjEvMiIsIjIvMiIsICIxLzMiLCAgIjIvMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjMvMyIsICIxLzQiLCAiMi80IiwgIjMvNCIsICI0LzQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIxLzUiLCAiMi81IiwgIjMvNSIsICI0LzUiLCAiNS81IikpKQoKCgojIyMgVmFyaWFibGVzCgpiaXJ0aG9yZGVyID0gYmlydGhvcmRlciAlPiUKICBtdXRhdGUoCiAgICBnX2ZhY3Rvcl8yMDE1X29sZCA9IChnX2ZhY3Rvcl8yMDE1X29sZCAtIG1lYW4oZ19mYWN0b3JfMjAxNV9vbGQsIG5hLnJtPVQpKSAvIHNkKGdfZmFjdG9yXzIwMTVfb2xkLCBuYS5ybT1UKSwKICAgIGdfZmFjdG9yXzIwMTVfeW91bmcgPSAoZ19mYWN0b3JfMjAxNV95b3VuZyAtIG1lYW4oZ19mYWN0b3JfMjAxNV95b3VuZywgbmEucm09VCkpIC8gc2QoZ19mYWN0b3JfMjAxNV95b3VuZywgbmEucm09VCksCiAgICBnX2ZhY3Rvcl8yMDA3X29sZCA9IChnX2ZhY3Rvcl8yMDA3X29sZCAtIG1lYW4oZ19mYWN0b3JfMjAwN19vbGQsIG5hLnJtPVQpKSAvIHNkKGdfZmFjdG9yXzIwMDdfb2xkLCBuYS5ybT1UKSwKZ19mYWN0b3JfMjAwN195b3VuZyA9IChnX2ZhY3Rvcl8yMDA3X3lvdW5nIC0gbWVhbihnX2ZhY3Rvcl8yMDA3X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChnX2ZhY3Rvcl8yMDA3X3lvdW5nLCBuYS5ybT1UKSwKICAgIHJhdmVuXzIwMTVfb2xkID0gKHJhdmVuXzIwMTVfb2xkIC0gbWVhbihyYXZlbl8yMDE1X29sZCwgbmEucm09VCkpIC8gc2QocmF2ZW5fMjAxNV9vbGQpLAogICAgbWF0aF8yMDE1X29sZCA9IChtYXRoXzIwMTVfb2xkIC0gbWVhbihtYXRoXzIwMTVfb2xkLCBuYS5ybT1UKSkgLyBzZChtYXRoXzIwMTVfb2xkLCBuYS5ybT1UKSwKICAgIHJhdmVuXzIwMTVfeW91bmcgPSAocmF2ZW5fMjAxNV95b3VuZyAtIG1lYW4ocmF2ZW5fMjAxNV95b3VuZywgbmEucm09VCkpIC8gc2QocmF2ZW5fMjAxNV95b3VuZyksCiAgICBtYXRoXzIwMTVfeW91bmcgPSAobWF0aF8yMDE1X3lvdW5nIC0gbWVhbihtYXRoXzIwMTVfeW91bmcsIG5hLnJtPVQpKSAvCiAgICAgIHNkKG1hdGhfMjAxNV95b3VuZywgbmEucm09VCksCiAgICByYXZlbl8yMDA3X29sZCA9IChyYXZlbl8yMDA3X29sZCAtIG1lYW4ocmF2ZW5fMjAwN19vbGQsIG5hLnJtPVQpKSAvIHNkKHJhdmVuXzIwMDdfb2xkKSwKbWF0aF8yMDA3X29sZCA9IChtYXRoXzIwMDdfb2xkIC0gbWVhbihtYXRoXzIwMDdfb2xkLCBuYS5ybT1UKSkgLyBzZChtYXRoXzIwMDdfb2xkLCBuYS5ybT1UKSwKcmF2ZW5fMjAwN195b3VuZyA9IChyYXZlbl8yMDA3X3lvdW5nIC0gbWVhbihyYXZlbl8yMDA3X3lvdW5nLCBuYS5ybT1UKSkgLyBzZChyYXZlbl8yMDA3X3lvdW5nKSwKbWF0aF8yMDA3X3lvdW5nID0gKG1hdGhfMjAwN195b3VuZyAtIG1lYW4obWF0aF8yMDA3X3lvdW5nLCBuYS5ybT1UKSkgLwogIHNkKG1hdGhfMjAwN195b3VuZywgbmEucm09VCksCiAgICBjb3VudF9iYWNrd2FyZHMgPSAoY291bnRfYmFja3dhcmRzIC0gbWVhbihjb3VudF9iYWNrd2FyZHMsIG5hLnJtPVQpKSAvCiAgICAgIHNkKGNvdW50X2JhY2t3YXJkcywgbmEucm09VCksCiAgICB3b3Jkc19kZWxheWVkID0gKHdvcmRzX2RlbGF5ZWQgLSBtZWFuKHdvcmRzX2RlbGF5ZWQsIG5hLnJtPVQpKSAvCiAgICAgIHNkKHdvcmRzX2RlbGF5ZWQsIG5hLnJtPVQpLAogICAgYWRhcHRpdmVfbnVtYmVyaW5nID0gKGFkYXB0aXZlX251bWJlcmluZyAtIG1lYW4oYWRhcHRpdmVfbnVtYmVyaW5nLCBuYS5ybT1UKSkgLwogICAgICBzZChhZGFwdGl2ZV9udW1iZXJpbmcsIG5hLnJtPVQpLAogICAgYmlnNV9leHQgPSAoYmlnNV9leHQgLSBtZWFuKGJpZzVfZXh0LCBuYS5ybT1UKSkgLyBzZChiaWc1X2V4dCwgbmEucm09VCksCiAgICBiaWc1X2NvbiA9IChiaWc1X2NvbiAtIG1lYW4oYmlnNV9jb24sIG5hLnJtPVQpKSAvIHNkKGJpZzVfY29uLCBuYS5ybT1UKSwKICAgIGJpZzVfYWdyZWUgPSAoYmlnNV9hZ3JlZSAtIG1lYW4oYmlnNV9hZ3JlZSwgbmEucm09VCkpIC8gc2QoYmlnNV9hZ3JlZSwgbmEucm09VCksCiAgICBiaWc1X29wZW4gPSAoYmlnNV9vcGVuIC0gbWVhbihiaWc1X29wZW4sIG5hLnJtPVQpKSAvIHNkKGJpZzVfb3BlbiwgbmEucm09VCksCiAgICBiaWc1X25ldSA9IChiaWc1X25ldSAtIG1lYW4oYmlnNV9uZXUsIG5hLnJtPVQpKSAvIHNkKGJpZzVfbmV1LCBuYS5ybT1UKSwKICAgIHJpc2tBID0gKHJpc2tBIC0gbWVhbihyaXNrQSwgbmEucm09VCkpIC8gc2Qocmlza0EsIG5hLnJtPVQpLAogICAgcmlza0IgPSAocmlza0IgLSBtZWFuKHJpc2tCLCBuYS5ybT1UKSkgLyBzZChyaXNrQiwgbmEucm09VCksCiAgICB5ZWFyc19vZl9lZHVjYXRpb25feiA9ICh5ZWFyc19vZl9lZHVjYXRpb24gLSBtZWFuKHllYXJzX29mX2VkdWNhdGlvbiwgbmEucm09VCkpIC8KICAgICAgc2QoeWVhcnNfb2ZfZWR1Y2F0aW9uLCBuYS5ybT1UKSwKICAgIHdhZ2VfbGFzdF9tb250aF96ID0gKHdhZ2VfbGFzdF9tb250aF9sb2cgLSBtZWFuKHdhZ2VfbGFzdF9tb250aF9sb2csIG5hLnJtPVQpKSAvCiAgICAgIHNkKHdhZ2VfbGFzdF9tb250aF9sb2csIG5hLnJtPVQpLAogICAgd2FnZV9sYXN0X3llYXJfeiA9ICh3YWdlX2xhc3RfeWVhcl9sb2cgLSBtZWFuKHdhZ2VfbGFzdF95ZWFyX2xvZywgbmEucm09VCkpIC8KICAgICAgc2Qod2FnZV9sYXN0X3llYXJfbG9nLCBuYS5ybT1UKSwKICAgIGF0dGVuZGVkX3NjaG9vbCA9IGFzLmludGVnZXIoYXR0ZW5kZWRfc2Nob29sKSwKICAgIGF0dGVuZGVkX3NjaG9vbCA9IGlmZWxzZShhdHRlbmRlZF9zY2hvb2wgPT0gMSwgMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGF0dGVuZGVkX3NjaG9vbCA9PSAyLCAxLCBOQSkpKQpkYXRhX3VzZWQgPC0gYmlydGhvcmRlciAlPiUKICBtdXRhdGUoc2libGluZ19jb3VudCA9IHNpYmxpbmdfY291bnRfbmFpdmUsCiAgICAgICAgIGJpcnRoX29yZGVyX25vbmxpbmVhciA9IGJpcnRob3JkZXJfbmFpdmVfZmFjdG9yLAogICAgICAgICBiaXJ0aF9vcmRlciA9IGJpcnRob3JkZXJfbmFpdmUsCiAgICAgICAgIGNvdW50X2JpcnRoX29yZGVyID0gY291bnRfYmlydGhvcmRlcl9uYWl2ZSkKCmBgYAoKIyMgSW50ZWxsaWdlbmNlIHsuYWN0aXZlIC50YWJzZXR9CiMjIyBnLWZhY3RvciAyMDE1IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBnX2ZhY3Rvcl8yMDE1X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgUmF2ZW4gMjAxNSBvbGQgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gcmF2ZW5fMjAxNV9vbGQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgTnVtZXJhY3kgMjAxNSBvbGQgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gbWF0aF8yMDE1X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBDb3VudGluZyBCYWNrd2FyZHMgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gY291bnRfYmFja3dhcmRzKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIERlbGF5ZWQgV29yZCBSZWNhbGwgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gd29yZHNfZGVsYXllZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgQWRhcHRpdmUgTnVtYmVyaW5nIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGFkYXB0aXZlX251bWJlcmluZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoKIyMjIGctZmFjdG9yIDIwMTUgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gZ19mYWN0b3JfMjAxNV95b3VuZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgUmF2ZW4gMjAxNSB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByYXZlbl8yMDE1X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIE51bWVyYWN5IDIwMTUgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gbWF0aF8yMDE1X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIGctZmFjdG9yIDIwMDcgb2xkIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGdfZmFjdG9yXzIwMDdfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBSYXZlbiAyMDA3IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByYXZlbl8yMDA3X29sZCkKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIyBOdW1lcmFjeSAyMDA3IG9sZCB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBtYXRoXzIwMDdfb2xkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIGctZmFjdG9yIDIwMDcgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gZ19mYWN0b3JfMjAwN195b3VuZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCgojIyMgUmF2ZW4gMjAwNyB5b3VuZyB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByYXZlbl8yMDA3X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIE51bWVyYWN5IDIwMDcgeW91bmcgey50YWJzZXR9CgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gbWF0aF8yMDA3X3lvdW5nKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMgUGVyc29uYWxpdHkgey50YWJzZXR9CgojIyMgRXh0cmF2ZXJzaW9uIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfZXh0KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBOZXVyb3RpY2lzbSB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSBiaWc1X25ldSkKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIENvbnNjaWVudGlvdXNuZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfbmV1KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCiMjIyBBZ3JlZWFibGVuZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfYWdyZWUpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIE9wZW5uZXNzIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGJpZzVfb3BlbikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIFJpc2twcmVmZXJlbmNlIHsudGFic2V0fQojIyMgUmlzayBBIHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHJpc2tBKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIFJpc2sgQiB7LnRhYnNldH0KCmBgYHtyfQojIFNwZWNpZnkgeW91ciBvdXRjb21lCmRhdGFfdXNlZCA9IGRhdGFfdXNlZCAlPiUgbXV0YXRlKG91dGNvbWUgPSByaXNrQikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCgpgYGAKCiMjIEVkdWNhdGlvbmFsIEF0dGFpbm1lbnQgey50YWJzZXR9CiMjIyBZZWFycyBvZiBFZHVjYXRpb24gLSB6LXN0YW5kYXJkaXplZHsudGFic2V0fQoKYGBge3J9CiMgU3BlY2lmeSB5b3VyIG91dGNvbWUKZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHllYXJzX29mX2VkdWNhdGlvbl96KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIGVsZW1lbnRhcnlfbWlzc2VkCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gRWxlbWVudGFyeV9taXNzZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgoKIyMjIGVsZW1lbnRhcnlfd29ya2VkCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gRWxlbWVudGFyeV93b3JrZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQoKYGBgCgojIyMgYXR0ZW5kZWRfc2Nob29sCgpgYGB7cn0KIyBTcGVjaWZ5IHlvdXIgb3V0Y29tZQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gYXR0ZW5kZWRfc2Nob29sKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKCgojIyBXb3JrIHsudGFic2V0fQoKIyMjIEluY29tZSBMYXN0IE1vbnRoIChsb2cpIC0gei1zdGFuZGFyZGl6ZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IHdhZ2VfbGFzdF9tb250aF96KQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKCmBgYAoKIyMjIEluY29tZSBsYXN0IHllYXIgKGxvZykgLSB6LXN0YW5kYXJkaXplZCB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gd2FnZV9sYXN0X3llYXJfeikKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoKIyMjIFNlbGYtRW1wbG95bWVudCAtIG5vbiBzdGFuZGFyZGl6ZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IFNlbGZfZW1wbG95ZWQpCmRhdGFfdXNlZF9wbG90cyA8LSBkYXRhX3VzZWRbWzFdXQoKY29tcGFyZV9iaXJ0aG9yZGVyX2ltcHV0ZWQoZGF0YV91c2VkID0gZGF0YV91c2VkKQpgYGAKCiMjIFNtb2tpbmcgQmVoYXZpb3VyIHsudGFic2V0fQojIyMgZXZlcl9zbW9rZWQgey50YWJzZXR9CgpgYGB7cn0KZGF0YV91c2VkID0gZGF0YV91c2VkICU+JSBtdXRhdGUob3V0Y29tZSA9IGV2ZXJfc21va2VkKQpkYXRhX3VzZWRfcGxvdHMgPC0gZGF0YV91c2VkW1sxXV0KCmNvbXBhcmVfYmlydGhvcmRlcl9pbXB1dGVkKGRhdGFfdXNlZCA9IGRhdGFfdXNlZCkKYGBgCgojIyMgc3RpbGxfc21va2luZyB7LnRhYnNldH0KCmBgYHtyfQpkYXRhX3VzZWQgPSBkYXRhX3VzZWQgJT4lIG11dGF0ZShvdXRjb21lID0gc3RpbGxfc21va2luZykKZGF0YV91c2VkX3Bsb3RzIDwtIGRhdGFfdXNlZFtbMV1dCgpjb21wYXJlX2JpcnRob3JkZXJfaW1wdXRlZChkYXRhX3VzZWQgPSBkYXRhX3VzZWQpCmBgYAoK</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
