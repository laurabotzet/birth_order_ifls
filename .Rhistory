### Birth Order
alldata_birthorder %>%
filter(birthorder_uterus_alive<6) %>%
ggplot(aes(x=birthorder_uterus_alive, y=g_factor)) + geom_jitter() + geom_smooth(method=lm)
table(alldata_birthorder$sibling_count_uterus_alive)
alldata_birthorder %>%
filter(birthorder_uterus_alive<8) %>%
filter(sibling_count_uterus_alive<8) %>%
ggplot(aes(x=birthorder_uterus_alive, y=g_factor)) +
facet_wrap(~ sibling_count_uterus_alive) +
geom_jitter() + geom_smooth(method=lm)
alldata_birthorder %>% select(birthorder_uterus_alive, sibling_count_uterus_alive, birthdate) -> subs
alldata_birthorder$byear = as.numeric(stringr::str_sub(alldata_birthorder$birthdate,1,4))
alldata_birthorder %>%
filter(birthorder_uterus_alive < 8) %>%
filter(sibling_count_uterus_alive < 8) %>%
mutate(birthorder_uterus_alive = factor(birthorder_uterus_alive, levels = c("1","2","3","4","5","6", "7", "8")),
sibling_count_uters_alive = factor(sibling_count_uterus_alive)) %>%
ggplot(aes(x=birthorder_uterus_alive, y=g_factor, colour = sibling_count_uterus_alive, group = sibling_count_uterus_alive)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
alldata_birthorder %>%
filter(birthorder_uterus_alive < 8) %>%
filter(sibling_count_uterus_alive < 8) %>%
mutate(birthorder_uterus_alive = factor(birthorder_uterus_alive,levels = c("1","2","3","4","5","6", "7", "8")),
sibling_count_uters_alive = sibling_count_uterus_alive) %>%
ggplot(aes(x=birthorder_uterus_alive, y=big5_open, colour = sibling_count_uterus_alive, group = sibling_count_uterus_alive)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
alldata_birthorder %>%
filter(birthorder_uterus_alive < 8) %>%
filter(sibling_count_uterus_alive < 8) %>%
mutate(birthorder_uterus_alive = factor(birthorder_uterus_alive, levels = c("1","2","3","4","5","6", "7", "8")),
sibling_count_uters_alive = sibling_count_uterus_alive) %>%
ggplot(aes(x=birthorder_uterus_alive, y=big5_ext, colour = sibling_count_uterus_alive, group = sibling_count_uterus_alive)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
### Genes:
alldata_birthorder %>%
filter(birthorder_genes < 8) %>%
filter(sibling_count_genes < 8) %>%
mutate(birthorder_genes = factor(birthorder_genes),
sibling_count_genes = sibling_count_genes) %>%
ggplot(aes(x=birthorder_genes, y=g_factor, colour = sibling_count_genes, group = sibling_count_genes)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
alldata_birthorder %>%
filter(birthorder_genes < 8) %>%
filter(sibling_count_genes < 8) %>%
mutate(birthorder_genes = factor(birthorder_genes),
sibling_count_genes = sibling_count_genes) %>%
ggplot(aes(x=birthorder_genes, y=big5_open, colour = sibling_count_genes, group = sibling_count_genes)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
alldata_birthorder %>%
filter(birthorder_uterus_alive < 8) %>%
filter(sibling_count_uterus_alive < 8) %>%
mutate(birthorder_uterus_alive = factor(birthorder_uterus_alive),
sibling_count_uters_alive = sibling_count_uterus_alive) %>%
ggplot(aes(x=birthorder_uterus_alive, y=big5_ext, colour = sibling_count_uterus_alive, group = sibling_count_uterus_alive)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
```
## Save data
for future analyses
```{r save data}
saveRDS(alldata_birthorder, file = "data/alldata_birthorder.rds")
saveRDS(alldata, file = "data/alldata.rds")
```
alldata_birthorder %>%
filter(birthorder_uterus_alive < 8) %>%
filter(sibling_count_uterus_alive < 8) %>%
mutate(birthorder_uterus_alive = factor(birthorder_uterus_alive, levels = 1:7),
sibling_count_uters_alive = sibling_count_uterus_alive) %>%
ggplot(aes(x=birthorder_uterus_alive, y=big5_ext, colour = sibling_count_uterus_alive, group = sibling_count_uterus_alive)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
alldata_birthorder %>%
filter(birthorder_uterus_alive < 8) %>%
filter(sibling_count_uterus_alive < 8) %>%
mutate(birthorder_uterus_alive = factor(birthorder_uterus_alive, levels = 1:7),
sibling_count_uters_alive = factor(sibling_count_uterus_alive, levels = 1:7)) %>%
ggplot(aes(x=birthorder_uterus_alive, y=big5_ext, colour = sibling_count_uterus_alive, group = sibling_count_uterus_alive)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
alldata_birthorder %>%
filter(birthorder_uterus_alive < 8) %>%
filter(sibling_count_uterus_alive < 8) %>%
mutate(birthorder_uterus_alive = factor(birthorder_uterus_alive, levels = c("1","2","3","4","5","6", "7", "8")),
sibling_count_uters_alive = factor(sibling_count_uterus_alive)) %>%
ggplot(aes(x=birthorder_uterus_alive, y=g_factor, colour = sibling_count_uterus_alive, group = sibling_count_uterus_alive)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
m1m = lmer(riskA ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
library(dplyr)
library(lme4)
library(effects)
m1m = lmer(riskA ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
alldata_birthorder = readRDS("data/alldata_birthorder.rds")
qplot(alldata_birthorder$byear,binwidth = 1)
qplot(alldata_birthorder$age,binwidth = 1)
crosstabs(alldata_birthorder$sex.x + alldata_birthorder$sex.y)
qplot(alldata_birthorder$birthorder_uterus_alive, binwidth = 1)
alldata_birthorder = alldata_birthorder %>%
mutate(
birthorder_uterus_alive_factor = as.character(birthorder_uterus_alive),
birthorder_uterus_alive_factor = ifelse(birthorder_uterus_alive > 5, "5+", birthorder_uterus_alive_factor),
birthorder_uterus_alive_factor = factor(birthorder_uterus_alive_factor, levels = c("1","2","3","4","5","5+")),
sibling_count_uterus_alive_factor = as.character(sibling_count_uterus_alive),
sibling_count_uterus_alive_factor = ifelse(sibling_count_uterus_alive > 5, "5+", sibling_count_uterus_alive_factor),
sibling_count_uterus_alive_factor = factor(sibling_count_uterus_alive_factor, levels = c("1","2","3","4","5","5+")),
birthorder_genes_factor = as.character(birthorder_genes),
birthorder_genes_factor = ifelse(birthorder_genes >5 , "5+", birthorder_genes_factor),
birthorder_genes_factor = factor(birthorder_genes_factor, levels = c("1","2","3","4","5","5+")),
sibling_count_genes_factor = as.character(sibling_count_genes),
sibling_count_genes_factor = ifelse(sibling_count_genes >5 , "5+", sibling_count_genes_factor),
sibling_count_genes_factor = factor(sibling_count_genes_factor, levels = c("1","2","3","4","5","5+")))
crosstabs(~ sibling_count_uterus_alive_factor + birthorder_uterus_alive_factor, data = alldata_birthorder)
crosstabs(~ sibling_count_genes_factor + birthorder_genes_factor, data = alldata_birthorder)
alldata_birthorder$sex = factor(ifelse(alldata_birthorder$sex.x==1, "male", "female"))
# remove only children?
no_only_children_uterus = alldata_birthorder %>% filter(as.numeric(sibling_count_uterus_alive) > 1)
crosstabs(~ sibling_count_uterus_alive_factor + birthorder_uterus_alive_factor, data = no_only_children_uterus)
no_only_children_genes = alldata_birthorder %>% filter(as.numeric(sibling_count_genes) > 1)
crosstabs(~ sibling_count_genes_factor + birthorder_genes_factor, data = no_only_children_genes)
no_only_children_genes = alldata_birthorder %>% filter(as.numeric(as.character(sibling_count_genes)) > 1)
crosstabs(~ sibling_count_genes_factor + birthorder_genes_factor, data = no_only_children_genes)
m1m = lmer(riskA ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
plot(allEffects(m1m))
traceback()
no_only_children_uterus$interaction = interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor)
table(no_only_children_uterus$interaction)
table(no_only_children_uterus$interaction, exclude = NULL)
no_only_children_uterus$interaction = droplevels(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor))
table(no_only_children_uterus$interaction, exclude = NULL)
m1m = lmer(riskA ~ gender + age + byear + interaction + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
plot(allEffects(m1m))
levels(no_only_children_uterus$sibling_count_uterus_alive_factor)
levels(no_only_children_uterus$birthorder_count_uterus_alive_factor)
levels(no_only_children_uterus$birthorder_uterus_alive_factor)
m1m = lmer(riskA ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
plot(allEffects(m1m))
library(sjPlot)
sjp.int(m1m)
detach("package:sjPlot", unload=TRUE)
library("lsmeans", lib.loc="/usr/local/lib/R/site-library")
lsmeans(m1m)
lsmeans(m1m, ~ birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor)
emm = lsmeans(m1m, ~ birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor)
str(emm)
emm@grid
plot(emm)
as.data.frame(emm)
emm@linfct
emm@post.beta
emm@nbasis
library(brms)
confint(emm)
xxx = .Last.value
cemm = xxx
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.Cl, ymin = lower.CL, colour = sibling_count_uterus_alive_factor)) + geom_pointrange(stat = "identity")
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor)) + geom_pointrange(stat = "identity")
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor)) + geom_pointrange(stat = "identity", position = position_dodge())
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor)) + geom_pointrange(stat = "identity", position = position_dodge(width = 0.2))
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor)) + geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) + geom_line()
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor, group = sibling_count_uterus_alive_factor)) + geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) + geom_line()
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor, group = sibling_count_uterus_alive_factor)) + geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) + geom_line(position = position_dodge(width = 0.5))
m1m = lmer(g_factor ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
m1m = lmer(riskA ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
no_only_children_uterus$interaction = droplevels(interaction(no_only_children_uterus$sibling_count_uterus_alive_factor, no_only_children_uterus$birthorder_uterus_alive_factor))
no_only_children_uterus$count_birthorde = droplevels(interaction(no_only_children_uterus$sibling_count_uterus_alive_factor, no_only_children_uterus$birthorder_uterus_alive_factor))
no_only_children_uterus$count_birthorder = droplevels(interaction(no_only_children_uterus$sibling_count_uterus_alive_factor, no_only_children_uterus$birthorder_uterus_alive_factor))
table(no_only_children_uterus$interaction, exclude = NULL)
table(no_only_children_uterus$count_birthorder, exclude = NULL)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, ~ count_birthorder)
cemm = confint(emm)
cemm = confint(emm, REML = F)
emm = lsmeans(m1m, ~ count_birthorder)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus, REML = F)
summary(m1m)
emm = lsmeans(m1m, ~ count_birthorder)
cemm = confint(emm)
summary(m1m)
emm = lsmeans(m1m, ~ count_birthorder)
cemm = confint(emm)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, ~ count_birthorder)
cemm = confint(emm)
traceback()
emm = lsmeans(m1m, ~ count_birthorder)
emm
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus, REML = F)
summary(m1m)
emm = lsmeans(m1m, ~ count_birthorder)
emm
?lsmeans
emm = lsmeans::lsmeans(m1m, ~ count_birthorder)
cemm = confint(emm)
emm
emm = lmerTest::lsmeans(m1m, ~ count_birthorder)
emm = lmerTest::lsmeans(m1m, "count_birthorder")
emm = lmerTest::lsmeans(m1m, "count_birthorder", ddf="Kenward-Roger")
emm = lmerTest::lsmeans(m1m, "count_birthorder", ddf="lme4")
str(no_only_children_uterus$count_birthorder)
emm = lmerTest::lsmeans(m1m, "count_birthorder", ddf = "")
emm = lmerTest::lsmeans(m1m, "count_birthorder", ddf = "Kenward-Rogers")
emm = lmerTest::lsmeans(m1m, "count_birthorder", ddf = "Kenward-Roger")
m1m = lmer(g_factor ~ gender + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus, REML = F)
summary(m1m)
emm = lsmeans(m1m, "count_birthorder")
cemm = confint(emm)
m1m = lmer(g_factor ~ gender + age + byear + (1 | mother_pidlink), data = no_only_children_uterus, REML = F)
summary(m1m)
emm = lsmeans(m1m, "count_birthorder")
emm = lsmeans(m1m, "age")
cemm = confint(emm)
m1m = lmer(riskA ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, ~ birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor)
cemm = confint(emm)
m1m = lmer(riskA ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, ~ count_birthorder)
cemm = confint(emm)
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor, group = sibling_count_uterus_alive_factor)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
head(cemm)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus, REML = F)
plot(m1m)
vcov(m1m)
predict(m1m)
anova(m1m)
qplot(no_only_children_uterus$g_factor)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
xtabs(~ is.na(g_factor) + count_birthorder, data = no_only_children_uterus)
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor, group = sibling_count_uterus_alive_factor)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
m1m = lmer(riskA ~ gender + age + byear + interaction + (1 | mother_pidlink), data = no_only_children_uterus)
m1m = lmer(riskA ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, ~ birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor)
cemm = confint(emm)
ggplot(cemm, aes(birthorder_uterus_alive_factor, lsmean, ymax = upper.CL, ymin = lower.CL, colour = sibling_count_uterus_alive_factor, group = sibling_count_uterus_alive_factor)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
xtabs(~ is.na(g_factor) + count_birthorder, data = no_only_children_uterus)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, "count_birthorder")
cemm = confint(emm)
m1m = lmer(g_factor ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
qplot(no_only_children_uterus$riskA)
xtabs(~ is.na(g_factor) + is.na(riskA), data = no_only_children_uterus)
xtabs(~ is.na(g_factor) + count_birthorder, data = no_only_children_uterus)
no_only_children_uterus$count_birthorder = droplevels(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor))
levels(no_only_children_uterus$count_birthorder)
no_only_children_uterus$count_birthorder = droplevels(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor))
?recode
no_only_children_uterus$count_birthorder = str_replace(droplevels(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor)), ".", "/")
levels(no_only_children_uterus$count_birthorder)
table(no_only_children_uterus$count_birthorder, exclude = NULL)
no_only_children_uterus$count_birthorder = str_replace(as.character(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor)), ".", "/")
levels(no_only_children_uterus$count_birthorder)
unique(no_only_children_uterus$count_birthorder)
no_only_children_uterus$count_birthorder = str_replace(as.character(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor)), "\\.", "/")
unique(no_only_children_uterus$count_birthorder)
dput(unique(no_only_children_uterus$count_birthorder))
no_only_children_uterus$count_birthorder = factor(str_replace(as.character(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor)), "\\.", "/"), levels =
c(
"1/2",
"2/2",
"1/3",
"2/3",
"3/3",
"1/4",
"2/4",
"3/4",
"4/4",
"1/5",
"2/5",
"3/5",
"4/5",
"5/5",
"1/5+",
"2/5+",
"3/5+",
"4/5+",
"5/5+",
"5+/5+"
)
no_only_children_uterus$count_birthorder = factor(str_replace(as.character(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor)), "\\.", "/"), levels =
no_only_children_uterus$count_birthorder = factor(str_replace(as.character(interaction(no_only_children_uterus$birthorder_uterus_alive_factor, no_only_children_uterus$sibling_count_uterus_alive_factor)), "\\.", "/"), levels =
c(
"1/2",
"2/2",
"1/3",
"2/3",
"3/3",
"1/4",
"2/4",
"3/4",
"4/4",
"1/5",
"2/5",
"3/5",
"4/5",
"5/5",
"1/5+",
"2/5+",
"3/5+",
"4/5+",
"5/5+",
"5+/5+"
))
levels(no_only_children_uterus$count_birthorder)
table(no_only_children_uterus$count_birthorder, exclude = NULL)
crosstabs(no_only_children_uterus$count_birthorder, exclude = NULL)
crosstabs(no_only_children_uterus$count_birthorder)
m1m = lmer(riskA ~ gender + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
m1m = lmer(riskA ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, ~ birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor)
emm = lsmeans(m1m, ~ count_birthorder)
cemm = confint(emm)
cemm = confint(emm) %>% separate(count_birthorder, into = c("Birth order", "Nr. Siblings"), sep = "/")
ggplot(cemm, aes(`Birth order`, lsmean, ymax = upper.CL, ymin = lower.CL, colour = `Nr. Siblings`, group = sibling_count_uterus_alive_factor)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
ggplot(cemm, aes(`Birth order`, lsmean, ymax = upper.CL, ymin = lower.CL, colour = `Nr. Siblings`, group = `Nr. Siblings`)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, "count_birthorder")
cemm = confint(emm)
str(no_only_children_uterus$g_factor)
str(no_only_children_uterus$riskA)
qplot(no_only_children_uterus$g_factor)
qplot(scale(no_only_children_uterus$g_factor))
no_only_children_uterus$g_factor = scale(no_only_children_uterus$g_factor)[,1]
str(no_only_children_uterus$g_factor)
head(no_only_children_uterus$g_factor, 20)
qplot(no_only_children_uterus$g_factor,)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, "count_birthorder")
cemm = confint(emm)
traceback()
debug(lmerTest:::calcSatterth)
cemm = confint(emm)
cemm = confint(emm)
str(model)
rho
summary(m1m)
qplot(no_only_children_uterus$age)
qplot(no_only_children_uterus$byear)
m1m = lmer(riskA ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
m1m = lmer(riskA ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
no_only_children_uterus$byear = no_only_children_uterus$byear - mean(no_only_children_uterus$byear, na.rm = T)
no_only_children_uterus$age = no_only_children_uterus$age - mean(no_only_children_uterus$age, na.rm = T)
m1m = lmer(g_factor ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, "count_birthorder")
emm = lsmeans(m1m, "count_birthorder")
cemm = confint(emm) %>% separate(count_birthorder, into = c("Birth order", "Nr. Siblings"), sep = "/")
cemm = confint(emm)
rho
debug(calcApvar)
ch
cemm = confint(emm)
summary(emm)
View(h)
h[2,2] = h[2,2]  * -1
plot(m1m)
table(no_only_children_uterus$gender)
summary(m1m)
str(no_only_children_uterus$gender)
no_only_children_uterus$male = factor(no_only_children_uterus$gender == 1)
no_only_children_uterus$male = ifelse(no_only_children_uterus$gender > 3, NA, no_only_children_uterus$male)
table(no_only_children_uterus$male)
m1m = lmer(riskA ~ gender + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
m1m = lmer(riskA ~ male + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
m1m = lmer(g_factor ~ male + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, "count_birthorder")
cemm = confint(emm) %>% separate(count_birthorder, into = c("Birth order", "Nr. Siblings"), sep = "/")
lmerTest::lmer(g_factor ~ male + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(lmerTest::lmer(g_factor ~ male + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus))
m1m = lmer(g_factor ~ (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
emm = lsmeans(m1m, "count_birthorder")
summary(lmerTest::lmer(g_factor ~ (1 | mother_pidlink), data = no_only_children_uterus))
undebug(lmerTest:::calcApvar)
summary(lmerTest::lmer(g_factor ~ (1 | mother_pidlink), data = no_only_children_uterus))
summary(lmerTest::lmer(riskA ~ (1 | mother_pidlink), data = no_only_children_uterus))
table(duplicated(no_only_children_uterus$mother_pidlink))
table(table(no_only_children_uterus$mother_pidlink))
table(no_only_children_uterus$sibling_count_uterus_alive)
plot(allEffects(m1m))
m1m = lmer(g_factor ~ male + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
plot(allEffects(m1m))
m1m = lmer(riskA ~ male + age + byear + sibling_count_uterus_alive_factor * birthorder_uterus_alive_factor + (1 | mother_pidlink), data = no_only_children_uterus)
plot(allEffects(m1m))
m1m = lmer(riskA ~ male + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
plot(allEffects(m1m))
emm = allEffects(m1m)
str(emm)
emm$count_birthorder
as.data.frame(emm$count_birthorder)
as.data.frame(emm$count_birthorder)
cemm = as.data.frame(emm$count_birthorder)  %>% separate(count_birthorder, into = c("Birth order", "Nr. Siblings"), sep = "/")
ggplot(cemm, aes(`Birth order`, lsmean, ymax = upper.CL, ymin = lower.CL, colour = `Nr. Siblings`, group = `Nr. Siblings`)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
ggplot(cemm, aes(`Birth order`, y = fit, ymax = upper, ymin = lower, colour = `Nr. Siblings`, group = `Nr. Siblings`)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
ggplot(cemm, aes(`Birth order`, y = fit, ymax = upper, ymin = lower, colour = `Nr. Siblings`, group = `Nr. Siblings`)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
m1m = lmer(g_factor ~ male + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
emm = allEffects(m1m)
cemm = as.data.frame(emm$count_birthorder)  %>% separate(count_birthorder, into = c("Birth order", "Nr. Siblings"), sep = "/")
ggplot(cemm, aes(`Birth order`, y = fit, ymax = upper, ymin = lower, colour = `Nr. Siblings`, group = `Nr. Siblings`)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5))
m1m@call
m1m@call[1]
m1m@call[2]
m1m@call[3]
m1m@call[4]
m1m@call[2]
m1m@call[2][2]
m1m@frame[,1]
names(m1m@frame)[1]
plot_birthorder = function(model) {
outcome = names(model@frame)[1]
emm = allEffects(model)
cemm = as.data.frame(emm$count_birthorder)  %>% separate(count_birthorder, into = c("Birth order", "Nr. Siblings"), sep = "/")
print(
ggplot(cemm, aes(`Birth order`, y = fit, ymax = upper, ymin = lower, colour = `Nr. Siblings`, group = `Nr. Siblings`)) +
geom_pointrange(stat = "identity", position = position_dodge(width = 0.5)) +
geom_line(position = position_dodge(width = 0.5)) +
ylab(outcome)
)
}
plot_birthorder(m1m)
model_risk = lmer(riskA ~ male + age + byear + count_birthorder + (1 | mother_pidlink), data = no_only_children_uterus)
summary(m1m)
plot_birthorder(model_risk)
m1 = lm(riskA ~ sex + age + byear + birthorder_uterus_alive, data = alldata_birthorder)
summary(m1)
m2 = lm(riskA ~ sex + age + byear + birthorder_uterus_preg, data = alldata_birthorder)
summary(m2)
x1 = lm(riskA ~ sex + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor, data = no_only_children_uterus)
summary(x1)
plot(allEffects(x1))
x2 = lm(g_factor ~ sex + age + byear + birthorder_uterus_alive_factor * sibling_count_uterus_alive_factor, data = no_only_children_uterus)
summary(x2)
plot(allEffects(x2))
no_only_children_uterus %>%
ggplot(aes(x=birthorder_uterus_alive_factor, y=g_factor, colour = sibling_count_uterus_alive_factor, group = sibling_count_uterus_alive_factor)) +
geom_pointrange(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4)) +
geom_line(fun.data = "mean_cl_boot", stat = "summary", position = position_dodge(width = 0.4))
x2_genes = lm(g_factor ~ sex + age + byear + birthorder_genes_factor * sibling_count_genes_factor, data = no_only_children_genes)
summary(x2_genes)
plot(allEffects(x2_genes))
alldata_birthorder = readRDS("data/alldata_birthorder.rds")
qplot(alldata_birthorder$byear,binwidth = 1)
qplot(alldata_birthorder$age,binwidth = 1)
crosstabs(alldata_birthorder$sex.x + alldata_birthorder$sex.y)
qplot(alldata_birthorder$birthorder_uterus_alive, binwidth = 1)
alldata_birthorder = alldata_birthorder %>%
mutate(
birthorder_uterus_alive_factor = as.character(birthorder_uterus_alive),
birthorder_uterus_alive_factor = ifelse(birthorder_uterus_alive > 5, "5+", birthorder_uterus_alive_factor),
birthorder_uterus_alive_factor = factor(birthorder_uterus_alive_factor, levels = c("1","2","3","4","5","5+")),
sibling_count_uterus_alive_factor = as.character(sibling_count_uterus_alive),
sibling_count_uterus_alive_factor = ifelse(sibling_count_uterus_alive > 5, "5+", sibling_count_uterus_alive_factor),
sibling_count_uterus_alive_factor = factor(sibling_count_uterus_alive_factor, levels = c("1","2","3","4","5","5+")),
birthorder_genes_factor = as.character(birthorder_genes),
birthorder_genes_factor = ifelse(birthorder_genes >5 , "5+", birthorder_genes_factor),
birthorder_genes_factor = factor(birthorder_genes_factor, levels = c("1","2","3","4","5","5+")),
sibling_count_genes_factor = as.character(sibling_count_genes),
sibling_count_genes_factor = ifelse(sibling_count_genes >5 , "5+", sibling_count_genes_factor),
sibling_count_genes_factor = factor(sibling_count_genes_factor, levels = c("1","2","3","4","5","5+")),
count_birthorder = factor(str_replace(as.character(interaction(birthorder_uterus_alive_factor, sibling_count_uterus_alive_factor)), "\\.", "/"), levels =   c("1/1","1/2","2/2",
"1/3",  "2/3",  "3/3",
"1/4", "2/4", "3/4", "4/4",
"1/5", "2/5", "3/5", "4/5", "5/5",
"1/5+", "2/5+", "3/5+", "4/5+", "5/5+", "5+/5+")),
byear = byear - mean(byear, na.rm = T),
age = age - mean(age, na.rm = T),
male = factor(gender == 1),
male = ifelse(gender > 3, NA, male),
g_factor = scale(g_factor)[,1]
)
qplot(alldata_birthorder$byear,binwidth = 1)
q()
