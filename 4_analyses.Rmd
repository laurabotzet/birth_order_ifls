---
output: html_document
editor_options: 
  chunk_output_type: console
---
# <span style="color:#A6D854">Birth Order Effects</span> {.tabset}

## Helper
```{r helper}
source("0_helpers.R")
```

## Load data
```{r Load Data}
birthorder = readRDS("data/birthorder.rds")
```

## Data preperations
```{r data preperations}
### Variables
birthorder = birthorder %>%
  mutate(
    birthyear = birth_year,
    male = ifelse(sex == 1, 1L, 0L),
    male = ifelse(sex > 3, NA_integer_, male),
    male = factor(male),
    # center variables that are used for analysy - but first save old values
    old_g_factor = g_factor,
    old_raven = raven,
    old_math = math,
    old_count_backwards = count_backwards,
    old_words_remembered_avg = words_remembered_avg,
    old_words_immediate = words_immediate,
    old_words_delayed = words_delayed,
    old_adaptive_numbering = adaptive_numbering,
    old_big5_ext = big5_ext,
    old_big5_con = big5_con,
    old_big5_agree = big5_agree,
    old_big5_neu = big5_neu,
    old_big5_open = big5_open,
    old_riskA = riskA,
    old_riskB = riskB,
    g_factor = (g_factor - mean(g_factor, na.rm=T)) / sd(g_factor, na.rm=T),
    raven = (raven - mean(raven, na.rm=T)) / sd(raven, na.rm=T),
    math = (math - mean(math, na.rm=T)) / sd(math, na.rm=T),
    count_backwards = (count_backwards - mean(count_backwards, na.rm=T)) /
      sd(count_backwards, na.rm=T),
    words_remembered_avg = (words_remembered_avg - mean(words_remembered_avg, na.rm=T)) /
      sd(words_remembered_avg, na.rm=T),
    words_immediate = (words_immediate - mean(words_immediate, na.rm=T)) /
      sd(words_immediate, na.rm=T),
    words_delayed = (words_delayed - mean(words_delayed, na.rm=T)) /
      sd(words_delayed, na.rm=T),
    adaptive_numbering = (adaptive_numbering - mean(adaptive_numbering, na.rm=T)) /
      sd(adaptive_numbering, na.rm=T),
    big5_ext = (big5_ext - mean(big5_ext, na.rm=T)) / sd(big5_ext, na.rm=T),
    big5_con = (big5_con - mean(big5_con, na.rm=T)) / sd(big5_con, na.rm=T),
    big5_agree = (big5_agree - mean(big5_agree, na.rm=T)) / sd(big5_agree, na.rm=T),
    big5_open = (big5_open - mean(big5_open, na.rm=T)) / sd(big5_open, na.rm=T),
    big5_neu = (big5_neu - mean(big5_neu, na.rm=T)) / sd(big5_neu, na.rm=T),
    riskA = (riskA - mean(riskA, na.rm=T)) / sd(riskA, na.rm=T),
    riskB = (riskB - mean(riskB, na.rm=T)) / sd(riskB, na.rm=T),
    years_of_education_z = (years_of_education - mean(years_of_education, na.rm=T)) /
      sd(years_of_education, na.rm=T),
    Total_score_highest_z = (Total_score_highest - mean(Total_score_highest, na.rm=T)) /
      sd(Total_score_highest, na.rm=T),
    wage_last_month_z = (wage_last_month - mean(wage_last_month, na.rm=T)) /
      sd(wage_last_month, na.rm=T),
    wage_last_year_z = (wage_last_year - mean(wage_last_year, na.rm=T)) /
      sd(wage_last_year, na.rm=T)
        )
qplot(birthorder$male)

### Birthorder and Sibling Count
birthorder = birthorder %>% 
  mutate(
# birthorder as factors with levels of 1, 2, 3, 4, 5, 5+
    birthorder_naive_factor = as.character(birthorder_naive),
    birthorder_naive_factor = ifelse(birthorder_naive > 5, "5+",
                                            birthorder_naive_factor),
    birthorder_naive_factor = factor(birthorder_naive_factor, 
                                            levels = c("1","2","3","4","5","5+")),
    sibling_count_naive_factor = as.character(sibling_count_naive),
    sibling_count_naive_factor = ifelse(sibling_count_naive > 5, "5+",
                                               sibling_count_naive_factor),
    sibling_count_naive_factor = factor(sibling_count_naive_factor, 
                                               levels = c("2","3","4","5","5+")),

    birthorder_uterus_alive_factor = as.character(birthorder_uterus_alive),
    birthorder_uterus_alive_factor = ifelse(birthorder_uterus_alive > 5, "5+",
                                            birthorder_uterus_alive_factor),
    birthorder_uterus_alive_factor = factor(birthorder_uterus_alive_factor, 
                                            levels = c("1","2","3","4","5","5+")),
    sibling_count_uterus_alive_factor = as.character(sibling_count_uterus_alive),
    sibling_count_uterus_alive_factor = ifelse(sibling_count_uterus_alive > 5, "5+",
                                               sibling_count_uterus_alive_factor),
    sibling_count_uterus_alive_factor = factor(sibling_count_uterus_alive_factor, 
                                               levels = c("2","3","4","5","5+")),
    birthorder_uterus_preg_factor = as.character(birthorder_uterus_preg),
    birthorder_uterus_preg_factor = ifelse(birthorder_uterus_preg > 5, "5+",
                                           birthorder_uterus_preg_factor),
    birthorder_uterus_preg_factor = factor(birthorder_uterus_preg_factor,
                                           levels = c("1","2","3","4","5","5+")),
    sibling_count_uterus_preg_factor = as.character(sibling_count_uterus_preg),
    sibling_count_uterus_preg_factor = ifelse(sibling_count_uterus_preg > 5, "5+",
                                              sibling_count_uterus_preg_factor),
    sibling_count_uterus_preg_factor = factor(sibling_count_uterus_preg_factor, 
                                              levels = c("2","3","4","5","5+")),
    birthorder_genes_factor = as.character(birthorder_genes),
    birthorder_genes_factor = ifelse(birthorder_genes >5 , "5+", birthorder_genes_factor),
    birthorder_genes_factor = factor(birthorder_genes_factor, 
                                     levels = c("1","2","3","4","5","5+")),
    sibling_count_genes_factor = as.character(sibling_count_genes),
    sibling_count_genes_factor = ifelse(sibling_count_genes >5 , "5+",
                                        sibling_count_genes_factor),
    sibling_count_genes_factor = factor(sibling_count_genes_factor, 
                                        levels = c("2","3","4","5","5+")),
    # interaction birthorder * siblingcout for each birthorder
    count_birthorder_naive =
      factor(str_replace(as.character(interaction(birthorder_naive_factor,                                                              sibling_count_naive_factor)),
                        "\\.", "/"),
                                           levels =   c("1/2","2/2", "1/3",  "2/3",
                                                        "3/3", "1/4", "2/4", "3/4", "4/4",
                                                        "1/5", "2/5", "3/5", "4/5", "5/5",
                                                        "1/5+", "2/5+", "3/5+", "4/5+",
                                                        "5/5+", "5+/5+")),
    count_birthorder_uterus_alive =
      factor(str_replace(as.character(interaction(birthorder_uterus_alive_factor,                                                              sibling_count_uterus_alive_factor)),
                        "\\.", "/"),
                                           levels =   c("1/2","2/2", "1/3",  "2/3",
                                                        "3/3", "1/4", "2/4", "3/4", "4/4",
                                                        "1/5", "2/5", "3/5", "4/5", "5/5",
                                                        "1/5+", "2/5+", "3/5+", "4/5+",
                                                        "5/5+", "5+/5+")),
    count_birthorder_uterus_preg =
      factor(str_replace(as.character(interaction(birthorder_uterus_preg_factor,                                                              sibling_count_uterus_preg_factor)), 
                         "\\.", "/"),
                                           levels =   c("1/2","2/2", "1/3",  "2/3",
                                                        "3/3", "1/4", "2/4", "3/4", "4/4",
                                                        "1/5", "2/5", "3/5", "4/5", "5/5",
                                                        "1/5+", "2/5+", "3/5+", "4/5+",
                                                        "5/5+", "5+/5+")),
    count_birthorder_genes =
      factor(str_replace(as.character(interaction(birthorder_genes_factor,                                                              sibling_count_genes_factor)), "\\.", "/"),
                                           levels =   c("1/2","2/2", "1/3",  "2/3",
                                                        "3/3", "1/4", "2/4", "3/4", "4/4",
                                                        "1/5", "2/5", "3/5", "4/5", "5/5",
                                                        "1/5+", "2/5+", "3/5+", "4/5+",
                                                        "5/5+", "5+/5+")))
```


## Test
```{r}
birthorder = birthorder %>% mutate(birthyear = if_else(is.na(birth_year), ar08yr, birth_year))
g_factor_m1 = lmer(g_factor ~ birthorder_naive + birthyear + male + sibling_count_naive + (1 | mother_pidlink), data = birthorder)
summary(g_factor_m1)
plot(allEffects(g_factor_m1))
birthorder %>% select(g_factor, birthyear, male, birthorder_naive_factor, mother_pidlink) %>% missingness_patterns()

g_factor_m1 = lmer(g_factor ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_naive_factor,
                            birth_order_nonlinear = birthorder_naive_factor,
                            birth_order = birthorder_naive,
                            count_birth_order = count_birthorder_naive))
compare_models_markdown(g_factor_m1)
```


## Covariates and birth order
```{r}
round(cor(birthorder %>% ungroup() %>% select(birthorder_uterus_alive, birthorder_uterus_preg, birthorder_genes, sibling_count_uterus_alive, sibling_count_uterus_preg, sibling_count_genes), use = "pairwise.complete.obs"), 2) 
```

## Intelligence {.active .tabset}
### g-factor {.tabset}

#### Maternal birth order {.tabset}

```{r}
g_factor_m1 = lmer(g_factor ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(g_factor_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
g_factor_preg_m1 = lmer(g_factor ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(g_factor_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
g_factor_parental_m1 = lmer(g_factor ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(g_factor_parental_m1)
```

### Raven {.tabset}

#### Maternal birth order {.tabset}

```{r}
raven_m1 = lmer(raven ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(raven_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
raven_preg_m1 = lmer(raven ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(raven_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
raven_parental_m1 = lmer(raven ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(raven_parental_m1)
```


### Numeracy {.tabset}

#### Maternal birth order {.tabset}

```{r}
math_m1 = lmer(math ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(math_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
math_preg_m1 = lmer(math ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(math_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
math_parental_m1 = lmer(math ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(math_parental_m1)
```

### Counting backwards {.tabset}

#### Maternal birth order {.tabset}

```{r}
count_backwards_m1 = lmer(count_backwards ~ birthyear + male + sibling_count + (1 | mother_pidlink),
               data = birthorder %>%
                 rename(sibling_count = sibling_count_uterus_alive_factor,
                        birth_order_nonlinear = birthorder_uterus_alive_factor,
                        birth_order = birthorder_uterus_alive,
                        count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(count_backwards_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
count_backwards_preg_m1 = lmer(count_backwards ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
                      rename(sibling_count = sibling_count_uterus_preg_factor,
                             birth_order_nonlinear = birthorder_uterus_preg_factor,
                             birth_order = birthorder_uterus_preg,
                             count_birth_order = count_birthorder_uterus_preg
                      ))
compare_models_markdown(count_backwards_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
count_backwards_parental_m1 = lmer(count_backwards ~ birthyear + male + sibling_count + (1 | marriage_id),
                        data = birthorder %>% 
                          rename(sibling_count = sibling_count_genes_factor,
                                 birth_order_nonlinear = birthorder_genes_factor,
                                 birth_order = birthorder_genes,
                                 count_birth_order = count_birthorder_genes
                          ))
compare_models_markdown(count_backwards_parental_m1)
```

### Immediate word recall {.tabset}

#### Maternal birth order {.tabset}

```{r}
words_immediate_m1 = lmer(words_immediate ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                          data = birthorder %>%
                            rename(sibling_count = sibling_count_uterus_alive_factor,
                                   birth_order_nonlinear = birthorder_uterus_alive_factor,
                                   birth_order = birthorder_uterus_alive,
                                   count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(words_immediate_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
words_immediate_preg_m1 = lmer(words_immediate ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
                                 rename(sibling_count = sibling_count_uterus_preg_factor,
                                        birth_order_nonlinear = birthorder_uterus_preg_factor,
                                        birth_order = birthorder_uterus_preg,
                                        count_birth_order = count_birthorder_uterus_preg
                                 ))
compare_models_markdown(words_immediate_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
words_immediate_parental_m1 = lmer(words_immediate ~ birthyear + male + sibling_count + (1 | marriage_id),
                                   data = birthorder %>% 
                                     rename(sibling_count = sibling_count_genes_factor,
                                            birth_order_nonlinear = birthorder_genes_factor,
                                            birth_order = birthorder_genes,
                                            count_birth_order = count_birthorder_genes
                                     ))
compare_models_markdown(words_immediate_parental_m1)
```


### Delayed word recall {.tabset}

#### Maternal birth order {.tabset}

```{r}
words_delayed_m1 = lmer(words_delayed ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                          data = birthorder %>%
                            rename(sibling_count = sibling_count_uterus_alive_factor,
                                   birth_order_nonlinear = birthorder_uterus_alive_factor,
                                   birth_order = birthorder_uterus_alive,
                                   count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(words_delayed_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
words_delayed_preg_m1 = lmer(words_delayed ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
                                 rename(sibling_count = sibling_count_uterus_preg_factor,
                                        birth_order_nonlinear = birthorder_uterus_preg_factor,
                                        birth_order = birthorder_uterus_preg,
                                        count_birth_order = count_birthorder_uterus_preg
                                 ))
compare_models_markdown(words_delayed_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
words_delayed_parental_m1 = lmer(words_delayed ~ birthyear + male + sibling_count + (1 | marriage_id),
                                   data = birthorder %>% 
                                     rename(sibling_count = sibling_count_genes_factor,
                                            birth_order_nonlinear = birthorder_genes_factor,
                                            birth_order = birthorder_genes,
                                            count_birth_order = count_birthorder_genes
                                     ))
compare_models_markdown(words_delayed_parental_m1)
```

### Adaptive Numbering {.tabset}

#### Maternal birth order {.tabset}

```{r}
adaptive_numbering_m1 = lmer(adaptive_numbering ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                          data = birthorder %>%
                            rename(sibling_count = sibling_count_uterus_alive_factor,
                                   birth_order_nonlinear = birthorder_uterus_alive_factor,
                                   birth_order = birthorder_uterus_alive,
                                   count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(adaptive_numbering_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
adaptive_numbering_preg_m1 = lmer(adaptive_numbering ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
                                 rename(sibling_count = sibling_count_uterus_preg_factor,
                                        birth_order_nonlinear = birthorder_uterus_preg_factor,
                                        birth_order = birthorder_uterus_preg,
                                        count_birth_order = count_birthorder_uterus_preg
                                 ))
compare_models_markdown(adaptive_numbering_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
adaptive_numbering_parental_m1 = lmer(adaptive_numbering ~ birthyear + male + sibling_count + (1 | marriage_id),
                                   data = birthorder %>% 
                                     rename(sibling_count = sibling_count_genes_factor,
                                            birth_order_nonlinear = birthorder_genes_factor,
                                            birth_order = birthorder_genes,
                                            count_birth_order = count_birthorder_genes
                                     ))
compare_models_markdown(adaptive_numbering_parental_m1)
```

## Personality {.tabset}
### Extraversion {.tabset}

#### Maternal birth order {.tabset}

```{r}
big5_ext_m1 = lmer(big5_ext ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(big5_ext_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
big5_ext_preg_m1 = lmer(big5_ext ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(big5_ext_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
big5_ext_parental_m1 = lmer(big5_ext ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(big5_ext_parental_m1)
```

### Neuroticism {.tabset}

#### Maternal birth order {.tabset}

```{r}
big5_neu_m1 = lmer(big5_neu ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(big5_neu_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
big5_neu_preg_m1 = lmer(big5_neu ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(big5_neu_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
big5_neu_parental_m1 = lmer(big5_neu ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(big5_neu_parental_m1)
```

### Conscientiousness {.tabset}

#### Maternal birth order {.tabset}

```{r}
big5_con_m1 = lmer(big5_con ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(big5_con_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
big5_con_preg_m1 = lmer(big5_con ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(big5_con_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
big5_con_parental_m1 = lmer(big5_con ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(big5_con_parental_m1)
```

### Agreeableness {.tabset}

#### Maternal birth order {.tabset}

```{r}
big5_agree_m1 = lmer(big5_agree ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(big5_agree_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
big5_agree_preg_m1 = lmer(big5_agree ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(big5_agree_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
big5_agree_parental_m1 = lmer(big5_agree ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(big5_agree_parental_m1)
```

### Openness {.tabset}

#### Maternal birth order {.tabset}

```{r}
big5_open_m1 = lmer(big5_open ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(big5_open_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
big5_open_preg_m1 = lmer(big5_open ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(big5_open_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
big5_open_parental_m1 = lmer(big5_open ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(big5_open_parental_m1)
```

## Risk preference {.tabset}

### Risk A {.tabset}

#### Maternal birth order {.tabset}

```{r}
riskA_m1 = lmer(riskA ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(riskA_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
riskA_preg_m1 = lmer(riskA ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(riskA_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
riskA_parental_m1 = lmer(riskA ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(riskA_parental_m1)
```


### Risk B {.tabset}

#### Maternal birth order {.tabset}

```{r}
riskB_m1 = lmer(riskB ~ birthyear + male + sibling_count + (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(riskB_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
riskB_preg_m1 = lmer(riskB ~ birthyear + male + sibling_count + (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(riskB_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
riskB_parental_m1 = lmer(riskB ~ birthyear + male + sibling_count + (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(riskB_parental_m1)
```

## Educational Attainment {.tabset}
### Years of Education - z-standardized {.tabset}

#### Maternal birth order {.tabset}

```{r}
years_of_education_z_m1 = lmer(years_of_education_z ~ birthyear + male + sibling_count +
                                 (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(years_of_education_z_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
years_of_education_z_preg_m1 = lmer(years_of_education_z ~ birthyear + male + sibling_count +
                                      (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(years_of_education_z_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
years_of_education_z_parental_m1 = lmer(years_of_education_z ~ birthyear + male + sibling_count +
                                         (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(years_of_education_z_parental_m1)
```

#### Years of education - non-standardized {.tabset}

#### Maternal birth order {.tabset}

```{r}
years_of_education_m1 = lmer(years_of_education ~ birthyear + male + sibling_count +
                                 (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown_nonz(years_of_education_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
years_of_education_preg_m1 = lmer(years_of_education ~ birthyear + male + sibling_count +
                                      (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown_nonz(years_of_education_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
years_of_education_parental_m1 = lmer(years_of_education ~ birthyear + male + sibling_count +
                                         (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown_nonz(years_of_education_parental_m1)
```

### EBTANAS - z-standardized {.tabset}

#### Maternal birth order {.tabset}

```{r}
total_score_highest_z_m1 = lmer(Total_score_highest_z ~ birthyear + male + sibling_count +
                                 (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(total_score_highest_z_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
total_score_highest_z_preg_m1 = lmer(Total_score_highest_z ~ birthyear + male +
                                       sibling_count +
                                      (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(total_score_highest_z_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
total_score_highest_z_parental_m1 = lmer(Total_score_highest_z ~ birthyear + male + sibling_count +
                                         (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(total_score_highest_z_parental_m1)
```

## Income last month {.tabset}

### z-standardized {.tabset}

#### Maternal birth order {.tabset}

```{r}
wage_last_month_z_m1 = lmer(wage_last_month_z ~ birthyear + male + sibling_count +
                                 (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(wage_last_month_z_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
wage_last_month_z_preg_m1 = lmer(wage_last_month_z ~ birthyear + male + sibling_count +
                                      (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(wage_last_month_z_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
wage_last_month_z_parental_m1 = lmer(wage_last_month_z ~ birthyear + male + sibling_count +
                                         (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(wage_last_month_z_parental_m1)
```


## Income last year {.tabset}

### z-standardized {.tabset}

#### Maternal birth order {.tabset}

```{r}
wage_last_year_z_m1 = lmer(wage_last_year_z ~ birthyear + male + sibling_count +
                                 (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown(wage_last_year_z_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
wage_last_year_z_preg_m1 = lmer(wage_last_year_z ~ birthyear + male + sibling_count +
                                      (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown(wage_last_year_z_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
wage_last_year_z_parental_m1 = lmer(wage_last_year_z ~ birthyear + male + sibling_count +
                                         (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown(wage_last_year_z_parental_m1)
```


## Work {.tabset}
### Self-Employment - non standardized {.tabset}

#### Maternal birth order {.tabset}

```{r}
self_employed_m1 = lmer(Self_employed ~ birthyear + male + sibling_count +
                                 (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown_01(self_employed_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
self_employed_preg_m1 = lmer(Self_employed ~ birthyear + male + sibling_count +
                                      (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown_01(self_employed_preg_m1)
```

#### Parental full sibling order {.tabset}

```{r}
self_employed_parental_m1 = lmer(Self_employed ~ birthyear + male + sibling_count +
                                         (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown_01(self_employed_parental_m1)
```

### Child Labour {.tabset}


#### Maternal birth order {.tabset}

```{r}
total_worked_m1 = lmer(total_worked ~ birthyear + male + sibling_count +
                                 (1 | mother_pidlink),
                   data = birthorder %>%
                     rename(sibling_count = sibling_count_uterus_alive_factor,
                            birth_order_nonlinear = birthorder_uterus_alive_factor,
                            birth_order = birthorder_uterus_alive,
                            count_birth_order = count_birthorder_uterus_alive))
compare_models_markdown_01(total_worked_m1)
```

#### Maternal pregnancy order {.tabset}

```{r}
total_worked_m1 = lmer(total_worked ~ birthyear + male + sibling_count +
                                      (1 | mother_pidlink), data = birthorder %>% 
  rename(sibling_count = sibling_count_uterus_preg_factor,
         birth_order_nonlinear = birthorder_uterus_preg_factor,
         birth_order = birthorder_uterus_preg,
         count_birth_order = count_birthorder_uterus_preg
         ))
compare_models_markdown_01(total_worked_m1)
```

#### Parental full sibling order {.tabset}

```{r}
total_worked_m1 = lmer(total_worked ~ birthyear + male + sibling_count +
                                         (1 | marriage_id),
                            data = birthorder %>% 
  rename(sibling_count = sibling_count_genes_factor,
         birth_order_nonlinear = birthorder_genes_factor,
         birth_order = birthorder_genes,
         count_birth_order = count_birthorder_genes
         ))
compare_models_markdown_01(total_worked_m1)
```


